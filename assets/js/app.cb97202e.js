(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function e(e){for(var r,o,l=e[0],s=e[1],c=e[2],u=0,p=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n[r]=s[r]);for(d&&d(e);p.length;)p.shift()();return a.push.apply(a,c||[]),t()}function t(){for(var n,e=0;e<a.length;e++){for(var t=a[e],r=!0,l=1;l<t.length;l++){var s=t[l];0!==i[s]&&(r=!1)}r&&(a.splice(e--,1),n=o(o.s=t[0]))}return n}var r={},i={1:0},a=[];function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.e=function(n){var e=[],t=i[n];if(0!==t)if(t)e.push(t[2]);else{var r=new Promise((function(e,r){t=i[n]=[e,r]}));e.push(t[2]=r);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=function(n){return o.p+"assets/js/"+({}[n]||n)+"."+{2:"fa058597",3:"4b71d9fe",4:"3836de01",5:"f79f1e82",6:"ceb8656c",7:"25301cde",8:"613325ef",9:"31c9a510",10:"fbbc33f8",11:"e3d7ecd4",12:"6de50559",13:"8dedab1e",14:"ead62617",15:"377f9eff",16:"763bd371",17:"452907d0",18:"bfb4eb4c",19:"3a381546",20:"a58c8d54",21:"2396ac9a",22:"bb98ebd0",23:"b7fdba34",24:"0b80133a",25:"69b28bfb",26:"bf4988d2",27:"0b6c643d",28:"f2a75d7c",29:"de74b523",30:"a3285463",31:"bee37403",32:"4c4ce223",33:"2b15780c",34:"242c9c33",35:"65867b33",36:"aa83c10f",37:"21526183",38:"27a51a78",39:"d49a2493",40:"6a058e64",41:"406875cc",42:"bbdd8e3f",43:"d40b65fe",44:"c0f90ae5",45:"888d6df5",46:"f7e33e57",47:"45f53f88",48:"77efa4d7",49:"222129ad",50:"5f2dae6e",51:"54d77935",52:"935ac9e4",53:"0561a5cf",54:"b64090af",55:"e720956e",56:"05ceed8c",57:"b43f5784",58:"1ccee6f6",59:"11da92d7",60:"72015a1a",61:"3aacd878",62:"693f7f4a",63:"f666517a",64:"456d56a4",65:"5af02db9",66:"dd0db447",67:"0670b2ab",68:"09d5204c",69:"db09bda6",70:"ce9ceff6",71:"df171820",72:"cd125ee6",73:"e033fc1b",74:"5160e9b2",75:"495ec91d",76:"8121dc30",77:"405ab201",78:"091cc5a6",79:"8fcedf93",80:"65ec1411",81:"1151b577",82:"1064cbc3",83:"d6b435b9",84:"d40835b6",85:"bbb92aeb",86:"4b654a58",87:"49f96070",88:"1cd4bf4b",89:"6f0cf925",90:"fdf245ed",91:"596c04cb",92:"1656dd04",93:"08106ce8",94:"00f357bc",95:"54112709",96:"aed60490"}[n]+".js"}(n);var s=new Error;a=function(e){l.onerror=l.onload=null,clearTimeout(c);var t=i[n];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;s.message="Loading chunk "+n+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,t[1](s)}i[n]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(e)},o.m=n,o.c=r,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)o.d(t,r,function(e){return n[e]}.bind(null,r));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,"a",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p="/design/",o.oe=function(n){throw console.error(n),n};var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var d=s;a.push([241,0]),t()}([function(n,e){var t=function(n){return n&&n.Math==Math&&n};n.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(n,e,t){var r=t(0),i=t(38).f,a=t(24),o=t(14),l=t(115),s=t(119),c=t(106);n.exports=function(n,e){var t,d,u,p,m,h=n.target,g=n.global,f=n.stat;if(t=g?r:f?r[h]||l(h,{}):(r[h]||{}).prototype)for(d in e){if(p=e[d],u=n.noTargetGet?(m=i(t,d))&&m.value:t[d],!c(g?d:h+(f?".":"#")+d,n.forced)&&void 0!==u){if(typeof p==typeof u)continue;s(p,u)}(n.sham||u&&u.sham)&&a(p,"sham",!0),o(t,d,p,n)}}},function(n,e,t){var r=t(65),i=Function.prototype,a=i.bind,o=i.call,l=r&&a.bind(o,o);n.exports=r?function(n){return n&&l(n)}:function(n){return n&&function(){return o.apply(n,arguments)}}},function(n,e){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,e){n.exports=function(n){return"function"==typeof n}},function(n,e,t){var r=t(0),i=t(51),a=t(9),o=t(85),l=t(52),s=t(156),c=i("wks"),d=r.Symbol,u=d&&d.for,p=s?d:d&&d.withoutSetter||o;n.exports=function(n){if(!a(c,n)||!l&&"string"!=typeof c[n]){var e="Symbol."+n;l&&a(d,n)?c[n]=d[n]:c[n]=s&&u?u(e):p(e)}return c[n]}},function(n,e,t){var r=t(122),i=t(14),a=t(261);r||i(Object.prototype,"toString",a,{unsafe:!0})},function(n,e,t){var r=t(65),i=Function.prototype.call;n.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},function(n,e,t){var r=t(3);n.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(n,e,t){var r=t(2),i=t(16),a=r({}.hasOwnProperty);n.exports=Object.hasOwn||function(n,e){return a(i(n),e)}},function(n,e,t){var r=t(0),i=t(11),a=r.String,o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not an object")}},function(n,e,t){var r=t(4);n.exports=function(n){return"object"==typeof n?null!==n:r(n)}},function(n,e,t){var r=t(0),i=t(82),a=r.String;n.exports=function(n){if("Symbol"===i(n))throw TypeError("Cannot convert a Symbol value to a string");return a(n)}},function(n,e,t){var r=t(0),i=t(8),a=t(158),o=t(157),l=t(10),s=t(87),c=r.TypeError,d=Object.defineProperty,u=Object.getOwnPropertyDescriptor;e.f=i?o?function(n,e,t){if(l(n),e=s(e),l(t),"function"==typeof n&&"prototype"===e&&"value"in t&&"writable"in t&&!t.writable){var r=u(n,e);r&&r.writable&&(n[e]=t.value,t={configurable:"configurable"in t?t.configurable:r.configurable,enumerable:"enumerable"in t?t.enumerable:r.enumerable,writable:!1})}return d(n,e,t)}:d:function(n,e,t){if(l(n),e=s(e),l(t),a)try{return d(n,e,t)}catch(n){}if("get"in t||"set"in t)throw c("Accessors not supported");return"value"in t&&(n[e]=t.value),n}},function(n,e,t){var r=t(0),i=t(4),a=t(9),o=t(24),l=t(115),s=t(91),c=t(37),d=t(70).CONFIGURABLE,u=c.get,p=c.enforce,m=String(String).split("String");(n.exports=function(n,e,t,s){var c,u=!!s&&!!s.unsafe,h=!!s&&!!s.enumerable,g=!!s&&!!s.noTargetGet,f=s&&void 0!==s.name?s.name:e;i(t)&&("Symbol("===String(f).slice(0,7)&&(f="["+String(f).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!a(t,"name")||d&&t.name!==f)&&o(t,"name",f),(c=p(t)).source||(c.source=m.join("string"==typeof f?f:""))),n!==r?(u?!g&&n[e]&&(h=!0):delete n[e],h?n[e]=t:o(n,e,t)):h?n[e]=t:l(e,t)})(Function.prototype,"toString",(function(){return i(this)&&u(this).source||s(this)}))},function(n,e,t){var r=t(0),i=t(4),a=function(n){return i(n)?n:void 0};n.exports=function(n,e){return arguments.length<2?a(r[n]):r[n]&&r[n][e]}},function(n,e,t){var r=t(0),i=t(18),a=r.Object;n.exports=function(n){return a(i(n))}},function(n,e){n.exports=!1},function(n,e,t){var r=t(0).TypeError;n.exports=function(n){if(null==n)throw r("Can't call method on "+n);return n}},function(n,e,t){"use strict";var r=t(1),i=t(97);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(n,e,t){var r=t(54);n.exports=function(n){return r(n.length)}},function(n,e,t){var r=t(64),i=t(18);n.exports=function(n){return r(i(n))}},function(n,e,t){var r=t(0),i=t(4),a=t(67),o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not a function")}},function(n,e,t){var r=t(2),i=r({}.toString),a=r("".slice);n.exports=function(n){return a(i(n),8,-1)}},function(n,e,t){var r=t(8),i=t(13),a=t(49);n.exports=r?function(n,e,t){return i.f(n,e,a(1,t))}:function(n,e,t){return n[e]=t,n}},function(n,e,t){"use strict";var r=t(175).charAt,i=t(12),a=t(37),o=t(162),l=a.set,s=a.getterFor("String Iterator");o(String,"String",(function(n){l(this,{type:"String Iterator",string:i(n),index:0})}),(function(){var n,e=s(this),t=e.string,i=e.index;return i>=t.length?{value:void 0,done:!0}:(n=r(t,i),e.index+=n.length,{value:n,done:!1})}))},function(n,e,t){var r=t(14),i=t(282),a=Error.prototype;a.toString!==i&&r(a,"toString",i)},function(n,e){var t=Array.isArray;n.exports=t},function(n,e,t){var r=t(15);n.exports=r("navigator","userAgent")||""},function(n,e,t){var r=t(192),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();n.exports=a},function(n,e,t){"use strict";function r(n,e,t,r,i,a,o,l){var s,c="function"==typeof n?n.options:n;if(e&&(c.render=e,c.staticRenderFns=t,c._compiled=!0),r&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),o?(s=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(o)},c._ssrRegister=s):i&&(s=l?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),s)if(c.functional){c._injectStyles=s;var d=c.render;c.render=function(n,e){return s.call(e),d(n,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,s):[s]}return{exports:n,options:c}}t.d(e,"a",(function(){return r}))},function(n,e,t){"use strict";var r=t(1),i=t(59).filter;r({target:"Array",proto:!0,forced:!t(75)("filter")},{filter:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){var r=t(0),i=t(176),a=t(177),o=t(145),l=t(24),s=t(5),c=s("iterator"),d=s("toStringTag"),u=o.values,p=function(n,e){if(n){if(n[c]!==u)try{l(n,c,u)}catch(e){n[c]=u}if(n[d]||l(n,d,e),i[e])for(var t in o)if(n[t]!==o[t])try{l(n,t,o[t])}catch(e){n[t]=o[t]}}};for(var m in i)p(r[m]&&r[m].prototype,m);p(a,"DOMTokenList")},function(n,e,t){"use strict";var r=t(1),i=t(181);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(n,e,t){var r=t(0),i=t(176),a=t(177),o=t(181),l=t(24),s=function(n){if(n&&n.forEach!==o)try{l(n,"forEach",o)}catch(e){n.forEach=o}};for(var c in i)i[c]&&s(r[c]&&r[c].prototype);s(a)},function(n,e,t){var r,i=t(10),a=t(146),o=t(117),l=t(68),s=t(161),c=t(86),d=t(90),u=d("IE_PROTO"),p=function(){},m=function(n){return"<script>"+n+"<\/script>"},h=function(n){n.write(m("")),n.close();var e=n.parentWindow.Object;return n=null,e},g=function(){try{r=new ActiveXObject("htmlfile")}catch(n){}var n,e;g="undefined"!=typeof document?document.domain&&r?h(r):((e=c("iframe")).style.display="none",s.appendChild(e),e.src=String("javascript:"),(n=e.contentWindow.document).open(),n.write(m("document.F=Object")),n.close(),n.F):h(r);for(var t=o.length;t--;)delete g.prototype[o[t]];return g()};l[u]=!0,n.exports=Object.create||function(n,e){var t;return null!==n?(p.prototype=i(n),t=new p,p.prototype=null,t[u]=n):t=g(),void 0===e?t:a.f(t,e)}},function(n,e,t){var r=t(2);n.exports=r({}.isPrototypeOf)},function(n,e,t){var r,i,a,o=t(243),l=t(0),s=t(2),c=t(11),d=t(24),u=t(9),p=t(114),m=t(90),h=t(68),g=l.TypeError,f=l.WeakMap;if(o||p.state){var v=p.state||(p.state=new f),b=s(v.get),y=s(v.has),x=s(v.set);r=function(n,e){if(y(v,n))throw new g("Object already initialized");return e.facade=n,x(v,n,e),e},i=function(n){return b(v,n)||{}},a=function(n){return y(v,n)}}else{var T=m("state");h[T]=!0,r=function(n,e){if(u(n,T))throw new g("Object already initialized");return e.facade=n,d(n,T,e),e},i=function(n){return u(n,T)?n[T]:{}},a=function(n){return u(n,T)}}n.exports={set:r,get:i,has:a,enforce:function(n){return a(n)?i(n):r(n,{})},getterFor:function(n){return function(e){var t;if(!c(e)||(t=i(e)).type!==n)throw g("Incompatible receiver, "+n+" required");return t}}}},function(n,e,t){var r=t(8),i=t(7),a=t(118),o=t(49),l=t(21),s=t(87),c=t(9),d=t(158),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(n,e){if(n=l(n),e=s(e),d)try{return u(n,e)}catch(n){}if(c(n,e))return o(!i(a.f,n,e),n[e])}},function(n,e,t){var r=t(65),i=Function.prototype,a=i.apply,o=i.call;n.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(a):function(){return o.apply(a,arguments)})},function(n,e,t){var r=t(1),i=t(0),a=t(39),o=t(278),l=i.WebAssembly,s=7!==Error("e",{cause:7}).cause,c=function(n,e){var t={};t[n]=o(n,e,s),r({global:!0,forced:s},t)},d=function(n,e){if(l&&l[n]){var t={};t[n]=o("WebAssembly."+n,e,s),r({target:"WebAssembly",stat:!0,forced:s},t)}};c("Error",(function(n){return function(e){return a(n,this,arguments)}})),c("EvalError",(function(n){return function(e){return a(n,this,arguments)}})),c("RangeError",(function(n){return function(e){return a(n,this,arguments)}})),c("ReferenceError",(function(n){return function(e){return a(n,this,arguments)}})),c("SyntaxError",(function(n){return function(e){return a(n,this,arguments)}})),c("TypeError",(function(n){return function(e){return a(n,this,arguments)}})),c("URIError",(function(n){return function(e){return a(n,this,arguments)}})),d("CompileError",(function(n){return function(e){return a(n,this,arguments)}})),d("LinkError",(function(n){return function(e){return a(n,this,arguments)}})),d("RuntimeError",(function(n){return function(e){return a(n,this,arguments)}}))},function(n,e,t){var r=t(302),i=t(305);n.exports=function(n,e){var t=i(n,e);return r(t)?t:void 0}},function(n,e,t){t(378),t(379)},function(n,e,t){"use strict";t.d(e,"e",(function(){return r})),t.d(e,"b",(function(){return a})),t.d(e,"j",(function(){return o})),t.d(e,"g",(function(){return s})),t.d(e,"h",(function(){return c})),t.d(e,"i",(function(){return d})),t.d(e,"c",(function(){return u})),t.d(e,"f",(function(){return p})),t.d(e,"l",(function(){return m})),t.d(e,"m",(function(){return h})),t.d(e,"d",(function(){return f})),t.d(e,"k",(function(){return v})),t.d(e,"n",(function(){return b})),t.d(e,"a",(function(){return x}));t(19),t(45),t(140),t(81),t(138),t(113),t(44),t(33),t(6),t(34),t(31),t(84),t(80),t(155),t(79),t(213),t(26),t(144);var r=/#.*$/,i=/\.(md|html)$/,a=/\/$/,o=/^[a-z]+:/i;function l(n){return decodeURI(n).replace(r,"").replace(i,"")}function s(n){return o.test(n)}function c(n){return/^mailto:/.test(n)}function d(n){return/^tel:/.test(n)}function u(n){if(s(n))return n;if(!n)return"404";var e=n.match(r),t=e?e[0]:"",i=l(n);return a.test(i)?n:i+".html"+t}function p(n,e){var t=n.hash,i=function(n){var e=n&&n.match(r);if(e)return e[0]}(e);return(!i||t===i)&&l(n.path)===l(e)}function m(n,e,t){if(s(e))return{type:"external",path:e};t&&(e=function(n,e,t){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return e+n;var i=e.split("/");t&&i[i.length-1]||i.pop();for(var a=n.replace(/^\//,"").split("/"),o=0;o<a.length;o++){var l=a[o];".."===l?i.pop():"."!==l&&i.push(l)}""!==i[0]&&i.unshift("");return i.join("/")}(e,t));for(var r=l(e),i=0;i<n.length;i++)if(l(n[i].regularPath)===r)return Object.assign({},n[i],{type:"page",path:u(n[i].path)});return console.error('[vuepress] No matching page found for sidebar item "'.concat(e,'"')),{}}function h(n,e,t,r){var i=t.pages,a=t.themeConfig,o=r&&a.locales&&a.locales[r]||a;if("auto"===(n.frontmatter.sidebar||o.sidebar||a.sidebar))return g(n);var l=o.sidebar||a.sidebar;if(l){var s=function(n,e){if(Array.isArray(e))return{base:"/",config:e};for(var t in e)if(0===(r=n,/(\.html|\/)$/.test(r)?r:r+"/").indexOf(encodeURI(t)))return{base:t,config:e[t]};var r;return{}}(e,l),c=s.base,d=s.config;return"auto"===d?g(n):d?d.map((function(n){return function n(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if("string"==typeof e)return m(t,e,r);if(Array.isArray(e))return Object.assign(m(t,e[0],r),{title:e[1]});i>3&&console.error("[vuepress] detected a too deep nested sidebar group.");var a=e.children||[];return 0===a.length&&e.path?Object.assign(m(t,e.path,r),{title:e.title}):{type:"group",path:e.path,title:e.title,sidebarDepth:e.sidebarDepth,initialOpenGroupIndex:e.initialOpenGroupIndex,children:a.map((function(e){return n(e,t,r,i+1)})),collapsable:!1!==e.collapsable}}(n,i,c)})):[]}return[]}function g(n){var e=f(n.headers||[]);return[{type:"group",collapsable:!1,title:n.title,path:null,children:e.map((function(e){return{type:"auto",title:e.title,basePath:n.path,path:n.path+"#"+e.slug,children:e.children||[]}}))}]}function f(n){var e;return(n=n.map((function(n){return Object.assign({},n)}))).forEach((function(n){2===n.level?e=n:e&&(e.children||(e.children=[])).push(n)})),n.filter((function(n){return 2===n.level}))}function v(n){return Object.assign(n,{type:n.items&&n.items.length?"links":"link"})}function b(n){return Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase()}function y(n){var e=n.frontmatter.date||n.lastUpdated||new Date,t=new Date(e);return"Invalid Date"==t&&e&&(t=new Date(e.replace(/-/g,"/"))),t.getTime()}function x(n,e){return y(e)-y(n)}},function(n,e,t){"use strict";var r=t(1),i=t(59).map;r({target:"Array",proto:!0,forced:!t(75)("map")},{map:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var r=t(39),i=t(7),a=t(2),o=t(111),l=t(3),s=t(10),c=t(4),d=t(46),u=t(54),p=t(12),m=t(18),h=t(127),g=t(48),f=t(283),v=t(112),b=t(5)("replace"),y=Math.max,x=Math.min,T=a([].concat),k=a([].push),w=a("".indexOf),I=a("".slice),C="$0"==="a".replace(/./,"$0"),S=!!/./[b]&&""===/./[b]("a","$0");o("replace",(function(n,e,t){var a=S?"$":"$0";return[function(n,t){var r=m(this),a=null==n?void 0:g(n,b);return a?i(a,n,r,t):i(e,p(r),n,t)},function(n,i){var o=s(this),l=p(n);if("string"==typeof i&&-1===w(i,a)&&-1===w(i,"$<")){var m=t(e,o,l,i);if(m.done)return m.value}var g=c(i);g||(i=p(i));var b=o.global;if(b){var C=o.unicode;o.lastIndex=0}for(var S=[];;){var E=v(o,l);if(null===E)break;if(k(S,E),!b)break;""===p(E[0])&&(o.lastIndex=h(l,u(o.lastIndex),C))}for(var _,z="",A=0,P=0;P<S.length;P++){for(var R=p((E=S[P])[0]),B=y(x(d(E.index),l.length),0),j=[],D=1;D<E.length;D++)k(j,void 0===(_=E[D])?_:String(_));var M=E.groups;if(g){var L=T([R],j,B,l);void 0!==M&&k(L,M);var O=p(r(i,void 0,L))}else O=f(R,l,B,j,M,i);B>=A&&(z+=I(l,A,B)+O,A=B+R.length)}return z+I(l,A)}]}),!!l((function(){var n=/./;return n.exec=function(){var n=[];return n.groups={a:"7"},n},"7"!=="".replace(n,"$<a>")}))||!C||S)},function(n,e){var t=Math.ceil,r=Math.floor;n.exports=function(n){var e=+n;return e!=e||0===e?0:(e>0?r:t)(e)}},function(n,e,t){"use strict";var r=t(3);n.exports=function(n,e){var t=[][n];return!!t&&r((function(){t.call(null,e||function(){return 1},1)}))}},function(n,e,t){var r=t(22);n.exports=function(n,e){var t=n[e];return null==t?void 0:r(t)}},function(n,e){n.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(n,e){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,e,t){var r=t(17),i=t(114);(n.exports=function(n,e){return i[n]||(i[n]=void 0!==e?e:{})})("versions",[]).push({version:"3.22.2",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.2/LICENSE",source:"https://github.com/zloirock/core-js"})},function(n,e,t){var r=t(53),i=t(3);n.exports=!!Object.getOwnPropertySymbols&&!i((function(){var n=Symbol();return!String(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(n,e,t){var r,i,a=t(0),o=t(28),l=a.process,s=a.Deno,c=l&&l.versions||s&&s.version,d=c&&c.v8;d&&(i=(r=d.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),n.exports=i},function(n,e,t){var r=t(46),i=Math.min;n.exports=function(n){return n>0?i(r(n),9007199254740991):0}},function(n,e,t){var r=t(0);n.exports=r.Promise},function(n,e,t){"use strict";var r=t(87),i=t(13),a=t(49);n.exports=function(n,e,t){var o=r(e);o in n?i.f(n,o,a(0,t)):n[o]=t}},function(n,e,t){"use strict";var r=t(1),i=t(0),a=t(62),o=t(94),l=t(11),s=t(89),c=t(20),d=t(21),u=t(56),p=t(5),m=t(75),h=t(72),g=m("slice"),f=p("species"),v=i.Array,b=Math.max;r({target:"Array",proto:!0,forced:!g},{slice:function(n,e){var t,r,i,p=d(this),m=c(p),g=s(n,m),y=s(void 0===e?m:e,m);if(a(p)&&(t=p.constructor,(o(t)&&(t===v||a(t.prototype))||l(t)&&null===(t=t[f]))&&(t=void 0),t===v||void 0===t))return h(p,g,y);for(r=new(void 0===t?v:t)(b(y-g,0)),i=0;g<y;g++,i++)g in p&&u(r,i,p[g]);return r.length=i,r}})},function(n,e,t){var r=t(2),i=t(22),a=t(65),o=r(r.bind);n.exports=function(n,e){return i(n),void 0===e?n:a?o(n,e):function(){return n.apply(e,arguments)}}},function(n,e,t){var r=t(58),i=t(2),a=t(64),o=t(16),l=t(20),s=t(108),c=i([].push),d=function(n){var e=1==n,t=2==n,i=3==n,d=4==n,u=6==n,p=7==n,m=5==n||u;return function(h,g,f,v){for(var b,y,x=o(h),T=a(x),k=r(g,f),w=l(T),I=0,C=v||s,S=e?C(h,w):t||p?C(h,0):void 0;w>I;I++)if((m||I in T)&&(y=k(b=T[I],I,x),n))if(e)S[I]=y;else if(y)switch(n){case 3:return!0;case 5:return b;case 6:return I;case 2:c(S,b)}else switch(n){case 4:return!1;case 7:c(S,b)}return u?-1:i||d?d:S}};n.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},function(n,e,t){var r=t(160),i=t(117).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return r(n,i)}},function(n,e,t){var r=t(13).f,i=t(9),a=t(5)("toStringTag");n.exports=function(n,e,t){n&&!t&&(n=n.prototype),n&&!i(n,a)&&r(n,a,{configurable:!0,value:e})}},function(n,e,t){var r=t(23);n.exports=Array.isArray||function(n){return"Array"==r(n)}},function(n,e,t){var r=t(76),i=t(287),a=t(288),o=r?r.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":o&&o in Object(n)?i(n):a(n)}},function(n,e,t){var r=t(0),i=t(2),a=t(3),o=t(23),l=r.Object,s=i("".split);n.exports=a((function(){return!l("z").propertyIsEnumerable(0)}))?function(n){return"String"==o(n)?s(n,""):l(n)}:l},function(n,e,t){var r=t(3);n.exports=!r((function(){var n=function(){}.bind();return"function"!=typeof n||n.hasOwnProperty("prototype")}))},function(n,e,t){var r=t(0),i=t(15),a=t(4),o=t(36),l=t(156),s=r.Object;n.exports=l?function(n){return"symbol"==typeof n}:function(n){var e=i("Symbol");return a(e)&&o(e.prototype,s(n))}},function(n,e,t){var r=t(0).String;n.exports=function(n){try{return r(n)}catch(n){return"Object"}}},function(n,e){n.exports={}},function(n,e){n.exports={}},function(n,e,t){var r=t(8),i=t(9),a=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,l=i(a,"name"),s=l&&"something"===function(){}.name,c=l&&(!r||r&&o(a,"name").configurable);n.exports={EXISTS:l,PROPER:s,CONFIGURABLE:c}},function(n,e,t){var r=t(2),i=t(10),a=t(244);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,e=!1,t={};try{(n=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),e=t instanceof Array}catch(n){}return function(t,r){return i(t),a(r),e?n(t,r):t.__proto__=r,t}}():void 0)},function(n,e,t){var r=t(2);n.exports=r([].slice)},function(n,e,t){var r=t(0),i=t(55),a=t(4),o=t(106),l=t(91),s=t(5),c=t(252),d=t(17),u=t(53),p=i&&i.prototype,m=s("species"),h=!1,g=a(r.PromiseRejectionEvent),f=o("Promise",(function(){var n=l(i),e=n!==String(i);if(!e&&66===u)return!0;if(d&&(!p.catch||!p.finally))return!0;if(u>=51&&/native code/.test(n))return!1;var t=new i((function(n){n(1)})),r=function(n){n((function(){}),(function(){}))};return(t.constructor={})[m]=r,!(h=t.then((function(){}))instanceof r)||!e&&c&&!g}));n.exports={CONSTRUCTOR:f,REJECTION_EVENT:g,SUBCLASSING:h}},function(n,e,t){"use strict";var r=t(22),i=function(n){var e,t;this.promise=new n((function(n,r){if(void 0!==e||void 0!==t)throw TypeError("Bad Promise constructor");e=n,t=r})),this.resolve=r(e),this.reject=r(t)};n.exports.f=function(n){return new i(n)}},function(n,e,t){var r=t(3),i=t(5),a=t(53),o=i("species");n.exports=function(n){return a>=51||!r((function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[n](Boolean).foo}))}},function(n,e,t){var r=t(29).Symbol;n.exports=r},function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));t(84);var r=t(78);t(83),t(96),t(6),t(126),t(25),t(32),t(187);var i=t(103);t(40),t(26);function a(n){return function(n){if(Array.isArray(n))return Object(r.a)(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||Object(i.a)(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,e,t){"use strict";function r(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}t.d(e,"a",(function(){return r}))},function(n,e,t){"use strict";var r=t(1),i=t(0),a=t(3),o=t(62),l=t(11),s=t(16),c=t(20),d=t(56),u=t(108),p=t(75),m=t(5),h=t(53),g=m("isConcatSpreadable"),f=i.TypeError,v=h>=51||!a((function(){var n=[];return n[g]=!1,n.concat()[0]!==n})),b=p("concat"),y=function(n){if(!l(n))return!1;var e=n[g];return void 0!==e?!!e:o(n)};r({target:"Array",proto:!0,forced:!v||!b},{concat:function(n){var e,t,r,i,a,o=s(this),l=u(o,0),p=0;for(e=-1,r=arguments.length;e<r;e++)if(y(a=-1===e?o:arguments[e])){if(p+(i=c(a))>9007199254740991)throw f("Maximum allowed index exceeded");for(t=0;t<i;t++,p++)t in a&&d(l,p,a[t])}else{if(p>=9007199254740991)throw f("Maximum allowed index exceeded");d(l,p++,a)}return l.length=p,l}})},function(n,e,t){"use strict";var r=t(1),i=t(2),a=t(116).indexOf,o=t(47),l=i([].indexOf),s=!!l&&1/l([1],1,-0)<0,c=o("indexOf");r({target:"Array",proto:!0,forced:s||!c},{indexOf:function(n){var e=arguments.length>1?arguments[1]:void 0;return s?l(this,n,e)||0:a(this,n,e)}})},function(n,e,t){"use strict";t(19);var r,i,a=t(1),o=t(0),l=t(7),s=t(2),c=t(4),d=t(11),u=(r=!1,(i=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&r),p=o.Error,m=s(/./.test);a({target:"RegExp",proto:!0,forced:!u},{test:function(n){var e=this.exec;if(!c(e))return m(this,n);var t=l(e,this,n);if(null!==t&&!d(t))throw new p("RegExp exec method returned something other than an Object or null");return!!t}})},function(n,e,t){var r=t(0),i=t(122),a=t(4),o=t(23),l=t(5)("toStringTag"),s=r.Object,c="Arguments"==o(function(){return arguments}());n.exports=i?o:function(n){var e,t,r;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(t=function(n,e){try{return n[e]}catch(n){}}(e=s(n),l))?t:c?o(e):"Object"==(r=o(e))&&a(e.callee)?"Arguments":r}},function(n,e,t){t(270),t(273),t(274),t(125),t(275)},function(n,e,t){t(1)({target:"Array",stat:!0},{isArray:t(62)})},function(n,e,t){var r=t(2),i=0,a=Math.random(),o=r(1..toString);n.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+o(++i+a,36)}},function(n,e,t){var r=t(0),i=t(11),a=r.document,o=i(a)&&i(a.createElement);n.exports=function(n){return o?a.createElement(n):{}}},function(n,e,t){var r=t(159),i=t(66);n.exports=function(n){var e=r(n,"string");return i(e)?e:e+""}},function(n,e,t){var r=t(160),i=t(117);n.exports=Object.keys||function(n){return r(n,i)}},function(n,e,t){var r=t(46),i=Math.max,a=Math.min;n.exports=function(n,e){var t=r(n);return t<0?i(t+e,0):a(t,e)}},function(n,e,t){var r=t(51),i=t(85),a=r("keys");n.exports=function(n){return a[n]||(a[n]=i(n))}},function(n,e,t){var r=t(2),i=t(4),a=t(114),o=r(Function.toString);i(a.inspectSource)||(a.inspectSource=function(n){return o(n)}),n.exports=a.inspectSource},function(n,e){e.f=Object.getOwnPropertySymbols},function(n,e,t){var r=t(23),i=t(0);n.exports="process"==r(i.process)},function(n,e,t){var r=t(2),i=t(3),a=t(4),o=t(82),l=t(15),s=t(91),c=function(){},d=[],u=l("Reflect","construct"),p=/^\s*(?:class|function)\b/,m=r(p.exec),h=!p.exec(c),g=function(n){if(!a(n))return!1;try{return u(c,d,n),!0}catch(n){return!1}},f=function(n){if(!a(n))return!1;switch(o(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!m(p,s(n))}catch(n){return!0}};f.sham=!0,n.exports=!u||i((function(){var n;return g(g.call)||!g(Object)||!g((function(){n=!0}))||n}))?f:g},function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));t(6);function r(n,e,t,r,i,a,o){try{var l=n[a](o),s=l.value}catch(n){return void t(n)}l.done?e(s):Promise.resolve(s).then(r,i)}function i(n){return function(){var e=this,t=arguments;return new Promise((function(i,a){var o=n.apply(e,t);function l(n){r(o,i,a,l,s,"next",n)}function s(n){r(o,i,a,l,s,"throw",n)}l(void 0)}))}}},function(n,e,t){"use strict";var r=t(1),i=t(8),a=t(0),o=t(2),l=t(9),s=t(4),c=t(36),d=t(12),u=t(13).f,p=t(119),m=a.Symbol,h=m&&m.prototype;if(i&&s(m)&&(!("description"in h)||void 0!==m().description)){var g={},f=function(){var n=arguments.length<1||void 0===arguments[0]?void 0:d(arguments[0]),e=c(h,this)?new m(n):void 0===n?m():m(n);return""===n&&(g[e]=!0),e};p(f,m),f.prototype=h,h.constructor=f;var v="Symbol(test)"==String(m("test")),b=o(h.toString),y=o(h.valueOf),x=/^Symbol\((.*)\)[^)]+$/,T=o("".replace),k=o("".slice);u(h,"description",{configurable:!0,get:function(){var n=y(this),e=b(n);if(l(g,n))return"";var t=v?k(e,7,-1):T(e,x,"$1");return""===t?void 0:t}}),r({global:!0,forced:!0},{Symbol:f})}},function(n,e,t){"use strict";var r,i,a=t(7),o=t(2),l=t(12),s=t(188),c=t(110),d=t(51),u=t(35),p=t(37).get,m=t(226),h=t(232),g=d("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,v=f,b=o("".charAt),y=o("".indexOf),x=o("".replace),T=o("".slice),k=(i=/b*/g,a(f,r=/a/,"a"),a(f,i,"a"),0!==r.lastIndex||0!==i.lastIndex),w=c.BROKEN_CARET,I=void 0!==/()??/.exec("")[1];(k||I||w||m||h)&&(v=function(n){var e,t,r,i,o,c,d,m=this,h=p(m),C=l(n),S=h.raw;if(S)return S.lastIndex=m.lastIndex,e=a(v,S,C),m.lastIndex=S.lastIndex,e;var E=h.groups,_=w&&m.sticky,z=a(s,m),A=m.source,P=0,R=C;if(_&&(z=x(z,"y",""),-1===y(z,"g")&&(z+="g"),R=T(C,m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==b(C,m.lastIndex-1))&&(A="(?: "+A+")",R=" "+R,P++),t=new RegExp("^(?:"+A+")",z)),I&&(t=new RegExp("^"+A+"$(?!\\s)",z)),k&&(r=m.lastIndex),i=a(f,_?t:m,R),_?i?(i.input=T(i.input,P),i[0]=T(i[0],P),i.index=m.lastIndex,m.lastIndex+=i[0].length):m.lastIndex=0:k&&i&&(m.lastIndex=m.global?i.index+i[0].length:r),I&&i&&i.length>1&&a(g,i[0],t,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&E)for(i.groups=c=u(null),o=0;o<E.length;o++)c[(d=E[o])[0]]=i[d[1]];return i}),n.exports=v},function(n,e,t){var r=t(292),i=t(293),a=t(294),o=t(295),l=t(296);function s(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,n.exports=s},function(n,e,t){var r=t(194);n.exports=function(n,e){for(var t=n.length;t--;)if(r(n[t][0],e))return t;return-1}},function(n,e,t){var r=t(41)(Object,"create");n.exports=r},function(n,e,t){var r=t(314);n.exports=function(n,e){var t=n.__data__;return r(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(n,e,t){var r=t(135);n.exports=function(n){if("string"==typeof n||r(n))return n;var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));t(57),t(6),t(109),t(187),t(25),t(19),t(81);var r=t(78);function i(n,e){if(n){if("string"==typeof n)return Object(r.a)(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Object(r.a)(n,e):void 0}}},function(n,e,t){var r,i;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(i="function"==typeof(r=function(){var n,e,t={version:"0.2.0"},r=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function i(n,e,t){return n<e?e:n>t?t:n}function a(n){return 100*(-1+n)}t.configure=function(n){var e,t;for(e in n)void 0!==(t=n[e])&&n.hasOwnProperty(e)&&(r[e]=t);return this},t.status=null,t.set=function(n){var e=t.isStarted();n=i(n,r.minimum,1),t.status=1===n?null:n;var s=t.render(!e),c=s.querySelector(r.barSelector),d=r.speed,u=r.easing;return s.offsetWidth,o((function(e){""===r.positionUsing&&(r.positionUsing=t.getPositioningCSS()),l(c,function(n,e,t){var i;return(i="translate3d"===r.positionUsing?{transform:"translate3d("+a(n)+"%,0,0)"}:"translate"===r.positionUsing?{transform:"translate("+a(n)+"%,0)"}:{"margin-left":a(n)+"%"}).transition="all "+e+"ms "+t,i}(n,d,u)),1===n?(l(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout((function(){l(s,{transition:"all "+d+"ms linear",opacity:0}),setTimeout((function(){t.remove(),e()}),d)}),d)):setTimeout(e,d)})),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout((function(){t.status&&(t.trickle(),n())}),r.trickleSpeed)};return r.trickle&&n(),this},t.done=function(n){return n||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(n){var e=t.status;return e?("number"!=typeof n&&(n=(1-e)*i(Math.random()*e,.1,.95)),e=i(e+n,0,.994),t.set(e)):t.start()},t.trickle=function(){return t.inc(Math.random()*r.trickleRate)},n=0,e=0,t.promise=function(r){return r&&"resolved"!==r.state()?(0===e&&t.start(),n++,e++,r.always((function(){0==--e?(n=0,t.done()):t.set((n-e)/n)})),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");c(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=r.template;var i,o=e.querySelector(r.barSelector),s=n?"-100":a(t.status||0),d=document.querySelector(r.parent);return l(o,{transition:"all 0 linear",transform:"translate3d("+s+"%,0,0)"}),r.showSpinner||(i=e.querySelector(r.spinnerSelector))&&p(i),d!=document.body&&c(d,"nprogress-custom-parent"),d.appendChild(e),e},t.remove=function(){d(document.documentElement,"nprogress-busy"),d(document.querySelector(r.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&p(n)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var n=document.body.style,e="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return e+"Perspective"in n?"translate3d":e+"Transform"in n?"translate":"margin"};var o=function(){var n=[];function e(){var t=n.shift();t&&t(e)}return function(t){n.push(t),1==n.length&&e()}}(),l=function(){var n=["Webkit","O","Moz","ms"],e={};function t(t){return t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,e){return e.toUpperCase()})),e[t]||(e[t]=function(e){var t=document.body.style;if(e in t)return e;for(var r,i=n.length,a=e.charAt(0).toUpperCase()+e.slice(1);i--;)if((r=n[i]+a)in t)return r;return e}(t))}function r(n,e,r){e=t(e),n.style[e]=r}return function(n,e){var t,i,a=arguments;if(2==a.length)for(t in e)void 0!==(i=e[t])&&e.hasOwnProperty(t)&&r(n,t,i);else r(n,a[1],a[2])}}();function s(n,e){return("string"==typeof n?n:u(n)).indexOf(" "+e+" ")>=0}function c(n,e){var t=u(n),r=t+e;s(t,e)||(n.className=r.substring(1))}function d(n,e){var t,r=u(n);s(n,e)&&(t=r.replace(" "+e+" "," "),n.className=t.substring(1,t.length-1))}function u(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function p(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return t})?r.call(e,t,e,n):r)||(n.exports=i)},function(n,e,t){var r=t(1),i=t(16),a=t(88);r({target:"Object",stat:!0,forced:t(3)((function(){a(1)}))},{keys:function(n){return a(i(n))}})},function(n,e,t){var r=t(3),i=t(4),a=/#|\.prototype\./,o=function(n,e){var t=s[l(n)];return t==d||t!=c&&(i(e)?r(e):!!e)},l=o.normalize=function(n){return String(n).replace(a,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",d=o.POLYFILL="P";n.exports=o},function(n,e,t){var r=t(82),i=t(48),a=t(69),o=t(5)("iterator");n.exports=function(n){if(null!=n)return i(n,o)||i(n,"@@iterator")||a[r(n)]}},function(n,e,t){var r=t(262);n.exports=function(n,e){return new(r(n))(0===e?0:e)}},function(n,e,t){var r=t(8),i=t(70).EXISTS,a=t(2),o=t(13).f,l=Function.prototype,s=a(l.toString),c=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,d=a(c.exec);r&&!i&&o(l,"name",{configurable:!0,get:function(){try{return d(c,s(this))[1]}catch(n){return""}}})},function(n,e,t){var r=t(3),i=t(0).RegExp,a=r((function(){var n=i("a","y");return n.lastIndex=2,null!=n.exec("abcd")})),o=a||r((function(){return!i("a","y").sticky})),l=a||r((function(){var n=i("^r","gy");return n.lastIndex=2,null!=n.exec("str")}));n.exports={BROKEN_CARET:l,MISSED_STICKY:o,UNSUPPORTED_Y:a}},function(n,e,t){"use strict";t(19);var r=t(2),i=t(14),a=t(97),o=t(3),l=t(5),s=t(24),c=l("species"),d=RegExp.prototype;n.exports=function(n,e,t,u){var p=l(n),m=!o((function(){var e={};return e[p]=function(){return 7},7!=""[n](e)})),h=m&&!o((function(){var e=!1,t=/a/;return"split"===n&&((t={}).constructor={},t.constructor[c]=function(){return t},t.flags="",t[p]=/./[p]),t.exec=function(){return e=!0,null},t[p](""),!e}));if(!m||!h||t){var g=r(/./[p]),f=e(p,""[n],(function(n,e,t,i,o){var l=r(n),s=e.exec;return s===a||s===d.exec?m&&!o?{done:!0,value:g(e,t,i)}:{done:!0,value:l(t,e,i)}:{done:!1}}));i(String.prototype,n,f[0]),i(d,p,f[1])}u&&s(d[p],"sham",!0)}},function(n,e,t){var r=t(0),i=t(7),a=t(10),o=t(4),l=t(23),s=t(97),c=r.TypeError;n.exports=function(n,e){var t=n.exec;if(o(t)){var r=i(t,n,e);return null!==r&&a(r),r}if("RegExp"===l(n))return i(s,n,e);throw c("RegExp#exec called on incompatible receiver")}},function(n,e,t){"use strict";var r=t(1),i=t(2),a=t(64),o=t(21),l=t(47),s=i([].join),c=a!=Object,d=l("join",",");r({target:"Array",proto:!0,forced:c||!d},{join:function(n){return s(o(this),void 0===n?",":n)}})},function(n,e,t){var r=t(0),i=t(115),a=r["__core-js_shared__"]||i("__core-js_shared__",{});n.exports=a},function(n,e,t){var r=t(0),i=Object.defineProperty;n.exports=function(n,e){try{i(r,n,{value:e,configurable:!0,writable:!0})}catch(t){r[n]=e}return e}},function(n,e,t){var r=t(21),i=t(89),a=t(20),o=function(n){return function(e,t,o){var l,s=r(e),c=a(s),d=i(o,c);if(n&&t!=t){for(;c>d;)if((l=s[d++])!=l)return!0}else for(;c>d;d++)if((n||d in s)&&s[d]===t)return n||d||0;return!n&&-1}};n.exports={includes:o(!0),indexOf:o(!1)}},function(n,e){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,e,t){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!r.call({1:2},1);e.f=a?function(n){var e=i(this,n);return!!e&&e.enumerable}:r},function(n,e,t){var r=t(9),i=t(163),a=t(38),o=t(13);n.exports=function(n,e,t){for(var l=i(e),s=o.f,c=a.f,d=0;d<l.length;d++){var u=l[d];r(n,u)||t&&r(t,u)||s(n,u,c(e,u))}}},function(n,e,t){var r=t(0),i=t(9),a=t(4),o=t(16),l=t(90),s=t(165),c=l("IE_PROTO"),d=r.Object,u=d.prototype;n.exports=s?d.getPrototypeOf:function(n){var e=o(n);if(i(e,c))return e[c];var t=e.constructor;return a(t)&&e instanceof t?t.prototype:e instanceof d?u:null}},function(n,e,t){var r=t(10),i=t(166),a=t(5)("species");n.exports=function(n,e){var t,o=r(n).constructor;return void 0===o||null==(t=r(o)[a])?e:i(t)}},function(n,e,t){var r={};r[t(5)("toStringTag")]="z",n.exports="[object z]"===String(r)},function(n,e){n.exports=function(n){try{return{error:!1,value:n()}}catch(n){return{error:!0,value:n}}}},function(n,e,t){var r=t(0),i=t(89),a=t(20),o=t(56),l=r.Array,s=Math.max;n.exports=function(n,e,t){for(var r=a(n),c=i(e,r),d=i(void 0===t?r:t,r),u=l(s(d-c,0)),p=0;c<d;c++,p++)o(u,p,n[c]);return u.length=p,u}},function(n,e,t){var r=t(1),i=t(15),a=t(39),o=t(7),l=t(2),s=t(3),c=t(62),d=t(4),u=t(11),p=t(66),m=t(72),h=t(52),g=i("JSON","stringify"),f=l(/./.exec),v=l("".charAt),b=l("".charCodeAt),y=l("".replace),x=l(1..toString),T=/[\uD800-\uDFFF]/g,k=/^[\uD800-\uDBFF]$/,w=/^[\uDC00-\uDFFF]$/,I=!h||s((function(){var n=i("Symbol")();return"[null]"!=g([n])||"{}"!=g({a:n})||"{}"!=g(Object(n))})),C=s((function(){return'"\\udf06\\ud834"'!==g("\udf06\ud834")||'"\\udead"'!==g("\udead")})),S=function(n,e){var t=m(arguments),r=e;if((u(e)||void 0!==n)&&!p(n))return c(e)||(e=function(n,e){if(d(r)&&(e=o(r,this,n,e)),!p(e))return e}),t[1]=e,a(g,null,t)},E=function(n,e,t){var r=v(t,e-1),i=v(t,e+1);return f(k,n)&&!f(w,i)||f(w,n)&&!f(k,r)?"\\u"+x(b(n,0),16):n};g&&r({target:"JSON",stat:!0,forced:I||C},{stringify:function(n,e,t){var r=m(arguments),i=a(I?S:g,null,r);return C&&"string"==typeof i?y(i,T,E):i}})},function(n,e,t){t(185)("iterator")},function(n,e,t){"use strict";var r=t(175).charAt;n.exports=function(n,e,t){return e+(t?r(n,e).length:1)}},function(n,e,t){var r=t(286),i=t(50),a=Object.prototype,o=a.hasOwnProperty,l=a.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(n){return i(n)&&o.call(n,"callee")&&!l.call(n,"callee")};n.exports=s},function(n,e,t){var r=t(41)(t(29),"Map");n.exports=r},function(n,e){n.exports=function(n){var e=typeof n;return null!=n&&("object"==e||"function"==e)}},function(n,e,t){var r=t(306),i=t(313),a=t(315),o=t(316),l=t(317);function s(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,n.exports=s},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n){t[++e]=n})),t}},function(n,e){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,e,t){var r=t(27),i=t(135),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;n.exports=function(n,e){if(r(n))return!1;var t=typeof n;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=n&&!i(n))||(o.test(n)||!a.test(n)||null!=e&&n in Object(e))}},function(n,e,t){var r=t(63),i=t(50);n.exports=function(n){return"symbol"==typeof n||i(n)&&"[object Symbol]"==r(n)}},function(n,e){n.exports=function(n){return n}},function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));t(84);t(83),t(96),t(6),t(126),t(25),t(32);var r=t(103);t(40),t(26);function i(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,i,a=[],o=!0,l=!1;try{for(t=t.call(n);!(o=(r=t.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(n){l=!0,i=n}finally{try{o||null==t.return||t.return()}finally{if(l)throw i}}return a}}(n,e)||Object(r.a)(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,e,t){"use strict";var r=t(39),i=t(7),a=t(2),o=t(111),l=t(149),s=t(10),c=t(18),d=t(121),u=t(127),p=t(54),m=t(12),h=t(48),g=t(124),f=t(112),v=t(97),b=t(110),y=t(3),x=b.UNSUPPORTED_Y,T=Math.min,k=[].push,w=a(/./.exec),I=a(k),C=a("".slice);o("split",(function(n,e,t){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(n,t){var a=m(c(this)),o=void 0===t?4294967295:t>>>0;if(0===o)return[];if(void 0===n)return[a];if(!l(n))return i(e,a,n,o);for(var s,d,u,p=[],h=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),f=0,b=new RegExp(n.source,h+"g");(s=i(v,b,a))&&!((d=b.lastIndex)>f&&(I(p,C(a,f,s.index)),s.length>1&&s.index<a.length&&r(k,p,g(s,1)),u=s[0].length,f=d,p.length>=o));)b.lastIndex===s.index&&b.lastIndex++;return f===a.length?!u&&w(b,"")||I(p,""):I(p,C(a,f)),p.length>o?g(p,0,o):p}:"0".split(void 0,0).length?function(n,t){return void 0===n&&0===t?[]:i(e,this,n,t)}:e,[function(e,t){var r=c(this),o=null==e?void 0:h(e,n);return o?i(o,e,r,t):i(a,m(r),e,t)},function(n,r){var i=s(this),o=m(n),l=t(a,i,o,r,a!==e);if(l.done)return l.value;var c=d(i,RegExp),h=i.unicode,g=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(x?"g":"y"),v=new c(x?"^(?:"+i.source+")":i,g),b=void 0===r?4294967295:r>>>0;if(0===b)return[];if(0===o.length)return null===f(v,o)?[o]:[];for(var y=0,k=0,w=[];k<o.length;){v.lastIndex=x?0:k;var S,E=f(v,x?C(o,k):o);if(null===E||(S=T(p(v.lastIndex+(x?k:0)),o.length))===y)k=u(o,k,h);else{if(I(w,C(o,y,k)),w.length===b)return w;for(var _=1;_<=E.length-1;_++)if(I(w,E[_]),w.length===b)return w;k=y=S}}return I(w,C(o,y)),w}]}),!!y((function(){var n=/(?:)/,e=n.exec;n.exec=function(){return e.apply(this,arguments)};var t="ab".split(n);return 2!==t.length||"a"!==t[0]||"b"!==t[1]})),x)},function(n,e,t){"use strict";var r=t(1),i=t(59).some;r({target:"Array",proto:!0,forced:!t(47)("some")},{some:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){"use strict";var r=t(7),i=t(111),a=t(10),o=t(54),l=t(12),s=t(18),c=t(48),d=t(127),u=t(112);i("match",(function(n,e,t){return[function(e){var t=s(this),i=null==e?void 0:c(e,n);return i?r(i,e,t):new RegExp(e)[n](l(t))},function(n){var r=a(this),i=l(n),s=t(e,r,i);if(s.done)return s.value;if(!r.global)return u(r,i);var c=r.unicode;r.lastIndex=0;for(var p,m=[],h=0;null!==(p=u(r,i));){var g=l(p[0]);m[h]=g,""===g&&(r.lastIndex=d(i,o(r.lastIndex),c)),h++}return 0===h?null:m}]}))},function(n,e,t){var r=t(5),i=t(35),a=t(13),o=r("unscopables"),l=Array.prototype;null==l[o]&&a.f(l,o,{configurable:!0,value:i(null)}),n.exports=function(n){l[o][n]=!0}},function(n,e,t){var r=function(n){"use strict";var e=Object.prototype,t=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function l(n,e,t){return Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),n[e]}try{l({},"")}catch(n){l=function(n,e,t){return n[e]=t}}function s(n,e,t,r){var i=e&&e.prototype instanceof u?e:u,a=Object.create(i.prototype),o=new w(r||[]);return a._invoke=function(n,e,t){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return C()}for(t.method=i,t.arg=a;;){var o=t.delegate;if(o){var l=x(o,t);if(l){if(l===d)continue;return l}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===r)throw r="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r="executing";var s=c(n,e,t);if("normal"===s.type){if(r=t.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:t.done}}"throw"===s.type&&(r="completed",t.method="throw",t.arg=s.arg)}}}(n,t,o),a}function c(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=s;var d={};function u(){}function p(){}function m(){}var h={};l(h,i,(function(){return this}));var g=Object.getPrototypeOf,f=g&&g(g(I([])));f&&f!==e&&t.call(f,i)&&(h=f);var v=m.prototype=u.prototype=Object.create(h);function b(n){["next","throw","return"].forEach((function(e){l(n,e,(function(n){return this._invoke(e,n)}))}))}function y(n,e){var r;this._invoke=function(i,a){function o(){return new e((function(r,o){!function r(i,a,o,l){var s=c(n[i],n,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==typeof u&&t.call(u,"__await")?e.resolve(u.__await).then((function(n){r("next",n,o,l)}),(function(n){r("throw",n,o,l)})):e.resolve(u).then((function(n){d.value=n,o(d)}),(function(n){return r("throw",n,o,l)}))}l(s.arg)}(i,a,r,o)}))}return r=r?r.then(o,o):o()}}function x(n,e){var t=n.iterator[e.method];if(void 0===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=void 0,x(n,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=c(t,n.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var i=r.arg;return i?i.done?(e[n.resultName]=i.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function T(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function k(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function w(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(T,this),this.reset(!0)}function I(n){if(n){var e=n[i];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,a=function e(){for(;++r<n.length;)if(t.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:C}}function C(){return{value:void 0,done:!0}}return p.prototype=m,l(v,"constructor",m),l(m,"constructor",p),p.displayName=l(m,o,"GeneratorFunction"),n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,m):(n.__proto__=m,l(n,o,"GeneratorFunction")),n.prototype=Object.create(v),n},n.awrap=function(n){return{__await:n}},b(y.prototype),l(y.prototype,a,(function(){return this})),n.AsyncIterator=y,n.async=function(e,t,r,i,a){void 0===a&&(a=Promise);var o=new y(s(e,t,r,i),a);return n.isGeneratorFunction(t)?o:o.next().then((function(n){return n.done?n.value:o.next()}))},b(v),l(v,o,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=I,w.prototype={constructor:w,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!n)for(var e in this)"t"===e.charAt(0)&&t.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function r(t,r){return o.type="throw",o.arg=n,e.next=t,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=t.call(a,"catchLoc"),s=t.call(a,"finallyLoc");if(l&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(n,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&t.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=n,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),d},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),k(t),d}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var r=t.completion;if("throw"===r.type){var i=r.arg;k(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,t){return this.delegate={iterator:I(n),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),d}},n}(n.exports);try{regeneratorRuntime=r}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(n,e,t){var r=t(1),i=t(8),a=t(13).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==a,sham:!i},{defineProperty:a})},function(n,e,t){"use strict";var r=t(70).PROPER,i=t(14),a=t(10),o=t(12),l=t(3),s=t(238),c=RegExp.prototype.toString,d=l((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=r&&"toString"!=c.name;(d||u)&&i(RegExp.prototype,"toString",(function(){var n=a(this);return"/"+o(n.source)+"/"+o(s(n))}),{unsafe:!0})},function(n,e,t){"use strict";var r=t(21),i=t(141),a=t(69),o=t(37),l=t(13).f,s=t(162),c=t(17),d=t(8),u=o.set,p=o.getterFor("Array Iterator");n.exports=s(Array,"Array",(function(n,e){u(this,{type:"Array Iterator",target:r(n),index:0,kind:e})}),(function(){var n=p(this),e=n.target,t=n.kind,r=n.index++;return!e||r>=e.length?(n.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:r,done:!1}:"values"==t?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values");var m=a.Arguments=a.Array;if(i("keys"),i("values"),i("entries"),!c&&d&&"values"!==m.name)try{l(m,"name",{value:"values"})}catch(n){}},function(n,e,t){var r=t(8),i=t(157),a=t(13),o=t(10),l=t(21),s=t(88);e.f=r&&!i?Object.defineProperties:function(n,e){o(n);for(var t,r=l(e),i=s(e),c=i.length,d=0;c>d;)a.f(n,t=i[d++],r[t]);return n}},function(n,e,t){var r=t(0).TypeError;n.exports=function(n,e){if(n<e)throw r("Not enough arguments");return n}},function(n,e,t){var r=t(0),i=t(7),a=t(22),o=t(10),l=t(67),s=t(107),c=r.TypeError;n.exports=function(n,e){var t=arguments.length<2?s(n):e;if(a(t))return o(i(t,n));throw c(l(n)+" is not iterable")}},function(n,e,t){var r=t(11),i=t(23),a=t(5)("match");n.exports=function(n){var e;return r(n)&&(void 0!==(e=n[a])?!!e:"RegExp"==i(n))}},function(n,e,t){var r=t(4),i=t(11),a=t(71);n.exports=function(n,e,t){var o,l;return a&&r(o=e.constructor)&&o!==t&&i(l=o.prototype)&&l!==t.prototype&&a(n,l),n}},function(n,e){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,e){var t=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,c=l||s||Function("return this")(),d=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return c.Date.now()};function h(n){var e=typeof n;return!!n&&("object"==e||"function"==e)}function g(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==d.call(n)}(n))return NaN;if(h(n)){var e="function"==typeof n.valueOf?n.valueOf():n;n=h(e)?e+"":e}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(t,"");var l=i.test(n);return l||a.test(n)?o(n.slice(2),l?2:8):r.test(n)?NaN:+n}n.exports=function(n,e,t){var r,i,a,o,l,s,c=0,d=!1,f=!1,v=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function b(e){var t=r,a=i;return r=i=void 0,c=e,o=n.apply(a,t)}function y(n){return c=n,l=setTimeout(T,e),d?b(n):o}function x(n){var t=n-s;return void 0===s||t>=e||t<0||f&&n-c>=a}function T(){var n=m();if(x(n))return k(n);l=setTimeout(T,function(n){var t=e-(n-s);return f?p(t,a-(n-c)):t}(n))}function k(n){return l=void 0,v&&r?b(n):(r=i=void 0,o)}function w(){var n=m(),t=x(n);if(r=arguments,i=this,s=n,t){if(void 0===l)return y(s);if(f)return l=setTimeout(T,e),b(s)}return void 0===l&&(l=setTimeout(T,e)),o}return e=g(e)||0,h(t)&&(d=!!t.leading,a=(f="maxWait"in t)?u(g(t.maxWait)||0,e):a,v="trailing"in t?!!t.trailing:v),w.cancel=function(){void 0!==l&&clearTimeout(l),c=0,r=s=i=l=void 0},w.flush=function(){return void 0===l?o:k(m())},w}},function(n,e,t){var r=t(2),i=t(18),a=t(12),o=t(154),l=r("".replace),s="["+o+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(n){return function(e){var t=a(i(e));return 1&n&&(t=l(t,c,"")),2&n&&(t=l(t,d,"")),t}};n.exports={start:u(1),end:u(2),trim:u(3)}},function(n,e){n.exports="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff"},function(n,e,t){var r=t(2),i=t(14),a=Date.prototype,o=r(a.toString),l=r(a.getTime);"Invalid Date"!=String(new Date(NaN))&&i(a,"toString",(function(){var n=l(this);return n==n?o(this):"Invalid Date"}))},function(n,e,t){var r=t(52);n.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(n,e,t){var r=t(8),i=t(3);n.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(n,e,t){var r=t(8),i=t(3),a=t(86);n.exports=!r&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(n,e,t){var r=t(0),i=t(7),a=t(11),o=t(66),l=t(48),s=t(242),c=t(5),d=r.TypeError,u=c("toPrimitive");n.exports=function(n,e){if(!a(n)||o(n))return n;var t,r=l(n,u);if(r){if(void 0===e&&(e="default"),t=i(r,n,e),!a(t)||o(t))return t;throw d("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(n,e)}},function(n,e,t){var r=t(2),i=t(9),a=t(21),o=t(116).indexOf,l=t(68),s=r([].push);n.exports=function(n,e){var t,r=a(n),c=0,d=[];for(t in r)!i(l,t)&&i(r,t)&&s(d,t);for(;e.length>c;)i(r,t=e[c++])&&(~o(d,t)||s(d,t));return d}},function(n,e,t){var r=t(15);n.exports=r("document","documentElement")},function(n,e,t){"use strict";var r=t(1),i=t(7),a=t(17),o=t(70),l=t(4),s=t(227),c=t(120),d=t(71),u=t(61),p=t(24),m=t(14),h=t(5),g=t(69),f=t(164),v=o.PROPER,b=o.CONFIGURABLE,y=f.IteratorPrototype,x=f.BUGGY_SAFARI_ITERATORS,T=h("iterator"),k=function(){return this};n.exports=function(n,e,t,o,h,f,w){s(t,e,o);var I,C,S,E=function(n){if(n===h&&R)return R;if(!x&&n in A)return A[n];switch(n){case"keys":case"values":case"entries":return function(){return new t(this,n)}}return function(){return new t(this)}},_=e+" Iterator",z=!1,A=n.prototype,P=A[T]||A["@@iterator"]||h&&A[h],R=!x&&P||E(h),B="Array"==e&&A.entries||P;if(B&&(I=c(B.call(new n)))!==Object.prototype&&I.next&&(a||c(I)===y||(d?d(I,y):l(I[T])||m(I,T,k)),u(I,_,!0,!0),a&&(g[_]=k)),v&&"values"==h&&P&&"values"!==P.name&&(!a&&b?p(A,"name","values"):(z=!0,R=function(){return i(P,this)})),h)if(C={values:E("values"),keys:f?R:E("keys"),entries:E("entries")},w)for(S in C)(x||z||!(S in A))&&m(A,S,C[S]);else r({target:e,proto:!0,forced:x||z},C);return a&&!w||A[T]===R||m(A,T,R,{name:h}),g[e]=R,C}},function(n,e,t){var r=t(15),i=t(2),a=t(60),o=t(92),l=t(10),s=i([].concat);n.exports=r("Reflect","ownKeys")||function(n){var e=a.f(l(n)),t=o.f;return t?s(e,t(n)):e}},function(n,e,t){"use strict";var r,i,a,o=t(3),l=t(4),s=t(35),c=t(120),d=t(14),u=t(5),p=t(17),m=u("iterator"),h=!1;[].keys&&("next"in(a=[].keys())?(i=c(c(a)))!==Object.prototype&&(r=i):h=!0),null==r||o((function(){var n={};return r[m].call(n)!==n}))?r={}:p&&(r=s(r)),l(r[m])||d(r,m,(function(){return this})),n.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(n,e,t){var r=t(3);n.exports=!r((function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}))},function(n,e,t){var r=t(0),i=t(94),a=t(67),o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not a constructor")}},function(n,e,t){var r,i,a,o,l=t(0),s=t(39),c=t(58),d=t(4),u=t(9),p=t(3),m=t(161),h=t(72),g=t(86),f=t(147),v=t(168),b=t(93),y=l.setImmediate,x=l.clearImmediate,T=l.process,k=l.Dispatch,w=l.Function,I=l.MessageChannel,C=l.String,S=0,E={};try{r=l.location}catch(n){}var _=function(n){if(u(E,n)){var e=E[n];delete E[n],e()}},z=function(n){return function(){_(n)}},A=function(n){_(n.data)},P=function(n){l.postMessage(C(n),r.protocol+"//"+r.host)};y&&x||(y=function(n){f(arguments.length,1);var e=d(n)?n:w(n),t=h(arguments,1);return E[++S]=function(){s(e,void 0,t)},i(S),S},x=function(n){delete E[n]},b?i=function(n){T.nextTick(z(n))}:k&&k.now?i=function(n){k.now(z(n))}:I&&!v?(o=(a=new I).port2,a.port1.onmessage=A,i=c(o.postMessage,o)):l.addEventListener&&d(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!p(P)?(i=P,l.addEventListener("message",A,!1)):i="onreadystatechange"in g("script")?function(n){m.appendChild(g("script")).onreadystatechange=function(){m.removeChild(this),_(n)}}:function(n){setTimeout(z(n),0)}),n.exports={set:y,clear:x}},function(n,e,t){var r=t(28);n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(n,e,t){var r=t(0),i=t(58),a=t(7),o=t(10),l=t(67),s=t(170),c=t(20),d=t(36),u=t(148),p=t(107),m=t(171),h=r.TypeError,g=function(n,e){this.stopped=n,this.result=e},f=g.prototype;n.exports=function(n,e,t){var r,v,b,y,x,T,k,w=t&&t.that,I=!(!t||!t.AS_ENTRIES),C=!(!t||!t.IS_ITERATOR),S=!(!t||!t.INTERRUPTED),E=i(e,w),_=function(n){return r&&m(r,"normal",n),new g(!0,n)},z=function(n){return I?(o(n),S?E(n[0],n[1],_):E(n[0],n[1])):S?E(n,_):E(n)};if(C)r=n;else{if(!(v=p(n)))throw h(l(n)+" is not iterable");if(s(v)){for(b=0,y=c(n);y>b;b++)if((x=z(n[b]))&&d(f,x))return x;return new g(!1)}r=u(n,v)}for(T=r.next;!(k=a(T,r)).done;){try{x=z(k.value)}catch(n){m(r,"throw",n)}if("object"==typeof x&&x&&d(f,x))return x}return new g(!1)}},function(n,e,t){var r=t(5),i=t(69),a=r("iterator"),o=Array.prototype;n.exports=function(n){return void 0!==n&&(i.Array===n||o[a]===n)}},function(n,e,t){var r=t(7),i=t(10),a=t(48);n.exports=function(n,e,t){var o,l;i(n);try{if(!(o=a(n,"return"))){if("throw"===e)throw t;return t}o=r(o,n)}catch(n){l=!0,o=n}if("throw"===e)throw t;if(l)throw o;return i(o),t}},function(n,e,t){var r=t(55),i=t(173),a=t(73).CONSTRUCTOR;n.exports=a||!i((function(n){r.all(n).then(void 0,(function(){}))}))},function(n,e,t){var r=t(5)("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(n){}n.exports=function(n,e){if(!e&&!i)return!1;var t=!1;try{var a={};a[r]=function(){return{next:function(){return{done:t=!0}}}},n(a)}catch(n){}return t}},function(n,e,t){var r=t(10),i=t(11),a=t(74);n.exports=function(n,e){if(r(n),i(e)&&e.constructor===n)return e;var t=a.f(n);return(0,t.resolve)(e),t.promise}},function(n,e,t){var r=t(2),i=t(46),a=t(12),o=t(18),l=r("".charAt),s=r("".charCodeAt),c=r("".slice),d=function(n){return function(e,t){var r,d,u=a(o(e)),p=i(t),m=u.length;return p<0||p>=m?n?"":void 0:(r=s(u,p))<55296||r>56319||p+1===m||(d=s(u,p+1))<56320||d>57343?n?l(u,p):r:n?c(u,p,p+2):d-56320+(r-55296<<10)+65536}};n.exports={codeAt:d(!1),charAt:d(!0)}},function(n,e){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,e,t){var r=t(86)("span").classList,i=r&&r.constructor&&r.constructor.prototype;n.exports=i===Object.prototype?void 0:i},function(n,e,t){var r=t(1),i=t(3),a=t(16),o=t(120),l=t(165);r({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!l},{getPrototypeOf:function(n){return o(a(n))}})},function(n,e,t){var r=t(0),i=t(149),a=r.TypeError;n.exports=function(n){if(i(n))throw a("The method doesn't accept regular expressions");return n}},function(n,e,t){var r=t(5)("match");n.exports=function(n){var e=/./;try{"/./"[n](e)}catch(t){try{return e[r]=!1,"/./"[n](e)}catch(n){}}return!1}},function(n,e,t){"use strict";var r=t(59).forEach,i=t(47)("forEach");n.exports=i?[].forEach:function(n){return r(this,n,arguments.length>1?arguments[1]:void 0)}},function(n,e,t){var r=t(3);n.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(n,e,t){var r=t(23),i=t(21),a=t(60).f,o=t(124),l="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(n){return l&&"Window"==r(n)?function(n){try{return a(n)}catch(n){return o(l)}}(n):a(i(n))}},function(n,e,t){var r=t(5);e.f=r},function(n,e,t){var r=t(271),i=t(9),a=t(184),o=t(13).f;n.exports=function(n){var e=r.Symbol||(r.Symbol={});i(e,n)||o(e,n,{value:a.f(n)})}},function(n,e,t){var r=t(52);n.exports=r&&!!Symbol.for&&!!Symbol.keyFor},function(n,e,t){var r=t(1),i=t(276);r({target:"Array",stat:!0,forced:!t(173)((function(n){Array.from(n)}))},{from:i})},function(n,e,t){"use strict";var r=t(10);n.exports=function(){var n=r(this),e="";return n.hasIndices&&(e+="d"),n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.sticky&&(e+="y"),e}},function(n,e,t){var r=t(12);n.exports=function(n,e){return void 0===n?arguments.length<2?"":e:r(n)}},function(n,e,t){t(1)({target:"Object",stat:!0,sham:!t(8)},{create:t(35)})},function(n,e){n.exports=function(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}},function(n,e){var t="object"==typeof global&&global&&global.Object===Object&&global;n.exports=t},function(n,e,t){var r=t(98),i=t(297),a=t(298),o=t(299),l=t(300),s=t(301);function c(n){var e=this.__data__=new r(n);this.size=e.size}c.prototype.clear=i,c.prototype.delete=a,c.prototype.get=o,c.prototype.has=l,c.prototype.set=s,n.exports=c},function(n,e){n.exports=function(n,e){return n===e||n!=n&&e!=e}},function(n,e,t){var r=t(63),i=t(130);n.exports=function(n){if(!i(n))return!1;var e=r(n);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,e){var t=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return t.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,e,t){var r=t(318),i=t(50);n.exports=function n(e,t,a,o,l){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!=e&&t!=t:r(e,t,a,o,n,l))}},function(n,e,t){var r=t(199),i=t(321),a=t(200);n.exports=function(n,e,t,o,l,s){var c=1&t,d=n.length,u=e.length;if(d!=u&&!(c&&u>d))return!1;var p=s.get(n),m=s.get(e);if(p&&m)return p==e&&m==n;var h=-1,g=!0,f=2&t?new r:void 0;for(s.set(n,e),s.set(e,n);++h<d;){var v=n[h],b=e[h];if(o)var y=c?o(b,v,h,e,n,s):o(v,b,h,n,e,s);if(void 0!==y){if(y)continue;g=!1;break}if(f){if(!i(e,(function(n,e){if(!a(f,e)&&(v===n||l(v,n,t,o,s)))return f.push(e)}))){g=!1;break}}else if(v!==b&&!l(v,b,t,o,s)){g=!1;break}}return s.delete(n),s.delete(e),g}},function(n,e,t){var r=t(131),i=t(319),a=t(320);function o(n){var e=-1,t=null==n?0:n.length;for(this.__data__=new r;++e<t;)this.add(n[e])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,n.exports=o},function(n,e){n.exports=function(n,e){return n.has(e)}},function(n,e,t){var r=t(331),i=t(337),a=t(205);n.exports=function(n){return a(n)?r(n):i(n)}},function(n,e,t){(function(n){var r=t(29),i=t(333),a=e&&!e.nodeType&&e,o=a&&"object"==typeof n&&n&&!n.nodeType&&n,l=o&&o.exports===a?r.Buffer:void 0,s=(l?l.isBuffer:void 0)||i;n.exports=s}).call(this,t(151)(n))},function(n,e){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(n,e){var r=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&t.test(n))&&n>-1&&n%1==0&&n<e}},function(n,e,t){var r=t(334),i=t(335),a=t(336),o=a&&a.isTypedArray,l=o?i(o):r;n.exports=l},function(n,e,t){var r=t(195),i=t(133);n.exports=function(n){return null!=n&&i(n.length)&&!r(n)}},function(n,e,t){var r=t(41)(t(29),"Set");n.exports=r},function(n,e,t){var r=t(130);n.exports=function(n){return n==n&&!r(n)}},function(n,e){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},function(n,e,t){var r=t(210),i=t(102);n.exports=function(n,e){for(var t=0,a=(e=r(e,n)).length;null!=n&&t<a;)n=n[i(e[t++])];return t&&t==a?n:void 0}},function(n,e,t){var r=t(27),i=t(134),a=t(348),o=t(351);n.exports=function(n,e){return r(n)?n:i(n,e)?[n]:a(o(n))}},function(n,e,t){var r=t(0),i=t(39),a=t(4),o=t(28),l=t(72),s=t(147),c=/MSIE .\./.test(o),d=r.Function,u=function(n){return c?function(e,t){var r=s(arguments.length,1)>2,o=a(e)?e:d(e),c=r?l(arguments,2):void 0;return n(r?function(){i(o,this,c)}:o,t)}:n};n.exports={setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)}},function(n,e,t){"use strict";var r=t(0),i=t(2),a=t(22),o=t(11),l=t(9),s=t(72),c=t(65),d=r.Function,u=i([].concat),p=i([].join),m={},h=function(n,e,t){if(!l(m,e)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";m[e]=d("C,a","return new C("+p(r,",")+")")}return m[e](n,t)};n.exports=c?d.bind:function(n){var e=a(this),t=e.prototype,r=s(arguments,1),i=function(){var t=u(r,s(arguments));return this instanceof i?h(e,t.length,t):e.apply(n,t)};return o(t)&&(i.prototype=t),i}},function(n,e,t){"use strict";var r=t(1),i=t(385).start;r({target:"String",proto:!0,forced:t(387)},{padStart:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,e,t){},function(n,e,t){},function(n,e,t){t(1)({target:"Object",stat:!0},{setPrototypeOf:t(71)})},function(n,e,t){var r=t(1),i=t(15),a=t(39),o=t(212),l=t(166),s=t(10),c=t(11),d=t(35),u=t(3),p=i("Reflect","construct"),m=Object.prototype,h=[].push,g=u((function(){function n(){}return!(p((function(){}),[],n)instanceof n)})),f=!u((function(){p((function(){}))})),v=g||f;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(n,e){l(n),s(e);var t=arguments.length<3?n:l(arguments[2]);if(f&&!g)return p(n,e,t);if(n==t){switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3])}var r=[null];return a(h,r,e),new(a(o,n,r))}var i=t.prototype,u=d(c(i)?i:m),v=a(n,u,e);return c(v)?v:u}})},function(n,e,t){var r=t(1),i=t(0),a=t(61);r({global:!0},{Reflect:{}}),a(i.Reflect,"Reflect",!0)},function(n,e,t){},function(n,e,t){},function(n,e,t){var r=t(284),i=t(289),a=t(360),o=t(368),l=t(377),s=t(236),c=a((function(n){var e=s(n);return l(e)&&(e=void 0),o(r(n,1,l,!0),i(e,2))}));n.exports=c},function(n,e,t){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var r=/["'&<>]/;n.exports=function(n){var e,t=""+n,i=r.exec(t);if(!i)return t;var a="",o=0,l=0;for(o=i.index;o<t.length;o++){switch(t.charCodeAt(o)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}l!==o&&(a+=t.substring(l,o)),l=o+1,a+=e}return l!==o?a+t.substring(l,o):a}},function(n,e,t){"use strict";t.r(e);var r={name:"CodeBlock",props:{title:{type:String,required:!0},active:{type:Boolean,default:!1}}},i=(t(388),t(30)),a=Object(i.a)(r,(function(){var n=this.$createElement;return(this._self._c||n)("div",{staticClass:"theme-code-block",class:{"theme-code-block__active":this.active}},[this._t("default")],2)}),[],!1,null,"4f1e9d0c",null);e.default=a.exports},function(n,e,t){"use strict";t.r(e);t(33),t(6),t(34),t(44),t(31);var r={name:"CodeGroup",data:function(){return{codeTabs:[],activeCodeTabIndex:-1}},watch:{activeCodeTabIndex:function(n){this.codeTabs.forEach((function(n){n.elm.classList.remove("theme-code-block__active")})),this.codeTabs[n].elm.classList.add("theme-code-block__active")}},mounted:function(){var n=this;this.codeTabs=(this.$slots.default||[]).filter((function(n){return Boolean(n.componentOptions)})).map((function(e,t){return""===e.componentOptions.propsData.active&&(n.activeCodeTabIndex=t),{title:e.componentOptions.propsData.title,elm:e.elm}})),-1===this.activeCodeTabIndex&&this.codeTabs.length>0&&(this.activeCodeTabIndex=0)},methods:{changeCodeTab:function(n){this.activeCodeTabIndex=n}}},i=(t(389),t(30)),a=Object(i.a)(r,(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"theme-code-group"},[t("div",{staticClass:"theme-code-group__nav"},[t("ul",{staticClass:"theme-code-group__ul"},n._l(n.codeTabs,(function(e,r){return t("li",{key:e.title,staticClass:"theme-code-group__li"},[t("button",{staticClass:"theme-code-group__nav-tab",class:{"theme-code-group__nav-tab-active":r===n.activeCodeTabIndex},on:{click:function(e){return n.changeCodeTab(r)}}},[n._v("\n            "+n._s(e.title)+"\n          ")])])})),0)]),n._v(" "),n._t("default"),n._v(" "),n.codeTabs.length<1?t("pre",{staticClass:"pre-blank"},[n._v("// Make sure to add code blocks to your code group")]):n._e()],2)}),[],!1,null,"2f5f1757",null);e.default=a.exports},function(n,e,t){"use strict";var r=t(8),i=t(0),a=t(2),o=t(106),l=t(14),s=t(9),c=t(150),d=t(36),u=t(66),p=t(159),m=t(3),h=t(60).f,g=t(38).f,f=t(13).f,v=t(384),b=t(153).trim,y=i.Number,x=y.prototype,T=i.TypeError,k=a("".slice),w=a("".charCodeAt),I=function(n){var e=p(n,"number");return"bigint"==typeof e?e:C(e)},C=function(n){var e,t,r,i,a,o,l,s,c=p(n,"number");if(u(c))throw T("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=b(c),43===(e=w(c,0))||45===e){if(88===(t=w(c,2))||120===t)return NaN}else if(48===e){switch(w(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(a=k(c,2)).length,l=0;l<o;l++)if((s=w(a,l))<48||s>i)return NaN;return parseInt(a,r)}return+c};if(o("Number",!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var S,E=function(n){var e=arguments.length<1?0:y(I(n)),t=this;return d(x,t)&&m((function(){v(t)}))?c(Object(e),t,E):e},_=r?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),z=0;_.length>z;z++)s(y,S=_[z])&&!s(E,S)&&f(E,S,g(y,S));E.prototype=x,x.constructor=E,l(i,"Number",E)}},function(n,e,t){var r=t(3),i=t(0).RegExp;n.exports=r((function(){var n=i(".","s");return!(n.dotAll&&n.exec("\n")&&"s"===n.flags)}))},function(n,e,t){"use strict";var r=t(164).IteratorPrototype,i=t(35),a=t(49),o=t(61),l=t(69),s=function(){return this};n.exports=function(n,e,t,c){var d=e+" Iterator";return n.prototype=i(r,{next:a(+!c,t)}),o(n,d,!1,!0),l[d]=s,n}},function(n,e,t){var r=t(14);n.exports=function(n,e,t){for(var i in e)r(n,i,e[i],t);return n}},function(n,e,t){"use strict";var r=t(15),i=t(13),a=t(5),o=t(8),l=a("species");n.exports=function(n){var e=r(n),t=i.f;o&&e&&!e[l]&&t(e,l,{configurable:!0,get:function(){return this}})}},function(n,e,t){var r=t(0),i=t(36),a=r.TypeError;n.exports=function(n,e){if(i(e,n))return n;throw a("Incorrect invocation")}},function(n,e,t){var r=t(1),i=t(8),a=t(163),o=t(21),l=t(38),s=t(56);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(n){for(var e,t,r=o(n),i=l.f,c=a(r),d={},u=0;c.length>u;)void 0!==(t=i(r,e=c[u++]))&&s(d,e,t);return d}})},function(n,e,t){var r=t(3),i=t(0).RegExp;n.exports=r((function(){var n=i("(?<a>b)","g");return"b"!==n.exec("b").groups.a||"bc"!=="b".replace(n,"$<a>c")}))},function(n,e,t){var r=t(13).f;n.exports=function(n,e,t){t in n||r(n,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})}},function(n,e,t){"use strict";var r=t(1),i=t(116).includes,a=t(141);r({target:"Array",proto:!0},{includes:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(n,e,t){"use strict";var r=t(1),i=t(2),a=t(179),o=t(18),l=t(12),s=t(180),c=i("".indexOf);r({target:"String",proto:!0,forced:!s("includes")},{includes:function(n){return!!~c(l(o(this)),l(a(n)),arguments.length>1?arguments[1]:void 0)}})},function(n,e){n.exports=function(n){var e=null==n?0:n.length;return e?n[e-1]:void 0}},function(n,e,t){"use strict";var r=t(1),i=t(153).trim;r({target:"String",proto:!0,forced:t(382)("trim")},{trim:function(){return i(this)}})},function(n,e,t){var r=t(7),i=t(9),a=t(36),o=t(188),l=RegExp.prototype;n.exports=function(n){var e=n.flags;return void 0!==e||"flags"in l||i(n,"flags")||!a(l,n)?e:r(o,n)}},function(n,e,t){var r=t(124),i=Math.floor,a=function(n,e){var t=n.length,s=i(t/2);return t<8?o(n,e):l(n,a(r(n,0,s),e),a(r(n,s),e),e)},o=function(n,e){for(var t,r,i=n.length,a=1;a<i;){for(r=a,t=n[a];r&&e(n[r-1],t)>0;)n[r]=n[--r];r!==a++&&(n[r]=t)}return n},l=function(n,e,t,r){for(var i=e.length,a=t.length,o=0,l=0;o<i||l<a;)n[o+l]=o<i&&l<a?r(e[o],t[l])<=0?e[o++]:t[l++]:o<i?e[o++]:t[l++];return n};n.exports=a},function(n,e,t){var r=t(0),i=t(8),a=t(110).MISSED_STICKY,o=t(23),l=t(13).f,s=t(37).get,c=RegExp.prototype,d=r.TypeError;i&&a&&l(c,"sticky",{configurable:!0,get:function(){if(this!==c){if("RegExp"===o(this))return!!s(this).sticky;throw d("Incompatible receiver, RegExp required")}}})},function(n,e,t){n.exports=t(399)},function(n,e,t){var r=t(0),i=t(7),a=t(4),o=t(11),l=r.TypeError;n.exports=function(n,e){var t,r;if("string"===e&&a(t=n.toString)&&!o(r=i(t,n)))return r;if(a(t=n.valueOf)&&!o(r=i(t,n)))return r;if("string"!==e&&a(t=n.toString)&&!o(r=i(t,n)))return r;throw l("Can't convert object to primitive value")}},function(n,e,t){var r=t(0),i=t(4),a=t(91),o=r.WeakMap;n.exports=i(o)&&/native code/.test(a(o))},function(n,e,t){var r=t(0),i=t(4),a=r.String,o=r.TypeError;n.exports=function(n){if("object"==typeof n||i(n))return n;throw o("Can't set "+a(n)+" as a prototype")}},function(n,e,t){t(246),t(253),t(254),t(255),t(256),t(257)},function(n,e,t){"use strict";var r,i,a,o=t(1),l=t(17),s=t(93),c=t(0),d=t(7),u=t(14),p=t(228),m=t(71),h=t(61),g=t(229),f=t(22),v=t(4),b=t(11),y=t(230),x=t(121),T=t(167).set,k=t(247),w=t(250),I=t(123),C=t(251),S=t(37),E=t(55),_=t(73),z=t(74),A=_.CONSTRUCTOR,P=_.REJECTION_EVENT,R=_.SUBCLASSING,B=S.getterFor("Promise"),j=S.set,D=E&&E.prototype,M=E,L=D,O=c.TypeError,q=c.document,F=c.process,U=z.f,N=U,H=!!(q&&q.createEvent&&c.dispatchEvent),$=function(n){var e;return!(!b(n)||!v(e=n.then))&&e},Q=function(n,e){var t,r,i,a=e.value,o=1==e.state,l=o?n.ok:n.fail,s=n.resolve,c=n.reject,u=n.domain;try{l?(o||(2===e.rejection&&J(e),e.rejection=1),!0===l?t=a:(u&&u.enter(),t=l(a),u&&(u.exit(),i=!0)),t===n.promise?c(O("Promise-chain cycle")):(r=$(t))?d(r,t,s,c):s(t)):c(a)}catch(n){u&&!i&&u.exit(),c(n)}},W=function(n,e){n.notified||(n.notified=!0,k((function(){for(var t,r=n.reactions;t=r.get();)Q(t,n);n.notified=!1,e&&!n.rejection&&K(n)})))},G=function(n,e,t){var r,i;H?((r=q.createEvent("Event")).promise=e,r.reason=t,r.initEvent(n,!1,!0),c.dispatchEvent(r)):r={promise:e,reason:t},!P&&(i=c["on"+n])?i(r):"unhandledrejection"===n&&w("Unhandled promise rejection",t)},K=function(n){d(T,c,(function(){var e,t=n.facade,r=n.value;if(V(n)&&(e=I((function(){s?F.emit("unhandledRejection",r,t):G("unhandledrejection",t,r)})),n.rejection=s||V(n)?2:1,e.error))throw e.value}))},V=function(n){return 1!==n.rejection&&!n.parent},J=function(n){d(T,c,(function(){var e=n.facade;s?F.emit("rejectionHandled",e):G("rejectionhandled",e,n.value)}))},Z=function(n,e,t){return function(r){n(e,r,t)}},X=function(n,e,t){n.done||(n.done=!0,t&&(n=t),n.value=e,n.state=2,W(n,!0))},Y=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw O("Promise can't be resolved itself");var r=$(e);r?k((function(){var t={done:!1};try{d(r,e,Z(Y,t,n),Z(X,t,n))}catch(e){X(t,e,n)}})):(n.value=e,n.state=1,W(n,!1))}catch(e){X({done:!1},e,n)}}};if(A&&(L=(M=function(n){y(this,L),f(n),d(r,this);var e=B(this);try{n(Z(Y,e),Z(X,e))}catch(n){X(e,n)}}).prototype,(r=function(n){j(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new C,rejection:!1,state:0,value:void 0})}).prototype=p(L,{then:function(n,e){var t=B(this),r=U(x(this,M));return t.parent=!0,r.ok=!v(n)||n,r.fail=v(e)&&e,r.domain=s?F.domain:void 0,0==t.state?t.reactions.add(r):k((function(){Q(r,t)})),r.promise}}),i=function(){var n=new r,e=B(n);this.promise=n,this.resolve=Z(Y,e),this.reject=Z(X,e)},z.f=U=function(n){return n===M||void 0===n?new i(n):N(n)},!l&&v(E)&&D!==Object.prototype)){a=D.then,R||u(D,"then",(function(n,e){var t=this;return new M((function(n,e){d(a,t,n,e)})).then(n,e)}),{unsafe:!0});try{delete D.constructor}catch(n){}m&&m(D,L)}o({global:!0,wrap:!0,forced:A},{Promise:M}),h(M,"Promise",!1,!0),g("Promise")},function(n,e,t){var r,i,a,o,l,s,c,d,u=t(0),p=t(58),m=t(38).f,h=t(167).set,g=t(168),f=t(248),v=t(249),b=t(93),y=u.MutationObserver||u.WebKitMutationObserver,x=u.document,T=u.process,k=u.Promise,w=m(u,"queueMicrotask"),I=w&&w.value;I||(r=function(){var n,e;for(b&&(n=T.domain)&&n.exit();i;){e=i.fn,i=i.next;try{e()}catch(n){throw i?o():a=void 0,n}}a=void 0,n&&n.enter()},g||b||v||!y||!x?!f&&k&&k.resolve?((c=k.resolve(void 0)).constructor=k,d=p(c.then,c),o=function(){d(r)}):b?o=function(){T.nextTick(r)}:(h=p(h,u),o=function(){h(r)}):(l=!0,s=x.createTextNode(""),new y(r).observe(s,{characterData:!0}),o=function(){s.data=l=!l})),n.exports=I||function(n){var e={fn:n,next:void 0};a&&(a.next=e),i||(i=e,o()),a=e}},function(n,e,t){var r=t(28),i=t(0);n.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},function(n,e,t){var r=t(28);n.exports=/web0s(?!.*chrome)/i.test(r)},function(n,e,t){var r=t(0);n.exports=function(n,e){var t=r.console;t&&t.error&&(1==arguments.length?t.error(n):t.error(n,e))}},function(n,e){var t=function(){this.head=null,this.tail=null};t.prototype={add:function(n){var e={item:n,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},n.exports=t},function(n,e){n.exports="object"==typeof window&&"object"!=typeof Deno},function(n,e,t){"use strict";var r=t(1),i=t(7),a=t(22),o=t(74),l=t(123),s=t(169);r({target:"Promise",stat:!0,forced:t(172)},{all:function(n){var e=this,t=o.f(e),r=t.resolve,c=t.reject,d=l((function(){var t=a(e.resolve),o=[],l=0,d=1;s(n,(function(n){var a=l++,s=!1;d++,i(t,e,n).then((function(n){s||(s=!0,o[a]=n,--d||r(o))}),c)})),--d||r(o)}));return d.error&&c(d.value),t.promise}})},function(n,e,t){"use strict";var r=t(1),i=t(17),a=t(73).CONSTRUCTOR,o=t(55),l=t(15),s=t(4),c=t(14),d=o&&o.prototype;if(r({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(n){return this.then(void 0,n)}}),!i&&s(o)){var u=l("Promise").prototype.catch;d.catch!==u&&c(d,"catch",u,{unsafe:!0})}},function(n,e,t){"use strict";var r=t(1),i=t(7),a=t(22),o=t(74),l=t(123),s=t(169);r({target:"Promise",stat:!0,forced:t(172)},{race:function(n){var e=this,t=o.f(e),r=t.reject,c=l((function(){var o=a(e.resolve);s(n,(function(n){i(o,e,n).then(t.resolve,r)}))}));return c.error&&r(c.value),t.promise}})},function(n,e,t){"use strict";var r=t(1),i=t(7),a=t(74);r({target:"Promise",stat:!0,forced:t(73).CONSTRUCTOR},{reject:function(n){var e=a.f(this);return i(e.reject,void 0,n),e.promise}})},function(n,e,t){"use strict";var r=t(1),i=t(15),a=t(17),o=t(55),l=t(73).CONSTRUCTOR,s=t(174),c=i("Promise"),d=a&&!l;r({target:"Promise",stat:!0,forced:a||l},{resolve:function(n){return s(d&&this===c?o:this,n)}})},function(n,e,t){var r=t(1),i=t(259);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(n,e,t){"use strict";var r=t(8),i=t(2),a=t(7),o=t(3),l=t(88),s=t(92),c=t(118),d=t(16),u=t(64),p=Object.assign,m=Object.defineProperty,h=i([].concat);n.exports=!p||o((function(){if(r&&1!==p({b:1},p(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var n={},e={},t=Symbol();return n[t]=7,"abcdefghijklmnopqrst".split("").forEach((function(n){e[n]=n})),7!=p({},n)[t]||"abcdefghijklmnopqrst"!=l(p({},e)).join("")}))?function(n,e){for(var t=d(n),i=arguments.length,o=1,p=s.f,m=c.f;i>o;)for(var g,f=u(arguments[o++]),v=p?h(l(f),p(f)):l(f),b=v.length,y=0;b>y;)g=v[y++],r&&!a(m,f,g)||(t[g]=f[g]);return t}:p},function(n,e,t){"use strict";var r=t(1),i=t(17),a=t(55),o=t(3),l=t(15),s=t(4),c=t(121),d=t(174),u=t(14),p=a&&a.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!a&&o((function(){p.finally.call({then:function(){}},(function(){}))}))},{finally:function(n){var e=c(this,l("Promise")),t=s(n);return this.then(t?function(t){return d(e,n()).then((function(){return t}))}:n,t?function(t){return d(e,n()).then((function(){throw t}))}:n)}}),!i&&s(a)){var m=l("Promise").prototype.finally;p.finally!==m&&u(p,"finally",m,{unsafe:!0})}},function(n,e,t){"use strict";var r=t(122),i=t(82);n.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(n,e,t){var r=t(0),i=t(62),a=t(94),o=t(11),l=t(5)("species"),s=r.Array;n.exports=function(n){var e;return i(n)&&(e=n.constructor,(a(e)&&(e===s||i(e.prototype))||o(e)&&null===(e=e[l]))&&(e=void 0)),void 0===e?s:e}},function(n,e,t){"use strict";var r=t(1),i=t(264).left,a=t(47),o=t(53),l=t(93);r({target:"Array",proto:!0,forced:!a("reduce")||!l&&o>79&&o<83},{reduce:function(n){var e=arguments.length;return i(this,n,e,e>1?arguments[1]:void 0)}})},function(n,e,t){var r=t(0),i=t(22),a=t(16),o=t(64),l=t(20),s=r.TypeError,c=function(n){return function(e,t,r,c){i(t);var d=a(e),u=o(d),p=l(d),m=n?p-1:0,h=n?-1:1;if(r<2)for(;;){if(m in u){c=u[m],m+=h;break}if(m+=h,n?m<0:p<=m)throw s("Reduce of empty array with no initial value")}for(;n?m>=0:p>m;m+=h)m in u&&(c=t(c,u[m],m,d));return c}};n.exports={left:c(!1),right:c(!0)}},function(n,e,t){"use strict";var r,i=t(1),a=t(2),o=t(38).f,l=t(54),s=t(12),c=t(179),d=t(18),u=t(180),p=t(17),m=a("".startsWith),h=a("".slice),g=Math.min,f=u("startsWith");i({target:"String",proto:!0,forced:!!(p||f||(r=o(String.prototype,"startsWith"),!r||r.writable))&&!f},{startsWith:function(n){var e=s(d(this));c(n);var t=l(g(arguments.length>1?arguments[1]:void 0,e.length)),r=s(n);return m?m(e,r,t):h(e,t,t+r.length)===r}})},function(n,e,t){var r=t(1),i=t(182),a=t(3),o=t(11),l=t(267).onFreeze,s=Object.freeze;r({target:"Object",stat:!0,forced:a((function(){s(1)})),sham:!i},{freeze:function(n){return s&&o(n)?s(l(n)):n}})},function(n,e,t){var r=t(1),i=t(2),a=t(68),o=t(11),l=t(9),s=t(13).f,c=t(60),d=t(183),u=t(268),p=t(85),m=t(182),h=!1,g=p("meta"),f=0,v=function(n){s(n,g,{value:{objectID:"O"+f++,weakData:{}}})},b=n.exports={enable:function(){b.enable=function(){},h=!0;var n=c.f,e=i([].splice),t={};t[g]=1,n(t).length&&(c.f=function(t){for(var r=n(t),i=0,a=r.length;i<a;i++)if(r[i]===g){e(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},fastKey:function(n,e){if(!o(n))return"symbol"==typeof n?n:("string"==typeof n?"S":"P")+n;if(!l(n,g)){if(!u(n))return"F";if(!e)return"E";v(n)}return n[g].objectID},getWeakData:function(n,e){if(!l(n,g)){if(!u(n))return!0;if(!e)return!1;v(n)}return n[g].weakData},onFreeze:function(n){return m&&h&&u(n)&&!l(n,g)&&v(n),n}};a[g]=!0},function(n,e,t){var r=t(3),i=t(11),a=t(23),o=t(269),l=Object.isExtensible,s=r((function(){l(1)}));n.exports=s||o?function(n){return!!i(n)&&((!o||"ArrayBuffer"!=a(n))&&(!l||l(n)))}:l},function(n,e,t){var r=t(3);n.exports=r((function(){if("function"==typeof ArrayBuffer){var n=new ArrayBuffer(8);Object.isExtensible(n)&&Object.defineProperty(n,"a",{value:8})}}))},function(n,e,t){"use strict";var r=t(1),i=t(0),a=t(7),o=t(2),l=t(17),s=t(8),c=t(52),d=t(3),u=t(9),p=t(36),m=t(10),h=t(21),g=t(87),f=t(12),v=t(49),b=t(35),y=t(88),x=t(60),T=t(183),k=t(92),w=t(38),I=t(13),C=t(146),S=t(118),E=t(14),_=t(51),z=t(90),A=t(68),P=t(85),R=t(5),B=t(184),j=t(185),D=t(272),M=t(61),L=t(37),O=t(59).forEach,q=z("hidden"),F=L.set,U=L.getterFor("Symbol"),N=Object.prototype,H=i.Symbol,$=H&&H.prototype,Q=i.TypeError,W=i.QObject,G=w.f,K=I.f,V=T.f,J=S.f,Z=o([].push),X=_("symbols"),Y=_("op-symbols"),nn=_("wks"),en=!W||!W.prototype||!W.prototype.findChild,tn=s&&d((function(){return 7!=b(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(n,e,t){var r=G(N,e);r&&delete N[e],K(n,e,t),r&&n!==N&&K(N,e,r)}:K,rn=function(n,e){var t=X[n]=b($);return F(t,{type:"Symbol",tag:n,description:e}),s||(t.description=e),t},an=function(n,e,t){n===N&&an(Y,e,t),m(n);var r=g(e);return m(t),u(X,r)?(t.enumerable?(u(n,q)&&n[q][r]&&(n[q][r]=!1),t=b(t,{enumerable:v(0,!1)})):(u(n,q)||K(n,q,v(1,{})),n[q][r]=!0),tn(n,r,t)):K(n,r,t)},on=function(n,e){m(n);var t=h(e),r=y(t).concat(dn(t));return O(r,(function(e){s&&!a(ln,t,e)||an(n,e,t[e])})),n},ln=function(n){var e=g(n),t=a(J,this,e);return!(this===N&&u(X,e)&&!u(Y,e))&&(!(t||!u(this,e)||!u(X,e)||u(this,q)&&this[q][e])||t)},sn=function(n,e){var t=h(n),r=g(e);if(t!==N||!u(X,r)||u(Y,r)){var i=G(t,r);return!i||!u(X,r)||u(t,q)&&t[q][r]||(i.enumerable=!0),i}},cn=function(n){var e=V(h(n)),t=[];return O(e,(function(n){u(X,n)||u(A,n)||Z(t,n)})),t},dn=function(n){var e=n===N,t=V(e?Y:h(n)),r=[];return O(t,(function(n){!u(X,n)||e&&!u(N,n)||Z(r,X[n])})),r};c||(E($=(H=function(){if(p($,this))throw Q("Symbol is not a constructor");var n=arguments.length&&void 0!==arguments[0]?f(arguments[0]):void 0,e=P(n),t=function(n){this===N&&a(t,Y,n),u(this,q)&&u(this[q],e)&&(this[q][e]=!1),tn(this,e,v(1,n))};return s&&en&&tn(N,e,{configurable:!0,set:t}),rn(e,n)}).prototype,"toString",(function(){return U(this).tag})),E(H,"withoutSetter",(function(n){return rn(P(n),n)})),S.f=ln,I.f=an,C.f=on,w.f=sn,x.f=T.f=cn,k.f=dn,B.f=function(n){return rn(R(n),n)},s&&(K($,"description",{configurable:!0,get:function(){return U(this).description}}),l||E(N,"propertyIsEnumerable",ln,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:H}),O(y(nn),(function(n){j(n)})),r({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){en=!0},useSimple:function(){en=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!s},{create:function(n,e){return void 0===e?b(n):on(b(n),e)},defineProperty:an,defineProperties:on,getOwnPropertyDescriptor:sn}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:cn}),D(),M(H,"Symbol"),A[q]=!0},function(n,e,t){var r=t(0);n.exports=r},function(n,e,t){var r=t(7),i=t(15),a=t(5),o=t(14);n.exports=function(){var n=i("Symbol"),e=n&&n.prototype,t=e&&e.valueOf,l=a("toPrimitive");e&&!e[l]&&o(e,l,(function(n){return r(t,this)}))}},function(n,e,t){var r=t(1),i=t(15),a=t(9),o=t(12),l=t(51),s=t(186),c=l("string-to-symbol-registry"),d=l("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!s},{for:function(n){var e=o(n);if(a(c,e))return c[e];var t=i("Symbol")(e);return c[e]=t,d[t]=e,t}})},function(n,e,t){var r=t(1),i=t(9),a=t(66),o=t(67),l=t(51),s=t(186),c=l("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!s},{keyFor:function(n){if(!a(n))throw TypeError(o(n)+" is not a symbol");if(i(c,n))return c[n]}})},function(n,e,t){var r=t(1),i=t(52),a=t(3),o=t(92),l=t(16);r({target:"Object",stat:!0,forced:!i||a((function(){o.f(1)}))},{getOwnPropertySymbols:function(n){var e=o.f;return e?e(l(n)):[]}})},function(n,e,t){"use strict";var r=t(0),i=t(58),a=t(7),o=t(16),l=t(277),s=t(170),c=t(94),d=t(20),u=t(56),p=t(148),m=t(107),h=r.Array;n.exports=function(n){var e=o(n),t=c(this),r=arguments.length,g=r>1?arguments[1]:void 0,f=void 0!==g;f&&(g=i(g,r>2?arguments[2]:void 0));var v,b,y,x,T,k,w=m(e),I=0;if(!w||this==h&&s(w))for(v=d(e),b=t?new this(v):h(v);v>I;I++)k=f?g(e[I],I):e[I],u(b,I,k);else for(T=(x=p(e,w)).next,b=t?new this:[];!(y=a(T,x)).done;I++)k=f?l(x,g,[y.value,I],!0):y.value,u(b,I,k);return b.length=I,b}},function(n,e,t){var r=t(10),i=t(171);n.exports=function(n,e,t,a){try{return a?e(r(t)[0],t[1]):e(t)}catch(e){i(n,"throw",e)}}},function(n,e,t){"use strict";var r=t(15),i=t(9),a=t(24),o=t(36),l=t(71),s=t(119),c=t(233),d=t(150),u=t(189),p=t(279),m=t(280),h=t(281),g=t(8),f=t(17);n.exports=function(n,e,t,v){var b=v?2:1,y=n.split("."),x=y[y.length-1],T=r.apply(null,y);if(T){var k=T.prototype;if(!f&&i(k,"cause")&&delete k.cause,!t)return T;var w=r("Error"),I=e((function(n,e){var t=u(v?e:n,void 0),r=v?new T(n):new T;return void 0!==t&&a(r,"message",t),h&&a(r,"stack",m(r.stack,2)),this&&o(k,this)&&d(r,this,I),arguments.length>b&&p(r,arguments[b]),r}));if(I.prototype=k,"Error"!==x?l?l(I,w):s(I,w,{name:!0}):g&&"stackTraceLimit"in T&&(c(I,T,"stackTraceLimit"),c(I,T,"prepareStackTrace")),s(I,T),!f)try{k.name!==x&&a(k,"name",x),k.constructor=I}catch(n){}return I}}},function(n,e,t){var r=t(11),i=t(24);n.exports=function(n,e){r(e)&&"cause"in e&&i(n,"cause",e.cause)}},function(n,e,t){var r=t(2),i=Error,a=r("".replace),o=String(i("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,s=l.test(o);n.exports=function(n,e){if(s&&"string"==typeof n&&!i.prepareStackTrace)for(;e--;)n=a(n,l,"");return n}},function(n,e,t){var r=t(3),i=t(49);n.exports=!r((function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",i(1,7)),7!==n.stack)}))},function(n,e,t){"use strict";var r=t(8),i=t(3),a=t(10),o=t(35),l=t(189),s=Error.prototype.toString,c=i((function(){if(r){var n=o(Object.defineProperty({},"name",{get:function(){return this===n}}));if("true"!==s.call(n))return!0}return"2: 1"!==s.call({message:1,name:2})||"Error"!==s.call({})}));n.exports=c?function(){var n=a(this),e=l(n.name,"Error"),t=l(n.message);return e?t?e+": "+t:e:t}:s},function(n,e,t){var r=t(2),i=t(16),a=Math.floor,o=r("".charAt),l=r("".replace),s=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;n.exports=function(n,e,t,r,u,p){var m=t+n.length,h=r.length,g=d;return void 0!==u&&(u=i(u),g=c),l(p,g,(function(i,l){var c;switch(o(l,0)){case"$":return"$";case"&":return n;case"`":return s(e,0,t);case"'":return s(e,m);case"<":c=u[s(l,1,-1)];break;default:var d=+l;if(0===d)return i;if(d>h){var p=a(d/10);return 0===p?i:p<=h?void 0===r[p-1]?o(l,1):r[p-1]+o(l,1):i}c=r[d-1]}return void 0===c?"":c}))}},function(n,e,t){var r=t(191),i=t(285);n.exports=function n(e,t,a,o,l){var s=-1,c=e.length;for(a||(a=i),l||(l=[]);++s<c;){var d=e[s];t>0&&a(d)?t>1?n(d,t-1,a,o,l):r(l,d):o||(l[l.length]=d)}return l}},function(n,e,t){var r=t(76),i=t(128),a=t(27),o=r?r.isConcatSpreadable:void 0;n.exports=function(n){return a(n)||i(n)||!!(o&&n&&n[o])}},function(n,e,t){var r=t(63),i=t(50);n.exports=function(n){return i(n)&&"[object Arguments]"==r(n)}},function(n,e,t){var r=t(76),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,l=r?r.toStringTag:void 0;n.exports=function(n){var e=a.call(n,l),t=n[l];try{n[l]=void 0;var r=!0}catch(n){}var i=o.call(n);return r&&(e?n[l]=t:delete n[l]),i}},function(n,e){var t=Object.prototype.toString;n.exports=function(n){return t.call(n)}},function(n,e,t){var r=t(290),i=t(346),a=t(136),o=t(27),l=t(357);n.exports=function(n){return"function"==typeof n?n:null==n?a:"object"==typeof n?o(n)?i(n[0],n[1]):r(n):l(n)}},function(n,e,t){var r=t(291),i=t(345),a=t(208);n.exports=function(n){var e=i(n);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(t){return t===n||r(t,n,e)}}},function(n,e,t){var r=t(193),i=t(197);n.exports=function(n,e,t,a){var o=t.length,l=o,s=!a;if(null==n)return!l;for(n=Object(n);o--;){var c=t[o];if(s&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++o<l;){var d=(c=t[o])[0],u=n[d],p=c[1];if(s&&c[2]){if(void 0===u&&!(d in n))return!1}else{var m=new r;if(a)var h=a(u,p,d,n,e,m);if(!(void 0===h?i(p,u,3,a,m):h))return!1}}return!0}},function(n,e){n.exports=function(){this.__data__=[],this.size=0}},function(n,e,t){var r=t(99),i=Array.prototype.splice;n.exports=function(n){var e=this.__data__,t=r(e,n);return!(t<0)&&(t==e.length-1?e.pop():i.call(e,t,1),--this.size,!0)}},function(n,e,t){var r=t(99);n.exports=function(n){var e=this.__data__,t=r(e,n);return t<0?void 0:e[t][1]}},function(n,e,t){var r=t(99);n.exports=function(n){return r(this.__data__,n)>-1}},function(n,e,t){var r=t(99);n.exports=function(n,e){var t=this.__data__,i=r(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}},function(n,e,t){var r=t(98);n.exports=function(){this.__data__=new r,this.size=0}},function(n,e){n.exports=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}},function(n,e){n.exports=function(n){return this.__data__.get(n)}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e,t){var r=t(98),i=t(129),a=t(131);n.exports=function(n,e){var t=this.__data__;if(t instanceof r){var o=t.__data__;if(!i||o.length<199)return o.push([n,e]),this.size=++t.size,this;t=this.__data__=new a(o)}return t.set(n,e),this.size=t.size,this}},function(n,e,t){var r=t(195),i=t(303),a=t(130),o=t(196),l=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,d=s.toString,u=c.hasOwnProperty,p=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!a(n)||i(n))&&(r(n)?p:l).test(o(n))}},function(n,e,t){var r,i=t(304),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";n.exports=function(n){return!!a&&a in n}},function(n,e,t){var r=t(29)["__core-js_shared__"];n.exports=r},function(n,e){n.exports=function(n,e){return null==n?void 0:n[e]}},function(n,e,t){var r=t(307),i=t(98),a=t(129);n.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},function(n,e,t){var r=t(308),i=t(309),a=t(310),o=t(311),l=t(312);function s(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=i,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,n.exports=s},function(n,e,t){var r=t(100);n.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(n,e){n.exports=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}},function(n,e,t){var r=t(100),i=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;if(r){var t=e[n];return"__lodash_hash_undefined__"===t?void 0:t}return i.call(e,n)?e[n]:void 0}},function(n,e,t){var r=t(100),i=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;return r?void 0!==e[n]:i.call(e,n)}},function(n,e,t){var r=t(100);n.exports=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(n,e,t){var r=t(101);n.exports=function(n){var e=r(this,n).delete(n);return this.size-=e?1:0,e}},function(n,e){n.exports=function(n){var e=typeof n;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n}},function(n,e,t){var r=t(101);n.exports=function(n){return r(this,n).get(n)}},function(n,e,t){var r=t(101);n.exports=function(n){return r(this,n).has(n)}},function(n,e,t){var r=t(101);n.exports=function(n,e){var t=r(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}},function(n,e,t){var r=t(193),i=t(198),a=t(322),o=t(325),l=t(341),s=t(27),c=t(202),d=t(204),u="[object Object]",p=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,m,h,g){var f=s(n),v=s(e),b=f?"[object Array]":l(n),y=v?"[object Array]":l(e),x=(b="[object Arguments]"==b?u:b)==u,T=(y="[object Arguments]"==y?u:y)==u,k=b==y;if(k&&c(n)){if(!c(e))return!1;f=!0,x=!1}if(k&&!x)return g||(g=new r),f||d(n)?i(n,e,t,m,h,g):a(n,e,b,t,m,h,g);if(!(1&t)){var w=x&&p.call(n,"__wrapped__"),I=T&&p.call(e,"__wrapped__");if(w||I){var C=w?n.value():n,S=I?e.value():e;return g||(g=new r),h(C,S,t,m,g)}}return!!k&&(g||(g=new r),o(n,e,t,m,h,g))}},function(n,e){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}},function(n,e,t){var r=t(76),i=t(323),a=t(194),o=t(198),l=t(324),s=t(132),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;n.exports=function(n,e,t,r,c,u,p){switch(t){case"[object DataView]":if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=e.byteLength||!u(new i(n),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+n,+e);case"[object Error]":return n.name==e.name&&n.message==e.message;case"[object RegExp]":case"[object String]":return n==e+"";case"[object Map]":var m=l;case"[object Set]":var h=1&r;if(m||(m=s),n.size!=e.size&&!h)return!1;var g=p.get(n);if(g)return g==e;r|=2,p.set(n,e);var f=o(m(n),m(e),r,c,u,p);return p.delete(n),f;case"[object Symbol]":if(d)return d.call(n)==d.call(e)}return!1}},function(n,e,t){var r=t(29).Uint8Array;n.exports=r},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n,r){t[++e]=[r,n]})),t}},function(n,e,t){var r=t(326),i=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,a,o,l){var s=1&t,c=r(n),d=c.length;if(d!=r(e).length&&!s)return!1;for(var u=d;u--;){var p=c[u];if(!(s?p in e:i.call(e,p)))return!1}var m=l.get(n),h=l.get(e);if(m&&h)return m==e&&h==n;var g=!0;l.set(n,e),l.set(e,n);for(var f=s;++u<d;){var v=n[p=c[u]],b=e[p];if(a)var y=s?a(b,v,p,e,n,l):a(v,b,p,n,e,l);if(!(void 0===y?v===b||o(v,b,t,a,l):y)){g=!1;break}f||(f="constructor"==p)}if(g&&!f){var x=n.constructor,T=e.constructor;x==T||!("constructor"in n)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof T&&T instanceof T||(g=!1)}return l.delete(n),l.delete(e),g}},function(n,e,t){var r=t(327),i=t(328),a=t(201);n.exports=function(n){return r(n,a,i)}},function(n,e,t){var r=t(191),i=t(27);n.exports=function(n,e,t){var a=e(n);return i(n)?a:r(a,t(n))}},function(n,e,t){var r=t(329),i=t(330),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,l=o?function(n){return null==n?[]:(n=Object(n),r(o(n),(function(e){return a.call(n,e)})))}:i;n.exports=l},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length,i=0,a=[];++t<r;){var o=n[t];e(o,t,n)&&(a[i++]=o)}return a}},function(n,e){n.exports=function(){return[]}},function(n,e,t){var r=t(332),i=t(128),a=t(27),o=t(202),l=t(203),s=t(204),c=Object.prototype.hasOwnProperty;n.exports=function(n,e){var t=a(n),d=!t&&i(n),u=!t&&!d&&o(n),p=!t&&!d&&!u&&s(n),m=t||d||u||p,h=m?r(n.length,String):[],g=h.length;for(var f in n)!e&&!c.call(n,f)||m&&("length"==f||u&&("offset"==f||"parent"==f)||p&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||l(f,g))||h.push(f);return h}},function(n,e){n.exports=function(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}},function(n,e){n.exports=function(){return!1}},function(n,e,t){var r=t(63),i=t(133),a=t(50),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,n.exports=function(n){return a(n)&&i(n.length)&&!!o[r(n)]}},function(n,e){n.exports=function(n){return function(e){return n(e)}}},function(n,e,t){(function(n){var r=t(192),i=e&&!e.nodeType&&e,a=i&&"object"==typeof n&&n&&!n.nodeType&&n,o=a&&a.exports===i&&r.process,l=function(){try{var n=a&&a.require&&a.require("util").types;return n||o&&o.binding&&o.binding("util")}catch(n){}}();n.exports=l}).call(this,t(151)(n))},function(n,e,t){var r=t(338),i=t(339),a=Object.prototype.hasOwnProperty;n.exports=function(n){if(!r(n))return i(n);var e=[];for(var t in Object(n))a.call(n,t)&&"constructor"!=t&&e.push(t);return e}},function(n,e){var t=Object.prototype;n.exports=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}},function(n,e,t){var r=t(340)(Object.keys,Object);n.exports=r},function(n,e){n.exports=function(n,e){return function(t){return n(e(t))}}},function(n,e,t){var r=t(342),i=t(129),a=t(343),o=t(206),l=t(344),s=t(63),c=t(196),d=c(r),u=c(i),p=c(a),m=c(o),h=c(l),g=s;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=g(new i)||a&&"[object Promise]"!=g(a.resolve())||o&&"[object Set]"!=g(new o)||l&&"[object WeakMap]"!=g(new l))&&(g=function(n){var e=s(n),t="[object Object]"==e?n.constructor:void 0,r=t?c(t):"";if(r)switch(r){case d:return"[object DataView]";case u:return"[object Map]";case p:return"[object Promise]";case m:return"[object Set]";case h:return"[object WeakMap]"}return e}),n.exports=g},function(n,e,t){var r=t(41)(t(29),"DataView");n.exports=r},function(n,e,t){var r=t(41)(t(29),"Promise");n.exports=r},function(n,e,t){var r=t(41)(t(29),"WeakMap");n.exports=r},function(n,e,t){var r=t(207),i=t(201);n.exports=function(n){for(var e=i(n),t=e.length;t--;){var a=e[t],o=n[a];e[t]=[a,o,r(o)]}return e}},function(n,e,t){var r=t(197),i=t(347),a=t(354),o=t(134),l=t(207),s=t(208),c=t(102);n.exports=function(n,e){return o(n)&&l(e)?s(c(n),e):function(t){var o=i(t,n);return void 0===o&&o===e?a(t,n):r(e,o,3)}}},function(n,e,t){var r=t(209);n.exports=function(n,e,t){var i=null==n?void 0:r(n,e);return void 0===i?t:i}},function(n,e,t){var r=t(349),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r((function(n){var e=[];return 46===n.charCodeAt(0)&&e.push(""),n.replace(i,(function(n,t,r,i){e.push(r?i.replace(a,"$1"):t||n)})),e}));n.exports=o},function(n,e,t){var r=t(350);n.exports=function(n){var e=r(n,(function(n){return 500===t.size&&t.clear(),n})),t=e.cache;return e}},function(n,e,t){var r=t(131);function i(n,e){if("function"!=typeof n||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=t.cache;if(a.has(i))return a.get(i);var o=n.apply(this,r);return t.cache=a.set(i,o)||a,o};return t.cache=new(i.Cache||r),t}i.Cache=r,n.exports=i},function(n,e,t){var r=t(352);n.exports=function(n){return null==n?"":r(n)}},function(n,e,t){var r=t(76),i=t(353),a=t(27),o=t(135),l=r?r.prototype:void 0,s=l?l.toString:void 0;n.exports=function n(e){if("string"==typeof e)return e;if(a(e))return i(e,n)+"";if(o(e))return s?s.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(n,e){n.exports=function(n,e){for(var t=-1,r=null==n?0:n.length,i=Array(r);++t<r;)i[t]=e(n[t],t,n);return i}},function(n,e,t){var r=t(355),i=t(356);n.exports=function(n,e){return null!=n&&i(n,e,r)}},function(n,e){n.exports=function(n,e){return null!=n&&e in Object(n)}},function(n,e,t){var r=t(210),i=t(128),a=t(27),o=t(203),l=t(133),s=t(102);n.exports=function(n,e,t){for(var c=-1,d=(e=r(e,n)).length,u=!1;++c<d;){var p=s(e[c]);if(!(u=null!=n&&t(n,p)))break;n=n[p]}return u||++c!=d?u:!!(d=null==n?0:n.length)&&l(d)&&o(p,d)&&(a(n)||i(n))}},function(n,e,t){var r=t(358),i=t(359),a=t(134),o=t(102);n.exports=function(n){return a(n)?r(o(n)):i(n)}},function(n,e){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},function(n,e,t){var r=t(209);n.exports=function(n){return function(e){return r(e,n)}}},function(n,e,t){var r=t(136),i=t(361),a=t(363);n.exports=function(n,e){return a(i(n,e,r),n+"")}},function(n,e,t){var r=t(362),i=Math.max;n.exports=function(n,e,t){return e=i(void 0===e?n.length-1:e,0),function(){for(var a=arguments,o=-1,l=i(a.length-e,0),s=Array(l);++o<l;)s[o]=a[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=a[o];return c[e]=t(s),r(n,this,c)}}},function(n,e){n.exports=function(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}},function(n,e,t){var r=t(364),i=t(367)(r);n.exports=i},function(n,e,t){var r=t(365),i=t(366),a=t(136),o=i?function(n,e){return i(n,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:a;n.exports=o},function(n,e){n.exports=function(n){return function(){return n}}},function(n,e,t){var r=t(41),i=function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=i},function(n,e){var t=Date.now;n.exports=function(n){var e=0,r=0;return function(){var i=t(),a=16-(i-r);if(r=i,a>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}},function(n,e,t){var r=t(199),i=t(369),a=t(374),o=t(200),l=t(375),s=t(132);n.exports=function(n,e,t){var c=-1,d=i,u=n.length,p=!0,m=[],h=m;if(t)p=!1,d=a;else if(u>=200){var g=e?null:l(n);if(g)return s(g);p=!1,d=o,h=new r}else h=e?[]:m;n:for(;++c<u;){var f=n[c],v=e?e(f):f;if(f=t||0!==f?f:0,p&&v==v){for(var b=h.length;b--;)if(h[b]===v)continue n;e&&h.push(v),m.push(f)}else d(h,v,t)||(h!==m&&h.push(v),m.push(f))}return m}},function(n,e,t){var r=t(370);n.exports=function(n,e){return!!(null==n?0:n.length)&&r(n,e,0)>-1}},function(n,e,t){var r=t(371),i=t(372),a=t(373);n.exports=function(n,e,t){return e==e?a(n,e,t):r(n,i,t)}},function(n,e){n.exports=function(n,e,t,r){for(var i=n.length,a=t+(r?1:-1);r?a--:++a<i;)if(e(n[a],a,n))return a;return-1}},function(n,e){n.exports=function(n){return n!=n}},function(n,e){n.exports=function(n,e,t){for(var r=t-1,i=n.length;++r<i;)if(n[r]===e)return r;return-1}},function(n,e){n.exports=function(n,e,t){for(var r=-1,i=null==n?0:n.length;++r<i;)if(t(e,n[r]))return!0;return!1}},function(n,e,t){var r=t(206),i=t(376),a=t(132),o=r&&1/a(new r([,-0]))[1]==1/0?function(n){return new r(n)}:i;n.exports=o},function(n,e){n.exports=function(){}},function(n,e,t){var r=t(205),i=t(50);n.exports=function(n){return i(n)&&r(n)}},function(n,e,t){var r=t(1),i=t(0),a=t(211).setInterval;r({global:!0,bind:!0,forced:i.setInterval!==a},{setInterval:a})},function(n,e,t){var r=t(1),i=t(0),a=t(211).setTimeout;r({global:!0,bind:!0,forced:i.setTimeout!==a},{setTimeout:a})},function(n,e,t){},function(n,e,t){},function(n,e,t){var r=t(70).PROPER,i=t(3),a=t(154);n.exports=function(n){return i((function(){return!!a[n]()||"âÂá "!=="âÂá "[n]()||r&&a[n].name!==n}))}},function(n,e,t){var r=t(1),i=t(212);r({target:"Function",proto:!0,forced:Function.bind!==i},{bind:i})},function(n,e,t){var r=t(2);n.exports=r(1..valueOf)},function(n,e,t){var r=t(2),i=t(54),a=t(12),o=t(386),l=t(18),s=r(o),c=r("".slice),d=Math.ceil,u=function(n){return function(e,t,r){var o,u,p=a(l(e)),m=i(t),h=p.length,g=void 0===r?" ":a(r);return m<=h||""==g?p:((u=s(g,d((o=m-h)/g.length))).length>o&&(u=c(u,0,o)),n?p+u:u+p)}};n.exports={start:u(!1),end:u(!0)}},function(n,e,t){"use strict";var r=t(0),i=t(46),a=t(12),o=t(18),l=r.RangeError;n.exports=function(n){var e=a(o(this)),t="",r=i(n);if(r<0||r==1/0)throw l("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(t+=e);return t}},function(n,e,t){var r=t(28);n.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},function(n,e,t){"use strict";t(214)},function(n,e,t){"use strict";t(215)},function(n,e,t){"use strict";var r=t(1),i=t(2),a=t(22),o=t(16),l=t(20),s=t(12),c=t(3),d=t(239),u=t(47),p=t(391),m=t(392),h=t(53),g=t(393),f=[],v=i(f.sort),b=i(f.push),y=c((function(){f.sort(void 0)})),x=c((function(){f.sort(null)})),T=u("sort"),k=!c((function(){if(h)return h<70;if(!(p&&p>3)){if(m)return!0;if(g)return g<603;var n,e,t,r,i="";for(n=65;n<76;n++){switch(e=String.fromCharCode(n),n){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(r=0;r<47;r++)f.push({k:e+r,v:t})}for(f.sort((function(n,e){return e.v-n.v})),r=0;r<f.length;r++)e=f[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:y||!x||!T||!k},{sort:function(n){void 0!==n&&a(n);var e=o(this);if(k)return void 0===n?v(e):v(e,n);var t,r,i=[],c=l(e);for(r=0;r<c;r++)r in e&&b(i,e[r]);for(d(i,function(n){return function(e,t){return void 0===t?-1:void 0===e?1:void 0!==n?+n(e,t)||0:s(e)>s(t)?1:-1}}(n)),t=i.length,r=0;r<t;)e[r]=i[r++];for(;r<c;)delete e[r++];return e}})},function(n,e,t){var r=t(28).match(/firefox\/(\d+)/i);n.exports=!!r&&+r[1]},function(n,e,t){var r=t(28);n.exports=/MSIE|Trident/.test(r)},function(n,e,t){var r=t(28).match(/AppleWebKit\/(\d+)\./);n.exports=!!r&&+r[1]},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";var r=t(1),i=t(0),a=t(89),o=t(46),l=t(20),s=t(16),c=t(108),d=t(56),u=t(75)("splice"),p=i.TypeError,m=Math.max,h=Math.min;r({target:"Array",proto:!0,forced:!u},{splice:function(n,e){var t,r,i,u,g,f,v=s(this),b=l(v),y=a(n,b),x=arguments.length;if(0===x?t=r=0:1===x?(t=0,r=b-y):(t=x-2,r=h(m(o(e),0),b-y)),b+t-r>9007199254740991)throw p("Maximum allowed length exceeded");for(i=c(v,r),u=0;u<r;u++)(g=y+u)in v&&d(i,u,v[g]);if(i.length=r,t<r){for(u=y;u<b-r;u++)f=u+t,(g=u+r)in v?v[f]=v[g]:delete v[f];for(u=b;u>b-r+t;u--)delete v[u-1]}else if(t>r)for(u=b-r;u>y;u--)f=u+t-1,(g=u+r-1)in v?v[f]=v[g]:delete v[f];for(u=0;u<t;u++)v[u+y]=arguments[u+2];return v.length=b-r+t,i}})},function(n,e,t){"use strict";t(219)},function(n,e,t){"use strict";t(220)},function(n,e,t){"use strict";t.r(e);t(145),t(245),t(258),t(260);var r=t(95),i=(t(142),t(57),t(6),t(25),t(32),t(44),t(31),Object.freeze({}));function a(n){return null==n}function o(n){return null!=n}function l(n){return!0===n}function s(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function c(n){return null!==n&&"object"==typeof n}var d=Object.prototype.toString;function u(n){return"[object Object]"===d.call(n)}function p(n){return"[object RegExp]"===d.call(n)}function m(n){var e=parseFloat(String(n));return e>=0&&Math.floor(e)===e&&isFinite(n)}function h(n){return o(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function g(n){return null==n?"":Array.isArray(n)||u(n)&&n.toString===d?JSON.stringify(n,null,2):String(n)}function f(n){var e=parseFloat(n);return isNaN(e)?n:e}function v(n,e){for(var t=Object.create(null),r=n.split(","),i=0;i<r.length;i++)t[r[i]]=!0;return e?function(n){return t[n.toLowerCase()]}:function(n){return t[n]}}v("slot,component",!0);var b=v("key,ref,slot,slot-scope,is");function y(n,e){if(n.length){var t=n.indexOf(e);if(t>-1)return n.splice(t,1)}}var x=Object.prototype.hasOwnProperty;function T(n,e){return x.call(n,e)}function k(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var w=/-(\w)/g,I=k((function(n){return n.replace(w,(function(n,e){return e?e.toUpperCase():""}))})),C=k((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),S=/\B([A-Z])/g,E=k((function(n){return n.replace(S,"-$1").toLowerCase()}));var _=Function.prototype.bind?function(n,e){return n.bind(e)}:function(n,e){function t(t){var r=arguments.length;return r?r>1?n.apply(e,arguments):n.call(e,t):n.call(e)}return t._length=n.length,t};function z(n,e){e=e||0;for(var t=n.length-e,r=new Array(t);t--;)r[t]=n[t+e];return r}function A(n,e){for(var t in e)n[t]=e[t];return n}function P(n){for(var e={},t=0;t<n.length;t++)n[t]&&A(e,n[t]);return e}function R(n,e,t){}var B=function(n,e,t){return!1},j=function(n){return n};function D(n,e){if(n===e)return!0;var t=c(n),r=c(e);if(!t||!r)return!t&&!r&&String(n)===String(e);try{var i=Array.isArray(n),a=Array.isArray(e);if(i&&a)return n.length===e.length&&n.every((function(n,t){return D(n,e[t])}));if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(i||a)return!1;var o=Object.keys(n),l=Object.keys(e);return o.length===l.length&&o.every((function(t){return D(n[t],e[t])}))}catch(n){return!1}}function M(n,e){for(var t=0;t<n.length;t++)if(D(n[t],e))return t;return-1}function L(n){var e=!1;return function(){e||(e=!0,n.apply(this,arguments))}}var O=["component","directive","filter"],q=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],F={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:B,isReservedAttr:B,isUnknownElement:B,getTagNamespace:R,parsePlatformTagName:j,mustUseProp:B,async:!0,_lifecycleHooks:q},U=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function N(n,e,t,r){Object.defineProperty(n,e,{value:t,enumerable:!!r,writable:!0,configurable:!0})}var H=new RegExp("[^"+U.source+".$_\\d]");var $,Q="__proto__"in{},W="undefined"!=typeof window,G="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,K=G&&WXEnvironment.platform.toLowerCase(),V=W&&window.navigator.userAgent.toLowerCase(),J=V&&/msie|trident/.test(V),Z=V&&V.indexOf("msie 9.0")>0,X=V&&V.indexOf("edge/")>0,Y=(V&&V.indexOf("android"),V&&/iphone|ipad|ipod|ios/.test(V)||"ios"===K),nn=(V&&/chrome\/\d+/.test(V),V&&/phantomjs/.test(V),V&&V.match(/firefox\/(\d+)/)),en={}.watch,tn=!1;if(W)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){tn=!0}}),window.addEventListener("test-passive",null,rn)}catch(n){}var an=function(){return void 0===$&&($=!W&&!G&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),$},on=W&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ln(n){return"function"==typeof n&&/native code/.test(n.toString())}var sn,cn="undefined"!=typeof Symbol&&ln(Symbol)&&"undefined"!=typeof Reflect&&ln(Reflect.ownKeys);sn="undefined"!=typeof Set&&ln(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var dn=R,un=0,pn=function(){this.id=un++,this.subs=[]};pn.prototype.addSub=function(n){this.subs.push(n)},pn.prototype.removeSub=function(n){y(this.subs,n)},pn.prototype.depend=function(){pn.target&&pn.target.addDep(this)},pn.prototype.notify=function(){var n=this.subs.slice();for(var e=0,t=n.length;e<t;e++)n[e].update()},pn.target=null;var mn=[];function hn(n){mn.push(n),pn.target=n}function gn(){mn.pop(),pn.target=mn[mn.length-1]}var fn=function(n,e,t,r,i,a,o,l){this.tag=n,this.data=e,this.children=t,this.text=r,this.elm=i,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=l,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},vn={child:{configurable:!0}};vn.child.get=function(){return this.componentInstance},Object.defineProperties(fn.prototype,vn);var bn=function(n){void 0===n&&(n="");var e=new fn;return e.text=n,e.isComment=!0,e};function yn(n){return new fn(void 0,void 0,void 0,String(n))}function xn(n){var e=new fn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return e.ns=n.ns,e.isStatic=n.isStatic,e.key=n.key,e.isComment=n.isComment,e.fnContext=n.fnContext,e.fnOptions=n.fnOptions,e.fnScopeId=n.fnScopeId,e.asyncMeta=n.asyncMeta,e.isCloned=!0,e}var Tn=Array.prototype,kn=Object.create(Tn);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var e=Tn[n];N(kn,n,(function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var i,a=e.apply(this,t),o=this.__ob__;switch(n){case"push":case"unshift":i=t;break;case"splice":i=t.slice(2)}return i&&o.observeArray(i),o.dep.notify(),a}))}));var wn=Object.getOwnPropertyNames(kn),In=!0;function Cn(n){In=n}var Sn=function(n){this.value=n,this.dep=new pn,this.vmCount=0,N(n,"__ob__",this),Array.isArray(n)?(Q?function(n,e){n.__proto__=e}(n,kn):function(n,e,t){for(var r=0,i=t.length;r<i;r++){var a=t[r];N(n,a,e[a])}}(n,kn,wn),this.observeArray(n)):this.walk(n)};function En(n,e){var t;if(c(n)&&!(n instanceof fn))return T(n,"__ob__")&&n.__ob__ instanceof Sn?t=n.__ob__:In&&!an()&&(Array.isArray(n)||u(n))&&Object.isExtensible(n)&&!n._isVue&&(t=new Sn(n)),e&&t&&t.vmCount++,t}function _n(n,e,t,r,i){var a=new pn,o=Object.getOwnPropertyDescriptor(n,e);if(!o||!1!==o.configurable){var l=o&&o.get,s=o&&o.set;l&&!s||2!==arguments.length||(t=n[e]);var c=!i&&En(t);Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){var e=l?l.call(n):t;return pn.target&&(a.depend(),c&&(c.dep.depend(),Array.isArray(e)&&Pn(e))),e},set:function(e){var r=l?l.call(n):t;e===r||e!=e&&r!=r||l&&!s||(s?s.call(n,e):t=e,c=!i&&En(e),a.notify())}})}}function zn(n,e,t){if(Array.isArray(n)&&m(e))return n.length=Math.max(n.length,e),n.splice(e,1,t),t;if(e in n&&!(e in Object.prototype))return n[e]=t,t;var r=n.__ob__;return n._isVue||r&&r.vmCount?t:r?(_n(r.value,e,t),r.dep.notify(),t):(n[e]=t,t)}function An(n,e){if(Array.isArray(n)&&m(e))n.splice(e,1);else{var t=n.__ob__;n._isVue||t&&t.vmCount||T(n,e)&&(delete n[e],t&&t.dep.notify())}}function Pn(n){for(var e=void 0,t=0,r=n.length;t<r;t++)(e=n[t])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Pn(e)}Sn.prototype.walk=function(n){for(var e=Object.keys(n),t=0;t<e.length;t++)_n(n,e[t])},Sn.prototype.observeArray=function(n){for(var e=0,t=n.length;e<t;e++)En(n[e])};var Rn=F.optionMergeStrategies;function Bn(n,e){if(!e)return n;for(var t,r,i,a=cn?Reflect.ownKeys(e):Object.keys(e),o=0;o<a.length;o++)"__ob__"!==(t=a[o])&&(r=n[t],i=e[t],T(n,t)?r!==i&&u(r)&&u(i)&&Bn(r,i):zn(n,t,i));return n}function jn(n,e,t){return t?function(){var r="function"==typeof e?e.call(t,t):e,i="function"==typeof n?n.call(t,t):n;return r?Bn(r,i):i}:e?n?function(){return Bn("function"==typeof e?e.call(this,this):e,"function"==typeof n?n.call(this,this):n)}:e:n}function Dn(n,e){var t=e?n?n.concat(e):Array.isArray(e)?e:[e]:n;return t?function(n){for(var e=[],t=0;t<n.length;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}(t):t}function Mn(n,e,t,r){var i=Object.create(n||null);return e?A(i,e):i}Rn.data=function(n,e,t){return t?jn(n,e,t):e&&"function"!=typeof e?n:jn(n,e)},q.forEach((function(n){Rn[n]=Dn})),O.forEach((function(n){Rn[n+"s"]=Mn})),Rn.watch=function(n,e,t,r){if(n===en&&(n=void 0),e===en&&(e=void 0),!e)return Object.create(n||null);if(!n)return e;var i={};for(var a in A(i,n),e){var o=i[a],l=e[a];o&&!Array.isArray(o)&&(o=[o]),i[a]=o?o.concat(l):Array.isArray(l)?l:[l]}return i},Rn.props=Rn.methods=Rn.inject=Rn.computed=function(n,e,t,r){if(!n)return e;var i=Object.create(null);return A(i,n),e&&A(i,e),i},Rn.provide=jn;var Ln=function(n,e){return void 0===e?n:e};function On(n,e,t){if("function"==typeof e&&(e=e.options),function(n,e){var t=n.props;if(t){var r,i,a={};if(Array.isArray(t))for(r=t.length;r--;)"string"==typeof(i=t[r])&&(a[I(i)]={type:null});else if(u(t))for(var o in t)i=t[o],a[I(o)]=u(i)?i:{type:i};else 0;n.props=a}}(e),function(n,e){var t=n.inject;if(t){var r=n.inject={};if(Array.isArray(t))for(var i=0;i<t.length;i++)r[t[i]]={from:t[i]};else if(u(t))for(var a in t){var o=t[a];r[a]=u(o)?A({from:a},o):{from:o}}else 0}}(e),function(n){var e=n.directives;if(e)for(var t in e){var r=e[t];"function"==typeof r&&(e[t]={bind:r,update:r})}}(e),!e._base&&(e.extends&&(n=On(n,e.extends,t)),e.mixins))for(var r=0,i=e.mixins.length;r<i;r++)n=On(n,e.mixins[r],t);var a,o={};for(a in n)l(a);for(a in e)T(n,a)||l(a);function l(r){var i=Rn[r]||Ln;o[r]=i(n[r],e[r],t,r)}return o}function qn(n,e,t,r){if("string"==typeof t){var i=n[e];if(T(i,t))return i[t];var a=I(t);if(T(i,a))return i[a];var o=C(a);return T(i,o)?i[o]:i[t]||i[a]||i[o]}}function Fn(n,e,t,r){var i=e[n],a=!T(t,n),o=t[n],l=$n(Boolean,i.type);if(l>-1)if(a&&!T(i,"default"))o=!1;else if(""===o||o===E(n)){var s=$n(String,i.type);(s<0||l<s)&&(o=!0)}if(void 0===o){o=function(n,e,t){if(!T(e,"default"))return;var r=e.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[t]&&void 0!==n._props[t])return n._props[t];return"function"==typeof r&&"Function"!==Nn(e.type)?r.call(n):r}(r,i,n);var c=In;Cn(!0),En(o),Cn(c)}return o}var Un=/^\s*function (\w+)/;function Nn(n){var e=n&&n.toString().match(Un);return e?e[1]:""}function Hn(n,e){return Nn(n)===Nn(e)}function $n(n,e){if(!Array.isArray(e))return Hn(e,n)?0:-1;for(var t=0,r=e.length;t<r;t++)if(Hn(e[t],n))return t;return-1}function Qn(n,e,t){hn();try{if(e)for(var r=e;r=r.$parent;){var i=r.$options.errorCaptured;if(i)for(var a=0;a<i.length;a++)try{if(!1===i[a].call(r,n,e,t))return}catch(n){Gn(n,r,"errorCaptured hook")}}Gn(n,e,t)}finally{gn()}}function Wn(n,e,t,r,i){var a;try{(a=t?n.apply(e,t):n.call(e))&&!a._isVue&&h(a)&&!a._handled&&(a.catch((function(n){return Qn(n,r,i+" (Promise/async)")})),a._handled=!0)}catch(n){Qn(n,r,i)}return a}function Gn(n,e,t){if(F.errorHandler)try{return F.errorHandler.call(null,n,e,t)}catch(e){e!==n&&Kn(e,null,"config.errorHandler")}Kn(n,e,t)}function Kn(n,e,t){if(!W&&!G||"undefined"==typeof console)throw n;console.error(n)}var Vn,Jn=!1,Zn=[],Xn=!1;function Yn(){Xn=!1;var n=Zn.slice(0);Zn.length=0;for(var e=0;e<n.length;e++)n[e]()}if("undefined"!=typeof Promise&&ln(Promise)){var ne=Promise.resolve();Vn=function(){ne.then(Yn),Y&&setTimeout(R)},Jn=!0}else if(J||"undefined"==typeof MutationObserver||!ln(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Vn="undefined"!=typeof setImmediate&&ln(setImmediate)?function(){setImmediate(Yn)}:function(){setTimeout(Yn,0)};else{var ee=1,te=new MutationObserver(Yn),re=document.createTextNode(String(ee));te.observe(re,{characterData:!0}),Vn=function(){ee=(ee+1)%2,re.data=String(ee)},Jn=!0}function ie(n,e){var t;if(Zn.push((function(){if(n)try{n.call(e)}catch(n){Qn(n,e,"nextTick")}else t&&t(e)})),Xn||(Xn=!0,Vn()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){t=n}))}var ae=new sn;function oe(n){!function n(e,t){var r,i,a=Array.isArray(e);if(!a&&!c(e)||Object.isFrozen(e)||e instanceof fn)return;if(e.__ob__){var o=e.__ob__.dep.id;if(t.has(o))return;t.add(o)}if(a)for(r=e.length;r--;)n(e[r],t);else for(i=Object.keys(e),r=i.length;r--;)n(e[i[r]],t)}(n,ae),ae.clear()}var le=k((function(n){var e="&"===n.charAt(0),t="~"===(n=e?n.slice(1):n).charAt(0),r="!"===(n=t?n.slice(1):n).charAt(0);return{name:n=r?n.slice(1):n,once:t,capture:r,passive:e}}));function se(n,e){function t(){var n=arguments,r=t.fns;if(!Array.isArray(r))return Wn(r,null,arguments,e,"v-on handler");for(var i=r.slice(),a=0;a<i.length;a++)Wn(i[a],null,n,e,"v-on handler")}return t.fns=n,t}function ce(n,e,t,r,i,o){var s,c,d,u;for(s in n)c=n[s],d=e[s],u=le(s),a(c)||(a(d)?(a(c.fns)&&(c=n[s]=se(c,o)),l(u.once)&&(c=n[s]=i(u.name,c,u.capture)),t(u.name,c,u.capture,u.passive,u.params)):c!==d&&(d.fns=c,n[s]=d));for(s in e)a(n[s])&&r((u=le(s)).name,e[s],u.capture)}function de(n,e,t){var r;n instanceof fn&&(n=n.data.hook||(n.data.hook={}));var i=n[e];function s(){t.apply(this,arguments),y(r.fns,s)}a(i)?r=se([s]):o(i.fns)&&l(i.merged)?(r=i).fns.push(s):r=se([i,s]),r.merged=!0,n[e]=r}function ue(n,e,t,r,i){if(o(e)){if(T(e,t))return n[t]=e[t],i||delete e[t],!0;if(T(e,r))return n[t]=e[r],i||delete e[r],!0}return!1}function pe(n){return s(n)?[yn(n)]:Array.isArray(n)?function n(e,t){var r,i,c,d,u=[];for(r=0;r<e.length;r++)a(i=e[r])||"boolean"==typeof i||(c=u.length-1,d=u[c],Array.isArray(i)?i.length>0&&(me((i=n(i,(t||"")+"_"+r))[0])&&me(d)&&(u[c]=yn(d.text+i[0].text),i.shift()),u.push.apply(u,i)):s(i)?me(d)?u[c]=yn(d.text+i):""!==i&&u.push(yn(i)):me(i)&&me(d)?u[c]=yn(d.text+i.text):(l(e._isVList)&&o(i.tag)&&a(i.key)&&o(t)&&(i.key="__vlist"+t+"_"+r+"__"),u.push(i)));return u}(n):void 0}function me(n){return o(n)&&o(n.text)&&!1===n.isComment}function he(n,e){if(n){for(var t=Object.create(null),r=cn?Reflect.ownKeys(n):Object.keys(n),i=0;i<r.length;i++){var a=r[i];if("__ob__"!==a){for(var o=n[a].from,l=e;l;){if(l._provided&&T(l._provided,o)){t[a]=l._provided[o];break}l=l.$parent}if(!l)if("default"in n[a]){var s=n[a].default;t[a]="function"==typeof s?s.call(e):s}else 0}}return t}}function ge(n,e){if(!n||!n.length)return{};for(var t={},r=0,i=n.length;r<i;r++){var a=n[r],o=a.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,a.context!==e&&a.fnContext!==e||!o||null==o.slot)(t.default||(t.default=[])).push(a);else{var l=o.slot,s=t[l]||(t[l]=[]);"template"===a.tag?s.push.apply(s,a.children||[]):s.push(a)}}for(var c in t)t[c].every(fe)&&delete t[c];return t}function fe(n){return n.isComment&&!n.asyncFactory||" "===n.text}function ve(n){return n.isComment&&n.asyncFactory}function be(n,e,t){var r,a=Object.keys(e).length>0,o=n?!!n.$stable:!a,l=n&&n.$key;if(n){if(n._normalized)return n._normalized;if(o&&t&&t!==i&&l===t.$key&&!a&&!t.$hasNormal)return t;for(var s in r={},n)n[s]&&"$"!==s[0]&&(r[s]=ye(e,s,n[s]))}else r={};for(var c in e)c in r||(r[c]=xe(e,c));return n&&Object.isExtensible(n)&&(n._normalized=r),N(r,"$stable",o),N(r,"$key",l),N(r,"$hasNormal",a),r}function ye(n,e,t){var r=function(){var n=arguments.length?t.apply(null,arguments):t({}),e=(n=n&&"object"==typeof n&&!Array.isArray(n)?[n]:pe(n))&&n[0];return n&&(!e||1===n.length&&e.isComment&&!ve(e))?void 0:n};return t.proxy&&Object.defineProperty(n,e,{get:r,enumerable:!0,configurable:!0}),r}function xe(n,e){return function(){return n[e]}}function Te(n,e){var t,r,i,a,l;if(Array.isArray(n)||"string"==typeof n)for(t=new Array(n.length),r=0,i=n.length;r<i;r++)t[r]=e(n[r],r);else if("number"==typeof n)for(t=new Array(n),r=0;r<n;r++)t[r]=e(r+1,r);else if(c(n))if(cn&&n[Symbol.iterator]){t=[];for(var s=n[Symbol.iterator](),d=s.next();!d.done;)t.push(e(d.value,t.length)),d=s.next()}else for(a=Object.keys(n),t=new Array(a.length),r=0,i=a.length;r<i;r++)l=a[r],t[r]=e(n[l],l,r);return o(t)||(t=[]),t._isVList=!0,t}function ke(n,e,t,r){var i,a=this.$scopedSlots[n];a?(t=t||{},r&&(t=A(A({},r),t)),i=a(t)||("function"==typeof e?e():e)):i=this.$slots[n]||("function"==typeof e?e():e);var o=t&&t.slot;return o?this.$createElement("template",{slot:o},i):i}function we(n){return qn(this.$options,"filters",n)||j}function Ie(n,e){return Array.isArray(n)?-1===n.indexOf(e):n!==e}function Ce(n,e,t,r,i){var a=F.keyCodes[e]||t;return i&&r&&!F.keyCodes[e]?Ie(i,r):a?Ie(a,n):r?E(r)!==e:void 0===n}function Se(n,e,t,r,i){if(t)if(c(t)){var a;Array.isArray(t)&&(t=P(t));var o=function(o){if("class"===o||"style"===o||b(o))a=n;else{var l=n.attrs&&n.attrs.type;a=r||F.mustUseProp(e,l,o)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var s=I(o),c=E(o);s in a||c in a||(a[o]=t[o],i&&((n.on||(n.on={}))["update:"+o]=function(n){t[o]=n}))};for(var l in t)o(l)}else;return n}function Ee(n,e){var t=this._staticTrees||(this._staticTrees=[]),r=t[n];return r&&!e||ze(r=t[n]=this.$options.staticRenderFns[n].call(this._renderProxy,null,this),"__static__"+n,!1),r}function _e(n,e,t){return ze(n,"__once__"+e+(t?"_"+t:""),!0),n}function ze(n,e,t){if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r]&&"string"!=typeof n[r]&&Ae(n[r],e+"_"+r,t);else Ae(n,e,t)}function Ae(n,e,t){n.isStatic=!0,n.key=e,n.isOnce=t}function Pe(n,e){if(e)if(u(e)){var t=n.on=n.on?A({},n.on):{};for(var r in e){var i=t[r],a=e[r];t[r]=i?[].concat(i,a):a}}else;return n}function Re(n,e,t,r){e=e||{$stable:!t};for(var i=0;i<n.length;i++){var a=n[i];Array.isArray(a)?Re(a,e,t):a&&(a.proxy&&(a.fn.proxy=!0),e[a.key]=a.fn)}return r&&(e.$key=r),e}function Be(n,e){for(var t=0;t<e.length;t+=2){var r=e[t];"string"==typeof r&&r&&(n[e[t]]=e[t+1])}return n}function je(n,e){return"string"==typeof n?e+n:n}function De(n){n._o=_e,n._n=f,n._s=g,n._l=Te,n._t=ke,n._q=D,n._i=M,n._m=Ee,n._f=we,n._k=Ce,n._b=Se,n._v=yn,n._e=bn,n._u=Re,n._g=Pe,n._d=Be,n._p=je}function Me(n,e,t,r,a){var o,s=this,c=a.options;T(r,"_uid")?(o=Object.create(r))._original=r:(o=r,r=r._original);var d=l(c._compiled),u=!d;this.data=n,this.props=e,this.children=t,this.parent=r,this.listeners=n.on||i,this.injections=he(c.inject,r),this.slots=function(){return s.$slots||be(n.scopedSlots,s.$slots=ge(t,r)),s.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return be(n.scopedSlots,this.slots())}}),d&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=be(n.scopedSlots,this.$slots)),c._scopeId?this._c=function(n,e,t,i){var a=He(o,n,e,t,i,u);return a&&!Array.isArray(a)&&(a.fnScopeId=c._scopeId,a.fnContext=r),a}:this._c=function(n,e,t,r){return He(o,n,e,t,r,u)}}function Le(n,e,t,r,i){var a=xn(n);return a.fnContext=t,a.fnOptions=r,e.slot&&((a.data||(a.data={})).slot=e.slot),a}function Oe(n,e){for(var t in e)n[I(t)]=e[t]}De(Me.prototype);var qe={init:function(n,e){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var t=n;qe.prepatch(t,t)}else{(n.componentInstance=function(n,e){var t={_isComponent:!0,_parentVnode:n,parent:e},r=n.data.inlineTemplate;o(r)&&(t.render=r.render,t.staticRenderFns=r.staticRenderFns);return new n.componentOptions.Ctor(t)}(n,Xe)).$mount(e?n.elm:void 0,e)}},prepatch:function(n,e){var t=e.componentOptions;!function(n,e,t,r,a){0;var o=r.data.scopedSlots,l=n.$scopedSlots,s=!!(o&&!o.$stable||l!==i&&!l.$stable||o&&n.$scopedSlots.$key!==o.$key||!o&&n.$scopedSlots.$key),c=!!(a||n.$options._renderChildren||s);n.$options._parentVnode=r,n.$vnode=r,n._vnode&&(n._vnode.parent=r);if(n.$options._renderChildren=a,n.$attrs=r.data.attrs||i,n.$listeners=t||i,e&&n.$options.props){Cn(!1);for(var d=n._props,u=n.$options._propKeys||[],p=0;p<u.length;p++){var m=u[p],h=n.$options.props;d[m]=Fn(m,h,e,n)}Cn(!0),n.$options.propsData=e}t=t||i;var g=n.$options._parentListeners;n.$options._parentListeners=t,Ze(n,t,g),c&&(n.$slots=ge(a,r.context),n.$forceUpdate());0}(e.componentInstance=n.componentInstance,t.propsData,t.listeners,e,t.children)},insert:function(n){var e,t=n.context,r=n.componentInstance;r._isMounted||(r._isMounted=!0,tt(r,"mounted")),n.data.keepAlive&&(t._isMounted?((e=r)._inactive=!1,it.push(e)):et(r,!0))},destroy:function(n){var e=n.componentInstance;e._isDestroyed||(n.data.keepAlive?function n(e,t){if(t&&(e._directInactive=!0,nt(e)))return;if(!e._inactive){e._inactive=!0;for(var r=0;r<e.$children.length;r++)n(e.$children[r]);tt(e,"deactivated")}}(e,!0):e.$destroy())}},Fe=Object.keys(qe);function Ue(n,e,t,r,s){if(!a(n)){var d=t.$options._base;if(c(n)&&(n=d.extend(n)),"function"==typeof n){var u;if(a(n.cid)&&void 0===(n=function(n,e){if(l(n.error)&&o(n.errorComp))return n.errorComp;if(o(n.resolved))return n.resolved;var t=Qe;t&&o(n.owners)&&-1===n.owners.indexOf(t)&&n.owners.push(t);if(l(n.loading)&&o(n.loadingComp))return n.loadingComp;if(t&&!o(n.owners)){var r=n.owners=[t],i=!0,s=null,d=null;t.$on("hook:destroyed",(function(){return y(r,t)}));var u=function(n){for(var e=0,t=r.length;e<t;e++)r[e].$forceUpdate();n&&(r.length=0,null!==s&&(clearTimeout(s),s=null),null!==d&&(clearTimeout(d),d=null))},p=L((function(t){n.resolved=We(t,e),i?r.length=0:u(!0)})),m=L((function(e){o(n.errorComp)&&(n.error=!0,u(!0))})),g=n(p,m);return c(g)&&(h(g)?a(n.resolved)&&g.then(p,m):h(g.component)&&(g.component.then(p,m),o(g.error)&&(n.errorComp=We(g.error,e)),o(g.loading)&&(n.loadingComp=We(g.loading,e),0===g.delay?n.loading=!0:s=setTimeout((function(){s=null,a(n.resolved)&&a(n.error)&&(n.loading=!0,u(!1))}),g.delay||200)),o(g.timeout)&&(d=setTimeout((function(){d=null,a(n.resolved)&&m(null)}),g.timeout)))),i=!1,n.loading?n.loadingComp:n.resolved}}(u=n,d)))return function(n,e,t,r,i){var a=bn();return a.asyncFactory=n,a.asyncMeta={data:e,context:t,children:r,tag:i},a}(u,e,t,r,s);e=e||{},It(n),o(e.model)&&function(n,e){var t=n.model&&n.model.prop||"value",r=n.model&&n.model.event||"input";(e.attrs||(e.attrs={}))[t]=e.model.value;var i=e.on||(e.on={}),a=i[r],l=e.model.callback;o(a)?(Array.isArray(a)?-1===a.indexOf(l):a!==l)&&(i[r]=[l].concat(a)):i[r]=l}(n.options,e);var p=function(n,e,t){var r=e.options.props;if(!a(r)){var i={},l=n.attrs,s=n.props;if(o(l)||o(s))for(var c in r){var d=E(c);ue(i,s,c,d,!0)||ue(i,l,c,d,!1)}return i}}(e,n);if(l(n.options.functional))return function(n,e,t,r,a){var l=n.options,s={},c=l.props;if(o(c))for(var d in c)s[d]=Fn(d,c,e||i);else o(t.attrs)&&Oe(s,t.attrs),o(t.props)&&Oe(s,t.props);var u=new Me(t,s,a,r,n),p=l.render.call(null,u._c,u);if(p instanceof fn)return Le(p,t,u.parent,l,u);if(Array.isArray(p)){for(var m=pe(p)||[],h=new Array(m.length),g=0;g<m.length;g++)h[g]=Le(m[g],t,u.parent,l,u);return h}}(n,p,e,t,r);var m=e.on;if(e.on=e.nativeOn,l(n.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(n){for(var e=n.hook||(n.hook={}),t=0;t<Fe.length;t++){var r=Fe[t],i=e[r],a=qe[r];i===a||i&&i._merged||(e[r]=i?Ne(a,i):a)}}(e);var f=n.options.name||s;return new fn("vue-component-"+n.cid+(f?"-"+f:""),e,void 0,void 0,void 0,t,{Ctor:n,propsData:p,listeners:m,tag:s,children:r},u)}}}function Ne(n,e){var t=function(t,r){n(t,r),e(t,r)};return t._merged=!0,t}function He(n,e,t,r,i,d){return(Array.isArray(t)||s(t))&&(i=r,r=t,t=void 0),l(d)&&(i=2),function(n,e,t,r,i){if(o(t)&&o(t.__ob__))return bn();o(t)&&o(t.is)&&(e=t.is);if(!e)return bn();0;Array.isArray(r)&&"function"==typeof r[0]&&((t=t||{}).scopedSlots={default:r[0]},r.length=0);2===i?r=pe(r):1===i&&(r=function(n){for(var e=0;e<n.length;e++)if(Array.isArray(n[e]))return Array.prototype.concat.apply([],n);return n}(r));var s,d;if("string"==typeof e){var u;d=n.$vnode&&n.$vnode.ns||F.getTagNamespace(e),s=F.isReservedTag(e)?new fn(F.parsePlatformTagName(e),t,r,void 0,void 0,n):t&&t.pre||!o(u=qn(n.$options,"components",e))?new fn(e,t,r,void 0,void 0,n):Ue(u,t,n,r,e)}else s=Ue(e,t,n,r);return Array.isArray(s)?s:o(s)?(o(d)&&function n(e,t,r){e.ns=t,"foreignObject"===e.tag&&(t=void 0,r=!0);if(o(e.children))for(var i=0,s=e.children.length;i<s;i++){var c=e.children[i];o(c.tag)&&(a(c.ns)||l(r)&&"svg"!==c.tag)&&n(c,t,r)}}(s,d),o(t)&&function(n){c(n.style)&&oe(n.style);c(n.class)&&oe(n.class)}(t),s):bn()}(n,e,t,r,i)}var $e,Qe=null;function We(n,e){return(n.__esModule||cn&&"Module"===n[Symbol.toStringTag])&&(n=n.default),c(n)?e.extend(n):n}function Ge(n){if(Array.isArray(n))for(var e=0;e<n.length;e++){var t=n[e];if(o(t)&&(o(t.componentOptions)||ve(t)))return t}}function Ke(n,e){$e.$on(n,e)}function Ve(n,e){$e.$off(n,e)}function Je(n,e){var t=$e;return function r(){var i=e.apply(null,arguments);null!==i&&t.$off(n,r)}}function Ze(n,e,t){$e=n,ce(e,t||{},Ke,Ve,Je,n),$e=void 0}var Xe=null;function Ye(n){var e=Xe;return Xe=n,function(){Xe=e}}function nt(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function et(n,e){if(e){if(n._directInactive=!1,nt(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var t=0;t<n.$children.length;t++)et(n.$children[t]);tt(n,"activated")}}function tt(n,e){hn();var t=n.$options[e],r=e+" hook";if(t)for(var i=0,a=t.length;i<a;i++)Wn(t[i],n,null,n,r);n._hasHookEvent&&n.$emit("hook:"+e),gn()}var rt=[],it=[],at={},ot=!1,lt=!1,st=0;var ct=0,dt=Date.now;if(W&&!J){var ut=window.performance;ut&&"function"==typeof ut.now&&dt()>document.createEvent("Event").timeStamp&&(dt=function(){return ut.now()})}function pt(){var n,e;for(ct=dt(),lt=!0,rt.sort((function(n,e){return n.id-e.id})),st=0;st<rt.length;st++)(n=rt[st]).before&&n.before(),e=n.id,at[e]=null,n.run();var t=it.slice(),r=rt.slice();st=rt.length=it.length=0,at={},ot=lt=!1,function(n){for(var e=0;e<n.length;e++)n[e]._inactive=!0,et(n[e],!0)}(t),function(n){var e=n.length;for(;e--;){var t=n[e],r=t.vm;r._watcher===t&&r._isMounted&&!r._isDestroyed&&tt(r,"updated")}}(r),on&&F.devtools&&on.emit("flush")}var mt=0,ht=function(n,e,t,r,i){this.vm=n,i&&(n._watcher=this),n._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=t,this.id=++mt,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new sn,this.newDepIds=new sn,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(n){if(!H.test(n)){var e=n.split(".");return function(n){for(var t=0;t<e.length;t++){if(!n)return;n=n[e[t]]}return n}}}(e),this.getter||(this.getter=R)),this.value=this.lazy?void 0:this.get()};ht.prototype.get=function(){var n;hn(this);var e=this.vm;try{n=this.getter.call(e,e)}catch(n){if(!this.user)throw n;Qn(n,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&oe(n),gn(),this.cleanupDeps()}return n},ht.prototype.addDep=function(n){var e=n.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(n),this.depIds.has(e)||n.addSub(this))},ht.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var e=this.deps[n];this.newDepIds.has(e.id)||e.removeSub(this)}var t=this.depIds;this.depIds=this.newDepIds,this.newDepIds=t,this.newDepIds.clear(),t=this.deps,this.deps=this.newDeps,this.newDeps=t,this.newDeps.length=0},ht.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(n){var e=n.id;if(null==at[e]){if(at[e]=!0,lt){for(var t=rt.length-1;t>st&&rt[t].id>n.id;)t--;rt.splice(t+1,0,n)}else rt.push(n);ot||(ot=!0,ie(pt))}}(this)},ht.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||c(n)||this.deep){var e=this.value;if(this.value=n,this.user){var t='callback for watcher "'+this.expression+'"';Wn(this.cb,this.vm,[n,e],this.vm,t)}else this.cb.call(this.vm,n,e)}}},ht.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ht.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},ht.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1}};var gt={enumerable:!0,configurable:!0,get:R,set:R};function ft(n,e,t){gt.get=function(){return this[e][t]},gt.set=function(n){this[e][t]=n},Object.defineProperty(n,t,gt)}function vt(n){n._watchers=[];var e=n.$options;e.props&&function(n,e){var t=n.$options.propsData||{},r=n._props={},i=n.$options._propKeys=[];n.$parent&&Cn(!1);var a=function(a){i.push(a);var o=Fn(a,e,t,n);_n(r,a,o),a in n||ft(n,"_props",a)};for(var o in e)a(o);Cn(!0)}(n,e.props),e.methods&&function(n,e){n.$options.props;for(var t in e)n[t]="function"!=typeof e[t]?R:_(e[t],n)}(n,e.methods),e.data?function(n){var e=n.$options.data;u(e=n._data="function"==typeof e?function(n,e){hn();try{return n.call(e,e)}catch(n){return Qn(n,e,"data()"),{}}finally{gn()}}(e,n):e||{})||(e={});var t=Object.keys(e),r=n.$options.props,i=(n.$options.methods,t.length);for(;i--;){var a=t[i];0,r&&T(r,a)||(o=void 0,36!==(o=(a+"").charCodeAt(0))&&95!==o&&ft(n,"_data",a))}var o;En(e,!0)}(n):En(n._data={},!0),e.computed&&function(n,e){var t=n._computedWatchers=Object.create(null),r=an();for(var i in e){var a=e[i],o="function"==typeof a?a:a.get;0,r||(t[i]=new ht(n,o||R,R,bt)),i in n||yt(n,i,a)}}(n,e.computed),e.watch&&e.watch!==en&&function(n,e){for(var t in e){var r=e[t];if(Array.isArray(r))for(var i=0;i<r.length;i++)kt(n,t,r[i]);else kt(n,t,r)}}(n,e.watch)}var bt={lazy:!0};function yt(n,e,t){var r=!an();"function"==typeof t?(gt.get=r?xt(e):Tt(t),gt.set=R):(gt.get=t.get?r&&!1!==t.cache?xt(e):Tt(t.get):R,gt.set=t.set||R),Object.defineProperty(n,e,gt)}function xt(n){return function(){var e=this._computedWatchers&&this._computedWatchers[n];if(e)return e.dirty&&e.evaluate(),pn.target&&e.depend(),e.value}}function Tt(n){return function(){return n.call(this,this)}}function kt(n,e,t,r){return u(t)&&(r=t,t=t.handler),"string"==typeof t&&(t=n[t]),n.$watch(e,t,r)}var wt=0;function It(n){var e=n.options;if(n.super){var t=It(n.super);if(t!==n.superOptions){n.superOptions=t;var r=function(n){var e,t=n.options,r=n.sealedOptions;for(var i in t)t[i]!==r[i]&&(e||(e={}),e[i]=t[i]);return e}(n);r&&A(n.extendOptions,r),(e=n.options=On(t,n.extendOptions)).name&&(e.components[e.name]=n)}}return e}function Ct(n){this._init(n)}function St(n){n.cid=0;var e=1;n.extend=function(n){n=n||{};var t=this,r=t.cid,i=n._Ctor||(n._Ctor={});if(i[r])return i[r];var a=n.name||t.options.name;var o=function(n){this._init(n)};return(o.prototype=Object.create(t.prototype)).constructor=o,o.cid=e++,o.options=On(t.options,n),o.super=t,o.options.props&&function(n){var e=n.options.props;for(var t in e)ft(n.prototype,"_props",t)}(o),o.options.computed&&function(n){var e=n.options.computed;for(var t in e)yt(n.prototype,t,e[t])}(o),o.extend=t.extend,o.mixin=t.mixin,o.use=t.use,O.forEach((function(n){o[n]=t[n]})),a&&(o.options.components[a]=o),o.superOptions=t.options,o.extendOptions=n,o.sealedOptions=A({},o.options),i[r]=o,o}}function Et(n){return n&&(n.Ctor.options.name||n.tag)}function _t(n,e){return Array.isArray(n)?n.indexOf(e)>-1:"string"==typeof n?n.split(",").indexOf(e)>-1:!!p(n)&&n.test(e)}function zt(n,e){var t=n.cache,r=n.keys,i=n._vnode;for(var a in t){var o=t[a];if(o){var l=o.name;l&&!e(l)&&At(t,a,r,i)}}}function At(n,e,t,r){var i=n[e];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),n[e]=null,y(t,e)}!function(n){n.prototype._init=function(n){var e=this;e._uid=wt++,e._isVue=!0,n&&n._isComponent?function(n,e){var t=n.$options=Object.create(n.constructor.options),r=e._parentVnode;t.parent=e.parent,t._parentVnode=r;var i=r.componentOptions;t.propsData=i.propsData,t._parentListeners=i.listeners,t._renderChildren=i.children,t._componentTag=i.tag,e.render&&(t.render=e.render,t.staticRenderFns=e.staticRenderFns)}(e,n):e.$options=On(It(e.constructor),n||{},e),e._renderProxy=e,e._self=e,function(n){var e=n.$options,t=e.parent;if(t&&!e.abstract){for(;t.$options.abstract&&t.$parent;)t=t.$parent;t.$children.push(n)}n.$parent=t,n.$root=t?t.$root:n,n.$children=[],n.$refs={},n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(e),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var e=n.$options._parentListeners;e&&Ze(n,e)}(e),function(n){n._vnode=null,n._staticTrees=null;var e=n.$options,t=n.$vnode=e._parentVnode,r=t&&t.context;n.$slots=ge(e._renderChildren,r),n.$scopedSlots=i,n._c=function(e,t,r,i){return He(n,e,t,r,i,!1)},n.$createElement=function(e,t,r,i){return He(n,e,t,r,i,!0)};var a=t&&t.data;_n(n,"$attrs",a&&a.attrs||i,null,!0),_n(n,"$listeners",e._parentListeners||i,null,!0)}(e),tt(e,"beforeCreate"),function(n){var e=he(n.$options.inject,n);e&&(Cn(!1),Object.keys(e).forEach((function(t){_n(n,t,e[t])})),Cn(!0))}(e),vt(e),function(n){var e=n.$options.provide;e&&(n._provided="function"==typeof e?e.call(n):e)}(e),tt(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(Ct),function(n){var e={get:function(){return this._data}},t={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",e),Object.defineProperty(n.prototype,"$props",t),n.prototype.$set=zn,n.prototype.$delete=An,n.prototype.$watch=function(n,e,t){if(u(e))return kt(this,n,e,t);(t=t||{}).user=!0;var r=new ht(this,n,e,t);if(t.immediate){var i='callback for immediate watcher "'+r.expression+'"';hn(),Wn(e,this,[r.value],this,i),gn()}return function(){r.teardown()}}}(Ct),function(n){var e=/^hook:/;n.prototype.$on=function(n,t){var r=this;if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)r.$on(n[i],t);else(r._events[n]||(r._events[n]=[])).push(t),e.test(n)&&(r._hasHookEvent=!0);return r},n.prototype.$once=function(n,e){var t=this;function r(){t.$off(n,r),e.apply(t,arguments)}return r.fn=e,t.$on(n,r),t},n.prototype.$off=function(n,e){var t=this;if(!arguments.length)return t._events=Object.create(null),t;if(Array.isArray(n)){for(var r=0,i=n.length;r<i;r++)t.$off(n[r],e);return t}var a,o=t._events[n];if(!o)return t;if(!e)return t._events[n]=null,t;for(var l=o.length;l--;)if((a=o[l])===e||a.fn===e){o.splice(l,1);break}return t},n.prototype.$emit=function(n){var e=this,t=e._events[n];if(t){t=t.length>1?z(t):t;for(var r=z(arguments,1),i='event handler for "'+n+'"',a=0,o=t.length;a<o;a++)Wn(t[a],e,r,e,i)}return e}}(Ct),function(n){n.prototype._update=function(n,e){var t=this,r=t.$el,i=t._vnode,a=Ye(t);t._vnode=n,t.$el=i?t.__patch__(i,n):t.__patch__(t.$el,n,e,!1),a(),r&&(r.__vue__=null),t.$el&&(t.$el.__vue__=t),t.$vnode&&t.$parent&&t.$vnode===t.$parent._vnode&&(t.$parent.$el=t.$el)},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){tt(n,"beforeDestroy"),n._isBeingDestroyed=!0;var e=n.$parent;!e||e._isBeingDestroyed||n.$options.abstract||y(e.$children,n),n._watcher&&n._watcher.teardown();for(var t=n._watchers.length;t--;)n._watchers[t].teardown();n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),tt(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}(Ct),function(n){De(n.prototype),n.prototype.$nextTick=function(n){return ie(n,this)},n.prototype._render=function(){var n,e=this,t=e.$options,r=t.render,i=t._parentVnode;i&&(e.$scopedSlots=be(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{Qe=e,n=r.call(e._renderProxy,e.$createElement)}catch(t){Qn(t,e,"render"),n=e._vnode}finally{Qe=null}return Array.isArray(n)&&1===n.length&&(n=n[0]),n instanceof fn||(n=bn()),n.parent=i,n}}(Ct);var Pt=[String,RegExp,Array],Rt={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Pt,exclude:Pt,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,e=this.keys,t=this.vnodeToCache,r=this.keyToCache;if(t){var i=t.tag,a=t.componentInstance,o=t.componentOptions;n[r]={name:Et(o),tag:i,componentInstance:a},e.push(r),this.max&&e.length>parseInt(this.max)&&At(n,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)At(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(e){zt(n,(function(n){return _t(e,n)}))})),this.$watch("exclude",(function(e){zt(n,(function(n){return!_t(e,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,e=Ge(n),t=e&&e.componentOptions;if(t){var r=Et(t),i=this.include,a=this.exclude;if(i&&(!r||!_t(i,r))||a&&r&&_t(a,r))return e;var o=this.cache,l=this.keys,s=null==e.key?t.Ctor.cid+(t.tag?"::"+t.tag:""):e.key;o[s]?(e.componentInstance=o[s].componentInstance,y(l,s),l.push(s)):(this.vnodeToCache=e,this.keyToCache=s),e.data.keepAlive=!0}return e||n&&n[0]}}};!function(n){var e={get:function(){return F}};Object.defineProperty(n,"config",e),n.util={warn:dn,extend:A,mergeOptions:On,defineReactive:_n},n.set=zn,n.delete=An,n.nextTick=ie,n.observable=function(n){return En(n),n},n.options=Object.create(null),O.forEach((function(e){n.options[e+"s"]=Object.create(null)})),n.options._base=n,A(n.options.components,Rt),function(n){n.use=function(n){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(n)>-1)return this;var t=z(arguments,1);return t.unshift(this),"function"==typeof n.install?n.install.apply(n,t):"function"==typeof n&&n.apply(null,t),e.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=On(this.options,n),this}}(n),St(n),function(n){O.forEach((function(e){n[e]=function(n,t){return t?("component"===e&&u(t)&&(t.name=t.name||n,t=this.options._base.extend(t)),"directive"===e&&"function"==typeof t&&(t={bind:t,update:t}),this.options[e+"s"][n]=t,t):this.options[e+"s"][n]}}))}(n)}(Ct),Object.defineProperty(Ct.prototype,"$isServer",{get:an}),Object.defineProperty(Ct.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Ct,"FunctionalRenderContext",{value:Me}),Ct.version="2.6.14";var Bt=v("style,class"),jt=v("input,textarea,option,select,progress"),Dt=v("contenteditable,draggable,spellcheck"),Mt=v("events,caret,typing,plaintext-only"),Lt=v("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Ot="http://www.w3.org/1999/xlink",qt=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},Ft=function(n){return qt(n)?n.slice(6,n.length):""},Ut=function(n){return null==n||!1===n};function Nt(n){for(var e=n.data,t=n,r=n;o(r.componentInstance);)(r=r.componentInstance._vnode)&&r.data&&(e=Ht(r.data,e));for(;o(t=t.parent);)t&&t.data&&(e=Ht(e,t.data));return function(n,e){if(o(n)||o(e))return $t(n,Qt(e));return""}(e.staticClass,e.class)}function Ht(n,e){return{staticClass:$t(n.staticClass,e.staticClass),class:o(n.class)?[n.class,e.class]:e.class}}function $t(n,e){return n?e?n+" "+e:n:e||""}function Qt(n){return Array.isArray(n)?function(n){for(var e,t="",r=0,i=n.length;r<i;r++)o(e=Qt(n[r]))&&""!==e&&(t&&(t+=" "),t+=e);return t}(n):c(n)?function(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}(n):"string"==typeof n?n:""}var Wt={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Gt=v("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Kt=v("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Vt=function(n){return Gt(n)||Kt(n)};var Jt=Object.create(null);var Zt=v("text,number,password,search,email,tel,url");var Xt=Object.freeze({createElement:function(n,e){var t=document.createElement(n);return"select"!==n||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&t.setAttribute("multiple","multiple"),t},createElementNS:function(n,e){return document.createElementNS(Wt[n],e)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,e,t){n.insertBefore(e,t)},removeChild:function(n,e){n.removeChild(e)},appendChild:function(n,e){n.appendChild(e)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,e){n.textContent=e},setStyleScope:function(n,e){n.setAttribute(e,"")}}),Yt={create:function(n,e){nr(e)},update:function(n,e){n.data.ref!==e.data.ref&&(nr(n,!0),nr(e))},destroy:function(n){nr(n,!0)}};function nr(n,e){var t=n.data.ref;if(o(t)){var r=n.context,i=n.componentInstance||n.elm,a=r.$refs;e?Array.isArray(a[t])?y(a[t],i):a[t]===i&&(a[t]=void 0):n.data.refInFor?Array.isArray(a[t])?a[t].indexOf(i)<0&&a[t].push(i):a[t]=[i]:a[t]=i}}var er=new fn("",{},[]),tr=["create","activate","update","remove","destroy"];function rr(n,e){return n.key===e.key&&n.asyncFactory===e.asyncFactory&&(n.tag===e.tag&&n.isComment===e.isComment&&o(n.data)===o(e.data)&&function(n,e){if("input"!==n.tag)return!0;var t,r=o(t=n.data)&&o(t=t.attrs)&&t.type,i=o(t=e.data)&&o(t=t.attrs)&&t.type;return r===i||Zt(r)&&Zt(i)}(n,e)||l(n.isAsyncPlaceholder)&&a(e.asyncFactory.error))}function ir(n,e,t){var r,i,a={};for(r=e;r<=t;++r)o(i=n[r].key)&&(a[i]=r);return a}var ar={create:or,update:or,destroy:function(n){or(n,er)}};function or(n,e){(n.data.directives||e.data.directives)&&function(n,e){var t,r,i,a=n===er,o=e===er,l=sr(n.data.directives,n.context),s=sr(e.data.directives,e.context),c=[],d=[];for(t in s)r=l[t],i=s[t],r?(i.oldValue=r.value,i.oldArg=r.arg,dr(i,"update",e,n),i.def&&i.def.componentUpdated&&d.push(i)):(dr(i,"bind",e,n),i.def&&i.def.inserted&&c.push(i));if(c.length){var u=function(){for(var t=0;t<c.length;t++)dr(c[t],"inserted",e,n)};a?de(e,"insert",u):u()}d.length&&de(e,"postpatch",(function(){for(var t=0;t<d.length;t++)dr(d[t],"componentUpdated",e,n)}));if(!a)for(t in l)s[t]||dr(l[t],"unbind",n,n,o)}(n,e)}var lr=Object.create(null);function sr(n,e){var t,r,i=Object.create(null);if(!n)return i;for(t=0;t<n.length;t++)(r=n[t]).modifiers||(r.modifiers=lr),i[cr(r)]=r,r.def=qn(e.$options,"directives",r.name);return i}function cr(n){return n.rawName||n.name+"."+Object.keys(n.modifiers||{}).join(".")}function dr(n,e,t,r,i){var a=n.def&&n.def[e];if(a)try{a(t.elm,n,t,r,i)}catch(r){Qn(r,t.context,"directive "+n.name+" "+e+" hook")}}var ur=[Yt,ar];function pr(n,e){var t=e.componentOptions;if(!(o(t)&&!1===t.Ctor.options.inheritAttrs||a(n.data.attrs)&&a(e.data.attrs))){var r,i,l=e.elm,s=n.data.attrs||{},c=e.data.attrs||{};for(r in o(c.__ob__)&&(c=e.data.attrs=A({},c)),c)i=c[r],s[r]!==i&&mr(l,r,i,e.data.pre);for(r in(J||X)&&c.value!==s.value&&mr(l,"value",c.value),s)a(c[r])&&(qt(r)?l.removeAttributeNS(Ot,Ft(r)):Dt(r)||l.removeAttribute(r))}}function mr(n,e,t,r){r||n.tagName.indexOf("-")>-1?hr(n,e,t):Lt(e)?Ut(t)?n.removeAttribute(e):(t="allowfullscreen"===e&&"EMBED"===n.tagName?"true":e,n.setAttribute(e,t)):Dt(e)?n.setAttribute(e,function(n,e){return Ut(e)||"false"===e?"false":"contenteditable"===n&&Mt(e)?e:"true"}(e,t)):qt(e)?Ut(t)?n.removeAttributeNS(Ot,Ft(e)):n.setAttributeNS(Ot,e,t):hr(n,e,t)}function hr(n,e,t){if(Ut(t))n.removeAttribute(e);else{if(J&&!Z&&"TEXTAREA"===n.tagName&&"placeholder"===e&&""!==t&&!n.__ieph){var r=function(e){e.stopImmediatePropagation(),n.removeEventListener("input",r)};n.addEventListener("input",r),n.__ieph=!0}n.setAttribute(e,t)}}var gr={create:pr,update:pr};function fr(n,e){var t=e.elm,r=e.data,i=n.data;if(!(a(r.staticClass)&&a(r.class)&&(a(i)||a(i.staticClass)&&a(i.class)))){var l=Nt(e),s=t._transitionClasses;o(s)&&(l=$t(l,Qt(s))),l!==t._prevClass&&(t.setAttribute("class",l),t._prevClass=l)}}var vr,br={create:fr,update:fr};function yr(n,e,t){var r=vr;return function i(){var a=e.apply(null,arguments);null!==a&&kr(n,i,t,r)}}var xr=Jn&&!(nn&&Number(nn[1])<=53);function Tr(n,e,t,r){if(xr){var i=ct,a=e;e=a._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=i||n.timeStamp<=0||n.target.ownerDocument!==document)return a.apply(this,arguments)}}vr.addEventListener(n,e,tn?{capture:t,passive:r}:t)}function kr(n,e,t,r){(r||vr).removeEventListener(n,e._wrapper||e,t)}function wr(n,e){if(!a(n.data.on)||!a(e.data.on)){var t=e.data.on||{},r=n.data.on||{};vr=e.elm,function(n){if(o(n.__r)){var e=J?"change":"input";n[e]=[].concat(n.__r,n[e]||[]),delete n.__r}o(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(t),ce(t,r,Tr,kr,yr,e.context),vr=void 0}}var Ir,Cr={create:wr,update:wr};function Sr(n,e){if(!a(n.data.domProps)||!a(e.data.domProps)){var t,r,i=e.elm,l=n.data.domProps||{},s=e.data.domProps||{};for(t in o(s.__ob__)&&(s=e.data.domProps=A({},s)),l)t in s||(i[t]="");for(t in s){if(r=s[t],"textContent"===t||"innerHTML"===t){if(e.children&&(e.children.length=0),r===l[t])continue;1===i.childNodes.length&&i.removeChild(i.childNodes[0])}if("value"===t&&"PROGRESS"!==i.tagName){i._value=r;var c=a(r)?"":String(r);Er(i,c)&&(i.value=c)}else if("innerHTML"===t&&Kt(i.tagName)&&a(i.innerHTML)){(Ir=Ir||document.createElement("div")).innerHTML="<svg>"+r+"</svg>";for(var d=Ir.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;d.firstChild;)i.appendChild(d.firstChild)}else if(r!==l[t])try{i[t]=r}catch(n){}}}}function Er(n,e){return!n.composing&&("OPTION"===n.tagName||function(n,e){var t=!0;try{t=document.activeElement!==n}catch(n){}return t&&n.value!==e}(n,e)||function(n,e){var t=n.value,r=n._vModifiers;if(o(r)){if(r.number)return f(t)!==f(e);if(r.trim)return t.trim()!==e.trim()}return t!==e}(n,e))}var _r={create:Sr,update:Sr},zr=k((function(n){var e={},t=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var r=n.split(t);r.length>1&&(e[r[0].trim()]=r[1].trim())}})),e}));function Ar(n){var e=Pr(n.style);return n.staticStyle?A(n.staticStyle,e):e}function Pr(n){return Array.isArray(n)?P(n):"string"==typeof n?zr(n):n}var Rr,Br=/^--/,jr=/\s*!important$/,Dr=function(n,e,t){if(Br.test(e))n.style.setProperty(e,t);else if(jr.test(t))n.style.setProperty(E(e),t.replace(jr,""),"important");else{var r=Lr(e);if(Array.isArray(t))for(var i=0,a=t.length;i<a;i++)n.style[r]=t[i];else n.style[r]=t}},Mr=["Webkit","Moz","ms"],Lr=k((function(n){if(Rr=Rr||document.createElement("div").style,"filter"!==(n=I(n))&&n in Rr)return n;for(var e=n.charAt(0).toUpperCase()+n.slice(1),t=0;t<Mr.length;t++){var r=Mr[t]+e;if(r in Rr)return r}}));function Or(n,e){var t=e.data,r=n.data;if(!(a(t.staticStyle)&&a(t.style)&&a(r.staticStyle)&&a(r.style))){var i,l,s=e.elm,c=r.staticStyle,d=r.normalizedStyle||r.style||{},u=c||d,p=Pr(e.data.style)||{};e.data.normalizedStyle=o(p.__ob__)?A({},p):p;var m=function(n,e){var t,r={};if(e)for(var i=n;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(t=Ar(i.data))&&A(r,t);(t=Ar(n.data))&&A(r,t);for(var a=n;a=a.parent;)a.data&&(t=Ar(a.data))&&A(r,t);return r}(e,!0);for(l in u)a(m[l])&&Dr(s,l,"");for(l in m)(i=m[l])!==u[l]&&Dr(s,l,null==i?"":i)}}var qr={create:Or,update:Or},Fr=/\s+/;function Ur(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(Fr).forEach((function(e){return n.classList.add(e)})):n.classList.add(e);else{var t=" "+(n.getAttribute("class")||"")+" ";t.indexOf(" "+e+" ")<0&&n.setAttribute("class",(t+e).trim())}}function Nr(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(Fr).forEach((function(e){return n.classList.remove(e)})):n.classList.remove(e),n.classList.length||n.removeAttribute("class");else{for(var t=" "+(n.getAttribute("class")||"")+" ",r=" "+e+" ";t.indexOf(r)>=0;)t=t.replace(r," ");(t=t.trim())?n.setAttribute("class",t):n.removeAttribute("class")}}function Hr(n){if(n){if("object"==typeof n){var e={};return!1!==n.css&&A(e,$r(n.name||"v")),A(e,n),e}return"string"==typeof n?$r(n):void 0}}var $r=k((function(n){return{enterClass:n+"-enter",enterToClass:n+"-enter-to",enterActiveClass:n+"-enter-active",leaveClass:n+"-leave",leaveToClass:n+"-leave-to",leaveActiveClass:n+"-leave-active"}})),Qr=W&&!Z,Wr="transition",Gr="transitionend",Kr="animation",Vr="animationend";Qr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Wr="WebkitTransition",Gr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Kr="WebkitAnimation",Vr="webkitAnimationEnd"));var Jr=W?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function Zr(n){Jr((function(){Jr(n)}))}function Xr(n,e){var t=n._transitionClasses||(n._transitionClasses=[]);t.indexOf(e)<0&&(t.push(e),Ur(n,e))}function Yr(n,e){n._transitionClasses&&y(n._transitionClasses,e),Nr(n,e)}function ni(n,e,t){var r=ti(n,e),i=r.type,a=r.timeout,o=r.propCount;if(!i)return t();var l="transition"===i?Gr:Vr,s=0,c=function(){n.removeEventListener(l,d),t()},d=function(e){e.target===n&&++s>=o&&c()};setTimeout((function(){s<o&&c()}),a+1),n.addEventListener(l,d)}var ei=/\b(transform|all)(,|$)/;function ti(n,e){var t,r=window.getComputedStyle(n),i=(r[Wr+"Delay"]||"").split(", "),a=(r[Wr+"Duration"]||"").split(", "),o=ri(i,a),l=(r[Kr+"Delay"]||"").split(", "),s=(r[Kr+"Duration"]||"").split(", "),c=ri(l,s),d=0,u=0;return"transition"===e?o>0&&(t="transition",d=o,u=a.length):"animation"===e?c>0&&(t="animation",d=c,u=s.length):u=(t=(d=Math.max(o,c))>0?o>c?"transition":"animation":null)?"transition"===t?a.length:s.length:0,{type:t,timeout:d,propCount:u,hasTransform:"transition"===t&&ei.test(r[Wr+"Property"])}}function ri(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max.apply(null,e.map((function(e,t){return ii(e)+ii(n[t])})))}function ii(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function ai(n,e){var t=n.elm;o(t._leaveCb)&&(t._leaveCb.cancelled=!0,t._leaveCb());var r=Hr(n.data.transition);if(!a(r)&&!o(t._enterCb)&&1===t.nodeType){for(var i=r.css,l=r.type,s=r.enterClass,d=r.enterToClass,u=r.enterActiveClass,p=r.appearClass,m=r.appearToClass,h=r.appearActiveClass,g=r.beforeEnter,v=r.enter,b=r.afterEnter,y=r.enterCancelled,x=r.beforeAppear,T=r.appear,k=r.afterAppear,w=r.appearCancelled,I=r.duration,C=Xe,S=Xe.$vnode;S&&S.parent;)C=S.context,S=S.parent;var E=!C._isMounted||!n.isRootInsert;if(!E||T||""===T){var _=E&&p?p:s,z=E&&h?h:u,A=E&&m?m:d,P=E&&x||g,R=E&&"function"==typeof T?T:v,B=E&&k||b,j=E&&w||y,D=f(c(I)?I.enter:I);0;var M=!1!==i&&!Z,O=si(R),q=t._enterCb=L((function(){M&&(Yr(t,A),Yr(t,z)),q.cancelled?(M&&Yr(t,_),j&&j(t)):B&&B(t),t._enterCb=null}));n.data.show||de(n,"insert",(function(){var e=t.parentNode,r=e&&e._pending&&e._pending[n.key];r&&r.tag===n.tag&&r.elm._leaveCb&&r.elm._leaveCb(),R&&R(t,q)})),P&&P(t),M&&(Xr(t,_),Xr(t,z),Zr((function(){Yr(t,_),q.cancelled||(Xr(t,A),O||(li(D)?setTimeout(q,D):ni(t,l,q)))}))),n.data.show&&(e&&e(),R&&R(t,q)),M||O||q()}}}function oi(n,e){var t=n.elm;o(t._enterCb)&&(t._enterCb.cancelled=!0,t._enterCb());var r=Hr(n.data.transition);if(a(r)||1!==t.nodeType)return e();if(!o(t._leaveCb)){var i=r.css,l=r.type,s=r.leaveClass,d=r.leaveToClass,u=r.leaveActiveClass,p=r.beforeLeave,m=r.leave,h=r.afterLeave,g=r.leaveCancelled,v=r.delayLeave,b=r.duration,y=!1!==i&&!Z,x=si(m),T=f(c(b)?b.leave:b);0;var k=t._leaveCb=L((function(){t.parentNode&&t.parentNode._pending&&(t.parentNode._pending[n.key]=null),y&&(Yr(t,d),Yr(t,u)),k.cancelled?(y&&Yr(t,s),g&&g(t)):(e(),h&&h(t)),t._leaveCb=null}));v?v(w):w()}function w(){k.cancelled||(!n.data.show&&t.parentNode&&((t.parentNode._pending||(t.parentNode._pending={}))[n.key]=n),p&&p(t),y&&(Xr(t,s),Xr(t,u),Zr((function(){Yr(t,s),k.cancelled||(Xr(t,d),x||(li(T)?setTimeout(k,T):ni(t,l,k)))}))),m&&m(t,k),y||x||k())}}function li(n){return"number"==typeof n&&!isNaN(n)}function si(n){if(a(n))return!1;var e=n.fns;return o(e)?si(Array.isArray(e)?e[0]:e):(n._length||n.length)>1}function ci(n,e){!0!==e.data.show&&ai(e)}var di=function(n){var e,t,r={},i=n.modules,c=n.nodeOps;for(e=0;e<tr.length;++e)for(r[tr[e]]=[],t=0;t<i.length;++t)o(i[t][tr[e]])&&r[tr[e]].push(i[t][tr[e]]);function d(n){var e=c.parentNode(n);o(e)&&c.removeChild(e,n)}function u(n,e,t,i,a,s,d){if(o(n.elm)&&o(s)&&(n=s[d]=xn(n)),n.isRootInsert=!a,!function(n,e,t,i){var a=n.data;if(o(a)){var s=o(n.componentInstance)&&a.keepAlive;if(o(a=a.hook)&&o(a=a.init)&&a(n,!1),o(n.componentInstance))return p(n,e),m(t,n.elm,i),l(s)&&function(n,e,t,i){var a,l=n;for(;l.componentInstance;)if(l=l.componentInstance._vnode,o(a=l.data)&&o(a=a.transition)){for(a=0;a<r.activate.length;++a)r.activate[a](er,l);e.push(l);break}m(t,n.elm,i)}(n,e,t,i),!0}}(n,e,t,i)){var u=n.data,g=n.children,v=n.tag;o(v)?(n.elm=n.ns?c.createElementNS(n.ns,v):c.createElement(v,n),b(n),h(n,g,e),o(u)&&f(n,e),m(t,n.elm,i)):l(n.isComment)?(n.elm=c.createComment(n.text),m(t,n.elm,i)):(n.elm=c.createTextNode(n.text),m(t,n.elm,i))}}function p(n,e){o(n.data.pendingInsert)&&(e.push.apply(e,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,g(n)?(f(n,e),b(n)):(nr(n),e.push(n))}function m(n,e,t){o(n)&&(o(t)?c.parentNode(t)===n&&c.insertBefore(n,e,t):c.appendChild(n,e))}function h(n,e,t){if(Array.isArray(e)){0;for(var r=0;r<e.length;++r)u(e[r],t,n.elm,null,!0,e,r)}else s(n.text)&&c.appendChild(n.elm,c.createTextNode(String(n.text)))}function g(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return o(n.tag)}function f(n,t){for(var i=0;i<r.create.length;++i)r.create[i](er,n);o(e=n.data.hook)&&(o(e.create)&&e.create(er,n),o(e.insert)&&t.push(n))}function b(n){var e;if(o(e=n.fnScopeId))c.setStyleScope(n.elm,e);else for(var t=n;t;)o(e=t.context)&&o(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e),t=t.parent;o(e=Xe)&&e!==n.context&&e!==n.fnContext&&o(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e)}function y(n,e,t,r,i,a){for(;r<=i;++r)u(t[r],a,n,e,!1,t,r)}function x(n){var e,t,i=n.data;if(o(i))for(o(e=i.hook)&&o(e=e.destroy)&&e(n),e=0;e<r.destroy.length;++e)r.destroy[e](n);if(o(e=n.children))for(t=0;t<n.children.length;++t)x(n.children[t])}function T(n,e,t){for(;e<=t;++e){var r=n[e];o(r)&&(o(r.tag)?(k(r),x(r)):d(r.elm))}}function k(n,e){if(o(e)||o(n.data)){var t,i=r.remove.length+1;for(o(e)?e.listeners+=i:e=function(n,e){function t(){0==--t.listeners&&d(n)}return t.listeners=e,t}(n.elm,i),o(t=n.componentInstance)&&o(t=t._vnode)&&o(t.data)&&k(t,e),t=0;t<r.remove.length;++t)r.remove[t](n,e);o(t=n.data.hook)&&o(t=t.remove)?t(n,e):e()}else d(n.elm)}function w(n,e,t,r){for(var i=t;i<r;i++){var a=e[i];if(o(a)&&rr(n,a))return i}}function I(n,e,t,i,s,d){if(n!==e){o(e.elm)&&o(i)&&(e=i[s]=xn(e));var p=e.elm=n.elm;if(l(n.isAsyncPlaceholder))o(e.asyncFactory.resolved)?E(n.elm,e,t):e.isAsyncPlaceholder=!0;else if(l(e.isStatic)&&l(n.isStatic)&&e.key===n.key&&(l(e.isCloned)||l(e.isOnce)))e.componentInstance=n.componentInstance;else{var m,h=e.data;o(h)&&o(m=h.hook)&&o(m=m.prepatch)&&m(n,e);var f=n.children,v=e.children;if(o(h)&&g(e)){for(m=0;m<r.update.length;++m)r.update[m](n,e);o(m=h.hook)&&o(m=m.update)&&m(n,e)}a(e.text)?o(f)&&o(v)?f!==v&&function(n,e,t,r,i){var l,s,d,p=0,m=0,h=e.length-1,g=e[0],f=e[h],v=t.length-1,b=t[0],x=t[v],k=!i;for(0;p<=h&&m<=v;)a(g)?g=e[++p]:a(f)?f=e[--h]:rr(g,b)?(I(g,b,r,t,m),g=e[++p],b=t[++m]):rr(f,x)?(I(f,x,r,t,v),f=e[--h],x=t[--v]):rr(g,x)?(I(g,x,r,t,v),k&&c.insertBefore(n,g.elm,c.nextSibling(f.elm)),g=e[++p],x=t[--v]):rr(f,b)?(I(f,b,r,t,m),k&&c.insertBefore(n,f.elm,g.elm),f=e[--h],b=t[++m]):(a(l)&&(l=ir(e,p,h)),a(s=o(b.key)?l[b.key]:w(b,e,p,h))?u(b,r,n,g.elm,!1,t,m):rr(d=e[s],b)?(I(d,b,r,t,m),e[s]=void 0,k&&c.insertBefore(n,d.elm,g.elm)):u(b,r,n,g.elm,!1,t,m),b=t[++m]);p>h?y(n,a(t[v+1])?null:t[v+1].elm,t,m,v,r):m>v&&T(e,p,h)}(p,f,v,t,d):o(v)?(o(n.text)&&c.setTextContent(p,""),y(p,null,v,0,v.length-1,t)):o(f)?T(f,0,f.length-1):o(n.text)&&c.setTextContent(p,""):n.text!==e.text&&c.setTextContent(p,e.text),o(h)&&o(m=h.hook)&&o(m=m.postpatch)&&m(n,e)}}}function C(n,e,t){if(l(t)&&o(n.parent))n.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var S=v("attrs,class,staticClass,staticStyle,key");function E(n,e,t,r){var i,a=e.tag,s=e.data,c=e.children;if(r=r||s&&s.pre,e.elm=n,l(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(s)&&(o(i=s.hook)&&o(i=i.init)&&i(e,!0),o(i=e.componentInstance)))return p(e,t),!0;if(o(a)){if(o(c))if(n.hasChildNodes())if(o(i=s)&&o(i=i.domProps)&&o(i=i.innerHTML)){if(i!==n.innerHTML)return!1}else{for(var d=!0,u=n.firstChild,m=0;m<c.length;m++){if(!u||!E(u,c[m],t,r)){d=!1;break}u=u.nextSibling}if(!d||u)return!1}else h(e,c,t);if(o(s)){var g=!1;for(var v in s)if(!S(v)){g=!0,f(e,t);break}!g&&s.class&&oe(s.class)}}else n.data!==e.text&&(n.data=e.text);return!0}return function(n,e,t,i){if(!a(e)){var s,d=!1,p=[];if(a(n))d=!0,u(e,p);else{var m=o(n.nodeType);if(!m&&rr(n,e))I(n,e,p,null,null,i);else{if(m){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),t=!0),l(t)&&E(n,e,p))return C(e,p,!0),n;s=n,n=new fn(c.tagName(s).toLowerCase(),{},[],void 0,s)}var h=n.elm,f=c.parentNode(h);if(u(e,p,h._leaveCb?null:f,c.nextSibling(h)),o(e.parent))for(var v=e.parent,b=g(e);v;){for(var y=0;y<r.destroy.length;++y)r.destroy[y](v);if(v.elm=e.elm,b){for(var k=0;k<r.create.length;++k)r.create[k](er,v);var w=v.data.hook.insert;if(w.merged)for(var S=1;S<w.fns.length;S++)w.fns[S]()}else nr(v);v=v.parent}o(f)?T([n],0,0):o(n.tag)&&x(n)}}return C(e,p,d),e.elm}o(n)&&x(n)}}({nodeOps:Xt,modules:[gr,br,Cr,_r,qr,W?{create:ci,activate:ci,remove:function(n,e){!0!==n.data.show?oi(n,e):e()}}:{}].concat(ur)});Z&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&bi(n,"input")}));var ui={inserted:function(n,e,t,r){"select"===t.tag?(r.elm&&!r.elm._vOptions?de(t,"postpatch",(function(){ui.componentUpdated(n,e,t)})):pi(n,e,t.context),n._vOptions=[].map.call(n.options,gi)):("textarea"===t.tag||Zt(n.type))&&(n._vModifiers=e.modifiers,e.modifiers.lazy||(n.addEventListener("compositionstart",fi),n.addEventListener("compositionend",vi),n.addEventListener("change",vi),Z&&(n.vmodel=!0)))},componentUpdated:function(n,e,t){if("select"===t.tag){pi(n,e,t.context);var r=n._vOptions,i=n._vOptions=[].map.call(n.options,gi);if(i.some((function(n,e){return!D(n,r[e])})))(n.multiple?e.value.some((function(n){return hi(n,i)})):e.value!==e.oldValue&&hi(e.value,i))&&bi(n,"change")}}};function pi(n,e,t){mi(n,e,t),(J||X)&&setTimeout((function(){mi(n,e,t)}),0)}function mi(n,e,t){var r=e.value,i=n.multiple;if(!i||Array.isArray(r)){for(var a,o,l=0,s=n.options.length;l<s;l++)if(o=n.options[l],i)a=M(r,gi(o))>-1,o.selected!==a&&(o.selected=a);else if(D(gi(o),r))return void(n.selectedIndex!==l&&(n.selectedIndex=l));i||(n.selectedIndex=-1)}}function hi(n,e){return e.every((function(e){return!D(e,n)}))}function gi(n){return"_value"in n?n._value:n.value}function fi(n){n.target.composing=!0}function vi(n){n.target.composing&&(n.target.composing=!1,bi(n.target,"input"))}function bi(n,e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}function yi(n){return!n.componentInstance||n.data&&n.data.transition?n:yi(n.componentInstance._vnode)}var xi={model:ui,show:{bind:function(n,e,t){var r=e.value,i=(t=yi(t)).data&&t.data.transition,a=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;r&&i?(t.data.show=!0,ai(t,(function(){n.style.display=a}))):n.style.display=r?a:"none"},update:function(n,e,t){var r=e.value;!r!=!e.oldValue&&((t=yi(t)).data&&t.data.transition?(t.data.show=!0,r?ai(t,(function(){n.style.display=n.__vOriginalDisplay})):oi(t,(function(){n.style.display="none"}))):n.style.display=r?n.__vOriginalDisplay:"none")},unbind:function(n,e,t,r,i){i||(n.style.display=n.__vOriginalDisplay)}}},Ti={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ki(n){var e=n&&n.componentOptions;return e&&e.Ctor.options.abstract?ki(Ge(e.children)):n}function wi(n){var e={},t=n.$options;for(var r in t.propsData)e[r]=n[r];var i=t._parentListeners;for(var a in i)e[I(a)]=i[a];return e}function Ii(n,e){if(/\d-keep-alive$/.test(e.tag))return n("keep-alive",{props:e.componentOptions.propsData})}var Ci=function(n){return n.tag||ve(n)},Si=function(n){return"show"===n.name},Ei={name:"transition",props:Ti,abstract:!0,render:function(n){var e=this,t=this.$slots.default;if(t&&(t=t.filter(Ci)).length){0;var r=this.mode;0;var i=t[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return i;var a=ki(i);if(!a)return i;if(this._leaving)return Ii(n,i);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:s(a.key)?0===String(a.key).indexOf(o)?a.key:o+a.key:a.key;var l=(a.data||(a.data={})).transition=wi(this),c=this._vnode,d=ki(c);if(a.data.directives&&a.data.directives.some(Si)&&(a.data.show=!0),d&&d.data&&!function(n,e){return e.key===n.key&&e.tag===n.tag}(a,d)&&!ve(d)&&(!d.componentInstance||!d.componentInstance._vnode.isComment)){var u=d.data.transition=A({},l);if("out-in"===r)return this._leaving=!0,de(u,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Ii(n,i);if("in-out"===r){if(ve(a))return c;var p,m=function(){p()};de(l,"afterEnter",m),de(l,"enterCancelled",m),de(u,"delayLeave",(function(n){p=n}))}}return i}}},_i=A({tag:String,moveClass:String},Ti);function zi(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function Ai(n){n.data.newPos=n.elm.getBoundingClientRect()}function Pi(n){var e=n.data.pos,t=n.data.newPos,r=e.left-t.left,i=e.top-t.top;if(r||i){n.data.moved=!0;var a=n.elm.style;a.transform=a.WebkitTransform="translate("+r+"px,"+i+"px)",a.transitionDuration="0s"}}delete _i.mode;var Ri={Transition:Ei,TransitionGroup:{props:_i,beforeMount:function(){var n=this,e=this._update;this._update=function(t,r){var i=Ye(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,i(),e.call(n,t,r)}},render:function(n){for(var e=this.tag||this.$vnode.data.tag||"span",t=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],a=this.children=[],o=wi(this),l=0;l<i.length;l++){var s=i[l];if(s.tag)if(null!=s.key&&0!==String(s.key).indexOf("__vlist"))a.push(s),t[s.key]=s,(s.data||(s.data={})).transition=o;else;}if(r){for(var c=[],d=[],u=0;u<r.length;u++){var p=r[u];p.data.transition=o,p.data.pos=p.elm.getBoundingClientRect(),t[p.key]?c.push(p):d.push(p)}this.kept=n(e,null,c),this.removed=d}return n(e,null,a)},updated:function(){var n=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,e)&&(n.forEach(zi),n.forEach(Ai),n.forEach(Pi),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var t=n.elm,r=t.style;Xr(t,e),r.transform=r.WebkitTransform=r.transitionDuration="",t.addEventListener(Gr,t._moveCb=function n(r){r&&r.target!==t||r&&!/transform$/.test(r.propertyName)||(t.removeEventListener(Gr,n),t._moveCb=null,Yr(t,e))})}})))},methods:{hasMove:function(n,e){if(!Qr)return!1;if(this._hasMove)return this._hasMove;var t=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){Nr(t,n)})),Ur(t,e),t.style.display="none",this.$el.appendChild(t);var r=ti(t);return this.$el.removeChild(t),this._hasMove=r.hasTransform}}}};Ct.config.mustUseProp=function(n,e,t){return"value"===t&&jt(n)&&"button"!==e||"selected"===t&&"option"===n||"checked"===t&&"input"===n||"muted"===t&&"video"===n},Ct.config.isReservedTag=Vt,Ct.config.isReservedAttr=Bt,Ct.config.getTagNamespace=function(n){return Kt(n)?"svg":"math"===n?"math":void 0},Ct.config.isUnknownElement=function(n){if(!W)return!0;if(Vt(n))return!1;if(n=n.toLowerCase(),null!=Jt[n])return Jt[n];var e=document.createElement(n);return n.indexOf("-")>-1?Jt[n]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Jt[n]=/HTMLUnknownElement/.test(e.toString())},A(Ct.options.directives,xi),A(Ct.options.components,Ri),Ct.prototype.__patch__=W?di:R,Ct.prototype.$mount=function(n,e){return function(n,e,t){var r;return n.$el=e,n.$options.render||(n.$options.render=bn),tt(n,"beforeMount"),r=function(){n._update(n._render(),t)},new ht(n,r,R,{before:function(){n._isMounted&&!n._isDestroyed&&tt(n,"beforeUpdate")}},!0),t=!1,null==n.$vnode&&(n._isMounted=!0,tt(n,"mounted")),n}(this,n=n&&W?function(n){if("string"==typeof n){var e=document.querySelector(n);return e||document.createElement("div")}return n}(n):void 0,e)},W&&setTimeout((function(){F.devtools&&on&&on.emit("init",Ct)}),0);var Bi=Ct;
/*!
  * vue-router v3.5.3
  * (c) 2021 Evan You
  * @license MIT
  */function ji(n,e){for(var t in e)n[t]=e[t];return n}var Di=/[!'()*]/g,Mi=function(n){return"%"+n.charCodeAt(0).toString(16)},Li=/%2C/g,Oi=function(n){return encodeURIComponent(n).replace(Di,Mi).replace(Li,",")};function qi(n){try{return decodeURIComponent(n)}catch(n){0}return n}var Fi=function(n){return null==n||"object"==typeof n?n:String(n)};function Ui(n){var e={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var t=n.replace(/\+/g," ").split("="),r=qi(t.shift()),i=t.length>0?qi(t.join("=")):null;void 0===e[r]?e[r]=i:Array.isArray(e[r])?e[r].push(i):e[r]=[e[r],i]})),e):e}function Ni(n){var e=n?Object.keys(n).map((function(e){var t=n[e];if(void 0===t)return"";if(null===t)return Oi(e);if(Array.isArray(t)){var r=[];return t.forEach((function(n){void 0!==n&&(null===n?r.push(Oi(e)):r.push(Oi(e)+"="+Oi(n)))})),r.join("&")}return Oi(e)+"="+Oi(t)})).filter((function(n){return n.length>0})).join("&"):null;return e?"?"+e:""}var Hi=/\/?$/;function $i(n,e,t,r){var i=r&&r.options.stringifyQuery,a=e.query||{};try{a=Qi(a)}catch(n){}var o={name:e.name||n&&n.name,meta:n&&n.meta||{},path:e.path||"/",hash:e.hash||"",query:a,params:e.params||{},fullPath:Ki(e,i),matched:n?Gi(n):[]};return t&&(o.redirectedFrom=Ki(t,i)),Object.freeze(o)}function Qi(n){if(Array.isArray(n))return n.map(Qi);if(n&&"object"==typeof n){var e={};for(var t in n)e[t]=Qi(n[t]);return e}return n}var Wi=$i(null,{path:"/"});function Gi(n){for(var e=[];n;)e.unshift(n),n=n.parent;return e}function Ki(n,e){var t=n.path,r=n.query;void 0===r&&(r={});var i=n.hash;return void 0===i&&(i=""),(t||"/")+(e||Ni)(r)+i}function Vi(n,e,t){return e===Wi?n===e:!!e&&(n.path&&e.path?n.path.replace(Hi,"")===e.path.replace(Hi,"")&&(t||n.hash===e.hash&&Ji(n.query,e.query)):!(!n.name||!e.name)&&(n.name===e.name&&(t||n.hash===e.hash&&Ji(n.query,e.query)&&Ji(n.params,e.params))))}function Ji(n,e){if(void 0===n&&(n={}),void 0===e&&(e={}),!n||!e)return n===e;var t=Object.keys(n).sort(),r=Object.keys(e).sort();return t.length===r.length&&t.every((function(t,i){var a=n[t];if(r[i]!==t)return!1;var o=e[t];return null==a||null==o?a===o:"object"==typeof a&&"object"==typeof o?Ji(a,o):String(a)===String(o)}))}function Zi(n){for(var e=0;e<n.matched.length;e++){var t=n.matched[e];for(var r in t.instances){var i=t.instances[r],a=t.enteredCbs[r];if(i&&a){delete t.enteredCbs[r];for(var o=0;o<a.length;o++)i._isBeingDestroyed||a[o](i)}}}}var Xi={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,e){var t=e.props,r=e.children,i=e.parent,a=e.data;a.routerView=!0;for(var o=i.$createElement,l=t.name,s=i.$route,c=i._routerViewCache||(i._routerViewCache={}),d=0,u=!1;i&&i._routerRoot!==i;){var p=i.$vnode?i.$vnode.data:{};p.routerView&&d++,p.keepAlive&&i._directInactive&&i._inactive&&(u=!0),i=i.$parent}if(a.routerViewDepth=d,u){var m=c[l],h=m&&m.component;return h?(m.configProps&&Yi(h,a,m.route,m.configProps),o(h,a,r)):o()}var g=s.matched[d],f=g&&g.components[l];if(!g||!f)return c[l]=null,o();c[l]={component:f},a.registerRouteInstance=function(n,e){var t=g.instances[l];(e&&t!==n||!e&&t===n)&&(g.instances[l]=e)},(a.hook||(a.hook={})).prepatch=function(n,e){g.instances[l]=e.componentInstance},a.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==g.instances[l]&&(g.instances[l]=n.componentInstance),Zi(s)};var v=g.props&&g.props[l];return v&&(ji(c[l],{route:s,configProps:v}),Yi(f,a,s,v)),o(f,a,r)}};function Yi(n,e,t,r){var i=e.props=function(n,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(n);case"boolean":return e?n.params:void 0;default:0}}(t,r);if(i){i=e.props=ji({},i);var a=e.attrs=e.attrs||{};for(var o in i)n.props&&o in n.props||(a[o]=i[o],delete i[o])}}function na(n,e,t){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return e+n;var i=e.split("/");t&&i[i.length-1]||i.pop();for(var a=n.replace(/^\//,"").split("/"),o=0;o<a.length;o++){var l=a[o];".."===l?i.pop():"."!==l&&i.push(l)}return""!==i[0]&&i.unshift(""),i.join("/")}function ea(n){return n.replace(/\/+/g,"/")}var ta=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},ra=va,ia=ca,aa=function(n,e){return ua(ca(n,e),e)},oa=ua,la=fa,sa=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function ca(n,e){for(var t,r=[],i=0,a=0,o="",l=e&&e.delimiter||"/";null!=(t=sa.exec(n));){var s=t[0],c=t[1],d=t.index;if(o+=n.slice(a,d),a=d+s.length,c)o+=c[1];else{var u=n[a],p=t[2],m=t[3],h=t[4],g=t[5],f=t[6],v=t[7];o&&(r.push(o),o="");var b=null!=p&&null!=u&&u!==p,y="+"===f||"*"===f,x="?"===f||"*"===f,T=t[2]||l,k=h||g;r.push({name:m||i++,prefix:p||"",delimiter:T,optional:x,repeat:y,partial:b,asterisk:!!v,pattern:k?ma(k):v?".*":"[^"+pa(T)+"]+?"})}}return a<n.length&&(o+=n.substr(a)),o&&r.push(o),r}function da(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function ua(n,e){for(var t=new Array(n.length),r=0;r<n.length;r++)"object"==typeof n[r]&&(t[r]=new RegExp("^(?:"+n[r].pattern+")$",ga(e)));return function(e,r){for(var i="",a=e||{},o=(r||{}).pretty?da:encodeURIComponent,l=0;l<n.length;l++){var s=n[l];if("string"!=typeof s){var c,d=a[s.name];if(null==d){if(s.optional){s.partial&&(i+=s.prefix);continue}throw new TypeError('Expected "'+s.name+'" to be defined')}if(ta(d)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var u=0;u<d.length;u++){if(c=o(d[u]),!t[l].test(c))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received `'+JSON.stringify(c)+"`");i+=(0===u?s.prefix:s.delimiter)+c}}else{if(c=s.asterisk?encodeURI(d).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):o(d),!t[l].test(c))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+c+'"');i+=s.prefix+c}}else i+=s}return i}}function pa(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function ma(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function ha(n,e){return n.keys=e,n}function ga(n){return n&&n.sensitive?"":"i"}function fa(n,e,t){ta(e)||(t=e||t,e=[]);for(var r=(t=t||{}).strict,i=!1!==t.end,a="",o=0;o<n.length;o++){var l=n[o];if("string"==typeof l)a+=pa(l);else{var s=pa(l.prefix),c="(?:"+l.pattern+")";e.push(l),l.repeat&&(c+="(?:"+s+c+")*"),a+=c=l.optional?l.partial?s+"("+c+")?":"(?:"+s+"("+c+"))?":s+"("+c+")"}}var d=pa(t.delimiter||"/"),u=a.slice(-d.length)===d;return r||(a=(u?a.slice(0,-d.length):a)+"(?:"+d+"(?=$))?"),a+=i?"$":r&&u?"":"(?="+d+"|$)",ha(new RegExp("^"+a,ga(t)),e)}function va(n,e,t){return ta(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?function(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var r=0;r<t.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return ha(n,e)}(n,e):ta(n)?function(n,e,t){for(var r=[],i=0;i<n.length;i++)r.push(va(n[i],e,t).source);return ha(new RegExp("(?:"+r.join("|")+")",ga(t)),e)}(n,e,t):function(n,e,t){return fa(ca(n,t),e,t)}(n,e,t)}ra.parse=ia,ra.compile=aa,ra.tokensToFunction=oa,ra.tokensToRegExp=la;var ba=Object.create(null);function ya(n,e,t){e=e||{};try{var r=ba[n]||(ba[n]=ra.compile(n));return"string"==typeof e.pathMatch&&(e[0]=e.pathMatch),r(e,{pretty:!0})}catch(n){return""}finally{delete e[0]}}function xa(n,e,t,r){var i="string"==typeof n?{path:n}:n;if(i._normalized)return i;if(i.name){var a=(i=ji({},n)).params;return a&&"object"==typeof a&&(i.params=ji({},a)),i}if(!i.path&&i.params&&e){(i=ji({},i))._normalized=!0;var o=ji(ji({},e.params),i.params);if(e.name)i.name=e.name,i.params=o;else if(e.matched.length){var l=e.matched[e.matched.length-1].path;i.path=ya(l,o,e.path)}else 0;return i}var s=function(n){var e="",t="",r=n.indexOf("#");r>=0&&(e=n.slice(r),n=n.slice(0,r));var i=n.indexOf("?");return i>=0&&(t=n.slice(i+1),n=n.slice(0,i)),{path:n,query:t,hash:e}}(i.path||""),c=e&&e.path||"/",d=s.path?na(s.path,c,t||i.append):c,u=function(n,e,t){void 0===e&&(e={});var r,i=t||Ui;try{r=i(n||"")}catch(n){r={}}for(var a in e){var o=e[a];r[a]=Array.isArray(o)?o.map(Fi):Fi(o)}return r}(s.query,i.query,r&&r.options.parseQuery),p=i.hash||s.hash;return p&&"#"!==p.charAt(0)&&(p="#"+p),{_normalized:!0,path:d,query:u,hash:p}}var Ta,ka=function(){},wa={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var e=this,t=this.$router,r=this.$route,i=t.resolve(this.to,r,this.append),a=i.location,o=i.route,l=i.href,s={},c=t.options.linkActiveClass,d=t.options.linkExactActiveClass,u=null==c?"router-link-active":c,p=null==d?"router-link-exact-active":d,m=null==this.activeClass?u:this.activeClass,h=null==this.exactActiveClass?p:this.exactActiveClass,g=o.redirectedFrom?$i(null,xa(o.redirectedFrom),null,t):o;s[h]=Vi(r,g,this.exactPath),s[m]=this.exact||this.exactPath?s[h]:function(n,e){return 0===n.path.replace(Hi,"/").indexOf(e.path.replace(Hi,"/"))&&(!e.hash||n.hash===e.hash)&&function(n,e){for(var t in e)if(!(t in n))return!1;return!0}(n.query,e.query)}(r,g);var f=s[h]?this.ariaCurrentValue:null,v=function(n){Ia(n)&&(e.replace?t.replace(a,ka):t.push(a,ka))},b={click:Ia};Array.isArray(this.event)?this.event.forEach((function(n){b[n]=v})):b[this.event]=v;var y={class:s},x=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:l,route:o,navigate:v,isActive:s[m],isExactActive:s[h]});if(x){if(1===x.length)return x[0];if(x.length>1||!x.length)return 0===x.length?n():n("span",{},x)}if("a"===this.tag)y.on=b,y.attrs={href:l,"aria-current":f};else{var T=function n(e){var t;if(e)for(var r=0;r<e.length;r++){if("a"===(t=e[r]).tag)return t;if(t.children&&(t=n(t.children)))return t}}(this.$slots.default);if(T){T.isStatic=!1;var k=T.data=ji({},T.data);for(var w in k.on=k.on||{},k.on){var I=k.on[w];w in b&&(k.on[w]=Array.isArray(I)?I:[I])}for(var C in b)C in k.on?k.on[C].push(b[C]):k.on[C]=v;var S=T.data.attrs=ji({},T.data.attrs);S.href=l,S["aria-current"]=f}else y.on=b}return n(this.tag,y,this.$slots.default)}};function Ia(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}var Ca="undefined"!=typeof window;function Sa(n,e,t,r,i){var a=e||[],o=t||Object.create(null),l=r||Object.create(null);n.forEach((function(n){!function n(e,t,r,i,a,o){var l=i.path,s=i.name;0;var c=i.pathToRegexpOptions||{},d=function(n,e,t){t||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==e)return n;return ea(e.path+"/"+n)}(l,a,c.strict);"boolean"==typeof i.caseSensitive&&(c.sensitive=i.caseSensitive);var u={path:d,regex:Ea(d,c),components:i.components||{default:i.component},alias:i.alias?"string"==typeof i.alias?[i.alias]:i.alias:[],instances:{},enteredCbs:{},name:s,parent:a,matchAs:o,redirect:i.redirect,beforeEnter:i.beforeEnter,meta:i.meta||{},props:null==i.props?{}:i.components?i.props:{default:i.props}};i.children&&i.children.forEach((function(i){var a=o?ea(o+"/"+i.path):void 0;n(e,t,r,i,u,a)}));t[u.path]||(e.push(u.path),t[u.path]=u);if(void 0!==i.alias)for(var p=Array.isArray(i.alias)?i.alias:[i.alias],m=0;m<p.length;++m){0;var h={path:p[m],children:i.children};n(e,t,r,h,a,u.path||"/")}s&&(r[s]||(r[s]=u))}(a,o,l,n,i)}));for(var s=0,c=a.length;s<c;s++)"*"===a[s]&&(a.push(a.splice(s,1)[0]),c--,s--);return{pathList:a,pathMap:o,nameMap:l}}function Ea(n,e){return ra(n,[],e)}function _a(n,e){var t=Sa(n),r=t.pathList,i=t.pathMap,a=t.nameMap;function o(n,t,o){var l=xa(n,t,!1,e),c=l.name;if(c){var d=a[c];if(!d)return s(null,l);var u=d.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof l.params&&(l.params={}),t&&"object"==typeof t.params)for(var p in t.params)!(p in l.params)&&u.indexOf(p)>-1&&(l.params[p]=t.params[p]);return l.path=ya(d.path,l.params),s(d,l,o)}if(l.path){l.params={};for(var m=0;m<r.length;m++){var h=r[m],g=i[h];if(za(g.regex,l.path,l.params))return s(g,l,o)}}return s(null,l)}function l(n,t){var r=n.redirect,i="function"==typeof r?r($i(n,t,null,e)):r;if("string"==typeof i&&(i={path:i}),!i||"object"!=typeof i)return s(null,t);var l=i,c=l.name,d=l.path,u=t.query,p=t.hash,m=t.params;if(u=l.hasOwnProperty("query")?l.query:u,p=l.hasOwnProperty("hash")?l.hash:p,m=l.hasOwnProperty("params")?l.params:m,c){a[c];return o({_normalized:!0,name:c,query:u,hash:p,params:m},void 0,t)}if(d){var h=function(n,e){return na(n,e.parent?e.parent.path:"/",!0)}(d,n);return o({_normalized:!0,path:ya(h,m),query:u,hash:p},void 0,t)}return s(null,t)}function s(n,t,r){return n&&n.redirect?l(n,r||t):n&&n.matchAs?function(n,e,t){var r=o({_normalized:!0,path:ya(t,e.params)});if(r){var i=r.matched,a=i[i.length-1];return e.params=r.params,s(a,e)}return s(null,e)}(0,t,n.matchAs):$i(n,t,r,e)}return{match:o,addRoute:function(n,e){var t="object"!=typeof n?a[n]:void 0;Sa([e||n],r,i,a,t),t&&t.alias.length&&Sa(t.alias.map((function(n){return{path:n,children:[e]}})),r,i,a,t)},getRoutes:function(){return r.map((function(n){return i[n]}))},addRoutes:function(n){Sa(n,r,i,a)}}}function za(n,e,t){var r=e.match(n);if(!r)return!1;if(!t)return!0;for(var i=1,a=r.length;i<a;++i){var o=n.keys[i-1];o&&(t[o.name||"pathMatch"]="string"==typeof r[i]?qi(r[i]):r[i])}return!0}var Aa=Ca&&window.performance&&window.performance.now?window.performance:Date;function Pa(){return Aa.now().toFixed(3)}var Ra=Pa();function Ba(){return Ra}function ja(n){return Ra=n}var Da=Object.create(null);function Ma(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(n,""),t=ji({},window.history.state);return t.key=Ba(),window.history.replaceState(t,"",e),window.addEventListener("popstate",qa),function(){window.removeEventListener("popstate",qa)}}function La(n,e,t,r){if(n.app){var i=n.options.scrollBehavior;i&&n.app.$nextTick((function(){var a=function(){var n=Ba();if(n)return Da[n]}(),o=i.call(n,e,t,r?a:null);o&&("function"==typeof o.then?o.then((function(n){$a(n,a)})).catch((function(n){0})):$a(o,a))}))}}function Oa(){var n=Ba();n&&(Da[n]={x:window.pageXOffset,y:window.pageYOffset})}function qa(n){Oa(),n.state&&n.state.key&&ja(n.state.key)}function Fa(n){return Na(n.x)||Na(n.y)}function Ua(n){return{x:Na(n.x)?n.x:window.pageXOffset,y:Na(n.y)?n.y:window.pageYOffset}}function Na(n){return"number"==typeof n}var Ha=/^#\d/;function $a(n,e){var t,r="object"==typeof n;if(r&&"string"==typeof n.selector){var i=Ha.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(i){var a=n.offset&&"object"==typeof n.offset?n.offset:{};e=function(n,e){var t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{x:r.left-t.left-e.x,y:r.top-t.top-e.y}}(i,a={x:Na((t=a).x)?t.x:0,y:Na(t.y)?t.y:0})}else Fa(n)&&(e=Ua(n))}else r&&Fa(n)&&(e=Ua(n));e&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:e.x,top:e.y,behavior:n.behavior}):window.scrollTo(e.x,e.y))}var Qa,Wa=Ca&&((-1===(Qa=window.navigator.userAgent).indexOf("Android 2.")&&-1===Qa.indexOf("Android 4.0")||-1===Qa.indexOf("Mobile Safari")||-1!==Qa.indexOf("Chrome")||-1!==Qa.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function Ga(n,e){Oa();var t=window.history;try{if(e){var r=ji({},t.state);r.key=Ba(),t.replaceState(r,"",n)}else t.pushState({key:ja(Pa())},"",n)}catch(t){window.location[e?"replace":"assign"](n)}}function Ka(n){Ga(n,!0)}function Va(n,e,t){var r=function(i){i>=n.length?t():n[i]?e(n[i],(function(){r(i+1)})):r(i+1)};r(0)}var Ja={redirected:2,aborted:4,cancelled:8,duplicated:16};function Za(n,e){return Ya(n,e,Ja.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var e={};return no.forEach((function(t){t in n&&(e[t]=n[t])})),JSON.stringify(e,null,2)}(e)+'" via a navigation guard.')}function Xa(n,e){return Ya(n,e,Ja.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+e.fullPath+'" with a new navigation.')}function Ya(n,e,t,r){var i=new Error(r);return i._isRouter=!0,i.from=n,i.to=e,i.type=t,i}var no=["params","query","hash"];function eo(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function to(n,e){return eo(n)&&n._isRouter&&(null==e||n.type===e)}function ro(n){return function(e,t,r){var i=!1,a=0,o=null;io(n,(function(n,e,t,l){if("function"==typeof n&&void 0===n.cid){i=!0,a++;var s,c=lo((function(e){var i;((i=e).__esModule||oo&&"Module"===i[Symbol.toStringTag])&&(e=e.default),n.resolved="function"==typeof e?e:Ta.extend(e),t.components[l]=e,--a<=0&&r()})),d=lo((function(n){var e="Failed to resolve async component "+l+": "+n;o||(o=eo(n)?n:new Error(e),r(o))}));try{s=n(c,d)}catch(n){d(n)}if(s)if("function"==typeof s.then)s.then(c,d);else{var u=s.component;u&&"function"==typeof u.then&&u.then(c,d)}}})),i||r()}}function io(n,e){return ao(n.map((function(n){return Object.keys(n.components).map((function(t){return e(n.components[t],n.instances[t],n,t)}))})))}function ao(n){return Array.prototype.concat.apply([],n)}var oo="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function lo(n){var e=!1;return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(!e)return e=!0,n.apply(this,t)}}var so=function(n,e){this.router=n,this.base=function(n){if(!n)if(Ca){var e=document.querySelector("base");n=(n=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(e),this.current=Wi,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function co(n,e,t,r){var i=io(n,(function(n,r,i,a){var o=function(n,e){"function"!=typeof n&&(n=Ta.extend(n));return n.options[e]}(n,e);if(o)return Array.isArray(o)?o.map((function(n){return t(n,r,i,a)})):t(o,r,i,a)}));return ao(r?i.reverse():i)}function uo(n,e){if(e)return function(){return n.apply(e,arguments)}}so.prototype.listen=function(n){this.cb=n},so.prototype.onReady=function(n,e){this.ready?n():(this.readyCbs.push(n),e&&this.readyErrorCbs.push(e))},so.prototype.onError=function(n){this.errorCbs.push(n)},so.prototype.transitionTo=function(n,e,t){var r,i=this;try{r=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(e){e(n)})),n}var a=this.current;this.confirmTransition(r,(function(){i.updateRoute(r),e&&e(r),i.ensureURL(),i.router.afterHooks.forEach((function(n){n&&n(r,a)})),i.ready||(i.ready=!0,i.readyCbs.forEach((function(n){n(r)})))}),(function(n){t&&t(n),n&&!i.ready&&(to(n,Ja.redirected)&&a===Wi||(i.ready=!0,i.readyErrorCbs.forEach((function(e){e(n)}))))}))},so.prototype.confirmTransition=function(n,e,t){var r=this,i=this.current;this.pending=n;var a,o,l=function(n){!to(n)&&eo(n)&&(r.errorCbs.length?r.errorCbs.forEach((function(e){e(n)})):console.error(n)),t&&t(n)},s=n.matched.length-1,c=i.matched.length-1;if(Vi(n,i)&&s===c&&n.matched[s]===i.matched[c])return this.ensureURL(),n.hash&&La(this.router,i,n,!1),l(((o=Ya(a=i,n,Ja.duplicated,'Avoided redundant navigation to current location: "'+a.fullPath+'".')).name="NavigationDuplicated",o));var d=function(n,e){var t,r=Math.max(n.length,e.length);for(t=0;t<r&&n[t]===e[t];t++);return{updated:e.slice(0,t),activated:e.slice(t),deactivated:n.slice(t)}}(this.current.matched,n.matched),u=d.updated,p=d.deactivated,m=d.activated,h=[].concat(function(n){return co(n,"beforeRouteLeave",uo,!0)}(p),this.router.beforeHooks,function(n){return co(n,"beforeRouteUpdate",uo)}(u),m.map((function(n){return n.beforeEnter})),ro(m)),g=function(e,t){if(r.pending!==n)return l(Xa(i,n));try{e(n,i,(function(e){!1===e?(r.ensureURL(!0),l(function(n,e){return Ya(n,e,Ja.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+e.fullPath+'" via a navigation guard.')}(i,n))):eo(e)?(r.ensureURL(!0),l(e)):"string"==typeof e||"object"==typeof e&&("string"==typeof e.path||"string"==typeof e.name)?(l(Za(i,n)),"object"==typeof e&&e.replace?r.replace(e):r.push(e)):t(e)}))}catch(n){l(n)}};Va(h,g,(function(){Va(function(n){return co(n,"beforeRouteEnter",(function(n,e,t,r){return function(n,e,t){return function(r,i,a){return n(r,i,(function(n){"function"==typeof n&&(e.enteredCbs[t]||(e.enteredCbs[t]=[]),e.enteredCbs[t].push(n)),a(n)}))}}(n,t,r)}))}(m).concat(r.router.resolveHooks),g,(function(){if(r.pending!==n)return l(Xa(i,n));r.pending=null,e(n),r.router.app&&r.router.app.$nextTick((function(){Zi(n)}))}))}))},so.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},so.prototype.setupListeners=function(){},so.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=Wi,this.pending=null};var po=function(n){function e(e,t){n.call(this,e,t),this._startLocation=mo(this.base)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router,t=e.options.scrollBehavior,r=Wa&&t;r&&this.listeners.push(Ma());var i=function(){var t=n.current,i=mo(n.base);n.current===Wi&&i===n._startLocation||n.transitionTo(i,(function(n){r&&La(e,n,t,!0)}))};window.addEventListener("popstate",i),this.listeners.push((function(){window.removeEventListener("popstate",i)}))}},e.prototype.go=function(n){window.history.go(n)},e.prototype.push=function(n,e,t){var r=this,i=this.current;this.transitionTo(n,(function(n){Ga(ea(r.base+n.fullPath)),La(r.router,n,i,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this,i=this.current;this.transitionTo(n,(function(n){Ka(ea(r.base+n.fullPath)),La(r.router,n,i,!1),e&&e(n)}),t)},e.prototype.ensureURL=function(n){if(mo(this.base)!==this.current.fullPath){var e=ea(this.base+this.current.fullPath);n?Ga(e):Ka(e)}},e.prototype.getCurrentLocation=function(){return mo(this.base)},e}(so);function mo(n){var e=window.location.pathname,t=e.toLowerCase(),r=n.toLowerCase();return!n||t!==r&&0!==t.indexOf(ea(r+"/"))||(e=e.slice(n.length)),(e||"/")+window.location.search+window.location.hash}var ho=function(n){function e(e,t,r){n.call(this,e,t),r&&function(n){var e=mo(n);if(!/^\/#/.test(e))return window.location.replace(ea(n+"/#"+e)),!0}(this.base)||go()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router.options.scrollBehavior,t=Wa&&e;t&&this.listeners.push(Ma());var r=function(){var e=n.current;go()&&n.transitionTo(fo(),(function(r){t&&La(n.router,r,e,!0),Wa||yo(r.fullPath)}))},i=Wa?"popstate":"hashchange";window.addEventListener(i,r),this.listeners.push((function(){window.removeEventListener(i,r)}))}},e.prototype.push=function(n,e,t){var r=this,i=this.current;this.transitionTo(n,(function(n){bo(n.fullPath),La(r.router,n,i,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this,i=this.current;this.transitionTo(n,(function(n){yo(n.fullPath),La(r.router,n,i,!1),e&&e(n)}),t)},e.prototype.go=function(n){window.history.go(n)},e.prototype.ensureURL=function(n){var e=this.current.fullPath;fo()!==e&&(n?bo(e):yo(e))},e.prototype.getCurrentLocation=function(){return fo()},e}(so);function go(){var n=fo();return"/"===n.charAt(0)||(yo("/"+n),!1)}function fo(){var n=window.location.href,e=n.indexOf("#");return e<0?"":n=n.slice(e+1)}function vo(n){var e=window.location.href,t=e.indexOf("#");return(t>=0?e.slice(0,t):e)+"#"+n}function bo(n){Wa?Ga(vo(n)):window.location.hash=n}function yo(n){Wa?Ka(vo(n)):window.location.replace(vo(n))}var xo=function(n){function e(e,t){n.call(this,e,t),this.stack=[],this.index=-1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.push=function(n,e,t){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index+1).concat(n),r.index++,e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index).concat(n),e&&e(n)}),t)},e.prototype.go=function(n){var e=this,t=this.index+n;if(!(t<0||t>=this.stack.length)){var r=this.stack[t];this.confirmTransition(r,(function(){var n=e.current;e.index=t,e.updateRoute(r),e.router.afterHooks.forEach((function(e){e&&e(r,n)}))}),(function(n){to(n,Ja.duplicated)&&(e.index=t)}))}},e.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},e.prototype.ensureURL=function(){},e}(so),To=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=_a(n.routes||[],this);var e=n.mode||"hash";switch(this.fallback="history"===e&&!Wa&&!1!==n.fallback,this.fallback&&(e="hash"),Ca||(e="abstract"),this.mode=e,e){case"history":this.history=new po(this,n.base);break;case"hash":this.history=new ho(this,n.base,this.fallback);break;case"abstract":this.history=new xo(this,n.base);break;default:0}},ko={currentRoute:{configurable:!0}};function wo(n,e){return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}To.prototype.match=function(n,e,t){return this.matcher.match(n,e,t)},ko.currentRoute.get=function(){return this.history&&this.history.current},To.prototype.init=function(n){var e=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var t=e.apps.indexOf(n);t>-1&&e.apps.splice(t,1),e.app===n&&(e.app=e.apps[0]||null),e.app||e.history.teardown()})),!this.app){this.app=n;var t=this.history;if(t instanceof po||t instanceof ho){var r=function(n){t.setupListeners(),function(n){var r=t.current,i=e.options.scrollBehavior;Wa&&i&&"fullPath"in n&&La(e,n,r,!1)}(n)};t.transitionTo(t.getCurrentLocation(),r,r)}t.listen((function(n){e.apps.forEach((function(e){e._route=n}))}))}},To.prototype.beforeEach=function(n){return wo(this.beforeHooks,n)},To.prototype.beforeResolve=function(n){return wo(this.resolveHooks,n)},To.prototype.afterEach=function(n){return wo(this.afterHooks,n)},To.prototype.onReady=function(n,e){this.history.onReady(n,e)},To.prototype.onError=function(n){this.history.onError(n)},To.prototype.push=function(n,e,t){var r=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){r.history.push(n,e,t)}));this.history.push(n,e,t)},To.prototype.replace=function(n,e,t){var r=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){r.history.replace(n,e,t)}));this.history.replace(n,e,t)},To.prototype.go=function(n){this.history.go(n)},To.prototype.back=function(){this.go(-1)},To.prototype.forward=function(){this.go(1)},To.prototype.getMatchedComponents=function(n){var e=n?n.matched?n:this.resolve(n).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(n){return Object.keys(n.components).map((function(e){return n.components[e]}))}))):[]},To.prototype.resolve=function(n,e,t){var r=xa(n,e=e||this.history.current,t,this),i=this.match(r,e),a=i.redirectedFrom||i.fullPath;return{location:r,route:i,href:function(n,e,t){var r="hash"===t?"#"+e:e;return n?ea(n+"/"+r):r}(this.history.base,a,this.mode),normalizedTo:r,resolved:i}},To.prototype.getRoutes=function(){return this.matcher.getRoutes()},To.prototype.addRoute=function(n,e){this.matcher.addRoute(n,e),this.history.current!==Wi&&this.history.transitionTo(this.history.getCurrentLocation())},To.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==Wi&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(To.prototype,ko),To.install=function n(e){if(!n.installed||Ta!==e){n.installed=!0,Ta=e;var t=function(n){return void 0!==n},r=function(n,e){var r=n.$options._parentVnode;t(r)&&t(r=r.data)&&t(r=r.registerRouteInstance)&&r(n,e)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",Xi),e.component("RouterLink",wa);var i=e.config.optionMergeStrategies;i.beforeRouteEnter=i.beforeRouteLeave=i.beforeRouteUpdate=i.created}},To.version="3.5.3",To.isNavigationFailure=to,To.NavigationFailureType=Ja,To.START_LOCATION=Wi,Ca&&window.Vue&&window.Vue.use(To);var Io=To;t(231),t(178),t(263),t(105),t(265),t(33),t(34),t(266);function Co(n){n.locales&&Object.keys(n.locales).forEach((function(e){n.locales[e].path=e})),Object.freeze(n)}t(83),t(96),t(126);function So(n){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var Eo=t(77),_o=(t(190),t(19),t(45),t(234),t(235),t(40),t(26),{NotFound:function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,492))},Layout:function(){return Promise.all([t.e(0),t.e(2)]).then(t.bind(null,491))}}),zo={"v-7f042c4c":function(){return t.e(5).then(t.bind(null,493))},"v-55ab495b":function(){return t.e(6).then(t.bind(null,494))},"v-7f4fa8ff":function(){return t.e(7).then(t.bind(null,495))},"v-26f88fff":function(){return t.e(8).then(t.bind(null,496))},"v-1e2a0709":function(){return t.e(9).then(t.bind(null,497))},"v-7a3f894c":function(){return t.e(10).then(t.bind(null,498))},"v-adecc362":function(){return t.e(11).then(t.bind(null,499))},"v-63a49f52":function(){return t.e(12).then(t.bind(null,500))},"v-1e5e3fdf":function(){return t.e(13).then(t.bind(null,501))},"v-fea1ca6c":function(){return t.e(14).then(t.bind(null,502))},"v-dc1b4da6":function(){return t.e(15).then(t.bind(null,503))},"v-265d3d7e":function(){return t.e(16).then(t.bind(null,504))},"v-4239add5":function(){return t.e(17).then(t.bind(null,505))},"v-932f2d58":function(){return t.e(18).then(t.bind(null,506))},"v-6097cc9c":function(){return t.e(19).then(t.bind(null,507))},"v-6395f8b6":function(){return t.e(20).then(t.bind(null,508))},"v-11101d84":function(){return t.e(21).then(t.bind(null,509))},"v-190803ce":function(){return t.e(22).then(t.bind(null,510))},"v-6655d46f":function(){return t.e(23).then(t.bind(null,511))},"v-510eccb8":function(){return t.e(24).then(t.bind(null,512))},"v-491fd7ec":function(){return t.e(25).then(t.bind(null,513))},"v-b75e4ec2":function(){return t.e(26).then(t.bind(null,514))},"v-21ce6260":function(){return t.e(27).then(t.bind(null,515))},"v-6ef572de":function(){return t.e(28).then(t.bind(null,516))},"v-47519682":function(){return t.e(29).then(t.bind(null,517))},"v-67c5593b":function(){return t.e(30).then(t.bind(null,518))},"v-0bf2fe55":function(){return t.e(31).then(t.bind(null,519))},"v-1cd4c4a0":function(){return t.e(32).then(t.bind(null,520))},"v-af744166":function(){return t.e(33).then(t.bind(null,521))},"v-5a6ba150":function(){return t.e(34).then(t.bind(null,522))},"v-278d74e8":function(){return t.e(35).then(t.bind(null,523))},"v-6091d31b":function(){return t.e(36).then(t.bind(null,524))},"v-1af69402":function(){return t.e(37).then(t.bind(null,525))},"v-f52afa76":function(){return t.e(38).then(t.bind(null,526))},"v-255354da":function(){return t.e(39).then(t.bind(null,527))},"v-0349074a":function(){return t.e(40).then(t.bind(null,528))},"v-65b0509c":function(){return t.e(41).then(t.bind(null,529))},"v-30f4df2d":function(){return t.e(42).then(t.bind(null,530))},"v-686da33c":function(){return t.e(43).then(t.bind(null,531))},"v-03ef00cc":function(){return t.e(44).then(t.bind(null,532))},"v-7f83aac5":function(){return t.e(45).then(t.bind(null,533))},"v-35aeaf87":function(){return t.e(46).then(t.bind(null,534))},"v-6c538cc0":function(){return t.e(47).then(t.bind(null,535))},"v-056e1262":function(){return t.e(48).then(t.bind(null,536))},"v-ecdbd4a2":function(){return t.e(49).then(t.bind(null,537))},"v-27b2649e":function(){return t.e(50).then(t.bind(null,538))},"v-55732b48":function(){return t.e(51).then(t.bind(null,539))},"v-12aaaa7d":function(){return t.e(52).then(t.bind(null,540))},"v-6dbfe670":function(){return t.e(53).then(t.bind(null,541))},"v-43c755b4":function(){return t.e(54).then(t.bind(null,542))},"v-2b866fe8":function(){return t.e(55).then(t.bind(null,543))},"v-bad396a0":function(){return t.e(56).then(t.bind(null,544))},"v-33b23c84":function(){return t.e(57).then(t.bind(null,545))},"v-13d9f031":function(){return t.e(58).then(t.bind(null,546))},"v-a097a3be":function(){return t.e(59).then(t.bind(null,547))},"v-3a239cb0":function(){return t.e(60).then(t.bind(null,548))},"v-1bdc9712":function(){return t.e(61).then(t.bind(null,549))},"v-68de8656":function(){return t.e(62).then(t.bind(null,550))},"v-72ea5972":function(){return t.e(63).then(t.bind(null,551))},"v-b5457c16":function(){return t.e(64).then(t.bind(null,552))},"v-0569b6f8":function(){return t.e(65).then(t.bind(null,553))},"v-4e6d8200":function(){return t.e(66).then(t.bind(null,554))},"v-2c19e87c":function(){return t.e(67).then(t.bind(null,555))},"v-25c50554":function(){return t.e(68).then(t.bind(null,556))},"v-6e2d857c":function(){return t.e(69).then(t.bind(null,557))},"v-51d6ac9c":function(){return t.e(70).then(t.bind(null,558))},"v-f82d5ee0":function(){return t.e(71).then(t.bind(null,559))},"v-e65aab34":function(){return t.e(72).then(t.bind(null,560))},"v-637f7ff4":function(){return t.e(73).then(t.bind(null,561))},"v-07d9254f":function(){return t.e(74).then(t.bind(null,562))},"v-cc527b5a":function(){return t.e(75).then(t.bind(null,563))},"v-04ae6228":function(){return t.e(76).then(t.bind(null,564))},"v-1a6137e8":function(){return t.e(77).then(t.bind(null,565))},"v-ca584e06":function(){return t.e(78).then(t.bind(null,566))},"v-f0251290":function(){return t.e(79).then(t.bind(null,567))},"v-0f7af49e":function(){return t.e(80).then(t.bind(null,568))},"v-1457855d":function(){return t.e(81).then(t.bind(null,569))},"v-3f96c8d8":function(){return t.e(82).then(t.bind(null,570))},"v-0893d5c3":function(){return t.e(83).then(t.bind(null,571))},"v-79c78335":function(){return t.e(84).then(t.bind(null,572))},"v-c5ef3042":function(){return t.e(85).then(t.bind(null,573))},"v-ce0e8fd4":function(){return t.e(86).then(t.bind(null,574))},"v-38d3c9ce":function(){return t.e(87).then(t.bind(null,575))},"v-5d9b4816":function(){return t.e(88).then(t.bind(null,576))},"v-3a98d9f2":function(){return t.e(89).then(t.bind(null,577))},"v-45cada9f":function(){return t.e(90).then(t.bind(null,578))},"v-612a002e":function(){return t.e(91).then(t.bind(null,579))},"v-179f8f74":function(){return t.e(92).then(t.bind(null,580))},"v-02e2a776":function(){return t.e(93).then(t.bind(null,581))},"v-20b770b6":function(){return t.e(94).then(t.bind(null,582))},"v-0480d1c5":function(){return t.e(95).then(t.bind(null,583))},"v-7e5bbd14":function(){return t.e(96).then(t.bind(null,584))}};function Ao(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var Po=/-(\w)/g,Ro=Ao((function(n){return n.replace(Po,(function(n,e){return e?e.toUpperCase():""}))})),Bo=/\B([A-Z])/g,jo=Ao((function(n){return n.replace(Bo,"-$1").toLowerCase()})),Do=Ao((function(n){return n.charAt(0).toUpperCase()+n.slice(1)}));function Mo(n,e){if(e)return n(e)?n(e):e.includes("-")?n(Do(Ro(e))):n(Do(e))||n(jo(e))}var Lo=Object.assign({},_o,zo),Oo=function(n){return Lo[n]},qo=function(n){return zo[n]},Fo=function(n){return _o[n]},Uo=function(n){return Bi.component(n)};function No(n){return Mo(qo,n)}function Ho(n){return Mo(Fo,n)}function $o(n){return Mo(Oo,n)}function Qo(n){return Mo(Uo,n)}function Wo(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return Promise.all(e.filter((function(n){return n})).map(function(){var n=Object(r.a)(regeneratorRuntime.mark((function n(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Qo(e)||!$o(e)){n.next=5;break}return n.next=3,$o(e)();case 3:t=n.sent,Bi.component(e,t.default);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))}function Go(n,e){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=e)}var Ko=t(137),Vo=(t(125),t(113),t(79),t(221)),Jo=t.n(Vo),Zo=t(222),Xo=t.n(Zo),Yo={created:function(){if(this.siteMeta=this.$site.headTags.filter((function(n){return"meta"===Object(Ko.a)(n,1)[0]})).map((function(n){var e=Object(Ko.a)(n,2);e[0];return e[1]})),this.$ssrContext){var n=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(e=n)?e.map((function(n){var e="<meta";return Object.keys(n).forEach((function(t){e+=" ".concat(t,'="').concat(Xo()(n[t]),'"')})),e+">"})).join("\n    "):"",this.$ssrContext.canonicalLink=el(this.$canonicalUrl)}var e},mounted:function(){this.currentMetaTags=Object(Eo.a)(document.querySelectorAll("meta")),this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta:function(){document.title=this.$title,document.documentElement.lang=this.$lang;var n=this.getMergedMetaTags();this.currentMetaTags=tl(n,this.currentMetaTags)},getMergedMetaTags:function(){var n=this.$page.frontmatter.meta||[];return Jo()([{name:"description",content:this.$description}],n,this.siteMeta,rl)},updateCanonicalLink:function(){nl(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",el(this.$canonicalUrl))}},watch:{$page:function(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy:function(){tl(null,this.currentMetaTags),nl()}};function nl(){var n=document.querySelector("link[rel='canonical']");n&&n.remove()}function el(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?'<link href="'.concat(n,'" rel="canonical" />'):""}function tl(n,e){if(e&&Object(Eo.a)(e).filter((function(n){return n.parentNode===document.head})).forEach((function(n){return document.head.removeChild(n)})),n)return n.map((function(n){var e=document.createElement("meta");return Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),document.head.appendChild(e),e}))}function rl(n){for(var e=0,t=["name","property","itemprop"];e<t.length;e++){var r=t[e];if(n.hasOwnProperty(r))return n[r]+r}return JSON.stringify(n)}t(139);var il=t(152),al={mounted:function(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:t.n(il)()((function(){this.setActiveHash()}),300),setActiveHash:function(){for(var n=this,e=[].slice.call(document.querySelectorAll(".sidebar-link")),t=[].slice.call(document.querySelectorAll(".header-anchor")).filter((function(n){return e.some((function(e){return e.hash===n.hash}))})),r=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),i=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),a=window.innerHeight+r,o=0;o<t.length;o++){var l=t[o],s=t[o+1],c=0===o&&0===r||r>=l.parentElement.offsetTop+10&&(!s||r<s.parentElement.offsetTop-10),d=decodeURIComponent(this.$route.hash);if(c&&d!==decodeURIComponent(l.hash)){var u=l;if(a===i)for(var p=o+1;p<t.length;p++)if(d===decodeURIComponent(t[p].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(u.hash),(function(){n.$nextTick((function(){n.$vuepress.$set("disableScrollBehavior",!1)}))}))}}}},beforeDestroy:function(){window.removeEventListener("scroll",this.onScroll)}},ol=(t(109),t(104)),ll=t.n(ol),sl={mounted:function(){var n=this;ll.a.configure({showSpinner:!1}),this.$router.beforeEach((function(n,e,t){n.path===e.path||Bi.component(n.name)||ll.a.start(),t()})),this.$router.afterEach((function(){ll.a.done(),n.isSidebarOpen=!1}))}};t(81),t(42),t(84),t(380);function cl(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}t(143);function dl(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ul(n,e,t){return e&&dl(n.prototype,e),t&&dl(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}t(381);var pl=function(){function n(){cl(this,n);this.containerEl=document.getElementById("message-container"),this.containerEl||(this.containerEl=document.createElement("div"),this.containerEl.id="message-container",document.body.appendChild(this.containerEl))}return ul(n,[{key:"show",value:function(n){var e=this,t=n.text,r=void 0===t?"":t,i=n.duration,a=void 0===i?3e3:i,o=document.createElement("div");o.className="message move-in",o.innerHTML='\n      <i style="fill: #06a35a;font-size: 14px;display:inline-flex;align-items: center;">\n        <svg style="fill: #06a35a;font-size: 14px;" t="1572421810237" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2323" width="16" height="16"><path d="M822.811993 824.617989c-83.075838 81.99224-188.546032 124.613757-316.049383 127.86455-122.085362-3.250794-223.943563-45.87231-305.935802-127.86455s-124.613757-184.21164-127.86455-305.935802c3.250794-127.503351 45.87231-232.973545 127.86455-316.049383 81.99224-83.075838 184.21164-126.058554 305.935802-129.309347 127.503351 3.250794 232.973545 46.23351 316.049383 129.309347 83.075838 83.075838 126.058554 188.546032 129.309347 316.049383C949.231746 640.406349 905.887831 742.62575 822.811993 824.617989zM432.716755 684.111464c3.973192 3.973192 8.307584 5.779189 13.364374 6.140388 5.05679 0.361199 9.752381-1.444797 13.364374-5.417989l292.571429-287.514638c3.973192-3.973192 5.779189-8.307584 5.779189-13.364374 0-5.05679-1.805996-9.752381-5.779189-13.364374l1.805996 1.805996c-3.973192-3.973192-8.668783-5.779189-14.086772-6.140388-5.417989-0.361199-10.47478 1.444797-14.809171 5.417989l-264.397884 220.33157c-3.973192 3.250794-8.668783 4.695591-14.447972 4.695591-5.779189 0-10.835979-1.444797-15.53157-3.973192l-94.273016-72.962257c-4.334392-3.250794-9.391182-4.334392-14.447972-3.973192s-9.391182 3.250794-12.641975 7.585185l-2.889594 3.973192c-3.250794 4.334392-4.334392 9.391182-3.973192 14.809171 0.722399 5.417989 2.528395 10.11358 5.779189 14.086772L432.716755 684.111464z" p-id="2324"></path></svg>\n      </i>\n      <div class="text">'.concat(r,"</div>\n    "),this.containerEl.appendChild(o),a>0&&setTimeout((function(){e.close(o)}),a)}},{key:"close",value:function(n){n.className=n.className.replace("move-in",""),n.className+="move-out",n.addEventListener("animationend",(function(){n.remove()}))}}]),n}(),ml={mounted:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},updated:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},methods:{updateCopy:function(){var n=this;setTimeout((function(){(['div[class*="language-"] pre','div[class*="aside-code"] aside']instanceof Array||Array.isArray(['div[class*="language-"] pre','div[class*="aside-code"] aside']))&&['div[class*="language-"] pre','div[class*="aside-code"] aside'].forEach((function(e){document.querySelectorAll(e).forEach(n.generateCopyButton)}))}),1e3)},generateCopyButton:function(n){var e=this;if(!n.classList.contains("codecopy-enabled")){var t=document.createElement("i");t.className="code-copy",t.innerHTML='<svg  style="color:#aaa;font-size:14px" t="1572422231464" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3201" width="14" height="14"><path d="M866.461538 39.384615H354.461538c-43.323077 0-78.769231 35.446154-78.76923 78.769231v39.384616h472.615384c43.323077 0 78.769231 35.446154 78.769231 78.76923v551.384616h39.384615c43.323077 0 78.769231-35.446154 78.769231-78.769231V118.153846c0-43.323077-35.446154-78.769231-78.769231-78.769231z m-118.153846 275.692308c0-43.323077-35.446154-78.769231-78.76923-78.769231H157.538462c-43.323077 0-78.769231 35.446154-78.769231 78.769231v590.769231c0 43.323077 35.446154 78.769231 78.769231 78.769231h512c43.323077 0 78.769231-35.446154 78.76923-78.769231V315.076923z m-354.461538 137.846154c0 11.815385-7.876923 19.692308-19.692308 19.692308h-157.538461c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h157.538461c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z m157.538461 315.076923c0 11.815385-7.876923 19.692308-19.692307 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h315.076923c11.815385 0 19.692308 7.876923 19.692307 19.692308v39.384615z m78.769231-157.538462c0 11.815385-7.876923 19.692308-19.692308 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h393.846153c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z" p-id="3202"></path></svg>',t.title="Copy to clipboard",t.addEventListener("click",(function(){e.copyToClipboard(n.innerText)})),n.appendChild(t),n.classList.add("codecopy-enabled")}},copyToClipboard:function(n){var e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);var t=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),(new pl).show({text:"å¤å¶æå",duration:1e3}),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}}};t(237),t(80),t(138),t(140),t(383);!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}("@media (max-width: 1000px) {\n  .vuepress-plugin-demo-block__h_code {\n    display: none;\n  }\n  .vuepress-plugin-demo-block__app {\n    margin-left: auto !important;\n    margin-right: auto !important;\n  }\n}\n.vuepress-plugin-demo-block__wrapper {\n  margin-top: 10px;\n  border: 1px solid #ebebeb;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display {\n  height: 400px;\n  display: flex;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__app {\n  width: 300px;\n  border: 1px solid #ebebeb;\n  box-shadow: 1px 1px 3px #ebebeb;\n  margin-right: 5px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code {\n  flex: 1;\n  overflow: auto;\n  height: 100%;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code > pre {\n  overflow: visible;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  max-height: 400px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper div {\n  box-sizing: border-box;\n}\n.vuepress-plugin-demo-block__wrapper:hover {\n  box-shadow: 0 0 11px rgba(33, 33, 33, 0.2);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code {\n  overflow: hidden;\n  height: 0;\n  padding: 0 !important;\n  background-color: #282c34;\n  border-radius: 0 !important;\n  transition: height 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code pre {\n  margin: 0 !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  padding: 20px;\n  border-bottom: 1px solid #ebebeb;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer {\n  position: relative;\n  text-align: center;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__codepen {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__expand::before {\n  border-top: none;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #ccc;\n  border-left: 6px solid transparent;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__codepen,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand span,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand::before {\n  border-top-color: #3eaf7c !important;\n  border-bottom-color: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover svg {\n  fill: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand-text {\n  transition: all 0.5s;\n  opacity: 0;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:nth-last-child(2) {\n  right: 50px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:last-child {\n  right: 10px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button {\n  border-color: transparent;\n  background-color: transparent;\n  font-size: 14px;\n  color: #3eaf7c;\n  cursor: pointer;\n  outline: none;\n  margin: 0;\n  width: 46px;\n  position: relative;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::before {\n  content: attr(data-tip);\n  white-space: nowrap;\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  color: #eee;\n  line-height: 1;\n  z-index: 1000;\n  border-radius: 4px;\n  padding: 6px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::after {\n  content: '' !important;\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: -5px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  border: 5px solid transparent;\n  border-top-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button svg {\n  width: 34px;\n  height: 20px;\n  fill: #ccc;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__codepen {\n  position: absolute;\n  top: 10px;\n  transition: all 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand {\n  position: relative;\n  width: 100px;\n  height: 40px;\n  margin: 0;\n  color: #3eaf7c;\n  font-size: 14px;\n  background-color: transparent;\n  border-color: transparent;\n  outline: none;\n  transition: all 0.5s;\n  cursor: pointer;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-top: 6px solid #ccc;\n  border-right: 6px solid transparent;\n  border-left: 6px solid transparent;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n");var hl={jsLib:[],cssLib:[],jsfiddle:!0,codepen:!0,codepenLayout:"left",codepenJsProcessor:"babel",codepenEditors:"101",horizontal:!1,vue:"https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js",react:"https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js",reactDOM:"https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"},gl={},fl=function(n){return'<div id="app">\n'.concat(n,"\n</div>")},vl=function(n){return window.$VUEPRESS_DEMO_BLOCK&&void 0!==window.$VUEPRESS_DEMO_BLOCK[n]?window.$VUEPRESS_DEMO_BLOCK[n]:hl[n]},bl=function n(e,t,r){var i=document.createElement(e);return t&&Object.keys(t).forEach((function(n){if(n.indexOf("data"))i[n]=t[n];else{var e=n.replace("data","");i.dataset[e]=t[n]}})),r&&r.forEach((function(e){var t=e.tag,r=e.attrs,a=e.children;i.appendChild(n(t,r,a))})),i},yl=function(n,e,t){var r,i=(r=n.querySelectorAll(".".concat(e)),Array.prototype.slice.call(r));return 1!==i.length||t?i:i[0]},xl=function(n,e){var t,r,i=n.match(/<style>([\s\S]+)<\/style>/),a=n.match(/<template>([\s\S]+)<\/template>/),o=n.match(/<script>([\s\S]+)<\/script>/),l={css:i&&i[1].replace(/^\n|\n$/g,""),html:a&&a[1].replace(/^\n|\n$/g,""),js:o&&o[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};l.htmlTpl=fl(l.html),l.jsTpl=(t=l.js,r=t.replace(/export\s+default\s*?\{\n*/,"").replace(/\n*\}\s*$/,"").trim(),"new Vue({\n  el: '#app',\n  ".concat(r,"\n})")),l.script=function(n,e){var t=n.split(/export\s+default/),r="(function() {".concat(t[0]," ; return ").concat(t[1],"})()"),i=window.Babel?window.Babel.transform(r,{presets:["es2015"]}).code:r,a=[eval][0](i);return a.template=e,a}(l.js,l.html);var s=vl("vue");return l.jsLib.unshift(s),l},Tl=function(n,e){var t,r=n.match(/<style>([\s\S]+)<\/style>/),i=n.match(/<html>([\s\S]+)<\/html>/),a=n.match(/<script>([\s\S]+)<\/script>/),o={css:r&&r[1].replace(/^\n|\n$/g,""),html:i&&i[1].replace(/^\n|\n$/g,""),js:a&&a[1].replace(/^\n|\n$/g,""),jsLib:e.jsLib||[],cssLib:e.cssLib||[]};return o.htmlTpl=o.html,o.jsTpl=o.js,o.script=(t=o.js,window.Babel?window.Babel.transform(t,{presets:["es2015"]}).code:t),o},kl=function(n){return n=n.replace("export default ","").replace(/App\.__style__(\s*)=(\s*)`([\s\S]*)?`/,""),n+='ReactDOM.render(React.createElement(App), document.getElementById("app"))'};function wl(){var n=yl(document,"vuepress-plugin-demo-block__wrapper",!0);n.length?n.forEach((function(n){if("true"!==n.dataset.created){n.style.display="block";var e=yl(n,"vuepress-plugin-demo-block__code"),t=yl(n,"vuepress-plugin-demo-block__display"),r=yl(n,"vuepress-plugin-demo-block__footer"),i=yl(t,"vuepress-plugin-demo-block__app"),a=decodeURIComponent(n.dataset.code),o=decodeURIComponent(n.dataset.config),l=decodeURIComponent(n.dataset.type);o=o?JSON.parse(o):{};var s=e.querySelector("div").clientHeight,c="react"===l?function(n,e){var t=(0,window.Babel.transform)(n,{presets:["es2015","react"]}).code,r="(function(exports){var module={};module.exports=exports;".concat(t,";return module.exports.__esModule?module.exports.default:module.exports;})({})"),i=new Function("return ".concat(r))(),a={js:i,css:i.__style__||"",jsLib:e.jsLib||[],cssLib:e.cssLib||[],jsTpl:kl(n),htmlTpl:fl("")},o=vl("react"),l=vl("reactDOM");return a.jsLib.unshift(o,l),a}(a,o):"vanilla"===l?Tl(a,o):xl(a,o),d=bl("button",{className:"".concat("vuepress-plugin-demo-block__expand")});if(r.appendChild(d),d.addEventListener("click",Il.bind(null,d,s,e,r)),vl("jsfiddle")&&r.appendChild(function(n){var e=n.css,t=n.htmlTpl,r=n.jsTpl,i=n.jsLib,a=n.cssLib,o=i.concat(a).concat(vl("cssLib")).concat(vl("jsLib")).join(",");return bl("form",{className:"vuepress-plugin-demo-block__jsfiddle",target:"_blank",action:"https://jsfiddle.net/api/post/library/pure/",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"css",value:e}},{tag:"input",attrs:{type:"hidden",name:"html",value:t}},{tag:"input",attrs:{type:"hidden",name:"js",value:r}},{tag:"input",attrs:{type:"hidden",name:"panel_js",value:3}},{tag:"input",attrs:{type:"hidden",name:"wrap",value:1}},{tag:"input",attrs:{type:"hidden",name:"resources",value:o}},{tag:"button",attrs:{type:"submit",className:"vuepress-plugin-demo-block__button",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088289967" class="icon" style="" viewBox="0 0 1170 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1952" xmlns:xlink="http://www.w3.org/1999/xlink" width="228.515625" height="200"><defs><style type="text/css"></style></defs><path d="M1028.571429 441.142857q63.428571 26.285714 102.571428 83.142857T1170.285714 650.857143q0 93.714286-67.428571 160.285714T940 877.714286q-2.285714 0-6.571429-0.285715t-6-0.285714H232q-97.142857-5.714286-164.571429-71.714286T0 645.142857q0-62.857143 31.428571-116t84-84q-6.857143-22.285714-6.857142-46.857143 0-65.714286 46.857142-112t113.714286-46.285714q54.285714 0 98.285714 33.142857 42.857143-88 127.142858-141.714286t186.571428-53.714285q94.857143 0 174.857143 46T982.571429 248.571429t46.571428 172q0 3.428571-0.285714 10.285714t-0.285714 10.285714zM267.428571 593.142857q0 69.714286 48 110.285714t118.857143 40.571429q78.285714 0 137.142857-56.571429-9.142857-11.428571-27.142857-32.285714T519.428571 626.285714q-38.285714 37.142857-82.285714 37.142857-31.428571 0-53.428571-19.142857T361.714286 594.285714q0-30.285714 22-49.714285t52.285714-19.428572q25.142857 0 48.285714 12t41.714286 31.428572 37.142857 42.857142 39.428572 46.857143 44 42.857143 55.428571 31.428572 69.428571 12q69.142857 0 116.857143-40.857143T936 594.857143q0-69.142857-48-109.714286t-118.285714-40.571428q-81.714286 0-137.714286 55.428571l53.142857 61.714286q37.714286-36.571429 81.142857-36.571429 29.714286 0 52.571429 18.857143t22.857143 48q0 32.571429-21.142857 52.285714t-53.714286 19.714286q-24.571429 0-47.142857-12t-41.142857-31.428571-37.428572-42.857143-39.714286-46.857143-44.285714-42.857143-55.142857-31.428571T434.285714 444.571429q-69.714286 0-118.285714 40.285714T267.428571 593.142857z" p-id="1953"></path></svg>',datatip:"JSFiddle"}}])}(c)),vl("codepen")&&r.appendChild(function(n){var e=n.css,t=n.htmlTpl,r=n.jsTpl,i=n.jsLib,a=n.cssLib,o=JSON.stringify({css:e,html:t,js:r,js_external:i.concat(vl("jsLib")).join(";"),css_external:a.concat(vl("cssLib")).join(";"),layout:vl("codepenLayout"),js_pre_processor:vl("codepenJsProcessor"),editors:vl("codepenEditors")});return bl("form",{className:"vuepress-plugin-demo-block__codepen",target:"_blank",action:"https://codepen.io/pen/define",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"data",value:o}},{tag:"button",attrs:{type:"submit",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088271207" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1737" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z" p-id="1738"></path></svg>',className:"vuepress-plugin-demo-block__button",datatip:"Codepen"}}])}(c)),void 0!==o.horizontal?o.horizontal:vl("horizontal")){n.classList.add("vuepress-plugin-demo-block__horizontal");var u=e.firstChild.cloneNode(!0);u.classList.add("vuepress-plugin-demo-block__h_code"),t.appendChild(u)}if(c.css&&function(n){if(!gl[n]){var e=bl("style",{innerHTML:n});document.body.appendChild(e),gl[n]=!0}}(c.css),"react"===l)ReactDOM.render(React.createElement(c.js),i);else if("vue"===l){var p=(new(Vue.extend(c.script))).$mount();i.appendChild(p.$el)}else"vanilla"===l&&(i.innerHTML=c.html,new Function("return (function(){".concat(c.script,"})()"))());n.dataset.created="true"}})):setTimeout((function(n){wl()}),300)}function Il(n,e,t,r){var i="1"!==n.dataset.isExpand;t.style.height=i?"".concat(e,"px"):0,i?r.classList.add("vuepress-plugin-demo-block__show-link"):r.classList.remove("vuepress-plugin-demo-block__show-link"),n.dataset.isExpand=i?"1":"0"}var Cl={mounted:function(){window.$VUEPRESS_DEMO_BLOCK={jsfiddle:!1,codepen:!0,horizontal:!1},wl()},updated:function(){wl()}},Sl=(t(225),"auto"),El="zoom-in",_l="zoom-out",zl="grab",Al="move";function Pl(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i={passive:!1};r?n.addEventListener(e,t,i):n.removeEventListener(e,t,i)}function Rl(n,e){if(n){var t=new Image;t.onload=function(){e&&e(t)},t.src=n}}function Bl(n){return n.dataset.original?n.dataset.original:"A"===n.parentNode.tagName?n.parentNode.getAttribute("href"):null}function jl(n,e,t){!function(n){var e=Dl,t=Ml;if(n.transition){var r=n.transition;delete n.transition,n[e]=r}if(n.transform){var i=n.transform;delete n.transform,n[t]=i}}(e);var r=n.style,i={};for(var a in e)t&&(i[a]=r[a]||""),r[a]=e[a];return i}var Dl="transition",Ml="transform",Ll="transform",Ol="transitionend";var ql=function(){},Fl={enableGrab:!0,preloadImage:!1,closeOnWindowResize:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,zIndex:998,customSize:null,onOpen:ql,onClose:ql,onGrab:ql,onMove:ql,onRelease:ql,onBeforeOpen:ql,onBeforeClose:ql,onBeforeGrab:ql,onBeforeRelease:ql,onImageLoading:ql,onImageLoaded:ql},Ul={init:function(n){var e,t;e=this,t=n,Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(n){e[n]=e[n].bind(t)}))},click:function(n){if(n.preventDefault(),Hl(n))return window.open(this.target.srcOriginal||n.currentTarget.src,"_blank");this.shown?this.released?this.close():this.release():this.open(n.currentTarget)},scroll:function(){var n=document.documentElement||document.body.parentNode||document.body,e=window.pageXOffset||n.scrollLeft,t=window.pageYOffset||n.scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition={x:e,y:t});var r=this.lastScrollPosition.x-e,i=this.lastScrollPosition.y-t,a=this.options.scrollThreshold;(Math.abs(i)>=a||Math.abs(r)>=a)&&(this.lastScrollPosition=null,this.close())},keydown:function(n){(function(n){return"Escape"===(n.key||n.code)||27===n.keyCode})(n)&&(this.released?this.close():this.release(this.close))},mousedown:function(n){if(Nl(n)&&!Hl(n)){n.preventDefault();var e=n.clientX,t=n.clientY;this.pressTimer=setTimeout(function(){this.grab(e,t)}.bind(this),200)}},mousemove:function(n){this.released||this.move(n.clientX,n.clientY)},mouseup:function(n){Nl(n)&&!Hl(n)&&(clearTimeout(this.pressTimer),this.released?this.close():this.release())},touchstart:function(n){n.preventDefault();var e=n.touches[0],t=e.clientX,r=e.clientY;this.pressTimer=setTimeout(function(){this.grab(t,r)}.bind(this),200)},touchmove:function(n){if(!this.released){var e=n.touches[0],t=e.clientX,r=e.clientY;this.move(t,r)}},touchend:function(n){(function(n){n.targetTouches.length})(n)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())},clickOverlay:function(){this.close()},resizeWindow:function(){this.close()}};function Nl(n){return 0===n.button}function Hl(n){return n.metaKey||n.ctrlKey}var $l={init:function(n){this.el=document.createElement("div"),this.instance=n,this.parent=document.body,jl(this.el,{position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0}),this.updateStyle(n.options),Pl(this.el,"click",n.handler.clickOverlay.bind(n))},updateStyle:function(n){jl(this.el,{zIndex:n.zIndex,backgroundColor:n.bgColor,transition:"opacity\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction})},insert:function(){this.parent.appendChild(this.el)},remove:function(){this.parent.removeChild(this.el)},fadeIn:function(){this.el.offsetWidth,this.el.style.opacity=this.instance.options.bgOpacity},fadeOut:function(){this.el.style.opacity=0}},Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wl=function(){function n(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),Gl=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Kl={init:function(n,e){this.el=n,this.instance=e,this.srcThumbnail=this.el.getAttribute("src"),this.srcset=this.el.getAttribute("srcset"),this.srcOriginal=Bl(this.el),this.rect=this.el.getBoundingClientRect(),this.translate=null,this.scale=null,this.styleOpen=null,this.styleClose=null},zoomIn:function(){var n=this.instance.options,e=n.zIndex,t=n.enableGrab,r=n.transitionDuration,i=n.transitionTimingFunction;this.translate=this.calculateTranslate(),this.scale=this.calculateScale(),this.styleOpen={position:"relative",zIndex:e+1,cursor:t?zl:_l,transition:Ll+"\n        "+r+"s\n        "+i,transform:"translate3d("+this.translate.x+"px, "+this.translate.y+"px, 0px)\n        scale("+this.scale.x+","+this.scale.y+")",height:this.rect.height+"px",width:this.rect.width+"px"},this.el.offsetWidth,this.styleClose=jl(this.el,this.styleOpen,!0)},zoomOut:function(){this.el.offsetWidth,jl(this.el,{transform:"none"})},grab:function(n,e,t){var r=Vl(),i=r.x-n,a=r.y-e;jl(this.el,{cursor:Al,transform:"translate3d(\n        "+(this.translate.x+i)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},move:function(n,e,t){var r=Vl(),i=r.x-n,a=r.y-e;jl(this.el,{transition:Ll,transform:"translate3d(\n        "+(this.translate.x+i)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+t)+","+(this.scale.y+t)+")"})},restoreCloseStyle:function(){jl(this.el,this.styleClose)},restoreOpenStyle:function(){jl(this.el,this.styleOpen)},upgradeSource:function(){if(this.srcOriginal){var n=this.el.parentNode;this.srcset&&this.el.removeAttribute("srcset");var e=this.el.cloneNode(!1);e.setAttribute("src",this.srcOriginal),e.style.position="fixed",e.style.visibility="hidden",n.appendChild(e),setTimeout(function(){this.el.setAttribute("src",this.srcOriginal),n.removeChild(e)}.bind(this),50)}},downgradeSource:function(){this.srcOriginal&&(this.srcset&&this.el.setAttribute("srcset",this.srcset),this.el.setAttribute("src",this.srcThumbnail))},calculateTranslate:function(){var n=Vl(),e=this.rect.left+this.rect.width/2,t=this.rect.top+this.rect.height/2;return{x:n.x-e,y:n.y-t}},calculateScale:function(){var n=this.el.dataset,e=n.zoomingHeight,t=n.zoomingWidth,r=this.instance.options,i=r.customSize,a=r.scaleBase;if(!i&&e&&t)return{x:t/this.rect.width,y:e/this.rect.height};if(i&&"object"===(void 0===i?"undefined":Ql(i)))return{x:i.width/this.rect.width,y:i.height/this.rect.height};var o=this.rect.width/2,l=this.rect.height/2,s=Vl(),c={x:s.x-o,y:s.y-l},d=c.x/o,u=c.y/l,p=a+Math.min(d,u);if(i&&"string"==typeof i){var m=t||this.el.naturalWidth,h=e||this.el.naturalHeight,g=parseFloat(i)*m/(100*this.rect.width),f=parseFloat(i)*h/(100*this.rect.height);if(p>g||p>f)return{x:g,y:f}}return{x:p,y:p}}};function Vl(){var n=document.documentElement;return{x:Math.min(n.clientWidth,window.innerWidth)/2,y:Math.min(n.clientHeight,window.innerHeight)/2}}function Jl(n,e,t){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach((function(r){Pl(n,r,e[r],t)}))}var Zl=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.target=Object.create(Kl),this.overlay=Object.create($l),this.handler=Object.create(Ul),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=Gl({},Fl,e),this.overlay.init(this),this.handler.init(this)}return Wl(n,[{key:"listen",value:function(n){if("string"==typeof n)for(var e=document.querySelectorAll(n),t=e.length;t--;)this.listen(e[t]);else"IMG"===n.tagName&&(n.style.cursor=El,Pl(n,"click",this.handler.click),this.options.preloadImage&&Rl(Bl(n)));return this}},{key:"config",value:function(n){return n?(Gl(this.options,n),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var r="string"==typeof n?document.querySelector(n):n;if("IMG"===r.tagName){if(this.options.onBeforeOpen(r),this.target.init(r,this),!this.options.preloadImage){var i=this.target.srcOriginal;null!=i&&(this.options.onImageLoading(r),Rl(i,this.options.onImageLoaded))}this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.fadeIn(),Pl(document,"scroll",this.handler.scroll),Pl(document,"keydown",this.handler.keydown),this.options.closeOnWindowResize&&Pl(window,"resize",this.handler.resizeWindow);var a=function n(){Pl(r,Ol,n,!1),e.lock=!1,e.target.upgradeSource(),e.options.enableGrab&&Jl(document,e.handler,!0),t(r)};return Pl(r,Ol,a),this}}}},{key:"close",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeClose(t),this.lock=!0,this.body.style.cursor=Sl,this.overlay.fadeOut(),this.target.zoomOut(),Pl(document,"scroll",this.handler.scroll,!1),Pl(document,"keydown",this.handler.keydown,!1),this.options.closeOnWindowResize&&Pl(window,"resize",this.handler.resizeWindow,!1);var r=function r(){Pl(t,Ol,r,!1),n.shown=!1,n.lock=!1,n.target.downgradeSource(),n.options.enableGrab&&Jl(document,n.handler,!1),n.target.restoreCloseStyle(),n.overlay.remove(),e(t)};return Pl(t,Ol,r),this}}},{key:"grab",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onGrab;if(this.shown&&!this.lock){var i=this.target.el;this.options.onBeforeGrab(i),this.released=!1,this.target.grab(n,e,t);var a=function n(){Pl(i,Ol,n,!1),r(i)};return Pl(i,Ol,a),this}}},{key:"move",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onMove;if(this.shown&&!this.lock){this.released=!1,this.body.style.cursor=Al,this.target.move(n,e,t);var i=this.target.el,a=function n(){Pl(i,Ol,n,!1),r(i)};return Pl(i,Ol,a),this}}},{key:"release",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var t=this.target.el;this.options.onBeforeRelease(t),this.lock=!0,this.body.style.cursor=Sl,this.target.restoreOpenStyle();var r=function r(){Pl(t,Ol,r,!1),n.lock=!1,n.released=!0,e(t)};return Pl(t,Ol,r),this}}}]),n}(),Xl=".theme-vdoing-content img:not(.no-zoom)",Yl=JSON.parse('{"bgColor":"rgba(0,0,0,0.6)"}'),ns=Number("500"),es=function(){function n(){cl(this,n),this.instance=new Zl(Yl)}return ul(n,[{key:"update",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xl;"undefined"!=typeof window&&this.instance.listen(n)}},{key:"updateDelay",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xl,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ns;setTimeout((function(){return n.update(e)}),t)}}]),n}(),ts=[Yo,al,sl,ml,Cl,{watch:{"$page.path":function(){void 0!==this.$vuepress.zooming&&this.$vuepress.zooming.updateDelay()}},mounted:function(){this.$vuepress.zooming=new es,this.$vuepress.zooming.updateDelay()}}],rs={name:"GlobalLayout",computed:{layout:function(){var n=this.getLayout();return Go("layout",n),Bi.component(n)}},methods:{getLayout:function(){if(this.$page.path){var n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},is=t(30),as=Object(is.a)(rs,(function(){var n=this.$createElement;return(this._self._c||n)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,e,t){var r;switch(e){case"components":n[e]||(n[e]={}),Object.assign(n[e],t);break;case"mixins":n[e]||(n[e]=[]),(r=n[e]).push.apply(r,Object(Eo.a)(t));break;default:throw new Error("Unknown option name.")}}(as,"mixins",ts);var os=[{name:"v-7f042c4c",path:"/pages/51af24/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-7f042c4c").then(t)}},{path:"/pages/51af24/index.html",redirect:"/pages/51af24/"},{path:"/01.æ¶æ/01.ç³»ç»æ¶æé¢è¯.html",redirect:"/pages/51af24/"},{name:"v-55ab495b",path:"/pages/c083ab/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-55ab495b").then(t)}},{path:"/pages/c083ab/index.html",redirect:"/pages/c083ab/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/Cinchcastçæ¶æ.html",redirect:"/pages/c083ab/"},{name:"v-7f4fa8ff",path:"/pages/f54c7b/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-7f4fa8ff").then(t)}},{path:"/pages/f54c7b/index.html",redirect:"/pages/f54c7b/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/",redirect:"/pages/f54c7b/"},{name:"v-26f88fff",path:"/pages/008eff/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-26f88fff").then(t)}},{path:"/pages/008eff/index.html",redirect:"/pages/008eff/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/äºé©¬éçæ¶æ.html",redirect:"/pages/008eff/"},{name:"v-1e2a0709",path:"/pages/b8e814/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1e2a0709").then(t)}},{path:"/pages/b8e814/index.html",redirect:"/pages/b8e814/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/ä½ä»£ç å¹³å°.html",redirect:"/pages/b8e814/"},{name:"v-7a3f894c",path:"/pages/1ed7ae/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-7a3f894c").then(t)}},{path:"/pages/1ed7ae/index.html",redirect:"/pages/1ed7ae/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/æµ·éæ°æ®å¤ç.html",redirect:"/pages/1ed7ae/"},{name:"v-adecc362",path:"/pages/49a2bd/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-adecc362").then(t)}},{path:"/pages/49a2bd/index.html",redirect:"/pages/49a2bd/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/çµå.html",redirect:"/pages/49a2bd/"},{name:"v-63a49f52",path:"/pages/cb2119/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-63a49f52").then(t)}},{path:"/pages/cb2119/index.html",redirect:"/pages/cb2119/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/ç­å°åæå¡.html",redirect:"/pages/cb2119/"},{name:"v-1e5e3fdf",path:"/pages/d86624/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1e5e3fdf").then(t)}},{path:"/pages/d86624/index.html",redirect:"/pages/d86624/"},{path:"/01.æ¶æ/01.è§£å³æ¹æ¡/ç§æç³»ç»è®¾è®¡.html",redirect:"/pages/d86624/"},{name:"v-fea1ca6c",path:"/pages/0c680e/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-fea1ca6c").then(t)}},{path:"/pages/0c680e/index.html",redirect:"/pages/0c680e/"},{path:"/01.æ¶æ/02.å®å¨/01.è®¤è¯åææ.html",redirect:"/pages/0c680e/"},{name:"v-dc1b4da6",path:"/pages/292687/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-dc1b4da6").then(t)}},{path:"/pages/292687/index.html",redirect:"/pages/292687/"},{path:"/01.æ¶æ/02.å®å¨/02.OAuth2.0.html",redirect:"/pages/292687/"},{name:"v-265d3d7e",path:"/pages/ce2da4/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-265d3d7e").then(t)}},{path:"/pages/ce2da4/index.html",redirect:"/pages/ce2da4/"},{path:"/01.æ¶æ/02.ç³»ç»æ¶ææ¦è¿°.html",redirect:"/pages/ce2da4/"},{name:"v-4239add5",path:"/pages/41c2c7/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-4239add5").then(t)}},{path:"/pages/41c2c7/index.html",redirect:"/pages/41c2c7/"},{path:"/01.æ¶æ/03.ç³»ç»é«æ§è½æ¶æ.html",redirect:"/pages/41c2c7/"},{name:"v-932f2d58",path:"/pages/ad5762/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-932f2d58").then(t)}},{path:"/pages/ad5762/index.html",redirect:"/pages/ad5762/"},{path:"/01.æ¶æ/04.ç³»ç»é«å¯ç¨æ¶æ.html",redirect:"/pages/ad5762/"},{name:"v-6097cc9c",path:"/pages/ed2a88/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6097cc9c").then(t)}},{path:"/pages/ed2a88/index.html",redirect:"/pages/ed2a88/"},{path:"/01.æ¶æ/05.ç³»ç»ä¼¸ç¼©æ§æ¶æ.html",redirect:"/pages/ed2a88/"},{name:"v-6395f8b6",path:"/pages/1580de/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6395f8b6").then(t)}},{path:"/pages/1580de/index.html",redirect:"/pages/1580de/"},{path:"/01.æ¶æ/06.ç³»ç»æ©å±æ§æ¶æ.html",redirect:"/pages/1580de/"},{name:"v-11101d84",path:"/pages/039552/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-11101d84").then(t)}},{path:"/pages/039552/index.html",redirect:"/pages/039552/"},{path:"/01.æ¶æ/07.ç³»ç»å®å¨æ§æ¶æ.html",redirect:"/pages/039552/"},{name:"v-190803ce",path:"/pages/eb0425/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-190803ce").then(t)}},{path:"/pages/eb0425/index.html",redirect:"/pages/eb0425/"},{path:"/01.æ¶æ/08.å¤§åç³»ç»æ ¸å¿ææ¯.html",redirect:"/pages/eb0425/"},{name:"v-6655d46f",path:"/pages/4dfb51/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6655d46f").then(t)}},{path:"/pages/4dfb51/index.html",redirect:"/pages/4dfb51/"},{path:"/01.æ¶æ/09.é¢åé©±å¨è®¾è®¡.html",redirect:"/pages/4dfb51/"},{name:"v-510eccb8",path:"/pages/cbf9f8/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-510eccb8").then(t)}},{path:"/pages/cbf9f8/index.html",redirect:"/pages/cbf9f8/"},{path:"/01.æ¶æ/",redirect:"/pages/cbf9f8/"},{name:"v-491fd7ec",path:"/pages/3d05e6/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-491fd7ec").then(t)}},{path:"/pages/3d05e6/index.html",redirect:"/pages/3d05e6/"},{path:"/01.æ¶æ/å¦ä½è®¾è®¡ç³»ç».html",redirect:"/pages/3d05e6/"},{name:"v-b75e4ec2",path:"/pages/45e366/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-b75e4ec2").then(t)}},{path:"/pages/45e366/index.html",redirect:"/pages/45e366/"},{path:"/01.æ¶æ/ç³»ç»æµè¯æ¶æ.html",redirect:"/pages/45e366/"},{name:"v-21ce6260",path:"/pages/cd56bb/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-21ce6260").then(t)}},{path:"/pages/cd56bb/index.html",redirect:"/pages/cd56bb/"},{path:"/02.åå¸å¼/01.åå¸å¼ç»¼å/01.åå¸å¼é¢è¯æ»ç».html",redirect:"/pages/cd56bb/"},{name:"v-6ef572de",path:"/pages/367308/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6ef572de").then(t)}},{path:"/pages/367308/index.html",redirect:"/pages/367308/"},{path:"/02.åå¸å¼/02.åå¸å¼çè®º/01.åå¸å¼çè®º.html",redirect:"/pages/367308/"},{name:"v-47519682",path:"/pages/874539/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-47519682").then(t)}},{path:"/pages/874539/index.html",redirect:"/pages/874539/"},{path:"/02.åå¸å¼/02.åå¸å¼çè®º/02.åå¸å¼ç®æ³Paxos.html",redirect:"/pages/874539/"},{name:"v-67c5593b",path:"/pages/e40812/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-67c5593b").then(t)}},{path:"/pages/e40812/index.html",redirect:"/pages/e40812/"},{path:"/02.åå¸å¼/02.åå¸å¼çè®º/03.åå¸å¼ç®æ³Raft.html",redirect:"/pages/e40812/"},{name:"v-0bf2fe55",path:"/pages/d15993/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0bf2fe55").then(t)}},{path:"/pages/d15993/index.html",redirect:"/pages/d15993/"},{path:"/02.åå¸å¼/02.åå¸å¼çè®º/04.åå¸å¼ç®æ³Gossip.html",redirect:"/pages/d15993/"},{name:"v-1cd4c4a0",path:"/pages/282676/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1cd4c4a0").then(t)}},{path:"/pages/282676/index.html",redirect:"/pages/282676/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/01.æµéæ§å¶.html",redirect:"/pages/282676/"},{name:"v-af744166",path:"/pages/b7ca44/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-af744166").then(t)}},{path:"/pages/b7ca44/index.html",redirect:"/pages/b7ca44/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/02.è´è½½åè¡¡.html",redirect:"/pages/b7ca44/"},{name:"v-5a6ba150",path:"/pages/d04ece/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-5a6ba150").then(t)}},{path:"/pages/d04ece/index.html",redirect:"/pages/d04ece/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/03.æå¡è·¯ç±.html",redirect:"/pages/d04ece/"},{name:"v-278d74e8",path:"/pages/3e66c2/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-278d74e8").then(t)}},{path:"/pages/3e66c2/index.html",redirect:"/pages/3e66c2/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/10.åå¸å¼ä¼è¯.html",redirect:"/pages/3e66c2/"},{name:"v-6091d31b",path:"/pages/471208/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6091d31b").then(t)}},{path:"/pages/471208/index.html",redirect:"/pages/471208/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/01.æ°æ®ç¼å­.html",redirect:"/pages/471208/"},{name:"v-1af69402",path:"/pages/7da6ca/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1af69402").then(t)}},{path:"/pages/7da6ca/index.html",redirect:"/pages/7da6ca/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/02.è¯»ååç¦».html",redirect:"/pages/7da6ca/"},{name:"v-f52afa76",path:"/pages/103382/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-f52afa76").then(t)}},{path:"/pages/103382/index.html",redirect:"/pages/103382/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/03.ååºåè¡¨.html",redirect:"/pages/103382/"},{name:"v-255354da",path:"/pages/0b2e59/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-255354da").then(t)}},{path:"/pages/0b2e59/index.html",redirect:"/pages/0b2e59/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/04.åå¸å¼ID.html",redirect:"/pages/0b2e59/"},{name:"v-0349074a",path:"/pages/910bad/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0349074a").then(t)}},{path:"/pages/910bad/index.html",redirect:"/pages/910bad/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/05.åå¸å¼äºå¡.html",redirect:"/pages/910bad/"},{name:"v-65b0509c",path:"/pages/69360c/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-65b0509c").then(t)}},{path:"/pages/69360c/index.html",redirect:"/pages/69360c/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/06.åå¸å¼é.html",redirect:"/pages/69360c/"},{name:"v-30f4df2d",path:"/pages/4bba35/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-30f4df2d").then(t)}},{path:"/pages/4bba35/index.html",redirect:"/pages/4bba35/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/04.éä¿¡/01.æ¶æ¯éå.html",redirect:"/pages/4bba35/"},{name:"v-686da33c",path:"/pages/516f3b/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-686da33c").then(t)}},{path:"/pages/516f3b/index.html",redirect:"/pages/516f3b/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/01.æå¡æ³¨åååç°.html",redirect:"/pages/516f3b/"},{name:"v-03ef00cc",path:"/pages/4c0174/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-03ef00cc").then(t)}},{path:"/pages/4c0174/index.html",redirect:"/pages/4c0174/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/02.æå¡çæ§.html",redirect:"/pages/4c0174/"},{name:"v-7f83aac5",path:"/pages/f918df/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-7f83aac5").then(t)}},{path:"/pages/f918df/index.html",redirect:"/pages/f918df/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/03.æå¡é¾è·¯çæ§.html",redirect:"/pages/f918df/"},{name:"v-35aeaf87",path:"/pages/28bda8/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-35aeaf87").then(t)}},{path:"/pages/28bda8/index.html",redirect:"/pages/28bda8/"},{path:"/02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/04.æå¡å®¹é.html",redirect:"/pages/28bda8/"},{name:"v-6c538cc0",path:"/pages/5b6d71/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6c538cc0").then(t)}},{path:"/pages/5b6d71/index.html",redirect:"/pages/5b6d71/"},{path:"/02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/01.å¾®æå¡åºæ¬åç.html",redirect:"/pages/5b6d71/"},{name:"v-056e1262",path:"/pages/f13c06/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-056e1262").then(t)}},{path:"/pages/f13c06/index.html",redirect:"/pages/f13c06/"},{path:"/02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/01.å¾®æå¡ç®ä».html",redirect:"/pages/f13c06/"},{name:"v-ecdbd4a2",path:"/pages/ebf86b/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-ecdbd4a2").then(t)}},{path:"/pages/ebf86b/index.html",redirect:"/pages/ebf86b/"},{path:"/02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/02.RPC.html",redirect:"/pages/ebf86b/"},{name:"v-27b2649e",path:"/pages/3c87eb/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-27b2649e").then(t)}},{path:"/pages/3c87eb/index.html",redirect:"/pages/3c87eb/"},{path:"/02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/22.Kong.html",redirect:"/pages/3c87eb/"},{name:"v-55732b48",path:"/pages/7e2fd1/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-55732b48").then(t)}},{path:"/pages/7e2fd1/index.html",redirect:"/pages/7e2fd1/"},{path:"/02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/",redirect:"/pages/7e2fd1/"},{name:"v-12aaaa7d",path:"/pages/3cb60a/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-12aaaa7d").then(t)}},{path:"/pages/3cb60a/index.html",redirect:"/pages/3cb60a/"},{path:"/02.åå¸å¼/",redirect:"/pages/3cb60a/"},{name:"v-6dbfe670",path:"/pages/eae6a0/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6dbfe670").then(t)}},{path:"/pages/eae6a0/index.html",redirect:"/pages/eae6a0/"},{path:"/03.è®¾è®¡/01.UML/01.UMLå¿«éå¥é¨.html",redirect:"/pages/eae6a0/"},{name:"v-43c755b4",path:"/pages/97f796/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-43c755b4").then(t)}},{path:"/pages/97f796/index.html",redirect:"/pages/97f796/"},{path:"/03.è®¾è®¡/01.UML/02.UMLç»æå»ºæ¨¡å¾.html",redirect:"/pages/97f796/"},{name:"v-2b866fe8",path:"/pages/dba425/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-2b866fe8").then(t)}},{path:"/pages/dba425/index.html",redirect:"/pages/dba425/"},{path:"/03.è®¾è®¡/01.UML/03.UMLè¡ä¸ºå»ºæ¨¡å¾.html",redirect:"/pages/dba425/"},{name:"v-bad396a0",path:"/pages/8f04b3/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-bad396a0").then(t)}},{path:"/pages/8f04b3/index.html",redirect:"/pages/8f04b3/"},{path:"/03.è®¾è®¡/01.UML/",redirect:"/pages/8f04b3/"},{name:"v-33b23c84",path:"/pages/dad9fd/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-33b23c84").then(t)}},{path:"/pages/dad9fd/index.html",redirect:"/pages/dad9fd/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/00.è®¾è®¡æ¨¡å¼æ¦è¿°.html",redirect:"/pages/dad9fd/"},{name:"v-13d9f031",path:"/pages/4244b2/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-13d9f031").then(t)}},{path:"/pages/4244b2/index.html",redirect:"/pages/4244b2/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/01.ç®åå·¥åæ¨¡å¼.html",redirect:"/pages/4244b2/"},{name:"v-a097a3be",path:"/pages/58cd12/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-a097a3be").then(t)}},{path:"/pages/58cd12/index.html",redirect:"/pages/58cd12/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/02.å·¥åæ¹æ³æ¨¡å¼.html",redirect:"/pages/58cd12/"},{name:"v-3a239cb0",path:"/pages/d40cbb/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-3a239cb0").then(t)}},{path:"/pages/d40cbb/index.html",redirect:"/pages/d40cbb/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/03.æ½è±¡å·¥åæ¨¡å¼.html",redirect:"/pages/d40cbb/"},{name:"v-1bdc9712",path:"/pages/cb480c/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1bdc9712").then(t)}},{path:"/pages/cb480c/index.html",redirect:"/pages/cb480c/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/04.å»ºé èæ¨¡å¼.html",redirect:"/pages/cb480c/"},{name:"v-68de8656",path:"/pages/c5ff69/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-68de8656").then(t)}},{path:"/pages/c5ff69/index.html",redirect:"/pages/c5ff69/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/05.ååæ¨¡å¼.html",redirect:"/pages/c5ff69/"},{name:"v-72ea5972",path:"/pages/b271ff/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-72ea5972").then(t)}},{path:"/pages/b271ff/index.html",redirect:"/pages/b271ff/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/06.åä¾æ¨¡å¼.html",redirect:"/pages/b271ff/"},{name:"v-b5457c16",path:"/pages/2c4733/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-b5457c16").then(t)}},{path:"/pages/2c4733/index.html",redirect:"/pages/2c4733/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/07.ééå¨æ¨¡å¼.html",redirect:"/pages/2c4733/"},{name:"v-0569b6f8",path:"/pages/9f520d/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0569b6f8").then(t)}},{path:"/pages/9f520d/index.html",redirect:"/pages/9f520d/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/08.æ¡¥æ¥æ¨¡å¼.html",redirect:"/pages/9f520d/"},{name:"v-4e6d8200",path:"/pages/b18a73/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-4e6d8200").then(t)}},{path:"/pages/b18a73/index.html",redirect:"/pages/b18a73/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/09.ç»åæ¨¡å¼.html",redirect:"/pages/b18a73/"},{name:"v-2c19e87c",path:"/pages/12897e/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-2c19e87c").then(t)}},{path:"/pages/12897e/index.html",redirect:"/pages/12897e/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/10.è£é¥°æ¨¡å¼.html",redirect:"/pages/12897e/"},{name:"v-25c50554",path:"/pages/427347/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-25c50554").then(t)}},{path:"/pages/427347/index.html",redirect:"/pages/427347/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/11.å¤è§æ¨¡å¼.html",redirect:"/pages/427347/"},{name:"v-6e2d857c",path:"/pages/265866/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-6e2d857c").then(t)}},{path:"/pages/265866/index.html",redirect:"/pages/265866/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/12.äº«åæ¨¡å¼.html",redirect:"/pages/265866/"},{name:"v-51d6ac9c",path:"/pages/2937c1/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-51d6ac9c").then(t)}},{path:"/pages/2937c1/index.html",redirect:"/pages/2937c1/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/13.ä»£çæ¨¡å¼.html",redirect:"/pages/2937c1/"},{name:"v-f82d5ee0",path:"/pages/604ebc/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-f82d5ee0").then(t)}},{path:"/pages/604ebc/index.html",redirect:"/pages/604ebc/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/14.æ¨¡æ¿æ¹æ³æ¨¡å¼.html",redirect:"/pages/604ebc/"},{name:"v-e65aab34",path:"/pages/6389ed/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-e65aab34").then(t)}},{path:"/pages/6389ed/index.html",redirect:"/pages/6389ed/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/15.å½ä»¤æ¨¡å¼.html",redirect:"/pages/6389ed/"},{name:"v-637f7ff4",path:"/pages/d2026d/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-637f7ff4").then(t)}},{path:"/pages/d2026d/index.html",redirect:"/pages/d2026d/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/16.è¿­ä»£å¨æ¨¡å¼.html",redirect:"/pages/d2026d/"},{name:"v-07d9254f",path:"/pages/87fbaa/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-07d9254f").then(t)}},{path:"/pages/87fbaa/index.html",redirect:"/pages/87fbaa/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/17.è§å¯èæ¨¡å¼.html",redirect:"/pages/87fbaa/"},{name:"v-cc527b5a",path:"/pages/1e0eff/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-cc527b5a").then(t)}},{path:"/pages/1e0eff/index.html",redirect:"/pages/1e0eff/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/18.è§£éå¨æ¨¡å¼.html",redirect:"/pages/1e0eff/"},{name:"v-04ae6228",path:"/pages/b5886f/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-04ae6228").then(t)}},{path:"/pages/b5886f/index.html",redirect:"/pages/b5886f/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/19.ä¸­ä»èæ¨¡å¼.html",redirect:"/pages/b5886f/"},{name:"v-1a6137e8",path:"/pages/a92964/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1a6137e8").then(t)}},{path:"/pages/a92964/index.html",redirect:"/pages/a92964/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/20.èè´£é¾æ¨¡å¼.html",redirect:"/pages/a92964/"},{name:"v-ca584e06",path:"/pages/e3cd5d/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-ca584e06").then(t)}},{path:"/pages/e3cd5d/index.html",redirect:"/pages/e3cd5d/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/21.å¤å¿å½æ¨¡å¼.html",redirect:"/pages/e3cd5d/"},{name:"v-f0251290",path:"/pages/e5bb92/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-f0251290").then(t)}},{path:"/pages/e5bb92/index.html",redirect:"/pages/e5bb92/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/22.ç­ç¥æ¨¡å¼.html",redirect:"/pages/e5bb92/"},{name:"v-0f7af49e",path:"/pages/6e8ebc/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0f7af49e").then(t)}},{path:"/pages/6e8ebc/index.html",redirect:"/pages/6e8ebc/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/23.è®¿é®èæ¨¡å¼.html",redirect:"/pages/6e8ebc/"},{name:"v-1457855d",path:"/pages/6420d5/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-1457855d").then(t)}},{path:"/pages/6420d5/index.html",redirect:"/pages/6420d5/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/24.ç¶ææ¨¡å¼.html",redirect:"/pages/6420d5/"},{name:"v-3f96c8d8",path:"/pages/b3c94e/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-3f96c8d8").then(t)}},{path:"/pages/b3c94e/index.html",redirect:"/pages/b3c94e/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/25.é¢åå¯¹è±¡åå.html",redirect:"/pages/b3c94e/"},{name:"v-0893d5c3",path:"/pages/4b9193/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0893d5c3").then(t)}},{path:"/pages/4b9193/index.html",redirect:"/pages/4b9193/"},{path:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/",redirect:"/pages/4b9193/"},{name:"v-79c78335",path:"/pages/89848c/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-79c78335").then(t)}},{path:"/pages/89848c/index.html",redirect:"/pages/89848c/"},{path:"/03.è®¾è®¡/03.éæ/01.ä»£ç çåå³éåéæ.html",redirect:"/pages/89848c/"},{name:"v-c5ef3042",path:"/pages/82f4c8/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-c5ef3042").then(t)}},{path:"/pages/82f4c8/index.html",redirect:"/pages/82f4c8/"},{path:"/03.è®¾è®¡/03.éæ/02.ä»£ç åå³éä¹ä»£ç èè¿.html",redirect:"/pages/82f4c8/"},{name:"v-ce0e8fd4",path:"/pages/9ae679/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-ce0e8fd4").then(t)}},{path:"/pages/9ae679/index.html",redirect:"/pages/9ae679/"},{path:"/03.è®¾è®¡/03.éæ/03.ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡.html",redirect:"/pages/9ae679/"},{name:"v-38d3c9ce",path:"/pages/76e1cc/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-38d3c9ce").then(t)}},{path:"/pages/76e1cc/index.html",redirect:"/pages/76e1cc/"},{path:"/03.è®¾è®¡/03.éæ/04.ä»£ç åå³éä¹åé©çéç¢.html",redirect:"/pages/76e1cc/"},{name:"v-5d9b4816",path:"/pages/dff53d/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-5d9b4816").then(t)}},{path:"/pages/dff53d/index.html",redirect:"/pages/dff53d/"},{path:"/03.è®¾è®¡/03.éæ/05.ä»£ç åå³éä¹éå¿è¦ç.html",redirect:"/pages/dff53d/"},{name:"v-3a98d9f2",path:"/pages/595d03/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-3a98d9f2").then(t)}},{path:"/pages/595d03/index.html",redirect:"/pages/595d03/"},{path:"/03.è®¾è®¡/03.éæ/06.ä»£ç åå³éä¹è¦å.html",redirect:"/pages/595d03/"},{name:"v-45cada9f",path:"/pages/156570/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-45cada9f").then(t)}},{path:"/pages/156570/index.html",redirect:"/pages/156570/"},{path:"/03.è®¾è®¡/03.éæ/",redirect:"/pages/156570/"},{name:"v-612a002e",path:"/pages/dc158b/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-612a002e").then(t)}},{path:"/pages/dc158b/index.html",redirect:"/pages/dc158b/"},{path:"/03.è®¾è®¡/04.ç¼ç¨èå¼/01.éè¯¯å¤ç.html",redirect:"/pages/dc158b/"},{name:"v-179f8f74",path:"/pages/9e0f8e/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-179f8f74").then(t)}},{path:"/pages/9e0f8e/index.html",redirect:"/pages/9e0f8e/"},{path:"/03.è®¾è®¡/04.ç¼ç¨èå¼/",redirect:"/pages/9e0f8e/"},{name:"v-02e2a776",path:"/archives/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-02e2a776").then(t)}},{path:"/archives/index.html",redirect:"/archives/"},{path:"/@pages/archivesPage.html",redirect:"/archives/"},{name:"v-20b770b6",path:"/categories/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-20b770b6").then(t)}},{path:"/categories/index.html",redirect:"/categories/"},{path:"/@pages/categoriesPage.html",redirect:"/categories/"},{name:"v-0480d1c5",path:"/tags/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-0480d1c5").then(t)}},{path:"/tags/index.html",redirect:"/tags/"},{path:"/@pages/tagsPage.html",redirect:"/tags/"},{name:"v-7e5bbd14",path:"/",component:as,beforeEnter:function(n,e,t){Wo("Layout","v-7e5bbd14").then(t)}},{path:"/index.html",redirect:"/"},{path:"*",component:as}],ls={title:"DESIGN",description:"Design æ¯ä¸ªäººçæ¶æè®¾è®¡å¿å¾",base:"/design/",headTags:[["link",{rel:"icon",href:"/design/img/favicon.ico"}],["meta",{name:"keywords",content:"vuepress,theme,blog,vdoing"}],["meta",{name:"theme-color",content:"#11a8cd"}]],pages:[{title:"ç³»ç»æ¶æé¢è¯",frontmatter:{title:"ç³»ç»æ¶æé¢è¯",date:"2020-08-10T10:59:18.000Z",categories:["æ¶æ"],tags:["æ¶æ","é¢è¯"],permalink:"/pages/51af24/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E9%9D%A2%E8%AF%95.html",relativePath:"01.æ¶æ/01.ç³»ç»æ¶æé¢è¯.md",key:"v-7f042c4c",path:"/pages/51af24/",headers:[{level:2,title:"1. å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»ï¼",slug:"_1-å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»",normalizedTitle:"1. å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»ï¼",charIndex:13},{level:3,title:"1.1. ç§æç³»ç»çææ",slug:"_1-1-ç§æç³»ç»çææ",normalizedTitle:"1.1. ç§æç³»ç»çææ",charIndex:32},{level:3,title:"1.2. ç§æç³»ç»çè§£å³æè·¯",slug:"_1-2-ç§æç³»ç»çè§£å³æè·¯",normalizedTitle:"1.2. ç§æç³»ç»çè§£å³æè·¯",charIndex:119},{level:3,title:"1.3. ç§æç³»ç»çè§£å³æ¹æ¡",slug:"_1-3-ç§æç³»ç»çè§£å³æ¹æ¡",normalizedTitle:"1.3. ç§æç³»ç»çè§£å³æ¹æ¡",charIndex:372},{level:2,title:"2. åèèµæ",slug:"_2-åèèµæ",normalizedTitle:"2. åèèµæ",charIndex:1056}],headersStr:"1. å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»ï¼ 1.1. ç§æç³»ç»çææ 1.2. ç§æç³»ç»çè§£å³æè·¯ 1.3. ç§æç³»ç»çè§£å³æ¹æ¡ 2. åèèµæ",content:'# ç³»ç»æ¶æé¢è¯\n\n\n# 1. å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»ï¼\n\n\n# 1.1. ç§æç³»ç»çææ\n\nç§æçæ ¸å¿é®é¢å°±æ¯æé«å¹¶åå¤çï¼ç±äºç³»ç»è¦å¨ç¬æ¶æ¿åå¹³æ¶æ°ååçè³ä¸ç¾åçæµéï¼è¿å¾å¾è¶åºç³»ç»ä¸éï¼å æ­¤å¤çç§æçæ ¸å¿æè·¯æ¯éæµåç¼å­ã\n\n\n# 1.2. ç§æç³»ç»çè§£å³æè·¯\n\n * ç³»ç»ä¸ææ¦æªæµéï¼å°½å¯è½å¨ä¸æ¸¸æ¦æªåéå¶è¯·æ±ï¼éå¶æµå¥åç«¯çéï¼ä¿è¯åç«¯ç³»ç»æ­£å¸¸ã å ä¸ºæ è®ºå¤å°äººåä¸ç§æï¼å®éæäº¤å¾å¾æ¯æéçï¼èä¸è¿å°äºåå ç§æçäººæ°ï¼å æ­¤å¯ä»¥éè¿åç«¯ç³»ç»è¿è¡æ¦æªï¼éå¶æç»æµå¥ç³»ç»çè¯·æ±æ°éï¼æ¥ä¿è¯ç³»ç»æ­£å¸¸è¿è¡ã\n * ååå©ç¨ç¼å­ï¼è¿æ¯ä¸ä¸ªå¸åçè¯»å¤åå°çåºç¨åºæ¯ï¼ä¸è¶ç«è½¦å¶å®åªæ 2000 å¼ ç¥¨ï¼200w ä¸ªäººæ¥ä¹°ï¼æå¤ 2000 ä¸ªäººä¸åæåï¼å¶ä»äººé½æ¯æ¥è¯¢åºå­ï¼åæ¯ä¾åªæ 0.1%ï¼è¯»æ¯ä¾å  99.9%ï¼ï¼éå¸¸éåä½¿ç¨ç¼å­ã\n\n\n# 1.3. ç§æç³»ç»çè§£å³æ¹æ¡\n\nç§æç³»ç»å·ä½æ¹æ¡å¦ä¸ï¼\n\nï¼1ï¼æµè§å¨ãå®¢æ·ç«¯æ¦æªéå¤è¯·æ±\n\n * ç¨æ·ç¹å»æ¥è¯¢æè´­ä¹°æé®åï¼ç¦ç¨æé®ï¼é¿åç¨æ·éå¤æäº¤è¯·æ±ã\n * JS ä»£ç ä¸­éå¶ç¨æ·å¨éå®æ¶é´ååªåè®¸æäº¤ä¸æ¬¡è¯·æ±\n\nåºäºæ­¤ï¼å¤§é¨åæµéå·²è¢«æ¦æªã\n\nï¼2ï¼åºç¨å±æ¦æªè¯·æ±\n\næµè§å¨ãå®¢æ·ç«¯æ¦æªéå¤è¯·æ±åªè½åºä»éè¿æµè§å¨è®¿é®çç¨æ·ãå¦ææäººéè¿ç¨åºåé http è¯·æ±ï¼åæ æ³æ¦æªãéå¯¹è¿ç§æåµçæ¹æ¡æ¯ï¼\n\nä»¥é¡µé¢ç¼å­çæ¹å¼ï¼éå¯¹ç­æ¶é´åçåä¸ä¸ªè®¿é®æºï¼å¦åä¸ä¸ª IPãåä¸ä¸ª Sessionãåä¸ä¸ªç¨æ· ID å¤æ¬¡åé HTTP è¯·æ±ï¼æåæ ·çæ¥è¯¢è¯·æ±ï¼å¦å¤§éè¯·æ±é½æ¯æ¥è¯¢æç±»ååçåºå­ï¼ï¼é½è¿åç¸åçå±ç¤ºé¡µé¢ã\n\nå¦æ­¤éæµï¼åæå¤§é¨åçæµéè¢«æ¦æª\n\nï¼3ï¼æå¡å±è¯·æ±æ¦æªä¸æ°æ®ç¼å­\n\nå å¥æé»å®¢ï¼æ§å¶äº 10w å°èé¸¡ï¼å¹¶ä¸åè®¾ä¹°ç¥¨ä¸éè¦å®åè®¤è¯ï¼ï¼åé¢ççéå¶é½ä¸èµ·ä½ç¨äºãè¿æ¶åºè¯¥æä¹åï¼\n\n * è¯»è¯·æ±ï¼æ¥åºå­ï¼ - å¯¹äºè¯»è¯·æ±ï¼ç´æ¥ä½¿ç¨ç¼å­å³å¯ï¼ä¸è¬ç¼å­æå¡å¨åæºå¤çæ¯ç§ 10w ä¸ªè¯·æ±åºè¯¥æ²¡ä»ä¹é®é¢ã\n\n * åè¯·æ±ï¼ä¸åï¼ - ç±äºæå¡å±æ¸æ¥çç¥éåºå­æ°éï¼æä»¥å®å¨å¯ä»¥æ ¹æ®åºå­æ°éè¿è¡éæµãå·ä½æ¥è¯´ï¼å°±æ¯æææä¸åè¯·æ±é½ä¸¢è¯¥æ¶æ¯éåä¸­ï¼æ¯æ¬¡åªåæéçåè¯·æ±å»æ°æ®å±å¤çãå½è¿äºåè¯·æ±å¤çå®ï¼æ´æ°ä¸ä¸ç¼å­ä¸­çåºå­æ°ï¼åå»åä¸ä¸æ¹åè¯·æ±ï¼å¦æåºå­æ°ä¸å¤ï¼åæ¶æ¯éåçåè¯·æ±å¨é¨è¿å"å·²å®ç½"çç»æã\n\n> åèï¼\n> \n>  * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - é¿éäºäºæ ç¤¾åºçåç­ - ç¥ä¹\n>  * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - ç½æäºçåç­ - ç¥ä¹\n\n\n# 2. åèèµæ\n\n * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - é¿éäºäºæ ç¤¾åºçåç­ - ç¥ä¹\n * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - ç½æäºçåç­ - ç¥ä¹',normalizedContent:'# ç³»ç»æ¶æé¢è¯\n\n\n# 1. å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»ï¼\n\n\n# 1.1. ç§æç³»ç»çææ\n\nç§æçæ ¸å¿é®é¢å°±æ¯æé«å¹¶åå¤çï¼ç±äºç³»ç»è¦å¨ç¬æ¶æ¿åå¹³æ¶æ°ååçè³ä¸ç¾åçæµéï¼è¿å¾å¾è¶åºç³»ç»ä¸éï¼å æ­¤å¤çç§æçæ ¸å¿æè·¯æ¯éæµåç¼å­ã\n\n\n# 1.2. ç§æç³»ç»çè§£å³æè·¯\n\n * ç³»ç»ä¸ææ¦æªæµéï¼å°½å¯è½å¨ä¸æ¸¸æ¦æªåéå¶è¯·æ±ï¼éå¶æµå¥åç«¯çéï¼ä¿è¯åç«¯ç³»ç»æ­£å¸¸ã å ä¸ºæ è®ºå¤å°äººåä¸ç§æï¼å®éæäº¤å¾å¾æ¯æéçï¼èä¸è¿å°äºåå ç§æçäººæ°ï¼å æ­¤å¯ä»¥éè¿åç«¯ç³»ç»è¿è¡æ¦æªï¼éå¶æç»æµå¥ç³»ç»çè¯·æ±æ°éï¼æ¥ä¿è¯ç³»ç»æ­£å¸¸è¿è¡ã\n * ååå©ç¨ç¼å­ï¼è¿æ¯ä¸ä¸ªå¸åçè¯»å¤åå°çåºç¨åºæ¯ï¼ä¸è¶ç«è½¦å¶å®åªæ 2000 å¼ ç¥¨ï¼200w ä¸ªäººæ¥ä¹°ï¼æå¤ 2000 ä¸ªäººä¸åæåï¼å¶ä»äººé½æ¯æ¥è¯¢åºå­ï¼åæ¯ä¾åªæ 0.1%ï¼è¯»æ¯ä¾å  99.9%ï¼ï¼éå¸¸éåä½¿ç¨ç¼å­ã\n\n\n# 1.3. ç§æç³»ç»çè§£å³æ¹æ¡\n\nç§æç³»ç»å·ä½æ¹æ¡å¦ä¸ï¼\n\nï¼1ï¼æµè§å¨ãå®¢æ·ç«¯æ¦æªéå¤è¯·æ±\n\n * ç¨æ·ç¹å»æ¥è¯¢æè´­ä¹°æé®åï¼ç¦ç¨æé®ï¼é¿åç¨æ·éå¤æäº¤è¯·æ±ã\n * js ä»£ç ä¸­éå¶ç¨æ·å¨éå®æ¶é´ååªåè®¸æäº¤ä¸æ¬¡è¯·æ±\n\nåºäºæ­¤ï¼å¤§é¨åæµéå·²è¢«æ¦æªã\n\nï¼2ï¼åºç¨å±æ¦æªè¯·æ±\n\næµè§å¨ãå®¢æ·ç«¯æ¦æªéå¤è¯·æ±åªè½åºä»éè¿æµè§å¨è®¿é®çç¨æ·ãå¦ææäººéè¿ç¨åºåé http è¯·æ±ï¼åæ æ³æ¦æªãéå¯¹è¿ç§æåµçæ¹æ¡æ¯ï¼\n\nä»¥é¡µé¢ç¼å­çæ¹å¼ï¼éå¯¹ç­æ¶é´åçåä¸ä¸ªè®¿é®æºï¼å¦åä¸ä¸ª ipãåä¸ä¸ª sessionãåä¸ä¸ªç¨æ· id å¤æ¬¡åé http è¯·æ±ï¼æåæ ·çæ¥è¯¢è¯·æ±ï¼å¦å¤§éè¯·æ±é½æ¯æ¥è¯¢æç±»ååçåºå­ï¼ï¼é½è¿åç¸åçå±ç¤ºé¡µé¢ã\n\nå¦æ­¤éæµï¼åæå¤§é¨åçæµéè¢«æ¦æª\n\nï¼3ï¼æå¡å±è¯·æ±æ¦æªä¸æ°æ®ç¼å­\n\nå å¥æé»å®¢ï¼æ§å¶äº 10w å°èé¸¡ï¼å¹¶ä¸åè®¾ä¹°ç¥¨ä¸éè¦å®åè®¤è¯ï¼ï¼åé¢ççéå¶é½ä¸èµ·ä½ç¨äºãè¿æ¶åºè¯¥æä¹åï¼\n\n * è¯»è¯·æ±ï¼æ¥åºå­ï¼ - å¯¹äºè¯»è¯·æ±ï¼ç´æ¥ä½¿ç¨ç¼å­å³å¯ï¼ä¸è¬ç¼å­æå¡å¨åæºå¤çæ¯ç§ 10w ä¸ªè¯·æ±åºè¯¥æ²¡ä»ä¹é®é¢ã\n\n * åè¯·æ±ï¼ä¸åï¼ - ç±äºæå¡å±æ¸æ¥çç¥éåºå­æ°éï¼æä»¥å®å¨å¯ä»¥æ ¹æ®åºå­æ°éè¿è¡éæµãå·ä½æ¥è¯´ï¼å°±æ¯æææä¸åè¯·æ±é½ä¸¢è¯¥æ¶æ¯éåä¸­ï¼æ¯æ¬¡åªåæéçåè¯·æ±å»æ°æ®å±å¤çãå½è¿äºåè¯·æ±å¤çå®ï¼æ´æ°ä¸ä¸ç¼å­ä¸­çåºå­æ°ï¼åå»åä¸ä¸æ¹åè¯·æ±ï¼å¦æåºå­æ°ä¸å¤ï¼åæ¶æ¯éåçåè¯·æ±å¨é¨è¿å"å·²å®ç½"çç»æã\n\n> åèï¼\n> \n>  * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - é¿éäºäºæ ç¤¾åºçåç­ - ç¥ä¹\n>  * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - ç½æäºçåç­ - ç¥ä¹\n\n\n# 2. åèèµæ\n\n * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - é¿éäºäºæ ç¤¾åºçåç­ - ç¥ä¹\n * å¦ä½è®¾è®¡ç§æç³»ç»ï¼ - ç½æäºçåç­ - ç¥ä¹',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"Cinchcast çæ¶æ",frontmatter:{title:"Cinchcast çæ¶æ",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/c083ab/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Cinchcast%E7%9A%84%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/Cinchcastçæ¶æ.md",key:"v-55ab495b",path:"/pages/c083ab/",headers:[{level:2,title:"ç»è®¡æ°æ®",slug:"ç»è®¡æ°æ®",normalizedTitle:"ç»è®¡æ°æ®",charIndex:231},{level:2,title:"æ°æ®ä¸­å¿",slug:"æ°æ®ä¸­å¿",normalizedTitle:"æ°æ®ä¸­å¿",charIndex:417},{level:2,title:"ç¡¬ä»¶",slug:"ç¡¬ä»¶",normalizedTitle:"ç¡¬ä»¶",charIndex:408},{level:2,title:"å¼åå·¥å·",slug:"å¼åå·¥å·",normalizedTitle:"å¼åå·¥å·",charIndex:626},{level:2,title:"è½¯ä»¶åä½¿ç¨çææ¯",slug:"è½¯ä»¶åä½¿ç¨çææ¯",normalizedTitle:"è½¯ä»¶åä½¿ç¨çææ¯",charIndex:839},{level:2,title:"çæµ",slug:"çæµ",normalizedTitle:"çæµ",charIndex:1083},{level:2,title:"æä»¬çåå",slug:"æä»¬çåå",normalizedTitle:"æä»¬çåå",charIndex:1238},{level:2,title:"æ¶æ",slug:"æ¶æ",normalizedTitle:"æ¶æ",charIndex:13},{level:2,title:"ç»éªæè®­",slug:"ç»éªæè®­",normalizedTitle:"ç»éªæè®­",charIndex:1748},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2152}],headersStr:"ç»è®¡æ°æ® æ°æ®ä¸­å¿ ç¡¬ä»¶ å¼åå·¥å· è½¯ä»¶åä½¿ç¨çææ¯ çæµ æä»¬çåå æ¶æ ç»éªæè®­ åèèµæ",content:"# Cinchcast çæ¶æ\n\nCinchcast æä¾çè§£å³æ¹æ¡åè®¸å¬å¸åå»ºãå±äº«ãè¡¡éåè´§å¸åé³é¢åå®¹ï¼ä»¥æ¥è§¦åå¸å¼å¯¹å¶ä¸å¡æéè¦çäººãæä»¬çææ¯å°ä¼è®®æ¡¥æ¥å¨ä¸å®æ¶é³é¢æµç¸ç»åï¼ä»¥ç®åå¨çº¿æ´»å¨å¹¶å¢å¼ºåä¸èçåä¸åº¦ã Cinchcast ææ¯è¿ç¨äºä¸ºå¨çæå¤§çé³é¢ç¤¾äº¤ç½ç» Blogtalkradio æä¾å¨åãä»å¤©ï¼æä»¬çå¹³å°æ¯å¤©å¶ä½åååè¶è¿ 1,500 å°æ¶çåååå®¹ãå¨æ¬æä¸­ï¼æä»¬æè¿°äºæä»¬ä¸ºæ©å±å¹³å°ä»¥æ¯æè¿ç§è§æ¨¡çæ°æ®èååºçå·¥ç¨å³ç­ã\n\n\n# ç»è®¡æ°æ®\n\n * æµè§éæ¯æè¶è¿ 5000 ä¸\n * åå»ºäº 50000 å°æ¶çé³é¢åå®¹\n * 1500 ä¸ä¸ªæµåªä½\n * 175,000,000 æ¬¡å¹¿åå±ç¤º\n * å³°å¼æ¯ç§ 40000 å¹¶åè¯·æ±\n * MSSQLãRedisãElasticSearch éç¾¤ä¸­å­å¨çæ°æ®è¾¾å°æ¯å¤©æ° TBï¼\n * 10 äººå·¥ç¨å¸å¢é\n * çäº§ç¯å¢å¤§æ¦æ 100 å·¦å³çç¡¬ä»¶èç¹\n\n\n# æ°æ®ä¸­å¿\n\nçº¿ä¸ç½ç«é¨ç½²å¨å¸é²åæçæ°æ®ä¸­å¿ãä½ QA å Staging ç¯å¢åä½¿ç¨äº Amazon EC2 äºå®ä¾ã\n\nââèèå°æ°æ®å®å¨ï¼å¤§é¨åå¬å¸ä¸æ¿ææçå®æ°æ®é¨ç½²å¨äºç«¯ã\n\n\n# ç¡¬ä»¶\n\n * å¤§æ¦æ 50 å° Web æå¡å¨\n * 15 å° MS SQL æ°æ®åºæå¡å¨\n * 2 å° Redis ç NoSQL çé®å¼æå¡å¨\n * 2 å° NodeJS æå¡å¨\n * 2 å° å¼¹æ§æç´¢éç¾¤æå¡å¨\n\n\n# å¼åå·¥å·\n\n * NET 4 C#ï¼ASP.NET å MVC3\n * IDE ç¨çæ¯ Visual Studio 2010 Team Suite\n * ç¨ StyleCopãReSharper æ¥å¼ºåä»£ç æ å\n * ä½¿ç¨ææ·ãå¶ä¸­å¤§çåè½ç¨ Scrumï¼å°ä»»å¡åéè¿çæ¿ä»»å¡å¢ç®¡ç\n * æµè¯åæç»­éæä½¿ç¨ Jenkins + Nunit\n * èªå¨åæµè¯åæ¯ Selenium å Sauce On Demand\n\n\n# è½¯ä»¶åä½¿ç¨çææ¯\n\n * Windows Server 2008 R2 ç 64 ä½æä½ç³»ç»\n * åºäºå¾®è½¯ Windows Server 2008 Web æå¡å¨ä¸è¿è¡ç SQL Server 2005\n * è´è½½åè¡¡æ¯ EQL(Equalizer load balancers)\n * Redis ä½ä¸ºåå¸å¼ç¼å­å±åæ¶æ¯ååéå\n * NodeJS ç¨æ¥è¿è¡å®æ¶åæåæ´æ°ä»ªè¡¨ç\n * æç´¢ç¨å¾æ¯ ElasticSearchï¼æ¥å¿åææ¯éè¿ Sawmill+èªå®ä¹åæå¨èæ¬\n\n\n# çæµ\n\n * NewRelicï¼æ§è½çæ§\n * æ§è½å¯¹ KPIï¼è½¬æ¢çï¼é¡µé¢æµè§éï¼çå½±åï¼Chartbeatï¼\n * Gomezï¼WhatsupGoldï¼Nagios ç­ç¨æ¥åç§é¢è­¦åæ¥è­¦\n * SQL Server monitoring ççæ§ï¼æ¥èª Red Gate ç SQL Monitor\n\n\n# æä»¬çåå\n\n * å°éä»äººçæ¶é´ãä¸è¦å¸¦çé®é¢æ¥ï¼è¦æ¿åºè§£å³åæ³ã\n * ä¸è¦å»è¿½éå½ä¸çç­ç¹ææ¯ï¼åå®ç°åºæ¬åè½ï¼ç¶åååé¦ä¸æ·»è±çãå¡å®æ¯æéè¦çã\n * æä¸ºä¸ä¸ªâå¦ä½åâçå¢éèä¸æ¯æ»æ¯è¯´âä¸âçå¢é\n * é¢åå¤çæ»æ¯äº¡ç¾è¡¥ç¢è¦å¥½ï¼æå®å¨æ¤å¥å°è½¯ä»¶å¼åçå½å¨æä¸­ï¼éè¿å¹è®­å¼åäººåå¦ä½ååºå®å¨çè½¯ä»¶å¹¶æå®ä»ä¸å¼å§å°±ä½ä¸ºä¸å¡ä¼åèèä¹å¤ã\n\n\n# æ¶æ\n\n * ææ JavascriptãCSS åå¾åé½ç¼å­å¨ CDN çº§å«ã DNS æåä¸ä¸ª CDNï¼å®å°è¯·æ±ä¼ éç»æºæå¡å¨ãæä»¬ä½¿ç¨ Cotendo æ¯å ä¸ºå®åè®¸å¨ CDN ä¸ååº L7 è·¯ç±å³ç­ã\n * åç¬ç Web æå¡å¨éç¾¤ç¨äºä¸ºæ®éç¨æ·åå¹¿åç¨æ·çè¯·æ±æä¾æå¡ï¼éè¿ cookie è¿è¡åºåã\n * æä»¬æ­£å¨è½¬åé¢åæå¡çæ¶æï¼å¶ä¸­ç³»ç»çå³é®é¨åï¼ä¾å¦æç´¢ãèº«ä»½éªè¯ãç¼å­ï¼é½æ¯ä»¥åç§è¯­è¨å®ç°ç RESTFUL æå¡ãè¿äºæå¡è¿æä¾äºä¸ä¸ªç¼å­å±ã\n * REDIS NOSQL é®å¼å­å¨ï¼redis.ioï¼ç¨ä½æ°æ®åºè°ç¨ä¹åçç¼å­å±ã\n * Scaleout ç¨äºå¨ç½ç»æå¡å¨éç¾¤ä¸­ç»´æ¤ä¼è¯ç¶æãä½æ¯ï¼æä»¬æ­£å¨èèåæ¢å° REDISã\n\n\n# ç»éªæè®­\n\n * SQL Server æ°æ®åºä¸­çææ¬æç´¢ä¸å¥½ç¨ï¼ç»å¸¸åºç° CPU é»å¡ï¼æä»¥ Cinchcast åæ¢å° ElasticSearchï¼ä¸ä¸ª Lucene çè¡çå·¥å·ã\n * å¾®è½¯åç½®çä¼è¯æ¨¡åå®¹æåºç°æ­»éï¼ä»ä»¬ç¨ AngiesList ä¼è¯æ¨¡ååä»£äºå®ï¼å¹¶ææ°æ®å­å¨å° Redisã\n * æ¥å¿æ¯åç°é®é¢çå³é®ã\n * éæ°åæè½®å­ï¼ææ¶åä¹å¯ä»¥æ¯ä¸ä»¶å¥½äºãä¾å¦ï¼å¨ä¸ä¸ªä¾åºåçæä¾ç JS / CSS çäº§åå¯¼è´æ§è½é®é¢çæ¶åï¼ä»ä»¬éè¿éåæ¾èæ¹åäºç½ç«çæ§è½ã\n * å¹¶ä¸æ¯ææçæ°æ®é½æ¯å³ç³»åçã\n * å¨å¼åä¸­ä¸ä½¿ç¨ææ æ£æµå°±åå¨é£æ´ä¸­ä¸åèé«åº¦è¡¨æ¥éè½é£æºï¼å æ­¤æ´ä¸ªå¼åè¿ç¨ä¸­ï¼ä¸å®è¦éè¿ç½ç«ååéï¼è§£å³éè¯¯çæ¶é´ãä»£ç è¦ççï¼ç­ææ æ¥è¡¡éä½ çæçã æ»çæ¥è¯´ï¼å¯¹äºæ¥ PV ç¾ä¸çº§çç½ç«æ¥è¯´ï¼Cinchcast çæ¶æãç åãè¿ç»´ç­å±é¢çææ¯éååç»éªå¼å¾å­¦ä¹ ååèã\n\n\n# åèèµæ\n\n * æ¯å¤©äº§ç 1500 å°æ¶çé³é¢",normalizedContent:"# cinchcast çæ¶æ\n\ncinchcast æä¾çè§£å³æ¹æ¡åè®¸å¬å¸åå»ºãå±äº«ãè¡¡éåè´§å¸åé³é¢åå®¹ï¼ä»¥æ¥è§¦åå¸å¼å¯¹å¶ä¸å¡æéè¦çäººãæä»¬çææ¯å°ä¼è®®æ¡¥æ¥å¨ä¸å®æ¶é³é¢æµç¸ç»åï¼ä»¥ç®åå¨çº¿æ´»å¨å¹¶å¢å¼ºåä¸èçåä¸åº¦ã cinchcast ææ¯è¿ç¨äºä¸ºå¨çæå¤§çé³é¢ç¤¾äº¤ç½ç» blogtalkradio æä¾å¨åãä»å¤©ï¼æä»¬çå¹³å°æ¯å¤©å¶ä½åååè¶è¿ 1,500 å°æ¶çåååå®¹ãå¨æ¬æä¸­ï¼æä»¬æè¿°äºæä»¬ä¸ºæ©å±å¹³å°ä»¥æ¯æè¿ç§è§æ¨¡çæ°æ®èååºçå·¥ç¨å³ç­ã\n\n\n# ç»è®¡æ°æ®\n\n * æµè§éæ¯æè¶è¿ 5000 ä¸\n * åå»ºäº 50000 å°æ¶çé³é¢åå®¹\n * 1500 ä¸ä¸ªæµåªä½\n * 175,000,000 æ¬¡å¹¿åå±ç¤º\n * å³°å¼æ¯ç§ 40000 å¹¶åè¯·æ±\n * mssqlãredisãelasticsearch éç¾¤ä¸­å­å¨çæ°æ®è¾¾å°æ¯å¤©æ° tbï¼\n * 10 äººå·¥ç¨å¸å¢é\n * çäº§ç¯å¢å¤§æ¦æ 100 å·¦å³çç¡¬ä»¶èç¹\n\n\n# æ°æ®ä¸­å¿\n\nçº¿ä¸ç½ç«é¨ç½²å¨å¸é²åæçæ°æ®ä¸­å¿ãä½ qa å staging ç¯å¢åä½¿ç¨äº amazon ec2 äºå®ä¾ã\n\nââèèå°æ°æ®å®å¨ï¼å¤§é¨åå¬å¸ä¸æ¿ææçå®æ°æ®é¨ç½²å¨äºç«¯ã\n\n\n# ç¡¬ä»¶\n\n * å¤§æ¦æ 50 å° web æå¡å¨\n * 15 å° ms sql æ°æ®åºæå¡å¨\n * 2 å° redis ç nosql çé®å¼æå¡å¨\n * 2 å° nodejs æå¡å¨\n * 2 å° å¼¹æ§æç´¢éç¾¤æå¡å¨\n\n\n# å¼åå·¥å·\n\n * net 4 c#ï¼asp.net å mvc3\n * ide ç¨çæ¯ visual studio 2010 team suite\n * ç¨ stylecopãresharper æ¥å¼ºåä»£ç æ å\n * ä½¿ç¨ææ·ãå¶ä¸­å¤§çåè½ç¨ scrumï¼å°ä»»å¡åéè¿çæ¿ä»»å¡å¢ç®¡ç\n * æµè¯åæç»­éæä½¿ç¨ jenkins + nunit\n * èªå¨åæµè¯åæ¯ selenium å sauce on demand\n\n\n# è½¯ä»¶åä½¿ç¨çææ¯\n\n * windows server 2008 r2 ç 64 ä½æä½ç³»ç»\n * åºäºå¾®è½¯ windows server 2008 web æå¡å¨ä¸è¿è¡ç sql server 2005\n * è´è½½åè¡¡æ¯ eql(equalizer load balancers)\n * redis ä½ä¸ºåå¸å¼ç¼å­å±åæ¶æ¯ååéå\n * nodejs ç¨æ¥è¿è¡å®æ¶åæåæ´æ°ä»ªè¡¨ç\n * æç´¢ç¨å¾æ¯ elasticsearchï¼æ¥å¿åææ¯éè¿ sawmill+èªå®ä¹åæå¨èæ¬\n\n\n# çæµ\n\n * newrelicï¼æ§è½çæ§\n * æ§è½å¯¹ kpiï¼è½¬æ¢çï¼é¡µé¢æµè§éï¼çå½±åï¼chartbeatï¼\n * gomezï¼whatsupgoldï¼nagios ç­ç¨æ¥åç§é¢è­¦åæ¥è­¦\n * sql server monitoring ççæ§ï¼æ¥èª red gate ç sql monitor\n\n\n# æä»¬çåå\n\n * å°éä»äººçæ¶é´ãä¸è¦å¸¦çé®é¢æ¥ï¼è¦æ¿åºè§£å³åæ³ã\n * ä¸è¦å»è¿½éå½ä¸çç­ç¹ææ¯ï¼åå®ç°åºæ¬åè½ï¼ç¶åååé¦ä¸æ·»è±çãå¡å®æ¯æéè¦çã\n * æä¸ºä¸ä¸ªâå¦ä½åâçå¢éèä¸æ¯æ»æ¯è¯´âä¸âçå¢é\n * é¢åå¤çæ»æ¯äº¡ç¾è¡¥ç¢è¦å¥½ï¼æå®å¨æ¤å¥å°è½¯ä»¶å¼åçå½å¨æä¸­ï¼éè¿å¹è®­å¼åäººåå¦ä½ååºå®å¨çè½¯ä»¶å¹¶æå®ä»ä¸å¼å§å°±ä½ä¸ºä¸å¡ä¼åèèä¹å¤ã\n\n\n# æ¶æ\n\n * ææ javascriptãcss åå¾åé½ç¼å­å¨ cdn çº§å«ã dns æåä¸ä¸ª cdnï¼å®å°è¯·æ±ä¼ éç»æºæå¡å¨ãæä»¬ä½¿ç¨ cotendo æ¯å ä¸ºå®åè®¸å¨ cdn ä¸ååº l7 è·¯ç±å³ç­ã\n * åç¬ç web æå¡å¨éç¾¤ç¨äºä¸ºæ®éç¨æ·åå¹¿åç¨æ·çè¯·æ±æä¾æå¡ï¼éè¿ cookie è¿è¡åºåã\n * æä»¬æ­£å¨è½¬åé¢åæå¡çæ¶æï¼å¶ä¸­ç³»ç»çå³é®é¨åï¼ä¾å¦æç´¢ãèº«ä»½éªè¯ãç¼å­ï¼é½æ¯ä»¥åç§è¯­è¨å®ç°ç restful æå¡ãè¿äºæå¡è¿æä¾äºä¸ä¸ªç¼å­å±ã\n * redis nosql é®å¼å­å¨ï¼redis.ioï¼ç¨ä½æ°æ®åºè°ç¨ä¹åçç¼å­å±ã\n * scaleout ç¨äºå¨ç½ç»æå¡å¨éç¾¤ä¸­ç»´æ¤ä¼è¯ç¶æãä½æ¯ï¼æä»¬æ­£å¨èèåæ¢å° redisã\n\n\n# ç»éªæè®­\n\n * sql server æ°æ®åºä¸­çææ¬æç´¢ä¸å¥½ç¨ï¼ç»å¸¸åºç° cpu é»å¡ï¼æä»¥ cinchcast åæ¢å° elasticsearchï¼ä¸ä¸ª lucene çè¡çå·¥å·ã\n * å¾®è½¯åç½®çä¼è¯æ¨¡åå®¹æåºç°æ­»éï¼ä»ä»¬ç¨ angieslist ä¼è¯æ¨¡ååä»£äºå®ï¼å¹¶ææ°æ®å­å¨å° redisã\n * æ¥å¿æ¯åç°é®é¢çå³é®ã\n * éæ°åæè½®å­ï¼ææ¶åä¹å¯ä»¥æ¯ä¸ä»¶å¥½äºãä¾å¦ï¼å¨ä¸ä¸ªä¾åºåçæä¾ç js / css çäº§åå¯¼è´æ§è½é®é¢çæ¶åï¼ä»ä»¬éè¿éåæ¾èæ¹åäºç½ç«çæ§è½ã\n * å¹¶ä¸æ¯ææçæ°æ®é½æ¯å³ç³»åçã\n * å¨å¼åä¸­ä¸ä½¿ç¨ææ æ£æµå°±åå¨é£æ´ä¸­ä¸åèé«åº¦è¡¨æ¥éè½é£æºï¼å æ­¤æ´ä¸ªå¼åè¿ç¨ä¸­ï¼ä¸å®è¦éè¿ç½ç«ååéï¼è§£å³éè¯¯çæ¶é´ãä»£ç è¦ççï¼ç­ææ æ¥è¡¡éä½ çæçã æ»çæ¥è¯´ï¼å¯¹äºæ¥ pv ç¾ä¸çº§çç½ç«æ¥è¯´ï¼cinchcast çæ¶æãç åãè¿ç»´ç­å±é¢çææ¯éååç»éªå¼å¾å­¦ä¹ ååèã\n\n\n# åèèµæ\n\n * æ¯å¤©äº§ç 1500 å°æ¶çé³é¢",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"README",frontmatter:{title:"README",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/f54c7b/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/README.md",key:"v-7f4fa8ff",path:"/pages/f54c7b/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:11},{level:3,title:"ç¥åç³»ç»æ¶æ",slug:"ç¥åç³»ç»æ¶æ",normalizedTitle:"ç¥åç³»ç»æ¶æ",charIndex:21},{level:3,title:"æä¸æä¹è¡ç³»å",slug:"æä¸æä¹è¡ç³»å",normalizedTitle:"æä¸æä¹è¡ç³»å",charIndex:1665},{level:4,title:"è®¾è®¡ä¸ä¸ªç­å°åæå¡",slug:"è®¾è®¡ä¸ä¸ªç­å°åæå¡",normalizedTitle:"è®¾è®¡ä¸ä¸ªç­å°åæå¡",charIndex:1676},{level:4,title:"è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°",slug:"è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°",normalizedTitle:"è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°",charIndex:1689},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:1703},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:1713}],headersStr:"ð åå®¹ ç¥åç³»ç»æ¶æ æä¸æä¹è¡ç³»å è®¾è®¡ä¸ä¸ªç­å°åæå¡ è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å° ð èµæ ðª ä¼ é",content:"# è§£å³æ¹æ¡\n\n\n# ð åå®¹\n\n\n# ç¥åç³»ç»æ¶æ\n\nç±»å                ç»åç±»å    ç³»ç»                                      èµæ\nData processing           MapReduce - Google çåå¸å¼æ°æ®å¤ç             research.google.com\nData processing           Spark - Databricks çåå¸å¼æ°æ®å¤ç             slideshare.net\nData processing           Storm - Twitter çåå¸å¼æ°æ®å¤ç                slideshare.net\n                                                                  \nåå¸å¼å­å¨             Nosql   Bigtable - Google çåå¼æ°æ®åº                harvard.edu\nåå¸å¼å­å¨             Nosql   HBase - Bigtable çå¼æºå®ç°                  slideshare.net\nåå¸å¼å­å¨             Nosql   Cassandra - Facebook çåå¼æ°æ®åº             slideshare.net\nåå¸å¼å­å¨             Nosql   DynamoDB - Amazon çææ¡£æ°æ®åº                harvard.edu\nåå¸å¼å­å¨             Nosql   MongoDB - ææ¡£æ°æ®åº                         MongoDB\nåå¸å¼å­å¨             Nosql   Spanner - Google çå¨çåå¸æ°æ®åº               research.google.com\nåå¸å¼å­å¨             Nosql   Memcached - åå¸å¼åå­ç¼å­ç³»ç»                   slideshare.net\nåå¸å¼å­å¨             Nosql   Redis - è½å¤æä¹ååå·æå¼ç±»åçåå¸å¼åå­ç¼å­ç³»ç»           Redis\nåå¸å¼å­å¨             æä»¶ç³»ç»    Google File System (GFS) - åå¸å¼æä»¶ç³»ç»      research.google.com\nåå¸å¼å­å¨             æä»¶ç³»ç»    Hadoop File System (HDFS) - GFS çå¼æºå®ç°   apache.org\n                                                                  \nåå¸å¼ä¸­é´ä»¶                    Chubby - Google çåå¸å¼ç³»ç»çä½è¦åéæå¡           research.google.com\nåå¸å¼ä¸­é´ä»¶                    Dapper - åå¸å¼ç³»ç»è·è¸ªåºç¡è®¾æ½                    research.google.com\nåå¸å¼ä¸­é´ä»¶            MQ      Kafka - LinkedIn çåå¸è®¢éæ¶æ¯ç³»ç»              Kafka\nåå¸å¼ä¸­é´ä»¶            åå¸å¼åè°   Zookeeper - éä¸­çåºç¡æ¶æååè°æå¡                ZooKeeper\n                                                                  \n\n\n# æä¸æä¹è¡ç³»å\n\n# è®¾è®¡ä¸ä¸ªç­å°åæå¡\n\n# è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°\n\n\n# ð èµæ\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# è§£å³æ¹æ¡\n\n\n# ð åå®¹\n\n\n# ç¥åç³»ç»æ¶æ\n\nç±»å                ç»åç±»å    ç³»ç»                                      èµæ\ndata processing           mapreduce - google çåå¸å¼æ°æ®å¤ç             research.google.com\ndata processing           spark - databricks çåå¸å¼æ°æ®å¤ç             slideshare.net\ndata processing           storm - twitter çåå¸å¼æ°æ®å¤ç                slideshare.net\n                                                                  \nåå¸å¼å­å¨             nosql   bigtable - google çåå¼æ°æ®åº                harvard.edu\nåå¸å¼å­å¨             nosql   hbase - bigtable çå¼æºå®ç°                  slideshare.net\nåå¸å¼å­å¨             nosql   cassandra - facebook çåå¼æ°æ®åº             slideshare.net\nåå¸å¼å­å¨             nosql   dynamodb - amazon çææ¡£æ°æ®åº                harvard.edu\nåå¸å¼å­å¨             nosql   mongodb - ææ¡£æ°æ®åº                         mongodb\nåå¸å¼å­å¨             nosql   spanner - google çå¨çåå¸æ°æ®åº               research.google.com\nåå¸å¼å­å¨             nosql   memcached - åå¸å¼åå­ç¼å­ç³»ç»                   slideshare.net\nåå¸å¼å­å¨             nosql   redis - è½å¤æä¹ååå·æå¼ç±»åçåå¸å¼åå­ç¼å­ç³»ç»           redis\nåå¸å¼å­å¨             æä»¶ç³»ç»    google file system (gfs) - åå¸å¼æä»¶ç³»ç»      research.google.com\nåå¸å¼å­å¨             æä»¶ç³»ç»    hadoop file system (hdfs) - gfs çå¼æºå®ç°   apache.org\n                                                                  \nåå¸å¼ä¸­é´ä»¶                    chubby - google çåå¸å¼ç³»ç»çä½è¦åéæå¡           research.google.com\nåå¸å¼ä¸­é´ä»¶                    dapper - åå¸å¼ç³»ç»è·è¸ªåºç¡è®¾æ½                    research.google.com\nåå¸å¼ä¸­é´ä»¶            mq      kafka - linkedin çåå¸è®¢éæ¶æ¯ç³»ç»              kafka\nåå¸å¼ä¸­é´ä»¶            åå¸å¼åè°   zookeeper - éä¸­çåºç¡æ¶æååè°æå¡                zookeeper\n                                                                  \n\n\n# æä¸æä¹è¡ç³»å\n\n# è®¾è®¡ä¸ä¸ªç­å°åæå¡\n\n# è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°\n\n\n# ð èµæ\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"äºé©¬éçæ¶æ",frontmatter:{title:"äºé©¬éçæ¶æ",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/008eff/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E4%BA%9A%E9%A9%AC%E9%80%8A%E7%9A%84%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/äºé©¬éçæ¶æ.md",key:"v-26f88fff",path:"/pages/008eff/",headers:[{level:2,title:"æå½çè¦ç¹",slug:"æå½çè¦ç¹",normalizedTitle:"æå½çè¦ç¹",charIndex:13},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:178}],headersStr:"æå½çè¦ç¹ åèèµæ",content:"# äºé©¬éçæ¶æ\n\n\n# æå½çè¦ç¹\n\nå¯æ©å±ï¼æ·»å èµæºï¼æ§è½ææ­£æ¯æå\n\nåå¸å¼ãå»ä¸­å¿å\n\néç¦»æ§ï¼é¢åæå¡ï¼èåæ°ä»¥ç¾è®¡çæå¡ï¼å¯¹å¤ç»ä¸æä¾æå¡\n\nåæ¶æ¯æ REST å SOAP\n\nå¢éå¨ç²¾ä¸å¨å¤ï¼èçæ²éææ¬\n\nç¶æç®¡çæ¯å¤§è§æ¨¡ç³»ç»çæ ¸å¿é®é¢ï¼å¦åå¸å¼ Session ç­\n\nè®¾è®¡åºå°½éç®åï¼å¾å¤é®é¢å¯ä»¥ç¨ä¸å¡é»è¾å»è§£å³ï¼èä¸æ¯éè¿ææ¯\n\n\n# åèèµæ\n\n * Amazon çæ¶æ",normalizedContent:"# äºé©¬éçæ¶æ\n\n\n# æå½çè¦ç¹\n\nå¯æ©å±ï¼æ·»å èµæºï¼æ§è½ææ­£æ¯æå\n\nåå¸å¼ãå»ä¸­å¿å\n\néç¦»æ§ï¼é¢åæå¡ï¼èåæ°ä»¥ç¾è®¡çæå¡ï¼å¯¹å¤ç»ä¸æä¾æå¡\n\nåæ¶æ¯æ rest å soap\n\nå¢éå¨ç²¾ä¸å¨å¤ï¼èçæ²éææ¬\n\nç¶æç®¡çæ¯å¤§è§æ¨¡ç³»ç»çæ ¸å¿é®é¢ï¼å¦åå¸å¼ session ç­\n\nè®¾è®¡åºå°½éç®åï¼å¾å¤é®é¢å¯ä»¥ç¨ä¸å¡é»è¾å»è§£å³ï¼èä¸æ¯éè¿ææ¯\n\n\n# åèèµæ\n\n * amazon çæ¶æ",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä½ä»£ç å¹³å°",frontmatter:{title:"ä½ä»£ç å¹³å°",date:"2021-05-06T16:57:48.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/b8e814/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/ä½ä»£ç å¹³å°.md",key:"v-1e2a0709",path:"/pages/b8e814/",headers:[{level:2,title:"ä¸å¡åæ",slug:"ä¸å¡åæ",normalizedTitle:"ä¸å¡åæ",charIndex:76},{level:3,title:"ä½ä»£ç å¹³å°æ¯ä»ä¹",slug:"ä½ä»£ç å¹³å°æ¯ä»ä¹",normalizedTitle:"ä½ä»£ç å¹³å°æ¯ä»ä¹",charIndex:85},{level:3,title:"ææ¯è·¯çº¿",slug:"ææ¯è·¯çº¿",normalizedTitle:"ææ¯è·¯çº¿",charIndex:287},{level:4,title:"åºäº IDE æ¡æ¶çå¿«éå¼åå¹³å°",slug:"åºäº-ide-æ¡æ¶çå¿«éå¼åå¹³å°",normalizedTitle:"åºäº ide æ¡æ¶çå¿«éå¼åå¹³å°",charIndex:295},{level:4,title:"åºäºæ¨¡åé©±å¨çåºç¨å¹³å°",slug:"åºäºæ¨¡åé©±å¨çåºç¨å¹³å°",normalizedTitle:"åºäºæ¨¡åé©±å¨çåºç¨å¹³å°",charIndex:556},{level:3,title:"æ ¸å¿è¦ç´ ",slug:"æ ¸å¿è¦ç´ ",normalizedTitle:"æ ¸å¿è¦ç´ ",charIndex:783},{level:4,title:"æ°æ®æ¨¡å",slug:"æ°æ®æ¨¡å",normalizedTitle:"æ°æ®æ¨¡å",charIndex:356},{level:4,title:"ä¸å¡æµç¨",slug:"ä¸å¡æµç¨",normalizedTitle:"ä¸å¡æµç¨",charIndex:986},{level:4,title:"ç¨æ·æé",slug:"ç¨æ·æé",normalizedTitle:"ç¨æ·æé",charIndex:991},{level:4,title:"ç»è®¡å¾è¡¨",slug:"ç»è®¡å¾è¡¨",normalizedTitle:"ç»è®¡å¾è¡¨",charIndex:996},{level:3,title:"æµè¡äº§å",slug:"æµè¡äº§å",normalizedTitle:"æµè¡äº§å",charIndex:1776},{level:4,title:"OutSystems",slug:"outsystems",normalizedTitle:"outsystems",charIndex:1784},{level:4,title:"Mendix",slug:"mendix",normalizedTitle:"mendix",charIndex:1923},{level:2,title:"é¡¶å±è®¾è®¡",slug:"é¡¶å±è®¾è®¡",normalizedTitle:"é¡¶å±è®¾è®¡",charIndex:2064},{level:2,title:"ç»ä»¶è®¾è®¡",slug:"ç»ä»¶è®¾è®¡",normalizedTitle:"ç»ä»¶è®¾è®¡",charIndex:2452},{level:3,title:"åè¡¨é¡µ",slug:"åè¡¨é¡µ",normalizedTitle:"åè¡¨é¡µ",charIndex:2461},{level:4,title:"æç´¢æ ",slug:"æç´¢æ ",normalizedTitle:"æç´¢æ ",charIndex:2468},{level:4,title:"æä½æ ",slug:"æä½æ ",normalizedTitle:"æä½æ ",charIndex:2475},{level:4,title:"è¡¨æ ¼",slug:"è¡¨æ ¼",normalizedTitle:"è¡¨æ ¼",charIndex:2482},{level:4,title:"åé¡µ",slug:"åé¡µ",normalizedTitle:"åé¡µ",charIndex:2488},{level:3,title:"è¡¨åé¡µ",slug:"è¡¨åé¡µ",normalizedTitle:"è¡¨åé¡µ",charIndex:2495},{level:4,title:"è¡¨åç»ä»¶",slug:"è¡¨åç»ä»¶",normalizedTitle:"è¡¨åç»ä»¶",charIndex:2502},{level:4,title:"æ ¡éªå¨",slug:"æ ¡éªå¨",normalizedTitle:"æ ¡éªå¨",charIndex:2510},{level:2,title:"æ©å±è®¾è®¡",slug:"æ©å±è®¾è®¡",normalizedTitle:"æ©å±è®¾è®¡",charIndex:2518},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2527}],headersStr:"ä¸å¡åæ ä½ä»£ç å¹³å°æ¯ä»ä¹ ææ¯è·¯çº¿ åºäº IDE æ¡æ¶çå¿«éå¼åå¹³å° åºäºæ¨¡åé©±å¨çåºç¨å¹³å° æ ¸å¿è¦ç´  æ°æ®æ¨¡å ä¸å¡æµç¨ ç¨æ·æé ç»è®¡å¾è¡¨ æµè¡äº§å OutSystems Mendix é¡¶å±è®¾è®¡ ç»ä»¶è®¾è®¡ åè¡¨é¡µ æç´¢æ  æä½æ  è¡¨æ ¼ åé¡µ è¡¨åé¡µ è¡¨åç»ä»¶ æ ¡éªå¨ æ©å±è®¾è®¡ åèèµæ",content:"# è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°\n\n> æ¬æç®æ æ¯è®¾è®¡ä¸ä¸ªç¨äºæé«å¼åäººåå¼åæççä½ä»£ç å¹³å°ï¼è¿éä¼éç¨ç³»ç»è§£å³æ¹æ¡è®¾è®¡çä¸è¬æè·¯æ¥éæ­¥æ¢å¯»è®¾è®¡æ¹æ¡ã\n\n\n# ä¸å¡åæ\n\n\n# ä½ä»£ç å¹³å°æ¯ä»ä¹\n\nå¹¿ä¹ä¸çä½ä»£ç å¹³å°åæ¬ä½ä»£ç å¹³å°åé¶ä»£ç å¹³å°ï¼å®ä»¬é½å±äº APaaSï¼Application Platform as a Service åºç¨å¹³å°å³æå¡ï¼ï¼ä¸¤èçä¸»è¦åºå«å¨äºå¯¹ä»£ç çä¾èµç¨åº¦ï¼\n\n * ä½ä»£ç å¹³å°ï¼éè¿èªå¨ä»£ç çæåå¯è§åç¼ç¨ï¼åªéè¦å°éä»£ç ï¼å³å¯å¿«éæ­å»ºåç§åºç¨ã\n * é¶ä»£ç å¹³å°ï¼é¶å¼åç»éªçä¸å¡äººåéè¿ææ½ç­æ¹å¼ï¼æ éç¼åä»£ç ï¼å³å¯å¿«éæ­å»ºåç§åºç¨ã\n\n\n# ææ¯è·¯çº¿\n\n# åºäº IDE æ¡æ¶çå¿«éå¼åå¹³å°\n\nè¯¥æ¹æ¡å°ä¼ ç»çéæå¼åç¯å¢ï¼IDEï¼ååå¯è§åï¼å¼åèå¯¹åç«¯çé¢ç»ä»¶ãæ°æ®æºç»å®æ¹å¼ãæ°æ®æ¨¡åãä¸å¡é»è¾åå·¥ä½æµç­é½å¯ä»¥èªç±å®ä¹ï¼å¹³å°å°èªå¨çæä»£ç ï¼å¼åèä¹å¯ä»¥æ·»å èªå·±çä»£ç ï¼å¯¹ç¨åºå·æè¾å¼ºçæ§å¶è½åï¼å æ­¤è¯¥æ¹æ¡å·å¤æ´é«ççµæ´»æ§ï¼å¯ä»¥è®¾è®¡åºå®å¶åç¨åº¦é«ãé»è¾å¤æçè½¯ä»¶ã\n\nç±äºè¯¥æ¹æ¡ä»æ¶åä»£ç å¼åãé¨ç½²ç­ææ¯å·¥ä½ï¼æä»¥å®ä»ç¶æ¯ä¸ä¸ªææ¯å¼åå¹³å°ï¼éè¦è¾é«çå­¦ä¹ ææ¬ï¼ä¸»è¦ä»·å¼æ¯æé«å¼åæçï¼åå°éå¤å³å¨ã\n\nOutsystems å°±æ¯éç¨è¯¥æ¹æ¡çå¸åäº§åï¼å¦ä¸ä¸ºäº§åæªå¾ï¼\n\n\n\n# åºäºæ¨¡åé©±å¨çåºç¨å¹³å°\n\nç¨æ·éè¿å¯è§åæ¹å¼æå»ºæ°æ®æ¨¡åãè§å¾ãæéãå·¥ä½æµç­ï¼å³å¯å¨å¹³å°æä¾çç¯å¢ä¸­è¿è¡ï¼æ éç¼è¯é¨ç½²ï¼æ´åä¸ç§å»çå¼çåºç¨æ­å»ºå¹³å°ãå¹³å°å¯¹åç±»ç»ä»¶ãä¸å¡é»è¾åäºè¾é«å±çº§çå°è£ï¼å æ­¤ç¨æ·æ æ³éå¿ææ¬²ä¿®æ¹çé¢é£æ ¼ãäº¤äºæ¹å¼ãå¤çé»è¾ç­ã\n\nè¯¥æ¹æ¡å¯ä»¥å®ç°å®å¨é¶ä»£ç ï¼å¯¹ä½¿ç¨èææ¯è¦æ±ä¸é«ï¼ä½éè¦å·å¤ä¸å¡æ½è±¡ãå»ºæ¨¡è½åãä¸»è¦ä»·å¼æ¯éä½å¼åé¨æ§ãå¿«ééåºååã\n\næéäºãä¼ä¼´äºç­é½æ¯æ­¤ç±»æ¹æ¡çå¸åäº§åï¼å¦ä¸ä¸ºæéäºçäº§åæªå¾ï¼\n\n\n\n\n# æ ¸å¿è¦ç´ \n\nç»å¤§é¨åçä¼ä¸è½¯ä»¶ç±ä»¥ä¸åä¸ªé¨åç»æï¼\n\n * ä¸å¡å®ä½ï¼å³æä½å¯¹è±¡ï¼å¦å®¢æ·ãè®¢å\n * ä¸å¡æ´»å¨ï¼å³è¿è¡ä½ç§æä½ï¼å¦éè´­ç³è¯·ãååå®¡æ¹\n * ä¸å¡æéï¼å³ä½ç§äººæ¥æä½ç§æéï¼åæ¬æ°æ®æ¥çæéåæ°æ®æä½æéï¼å¦é¨é¨ç»çå¯ä»¥ç®¡çææä¸å±çå®¢æ·ä¿¡æ¯ï¼èåå·¥åªè½ç®¡çèªå·±çå®¢æ·ä¿¡æ¯\n * ç»è®¡æ¥è¡¨ï¼å³ä»åªäºæ¹é¢éåä¼ä¸æ´»å¨æåµï¼å¦å®¢æ·å¢é¿çãåæéå®é¢è¶å¿\n\nä½ä»£ç å¹³å°å°ä»¥ä¸è¿è¡æ½è±¡ï¼æ¯ææ°æ®æ¨¡åãä¸å¡æµç¨ãç¨æ·æéãç»è®¡å¾è¡¨ï¼å æ­¤å¯ä»¥ä½ä¸ºæ´éç¨çä¼ä¸è½¯ä»¶è§£å³æ¹æ¡ï¼è¿åç±»è½åä¹æ¯ä»»ä½ä¸ä¸ªä½ä»£ç å¹³å°é½å¿é¡»å·å¤çæ ¸å¿è¦ç´ ã\n\n# æ°æ®æ¨¡å\n\nå»ºç«æ°æ®æ¨¡åå°±æ¯æåä¸å¡å®ä½çæ°æ®ç¹å¾ï¼æ½è±¡ä¸ºæ°æ®è¡¨ï¼å»ºç«è¡¨é´å³ç³»ãå¶ä½ ER å¾çè¿ç¨å°±æ¯æ°æ®å»ºæ¨¡ãå¸é¢ä¸å¸¸è§çä½ä»£ç å¹³å°åæä¾äºä¸°å¯çæ§ä»¶ï¼å¯ä»¥ææ½å®ææ°æ®æ¨¡åæ­å»ºãæ­¤å¤ï¼æ°æ®æ¨¡åæ­å»ºä¸è¡¨åå±ç¤ºåäºä¸ºä¸ï¼æ¯å®æä¸ä¸ªæ°æ®è¡¨çåå»ºï¼å°±èªå¨çæäºè¯¥è¡¨çå¢å æ¹æ¥åè½åç¸å³é¡µé¢ï¼è¿èéèäºæ°æ®åºè®¾è®¡ãåç«¯å¼åè¿äºä¸ä¸ææ¯ãå¶å®ï¼è¿ä¹å°±æ¯æä»¬å¸¸è¯´çè¡¨åå¼æã\n\nè¿éé¡ºä¾¿æä¸ä¸ï¼è½ç¶å¾å¤ä½ä»£ç å¹³å°å°æ°æ®å»ºæ¨¡ä¸è¡¨åå±ç¤ºåäºä¸ºä¸ï¼ä½éè¿è¿ç§æ¹å¼èªå¨çæçè¡¨ååªè½å®ç°æåºç¡çå¢å æ¹æ¥é¡µé¢ï¼ç¨æ·å¯¹çé¢å±ç¤ºåå®¹åå½¢å¼çæ§å¶ç¨åº¦å¾ä½ï¼æ æ³æ»¡è¶³å¤§é¨åä¼ä¸è½¯ä»¶çéæ±ï¼æä»¥ä½ä»£ç å¹³å°ä¸è¬è¿ä¼æä¾èªå®ä¹é¡µé¢åè½ï¼ç¨æ·å¯æ ¹æ®éè¦å¨é¡µé¢ä¸éç½®æé®ãå¾è¡¨ç­åç´ ï¼æ»¡è¶³ä¸ªæ§åéæ±ã\n\n# ä¸å¡æµç¨\n\nä¸å¡æµç¨æä¸ºäºå®ç°æé¡¹ç®æ ï¼ç±å¤äººåä½ï¼æç§ä¸å®çè§åãé¡ºåºè¿è¡çä¸ç³»åæ´»å¨ï¼å¨è½¯ä»¶ä¸­ï¼ä¸å¡æµç¨çåä¸èå¯ä»¥æ¯äººï¼ä¹å¯ä»¥æ¯ç¨åºãä½ä»£ç å¹³å°å®ç°äºå¯è§åæµç¨éç½®ï¼ç¨æ·å¯¹è§¦åæ¡ä»¶ãå¤çèç¹ãèç¹åä¸èè¿è¡éç½®ï¼å®ç°èªå®ä¹ä¸å¡æµç¨ã\n\n# ç¨æ·æé\n\nå¤§é¨åçä½ä»£ç å¹³å°é½éç¨äºéå¸¸ç»å¸ç RBACï¼Role-Based Access Control ï¼æ¨¡åç®¡çç¨æ·æéï¼ç®åæ¥è¯´å°±æ¯å°æ¥æç¸åæéçç¨æ·æ·»å ä¸ºç¸åè§è²ï¼éè¿ä¸ºè§è²åéæéï¼å®ç°äºâç¨æ·ââè§è²ââæéâçæææ¨¡å¼ãç±äºä¼ä¸æ¯ä¸ä¸ªç»ç»ï¼ä¸è¬é½ä¼æé¨é¨çæ¦å¿µï¼æä»¥ä¹å¯ä»¥å°é¨é¨æ·»å å°æä¸ªè§è²ï¼å®ç°âç¨æ·ââé¨é¨ââè§è²ââæéâçæææ¨¡å¼ã\n\n# ç»è®¡å¾è¡¨\n\nç»è®¡å¾è¡¨å¯ä»¥ç±»æ¯ Excel ä¸­çéè§å¾ï¼ç»è®¡å¾è¡¨ç±æ°æ®æºãç»è®¡è§åãå±ç¤ºå½¢å¼å®ä¹ï¼ä½ä»£ç å¹³å°ä¹æ­£æ¯éµå¾ªè¿ç§æ¹å¼ï¼å®ç°ç»è®¡å¾è¡¨çå¯è§åéç½®ã\n\n\n# æµè¡äº§å\n\n# OutSystems\n\nOutSystems æ¯å¿«éåºç¨å¼åçå¤´å·ä½ä»£ç å¹³å°ï¼å¹¶ä¸æ¯ 2018 å¹´ Gartner é«çäº§åå¹³å°çé¢å¯¼èãOutSystems å·ç§°å°ä½ä»£ç åè½ä¸é«çº§ç§»å¨åè½ç¸ç»åçå¯ä¸è§£å³æ¹æ¡ï¼å®æ¯ææ´ä¸ªåºç¨ç¨åºç»åçå¯è§åå¼åï¼å¯è½»æ¾ä¸ç°æç³»ç»éæã\n\n# Mendix\n\nMendix å¸®å©ä¼ä¸æ¹ååæ°æ¹å¼ãéè¿ä½¿ç¨å¯è§åæ¨¡åï¼å¨ Mendix ä¸æå»ºåºç¨ç¨åºéå¸¸ç®åï¼å¿«éä¸ç´è§ï¼å¯ä½¿å¼åäººååä¸å¡åæäººåç­ä¼å¤äººåæå»ºå¼ºå¤§çåºç¨ç¨åºï¼èæ éç¼åä»£ç ãåå©æ¨¡åé©±å¨å¼åï¼ä¸å¡é¢å¯¼èå IT é¨é¨å¯ä»¥å±äº«è¯­è¨æ¥å¿«éæå»ºåºç¨ç¨åºã\n\n\n# é¡¶å±è®¾è®¡\n\nç±äºç³»ç»çç¨æ·ç¾¤ä½æ¯æä¸å®ææ¯åºç¡çå¼åäººåãæä»¥ï¼ç³»ç»å®ä½æ¯ä½ä»£ç å¹³å°ï¼èéé¶ä»£ç å¹³å°ã\n\nå¶æ¬¡ï¼ç±äºç³»ç»ä¸»è¦æ¯ç¨äºç®ååºæ¬çé¡µé¢å¼åï¼æä»¥ææ¯è·¯çº¿åºè¯¥éæ©ï¼åºäºæ¨¡åé©±å¨çåºç¨å¹³å°ã\n\næåï¼ç±äºçæçä»£ç æ¯åºç¨äº Java Web æ¡æ¶ãçæçåç«¯ä»£ç æ¯ java ä»£ç ï¼åç«¯ä»£ç æ¯åºäº vue + element-ui çæçåç«¯ä»£ç ã\n\n\n\nä»£ç çæè§åå¯¹åºçæ°æ®å»ºæ¨¡ï¼\n\n\n\nèªå¨çæååç«¯ä»£ç ã\n\n * åç«¯ä»£ç \n   * Controller\n   * Service\n   * ServiceImpl\n   * Daomybatis\n   * DaoImpl\n   * Mapper\n   * Query\n   * Dto\n   * Entity\n   * xml\n * åç«¯ä»£ç \n   * List\n   * Form\n   * Api\n\n\n# ç»ä»¶è®¾è®¡\n\n\n# åè¡¨é¡µ\n\n# æç´¢æ \n\n# æä½æ \n\n# è¡¨æ ¼\n\n# åé¡µ\n\n\n# è¡¨åé¡µ\n\n# è¡¨åç»ä»¶\n\n# æ ¡éªå¨\n\n\n# æ©å±è®¾è®¡\n\n\n# åèèµæ\n\n * ä½ä»£ç å¹³å°ï¼10 åéä»å¥é¨å°åç\n * æµè°ä½ä»£ç å¹³å°æ¶åçä¸äºææ¯éå",normalizedContent:"# è®¾è®¡ä¸ä¸ªä½ä»£ç å¹³å°\n\n> æ¬æç®æ æ¯è®¾è®¡ä¸ä¸ªç¨äºæé«å¼åäººåå¼åæççä½ä»£ç å¹³å°ï¼è¿éä¼éç¨ç³»ç»è§£å³æ¹æ¡è®¾è®¡çä¸è¬æè·¯æ¥éæ­¥æ¢å¯»è®¾è®¡æ¹æ¡ã\n\n\n# ä¸å¡åæ\n\n\n# ä½ä»£ç å¹³å°æ¯ä»ä¹\n\nå¹¿ä¹ä¸çä½ä»£ç å¹³å°åæ¬ä½ä»£ç å¹³å°åé¶ä»£ç å¹³å°ï¼å®ä»¬é½å±äº apaasï¼application platform as a service åºç¨å¹³å°å³æå¡ï¼ï¼ä¸¤èçä¸»è¦åºå«å¨äºå¯¹ä»£ç çä¾èµç¨åº¦ï¼\n\n * ä½ä»£ç å¹³å°ï¼éè¿èªå¨ä»£ç çæåå¯è§åç¼ç¨ï¼åªéè¦å°éä»£ç ï¼å³å¯å¿«éæ­å»ºåç§åºç¨ã\n * é¶ä»£ç å¹³å°ï¼é¶å¼åç»éªçä¸å¡äººåéè¿ææ½ç­æ¹å¼ï¼æ éç¼åä»£ç ï¼å³å¯å¿«éæ­å»ºåç§åºç¨ã\n\n\n# ææ¯è·¯çº¿\n\n# åºäº ide æ¡æ¶çå¿«éå¼åå¹³å°\n\nè¯¥æ¹æ¡å°ä¼ ç»çéæå¼åç¯å¢ï¼ideï¼ååå¯è§åï¼å¼åèå¯¹åç«¯çé¢ç»ä»¶ãæ°æ®æºç»å®æ¹å¼ãæ°æ®æ¨¡åãä¸å¡é»è¾åå·¥ä½æµç­é½å¯ä»¥èªç±å®ä¹ï¼å¹³å°å°èªå¨çæä»£ç ï¼å¼åèä¹å¯ä»¥æ·»å èªå·±çä»£ç ï¼å¯¹ç¨åºå·æè¾å¼ºçæ§å¶è½åï¼å æ­¤è¯¥æ¹æ¡å·å¤æ´é«ççµæ´»æ§ï¼å¯ä»¥è®¾è®¡åºå®å¶åç¨åº¦é«ãé»è¾å¤æçè½¯ä»¶ã\n\nç±äºè¯¥æ¹æ¡ä»æ¶åä»£ç å¼åãé¨ç½²ç­ææ¯å·¥ä½ï¼æä»¥å®ä»ç¶æ¯ä¸ä¸ªææ¯å¼åå¹³å°ï¼éè¦è¾é«çå­¦ä¹ ææ¬ï¼ä¸»è¦ä»·å¼æ¯æé«å¼åæçï¼åå°éå¤å³å¨ã\n\noutsystems å°±æ¯éç¨è¯¥æ¹æ¡çå¸åäº§åï¼å¦ä¸ä¸ºäº§åæªå¾ï¼\n\n\n\n# åºäºæ¨¡åé©±å¨çåºç¨å¹³å°\n\nç¨æ·éè¿å¯è§åæ¹å¼æå»ºæ°æ®æ¨¡åãè§å¾ãæéãå·¥ä½æµç­ï¼å³å¯å¨å¹³å°æä¾çç¯å¢ä¸­è¿è¡ï¼æ éç¼è¯é¨ç½²ï¼æ´åä¸ç§å»çå¼çåºç¨æ­å»ºå¹³å°ãå¹³å°å¯¹åç±»ç»ä»¶ãä¸å¡é»è¾åäºè¾é«å±çº§çå°è£ï¼å æ­¤ç¨æ·æ æ³éå¿ææ¬²ä¿®æ¹çé¢é£æ ¼ãäº¤äºæ¹å¼ãå¤çé»è¾ç­ã\n\nè¯¥æ¹æ¡å¯ä»¥å®ç°å®å¨é¶ä»£ç ï¼å¯¹ä½¿ç¨èææ¯è¦æ±ä¸é«ï¼ä½éè¦å·å¤ä¸å¡æ½è±¡ãå»ºæ¨¡è½åãä¸»è¦ä»·å¼æ¯éä½å¼åé¨æ§ãå¿«ééåºååã\n\næéäºãä¼ä¼´äºç­é½æ¯æ­¤ç±»æ¹æ¡çå¸åäº§åï¼å¦ä¸ä¸ºæéäºçäº§åæªå¾ï¼\n\n\n\n\n# æ ¸å¿è¦ç´ \n\nç»å¤§é¨åçä¼ä¸è½¯ä»¶ç±ä»¥ä¸åä¸ªé¨åç»æï¼\n\n * ä¸å¡å®ä½ï¼å³æä½å¯¹è±¡ï¼å¦å®¢æ·ãè®¢å\n * ä¸å¡æ´»å¨ï¼å³è¿è¡ä½ç§æä½ï¼å¦éè´­ç³è¯·ãååå®¡æ¹\n * ä¸å¡æéï¼å³ä½ç§äººæ¥æä½ç§æéï¼åæ¬æ°æ®æ¥çæéåæ°æ®æä½æéï¼å¦é¨é¨ç»çå¯ä»¥ç®¡çææä¸å±çå®¢æ·ä¿¡æ¯ï¼èåå·¥åªè½ç®¡çèªå·±çå®¢æ·ä¿¡æ¯\n * ç»è®¡æ¥è¡¨ï¼å³ä»åªäºæ¹é¢éåä¼ä¸æ´»å¨æåµï¼å¦å®¢æ·å¢é¿çãåæéå®é¢è¶å¿\n\nä½ä»£ç å¹³å°å°ä»¥ä¸è¿è¡æ½è±¡ï¼æ¯ææ°æ®æ¨¡åãä¸å¡æµç¨ãç¨æ·æéãç»è®¡å¾è¡¨ï¼å æ­¤å¯ä»¥ä½ä¸ºæ´éç¨çä¼ä¸è½¯ä»¶è§£å³æ¹æ¡ï¼è¿åç±»è½åä¹æ¯ä»»ä½ä¸ä¸ªä½ä»£ç å¹³å°é½å¿é¡»å·å¤çæ ¸å¿è¦ç´ ã\n\n# æ°æ®æ¨¡å\n\nå»ºç«æ°æ®æ¨¡åå°±æ¯æåä¸å¡å®ä½çæ°æ®ç¹å¾ï¼æ½è±¡ä¸ºæ°æ®è¡¨ï¼å»ºç«è¡¨é´å³ç³»ãå¶ä½ er å¾çè¿ç¨å°±æ¯æ°æ®å»ºæ¨¡ãå¸é¢ä¸å¸¸è§çä½ä»£ç å¹³å°åæä¾äºä¸°å¯çæ§ä»¶ï¼å¯ä»¥ææ½å®ææ°æ®æ¨¡åæ­å»ºãæ­¤å¤ï¼æ°æ®æ¨¡åæ­å»ºä¸è¡¨åå±ç¤ºåäºä¸ºä¸ï¼æ¯å®æä¸ä¸ªæ°æ®è¡¨çåå»ºï¼å°±èªå¨çæäºè¯¥è¡¨çå¢å æ¹æ¥åè½åç¸å³é¡µé¢ï¼è¿èéèäºæ°æ®åºè®¾è®¡ãåç«¯å¼åè¿äºä¸ä¸ææ¯ãå¶å®ï¼è¿ä¹å°±æ¯æä»¬å¸¸è¯´çè¡¨åå¼æã\n\nè¿éé¡ºä¾¿æä¸ä¸ï¼è½ç¶å¾å¤ä½ä»£ç å¹³å°å°æ°æ®å»ºæ¨¡ä¸è¡¨åå±ç¤ºåäºä¸ºä¸ï¼ä½éè¿è¿ç§æ¹å¼èªå¨çæçè¡¨ååªè½å®ç°æåºç¡çå¢å æ¹æ¥é¡µé¢ï¼ç¨æ·å¯¹çé¢å±ç¤ºåå®¹åå½¢å¼çæ§å¶ç¨åº¦å¾ä½ï¼æ æ³æ»¡è¶³å¤§é¨åä¼ä¸è½¯ä»¶çéæ±ï¼æä»¥ä½ä»£ç å¹³å°ä¸è¬è¿ä¼æä¾èªå®ä¹é¡µé¢åè½ï¼ç¨æ·å¯æ ¹æ®éè¦å¨é¡µé¢ä¸éç½®æé®ãå¾è¡¨ç­åç´ ï¼æ»¡è¶³ä¸ªæ§åéæ±ã\n\n# ä¸å¡æµç¨\n\nä¸å¡æµç¨æä¸ºäºå®ç°æé¡¹ç®æ ï¼ç±å¤äººåä½ï¼æç§ä¸å®çè§åãé¡ºåºè¿è¡çä¸ç³»åæ´»å¨ï¼å¨è½¯ä»¶ä¸­ï¼ä¸å¡æµç¨çåä¸èå¯ä»¥æ¯äººï¼ä¹å¯ä»¥æ¯ç¨åºãä½ä»£ç å¹³å°å®ç°äºå¯è§åæµç¨éç½®ï¼ç¨æ·å¯¹è§¦åæ¡ä»¶ãå¤çèç¹ãèç¹åä¸èè¿è¡éç½®ï¼å®ç°èªå®ä¹ä¸å¡æµç¨ã\n\n# ç¨æ·æé\n\nå¤§é¨åçä½ä»£ç å¹³å°é½éç¨äºéå¸¸ç»å¸ç rbacï¼role-based access control ï¼æ¨¡åç®¡çç¨æ·æéï¼ç®åæ¥è¯´å°±æ¯å°æ¥æç¸åæéçç¨æ·æ·»å ä¸ºç¸åè§è²ï¼éè¿ä¸ºè§è²åéæéï¼å®ç°äºâç¨æ·ââè§è²ââæéâçæææ¨¡å¼ãç±äºä¼ä¸æ¯ä¸ä¸ªç»ç»ï¼ä¸è¬é½ä¼æé¨é¨çæ¦å¿µï¼æä»¥ä¹å¯ä»¥å°é¨é¨æ·»å å°æä¸ªè§è²ï¼å®ç°âç¨æ·ââé¨é¨ââè§è²ââæéâçæææ¨¡å¼ã\n\n# ç»è®¡å¾è¡¨\n\nç»è®¡å¾è¡¨å¯ä»¥ç±»æ¯ excel ä¸­çéè§å¾ï¼ç»è®¡å¾è¡¨ç±æ°æ®æºãç»è®¡è§åãå±ç¤ºå½¢å¼å®ä¹ï¼ä½ä»£ç å¹³å°ä¹æ­£æ¯éµå¾ªè¿ç§æ¹å¼ï¼å®ç°ç»è®¡å¾è¡¨çå¯è§åéç½®ã\n\n\n# æµè¡äº§å\n\n# outsystems\n\noutsystems æ¯å¿«éåºç¨å¼åçå¤´å·ä½ä»£ç å¹³å°ï¼å¹¶ä¸æ¯ 2018 å¹´ gartner é«çäº§åå¹³å°çé¢å¯¼èãoutsystems å·ç§°å°ä½ä»£ç åè½ä¸é«çº§ç§»å¨åè½ç¸ç»åçå¯ä¸è§£å³æ¹æ¡ï¼å®æ¯ææ´ä¸ªåºç¨ç¨åºç»åçå¯è§åå¼åï¼å¯è½»æ¾ä¸ç°æç³»ç»éæã\n\n# mendix\n\nmendix å¸®å©ä¼ä¸æ¹ååæ°æ¹å¼ãéè¿ä½¿ç¨å¯è§åæ¨¡åï¼å¨ mendix ä¸æå»ºåºç¨ç¨åºéå¸¸ç®åï¼å¿«éä¸ç´è§ï¼å¯ä½¿å¼åäººååä¸å¡åæäººåç­ä¼å¤äººåæå»ºå¼ºå¤§çåºç¨ç¨åºï¼èæ éç¼åä»£ç ãåå©æ¨¡åé©±å¨å¼åï¼ä¸å¡é¢å¯¼èå it é¨é¨å¯ä»¥å±äº«è¯­è¨æ¥å¿«éæå»ºåºç¨ç¨åºã\n\n\n# é¡¶å±è®¾è®¡\n\nç±äºç³»ç»çç¨æ·ç¾¤ä½æ¯æä¸å®ææ¯åºç¡çå¼åäººåãæä»¥ï¼ç³»ç»å®ä½æ¯ä½ä»£ç å¹³å°ï¼èéé¶ä»£ç å¹³å°ã\n\nå¶æ¬¡ï¼ç±äºç³»ç»ä¸»è¦æ¯ç¨äºç®ååºæ¬çé¡µé¢å¼åï¼æä»¥ææ¯è·¯çº¿åºè¯¥éæ©ï¼åºäºæ¨¡åé©±å¨çåºç¨å¹³å°ã\n\næåï¼ç±äºçæçä»£ç æ¯åºç¨äº java web æ¡æ¶ãçæçåç«¯ä»£ç æ¯ java ä»£ç ï¼åç«¯ä»£ç æ¯åºäº vue + element-ui çæçåç«¯ä»£ç ã\n\n\n\nä»£ç çæè§åå¯¹åºçæ°æ®å»ºæ¨¡ï¼\n\n\n\nèªå¨çæååç«¯ä»£ç ã\n\n * åç«¯ä»£ç \n   * controller\n   * service\n   * serviceimpl\n   * daomybatis\n   * daoimpl\n   * mapper\n   * query\n   * dto\n   * entity\n   * xml\n * åç«¯ä»£ç \n   * list\n   * form\n   * api\n\n\n# ç»ä»¶è®¾è®¡\n\n\n# åè¡¨é¡µ\n\n# æç´¢æ \n\n# æä½æ \n\n# è¡¨æ ¼\n\n# åé¡µ\n\n\n# è¡¨åé¡µ\n\n# è¡¨åç»ä»¶\n\n# æ ¡éªå¨\n\n\n# æ©å±è®¾è®¡\n\n\n# åèèµæ\n\n * ä½ä»£ç å¹³å°ï¼10 åéä»å¥é¨å°åç\n * æµè°ä½ä»£ç å¹³å°æ¶åçä¸äºææ¯éå",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æµ·éæ°æ®å¤ç",frontmatter:{title:"æµ·éæ°æ®å¤ç",date:"2021-08-19T22:15:16.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/1ed7ae/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/æµ·éæ°æ®å¤ç.md",key:"v-7a3f894c",path:"/pages/1ed7ae/",headers:[{level:2,title:"å¦ä½ä»æµ·éç URL ä¸­æ¾åºç¸åç URLï¼",slug:"å¦ä½ä»æµ·éç-url-ä¸­æ¾åºç¸åç-url",normalizedTitle:"å¦ä½ä»æµ·éç url ä¸­æ¾åºç¸åç urlï¼",charIndex:13},{level:3,title:"é®é¢æè¿°",slug:"é®é¢æè¿°",normalizedTitle:"é®é¢æè¿°",charIndex:40},{level:3,title:"è§£å³æè·¯",slug:"è§£å³æè·¯",normalizedTitle:"è§£å³æè·¯",charIndex:120},{level:3,title:"æ¹æ¡æ»ç»",slug:"æ¹æ¡æ»ç»",normalizedTitle:"æ¹æ¡æ»ç»",charIndex:748},{level:2,title:"å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯ï¼",slug:"å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯",normalizedTitle:"å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯ï¼",charIndex:798},{level:3,title:"é®é¢æè¿°",slug:"é®é¢æè¿°-2",normalizedTitle:"é®é¢æè¿°",charIndex:40},{level:3,title:"è§£å³æè·¯",slug:"è§£å³æè·¯-2",normalizedTitle:"è§£å³æè·¯",charIndex:120},{level:3,title:"æ¹æ¡æ»ç»",slug:"æ¹æ¡æ»ç»-2",normalizedTitle:"æ¹æ¡æ»ç»",charIndex:748},{level:2,title:"å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç IPï¼",slug:"å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç-ip",normalizedTitle:"å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç ipï¼",charIndex:1564},{level:3,title:"é®é¢æè¿°",slug:"é®é¢æè¿°-3",normalizedTitle:"é®é¢æè¿°",charIndex:40},{level:3,title:"è§£å³æè·¯",slug:"è§£å³æè·¯-3",normalizedTitle:"è§£å³æè·¯",charIndex:120},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°ï¼",slug:"å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°",normalizedTitle:"å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°ï¼",charIndex:1938},{level:3,title:"é®é¢æè¿°",slug:"é®é¢æè¿°-4",normalizedTitle:"é®é¢æè¿°",charIndex:40},{level:3,title:"è§£å³æè·¯",slug:"è§£å³æè·¯-4",normalizedTitle:"è§£å³æè·¯",charIndex:120},{level:4,title:"æ¹æ³ä¸ï¼åæ²»æ³",slug:"æ¹æ³ä¸-åæ²»æ³",normalizedTitle:"æ¹æ³ä¸ï¼åæ²»æ³",charIndex:2021},{level:4,title:"æ¹æ³äºï¼ä½å¾æ³",slug:"æ¹æ³äº-ä½å¾æ³",normalizedTitle:"æ¹æ³äºï¼ä½å¾æ³",charIndex:2113},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-2",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨ï¼",slug:"å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨",normalizedTitle:"å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨ï¼",charIndex:2959},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:4,title:"æ¹æ³ä¸ï¼åæ²»æ³",slug:"æ¹æ³ä¸-åæ²»æ³-2",normalizedTitle:"æ¹æ³ä¸ï¼åæ²»æ³",charIndex:2021},{level:4,title:"æ¹æ³äºï¼ä½å¾æ³",slug:"æ¹æ³äº-ä½å¾æ³-2",normalizedTitle:"æ¹æ³äºï¼ä½å¾æ³",charIndex:2113},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-3",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²ï¼",slug:"å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²",normalizedTitle:"å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²ï¼",charIndex:3311},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°-2",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯-2",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:4,title:"æ¹æ³ä¸ï¼åæ²»æ³",slug:"æ¹æ³ä¸-åæ²»æ³-3",normalizedTitle:"æ¹æ³ä¸ï¼åæ²»æ³",charIndex:2021},{level:4,title:"æ¹æ³äºï¼HashMap æ³",slug:"æ¹æ³äº-hashmap-æ³",normalizedTitle:"æ¹æ³äºï¼hashmap æ³",charIndex:3732},{level:4,title:"æ¹æ³ä¸ï¼åç¼æ æ³ï¼å­å¸æ ï¼",slug:"æ¹æ³ä¸-åç¼æ æ³-å­å¸æ ",normalizedTitle:"æ¹æ³ä¸ï¼åç¼æ æ³ï¼å­å¸æ ï¼",charIndex:4079},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-4",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°ï¼",slug:"å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°",normalizedTitle:"å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°ï¼",charIndex:4350},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°-3",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯-3",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-5",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½ä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ï¼",slug:"å¦ä½ä»-5-äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°",normalizedTitle:"å¦ä½ä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ï¼",charIndex:4703},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°-4",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯-4",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:4,title:"æ¹æ³ä¸ï¼åå æ³",slug:"æ¹æ³ä¸-åå æ³",normalizedTitle:"æ¹æ³ä¸ï¼åå æ³",charIndex:4914},{level:4,title:"æ¹æ³äºï¼åæ²»æ³",slug:"æ¹æ³äº-åæ²»æ³",normalizedTitle:"æ¹æ³äºï¼åæ²»æ³",charIndex:6276},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-6",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½æ¾åºæåå 500 çæ°ï¼",slug:"å¦ä½æ¾åºæåå-500-çæ°",normalizedTitle:"å¦ä½æ¾åºæåå 500 çæ°ï¼",charIndex:6794},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°-5",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯-5",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-7",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852},{level:2,title:"å¦ä½æç§ query çé¢åº¦æåºï¼",slug:"å¦ä½æç§-query-çé¢åº¦æåº",normalizedTitle:"å¦ä½æç§ query çé¢åº¦æåºï¼",charIndex:9132},{level:3,title:"é¢ç®æè¿°",slug:"é¢ç®æè¿°-6",normalizedTitle:"é¢ç®æè¿°",charIndex:2983},{level:3,title:"è§£ç­æè·¯",slug:"è§£ç­æè·¯-6",normalizedTitle:"è§£ç­æè·¯",charIndex:3062},{level:4,title:"æ¹æ³ä¸ï¼HashMap æ³",slug:"æ¹æ³ä¸-hashmap-æ³",normalizedTitle:"æ¹æ³ä¸ï¼hashmap æ³",charIndex:9353},{level:4,title:"æ¹æ³äºï¼åæ²»æ³",slug:"æ¹æ³äº-åæ²»æ³-2",normalizedTitle:"æ¹æ³äºï¼åæ²»æ³",charIndex:6276},{level:3,title:"æ¹æ³æ»ç»",slug:"æ¹æ³æ»ç»-8",normalizedTitle:"æ¹æ³æ»ç»",charIndex:1852}],headersStr:"å¦ä½ä»æµ·éç URL ä¸­æ¾åºç¸åç URLï¼ é®é¢æè¿° è§£å³æè·¯ æ¹æ¡æ»ç» å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯ï¼ é®é¢æè¿° è§£å³æè·¯ æ¹æ¡æ»ç» å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç IPï¼ é®é¢æè¿° è§£å³æè·¯ æ¹æ³æ»ç» å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°ï¼ é®é¢æè¿° è§£å³æè·¯ æ¹æ³ä¸ï¼åæ²»æ³ æ¹æ³äºï¼ä½å¾æ³ æ¹æ³æ»ç» å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨ï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³ä¸ï¼åæ²»æ³ æ¹æ³äºï¼ä½å¾æ³ æ¹æ³æ»ç» å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²ï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³ä¸ï¼åæ²»æ³ æ¹æ³äºï¼HashMap æ³ æ¹æ³ä¸ï¼åç¼æ æ³ï¼å­å¸æ ï¼ æ¹æ³æ»ç» å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°ï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³æ»ç» å¦ä½ä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³ä¸ï¼åå æ³ æ¹æ³äºï¼åæ²»æ³ æ¹æ³æ»ç» å¦ä½æ¾åºæåå 500 çæ°ï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³æ»ç» å¦ä½æç§ query çé¢åº¦æåºï¼ é¢ç®æè¿° è§£ç­æè·¯ æ¹æ³ä¸ï¼HashMap æ³ æ¹æ³äºï¼åæ²»æ³ æ¹æ³æ»ç»",content:"# æµ·éæ°æ®å¤ç\n\n\n# å¦ä½ä»æµ·éç URL ä¸­æ¾åºç¸åç URLï¼\n\n\n# é®é¢æè¿°\n\nç»å® aãb ä¸¤ä¸ªæä»¶ï¼åå­æ¾ 50 äº¿ä¸ª URLï¼æ¯ä¸ª URL åå  64Bï¼åå­éå¶æ¯ 4Gãè¯·æ¾åº aãb ä¸¤ä¸ªæä»¶å±åç URLã\n\n\n# è§£å³æè·¯\n\næ¯ä¸ª URL å  64Bï¼é£ä¹ 50 äº¿ä¸ª URL å ç¨çç©ºé´å¤§å°çº¦ä¸º 320GBã\n\n> $$5,000,000,000 * 64 B â 5 GB * 64 = 320 GB$$\n\nç±äºåå­å¤§å°åªæ 4Gï¼å æ­¤ï¼æä»¬ä¸å¯è½ä¸æ¬¡æ§æææ URL å è½½å°åå­ä¸­å¤çãå¯¹äºè¿ç§ç±»åçé¢ç®ï¼ä¸è¬éç¨åæ²»ç­ç¥ï¼å³ï¼æä¸ä¸ªæä»¶ä¸­ç URL æç§æä¸ªç¹å¾ååä¸ºå¤ä¸ªå°æä»¶ï¼ä½¿å¾æ¯ä¸ªå°æä»¶å¤§å°ä¸è¶è¿ 4Gï¼è¿æ ·å°±å¯ä»¥æè¿ä¸ªå°æä»¶è¯»å°åå­ä¸­è¿è¡å¤çäºã\n\næè·¯å¦ä¸ï¼\n\né¦åéåæä»¶ aï¼å¯¹éåå°ç URL æ± hash(URL) % 1000ï¼æ ¹æ®è®¡ç®ç»ææéåå°ç URL å­å¨å° a0, a1, a2, ..., a999ï¼è¿æ ·æ¯ä¸ªå¤§å°çº¦ä¸º 300MBãä½¿ç¨åæ ·çæ¹æ³éåæä»¶ bï¼ææä»¶ b ä¸­ç URL åå«å­å¨å°æä»¶ b0, b1, b2, ..., b999 ä¸­ãè¿æ ·å¤çè¿åï¼ææå¯è½ç¸åç URL é½å¨å¯¹åºçå°æä»¶ä¸­ï¼å³ a0 å¯¹åº b0, ..., a999 å¯¹åº b999ï¼ä¸å¯¹åºçå°æä»¶ä¸å¯è½æç¸åç URLãé£ä¹æ¥ä¸æ¥ï¼æä»¬åªéè¦æ±åºè¿ 1000 å¯¹å°æä»¶ä¸­ç¸åç URL å°±å¥½äºã\n\næ¥çéå ai( iâ[0,999])ï¼æ URL å­å¨å°ä¸ä¸ª HashSet éåä¸­ãç¶åéå bi ä¸­æ¯ä¸ª URLï¼çå¨ HashSet éåä¸­æ¯å¦å­å¨ï¼è¥å­å¨ï¼è¯´æè¿å°±æ¯å±åç URLï¼å¯ä»¥æè¿ä¸ª URL ä¿å­å°ä¸ä¸ªåç¬çæä»¶ä¸­ã\n\n\n# æ¹æ¡æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * å¯¹æ¯ä¸ªå­æä»¶è¿è¡ HashSet ç»è®¡ã\n\n\n# å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯ï¼\n\n\n# é®é¢æè¿°\n\næä¸ä¸ª 1GB å¤§å°çæä»¶ï¼æä»¶éæ¯ä¸è¡æ¯ä¸ä¸ªè¯ï¼æ¯ä¸ªè¯çå¤§å°ä¸è¶è¿ 16Bï¼åå­å¤§å°éå¶æ¯ 1MBï¼è¦æ±è¿åé¢æ°æé«ç 100 ä¸ªè¯(Top 100)ã\n\n\n# è§£å³æè·¯\n\nç±äºåå­éå¶ï¼æ æ³ç´æ¥å°å¤§æä»¶çææè¯ä¸æ¬¡è¯»å°åå­ä¸­ãå æ­¤ï¼å¯ä»¥éç¨åæ²»ç­ç¥ï¼æä¸ä¸ªå¤§æä»¶åè§£æå¤ä¸ªå°æä»¶ï¼ä¿è¯æ¯ä¸ªæä»¶çå¤§å°å°äº 1MBï¼è¿èç´æ¥å°åä¸ªå°æä»¶è¯»åå°åå­ä¸­è¿è¡å¤çã\n\næè·¯å¦ä¸ï¼\n\né¦åéåå¤§æä»¶ï¼å¯¹éåå°çæ¯ä¸ªè¯ xï¼æ§è¡ hash(x) % 5000ï¼å°ç»æä¸º i çè¯å­æ¾å°æä»¶ Ai ä¸­ãéåç»æåï¼æä»¬å¯ä»¥å¾å° 5000 ä¸ªå°æä»¶ãæ¯ä¸ªå°æä»¶çå¤§å°ä¸º 200KB å·¦å³ãå¦ææçå°æä»¶å¤§å°ä»ç¶è¶è¿ 1MBï¼åéç¨åæ ·çæ¹å¼ç»§ç»­è¿è¡åè§£ã\n\næ¥çç»è®¡æ¯ä¸ªå°æä»¶ä¸­åºç°é¢æ°æé«ç 100 ä¸ªè¯ãæç®åçæ¹å¼æ¯ä½¿ç¨ HashMap æ¥å®ç°ãå¶ä¸­ key ä¸ºè¯ï¼value ä¸ºè¯¥è¯åºç°çé¢çãå·ä½æ¹æ³æ¯ï¼å¯¹äºéåå°çè¯ xï¼å¦æå¨ map ä¸­ä¸å­å¨ï¼åæ§è¡ map.put(x, 1) è¥å­å¨ï¼åæ§è¡ map.put(x, map.get(x)+1)ï¼å°è¯¥è¯é¢æ°å  1ã\n\nä¸é¢æä»¬ç»è®¡äºæ¯ä¸ªå°æä»¶åè¯åºç°çé¢æ°ãæ¥ä¸æ¥ï¼æä»¬å¯ä»¥éè¿ç»´æ¤ä¸ä¸ªå°é¡¶å æ¥æ¾åºææè¯ä¸­åºç°é¢æ°æé«ç 100 ä¸ªãå·ä½æ¹æ³æ¯ï¼ä¾æ¬¡éåæ¯ä¸ªå°æä»¶ï¼æå»ºä¸ä¸ªå°é¡¶å ï¼å å¤§å°ä¸º 100ãå¦æéåå°çè¯çåºç°æ¬¡æ°å¤§äºå é¡¶è¯çåºç°æ¬¡æ°ï¼åç¨æ°è¯æ¿æ¢å é¡¶çè¯ï¼ç¶åéæ°è°æ´ä¸ºå°é¡¶å ï¼éåç»æåï¼å°é¡¶å ä¸çè¯å°±æ¯åºç°é¢æ°æé«ç 100 ä¸ªè¯ã\n\n\n# æ¹æ¡æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * ä½¿ç¨ HashMap ç»è®¡é¢æ°ï¼\n * æ±è§£æå¤§ç TopN ä¸ªï¼ç¨å°é¡¶å ï¼æ±è§£æå°ç TopN ä¸ªï¼ç¨å¤§é¡¶å ã\n\n\n# å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç IPï¼\n\n\n# é®é¢æè¿°\n\nç°ææµ·éæ¥å¿æ°æ®ä¿å­å¨ä¸ä¸ªè¶å¤§æä»¶ä¸­ï¼è¯¥æä»¶æ æ³ç´æ¥è¯»å¥åå­ï¼è¦æ±ä»ä¸­æåæå¤©è®¿é®ç¾åº¦æ¬¡æ°æå¤çé£ä¸ª IPã\n\n\n# è§£å³æè·¯\n\nè¿éé¢åªå³å¿æä¸å¤©è®¿é®ç¾åº¦æå¤ç IPï¼å æ­¤ï¼å¯ä»¥é¦åå¯¹æä»¶è¿è¡ä¸æ¬¡éåï¼æè¿ä¸å¤©è®¿é®ç¾åº¦ IP çç¸å³ä¿¡æ¯è®°å½å°ä¸ä¸ªåç¬çå¤§æä»¶ä¸­ãæ¥ä¸æ¥éç¨çæ¹æ³ä¸ä¸ä¸é¢ä¸æ ·ï¼å¤§è´å°±æ¯åå¯¹ IP è¿è¡åå¸æ å°ï¼æ¥çä½¿ç¨ HashMap ç»è®¡éå¤ IP çæ¬¡æ°ï¼æåè®¡ç®åºéå¤æ¬¡æ°æå¤ç IPã\n\n> æ³¨ï¼è¿éåªéè¦æ¾åºåºç°æ¬¡æ°æå¤ç IPï¼å¯ä»¥ä¸å¿ä½¿ç¨å ï¼ç´æ¥ç¨ä¸ä¸ªåé max å³å¯ã\n\n\n# æ¹æ³æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * ä½¿ç¨ HashMap ç»è®¡é¢æ°ï¼\n * æ±è§£æå¤§ç TopN ä¸ªï¼ç¨å°é¡¶å ï¼æ±è§£æå°ç TopN ä¸ªï¼ç¨å¤§é¡¶å ã\n\n\n# å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°ï¼\n\n\n# é®é¢æè¿°\n\nå¨ 2.5 äº¿ä¸ªæ´æ°ä¸­æ¾åºä¸éå¤çæ´æ°ãæ³¨æï¼åå­ä¸è¶³ä»¥å®¹çº³è¿ 2.5 äº¿ä¸ªæ´æ°ã\n\n\n# è§£å³æè·¯\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nä¸åé¢çé¢ç®æ¹æ³ç±»ä¼¼ï¼åå° 2.5 äº¿ä¸ªæ°ååå°å¤ä¸ªå°æä»¶ï¼ç¨ HashSet/HashMap æ¾åºæ¯ä¸ªå°æä»¶ä¸­ä¸éå¤çæ´æ°ï¼ååå¹¶æ¯ä¸ªå­ç»æï¼å³ä¸ºæç»ç»æã\n\n# æ¹æ³äºï¼ä½å¾æ³\n\nä½å¾ï¼å°±æ¯ç¨ä¸ä¸ªæå¤ä¸ª bit æ¥æ è®°æä¸ªåç´ å¯¹åºçå¼ï¼èé®å°±æ¯è¯¥åç´ ãéç¨ä½ä½ä¸ºåä½æ¥å­å¨æ°æ®ï¼å¯ä»¥å¤§å¤§èçå­å¨ç©ºé´ã\n\nä½å¾éè¿ä½¿ç¨ä½æ°ç»æ¥è¡¨ç¤ºæäºåç´ æ¯å¦å­å¨ãå®å¯ä»¥ç¨äºå¿«éæ¥æ¾ï¼å¤éï¼æåºç­ãä¸æ¯å¾æ¸æ¥ï¼æåä¸¾ä¸ªå°ä¾å­ã\n\nåè®¾æä»¬è¦å¯¹ [0,7] ä¸­ç 5 ä¸ªåç´  (6, 4, 2, 1, 5) è¿è¡æåºï¼å¯ä»¥éç¨ä½å¾æ³ã0~7 èå´æ»å±æ 8 ä¸ªæ°ï¼åªéè¦ 8bitï¼å³ 1 ä¸ªå­èãé¦åå°æ¯ä¸ªä½é½ç½® 0ï¼\n\n0 0 0 0 0 0 0 0\n\n\nç¶åéå 5 ä¸ªåç´ ï¼é¦åéå° 6ï¼é£ä¹å°ä¸æ ä¸º 6 çä½ç 0 ç½®ä¸º 1ï¼æ¥çéå° 4ï¼æä¸æ ä¸º 4 çä½ ç 0 ç½®ä¸º 1ï¼\n\n0 0 0 0 1 0 1 0\n\n\nä¾æ¬¡éåï¼ç»æåï¼ä½æ°ç»æ¯è¿æ ·çï¼\n\n0 1 1 0 1 1 1 0\n\n\næ¯ä¸ªä¸º 1 çä½ï¼å®çä¸æ é½è¡¨ç¤ºäºä¸ä¸ªæ°ï¼\n\nfor i in range(8):\n    if bits[i] == 1:\n        print(i)\n\n\nè¿æ ·æä»¬å¶å®å°±å·²ç»å®ç°äºæåºã\n\nå¯¹äºæ´æ°ç¸å³çç®æ³çæ±è§£ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸å®ç¨çç®æ³ãåè®¾ int æ´æ°å ç¨ 4Bï¼å³ 32bitï¼é£ä¹æä»¬å¯ä»¥è¡¨ç¤ºçæ´æ°çä¸ªæ°ä¸º 232ã\n\né£ä¹å¯¹äºè¿éé¢ï¼æä»¬ç¨ 2 ä¸ª bit æ¥è¡¨ç¤ºåä¸ªæ°å­çç¶æï¼\n\n * 00 è¡¨ç¤ºè¿ä¸ªæ°å­æ²¡åºç°è¿ï¼\n * 01 è¡¨ç¤ºè¿ä¸ªæ°å­åºç°è¿ä¸æ¬¡ï¼å³ä¸ºé¢ç®ææ¾çä¸éå¤æ´æ°ï¼ï¼\n * 10 è¡¨ç¤ºè¿ä¸ªæ°å­åºç°äºå¤æ¬¡ã\n\né£ä¹è¿ 232 ä¸ªæ´æ°ï¼æ»å±æéåå­ä¸º 232*2b=1GBãå æ­¤ï¼å½å¯ç¨åå­è¶è¿ 1GB æ¶ï¼å¯ä»¥éç¨ä½å¾æ³ãåè®¾åå­æ»¡è¶³ä½å¾æ³éæ±ï¼è¿è¡ä¸é¢çæä½ï¼\n\néå 2.5 äº¿ä¸ªæ´æ°ï¼æ¥çä½å¾ä¸­å¯¹åºçä½ï¼å¦ææ¯ 00ï¼ååä¸º 01ï¼å¦ææ¯ 01 ååä¸º 10ï¼å¦ææ¯ 10 åä¿æä¸åãéåç»æåï¼æ¥çä½å¾ï¼æå¯¹åºä½æ¯ 01 çæ´æ°è¾åºå³å¯ã\n\n\n# æ¹æ³æ»ç»\n\nå¤æ­æ°å­æ¯å¦éå¤çé®é¢ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸é«æçæ¹æ³ã\n\n\n# å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨ï¼\n\n\n# é¢ç®æè¿°\n\nç»å® 40 äº¿ä¸ªä¸éå¤çæ²¡æè¿åºç unsigned int åæ´æ°ï¼ç¶ååç»å®ä¸ä¸ªæ°ï¼å¦ä½å¿«éå¤æ­è¿ä¸ªæ°æ¯å¦å¨è¿ 40 äº¿ä¸ªæ´æ°å½ä¸­ï¼\n\n\n# è§£ç­æè·¯\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nä¾ç¶å¯ä»¥ç¨åæ²»æ³è§£å³ï¼æ¹æ³ä¸åé¢ç±»ä¼¼ï¼å°±ä¸åæ¬¡èµè¿°äºã\n\n# æ¹æ³äºï¼ä½å¾æ³\n\n40 äº¿ä¸ªä¸éå¤æ´æ°ï¼æä»¬ç¨ 40 äº¿ä¸ª bit æ¥è¡¨ç¤ºï¼åå§ä½åä¸º 0ï¼é£ä¹æ»å±éè¦åå­ï¼4,000,000,000bâ512Mã\n\næä»¬è¯»åè¿ 40 äº¿ä¸ªæ´æ°ï¼å°å¯¹åºç bit è®¾ç½®ä¸º 1ãæ¥çè¯»åè¦æ¥è¯¢çæ°ï¼æ¥çç¸åºä½æ¯å¦ä¸º 1ï¼å¦æä¸º 1 è¡¨ç¤ºå­å¨ï¼å¦æä¸º 0 è¡¨ç¤ºä¸å­å¨ã\n\n\n# æ¹æ³æ»ç»\n\nå¤æ­æ°å­æ¯å¦å­å¨ãå¤æ­æ°å­æ¯å¦éå¤çé®é¢ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸é«æçæ¹æ³ã\n\n\n# å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²ï¼\n\n\n# é¢ç®æè¿°\n\næç´¢å¼æä¼éè¿æ¥å¿æä»¶æç¨æ·æ¯æ¬¡æ£ç´¢ä½¿ç¨çæææ¥è¯¢ä¸²é½è®°å½ä¸æ¥ï¼æ¯ä¸ªæ¥è¯¢ä¸²çé¿åº¦ä¸è¶è¿ 255 å­èã\n\nåè®¾ç®åæ 1000w ä¸ªè®°å½ï¼è¿äºæ¥è¯¢ä¸²çéå¤åº¦æ¯è¾é«ï¼è½ç¶æ»æ°æ¯ 1000wï¼ä½å¦æé¤å»éå¤åï¼åä¸è¶è¿ 300w ä¸ªï¼ãè¯·ç»è®¡æç­é¨ç 10 ä¸ªæ¥è¯¢ä¸²ï¼è¦æ±ä½¿ç¨çåå­ä¸è½è¶è¿ 1Gãï¼ä¸ä¸ªæ¥è¯¢ä¸²çéå¤åº¦è¶é«ï¼è¯´ææ¥è¯¢å®çç¨æ·è¶å¤ï¼ä¹å°±è¶ç­é¨ãï¼\n\n\n# è§£ç­æè·¯\n\næ¯ä¸ªæ¥è¯¢ä¸²æé¿ä¸º 255Bï¼1000w ä¸ªä¸²éè¦å ç¨ çº¦ 2.55G åå­ï¼å æ­¤ï¼æä»¬æ æ³å°ææå­ç¬¦ä¸²å¨é¨è¯»å¥å°åå­ä¸­å¤çã\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nåæ²»æ³ä¾ç¶æ¯ä¸ä¸ªéå¸¸å®ç¨çæ¹æ³ã\n\nååä¸ºå¤ä¸ªå°æä»¶ï¼ä¿è¯åä¸ªå°æä»¶ä¸­çå­ç¬¦ä¸²è½è¢«ç´æ¥å è½½å°åå­ä¸­å¤çï¼ç¶åæ±åºæ¯ä¸ªæä»¶ä¸­åºç°æ¬¡æ°æå¤ç 10 ä¸ªå­ç¬¦ä¸²ï¼æåéè¿ä¸ä¸ªå°é¡¶å ç»è®¡åºæææä»¶ä¸­åºç°æå¤ç 10 ä¸ªå­ç¬¦ä¸²ã\n\næ¹æ³å¯è¡ï¼ä½ä¸æ¯æå¥½ï¼ä¸é¢ä»ç»å¶ä»æ¹æ³ã\n\n# æ¹æ³äºï¼HashMap æ³\n\nè½ç¶å­ç¬¦ä¸²æ»æ°æ¯è¾å¤ï¼ä½å»éåä¸è¶è¿ 300wï¼å æ­¤ï¼å¯ä»¥èèæææå­ç¬¦ä¸²ååºç°æ¬¡æ°ä¿å­å¨ä¸ä¸ª HashMap ä¸­ï¼æå ç¨çç©ºé´ä¸º 300w*(255+4)â777Mï¼å¶ä¸­ï¼4 è¡¨ç¤ºæ´æ°å ç¨ç 4 ä¸ªå­èï¼ãç±æ­¤å¯è§ï¼1G çåå­ç©ºé´å®å¨å¤ç¨ã\n\næè·¯å¦ä¸ï¼\n\né¦åï¼éåå­ç¬¦ä¸²ï¼è¥ä¸å¨ map ä¸­ï¼ç´æ¥å­å¥ mapï¼value è®°ä¸º 1ï¼è¥å¨ map ä¸­ï¼åæå¯¹åºç value å  1ï¼è¿ä¸æ­¥æ¶é´å¤æåº¦ O(N)ã\n\næ¥çéå mapï¼æå»ºä¸ä¸ª 10 ä¸ªåç´ çå°é¡¶å ï¼è¥éåå°çå­ç¬¦ä¸²çåºç°æ¬¡æ°å¤§äºå é¡¶å­ç¬¦ä¸²çåºç°æ¬¡æ°ï¼åè¿è¡æ¿æ¢ï¼å¹¶å°å è°æ´ä¸ºå°é¡¶å ã\n\néåç»æåï¼å ä¸­ 10 ä¸ªå­ç¬¦ä¸²å°±æ¯åºç°æ¬¡æ°æå¤çå­ç¬¦ä¸²ãè¿ä¸æ­¥æ¶é´å¤æåº¦ O(Nlog10)ã\n\n# æ¹æ³ä¸ï¼åç¼æ æ³ï¼å­å¸æ ï¼\n\næ¹æ³äºä½¿ç¨äº HashMap æ¥ç»è®¡æ¬¡æ°ï¼å½è¿äºå­ç¬¦ä¸²æå¤§éç¸ååç¼æ¶ï¼å¯ä»¥èèä½¿ç¨åç¼æ æ¥ç»è®¡å­ç¬¦ä¸²åºç°çæ¬¡æ°ï¼æ çç»ç¹ä¿å­å­ç¬¦ä¸²åºç°æ¬¡æ°ï¼0 è¡¨ç¤ºæ²¡æåºç°ã\n\næè·¯å¦ä¸ï¼\n\nå¨éåå­ç¬¦ä¸²æ¶ï¼å¨åç¼æ ä¸­æ¥æ¾ï¼å¦ææ¾å°ï¼åæç»ç¹ä¸­ä¿å­çå­ç¬¦ä¸²æ¬¡æ°å  1ï¼å¦åä¸ºè¿ä¸ªå­ç¬¦ä¸²æå»ºæ°ç»ç¹ï¼æå»ºå®æåæå¶å­ç»ç¹ä¸­å­ç¬¦ä¸²çåºç°æ¬¡æ°ç½®ä¸º 1ã\n\næåä¾ç¶ä½¿ç¨å°é¡¶å æ¥å¯¹å­ç¬¦ä¸²çåºç°æ¬¡æ°è¿è¡æåºã\n\n\n# æ¹æ³æ»ç»\n\nåç¼æ ç»å¸¸è¢«ç¨æ¥ç»è®¡å­ç¬¦ä¸²çåºç°æ¬¡æ°ãå®çå¦å¤ä¸ä¸ªå¤§çç¨éæ¯å­ç¬¦ä¸²æ¥æ¾ï¼å¤æ­æ¯å¦æéå¤çå­ç¬¦ä¸²ç­ã\n\n\n# å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°ï¼\n\n\n# é¢ç®æè¿°\n\nå·²ç¥æä¸ªæä»¶ååå«ä¸äºçµè¯å·ç ï¼æ¯ä¸ªå·ç ä¸º 8 ä½æ°å­ï¼ç»è®¡ä¸åå·ç çä¸ªæ°ã\n\n\n# è§£ç­æè·¯\n\nè¿éé¢æ¬è´¨è¿æ¯æ±è§£æ°æ®éå¤çé®é¢ï¼å¯¹äºè¿ç±»é®é¢ï¼ä¸è¬é¦åèèä½å¾æ³ã\n\nå¯¹äºæ¬é¢ï¼8 ä½çµè¯å·ç å¯ä»¥è¡¨ç¤ºçå·ç ä¸ªæ°ä¸º $$10^8$$ ä¸ªï¼å³ 1 äº¿ä¸ªãæä»¬æ¯ä¸ªå·ç ç¨ä¸ä¸ª bit æ¥è¡¨ç¤ºï¼åæ»å±éè¦ 1 äº¿ä¸ª bitï¼åå­å ç¨çº¦ 100Mã\n\næè·¯å¦ä¸ï¼\n\nç³è¯·ä¸ä¸ªä½å¾æ°ç»ï¼é¿åº¦ä¸º 1 äº¿ï¼åå§åä¸º 0ãç¶åéåææçµè¯å·ç ï¼æå·ç å¯¹åºçä½å¾ä¸­çä½ç½®ç½®ä¸º 1ãéåå®æåï¼å¦æ bit ä¸º 1ï¼åè¡¨ç¤ºè¿ä¸ªçµè¯å·ç å¨æä»¶ä¸­å­å¨ï¼å¦åä¸å­å¨ãbit å¼ä¸º 1 çæ°éå³ä¸º ä¸åçµè¯å·ç çä¸ªæ°ã\n\n\n# æ¹æ³æ»ç»\n\næ±è§£æ°æ®éå¤é®é¢ï¼è®°å¾èèä½å¾æ³ã\n\n\n# å¦ä½ä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ï¼\n\n\n# é¢ç®æè¿°\n\nä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ãæ°æ®æåºåï¼ä½ç½®å¨æä¸­é´çæ°å°±æ¯ä¸­ä½æ°ãå½æ ·æ¬æ°ä¸ºå¥æ°æ¶ï¼ä¸­ä½æ°ä¸º ç¬¬ (N+1)/2 ä¸ªæ°ï¼å½æ ·æ¬æ°ä¸ºå¶æ°æ¶ï¼ä¸­ä½æ°ä¸º ç¬¬ N/2 ä¸ªæ°ä¸ç¬¬ 1+N/2 ä¸ªæ°çåå¼ã\n\n\n# è§£ç­æè·¯\n\nå¦æè¿éé¢æ²¡æåå­å¤§å°éå¶ï¼åå¯ä»¥ææææ°è¯»å°åå­ä¸­æåºåæ¾åºä¸­ä½æ°ãä½æ¯æå¥½çæåºç®æ³çæ¶é´å¤æåº¦é½ä¸º O(NlogN)ãè¿éä½¿ç¨å¶ä»æ¹æ³ã\n\n# æ¹æ³ä¸ï¼åå æ³\n\nç»´æ¤ä¸¤ä¸ªå ï¼ä¸ä¸ªå¤§é¡¶å ï¼ä¸ä¸ªå°é¡¶å ãå¤§é¡¶å ä¸­æå¤§çæ°å°äºç­äºå°é¡¶å ä¸­æå°çæ°ï¼ä¿è¯è¿ä¸¤ä¸ªå ä¸­çåç´ ä¸ªæ°çå·®ä¸è¶è¿ 1ã\n\nè¥æ°æ®æ»æ°ä¸ºå¶æ°ï¼å½è¿ä¸¤ä¸ªå å»ºå¥½ä¹åï¼ä¸­ä½æ°å°±æ¯è¿ä¸¤ä¸ªå é¡¶åç´ çå¹³åå¼ãå½æ°æ®æ»æ°ä¸ºå¥æ°æ¶ï¼æ ¹æ®ä¸¤ä¸ªå çå¤§å°ï¼ä¸­ä½æ°ä¸å®å¨æ°æ®å¤çå çå é¡¶ã\n\nclass MedianFinder {\n\n    private PriorityQueue<Integer> maxHeap;\n    private PriorityQueue<Integer> minHeap;\n\n    /** initialize your data structure here. */\n    public MedianFinder() {\n        maxHeap = new PriorityQueue<>(Comparator.reverseOrder());\n        minHeap = new PriorityQueue<>(Integer::compareTo);\n    }\n\n    public void addNum(int num) {\n        if (maxHeap.isEmpty() || maxHeap.peek() > num) {\n            maxHeap.offer(num);\n        } else {\n            minHeap.offer(num);\n        }\n\n        int size1 = maxHeap.size();\n        int size2 = minHeap.size();\n        if (size1 - size2 > 1) {\n            minHeap.offer(maxHeap.poll());\n        } else if (size2 - size1 > 1) {\n            maxHeap.offer(minHeap.poll());\n        }\n    }\n\n    public double findMedian() {\n        int size1 = maxHeap.size();\n        int size2 = minHeap.size();\n\n        return size1 == size2\n            ? (maxHeap.peek() + minHeap.peek()) * 1.0 / 2\n            : (size1 > size2 ? maxHeap.peek() : minHeap.peek());\n    }\n}\n\n\n> è§ LeetCode No.295ï¼https://leetcode.com/problems/find-median-from-data-stream/\n\nä»¥ä¸è¿ç§æ¹æ³ï¼éè¦ææææ°æ®é½å è½½å°åå­ä¸­ãå½æ°æ®éå¾å¤§æ¶ï¼å°±ä¸è½è¿æ ·äºï¼å æ­¤ï¼è¿ç§æ¹æ³éç¨äºæ°æ®éè¾å°çæåµã5 äº¿ä¸ªæ°ï¼æ¯ä¸ªæ°å­å ç¨ 4Bï¼æ»å±éè¦ 2G åå­ãå¦æå¯ç¨åå­ä¸è¶³ 2Gï¼å°±ä¸è½ä½¿ç¨è¿ç§æ¹æ³äºï¼ä¸é¢ä»ç»å¦ä¸ç§æ¹æ³ã\n\n# æ¹æ³äºï¼åæ²»æ³\n\nåæ²»æ³çææ³æ¯æä¸ä¸ªå¤§çé®é¢éæ¸è½¬æ¢ä¸ºè§æ¨¡è¾å°çé®é¢æ¥æ±è§£ã\n\nå¯¹äºè¿éé¢ï¼é¡ºåºè¯»åè¿ 5 äº¿ä¸ªæ°å­ï¼å¯¹äºè¯»åå°çæ°å­ numï¼å¦æå®å¯¹åºçäºè¿å¶ä¸­æé«ä½ä¸º 1ï¼åæè¿ä¸ªæ°å­åå° f1 ä¸­ï¼å¦ååå¥ f0 ä¸­ãéè¿è¿ä¸æ­¥ï¼å¯ä»¥æè¿ 5 äº¿ä¸ªæ°ååä¸ºä¸¤é¨åï¼èä¸ f0 ä¸­çæ°é½å¤§äº f1 ä¸­çæ°ï¼æé«ä½æ¯ç¬¦å·ä½ï¼ã\n\nååä¹åï¼å¯ä»¥éå¸¸å®¹æå°ç¥éä¸­ä½æ°æ¯å¨ f0 è¿æ¯ f1 ä¸­ãåè®¾ f1 ä¸­æ 1 äº¿ä¸ªæ°ï¼é£ä¹ä¸­ä½æ°ä¸å®å¨ f0 ä¸­ï¼ä¸æ¯å¨ f0 ä¸­ï¼ä»å°å°å¤§æåçç¬¬ 1.5 äº¿ä¸ªæ°ä¸å®åé¢çä¸ä¸ªæ°çå¹³åå¼ã\n\n> æç¤ºï¼5 äº¿æ°çä¸­ä½æ°æ¯ç¬¬ 2.5 äº¿ä¸å³è¾¹ç¸é»ä¸ä¸ªæ°æ±å¹³åå¼ãè¥ f1 æä¸äº¿ä¸ªæ°ï¼é£ä¹ä¸­ä½æ°å°±æ¯ f0 ä¸­ä»ç¬¬ 1.5 äº¿ä¸ªæ°å¼å§çä¸¤ä¸ªæ°æ±å¾çå¹³åå¼ã\n\nå¯¹äº f0 å¯ä»¥ç¨æ¬¡é«ä½çäºè¿å¶ç»§ç»­å°æä»¶ä¸åä¸ºäºï¼å¦æ­¤ååä¸å»ï¼ç´å°åååçæä»¶å¯ä»¥è¢«å è½½å°åå­ä¸­ï¼ææ°æ®å è½½å°åå­ä¸­ä»¥åç´æ¥æåºï¼æ¾åºä¸­ä½æ°ã\n\n> æ³¨æï¼å½æ°æ®æ»æ°ä¸ºå¶æ°ï¼å¦æåååä¸¤ä¸ªæä»¶ä¸­çæ°æ®æç¸åä¸ªæ°ï¼é£ä¹ä¸­ä½æ°å°±æ¯æ°æ®è¾å°çæä»¶ä¸­çæå¤§å¼ä¸æ°æ®è¾å¤§çæä»¶ä¸­çæå°å¼çå¹³åå¼ã\n\n\n# æ¹æ³æ»ç»\n\nåæ²»æ³ï¼çé¦ï¼\n\n\n# å¦ä½æ¾åºæåå 500 çæ°ï¼\n\n\n# é¢ç®æè¿°\n\næ 20 ä¸ªæ°ç»ï¼æ¯ä¸ªæ°ç»æ 500 ä¸ªåç´ ï¼å¹¶ä¸æåºæåãå¦ä½å¨è¿ 20*500 ä¸ªæ°ä¸­æ¾åºå 500 çæ°ï¼\n\n\n# è§£ç­æè·¯\n\nå¯¹äº TopK é®é¢ï¼æå¸¸ç¨çæ¹æ³æ¯ä½¿ç¨å æåºãå¯¹æ¬é¢èè¨ï¼åè®¾æ°ç»éåºæåï¼å¯ä»¥éç¨ä»¥ä¸æ¹æ³ï¼\n\né¦åå»ºç«å¤§é¡¶å ï¼å çå¤§å°ä¸ºæ°ç»çä¸ªæ°ï¼å³ä¸º 20ï¼ææ¯ä¸ªæ°ç»æå¤§çå¼å­å°å ä¸­ã\n\næ¥çå é¤å é¡¶åç´ ï¼ä¿å­å°å¦ä¸ä¸ªå¤§å°ä¸º 500 çæ°ç»ä¸­ï¼ç¶ååå¤§é¡¶å æå¥å é¤çåç´ æå¨æ°ç»çä¸ä¸ä¸ªåç´ ã\n\néå¤ä¸é¢çæ­¥éª¤ï¼ç´å°å é¤å®ç¬¬ 500 ä¸ªåç´ ï¼ä¹å³æ¾åºäºæå¤§çå 500 ä¸ªæ°ã\n\n> ä¸ºäºå¨å ä¸­ååºä¸ä¸ªæ°æ®åï¼è½ç¥éå®æ¯ä»åªä¸ªæ°ç»ä¸­ååºçï¼ä»èå¯ä»¥ä»è¿ä¸ªæ°ç»ä¸­åä¸ä¸ä¸ªå¼ï¼å¯ä»¥ææ°ç»çæéå­æ¾å°å ä¸­ï¼å¯¹è¿ä¸ªæéæä¾æ¯è¾å¤§å°çæ¹æ³ã\n\nimport lombok.Data;\n\nimport java.util.Arrays;\nimport java.util.PriorityQueue;\n\n/**\n * @author https://github.com/yanglbme\n */\n@Data\npublic class DataWithSource implements Comparable<DataWithSource> {\n    /**\n     * æ°å¼\n     */\n    private int value;\n\n    /**\n     * è®°å½æ°å¼æ¥æºçæ°ç»\n     */\n    private int source;\n\n    /**\n     * è®°å½æ°å¼å¨æ°ç»ä¸­çç´¢å¼\n     */\n    private int index;\n\n    public DataWithSource(int value, int source, int index) {\n        this.value = value;\n        this.source = source;\n        this.index = index;\n    }\n\n    /**\n     *\n     * ç±äº PriorityQueue ä½¿ç¨å°é¡¶å æ¥å®ç°ï¼è¿ééè¿ä¿®æ¹\n     * ä¸¤ä¸ªæ´æ°çæ¯è¾é»è¾æ¥è®© PriorityQueue åæå¤§é¡¶å \n     */\n    @Override\n    public int compareTo(DataWithSource o) {\n        return Integer.compare(o.getValue(), this.value);\n    }\n}\n\n\nclass Test {\n    public static int[] getTop(int[][] data) {\n        int rowSize = data.length;\n        int columnSize = data[0].length;\n\n        // åå»ºä¸ä¸ªcolumnSizeå¤§å°çæ°ç»ï¼å­æ¾ç»æ\n        int[] result = new int[columnSize];\n\n        PriorityQueue<DataWithSource> maxHeap = new PriorityQueue<>();\n        for (int i = 0; i < rowSize; ++i) {\n            // å°æ¯ä¸ªæ°ç»çæå¤§ä¸ä¸ªåç´ æ¾å¥å ä¸­\n            DataWithSource d = new DataWithSource(data[i][0], i, 0);\n            maxHeap.add(d);\n        }\n\n        int num = 0;\n        while (num < columnSize) {\n            // å é¤å é¡¶åç´ \n            DataWithSource d = maxHeap.poll();\n            result[num++] = d.getValue();\n            if (num >= columnSize) {\n                break;\n            }\n\n            d.setValue(data[d.getSource()][d.getIndex() + 1]);\n            d.setIndex(d.getIndex() + 1);\n            maxHeap.add(d);\n        }\n        return result;\n\n    }\n\n    public static void main(String[] args) {\n        int[][] data = {\n                {29, 17, 14, 2, 1},\n                {19, 17, 16, 15, 6},\n                {30, 25, 20, 14, 5},\n        };\n\n        int[] top = getTop(data);\n        System.out.println(Arrays.toString(top)); // [30, 29, 25, 20, 19]\n    }\n}\n\n\n\n# æ¹æ³æ»ç»\n\næ± TopKï¼ä¸å¦¨èèä¸ä¸å æåºï¼\n\n\n# å¦ä½æç§ query çé¢åº¦æåºï¼\n\n\n# é¢ç®æè¿°\n\næ 10 ä¸ªæä»¶ï¼æ¯ä¸ªæä»¶å¤§å°ä¸º 1Gï¼æ¯ä¸ªæä»¶çæ¯ä¸è¡å­æ¾çé½æ¯ç¨æ·ç queryï¼æ¯ä¸ªæä»¶ç query é½å¯è½éå¤ãè¦æ±æç§ query çé¢åº¦æåºã\n\n\n# è§£ç­æè·¯\n\nå¦æ query çéå¤åº¦æ¯è¾å¤§ï¼å¯ä»¥èèä¸æ¬¡æ§æææ query è¯»å¥åå­ä¸­å¤çï¼å¦æ query çéå¤çä¸é«ï¼é£ä¹å¯ç¨åå­ä¸è¶³ä»¥å®¹çº³ææç queryï¼è¿æ¶åå°±éè¦éç¨åæ²»æ³æå¶ä»çæ¹æ³æ¥è§£å³ã\n\n# æ¹æ³ä¸ï¼HashMap æ³\n\nå¦æ query éå¤çé«ï¼è¯´æä¸å query æ»æ°æ¯è¾å°ï¼å¯ä»¥èèæææç query é½å è½½å°åå­ä¸­ç HashMap ä¸­ãæ¥çå°±å¯ä»¥æç§ query åºç°çæ¬¡æ°è¿è¡æåºã\n\n# æ¹æ³äºï¼åæ²»æ³\n\nåæ²»æ³éè¦æ ¹æ®æ°æ®éå¤§å°ä»¥åå¯ç¨åå­çå¤§å°æ¥ç¡®å®é®é¢ååçè§æ¨¡ãå¯¹äºè¿éé¢ï¼å¯ä»¥é¡ºåºéå 10 ä¸ªæä»¶ä¸­ç queryï¼éè¿ Hash å½æ° hash(query) % 10 æè¿äº query ååå° 10 ä¸ªå°æä»¶ä¸­ãä¹åå¯¹æ¯ä¸ªå°æä»¶ä½¿ç¨ HashMap ç»è®¡ query åºç°æ¬¡æ°ï¼æ ¹æ®æ¬¡æ°æåºå¹¶åå¥å°é¶å¤ä¸ä¸ªåç¬æä»¶ä¸­ã\n\næ¥çå¯¹æææä»¶æç§ query çæ¬¡æ°è¿è¡æåºï¼è¿éå¯ä»¥ä½¿ç¨å½å¹¶æåºï¼ç±äºæ æ³æææ query é½è¯»å¥åå­ï¼å æ­¤éè¦ä½¿ç¨å¤æåºï¼ã\n\n\n# æ¹æ³æ»ç»\n\n * åå­è¥å¤ï¼ç´æ¥è¯»å¥è¿è¡æåºï¼\n * åå­ä¸å¤ï¼åååä¸ºå°æä»¶ï¼å°æä»¶æå¥½åºåï¼æ´çä½¿ç¨å¤æåºè¿è¡å½å¹¶ã",normalizedContent:"# æµ·éæ°æ®å¤ç\n\n\n# å¦ä½ä»æµ·éç url ä¸­æ¾åºç¸åç urlï¼\n\n\n# é®é¢æè¿°\n\nç»å® aãb ä¸¤ä¸ªæä»¶ï¼åå­æ¾ 50 äº¿ä¸ª urlï¼æ¯ä¸ª url åå  64bï¼åå­éå¶æ¯ 4gãè¯·æ¾åº aãb ä¸¤ä¸ªæä»¶å±åç urlã\n\n\n# è§£å³æè·¯\n\næ¯ä¸ª url å  64bï¼é£ä¹ 50 äº¿ä¸ª url å ç¨çç©ºé´å¤§å°çº¦ä¸º 320gbã\n\n> $$5,000,000,000 * 64 b â 5 gb * 64 = 320 gb$$\n\nç±äºåå­å¤§å°åªæ 4gï¼å æ­¤ï¼æä»¬ä¸å¯è½ä¸æ¬¡æ§æææ url å è½½å°åå­ä¸­å¤çãå¯¹äºè¿ç§ç±»åçé¢ç®ï¼ä¸è¬éç¨åæ²»ç­ç¥ï¼å³ï¼æä¸ä¸ªæä»¶ä¸­ç url æç§æä¸ªç¹å¾ååä¸ºå¤ä¸ªå°æä»¶ï¼ä½¿å¾æ¯ä¸ªå°æä»¶å¤§å°ä¸è¶è¿ 4gï¼è¿æ ·å°±å¯ä»¥æè¿ä¸ªå°æä»¶è¯»å°åå­ä¸­è¿è¡å¤çäºã\n\næè·¯å¦ä¸ï¼\n\né¦åéåæä»¶ aï¼å¯¹éåå°ç url æ± hash(url) % 1000ï¼æ ¹æ®è®¡ç®ç»ææéåå°ç url å­å¨å° a0, a1, a2, ..., a999ï¼è¿æ ·æ¯ä¸ªå¤§å°çº¦ä¸º 300mbãä½¿ç¨åæ ·çæ¹æ³éåæä»¶ bï¼ææä»¶ b ä¸­ç url åå«å­å¨å°æä»¶ b0, b1, b2, ..., b999 ä¸­ãè¿æ ·å¤çè¿åï¼ææå¯è½ç¸åç url é½å¨å¯¹åºçå°æä»¶ä¸­ï¼å³ a0 å¯¹åº b0, ..., a999 å¯¹åº b999ï¼ä¸å¯¹åºçå°æä»¶ä¸å¯è½æç¸åç urlãé£ä¹æ¥ä¸æ¥ï¼æä»¬åªéè¦æ±åºè¿ 1000 å¯¹å°æä»¶ä¸­ç¸åç url å°±å¥½äºã\n\næ¥çéå ai( iâ[0,999])ï¼æ url å­å¨å°ä¸ä¸ª hashset éåä¸­ãç¶åéå bi ä¸­æ¯ä¸ª urlï¼çå¨ hashset éåä¸­æ¯å¦å­å¨ï¼è¥å­å¨ï¼è¯´æè¿å°±æ¯å±åç urlï¼å¯ä»¥æè¿ä¸ª url ä¿å­å°ä¸ä¸ªåç¬çæä»¶ä¸­ã\n\n\n# æ¹æ¡æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * å¯¹æ¯ä¸ªå­æä»¶è¿è¡ hashset ç»è®¡ã\n\n\n# å¦ä½ä»æµ·éæ°æ®ä¸­æ¾åºé«é¢è¯ï¼\n\n\n# é®é¢æè¿°\n\næä¸ä¸ª 1gb å¤§å°çæä»¶ï¼æä»¶éæ¯ä¸è¡æ¯ä¸ä¸ªè¯ï¼æ¯ä¸ªè¯çå¤§å°ä¸è¶è¿ 16bï¼åå­å¤§å°éå¶æ¯ 1mbï¼è¦æ±è¿åé¢æ°æé«ç 100 ä¸ªè¯(top 100)ã\n\n\n# è§£å³æè·¯\n\nç±äºåå­éå¶ï¼æ æ³ç´æ¥å°å¤§æä»¶çææè¯ä¸æ¬¡è¯»å°åå­ä¸­ãå æ­¤ï¼å¯ä»¥éç¨åæ²»ç­ç¥ï¼æä¸ä¸ªå¤§æä»¶åè§£æå¤ä¸ªå°æä»¶ï¼ä¿è¯æ¯ä¸ªæä»¶çå¤§å°å°äº 1mbï¼è¿èç´æ¥å°åä¸ªå°æä»¶è¯»åå°åå­ä¸­è¿è¡å¤çã\n\næè·¯å¦ä¸ï¼\n\né¦åéåå¤§æä»¶ï¼å¯¹éåå°çæ¯ä¸ªè¯ xï¼æ§è¡ hash(x) % 5000ï¼å°ç»æä¸º i çè¯å­æ¾å°æä»¶ ai ä¸­ãéåç»æåï¼æä»¬å¯ä»¥å¾å° 5000 ä¸ªå°æä»¶ãæ¯ä¸ªå°æä»¶çå¤§å°ä¸º 200kb å·¦å³ãå¦ææçå°æä»¶å¤§å°ä»ç¶è¶è¿ 1mbï¼åéç¨åæ ·çæ¹å¼ç»§ç»­è¿è¡åè§£ã\n\næ¥çç»è®¡æ¯ä¸ªå°æä»¶ä¸­åºç°é¢æ°æé«ç 100 ä¸ªè¯ãæç®åçæ¹å¼æ¯ä½¿ç¨ hashmap æ¥å®ç°ãå¶ä¸­ key ä¸ºè¯ï¼value ä¸ºè¯¥è¯åºç°çé¢çãå·ä½æ¹æ³æ¯ï¼å¯¹äºéåå°çè¯ xï¼å¦æå¨ map ä¸­ä¸å­å¨ï¼åæ§è¡ map.put(x, 1) è¥å­å¨ï¼åæ§è¡ map.put(x, map.get(x)+1)ï¼å°è¯¥è¯é¢æ°å  1ã\n\nä¸é¢æä»¬ç»è®¡äºæ¯ä¸ªå°æä»¶åè¯åºç°çé¢æ°ãæ¥ä¸æ¥ï¼æä»¬å¯ä»¥éè¿ç»´æ¤ä¸ä¸ªå°é¡¶å æ¥æ¾åºææè¯ä¸­åºç°é¢æ°æé«ç 100 ä¸ªãå·ä½æ¹æ³æ¯ï¼ä¾æ¬¡éåæ¯ä¸ªå°æä»¶ï¼æå»ºä¸ä¸ªå°é¡¶å ï¼å å¤§å°ä¸º 100ãå¦æéåå°çè¯çåºç°æ¬¡æ°å¤§äºå é¡¶è¯çåºç°æ¬¡æ°ï¼åç¨æ°è¯æ¿æ¢å é¡¶çè¯ï¼ç¶åéæ°è°æ´ä¸ºå°é¡¶å ï¼éåç»æåï¼å°é¡¶å ä¸çè¯å°±æ¯åºç°é¢æ°æé«ç 100 ä¸ªè¯ã\n\n\n# æ¹æ¡æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * ä½¿ç¨ hashmap ç»è®¡é¢æ°ï¼\n * æ±è§£æå¤§ç topn ä¸ªï¼ç¨å°é¡¶å ï¼æ±è§£æå°ç topn ä¸ªï¼ç¨å¤§é¡¶å ã\n\n\n# å¦ä½æ¾åºæä¸å¤©è®¿é®ç¾åº¦ç½ç«æå¤ç ipï¼\n\n\n# é®é¢æè¿°\n\nç°ææµ·éæ¥å¿æ°æ®ä¿å­å¨ä¸ä¸ªè¶å¤§æä»¶ä¸­ï¼è¯¥æä»¶æ æ³ç´æ¥è¯»å¥åå­ï¼è¦æ±ä»ä¸­æåæå¤©è®¿é®ç¾åº¦æ¬¡æ°æå¤çé£ä¸ª ipã\n\n\n# è§£å³æè·¯\n\nè¿éé¢åªå³å¿æä¸å¤©è®¿é®ç¾åº¦æå¤ç ipï¼å æ­¤ï¼å¯ä»¥é¦åå¯¹æä»¶è¿è¡ä¸æ¬¡éåï¼æè¿ä¸å¤©è®¿é®ç¾åº¦ ip çç¸å³ä¿¡æ¯è®°å½å°ä¸ä¸ªåç¬çå¤§æä»¶ä¸­ãæ¥ä¸æ¥éç¨çæ¹æ³ä¸ä¸ä¸é¢ä¸æ ·ï¼å¤§è´å°±æ¯åå¯¹ ip è¿è¡åå¸æ å°ï¼æ¥çä½¿ç¨ hashmap ç»è®¡éå¤ ip çæ¬¡æ°ï¼æåè®¡ç®åºéå¤æ¬¡æ°æå¤ç ipã\n\n> æ³¨ï¼è¿éåªéè¦æ¾åºåºç°æ¬¡æ°æå¤ç ipï¼å¯ä»¥ä¸å¿ä½¿ç¨å ï¼ç´æ¥ç¨ä¸ä¸ªåé max å³å¯ã\n\n\n# æ¹æ³æ»ç»\n\n * åèæ²»ä¹ï¼è¿è¡åå¸åä½ï¼\n * ä½¿ç¨ hashmap ç»è®¡é¢æ°ï¼\n * æ±è§£æå¤§ç topn ä¸ªï¼ç¨å°é¡¶å ï¼æ±è§£æå°ç topn ä¸ªï¼ç¨å¤§é¡¶å ã\n\n\n# å¦ä½å¨å¤§éçæ°æ®ä¸­æ¾åºä¸éå¤çæ´æ°ï¼\n\n\n# é®é¢æè¿°\n\nå¨ 2.5 äº¿ä¸ªæ´æ°ä¸­æ¾åºä¸éå¤çæ´æ°ãæ³¨æï¼åå­ä¸è¶³ä»¥å®¹çº³è¿ 2.5 äº¿ä¸ªæ´æ°ã\n\n\n# è§£å³æè·¯\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nä¸åé¢çé¢ç®æ¹æ³ç±»ä¼¼ï¼åå° 2.5 äº¿ä¸ªæ°ååå°å¤ä¸ªå°æä»¶ï¼ç¨ hashset/hashmap æ¾åºæ¯ä¸ªå°æä»¶ä¸­ä¸éå¤çæ´æ°ï¼ååå¹¶æ¯ä¸ªå­ç»æï¼å³ä¸ºæç»ç»æã\n\n# æ¹æ³äºï¼ä½å¾æ³\n\nä½å¾ï¼å°±æ¯ç¨ä¸ä¸ªæå¤ä¸ª bit æ¥æ è®°æä¸ªåç´ å¯¹åºçå¼ï¼èé®å°±æ¯è¯¥åç´ ãéç¨ä½ä½ä¸ºåä½æ¥å­å¨æ°æ®ï¼å¯ä»¥å¤§å¤§èçå­å¨ç©ºé´ã\n\nä½å¾éè¿ä½¿ç¨ä½æ°ç»æ¥è¡¨ç¤ºæäºåç´ æ¯å¦å­å¨ãå®å¯ä»¥ç¨äºå¿«éæ¥æ¾ï¼å¤éï¼æåºç­ãä¸æ¯å¾æ¸æ¥ï¼æåä¸¾ä¸ªå°ä¾å­ã\n\nåè®¾æä»¬è¦å¯¹ [0,7] ä¸­ç 5 ä¸ªåç´  (6, 4, 2, 1, 5) è¿è¡æåºï¼å¯ä»¥éç¨ä½å¾æ³ã0~7 èå´æ»å±æ 8 ä¸ªæ°ï¼åªéè¦ 8bitï¼å³ 1 ä¸ªå­èãé¦åå°æ¯ä¸ªä½é½ç½® 0ï¼\n\n0 0 0 0 0 0 0 0\n\n\nç¶åéå 5 ä¸ªåç´ ï¼é¦åéå° 6ï¼é£ä¹å°ä¸æ ä¸º 6 çä½ç 0 ç½®ä¸º 1ï¼æ¥çéå° 4ï¼æä¸æ ä¸º 4 çä½ ç 0 ç½®ä¸º 1ï¼\n\n0 0 0 0 1 0 1 0\n\n\nä¾æ¬¡éåï¼ç»æåï¼ä½æ°ç»æ¯è¿æ ·çï¼\n\n0 1 1 0 1 1 1 0\n\n\næ¯ä¸ªä¸º 1 çä½ï¼å®çä¸æ é½è¡¨ç¤ºäºä¸ä¸ªæ°ï¼\n\nfor i in range(8):\n    if bits[i] == 1:\n        print(i)\n\n\nè¿æ ·æä»¬å¶å®å°±å·²ç»å®ç°äºæåºã\n\nå¯¹äºæ´æ°ç¸å³çç®æ³çæ±è§£ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸å®ç¨çç®æ³ãåè®¾ int æ´æ°å ç¨ 4bï¼å³ 32bitï¼é£ä¹æä»¬å¯ä»¥è¡¨ç¤ºçæ´æ°çä¸ªæ°ä¸º 232ã\n\né£ä¹å¯¹äºè¿éé¢ï¼æä»¬ç¨ 2 ä¸ª bit æ¥è¡¨ç¤ºåä¸ªæ°å­çç¶æï¼\n\n * 00 è¡¨ç¤ºè¿ä¸ªæ°å­æ²¡åºç°è¿ï¼\n * 01 è¡¨ç¤ºè¿ä¸ªæ°å­åºç°è¿ä¸æ¬¡ï¼å³ä¸ºé¢ç®ææ¾çä¸éå¤æ´æ°ï¼ï¼\n * 10 è¡¨ç¤ºè¿ä¸ªæ°å­åºç°äºå¤æ¬¡ã\n\né£ä¹è¿ 232 ä¸ªæ´æ°ï¼æ»å±æéåå­ä¸º 232*2b=1gbãå æ­¤ï¼å½å¯ç¨åå­è¶è¿ 1gb æ¶ï¼å¯ä»¥éç¨ä½å¾æ³ãåè®¾åå­æ»¡è¶³ä½å¾æ³éæ±ï¼è¿è¡ä¸é¢çæä½ï¼\n\néå 2.5 äº¿ä¸ªæ´æ°ï¼æ¥çä½å¾ä¸­å¯¹åºçä½ï¼å¦ææ¯ 00ï¼ååä¸º 01ï¼å¦ææ¯ 01 ååä¸º 10ï¼å¦ææ¯ 10 åä¿æä¸åãéåç»æåï¼æ¥çä½å¾ï¼æå¯¹åºä½æ¯ 01 çæ´æ°è¾åºå³å¯ã\n\n\n# æ¹æ³æ»ç»\n\nå¤æ­æ°å­æ¯å¦éå¤çé®é¢ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸é«æçæ¹æ³ã\n\n\n# å¦ä½å¨å¤§éçæ°æ®ä¸­å¤æ­ä¸ä¸ªæ°æ¯å¦å­å¨ï¼\n\n\n# é¢ç®æè¿°\n\nç»å® 40 äº¿ä¸ªä¸éå¤çæ²¡æè¿åºç unsigned int åæ´æ°ï¼ç¶ååç»å®ä¸ä¸ªæ°ï¼å¦ä½å¿«éå¤æ­è¿ä¸ªæ°æ¯å¦å¨è¿ 40 äº¿ä¸ªæ´æ°å½ä¸­ï¼\n\n\n# è§£ç­æè·¯\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nä¾ç¶å¯ä»¥ç¨åæ²»æ³è§£å³ï¼æ¹æ³ä¸åé¢ç±»ä¼¼ï¼å°±ä¸åæ¬¡èµè¿°äºã\n\n# æ¹æ³äºï¼ä½å¾æ³\n\n40 äº¿ä¸ªä¸éå¤æ´æ°ï¼æä»¬ç¨ 40 äº¿ä¸ª bit æ¥è¡¨ç¤ºï¼åå§ä½åä¸º 0ï¼é£ä¹æ»å±éè¦åå­ï¼4,000,000,000bâ512mã\n\næä»¬è¯»åè¿ 40 äº¿ä¸ªæ´æ°ï¼å°å¯¹åºç bit è®¾ç½®ä¸º 1ãæ¥çè¯»åè¦æ¥è¯¢çæ°ï¼æ¥çç¸åºä½æ¯å¦ä¸º 1ï¼å¦æä¸º 1 è¡¨ç¤ºå­å¨ï¼å¦æä¸º 0 è¡¨ç¤ºä¸å­å¨ã\n\n\n# æ¹æ³æ»ç»\n\nå¤æ­æ°å­æ¯å¦å­å¨ãå¤æ­æ°å­æ¯å¦éå¤çé®é¢ï¼ä½å¾æ³æ¯ä¸ç§éå¸¸é«æçæ¹æ³ã\n\n\n# å¦ä½æ¥è¯¢æç­é¨çæ¥è¯¢ä¸²ï¼\n\n\n# é¢ç®æè¿°\n\næç´¢å¼æä¼éè¿æ¥å¿æä»¶æç¨æ·æ¯æ¬¡æ£ç´¢ä½¿ç¨çæææ¥è¯¢ä¸²é½è®°å½ä¸æ¥ï¼æ¯ä¸ªæ¥è¯¢ä¸²çé¿åº¦ä¸è¶è¿ 255 å­èã\n\nåè®¾ç®åæ 1000w ä¸ªè®°å½ï¼è¿äºæ¥è¯¢ä¸²çéå¤åº¦æ¯è¾é«ï¼è½ç¶æ»æ°æ¯ 1000wï¼ä½å¦æé¤å»éå¤åï¼åä¸è¶è¿ 300w ä¸ªï¼ãè¯·ç»è®¡æç­é¨ç 10 ä¸ªæ¥è¯¢ä¸²ï¼è¦æ±ä½¿ç¨çåå­ä¸è½è¶è¿ 1gãï¼ä¸ä¸ªæ¥è¯¢ä¸²çéå¤åº¦è¶é«ï¼è¯´ææ¥è¯¢å®çç¨æ·è¶å¤ï¼ä¹å°±è¶ç­é¨ãï¼\n\n\n# è§£ç­æè·¯\n\næ¯ä¸ªæ¥è¯¢ä¸²æé¿ä¸º 255bï¼1000w ä¸ªä¸²éè¦å ç¨ çº¦ 2.55g åå­ï¼å æ­¤ï¼æä»¬æ æ³å°ææå­ç¬¦ä¸²å¨é¨è¯»å¥å°åå­ä¸­å¤çã\n\n# æ¹æ³ä¸ï¼åæ²»æ³\n\nåæ²»æ³ä¾ç¶æ¯ä¸ä¸ªéå¸¸å®ç¨çæ¹æ³ã\n\nååä¸ºå¤ä¸ªå°æä»¶ï¼ä¿è¯åä¸ªå°æä»¶ä¸­çå­ç¬¦ä¸²è½è¢«ç´æ¥å è½½å°åå­ä¸­å¤çï¼ç¶åæ±åºæ¯ä¸ªæä»¶ä¸­åºç°æ¬¡æ°æå¤ç 10 ä¸ªå­ç¬¦ä¸²ï¼æåéè¿ä¸ä¸ªå°é¡¶å ç»è®¡åºæææä»¶ä¸­åºç°æå¤ç 10 ä¸ªå­ç¬¦ä¸²ã\n\næ¹æ³å¯è¡ï¼ä½ä¸æ¯æå¥½ï¼ä¸é¢ä»ç»å¶ä»æ¹æ³ã\n\n# æ¹æ³äºï¼hashmap æ³\n\nè½ç¶å­ç¬¦ä¸²æ»æ°æ¯è¾å¤ï¼ä½å»éåä¸è¶è¿ 300wï¼å æ­¤ï¼å¯ä»¥èèæææå­ç¬¦ä¸²ååºç°æ¬¡æ°ä¿å­å¨ä¸ä¸ª hashmap ä¸­ï¼æå ç¨çç©ºé´ä¸º 300w*(255+4)â777mï¼å¶ä¸­ï¼4 è¡¨ç¤ºæ´æ°å ç¨ç 4 ä¸ªå­èï¼ãç±æ­¤å¯è§ï¼1g çåå­ç©ºé´å®å¨å¤ç¨ã\n\næè·¯å¦ä¸ï¼\n\né¦åï¼éåå­ç¬¦ä¸²ï¼è¥ä¸å¨ map ä¸­ï¼ç´æ¥å­å¥ mapï¼value è®°ä¸º 1ï¼è¥å¨ map ä¸­ï¼åæå¯¹åºç value å  1ï¼è¿ä¸æ­¥æ¶é´å¤æåº¦ o(n)ã\n\næ¥çéå mapï¼æå»ºä¸ä¸ª 10 ä¸ªåç´ çå°é¡¶å ï¼è¥éåå°çå­ç¬¦ä¸²çåºç°æ¬¡æ°å¤§äºå é¡¶å­ç¬¦ä¸²çåºç°æ¬¡æ°ï¼åè¿è¡æ¿æ¢ï¼å¹¶å°å è°æ´ä¸ºå°é¡¶å ã\n\néåç»æåï¼å ä¸­ 10 ä¸ªå­ç¬¦ä¸²å°±æ¯åºç°æ¬¡æ°æå¤çå­ç¬¦ä¸²ãè¿ä¸æ­¥æ¶é´å¤æåº¦ o(nlog10)ã\n\n# æ¹æ³ä¸ï¼åç¼æ æ³ï¼å­å¸æ ï¼\n\næ¹æ³äºä½¿ç¨äº hashmap æ¥ç»è®¡æ¬¡æ°ï¼å½è¿äºå­ç¬¦ä¸²æå¤§éç¸ååç¼æ¶ï¼å¯ä»¥èèä½¿ç¨åç¼æ æ¥ç»è®¡å­ç¬¦ä¸²åºç°çæ¬¡æ°ï¼æ çç»ç¹ä¿å­å­ç¬¦ä¸²åºç°æ¬¡æ°ï¼0 è¡¨ç¤ºæ²¡æåºç°ã\n\næè·¯å¦ä¸ï¼\n\nå¨éåå­ç¬¦ä¸²æ¶ï¼å¨åç¼æ ä¸­æ¥æ¾ï¼å¦ææ¾å°ï¼åæç»ç¹ä¸­ä¿å­çå­ç¬¦ä¸²æ¬¡æ°å  1ï¼å¦åä¸ºè¿ä¸ªå­ç¬¦ä¸²æå»ºæ°ç»ç¹ï¼æå»ºå®æåæå¶å­ç»ç¹ä¸­å­ç¬¦ä¸²çåºç°æ¬¡æ°ç½®ä¸º 1ã\n\næåä¾ç¶ä½¿ç¨å°é¡¶å æ¥å¯¹å­ç¬¦ä¸²çåºç°æ¬¡æ°è¿è¡æåºã\n\n\n# æ¹æ³æ»ç»\n\nåç¼æ ç»å¸¸è¢«ç¨æ¥ç»è®¡å­ç¬¦ä¸²çåºç°æ¬¡æ°ãå®çå¦å¤ä¸ä¸ªå¤§çç¨éæ¯å­ç¬¦ä¸²æ¥æ¾ï¼å¤æ­æ¯å¦æéå¤çå­ç¬¦ä¸²ç­ã\n\n\n# å¦ä½ç»è®¡ä¸åçµè¯å·ç çä¸ªæ°ï¼\n\n\n# é¢ç®æè¿°\n\nå·²ç¥æä¸ªæä»¶ååå«ä¸äºçµè¯å·ç ï¼æ¯ä¸ªå·ç ä¸º 8 ä½æ°å­ï¼ç»è®¡ä¸åå·ç çä¸ªæ°ã\n\n\n# è§£ç­æè·¯\n\nè¿éé¢æ¬è´¨è¿æ¯æ±è§£æ°æ®éå¤çé®é¢ï¼å¯¹äºè¿ç±»é®é¢ï¼ä¸è¬é¦åèèä½å¾æ³ã\n\nå¯¹äºæ¬é¢ï¼8 ä½çµè¯å·ç å¯ä»¥è¡¨ç¤ºçå·ç ä¸ªæ°ä¸º $$10^8$$ ä¸ªï¼å³ 1 äº¿ä¸ªãæä»¬æ¯ä¸ªå·ç ç¨ä¸ä¸ª bit æ¥è¡¨ç¤ºï¼åæ»å±éè¦ 1 äº¿ä¸ª bitï¼åå­å ç¨çº¦ 100mã\n\næè·¯å¦ä¸ï¼\n\nç³è¯·ä¸ä¸ªä½å¾æ°ç»ï¼é¿åº¦ä¸º 1 äº¿ï¼åå§åä¸º 0ãç¶åéåææçµè¯å·ç ï¼æå·ç å¯¹åºçä½å¾ä¸­çä½ç½®ç½®ä¸º 1ãéåå®æåï¼å¦æ bit ä¸º 1ï¼åè¡¨ç¤ºè¿ä¸ªçµè¯å·ç å¨æä»¶ä¸­å­å¨ï¼å¦åä¸å­å¨ãbit å¼ä¸º 1 çæ°éå³ä¸º ä¸åçµè¯å·ç çä¸ªæ°ã\n\n\n# æ¹æ³æ»ç»\n\næ±è§£æ°æ®éå¤é®é¢ï¼è®°å¾èèä½å¾æ³ã\n\n\n# å¦ä½ä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ï¼\n\n\n# é¢ç®æè¿°\n\nä» 5 äº¿ä¸ªæ°ä¸­æ¾åºä¸­ä½æ°ãæ°æ®æåºåï¼ä½ç½®å¨æä¸­é´çæ°å°±æ¯ä¸­ä½æ°ãå½æ ·æ¬æ°ä¸ºå¥æ°æ¶ï¼ä¸­ä½æ°ä¸º ç¬¬ (n+1)/2 ä¸ªæ°ï¼å½æ ·æ¬æ°ä¸ºå¶æ°æ¶ï¼ä¸­ä½æ°ä¸º ç¬¬ n/2 ä¸ªæ°ä¸ç¬¬ 1+n/2 ä¸ªæ°çåå¼ã\n\n\n# è§£ç­æè·¯\n\nå¦æè¿éé¢æ²¡æåå­å¤§å°éå¶ï¼åå¯ä»¥ææææ°è¯»å°åå­ä¸­æåºåæ¾åºä¸­ä½æ°ãä½æ¯æå¥½çæåºç®æ³çæ¶é´å¤æåº¦é½ä¸º o(nlogn)ãè¿éä½¿ç¨å¶ä»æ¹æ³ã\n\n# æ¹æ³ä¸ï¼åå æ³\n\nç»´æ¤ä¸¤ä¸ªå ï¼ä¸ä¸ªå¤§é¡¶å ï¼ä¸ä¸ªå°é¡¶å ãå¤§é¡¶å ä¸­æå¤§çæ°å°äºç­äºå°é¡¶å ä¸­æå°çæ°ï¼ä¿è¯è¿ä¸¤ä¸ªå ä¸­çåç´ ä¸ªæ°çå·®ä¸è¶è¿ 1ã\n\nè¥æ°æ®æ»æ°ä¸ºå¶æ°ï¼å½è¿ä¸¤ä¸ªå å»ºå¥½ä¹åï¼ä¸­ä½æ°å°±æ¯è¿ä¸¤ä¸ªå é¡¶åç´ çå¹³åå¼ãå½æ°æ®æ»æ°ä¸ºå¥æ°æ¶ï¼æ ¹æ®ä¸¤ä¸ªå çå¤§å°ï¼ä¸­ä½æ°ä¸å®å¨æ°æ®å¤çå çå é¡¶ã\n\nclass medianfinder {\n\n    private priorityqueue<integer> maxheap;\n    private priorityqueue<integer> minheap;\n\n    /** initialize your data structure here. */\n    public medianfinder() {\n        maxheap = new priorityqueue<>(comparator.reverseorder());\n        minheap = new priorityqueue<>(integer::compareto);\n    }\n\n    public void addnum(int num) {\n        if (maxheap.isempty() || maxheap.peek() > num) {\n            maxheap.offer(num);\n        } else {\n            minheap.offer(num);\n        }\n\n        int size1 = maxheap.size();\n        int size2 = minheap.size();\n        if (size1 - size2 > 1) {\n            minheap.offer(maxheap.poll());\n        } else if (size2 - size1 > 1) {\n            maxheap.offer(minheap.poll());\n        }\n    }\n\n    public double findmedian() {\n        int size1 = maxheap.size();\n        int size2 = minheap.size();\n\n        return size1 == size2\n            ? (maxheap.peek() + minheap.peek()) * 1.0 / 2\n            : (size1 > size2 ? maxheap.peek() : minheap.peek());\n    }\n}\n\n\n> è§ leetcode no.295ï¼https://leetcode.com/problems/find-median-from-data-stream/\n\nä»¥ä¸è¿ç§æ¹æ³ï¼éè¦ææææ°æ®é½å è½½å°åå­ä¸­ãå½æ°æ®éå¾å¤§æ¶ï¼å°±ä¸è½è¿æ ·äºï¼å æ­¤ï¼è¿ç§æ¹æ³éç¨äºæ°æ®éè¾å°çæåµã5 äº¿ä¸ªæ°ï¼æ¯ä¸ªæ°å­å ç¨ 4bï¼æ»å±éè¦ 2g åå­ãå¦æå¯ç¨åå­ä¸è¶³ 2gï¼å°±ä¸è½ä½¿ç¨è¿ç§æ¹æ³äºï¼ä¸é¢ä»ç»å¦ä¸ç§æ¹æ³ã\n\n# æ¹æ³äºï¼åæ²»æ³\n\nåæ²»æ³çææ³æ¯æä¸ä¸ªå¤§çé®é¢éæ¸è½¬æ¢ä¸ºè§æ¨¡è¾å°çé®é¢æ¥æ±è§£ã\n\nå¯¹äºè¿éé¢ï¼é¡ºåºè¯»åè¿ 5 äº¿ä¸ªæ°å­ï¼å¯¹äºè¯»åå°çæ°å­ numï¼å¦æå®å¯¹åºçäºè¿å¶ä¸­æé«ä½ä¸º 1ï¼åæè¿ä¸ªæ°å­åå° f1 ä¸­ï¼å¦ååå¥ f0 ä¸­ãéè¿è¿ä¸æ­¥ï¼å¯ä»¥æè¿ 5 äº¿ä¸ªæ°ååä¸ºä¸¤é¨åï¼èä¸ f0 ä¸­çæ°é½å¤§äº f1 ä¸­çæ°ï¼æé«ä½æ¯ç¬¦å·ä½ï¼ã\n\nååä¹åï¼å¯ä»¥éå¸¸å®¹æå°ç¥éä¸­ä½æ°æ¯å¨ f0 è¿æ¯ f1 ä¸­ãåè®¾ f1 ä¸­æ 1 äº¿ä¸ªæ°ï¼é£ä¹ä¸­ä½æ°ä¸å®å¨ f0 ä¸­ï¼ä¸æ¯å¨ f0 ä¸­ï¼ä»å°å°å¤§æåçç¬¬ 1.5 äº¿ä¸ªæ°ä¸å®åé¢çä¸ä¸ªæ°çå¹³åå¼ã\n\n> æç¤ºï¼5 äº¿æ°çä¸­ä½æ°æ¯ç¬¬ 2.5 äº¿ä¸å³è¾¹ç¸é»ä¸ä¸ªæ°æ±å¹³åå¼ãè¥ f1 æä¸äº¿ä¸ªæ°ï¼é£ä¹ä¸­ä½æ°å°±æ¯ f0 ä¸­ä»ç¬¬ 1.5 äº¿ä¸ªæ°å¼å§çä¸¤ä¸ªæ°æ±å¾çå¹³åå¼ã\n\nå¯¹äº f0 å¯ä»¥ç¨æ¬¡é«ä½çäºè¿å¶ç»§ç»­å°æä»¶ä¸åä¸ºäºï¼å¦æ­¤ååä¸å»ï¼ç´å°åååçæä»¶å¯ä»¥è¢«å è½½å°åå­ä¸­ï¼ææ°æ®å è½½å°åå­ä¸­ä»¥åç´æ¥æåºï¼æ¾åºä¸­ä½æ°ã\n\n> æ³¨æï¼å½æ°æ®æ»æ°ä¸ºå¶æ°ï¼å¦æåååä¸¤ä¸ªæä»¶ä¸­çæ°æ®æç¸åä¸ªæ°ï¼é£ä¹ä¸­ä½æ°å°±æ¯æ°æ®è¾å°çæä»¶ä¸­çæå¤§å¼ä¸æ°æ®è¾å¤§çæä»¶ä¸­çæå°å¼çå¹³åå¼ã\n\n\n# æ¹æ³æ»ç»\n\nåæ²»æ³ï¼çé¦ï¼\n\n\n# å¦ä½æ¾åºæåå 500 çæ°ï¼\n\n\n# é¢ç®æè¿°\n\næ 20 ä¸ªæ°ç»ï¼æ¯ä¸ªæ°ç»æ 500 ä¸ªåç´ ï¼å¹¶ä¸æåºæåãå¦ä½å¨è¿ 20*500 ä¸ªæ°ä¸­æ¾åºå 500 çæ°ï¼\n\n\n# è§£ç­æè·¯\n\nå¯¹äº topk é®é¢ï¼æå¸¸ç¨çæ¹æ³æ¯ä½¿ç¨å æåºãå¯¹æ¬é¢èè¨ï¼åè®¾æ°ç»éåºæåï¼å¯ä»¥éç¨ä»¥ä¸æ¹æ³ï¼\n\né¦åå»ºç«å¤§é¡¶å ï¼å çå¤§å°ä¸ºæ°ç»çä¸ªæ°ï¼å³ä¸º 20ï¼ææ¯ä¸ªæ°ç»æå¤§çå¼å­å°å ä¸­ã\n\næ¥çå é¤å é¡¶åç´ ï¼ä¿å­å°å¦ä¸ä¸ªå¤§å°ä¸º 500 çæ°ç»ä¸­ï¼ç¶ååå¤§é¡¶å æå¥å é¤çåç´ æå¨æ°ç»çä¸ä¸ä¸ªåç´ ã\n\néå¤ä¸é¢çæ­¥éª¤ï¼ç´å°å é¤å®ç¬¬ 500 ä¸ªåç´ ï¼ä¹å³æ¾åºäºæå¤§çå 500 ä¸ªæ°ã\n\n> ä¸ºäºå¨å ä¸­ååºä¸ä¸ªæ°æ®åï¼è½ç¥éå®æ¯ä»åªä¸ªæ°ç»ä¸­ååºçï¼ä»èå¯ä»¥ä»è¿ä¸ªæ°ç»ä¸­åä¸ä¸ä¸ªå¼ï¼å¯ä»¥ææ°ç»çæéå­æ¾å°å ä¸­ï¼å¯¹è¿ä¸ªæéæä¾æ¯è¾å¤§å°çæ¹æ³ã\n\nimport lombok.data;\n\nimport java.util.arrays;\nimport java.util.priorityqueue;\n\n/**\n * @author https://github.com/yanglbme\n */\n@data\npublic class datawithsource implements comparable<datawithsource> {\n    /**\n     * æ°å¼\n     */\n    private int value;\n\n    /**\n     * è®°å½æ°å¼æ¥æºçæ°ç»\n     */\n    private int source;\n\n    /**\n     * è®°å½æ°å¼å¨æ°ç»ä¸­çç´¢å¼\n     */\n    private int index;\n\n    public datawithsource(int value, int source, int index) {\n        this.value = value;\n        this.source = source;\n        this.index = index;\n    }\n\n    /**\n     *\n     * ç±äº priorityqueue ä½¿ç¨å°é¡¶å æ¥å®ç°ï¼è¿ééè¿ä¿®æ¹\n     * ä¸¤ä¸ªæ´æ°çæ¯è¾é»è¾æ¥è®© priorityqueue åæå¤§é¡¶å \n     */\n    @override\n    public int compareto(datawithsource o) {\n        return integer.compare(o.getvalue(), this.value);\n    }\n}\n\n\nclass test {\n    public static int[] gettop(int[][] data) {\n        int rowsize = data.length;\n        int columnsize = data[0].length;\n\n        // åå»ºä¸ä¸ªcolumnsizeå¤§å°çæ°ç»ï¼å­æ¾ç»æ\n        int[] result = new int[columnsize];\n\n        priorityqueue<datawithsource> maxheap = new priorityqueue<>();\n        for (int i = 0; i < rowsize; ++i) {\n            // å°æ¯ä¸ªæ°ç»çæå¤§ä¸ä¸ªåç´ æ¾å¥å ä¸­\n            datawithsource d = new datawithsource(data[i][0], i, 0);\n            maxheap.add(d);\n        }\n\n        int num = 0;\n        while (num < columnsize) {\n            // å é¤å é¡¶åç´ \n            datawithsource d = maxheap.poll();\n            result[num++] = d.getvalue();\n            if (num >= columnsize) {\n                break;\n            }\n\n            d.setvalue(data[d.getsource()][d.getindex() + 1]);\n            d.setindex(d.getindex() + 1);\n            maxheap.add(d);\n        }\n        return result;\n\n    }\n\n    public static void main(string[] args) {\n        int[][] data = {\n                {29, 17, 14, 2, 1},\n                {19, 17, 16, 15, 6},\n                {30, 25, 20, 14, 5},\n        };\n\n        int[] top = gettop(data);\n        system.out.println(arrays.tostring(top)); // [30, 29, 25, 20, 19]\n    }\n}\n\n\n\n# æ¹æ³æ»ç»\n\næ± topkï¼ä¸å¦¨èèä¸ä¸å æåºï¼\n\n\n# å¦ä½æç§ query çé¢åº¦æåºï¼\n\n\n# é¢ç®æè¿°\n\næ 10 ä¸ªæä»¶ï¼æ¯ä¸ªæä»¶å¤§å°ä¸º 1gï¼æ¯ä¸ªæä»¶çæ¯ä¸è¡å­æ¾çé½æ¯ç¨æ·ç queryï¼æ¯ä¸ªæä»¶ç query é½å¯è½éå¤ãè¦æ±æç§ query çé¢åº¦æåºã\n\n\n# è§£ç­æè·¯\n\nå¦æ query çéå¤åº¦æ¯è¾å¤§ï¼å¯ä»¥èèä¸æ¬¡æ§æææ query è¯»å¥åå­ä¸­å¤çï¼å¦æ query çéå¤çä¸é«ï¼é£ä¹å¯ç¨åå­ä¸è¶³ä»¥å®¹çº³ææç queryï¼è¿æ¶åå°±éè¦éç¨åæ²»æ³æå¶ä»çæ¹æ³æ¥è§£å³ã\n\n# æ¹æ³ä¸ï¼hashmap æ³\n\nå¦æ query éå¤çé«ï¼è¯´æä¸å query æ»æ°æ¯è¾å°ï¼å¯ä»¥èèæææç query é½å è½½å°åå­ä¸­ç hashmap ä¸­ãæ¥çå°±å¯ä»¥æç§ query åºç°çæ¬¡æ°è¿è¡æåºã\n\n# æ¹æ³äºï¼åæ²»æ³\n\nåæ²»æ³éè¦æ ¹æ®æ°æ®éå¤§å°ä»¥åå¯ç¨åå­çå¤§å°æ¥ç¡®å®é®é¢ååçè§æ¨¡ãå¯¹äºè¿éé¢ï¼å¯ä»¥é¡ºåºéå 10 ä¸ªæä»¶ä¸­ç queryï¼éè¿ hash å½æ° hash(query) % 10 æè¿äº query ååå° 10 ä¸ªå°æä»¶ä¸­ãä¹åå¯¹æ¯ä¸ªå°æä»¶ä½¿ç¨ hashmap ç»è®¡ query åºç°æ¬¡æ°ï¼æ ¹æ®æ¬¡æ°æåºå¹¶åå¥å°é¶å¤ä¸ä¸ªåç¬æä»¶ä¸­ã\n\næ¥çå¯¹æææä»¶æç§ query çæ¬¡æ°è¿è¡æåºï¼è¿éå¯ä»¥ä½¿ç¨å½å¹¶æåºï¼ç±äºæ æ³æææ query é½è¯»å¥åå­ï¼å æ­¤éè¦ä½¿ç¨å¤æåºï¼ã\n\n\n# æ¹æ³æ»ç»\n\n * åå­è¥å¤ï¼ç´æ¥è¯»å¥è¿è¡æåºï¼\n * åå­ä¸å¤ï¼åååä¸ºå°æä»¶ï¼å°æä»¶æå¥½åºåï¼æ´çä½¿ç¨å¤æåºè¿è¡å½å¹¶ã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"çµå",frontmatter:{title:"çµå",date:"2021-08-05T23:42:12.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/49a2bd/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%94%B5%E5%95%86.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/çµå.md",key:"v-adecc362",path:"/pages/49a2bd/",headers:[{level:2,title:"åºæ¬ä¸å¡æ¶æ",slug:"åºæ¬ä¸å¡æ¶æ",normalizedTitle:"åºæ¬ä¸å¡æ¶æ",charIndex:9},{level:3,title:"è®¢å",slug:"è®¢å",normalizedTitle:"è®¢å",charIndex:22},{level:4,title:"è®¢åä¿¡æ¯ç®¡ç",slug:"è®¢åä¿¡æ¯ç®¡ç",normalizedTitle:"è®¢åä¿¡æ¯ç®¡ç",charIndex:80},{level:4,title:"ä¼æ å¸",slug:"ä¼æ å¸",normalizedTitle:"ä¼æ å¸",charIndex:134},{level:2,title:"å¸åé®é¢",slug:"å¸åé®é¢",normalizedTitle:"å¸åé®é¢",charIndex:142}],headersStr:"åºæ¬ä¸å¡æ¶æ è®¢å è®¢åä¿¡æ¯ç®¡ç ä¼æ å¸ å¸åé®é¢",content:"# çµå\n\n\n# åºæ¬ä¸å¡æ¶æ\n\n\n\n\n# è®¢å\n\nè®¢åæå¡ä¸è¬ä¸ä¸»å¨è°ç¨å¶ä»æå¡\n\nè®¢åæå¡ä¸è´è´£åç¬¬ä¸æ¹éæ\n\nè®¢åæå¡ä¸æä¾ä¼æ è®¡ç®æææ¬åæé»è¾\n\n# è®¢åä¿¡æ¯ç®¡ç\n\n * ç¨æ·\n * åå\n * æ¶è´§äºº\n * æ¶è´§å°å\n * æ¶è´§æ¶é´\n * è®¢åç¶æ\n\n# ä¼æ å¸\n\n\n# å¸åé®é¢\n\nç§ææ´»å¨\n\nè¶å",normalizedContent:"# çµå\n\n\n# åºæ¬ä¸å¡æ¶æ\n\n\n\n\n# è®¢å\n\nè®¢åæå¡ä¸è¬ä¸ä¸»å¨è°ç¨å¶ä»æå¡\n\nè®¢åæå¡ä¸è´è´£åç¬¬ä¸æ¹éæ\n\nè®¢åæå¡ä¸æä¾ä¼æ è®¡ç®æææ¬åæé»è¾\n\n# è®¢åä¿¡æ¯ç®¡ç\n\n * ç¨æ·\n * åå\n * æ¶è´§äºº\n * æ¶è´§å°å\n * æ¶è´§æ¶é´\n * è®¢åç¶æ\n\n# ä¼æ å¸\n\n\n# å¸åé®é¢\n\nç§ææ´»å¨\n\nè¶å",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç­å°åæå¡",frontmatter:{title:"ç­å°åæå¡",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/cb2119/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%9F%AD%E5%9C%B0%E5%9D%80%E6%9C%8D%E5%8A%A1.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/ç­å°åæå¡.md",key:"v-63a49f52",path:"/pages/cb2119/",headers:[{level:2,title:"æ­¥éª¤ä¸ãéæ±åæ",slug:"æ­¥éª¤ä¸ãéæ±åæ",normalizedTitle:"æ­¥éª¤ä¸ãéæ±åæ",charIndex:199},{level:3,title:"ç¨ä¾",slug:"ç¨ä¾",normalizedTitle:"ç¨ä¾",charIndex:233},{level:4,title:"é®é¢èå´",slug:"é®é¢èå´",normalizedTitle:"é®é¢èå´",charIndex:258},{level:4,title:"è¶åºèç´çç¨ä¾",slug:"è¶åºèç´çç¨ä¾",normalizedTitle:"è¶åºèç´çç¨ä¾",charIndex:464},{level:3,title:"çº¦æååè®¾",slug:"çº¦æååè®¾",normalizedTitle:"çº¦æååè®¾",charIndex:567},{level:4,title:"ç¶æåè®¾",slug:"ç¶æåè®¾",normalizedTitle:"ç¶æåè®¾",charIndex:576},{level:4,title:"æ§è½ä¼°ç®",slug:"æ§è½ä¼°ç®",normalizedTitle:"æ§è½ä¼°ç®",charIndex:717},{level:2,title:"æ­¥éª¤äºãé¡¶å±è®¾è®¡",slug:"æ­¥éª¤äºãé¡¶å±è®¾è®¡",normalizedTitle:"æ­¥éª¤äºãé¡¶å±è®¾è®¡",charIndex:1211},{level:2,title:"æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡",slug:"æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡",normalizedTitle:"æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡",charIndex:1249},{level:3,title:"ç¨ä¾ï¼ç¨æ·è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥",slug:"ç¨ä¾-ç¨æ·è¾å¥ä¸æ®µææ¬-ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥",normalizedTitle:"ç¨ä¾ï¼ç¨æ·è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥",charIndex:1280},{level:3,title:"ç¨ä¾ï¼ç¨æ·è¾å¥ä¸ä¸ª paste ç url åå¯ä»¥çå°å®å­å¨çåå®¹",slug:"ç¨ä¾-ç¨æ·è¾å¥ä¸ä¸ª-paste-ç-url-åå¯ä»¥çå°å®å­å¨çåå®¹",normalizedTitle:"ç¨ä¾ï¼ç¨æ·è¾å¥ä¸ä¸ª paste ç url åå¯ä»¥çå°å®å­å¨çåå®¹",charIndex:3061},{level:3,title:"ç¨ä¾ï¼ æå¡è·è¸ªåæé¡µé¢",slug:"ç¨ä¾-æå¡è·è¸ªåæé¡µé¢",normalizedTitle:"ç¨ä¾ï¼ æå¡è·è¸ªåæé¡µé¢",charIndex:3483},{level:3,title:"ç¨ä¾ï¼ æå¡å é¤è¿æç pastes",slug:"ç¨ä¾-æå¡å é¤è¿æç-pastes",normalizedTitle:"ç¨ä¾ï¼ æå¡å é¤è¿æç pastes",charIndex:4334},{level:2,title:"æ­¥éª¤åãæ©å±è®¾è®¡",slug:"æ­¥éª¤åãæ©å±è®¾è®¡",normalizedTitle:"æ­¥éª¤åãæ©å±è®¾è®¡",charIndex:4439},{level:2,title:"é¢å¤çè¯é¢",slug:"é¢å¤çè¯é¢",normalizedTitle:"é¢å¤çè¯é¢",charIndex:5365},{level:3,title:"NoSQL",slug:"nosql",normalizedTitle:"nosql",charIndex:1417},{level:3,title:"ç¼å­",slug:"ç¼å­",normalizedTitle:"ç¼å­",charIndex:4896},{level:3,title:"å¼æ­¥åå¾®æå¡",slug:"å¼æ­¥åå¾®æå¡",normalizedTitle:"å¼æ­¥åå¾®æå¡",charIndex:5627},{level:3,title:"éä¿¡",slug:"éä¿¡",normalizedTitle:"éä¿¡",charIndex:3043},{level:3,title:"å®å¨",slug:"å®å¨",normalizedTitle:"å®å¨",charIndex:5753},{level:3,title:"å»¶è¿æ°å­",slug:"å»¶è¿æ°å­",normalizedTitle:"å»¶è¿æ°å­",charIndex:5767},{level:3,title:"æç»­è¿è¡",slug:"æç»­è¿è¡",normalizedTitle:"æç»­è¿è¡",charIndex:5794}],headersStr:"æ­¥éª¤ä¸ãéæ±åæ ç¨ä¾ é®é¢èå´ è¶åºèç´çç¨ä¾ çº¦æååè®¾ ç¶æåè®¾ æ§è½ä¼°ç® æ­¥éª¤äºãé¡¶å±è®¾è®¡ æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡ ç¨ä¾ï¼ç¨æ·è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥ ç¨ä¾ï¼ç¨æ·è¾å¥ä¸ä¸ª paste ç url åå¯ä»¥çå°å®å­å¨çåå®¹ ç¨ä¾ï¼ æå¡è·è¸ªåæé¡µé¢ ç¨ä¾ï¼ æå¡å é¤è¿æç pastes æ­¥éª¤åãæ©å±è®¾è®¡ é¢å¤çè¯é¢ NoSQL ç¼å­ å¼æ­¥åå¾®æå¡ éä¿¡ å®å¨ å»¶è¿æ°å­ æç»­è¿è¡",content:'# è®¾è®¡ Pastebin.com (æè Bit.ly)\n\n> æ¬ææ¬è¿èª è®¾è®¡ Pastebin.com (æè Bit.ly)\n\næ³¨æ: ä¸ºäºé¿åéå¤ï¼å½åææ¡£ä¼ç´æ¥é¾æ¥å°ç³»ç»è®¾è®¡ä¸»é¢çç¸å³åºåï¼è¯·åèé¾æ¥åå®¹ä»¥è·å¾ç»¼åçè®¨è®ºç¹ãæè¡¡åæ¿ä»£æ¹æ¡ã\n\nè®¾è®¡ Bit.ly - æ¯ä¸ä¸ªç±»ä¼¼çé®é¢ï¼åºå«æ¯ pastebin éè¦å­å¨çæ¯ paste çåå®¹ï¼èä¸æ¯åå§çæªç­åç urlã\n\n\n# æ­¥éª¤ä¸ãéæ±åæ\n\n> æ¶éè¿ä¸ªé®é¢çéæ±åèç´ã é®ç¸å³é®é¢æ¥æç¡®ç¨ä¾åçº¦æã è®¨è®ºä¸äºåè®¾ã\n\n\n# ç¨ä¾\n\n# é®é¢èå´\n\n * ç¨æ· è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥\n   * è¿æè®¾ç½®\n     * é»è®¤çè®¾ç½®æ¯ä¸ä¼è¿æç\n     * å¯ä»¥éæ©è®¾ç½®ä¸ä¸ªè¿æçæ¶é´\n * ç¨æ· è¾å¥ä¸ä¸ª paste ç url åï¼å¯ä»¥çå°å®å­å¨çåå®¹\n * ç¨æ· æ¯å¿åç\n * Service è·è¸ªé¡µé¢åæ\n   * ä¸ä¸ªæçè®¿é®ç»è®¡\n * Service å é¤è¿æç pastes\n * Service éè¦é«å¯ç¨\n\n# è¶åºèç´çç¨ä¾\n\n * ç¨æ· å¯ä»¥æ³¨åä¸ä¸ªè´¦æ·\n   * ç¨æ· éè¿éªè¯é®ç®±\n * ç¨æ· å¯ä»¥ç¨æ³¨åçè´¦æ·ç»å½\n   * ç¨æ· å¯ä»¥ç¼è¾ææ¡£\n * ç¨æ· å¯ä»¥è®¾ç½®å¯è§æ§\n * ç¨æ· å¯ä»¥è®¾ç½®ç­é¾æ¥\n\n\n# çº¦æååè®¾\n\n# ç¶æåè®¾\n\n * è®¿é®æµéä¸æ¯åååå¸ç\n * æå¼ä¸ä¸ªç­é¾æ¥åºè¯¥æ¯å¾å¿«ç\n * pastes åªè½æ¯ææ¬\n * é¡µé¢è®¿é®åææ°æ®å¯ä»¥ä¸ç¨å®æ¶\n * ä¸åä¸çç¨æ·é\n * æ¯ä¸ªæä¸åä¸ç paste åå¥é\n * æ¯ä¸ªæä¸äº¿ç paste è¯»åé\n * è¯»åæ¯ä¾å¨ 10:1\n\n# æ§è½ä¼°ç®\n\n * æ¯ä¸ª paste çå¤§å°\n   * æ¯ä¸ä¸ª paste 1 KB\n   * shortlink - 7 bytes\n   * expiration_length_in_minutes - 4 bytes\n   * created_at - 5 bytes\n   * paste_path - 255 bytes\n   * æ»å± = ~1.27 KB\n * æ¯ä¸ªææ°ç paste åå®¹å¨ 12.7GB\n   * (1.27 * 10000000)KB / æç paste\n   * ä¸å¹´åå°è¿ 450GB çæ° paste åå®¹\n   * ä¸å¹´å 3.6 äº¿ç­é¾æ¥\n   * åè®¾å¤§é¨åé½æ¯æ°ç pasteï¼èä¸æ¯éè¦æ´æ°å·²å­å¨ç paste\n * å¹³å 4paste/s çåå¥éåº¦\n * å¹³å 40paste/s çè¯»åéåº¦\n\nç®åçè½¬æ¢æå:\n\n * 2.5 ç¾ä¸ req/s\n * 1 req/s = 2.5 ç¾ä¸ req/month\n * 40 req/s = 1 äº¿ req/month\n * 400 req/s = 10 äº¿ req/month\n\n\n# æ­¥éª¤äºãé¡¶å±è®¾è®¡\n\n> æ¦è¿°ä¸ä¸ªåæ¬ææéè¦çç»ä»¶çé«å±æ¬¡è®¾è®¡\n\n\n\n\n# æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡\n\n> æ·±å¥æ¯ä¸ä¸ªæ ¸å¿ç»ä»¶çç»è\n\n\n# ç¨ä¾ï¼ç¨æ·è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥\n\næä»¬å¯ä»¥ç¨ä¸ä¸ª å³ç³»åæ°æ®åºä½ä¸ºä¸ä¸ªå¤§çåå¸è¡¨ï¼ç¨æ¥æçæç url æ å°å°ä¸ä¸ªåå« paste æä»¶çæä»¶æå¡å¨åè·¯å¾ä¸ã\n\nä¸ºäºé¿åæç®¡ä¸ä¸ªæä»¶æå¡å¨ï¼æä»¬å¯ä»¥ç¨ä¸ä¸ªæç®¡çå¯¹è±¡å­å¨ï¼æ¯å¦ Amazon ç S3 æèNoSQL ææ¡£ç±»åå­å¨ã\n\nä½ä¸ºä¸ä¸ªå¤§çåå¸è¡¨çå³ç³»åæ°æ®åºçæ¿ä»£æ¹æ¡ï¼æä»¬å¯ä»¥ç¨NoSQL é®å¼å­å¨ãæä»¬éè¦è®¨è®ºéæ© SQL æ NoSQL ä¹é´çæè¡¡ãä¸é¢çè®¨è®ºæ¯ä½¿ç¨å³ç³»åæ°æ®åºæ¹æ³ã\n\n * å®¢æ·ç«¯ åéä¸ä¸ªåå»º paste çè¯·æ±å°ä½ä¸ºä¸ä¸ªååä»£çå¯å¨ç Web æå¡å¨ã\n * Web æå¡å¨ è½¬åè¯·æ±ç» åæ¥å£ æå¡å¨\n * åæ¥å£ æå¡å¨æ§è¡å¦ä¸æä½ï¼\n   * çæä¸ä¸ªå¯ä¸ç url\n     * æ£æ¥è¿ä¸ª url å¨ SQL æ°æ®åº éé¢æ¯å¦æ¯å¯ä¸ç\n     * å¦æè¿ä¸ª url ä¸æ¯å¯ä¸çï¼çæå¦å¤ä¸ä¸ª url\n     * å¦ææä»¬æ¯æèªå®ä¹ urlï¼æä»¬å¯ä»¥ä½¿ç¨ç¨æ·æä¾ç urlï¼ä¹éè¦æ£æ¥æ¯å¦éå¤ï¼\n   * æçæç url å­å¨å° SQL æ°æ®åº ç pastes è¡¨éé¢\n   * å­å¨ paste çåå®¹æ°æ®å° å¯¹è±¡å­å¨ éé¢\n   * è¿åçæç url\n\nåé¢è¯å®éæä½ éè¦åå¤å°ä»£ç \n\npastes è¡¨å¯ä»¥æå¦ä¸ç»æï¼\n\nshortlink char(7) NOT NULL\nexpiration_length_in_minutes int NOT NULL\ncreated_at datetime NOT NULL\npaste_path varchar(255) NOT NULL\nPRIMARY KEY(shortlink)\n\n\næä»¬å°å¨ shortlink å­æ®µå created_at å­æ®µä¸åå»ºä¸ä¸ªæ°æ®åºç´¢å¼ï¼ç¨æ¥æé«æ¥è¯¢çéåº¦ï¼é¿åå ä¸ºæ«æå¨è¡¨å¯¼è´çé¿æ¶é´æ¥è¯¢ï¼å¹¶å°æ°æ®ä¿å­å¨åå­ä¸­ï¼ä»åå­éé¢é¡ºåºè¯»å 1MB çæ°æ®éè¦å¤§æ¦ 250 å¾®ç§ï¼èä» SSD ä¸è¯»ååéè¦è±è´¹ 4 åçæ¶é´ï¼ä»ç¡¬çä¸åéè¦è±è´¹ 80 åçæ¶é´ã 1\n\nä¸ºäºçæå¯ä¸ç urlï¼æä»¬å¯ä»¥ï¼\n\n * ä½¿ç¨ MD5 æ¥åå¸ç¨æ·ç IP å°å + æ¶é´æ³\n   * MD5 æ¯ä¸ä¸ªæ®éç¨æ¥çæä¸ä¸ª 128-bit é¿åº¦çåå¸å¼çä¸ç§åå¸æ¹æ³\n   * MD5 æ¯ä¸è´åå¸ç\n   * æèæä»¬ä¹å¯ä»¥ç¨ MD5 åå¸ä¸ä¸ªéæºçæçæ°æ®\n * ç¨ Base 62 ç¼ç  MD5 åå¸å¼\n   * å¯¹äº urlsï¼ä½¿ç¨ Base 62 ç¼ç  [a-zA-Z0-9] æ¯æ¯è¾åéç\n   * å¯¹äºæ¯ä¸ä¸ªåå§è¾å¥åªä¼æä¸ä¸ª hash ç»æï¼Base 62 æ¯ç¡®å®çï¼ä¸æ¶åéæºæ§ï¼\n   * Base 64 æ¯å¦å¤ä¸ä¸ªæµè¡çç¼ç æ¹æ¡ï¼ä½æ¯å¯¹äº urlsï¼ä¼å ä¸ºé¢å¤ç + å - å­ç¬¦ä¸²èäº§çä¸äºé®é¢\n   * ä»¥ä¸ Base 62 ä¼ªä»£ç  æ§è¡çæ¶é´å¤æåº¦æ¯ O(k)ï¼k æ¯æ°å­çæ°é = 7ï¼\n\ndef base_encode(num, base=62):\n    digits = []\n    while num > 0\n      remainder = modulo(num, base)\n      digits.push(remainder)\n      num = divide(num, base)\n    digits = digits.reverse\n\n\n * åè¾åºçå 7 ä¸ªå­ç¬¦ï¼ç»æä¼æ 62^7 ä¸ªå¯è½çå¼ï¼åºè¯¥è¶³ä»¥æ»¡è¶³å¨ 3 å¹´åå¤ç 3.6 äº¿ä¸ªç­é¾æ¥ççº¦æï¼\n\nurl = base_encode(md5(ip_address+timestamp))[:URL_LENGTH]\n\n\næä»¬å°ä¼ç¨ä¸ä¸ªå¬å¼ç REST é£æ ¼æ¥å£ï¼\n\n$ curl -X POST --data \'{"expiration_length_in_minutes":"60", \\"paste_contents":"Hello World!"}\' https://pastebin.com/api/v1/paste\n\n\nResponse:\n\n{\n  "shortlink": "foobar"\n}\n\n\nç¨äºåé¨éä¿¡ï¼æä»¬å¯ä»¥ç¨ RPCã\n\n\n# ç¨ä¾ï¼ç¨æ·è¾å¥ä¸ä¸ª paste ç url åå¯ä»¥çå°å®å­å¨çåå®¹\n\n * å®¢æ·ç«¯ åéä¸ä¸ªè·å paste è¯·æ±å° Web Server\n * Web Server è½¬åè¯·æ±ç» è¯»åæ¥å£ æå¡å¨\n * è¯»åæ¥å£ æå¡å¨æ§è¡å¦ä¸æä½ï¼\n   * å¨ SQL æ°æ®åº æ£æ¥è¿ä¸ªçæç url\n     * å¦æè¿ä¸ª url å¨ SQL æ°æ®åº éé¢ï¼åä» å¯¹è±¡å­å¨ è·åè¿ä¸ª paste çåå®¹\n     * å¦åï¼è¿åä¸ä¸ªéè¯¯é¡µé¢ç»ç¨æ·\n\nREST APIï¼\n\ncurl https://pastebin.com/api/v1/paste?shortlink=foobar\n\n\nResponse:\n\n{\n  "paste_contents": "Hello World",\n  "created_at": "YYYY-MM-DD HH:MM:SS",\n  "expiration_length_in_minutes": "60"\n}\n\n\n\n# ç¨ä¾ï¼ æå¡è·è¸ªåæé¡µé¢\n\nå ä¸ºå®æ¶åæä¸æ¯å¿é¡»çï¼æä»¥æä»¬å¯ä»¥ç®åç MapReduce Web Server çæ¥å¿ï¼ç¨æ¥çæç¹å»æ¬¡æ°ã\n\nclass HitCounts(MRJob):\n\n    def extract_url(self, line):\n        """Extract the generated url from the log line."""\n        ...\n\n    def extract_year_month(self, line):\n        """Return the year and month portions of the timestamp."""\n        ...\n\n    def mapper(self, _, line):\n        """Parse each log line, extract and transform relevant lines.\n\n        Emit key value pairs of the form:\n\n        (2016-01, url0), 1\n        (2016-01, url0), 1\n        (2016-01, url1), 1\n        """\n        url = self.extract_url(line)\n        period = self.extract_year_month(line)\n        yield (period, url), 1\n\n    def reducer(self, key, values):\n        """Sum values for each key.\n\n        (2016-01, url0), 2\n        (2016-01, url1), 1\n        """\n        yield key, sum(values)\n\n\n\n# ç¨ä¾ï¼ æå¡å é¤è¿æç pastes\n\nä¸ºäºå é¤è¿æç pastesï¼æä»¬å¯ä»¥ç´æ¥æç´¢ SQL æ°æ®åº ä¸­ææçè¿ææ¶é´æ¯å½åæ¶é´æ´æ©çè®°å½ï¼ ææè¿æçè®°å½å°ä»è¿å¼ è¡¨éé¢å é¤ï¼æèå°å¶æ è®°ä¸ºè¿æï¼ã\n\n\n# æ­¥éª¤åãæ©å±è®¾è®¡\n\n> ç»å®çº¦ææ¡ä»¶ï¼è¯å«åè§£å³ç¶é¢ã\n\n\n\néè¦æç¤º: ä¸è¦ç®åçä»æåçè®¾è®¡ç´æ¥è·³å°æç»çè®¾è®¡\n\nè¯´ææ¨å°è¿­ä»£å°æ§è¡è¿æ ·çæä½ï¼1)Benchmark/Load æµè¯ï¼2)Profile åºç¶é¢ï¼3)å¨è¯ä¼°æ¿ä»£æ¹æ¡åæè¡¡æ¶è§£å³ç¶é¢ï¼4)éå¤åé¢ï¼å¯ä»¥åèå¨ AWS ä¸è®¾è®¡ä¸ä¸ªå¯ä»¥æ¯æç¾ä¸ç¨æ·çç³»ç»è¿ä¸ªç¨æ¥è§£å³å¦ä½è¿­ä»£å°æ©å±åå§è®¾è®¡çä¾å­ã\n\néè¦çæ¯è®¨è®ºå¨åå§è®¾è®¡ä¸­å¯è½éå°çç¶é¢ï¼ä»¥åå¦ä½è§£å³æ¯ä¸ªç¶é¢ãæ¯å¦ï¼å¨å¤ä¸ª Web æå¡å¨ ä¸æ·»å  è´è½½å¹³è¡¡å¨ å¯ä»¥è§£å³åªäºé®é¢ï¼ CDN è§£å³åªäºé®é¢ï¼Master-Slave Replicas è§£å³åªäºé®é¢? æ¿ä»£æ¹æ¡æ¯ä»ä¹åæä¹å¯¹æ¯ä¸ä¸ªæ¿ä»£æ¹æ¡è¿è¡æè¡¡æ¯è¾ï¼\n\næä»¬å°ä»ç»ä¸äºç»ä»¶æ¥å®æè®¾è®¡ï¼å¹¶è§£å³å¯ä¼¸ç¼©æ§é®é¢ãåé¨çè´è½½å¹³è¡¡å¨å¹¶ä¸è½åå°æä¹±ã\n\nä¸ºäºé¿åéå¤çè®¨è®ºï¼ åèä»¥ä¸ç³»ç»è®¾è®¡ä¸»é¢è·åä¸»è¦è®¨è®ºè¦ç¹ãæè¡¡åæ¿ä»£æ¹æ¡ï¼\n\n * DNS\n * CDN\n * è´è½½åè¡¡å¨\n * æ°´å¹³æ©å±\n * ååä»£çï¼web æå¡å¨ï¼\n * åºç¨å±\n * ç¼å­\n * å³ç³»åæ°æ®åºç®¡çç³»ç» (RDBMS)\n * SQL write master-slave failover\n * ä¸»ä»å¤å¶\n * ä¸è´æ§æ¨¡å¼\n * å¯ç¨æ§æ¨¡å¼\n\nåæå­å¨æ°æ®åº å¯ä»¥ç¨æ¯å¦ Amazon Redshift æè Google BigQuery è¿æ ·çæ°æ®ä»åºè§£å³æ¹æ¡ã\n\nä¸ä¸ªå Amazon S3 è¿æ ·ç å¯¹è±¡å­å¨ï¼å¯ä»¥è½»æ¾å¤çæ¯æ 12.7 GB çæ°åå®¹çº¦æã\n\nè¦å¤ç å¹³å æ¯ç§ 40 è¯»è¯·æ±(å³°å¼æ´é«)ï¼å¶ä¸­ç­ç¹åå®¹çæµéåºè¯¥ç± åå­ç¼å­ å¤çï¼èä¸æ¯æ°æ®åºãåå­ç¼å­ å¯¹äºå¤çåå¸ä¸ååçæµéåæµéå³°å¼ä¹å¾æç¨ãåªè¦å¯æ¬æ²¡æé·å¥å¤å¶åçæ³¥æ½­ï¼SQL Read Replicas åºè¯¥è½å¤å¤çç¼å­ä¸¢å¤±ã\n\nå¯¹äºåä¸ª SQL Write Master-Slaveï¼å¹³å æ¯ç§ 4paste åå¥ (å³°å¼æ´é«) åºè¯¥æ¯å¯ä»¥åå°çãå¦åï¼æä»¬éè¦ä½¿ç¨é¢å¤ç SQL æ©å±æ¨¡å¼:\n\n * èå\n * åç\n * éè§èå\n * SQL è°ä¼\n\næä»¬è¿åºè¯¥èèå°ä¸äºæ°æ®ç§»å¨å° NoSQL æ°æ®åºã\n\n\n# é¢å¤çè¯é¢\n\n> æ¯å¦æ´æ·±å¥æ¢è®¨é¢å¤ä¸»é¢ï¼åå³äºé®é¢çèå´åé¢è¯å©ä½çæ¶é´ã\n\n\n# NoSQL\n\n * é®å¼å­å¨\n * ææ¡£å­å¨\n * ååå­å¨\n * å¾æ°æ®åº\n * sql è¿æ¯ nosql\n\n\n# ç¼å­\n\n * å¨åªç¼å­\n   * å®¢æ·ç«¯ç¼å­\n   * CDN ç¼å­\n   * Web æå¡å¨ç¼å­\n   * æ°æ®åºç¼å­\n   * åºç¨ç¼å­\n * ç¼å­ä»ä¹\n   * æ°æ®åºæ¥è¯¢çº§å«çç¼å­\n   * å¯¹è±¡çº§å«çç¼å­\n * ä½æ¶æ´æ°ç¼å­\n   * ç¼å­æ¨¡å¼\n   * ç´åæ¨¡å¼\n   * ååæ¨¡å¼\n   * å·æ°\n\n\n# å¼æ­¥åå¾®æå¡\n\n * æ¶æ¯éå\n * ä»»å¡éå\n * èå\n * å¾®æå¡\n\n\n# éä¿¡\n\n * è®¨è®ºæè¡¡:\n   * è·å®¢æ·ç«¯ä¹é´çå¤é¨éä¿¡ - HTTP APIs following REST\n   * åé¨éä¿¡ - RPC\n * æå¡åç°\n\n\n# å®å¨\n\nåèå®å¨ã\n\n\n# å»¶è¿æ°å­\n\nè§æ¯ä¸ªç¨åºåé½åºè¯¥ç¥éçå»¶è¿æ°ã\n\n\n# æç»­è¿è¡\n\n * ç»§ç»­å¯¹ç³»ç»è¿è¡åºåæµè¯åçæ§ï¼ä»¥å¨ç¶é¢åºç°æ¶è§£å³å®ä»¬\n * æ©å±æ¯ä¸ä¸ªè¿­ä»£çè¿ç¨',normalizedContent:'# è®¾è®¡ pastebin.com (æè bit.ly)\n\n> æ¬ææ¬è¿èª è®¾è®¡ pastebin.com (æè bit.ly)\n\næ³¨æ: ä¸ºäºé¿åéå¤ï¼å½åææ¡£ä¼ç´æ¥é¾æ¥å°ç³»ç»è®¾è®¡ä¸»é¢çç¸å³åºåï¼è¯·åèé¾æ¥åå®¹ä»¥è·å¾ç»¼åçè®¨è®ºç¹ãæè¡¡åæ¿ä»£æ¹æ¡ã\n\nè®¾è®¡ bit.ly - æ¯ä¸ä¸ªç±»ä¼¼çé®é¢ï¼åºå«æ¯ pastebin éè¦å­å¨çæ¯ paste çåå®¹ï¼èä¸æ¯åå§çæªç­åç urlã\n\n\n# æ­¥éª¤ä¸ãéæ±åæ\n\n> æ¶éè¿ä¸ªé®é¢çéæ±åèç´ã é®ç¸å³é®é¢æ¥æç¡®ç¨ä¾åçº¦æã è®¨è®ºä¸äºåè®¾ã\n\n\n# ç¨ä¾\n\n# é®é¢èå´\n\n * ç¨æ· è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥\n   * è¿æè®¾ç½®\n     * é»è®¤çè®¾ç½®æ¯ä¸ä¼è¿æç\n     * å¯ä»¥éæ©è®¾ç½®ä¸ä¸ªè¿æçæ¶é´\n * ç¨æ· è¾å¥ä¸ä¸ª paste ç url åï¼å¯ä»¥çå°å®å­å¨çåå®¹\n * ç¨æ· æ¯å¿åç\n * service è·è¸ªé¡µé¢åæ\n   * ä¸ä¸ªæçè®¿é®ç»è®¡\n * service å é¤è¿æç pastes\n * service éè¦é«å¯ç¨\n\n# è¶åºèç´çç¨ä¾\n\n * ç¨æ· å¯ä»¥æ³¨åä¸ä¸ªè´¦æ·\n   * ç¨æ· éè¿éªè¯é®ç®±\n * ç¨æ· å¯ä»¥ç¨æ³¨åçè´¦æ·ç»å½\n   * ç¨æ· å¯ä»¥ç¼è¾ææ¡£\n * ç¨æ· å¯ä»¥è®¾ç½®å¯è§æ§\n * ç¨æ· å¯ä»¥è®¾ç½®ç­é¾æ¥\n\n\n# çº¦æååè®¾\n\n# ç¶æåè®¾\n\n * è®¿é®æµéä¸æ¯åååå¸ç\n * æå¼ä¸ä¸ªç­é¾æ¥åºè¯¥æ¯å¾å¿«ç\n * pastes åªè½æ¯ææ¬\n * é¡µé¢è®¿é®åææ°æ®å¯ä»¥ä¸ç¨å®æ¶\n * ä¸åä¸çç¨æ·é\n * æ¯ä¸ªæä¸åä¸ç paste åå¥é\n * æ¯ä¸ªæä¸äº¿ç paste è¯»åé\n * è¯»åæ¯ä¾å¨ 10:1\n\n# æ§è½ä¼°ç®\n\n * æ¯ä¸ª paste çå¤§å°\n   * æ¯ä¸ä¸ª paste 1 kb\n   * shortlink - 7 bytes\n   * expiration_length_in_minutes - 4 bytes\n   * created_at - 5 bytes\n   * paste_path - 255 bytes\n   * æ»å± = ~1.27 kb\n * æ¯ä¸ªææ°ç paste åå®¹å¨ 12.7gb\n   * (1.27 * 10000000)kb / æç paste\n   * ä¸å¹´åå°è¿ 450gb çæ° paste åå®¹\n   * ä¸å¹´å 3.6 äº¿ç­é¾æ¥\n   * åè®¾å¤§é¨åé½æ¯æ°ç pasteï¼èä¸æ¯éè¦æ´æ°å·²å­å¨ç paste\n * å¹³å 4paste/s çåå¥éåº¦\n * å¹³å 40paste/s çè¯»åéåº¦\n\nç®åçè½¬æ¢æå:\n\n * 2.5 ç¾ä¸ req/s\n * 1 req/s = 2.5 ç¾ä¸ req/month\n * 40 req/s = 1 äº¿ req/month\n * 400 req/s = 10 äº¿ req/month\n\n\n# æ­¥éª¤äºãé¡¶å±è®¾è®¡\n\n> æ¦è¿°ä¸ä¸ªåæ¬ææéè¦çç»ä»¶çé«å±æ¬¡è®¾è®¡\n\n\n\n\n# æ­¥éª¤ä¸ãæ ¸å¿ç»ä»¶è®¾è®¡\n\n> æ·±å¥æ¯ä¸ä¸ªæ ¸å¿ç»ä»¶çç»è\n\n\n# ç¨ä¾ï¼ç¨æ·è¾å¥ä¸æ®µææ¬ï¼ç¶åå¾å°ä¸ä¸ªéæºçæçé¾æ¥\n\næä»¬å¯ä»¥ç¨ä¸ä¸ª å³ç³»åæ°æ®åºä½ä¸ºä¸ä¸ªå¤§çåå¸è¡¨ï¼ç¨æ¥æçæç url æ å°å°ä¸ä¸ªåå« paste æä»¶çæä»¶æå¡å¨åè·¯å¾ä¸ã\n\nä¸ºäºé¿åæç®¡ä¸ä¸ªæä»¶æå¡å¨ï¼æä»¬å¯ä»¥ç¨ä¸ä¸ªæç®¡çå¯¹è±¡å­å¨ï¼æ¯å¦ amazon ç s3 æènosql ææ¡£ç±»åå­å¨ã\n\nä½ä¸ºä¸ä¸ªå¤§çåå¸è¡¨çå³ç³»åæ°æ®åºçæ¿ä»£æ¹æ¡ï¼æä»¬å¯ä»¥ç¨nosql é®å¼å­å¨ãæä»¬éè¦è®¨è®ºéæ© sql æ nosql ä¹é´çæè¡¡ãä¸é¢çè®¨è®ºæ¯ä½¿ç¨å³ç³»åæ°æ®åºæ¹æ³ã\n\n * å®¢æ·ç«¯ åéä¸ä¸ªåå»º paste çè¯·æ±å°ä½ä¸ºä¸ä¸ªååä»£çå¯å¨ç web æå¡å¨ã\n * web æå¡å¨ è½¬åè¯·æ±ç» åæ¥å£ æå¡å¨\n * åæ¥å£ æå¡å¨æ§è¡å¦ä¸æä½ï¼\n   * çæä¸ä¸ªå¯ä¸ç url\n     * æ£æ¥è¿ä¸ª url å¨ sql æ°æ®åº éé¢æ¯å¦æ¯å¯ä¸ç\n     * å¦æè¿ä¸ª url ä¸æ¯å¯ä¸çï¼çæå¦å¤ä¸ä¸ª url\n     * å¦ææä»¬æ¯æèªå®ä¹ urlï¼æä»¬å¯ä»¥ä½¿ç¨ç¨æ·æä¾ç urlï¼ä¹éè¦æ£æ¥æ¯å¦éå¤ï¼\n   * æçæç url å­å¨å° sql æ°æ®åº ç pastes è¡¨éé¢\n   * å­å¨ paste çåå®¹æ°æ®å° å¯¹è±¡å­å¨ éé¢\n   * è¿åçæç url\n\nåé¢è¯å®éæä½ éè¦åå¤å°ä»£ç \n\npastes è¡¨å¯ä»¥æå¦ä¸ç»æï¼\n\nshortlink char(7) not null\nexpiration_length_in_minutes int not null\ncreated_at datetime not null\npaste_path varchar(255) not null\nprimary key(shortlink)\n\n\næä»¬å°å¨ shortlink å­æ®µå created_at å­æ®µä¸åå»ºä¸ä¸ªæ°æ®åºç´¢å¼ï¼ç¨æ¥æé«æ¥è¯¢çéåº¦ï¼é¿åå ä¸ºæ«æå¨è¡¨å¯¼è´çé¿æ¶é´æ¥è¯¢ï¼å¹¶å°æ°æ®ä¿å­å¨åå­ä¸­ï¼ä»åå­éé¢é¡ºåºè¯»å 1mb çæ°æ®éè¦å¤§æ¦ 250 å¾®ç§ï¼èä» ssd ä¸è¯»ååéè¦è±è´¹ 4 åçæ¶é´ï¼ä»ç¡¬çä¸åéè¦è±è´¹ 80 åçæ¶é´ã 1\n\nä¸ºäºçæå¯ä¸ç urlï¼æä»¬å¯ä»¥ï¼\n\n * ä½¿ç¨ md5 æ¥åå¸ç¨æ·ç ip å°å + æ¶é´æ³\n   * md5 æ¯ä¸ä¸ªæ®éç¨æ¥çæä¸ä¸ª 128-bit é¿åº¦çåå¸å¼çä¸ç§åå¸æ¹æ³\n   * md5 æ¯ä¸è´åå¸ç\n   * æèæä»¬ä¹å¯ä»¥ç¨ md5 åå¸ä¸ä¸ªéæºçæçæ°æ®\n * ç¨ base 62 ç¼ç  md5 åå¸å¼\n   * å¯¹äº urlsï¼ä½¿ç¨ base 62 ç¼ç  [a-za-z0-9] æ¯æ¯è¾åéç\n   * å¯¹äºæ¯ä¸ä¸ªåå§è¾å¥åªä¼æä¸ä¸ª hash ç»æï¼base 62 æ¯ç¡®å®çï¼ä¸æ¶åéæºæ§ï¼\n   * base 64 æ¯å¦å¤ä¸ä¸ªæµè¡çç¼ç æ¹æ¡ï¼ä½æ¯å¯¹äº urlsï¼ä¼å ä¸ºé¢å¤ç + å - å­ç¬¦ä¸²èäº§çä¸äºé®é¢\n   * ä»¥ä¸ base 62 ä¼ªä»£ç  æ§è¡çæ¶é´å¤æåº¦æ¯ o(k)ï¼k æ¯æ°å­çæ°é = 7ï¼\n\ndef base_encode(num, base=62):\n    digits = []\n    while num > 0\n      remainder = modulo(num, base)\n      digits.push(remainder)\n      num = divide(num, base)\n    digits = digits.reverse\n\n\n * åè¾åºçå 7 ä¸ªå­ç¬¦ï¼ç»æä¼æ 62^7 ä¸ªå¯è½çå¼ï¼åºè¯¥è¶³ä»¥æ»¡è¶³å¨ 3 å¹´åå¤ç 3.6 äº¿ä¸ªç­é¾æ¥ççº¦æï¼\n\nurl = base_encode(md5(ip_address+timestamp))[:url_length]\n\n\næä»¬å°ä¼ç¨ä¸ä¸ªå¬å¼ç rest é£æ ¼æ¥å£ï¼\n\n$ curl -x post --data \'{"expiration_length_in_minutes":"60", \\"paste_contents":"hello world!"}\' https://pastebin.com/api/v1/paste\n\n\nresponse:\n\n{\n  "shortlink": "foobar"\n}\n\n\nç¨äºåé¨éä¿¡ï¼æä»¬å¯ä»¥ç¨ rpcã\n\n\n# ç¨ä¾ï¼ç¨æ·è¾å¥ä¸ä¸ª paste ç url åå¯ä»¥çå°å®å­å¨çåå®¹\n\n * å®¢æ·ç«¯ åéä¸ä¸ªè·å paste è¯·æ±å° web server\n * web server è½¬åè¯·æ±ç» è¯»åæ¥å£ æå¡å¨\n * è¯»åæ¥å£ æå¡å¨æ§è¡å¦ä¸æä½ï¼\n   * å¨ sql æ°æ®åº æ£æ¥è¿ä¸ªçæç url\n     * å¦æè¿ä¸ª url å¨ sql æ°æ®åº éé¢ï¼åä» å¯¹è±¡å­å¨ è·åè¿ä¸ª paste çåå®¹\n     * å¦åï¼è¿åä¸ä¸ªéè¯¯é¡µé¢ç»ç¨æ·\n\nrest apiï¼\n\ncurl https://pastebin.com/api/v1/paste?shortlink=foobar\n\n\nresponse:\n\n{\n  "paste_contents": "hello world",\n  "created_at": "yyyy-mm-dd hh:mm:ss",\n  "expiration_length_in_minutes": "60"\n}\n\n\n\n# ç¨ä¾ï¼ æå¡è·è¸ªåæé¡µé¢\n\nå ä¸ºå®æ¶åæä¸æ¯å¿é¡»çï¼æä»¥æä»¬å¯ä»¥ç®åç mapreduce web server çæ¥å¿ï¼ç¨æ¥çæç¹å»æ¬¡æ°ã\n\nclass hitcounts(mrjob):\n\n    def extract_url(self, line):\n        """extract the generated url from the log line."""\n        ...\n\n    def extract_year_month(self, line):\n        """return the year and month portions of the timestamp."""\n        ...\n\n    def mapper(self, _, line):\n        """parse each log line, extract and transform relevant lines.\n\n        emit key value pairs of the form:\n\n        (2016-01, url0), 1\n        (2016-01, url0), 1\n        (2016-01, url1), 1\n        """\n        url = self.extract_url(line)\n        period = self.extract_year_month(line)\n        yield (period, url), 1\n\n    def reducer(self, key, values):\n        """sum values for each key.\n\n        (2016-01, url0), 2\n        (2016-01, url1), 1\n        """\n        yield key, sum(values)\n\n\n\n# ç¨ä¾ï¼ æå¡å é¤è¿æç pastes\n\nä¸ºäºå é¤è¿æç pastesï¼æä»¬å¯ä»¥ç´æ¥æç´¢ sql æ°æ®åº ä¸­ææçè¿ææ¶é´æ¯å½åæ¶é´æ´æ©çè®°å½ï¼ ææè¿æçè®°å½å°ä»è¿å¼ è¡¨éé¢å é¤ï¼æèå°å¶æ è®°ä¸ºè¿æï¼ã\n\n\n# æ­¥éª¤åãæ©å±è®¾è®¡\n\n> ç»å®çº¦ææ¡ä»¶ï¼è¯å«åè§£å³ç¶é¢ã\n\n\n\néè¦æç¤º: ä¸è¦ç®åçä»æåçè®¾è®¡ç´æ¥è·³å°æç»çè®¾è®¡\n\nè¯´ææ¨å°è¿­ä»£å°æ§è¡è¿æ ·çæä½ï¼1)benchmark/load æµè¯ï¼2)profile åºç¶é¢ï¼3)å¨è¯ä¼°æ¿ä»£æ¹æ¡åæè¡¡æ¶è§£å³ç¶é¢ï¼4)éå¤åé¢ï¼å¯ä»¥åèå¨ aws ä¸è®¾è®¡ä¸ä¸ªå¯ä»¥æ¯æç¾ä¸ç¨æ·çç³»ç»è¿ä¸ªç¨æ¥è§£å³å¦ä½è¿­ä»£å°æ©å±åå§è®¾è®¡çä¾å­ã\n\néè¦çæ¯è®¨è®ºå¨åå§è®¾è®¡ä¸­å¯è½éå°çç¶é¢ï¼ä»¥åå¦ä½è§£å³æ¯ä¸ªç¶é¢ãæ¯å¦ï¼å¨å¤ä¸ª web æå¡å¨ ä¸æ·»å  è´è½½å¹³è¡¡å¨ å¯ä»¥è§£å³åªäºé®é¢ï¼ cdn è§£å³åªäºé®é¢ï¼master-slave replicas è§£å³åªäºé®é¢? æ¿ä»£æ¹æ¡æ¯ä»ä¹åæä¹å¯¹æ¯ä¸ä¸ªæ¿ä»£æ¹æ¡è¿è¡æè¡¡æ¯è¾ï¼\n\næä»¬å°ä»ç»ä¸äºç»ä»¶æ¥å®æè®¾è®¡ï¼å¹¶è§£å³å¯ä¼¸ç¼©æ§é®é¢ãåé¨çè´è½½å¹³è¡¡å¨å¹¶ä¸è½åå°æä¹±ã\n\nä¸ºäºé¿åéå¤çè®¨è®ºï¼ åèä»¥ä¸ç³»ç»è®¾è®¡ä¸»é¢è·åä¸»è¦è®¨è®ºè¦ç¹ãæè¡¡åæ¿ä»£æ¹æ¡ï¼\n\n * dns\n * cdn\n * è´è½½åè¡¡å¨\n * æ°´å¹³æ©å±\n * ååä»£çï¼web æå¡å¨ï¼\n * åºç¨å±\n * ç¼å­\n * å³ç³»åæ°æ®åºç®¡çç³»ç» (rdbms)\n * sql write master-slave failover\n * ä¸»ä»å¤å¶\n * ä¸è´æ§æ¨¡å¼\n * å¯ç¨æ§æ¨¡å¼\n\nåæå­å¨æ°æ®åº å¯ä»¥ç¨æ¯å¦ amazon redshift æè google bigquery è¿æ ·çæ°æ®ä»åºè§£å³æ¹æ¡ã\n\nä¸ä¸ªå amazon s3 è¿æ ·ç å¯¹è±¡å­å¨ï¼å¯ä»¥è½»æ¾å¤çæ¯æ 12.7 gb çæ°åå®¹çº¦æã\n\nè¦å¤ç å¹³å æ¯ç§ 40 è¯»è¯·æ±(å³°å¼æ´é«)ï¼å¶ä¸­ç­ç¹åå®¹çæµéåºè¯¥ç± åå­ç¼å­ å¤çï¼èä¸æ¯æ°æ®åºãåå­ç¼å­ å¯¹äºå¤çåå¸ä¸ååçæµéåæµéå³°å¼ä¹å¾æç¨ãåªè¦å¯æ¬æ²¡æé·å¥å¤å¶åçæ³¥æ½­ï¼sql read replicas åºè¯¥è½å¤å¤çç¼å­ä¸¢å¤±ã\n\nå¯¹äºåä¸ª sql write master-slaveï¼å¹³å æ¯ç§ 4paste åå¥ (å³°å¼æ´é«) åºè¯¥æ¯å¯ä»¥åå°çãå¦åï¼æä»¬éè¦ä½¿ç¨é¢å¤ç sql æ©å±æ¨¡å¼:\n\n * èå\n * åç\n * éè§èå\n * sql è°ä¼\n\næä»¬è¿åºè¯¥èèå°ä¸äºæ°æ®ç§»å¨å° nosql æ°æ®åºã\n\n\n# é¢å¤çè¯é¢\n\n> æ¯å¦æ´æ·±å¥æ¢è®¨é¢å¤ä¸»é¢ï¼åå³äºé®é¢çèå´åé¢è¯å©ä½çæ¶é´ã\n\n\n# nosql\n\n * é®å¼å­å¨\n * ææ¡£å­å¨\n * ååå­å¨\n * å¾æ°æ®åº\n * sql è¿æ¯ nosql\n\n\n# ç¼å­\n\n * å¨åªç¼å­\n   * å®¢æ·ç«¯ç¼å­\n   * cdn ç¼å­\n   * web æå¡å¨ç¼å­\n   * æ°æ®åºç¼å­\n   * åºç¨ç¼å­\n * ç¼å­ä»ä¹\n   * æ°æ®åºæ¥è¯¢çº§å«çç¼å­\n   * å¯¹è±¡çº§å«çç¼å­\n * ä½æ¶æ´æ°ç¼å­\n   * ç¼å­æ¨¡å¼\n   * ç´åæ¨¡å¼\n   * ååæ¨¡å¼\n   * å·æ°\n\n\n# å¼æ­¥åå¾®æå¡\n\n * æ¶æ¯éå\n * ä»»å¡éå\n * èå\n * å¾®æå¡\n\n\n# éä¿¡\n\n * è®¨è®ºæè¡¡:\n   * è·å®¢æ·ç«¯ä¹é´çå¤é¨éä¿¡ - http apis following rest\n   * åé¨éä¿¡ - rpc\n * æå¡åç°\n\n\n# å®å¨\n\nåèå®å¨ã\n\n\n# å»¶è¿æ°å­\n\nè§æ¯ä¸ªç¨åºåé½åºè¯¥ç¥éçå»¶è¿æ°ã\n\n\n# æç»­è¿è¡\n\n * ç»§ç»­å¯¹ç³»ç»è¿è¡åºåæµè¯åçæ§ï¼ä»¥å¨ç¶é¢åºç°æ¶è§£å³å®ä»¬\n * æ©å±æ¯ä¸ä¸ªè¿­ä»£çè¿ç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç§æç³»ç»è®¾è®¡",frontmatter:{title:"ç§æç³»ç»è®¾è®¡",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ","è§£å³æ¹æ¡"],tags:["æ¶æ","è§£å³æ¹æ¡"],permalink:"/pages/d86624/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/01.%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1.html",relativePath:"01.æ¶æ/01.è§£å³æ¹æ¡/ç§æç³»ç»è®¾è®¡.md",key:"v-1e5e3fdf",path:"/pages/d86624/",headers:[{level:2,title:"ç§æç³»ç»çé¾ç¹",slug:"ç§æç³»ç»çé¾ç¹",normalizedTitle:"ç§æç³»ç»çé¾ç¹",charIndex:36},{level:2,title:"ç§æç³»ç»çæè",slug:"ç§æç³»ç»çæè",normalizedTitle:"ç§æç³»ç»çæè",charIndex:443},{level:3,title:"ç¨³åå¿«",slug:"ç¨³åå¿«",normalizedTitle:"ç¨³åå¿«",charIndex:455},{level:2,title:"åç«¯ä¼å",slug:"åç«¯ä¼å",normalizedTitle:"åç«¯ä¼å",charIndex:589},{level:3,title:"éæé¡µé¢",slug:"éæé¡µé¢",normalizedTitle:"éæé¡µé¢",charIndex:598},{level:3,title:"æé®æ§å¶",slug:"æé®æ§å¶",normalizedTitle:"æé®æ§å¶",charIndex:790},{level:2,title:"åç«¯ä¼å",slug:"åç«¯ä¼å",normalizedTitle:"åç«¯ä¼å",charIndex:849},{level:3,title:"éç¦»",slug:"éç¦»",normalizedTitle:"éç¦»",charIndex:858},{level:3,title:"éæµãçæ­ãéçº§ãéç¦»",slug:"éæµãçæ­ãéçº§ãéç¦»",normalizedTitle:"éæµãçæ­ãéçº§ãéç¦»",charIndex:947},{level:3,title:"ç¼å­",slug:"ç¼å­",normalizedTitle:"ç¼å­",charIndex:647},{level:3,title:"æµéåå³°",slug:"æµéåå³°",normalizedTitle:"æµéåå³°",charIndex:1141},{level:3,title:"ååºå­",slug:"ååºå­",normalizedTitle:"ååºå­",charIndex:527},{level:4,title:"æ¶æä¸å",slug:"æ¶æä¸å",normalizedTitle:"æ¶æä¸å",charIndex:1282},{level:4,title:"é¿åè¶å",slug:"é¿åè¶å",normalizedTitle:"é¿åè¶å",charIndex:1361},{level:3,title:"URL å¨æå",slug:"url-å¨æå",normalizedTitle:"url å¨æå",charIndex:1776},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1843}],headersStr:"ç§æç³»ç»çé¾ç¹ ç§æç³»ç»çæè ç¨³åå¿« åç«¯ä¼å éæé¡µé¢ æé®æ§å¶ åç«¯ä¼å éç¦» éæµãçæ­ãéçº§ãéç¦» ç¼å­ æµéåå³° ååºå­ æ¶æä¸å é¿åè¶å URL å¨æå åèèµæ",content:"# ç§æç³»ç»è®¾è®¡\n\nç§æç³»ç»æè¦åºå¯¹çåºæ¯å°±æ¯ï¼ç¬æ¶æµ·éè¯·æ±ã\n\n\n# ç§æç³»ç»çé¾ç¹\n\n * é«å¹¶åï¼ç§æç³»ç»æ¯æè´çé«å¹¶åºæ¯åèªä¸ç¨è¯´ãå¶é«å¹¶åå¯ä»¥ç»åä¸ºäºï¼\n   * å¹¶åè¯»ï¼ä¸»è¦æ¯è¯»åå©ä½åºå­éä»¥åååä¿¡æ¯\n   * å¹¶ååï¼ä¸»è¦æ¯ä¸ååï¼ç³»ç»åå¥è®¢åè®°å½\n * è¶åï¼ç§æç³»ç»ä¸­å®åçååä¸è¬é½æ¯æ§ä»·æ¯å¾é«ï¼ä¸æä¹èµé±ï¼çè³èµé±èµååçååãä¸æ¦åºç°è¶åç°è±¡ï¼ä¼ç»åå®¶å¸¦æ¥å·¨å¤§çç»æµæå¤±ãä»ç³»ç»å±é¢æ¥çï¼æ¯å¦æç§æååæ¬æ¥åºå­ 100 ä»¶ï¼ä½æ¯å¨é«å¹¶ååºæ¯ä¸ï¼ç¬æ¶ä¸åéè¶è¿ 100 ä»¶ï¼å¤çä¸å½ï¼è®©è¿äºä¸åé½æåäºï¼å°±ä¼åºç°è¶åã\n * æ¶æè¯·æ±ï¼æäºäººä¸ºäºä½ä»·è´­å¥ç§æååï¼éè¿å¨å¤å°æºå¨ä¸è·èæ¬ï¼æ¨¡æå¤§éç¨æ·æ¢ååçè¯·æ±ï¼èµ°èªå·±çè·¯ï¼è®©å«äººæ è·¯å¯èµ°ï¼ã\n * æ°æ®åºå´©æºï¼æµ·éè¯·æ±ä¸ï¼å¦ææ²¡æ MQ åå³°ï¼æ²¡æè¿è½½ä¿æ¤ï¼è®©ææè¯·æ±é½æå°æ°æ®åºï¼é£ä¹æ°æ®åºåºæ¬å°±æäºãæ°æ®åºå¦ææäºï¼ä¹ä¼æ³¢åå¶ä»ä¸å¡ï¼ä»èå¯è½è®©æ´ä¸ªç³»ç»ãç½ç«é·å¥ç«çªã\n * å¯¹ç°æä¸å¡é æå²å»\n\n\n# ç§æç³»ç»çæè\n\n\n# ç¨³åå¿«\n\nç§æç³»ç»æ¶æçæèè§åº¦å¯ä»¥æ¦æ¬ä¸ºï¼ç¨³ãåãå¿«\n\n * ç¨³ï¼é«å¯ç¨ï¼ï¼ç³»ç»æ¶æè¦æ»¡è¶³é«å¯ç¨ï¼ç³»ç»è¦è½æä½æ´»å¨ã\n * åï¼ä¸è´æ§ï¼ï¼ååååºå­æ¹å¼éå¸¸å³é®ï¼ä¸è½åºç°è¶åã\n * å¿«ï¼é«æ§è½ï¼ï¼æ´ä¸ªè¯·æ±é¾è·¯ï¼ä»åç«¯å°åç«¯ï¼ä¾èµç»ä»¶é½è¦åå°ååä¼åã\n\n\n\n\n# åç«¯ä¼å\n\n\n# éæé¡µé¢\n\næç§æååé¡µé¢éæåï¼åå°æ¥æ°æ®åºç IO å¼éãç¶åï¼å¯ä»¥å°è¿äºéæé¡µé¢å CDN ç¼å­ï¼å¦æé¡¹ç®æ¯ååç«¯åç¦»çï¼è¿å¯ä»¥å¨ååä»£çæå¡å¨ä¾§è®¾ç½®éæç¼å­ã\n\nå¦æ¯ä¸ªååé½ç± ID æ¥æ è¯ï¼é£ä¹ http://item.xxx.com/item.htm?id=xxxx å°±å¯ä»¥ä½ä¸ºå¯ä¸ç URL æ è¯ãç¸åºçé¡µé¢å¯ä»¥æåååç«¯ç¼å­ï¼è¿æ ·å°±ä¸éè¦ååå°æ¥è¯¢ååä¿¡æ¯ã\n\n\n# æé®æ§å¶\n\nå¨ç§ææ´»å¨å¼å¯æ¶é´åï¼ä¸åæé®ç¦ç¨ã\n\næ­¤å¤ï¼æé®ä¸æ¦ç¹å»ä¹åï¼ç¦ç¨ä¸æ®µæ¶é´ï¼é²æ­¢æäººç¯çè¾åºã\n\n\n# åç«¯ä¼å\n\n\n# éç¦»\n\nç§ææ´»å¨ï¼æ¬è´¨ä¸è¿æ¯ä¸ä¸ªè¥éæ´»å¨ï¼æ§è´¨åææãä¿éä¸æ ·ã\n\nç§æç³»ç»è®¾è®¡åºçº¿ååï¼æ¯ä¸åºè¯¥å½±åç°æä¸å¡ãæä»¥ï¼ä¸ºäºé¿åé²ä¸èé²ï¼ç¾å¯ä¸ççæåµä¸ï¼ç§æç³»ç»å´©äºã\n\n\n# éæµãçæ­ãéçº§ãéç¦»\n\n * éç¦»ï¼å°ç§æç³»ç»ãæ°æ®ä¸å¶ä»æ­£å¸¸ä¸å¡éç¦»ãå½¼æ­¤éç¦»ï¼èªç¶äºä¸å½±åã\n\n * éæµï¼è®¾ç½®éå¼ï¼è¶è¿éå¼ï¼æç»è¯·æ±ãé²æ­¢æ°æ®åºè¢«ææ­»ã\n\n * éçº§ï¼ä¿è¯æ ¸å¿ä¸å¡ç»§ç»­å·¥ä½ï¼éæ ¸å¿ä¸å¡åå®å¤©å½ã\n\n * çæ­ï¼ä¸è¦å½±åå«çç³»ç»ã\n\n\n# ç¼å­\n\nç¼å­è¦é¢ç­ï¼é¿åç¬é´æµéå²å»ã\n\næ­¤å¤ï¼é²æ­¢éªå´©ãç©¿éãå»ç©¿é®é¢çå¸¸è§å¤çè¦åå¥½ã\n\nç¼å­ä¹è¦ä¿è¯é«å¯ç¨ã\n\n\n# æµéåå³°\n\nåå³°çæè·¯ï¼æéãç­é¢ãåå±è¿æ»¤ã\n\n * æéï¼ç¨æ¶æ¯éåæ¥ç¼å²ç¬æ¶æµéçæ¹æ¡ãä½æ¯ï¼æ¶æ¯éåèªèº«ä¹æä¸éï¼å¦æç§¯åè¿å¤ï¼ä¹ä¼å¤çä¸äºã\n * ç­é¢ï¼æä¸æï¼ï¼å¯ä»¥éå¶ç§æå¨å¹¶å»¶ç¼è¯·æ±ã\n * åå±è¿æ»¤ï¼éç¨æ¼æå¼çè®¾è®¡å°½å¯è½æ¦æªæ æè¯·æ±ã\n\n\n\n\n# ååºå­\n\n# æ¶æä¸å\n\næ¶æä¸åçè§£å³æ¹æ¡è¿æ¯è¦ç»åå®å¨ååä½å¼æªæ½æ¥å¶æ­¢ï¼\n\n * è¯å«é¢ç¹ä¸åä¸ä»æ¬¾æéå¤ä¸åä¸ä»æ¬¾çåå®¶ï¼é»æ­å¶ä¸åã\n * éå¶ä¸ªäººè´­ä¹°æ°\n\n# é¿åè¶å\n\nååºå­å¨æ°æ®ä¸è´æ§ä¸ï¼ä¸»è¦å°±æ¯ä¿è¯å¤§å¹¶åè¯·æ±æ¶åºå­æ°æ®ä¸è½ä¸ºè´æ°ï¼ä¹å°±æ¯è¦ä¿è¯æ°æ®åºä¸­çåºå­å­æ®µå¼ä¸è½ä¸ºè´æ°ï¼ä¸è¬æä»¬æå¤ç§è§£å³æ¹æ¡ï¼ä¸ç§æ¯å¨åºç¨ç¨åºä¸­éè¿äºå¡æ¥å¤æ­ï¼å³ä¿è¯åååºå­ä¸è½ä¸ºè´æ°ï¼å¦åå°±åæ»ï¼å¦ä¸ç§åæ³æ¯ç´æ¥è®¾ç½®æ°æ®åºçå­æ®µæ°æ®ä¸ºæ ç¬¦å·æ´æ°ï¼è¿æ ·åååºå­å­æ®µå¼å°äºé¶æ¶ä¼ç´æ¥æ§è¡ SQL è¯­å¥æ¥æ¥éï¼åæä¸ç§å°±æ¯ä½¿ç¨ CASE WHEN å¤æ­è¯­å¥ï¼ä¾å¦è¿æ ·ç SQL è¯­å¥ï¼\n\nUPDATE item SET inventory = CASE WHEN inventory >= xxx THEN inventory-xxx ELSE inventory END\n\n\nå¨äº¤æç¯èä¸­ï¼âåºå­âæ¯ä¸ªå³é®æ°æ®ï¼ä¹æ¯ä¸ªç­ç¹æ°æ®ï¼å ä¸ºäº¤æçåä¸ªç¯èä¸­é½å¯è½æ¶åå¯¹åºå­çæ¥è¯¢ãä½æ¯ï¼æå¨åé¢ä»ç»åå±è¿æ»¤æ¶æå°è¿ï¼ç§æä¸­å¹¶ä¸éè¦å¯¹åºå­æç²¾ç¡®çä¸è´æ§è¯»ï¼æåºå­æ°æ®æ¾å°ç¼å­ï¼Cacheï¼ä¸­ï¼å¯ä»¥å¤§å¤§æåè¯»æ§è½ã\n\n\n# URL å¨æå\n\néè¿ MD5 ä¹ç±»çå å¯ç®æ³å å¯éæºçå­ç¬¦ä¸²å»å urlï¼ç¶åéè¿åç«¯ä»£ç è·å url åå°æ ¡éªæè½éè¿ã\n\n\n# åèèµæ\n\n * å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»\n * ä¸ä¸ªç§æç³»ç»çè®¾è®¡æè",normalizedContent:"# ç§æç³»ç»è®¾è®¡\n\nç§æç³»ç»æè¦åºå¯¹çåºæ¯å°±æ¯ï¼ç¬æ¶æµ·éè¯·æ±ã\n\n\n# ç§æç³»ç»çé¾ç¹\n\n * é«å¹¶åï¼ç§æç³»ç»æ¯æè´çé«å¹¶åºæ¯åèªä¸ç¨è¯´ãå¶é«å¹¶åå¯ä»¥ç»åä¸ºäºï¼\n   * å¹¶åè¯»ï¼ä¸»è¦æ¯è¯»åå©ä½åºå­éä»¥åååä¿¡æ¯\n   * å¹¶ååï¼ä¸»è¦æ¯ä¸ååï¼ç³»ç»åå¥è®¢åè®°å½\n * è¶åï¼ç§æç³»ç»ä¸­å®åçååä¸è¬é½æ¯æ§ä»·æ¯å¾é«ï¼ä¸æä¹èµé±ï¼çè³èµé±èµååçååãä¸æ¦åºç°è¶åç°è±¡ï¼ä¼ç»åå®¶å¸¦æ¥å·¨å¤§çç»æµæå¤±ãä»ç³»ç»å±é¢æ¥çï¼æ¯å¦æç§æååæ¬æ¥åºå­ 100 ä»¶ï¼ä½æ¯å¨é«å¹¶ååºæ¯ä¸ï¼ç¬æ¶ä¸åéè¶è¿ 100 ä»¶ï¼å¤çä¸å½ï¼è®©è¿äºä¸åé½æåäºï¼å°±ä¼åºç°è¶åã\n * æ¶æè¯·æ±ï¼æäºäººä¸ºäºä½ä»·è´­å¥ç§æååï¼éè¿å¨å¤å°æºå¨ä¸è·èæ¬ï¼æ¨¡æå¤§éç¨æ·æ¢ååçè¯·æ±ï¼èµ°èªå·±çè·¯ï¼è®©å«äººæ è·¯å¯èµ°ï¼ã\n * æ°æ®åºå´©æºï¼æµ·éè¯·æ±ä¸ï¼å¦ææ²¡æ mq åå³°ï¼æ²¡æè¿è½½ä¿æ¤ï¼è®©ææè¯·æ±é½æå°æ°æ®åºï¼é£ä¹æ°æ®åºåºæ¬å°±æäºãæ°æ®åºå¦ææäºï¼ä¹ä¼æ³¢åå¶ä»ä¸å¡ï¼ä»èå¯è½è®©æ´ä¸ªç³»ç»ãç½ç«é·å¥ç«çªã\n * å¯¹ç°æä¸å¡é æå²å»\n\n\n# ç§æç³»ç»çæè\n\n\n# ç¨³åå¿«\n\nç§æç³»ç»æ¶æçæèè§åº¦å¯ä»¥æ¦æ¬ä¸ºï¼ç¨³ãåãå¿«\n\n * ç¨³ï¼é«å¯ç¨ï¼ï¼ç³»ç»æ¶æè¦æ»¡è¶³é«å¯ç¨ï¼ç³»ç»è¦è½æä½æ´»å¨ã\n * åï¼ä¸è´æ§ï¼ï¼ååååºå­æ¹å¼éå¸¸å³é®ï¼ä¸è½åºç°è¶åã\n * å¿«ï¼é«æ§è½ï¼ï¼æ´ä¸ªè¯·æ±é¾è·¯ï¼ä»åç«¯å°åç«¯ï¼ä¾èµç»ä»¶é½è¦åå°ååä¼åã\n\n\n\n\n# åç«¯ä¼å\n\n\n# éæé¡µé¢\n\næç§æååé¡µé¢éæåï¼åå°æ¥æ°æ®åºç io å¼éãç¶åï¼å¯ä»¥å°è¿äºéæé¡µé¢å cdn ç¼å­ï¼å¦æé¡¹ç®æ¯ååç«¯åç¦»çï¼è¿å¯ä»¥å¨ååä»£çæå¡å¨ä¾§è®¾ç½®éæç¼å­ã\n\nå¦æ¯ä¸ªååé½ç± id æ¥æ è¯ï¼é£ä¹ http://item.xxx.com/item.htm?id=xxxx å°±å¯ä»¥ä½ä¸ºå¯ä¸ç url æ è¯ãç¸åºçé¡µé¢å¯ä»¥æåååç«¯ç¼å­ï¼è¿æ ·å°±ä¸éè¦ååå°æ¥è¯¢ååä¿¡æ¯ã\n\n\n# æé®æ§å¶\n\nå¨ç§ææ´»å¨å¼å¯æ¶é´åï¼ä¸åæé®ç¦ç¨ã\n\næ­¤å¤ï¼æé®ä¸æ¦ç¹å»ä¹åï¼ç¦ç¨ä¸æ®µæ¶é´ï¼é²æ­¢æäººç¯çè¾åºã\n\n\n# åç«¯ä¼å\n\n\n# éç¦»\n\nç§ææ´»å¨ï¼æ¬è´¨ä¸è¿æ¯ä¸ä¸ªè¥éæ´»å¨ï¼æ§è´¨åææãä¿éä¸æ ·ã\n\nç§æç³»ç»è®¾è®¡åºçº¿ååï¼æ¯ä¸åºè¯¥å½±åç°æä¸å¡ãæä»¥ï¼ä¸ºäºé¿åé²ä¸èé²ï¼ç¾å¯ä¸ççæåµä¸ï¼ç§æç³»ç»å´©äºã\n\n\n# éæµãçæ­ãéçº§ãéç¦»\n\n * éç¦»ï¼å°ç§æç³»ç»ãæ°æ®ä¸å¶ä»æ­£å¸¸ä¸å¡éç¦»ãå½¼æ­¤éç¦»ï¼èªç¶äºä¸å½±åã\n\n * éæµï¼è®¾ç½®éå¼ï¼è¶è¿éå¼ï¼æç»è¯·æ±ãé²æ­¢æ°æ®åºè¢«ææ­»ã\n\n * éçº§ï¼ä¿è¯æ ¸å¿ä¸å¡ç»§ç»­å·¥ä½ï¼éæ ¸å¿ä¸å¡åå®å¤©å½ã\n\n * çæ­ï¼ä¸è¦å½±åå«çç³»ç»ã\n\n\n# ç¼å­\n\nç¼å­è¦é¢ç­ï¼é¿åç¬é´æµéå²å»ã\n\næ­¤å¤ï¼é²æ­¢éªå´©ãç©¿éãå»ç©¿é®é¢çå¸¸è§å¤çè¦åå¥½ã\n\nç¼å­ä¹è¦ä¿è¯é«å¯ç¨ã\n\n\n# æµéåå³°\n\nåå³°çæè·¯ï¼æéãç­é¢ãåå±è¿æ»¤ã\n\n * æéï¼ç¨æ¶æ¯éåæ¥ç¼å²ç¬æ¶æµéçæ¹æ¡ãä½æ¯ï¼æ¶æ¯éåèªèº«ä¹æä¸éï¼å¦æç§¯åè¿å¤ï¼ä¹ä¼å¤çä¸äºã\n * ç­é¢ï¼æä¸æï¼ï¼å¯ä»¥éå¶ç§æå¨å¹¶å»¶ç¼è¯·æ±ã\n * åå±è¿æ»¤ï¼éç¨æ¼æå¼çè®¾è®¡å°½å¯è½æ¦æªæ æè¯·æ±ã\n\n\n\n\n# ååºå­\n\n# æ¶æä¸å\n\næ¶æä¸åçè§£å³æ¹æ¡è¿æ¯è¦ç»åå®å¨ååä½å¼æªæ½æ¥å¶æ­¢ï¼\n\n * è¯å«é¢ç¹ä¸åä¸ä»æ¬¾æéå¤ä¸åä¸ä»æ¬¾çåå®¶ï¼é»æ­å¶ä¸åã\n * éå¶ä¸ªäººè´­ä¹°æ°\n\n# é¿åè¶å\n\nååºå­å¨æ°æ®ä¸è´æ§ä¸ï¼ä¸»è¦å°±æ¯ä¿è¯å¤§å¹¶åè¯·æ±æ¶åºå­æ°æ®ä¸è½ä¸ºè´æ°ï¼ä¹å°±æ¯è¦ä¿è¯æ°æ®åºä¸­çåºå­å­æ®µå¼ä¸è½ä¸ºè´æ°ï¼ä¸è¬æä»¬æå¤ç§è§£å³æ¹æ¡ï¼ä¸ç§æ¯å¨åºç¨ç¨åºä¸­éè¿äºå¡æ¥å¤æ­ï¼å³ä¿è¯åååºå­ä¸è½ä¸ºè´æ°ï¼å¦åå°±åæ»ï¼å¦ä¸ç§åæ³æ¯ç´æ¥è®¾ç½®æ°æ®åºçå­æ®µæ°æ®ä¸ºæ ç¬¦å·æ´æ°ï¼è¿æ ·åååºå­å­æ®µå¼å°äºé¶æ¶ä¼ç´æ¥æ§è¡ sql è¯­å¥æ¥æ¥éï¼åæä¸ç§å°±æ¯ä½¿ç¨ case when å¤æ­è¯­å¥ï¼ä¾å¦è¿æ ·ç sql è¯­å¥ï¼\n\nupdate item set inventory = case when inventory >= xxx then inventory-xxx else inventory end\n\n\nå¨äº¤æç¯èä¸­ï¼âåºå­âæ¯ä¸ªå³é®æ°æ®ï¼ä¹æ¯ä¸ªç­ç¹æ°æ®ï¼å ä¸ºäº¤æçåä¸ªç¯èä¸­é½å¯è½æ¶åå¯¹åºå­çæ¥è¯¢ãä½æ¯ï¼æå¨åé¢ä»ç»åå±è¿æ»¤æ¶æå°è¿ï¼ç§æä¸­å¹¶ä¸éè¦å¯¹åºå­æç²¾ç¡®çä¸è´æ§è¯»ï¼æåºå­æ°æ®æ¾å°ç¼å­ï¼cacheï¼ä¸­ï¼å¯ä»¥å¤§å¤§æåè¯»æ§è½ã\n\n\n# url å¨æå\n\néè¿ md5 ä¹ç±»çå å¯ç®æ³å å¯éæºçå­ç¬¦ä¸²å»å urlï¼ç¶åéè¿åç«¯ä»£ç è·å url åå°æ ¡éªæè½éè¿ã\n\n\n# åèèµæ\n\n * å¦ä½è®¾è®¡ä¸ä¸ªç§æç³»ç»\n * ä¸ä¸ªç§æç³»ç»çè®¾è®¡æè",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¤è¯åææ",frontmatter:{title:"è®¤è¯åææ",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","å®å¨"],tags:["æ¶æ","å®å¨","è®¤è¯","ææ"],permalink:"/pages/0c680e/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/02.%E5%AE%89%E5%85%A8/01.%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83.html",relativePath:"01.æ¶æ/02.å®å¨/01.è®¤è¯åææ.md",key:"v-fea1ca6c",path:"/pages/0c680e/",headers:[{level:2,title:"åºæ¬æ¦å¿µ",slug:"åºæ¬æ¦å¿µ",normalizedTitle:"åºæ¬æ¦å¿µ",charIndex:46},{level:3,title:"è®¤è¯",slug:"è®¤è¯",normalizedTitle:"è®¤è¯",charIndex:2},{level:3,title:"ææ",slug:"ææ",normalizedTitle:"ææ",charIndex:5},{level:3,title:"é´æ",slug:"é´æ",normalizedTitle:"é´æ",charIndex:1107},{level:3,title:"æéæ§å¶",slug:"æéæ§å¶",normalizedTitle:"æéæ§å¶",charIndex:1534},{level:3,title:"è®¤è¯ãææãé´æåæéæ§å¶çå³ç³»",slug:"è®¤è¯ãææãé´æåæéæ§å¶çå³ç³»",normalizedTitle:"è®¤è¯ãææãé´æåæéæ§å¶çå³ç³»",charIndex:2139},{level:2,title:"JWT",slug:"jwt",normalizedTitle:"jwt",charIndex:38},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2623}],headersStr:"åºæ¬æ¦å¿µ è®¤è¯ ææ é´æ æéæ§å¶ è®¤è¯ãææãé´æåæéæ§å¶çå³ç³» JWT åèèµæ",content:"# è®¤è¯åææ\n\n> å³é®è¯ï¼SSOãOauth 2.0ãCASãRABCãJWT\n\n\n# åºæ¬æ¦å¿µ\n\n\n# è®¤è¯\n\nè®¤è¯æ¯ææ ¹æ®å£°æèæç¹æçè¯å«ä¿¡æ¯ï¼ç¡®è®¤å£°æèçèº«ä»½ãè®¤è¯å¨è±æä¸­å¯¹åºäº identification è¿ä¸ªåè¯ã\n\næå¸¸è§çè®¤è¯å®ç°æ¹å¼æ¯éè¿ç¨æ·ååå¯ç ï¼ä½è®¤è¯æ¹å¼ä¸éäºæ­¤ãä¸é¢é½æ¯å½åå¸¸è§å°çè®¤è¯ææ¯ï¼\n\n * èº«ä»½è¯\n * ç¨æ·ååå¯ç è®¤è¯\n * ç¨æ·ææºè®¤è¯ï¼ææºç­ä¿¡ãææºäºç»´ç æ«æãæå¿å¯ç \n * ç¨æ·é®ç®±è®¤è¯\n * åºäºæ¶é´åºååç¨æ·ç¸å³çä¸æ¬¡æ§å£ä»¤\n * ç¨æ·ççç©å­¦ç¹å¾è®¤è¯ï¼æçº¹ãè¯­é³ãç¼çè¹è\n * ç¨æ·çå¤§æ°æ®è¯å«è®¤è¯\n * ç­ç­\n\nä¸ºäºç¡®è®¤ç¨æ·çèº«ä»½ï¼é²æ­¢ä¼ªé ï¼å¨å®å¨è¦æ±é«çåºåï¼ç»å¸¸ä¼ä½¿ç¨ç»åè®¤è¯ï¼æèå«å¤å ç´ è®¤è¯ï¼ï¼ä¹å°±æ¯åæ¶ä½¿ç¨å¤ä¸ªè®¤è¯æ¹å¼å¯¹ç¨æ·çèº«ä»½è¿è¡æ ¡éªã\n\n\n# ææ\n\nç®åæ¥è¯´ï¼ææä¸è¬æ¯æè·åç¨æ·çå§æ´¾æéãå¨è±æä¸­å¯¹åºäº authorization è¿ä¸ªåè¯ã\n\nå¨ä¿¡æ¯å®å¨é¢åï¼æææ¯æèµæºææèå§æ´¾æ§è¡èï¼èµäºæ§è¡èæå®èå´çèµæºæä½æéï¼ä»¥ä¾¿æ§è¡èä»£çæ§è¡å¯¹èµæºçç¸å³æä½ãè¿éé¢åå«æå¦ä¸åä¸ªéè¦æ¦å¿µï¼\n\n * èµæºææèï¼æ¥æèµæºçæææå©ï¼ä¸è¬å°±æ¯èµæºçæ¥æèã\n * èµæºæ§è¡èï¼è¢«å§æ´¾å»æ§è¡èµæºçç¸å³æä½ã\n * æä½æéï¼å¯ä»¥å¯¹èµæºè¿è¡çæç§æä½ã\n * èµæºï¼æä»·å¼çä¿¡æ¯ææ°æ®ç­ï¼åå°å®å¨ä¿æ¤ã\n\néè¦è¯´æçæ¯ï¼èµæºææèåæ§è¡èå¯ä»¥æ¯èªç¶äººï¼å°±æ¯æ®éç¨æ·ï¼ä½ä¸éäºèªç¶äººãå¨ä¿¡æ¯å®å¨é¢åï¼èµæºææèåæ§è¡èï¼å¾å¤æ¶åæ¯åºç¨ç¨åºæèæºå¨ãæ¯å¦ç¨æ·å¨æµè§å¨ä¸ç»å½ä¸ä¸ªç½ç«ï¼é£ä¹è¿ä¸ªæµè§å¨å°±æä¸ºä¸ä¸ªæ§è¡èï¼å®å¨ç¨æ·ç»å½åè·åäºç¨æ·çææï¼ä»£è¡¨çç¨æ·æ§è¡åç§æä»¤ï¼è¿è¡è´­ç©ãä¸åãä»é±ãè½¬è´¦ç­ç­æä½ã\n\nåæ¶ï¼èµæºææèåæ§è¡èå¯ä»¥æ¯åå¼çä¸åå®ä½ï¼ä¹å¯ä»¥æ¯åä¸ä¸ªãè¥æ¯åå¼çä¸¤èï¼åèµæºæ§è¡èæ¯ä»¥èµæºææèçä»£çå½¢å¼èå­å¨ã\n\nææçå®ç°æ¹å¼éå¸¸å¤ä¹å¾å¹¿æ³ï¼æä»¬å¸¸è§çé¶è¡å¡ãé¨ç¦å¡ãé¥åãå¬è¯ä¹¦ï¼è¿äºé½æ¯ç°å®çæ´»ä¸­ææçå®ç°æ¹å¼ãå¶å®ç°æ¹å¼ä¸»è¦éè¿ä¸ä¸ªå±ä¿¡çåªä»å®æï¼è¿ä¸ªåªä»ä¸å¯è¢«ç¯¡æ¹ï¼ä¸å¯éæä¼ªé ï¼å¾å¤æ¶åéè¦åä¿æ¤ï¼é²æ­¢è¢«çªåã\n\nå¨äºèç½åºç¨å¼åé¢åï¼æææç¨å°çæä¿¡åªä»ä¸»è¦åæ¬å¦ä¸å ç§ï¼\n\n * éè¿ web æå¡å¨ç session æºå¶ï¼ä¸ä¸ªè®¿é®ä¼è¯ä¿æçç¨æ·çææä¿¡æ¯\n * éè¿ web æµè§å¨ç cookie æºå¶ï¼ä¸ä¸ªç½ç«ç cookie ä¿æçç¨æ·çææä¿¡æ¯\n * é¢åææä»¤çï¼tokenï¼ï¼ä¸ä¸ªåæ³ææçä»¤çä¸­ä¿æçç¨æ·çææä¿¡æ¯\n\nåé¢ä¸¤èå¸¸è§äº web å¼åï¼éè¦ææµè§å¨çæ¯æã\n\n\n# é´æ\n\né´ææ¯æå¯¹äºä¸ä¸ªå£°æèæå£°æçèº«ä»½æå©ï¼å¯¹å¶æå£°æççå®æ§è¿è¡é´å«ç¡®è®¤çè¿ç¨ãå¨è±æä¸­å¯¹åºäº authentication è¿ä¸ªåè¯ã\n\né´æä¸»è¦æ¯å¯¹å£°æèæå£°æççå®æ§è¿è¡æ ¡éªãè¥ä»ææåºåï¼åä¼æ´å å®¹æçè§£é´æãææåé´ææ¯ä¸¤ä¸ªä¸ä¸æ¸¸ç¸å¹éçå³ç³»ï¼åææï¼åé´æãææåé´æä¸¤ä¸ªè¯ä¸­çâæâï¼æ¯åä¸ä¸ªæ¦å¿µï¼å°±æ¯æå§æ´¾çæå©ï¼å¨å®ç°ä¸å³ä¸ºæä¿¡åªä»çè¡¨è¾¾å½¢å¼ã\n\nå æ­¤ï¼é´æçå®ç°æ¹å¼æ¯åæææ¹å¼æä¸ä¸å¯¹åºå³ç³»ãå¯¹æææé¢åæä¿¡åªä»è¿è¡è§£æï¼ç¡®è®¤å¶çå®æ§ãä¸é¢æ¯é´æçä¸äºå®ç°æ¹å¼ï¼\n\n * é¨ç¦å¡ï¼éè¿é¨ç¦å¡è¯å«å¨\n * é¥åï¼éè¿ç¸å¹éçé\n * é¶è¡å¡ï¼éè¿é¶è¡å¡è¯å«å¨\n * äºèç½ web å¼åé¢åç session/cookie/tokenï¼æ ¡éª session/cookie/token çåæ³æ§åæææ§\n\né´ææ¯ä¸ä¸ªæ¿ä¸å¯ä¸çä¸ä¸ªç¯èï¼ä¸æ¸¸å®æ¥åææçè¾åºï¼æ ¡éªå¶çå®æ§åï¼ç¶åè·åæéï¼permissionï¼ï¼è¿ä¸ªå°ä¼ä¸ºä¸ä¸æ­¥çæéæ§å¶åå¥½åå¤ã\n\n\n# æéæ§å¶\n\næéæ§å¶æ¯æå¯¹å¯æ§è¡çåç§æä½ç»åéç½®ä¸ºæéåè¡¨ï¼ç¶åæ ¹æ®æ§è¡èçæéï¼è¥å¶æä½å¨æéèå´åï¼ååè®¸æ§è¡ï¼å¦åç¦æ­¢ãæéæ§å¶å¨è±æä¸­å¯¹åºäº access/permission controlã\n\nå¯¹äºæéæ§å¶ï¼å¯ä»¥åä¸ºä¸¤é¨åè¿è¡çè§£ï¼ä¸ä¸ªæ¯æéï¼å¦ä¸ä¸ªæ¯æ§å¶ãæéæ¯æ½è±¡çé»è¾æ¦å¿µï¼èæ§å¶æ¯å·ä½çå®ç°æ¹å¼ã\n\nåçæéï¼Permissionï¼ï¼è¿æ¯ä¸ä¸ªæ½è±¡çæ¦å¿µï¼ä¸è¬é¢åå®ä¹åéç½®å¥½ï¼ä»¥ä¾¿æ§å¶çå·ä½å®ç°ãæéçå®ä¹ï¼è¥ç®åç¹ï¼å¯ä»¥ç´æ¥å¯¹åºäºä¸ä¸ªå¯æ§è¡çæä½éåãèä¸è¬æåµä¸ï¼ä¼æåºäºè§è²çæ¹å¼æ¥å®ä¹æéï¼ç±è§è²æ¥å°è£å¯æ§è¡çæä½éåã\n\nè¥ä»¥é¨ç¦å¡çæéå®ç°ä¸ºä¾ï¼ä¸è¿°ä¸¤ç§å®ä¹æ¹å¼åå¯ä»¥åèªè¡¨è¾¾ä¸ºï¼\n\n * è¿æ¯ä¸ä¸ªé¨ç¦å¡ï¼æ¥æå¼å¬å¸ææçé¨çæé\n * è¿æ¯ä¸ä¸ªé¨ç¦å¡ï¼æ¥æç®¡çåè§è²çæéï¼å èå¯ä»¥å¼å¬å¸ææçé¨\n\nå¯ä»¥çå°ï¼æéä½ä¸ºä¸ä¸ªæ½è±¡çæ¦å¿µï¼å°æ§è¡èåå¯å·ä½æ§è¡çæä½ç¸åç¦»ã\n\nå¨ä¸æçè®¨è®ºä¸­ï¼é´æçè¾åºæ¯æéï¼Permissionï¼ãä¸æ¦æäºæéï¼ä¾¿ç¥éäºå¯æ§è¡çæä½ï¼æ¥ä¸æ¥å°±æ¯æ§å¶çäºæäºã\n\nå¯¹äºæ§å¶ï¼æ¯æ ¹æ®æ§è¡èçæéï¼å¯¹å¶ææ§è¡çæä½è¿è¡å¤æ­ï¼å³å®åè®¸æç¦æ­¢å½åæä½çæ§è¡ãç°å®çæ´»ä¸­æ§å¶çå®ç°æ¹å¼ï¼å¤ç§å¤æ ·ï¼\n\n * é¨ç¦ï¼æ§å¶é¨çå¼å³\n * èªè¡è½¦éï¼æ§å¶è½¦è½®\n * äºèç½ web åç«¯æå¡ï¼æ§å¶æ¥å£è®¿é®ï¼åè®¸ææç»è®¿é®è¯·æ±\n\n\n# è®¤è¯ãææãé´æåæéæ§å¶çå³ç³»\n\nè®¤è¯ãææãé´æåæéæ§å¶è¿åä¸ªç¯èæ¯ä¸ä¸ªååä¾æ¬¡åçãä¸ä¸æ¸¸çå³ç³»ï¼\n\nè®¤è¯--\x3eææ--\x3eé´æ--\x3eæéæ§å¶\n\néè¦è¯´æçæ¯ï¼è¿åä¸ªç¯èå¨æäºæ¶åä¼åæ¶åçã ä¾å¦å¨ä¸é¢çå ä¸ªåºæ¯ï¼\n\n * ä½¿ç¨é¨ç¦å¡å¼é¨ï¼è®¤è¯ãææãé´æãæéæ§å¶åä¸ªç¯èä¸æ°åµæï¼å¨ç¬é´åæ¶åç\n * ç¨æ·çç½ç«ç»å½ï¼ç¨æ·å¨ä½¿ç¨ç¨æ·ååå¯ç è¿è¡ç»å½æ¶ï¼è®¤è¯åææä¸¤ä¸ªç¯èä¸åå®æï¼èé´æåæéæ§å¶ååçå¨åç»­çè¯·æ±è®¿é®ä¸­ï¼æ¯å¦å¨éè´­ç©åææ¯ä»æ¶ã\n\næ è®ºææ ·ï¼è¥ä»æ¶é´é¡ºåºæ¹é¢æ¥çï¼è¿åä¸ªç¯èæ¯ææ¶é´ååãä¾æ¬¡ç¸ç»§åççå³ç³»ã\n\nè®¤è¯åé´æçå³ç³»ï¼\n\nè¿ä¸¤ä¸ªæ¦å¿µå¨å¾å¤æ¶åæ¯è¢«æ··æ·æå¤çæ¦å¿µãè¢«æ··æ·çä¸»è¦åå ï¼å¦ä¸ææè¿°ï¼å¾å¤æ¶åè®¤è¯ãææãé´æåæéæ§å¶ä¸ååçï¼ä»¥è³äºè¢«è¯¯è§£ä¸ºï¼è®¤è¯å°±æ¯é´æï¼é´æå°±æ¯è®¤è¯ã\n\nå¶å®ä¸¤èæ¯ä¸ä¸æ ·çæ¦å¿µï¼ä¸¤èé½æå¯¹èº«ä»½çç¡®è®¤è¿ç¨ï¼ä½æ¯ä¸¤èçä¸»è¦åºå«å¨äºï¼\n\n * è®¤è¯æ¯ç¡®è®¤å£°æèçæ¬èº«èº«ä»½ï¼å¶ä½ä¸ºææçä¸æ¸¸è¡æ¥èå­å¨\n * é´ææ¯å¯¹å£°æèæå£°æççå®æ§è¿è¡ç¡®è®¤çè¿ç¨ï¼å¶ä½ä¸ºææçä¸æ¸¸è¡æ¥èå­å¨\n\n\n# JWT\n\n\n# åèèµæ\n\nçè§£ OAuth 2.0",normalizedContent:"# è®¤è¯åææ\n\n> å³é®è¯ï¼ssoãoauth 2.0ãcasãrabcãjwt\n\n\n# åºæ¬æ¦å¿µ\n\n\n# è®¤è¯\n\nè®¤è¯æ¯ææ ¹æ®å£°æèæç¹æçè¯å«ä¿¡æ¯ï¼ç¡®è®¤å£°æèçèº«ä»½ãè®¤è¯å¨è±æä¸­å¯¹åºäº identification è¿ä¸ªåè¯ã\n\næå¸¸è§çè®¤è¯å®ç°æ¹å¼æ¯éè¿ç¨æ·ååå¯ç ï¼ä½è®¤è¯æ¹å¼ä¸éäºæ­¤ãä¸é¢é½æ¯å½åå¸¸è§å°çè®¤è¯ææ¯ï¼\n\n * èº«ä»½è¯\n * ç¨æ·ååå¯ç è®¤è¯\n * ç¨æ·ææºè®¤è¯ï¼ææºç­ä¿¡ãææºäºç»´ç æ«æãæå¿å¯ç \n * ç¨æ·é®ç®±è®¤è¯\n * åºäºæ¶é´åºååç¨æ·ç¸å³çä¸æ¬¡æ§å£ä»¤\n * ç¨æ·ççç©å­¦ç¹å¾è®¤è¯ï¼æçº¹ãè¯­é³ãç¼çè¹è\n * ç¨æ·çå¤§æ°æ®è¯å«è®¤è¯\n * ç­ç­\n\nä¸ºäºç¡®è®¤ç¨æ·çèº«ä»½ï¼é²æ­¢ä¼ªé ï¼å¨å®å¨è¦æ±é«çåºåï¼ç»å¸¸ä¼ä½¿ç¨ç»åè®¤è¯ï¼æèå«å¤å ç´ è®¤è¯ï¼ï¼ä¹å°±æ¯åæ¶ä½¿ç¨å¤ä¸ªè®¤è¯æ¹å¼å¯¹ç¨æ·çèº«ä»½è¿è¡æ ¡éªã\n\n\n# ææ\n\nç®åæ¥è¯´ï¼ææä¸è¬æ¯æè·åç¨æ·çå§æ´¾æéãå¨è±æä¸­å¯¹åºäº authorization è¿ä¸ªåè¯ã\n\nå¨ä¿¡æ¯å®å¨é¢åï¼æææ¯æèµæºææèå§æ´¾æ§è¡èï¼èµäºæ§è¡èæå®èå´çèµæºæä½æéï¼ä»¥ä¾¿æ§è¡èä»£çæ§è¡å¯¹èµæºçç¸å³æä½ãè¿éé¢åå«æå¦ä¸åä¸ªéè¦æ¦å¿µï¼\n\n * èµæºææèï¼æ¥æèµæºçæææå©ï¼ä¸è¬å°±æ¯èµæºçæ¥æèã\n * èµæºæ§è¡èï¼è¢«å§æ´¾å»æ§è¡èµæºçç¸å³æä½ã\n * æä½æéï¼å¯ä»¥å¯¹èµæºè¿è¡çæç§æä½ã\n * èµæºï¼æä»·å¼çä¿¡æ¯ææ°æ®ç­ï¼åå°å®å¨ä¿æ¤ã\n\néè¦è¯´æçæ¯ï¼èµæºææèåæ§è¡èå¯ä»¥æ¯èªç¶äººï¼å°±æ¯æ®éç¨æ·ï¼ä½ä¸éäºèªç¶äººãå¨ä¿¡æ¯å®å¨é¢åï¼èµæºææèåæ§è¡èï¼å¾å¤æ¶åæ¯åºç¨ç¨åºæèæºå¨ãæ¯å¦ç¨æ·å¨æµè§å¨ä¸ç»å½ä¸ä¸ªç½ç«ï¼é£ä¹è¿ä¸ªæµè§å¨å°±æä¸ºä¸ä¸ªæ§è¡èï¼å®å¨ç¨æ·ç»å½åè·åäºç¨æ·çææï¼ä»£è¡¨çç¨æ·æ§è¡åç§æä»¤ï¼è¿è¡è´­ç©ãä¸åãä»é±ãè½¬è´¦ç­ç­æä½ã\n\nåæ¶ï¼èµæºææèåæ§è¡èå¯ä»¥æ¯åå¼çä¸åå®ä½ï¼ä¹å¯ä»¥æ¯åä¸ä¸ªãè¥æ¯åå¼çä¸¤èï¼åèµæºæ§è¡èæ¯ä»¥èµæºææèçä»£çå½¢å¼èå­å¨ã\n\nææçå®ç°æ¹å¼éå¸¸å¤ä¹å¾å¹¿æ³ï¼æä»¬å¸¸è§çé¶è¡å¡ãé¨ç¦å¡ãé¥åãå¬è¯ä¹¦ï¼è¿äºé½æ¯ç°å®çæ´»ä¸­ææçå®ç°æ¹å¼ãå¶å®ç°æ¹å¼ä¸»è¦éè¿ä¸ä¸ªå±ä¿¡çåªä»å®æï¼è¿ä¸ªåªä»ä¸å¯è¢«ç¯¡æ¹ï¼ä¸å¯éæä¼ªé ï¼å¾å¤æ¶åéè¦åä¿æ¤ï¼é²æ­¢è¢«çªåã\n\nå¨äºèç½åºç¨å¼åé¢åï¼æææç¨å°çæä¿¡åªä»ä¸»è¦åæ¬å¦ä¸å ç§ï¼\n\n * éè¿ web æå¡å¨ç session æºå¶ï¼ä¸ä¸ªè®¿é®ä¼è¯ä¿æçç¨æ·çææä¿¡æ¯\n * éè¿ web æµè§å¨ç cookie æºå¶ï¼ä¸ä¸ªç½ç«ç cookie ä¿æçç¨æ·çææä¿¡æ¯\n * é¢åææä»¤çï¼tokenï¼ï¼ä¸ä¸ªåæ³ææçä»¤çä¸­ä¿æçç¨æ·çææä¿¡æ¯\n\nåé¢ä¸¤èå¸¸è§äº web å¼åï¼éè¦ææµè§å¨çæ¯æã\n\n\n# é´æ\n\né´ææ¯æå¯¹äºä¸ä¸ªå£°æèæå£°æçèº«ä»½æå©ï¼å¯¹å¶æå£°æççå®æ§è¿è¡é´å«ç¡®è®¤çè¿ç¨ãå¨è±æä¸­å¯¹åºäº authentication è¿ä¸ªåè¯ã\n\né´æä¸»è¦æ¯å¯¹å£°æèæå£°æççå®æ§è¿è¡æ ¡éªãè¥ä»ææåºåï¼åä¼æ´å å®¹æçè§£é´æãææåé´ææ¯ä¸¤ä¸ªä¸ä¸æ¸¸ç¸å¹éçå³ç³»ï¼åææï¼åé´æãææåé´æä¸¤ä¸ªè¯ä¸­çâæâï¼æ¯åä¸ä¸ªæ¦å¿µï¼å°±æ¯æå§æ´¾çæå©ï¼å¨å®ç°ä¸å³ä¸ºæä¿¡åªä»çè¡¨è¾¾å½¢å¼ã\n\nå æ­¤ï¼é´æçå®ç°æ¹å¼æ¯åæææ¹å¼æä¸ä¸å¯¹åºå³ç³»ãå¯¹æææé¢åæä¿¡åªä»è¿è¡è§£æï¼ç¡®è®¤å¶çå®æ§ãä¸é¢æ¯é´æçä¸äºå®ç°æ¹å¼ï¼\n\n * é¨ç¦å¡ï¼éè¿é¨ç¦å¡è¯å«å¨\n * é¥åï¼éè¿ç¸å¹éçé\n * é¶è¡å¡ï¼éè¿é¶è¡å¡è¯å«å¨\n * äºèç½ web å¼åé¢åç session/cookie/tokenï¼æ ¡éª session/cookie/token çåæ³æ§åæææ§\n\né´ææ¯ä¸ä¸ªæ¿ä¸å¯ä¸çä¸ä¸ªç¯èï¼ä¸æ¸¸å®æ¥åææçè¾åºï¼æ ¡éªå¶çå®æ§åï¼ç¶åè·åæéï¼permissionï¼ï¼è¿ä¸ªå°ä¼ä¸ºä¸ä¸æ­¥çæéæ§å¶åå¥½åå¤ã\n\n\n# æéæ§å¶\n\næéæ§å¶æ¯æå¯¹å¯æ§è¡çåç§æä½ç»åéç½®ä¸ºæéåè¡¨ï¼ç¶åæ ¹æ®æ§è¡èçæéï¼è¥å¶æä½å¨æéèå´åï¼ååè®¸æ§è¡ï¼å¦åç¦æ­¢ãæéæ§å¶å¨è±æä¸­å¯¹åºäº access/permission controlã\n\nå¯¹äºæéæ§å¶ï¼å¯ä»¥åä¸ºä¸¤é¨åè¿è¡çè§£ï¼ä¸ä¸ªæ¯æéï¼å¦ä¸ä¸ªæ¯æ§å¶ãæéæ¯æ½è±¡çé»è¾æ¦å¿µï¼èæ§å¶æ¯å·ä½çå®ç°æ¹å¼ã\n\nåçæéï¼permissionï¼ï¼è¿æ¯ä¸ä¸ªæ½è±¡çæ¦å¿µï¼ä¸è¬é¢åå®ä¹åéç½®å¥½ï¼ä»¥ä¾¿æ§å¶çå·ä½å®ç°ãæéçå®ä¹ï¼è¥ç®åç¹ï¼å¯ä»¥ç´æ¥å¯¹åºäºä¸ä¸ªå¯æ§è¡çæä½éåãèä¸è¬æåµä¸ï¼ä¼æåºäºè§è²çæ¹å¼æ¥å®ä¹æéï¼ç±è§è²æ¥å°è£å¯æ§è¡çæä½éåã\n\nè¥ä»¥é¨ç¦å¡çæéå®ç°ä¸ºä¾ï¼ä¸è¿°ä¸¤ç§å®ä¹æ¹å¼åå¯ä»¥åèªè¡¨è¾¾ä¸ºï¼\n\n * è¿æ¯ä¸ä¸ªé¨ç¦å¡ï¼æ¥æå¼å¬å¸ææçé¨çæé\n * è¿æ¯ä¸ä¸ªé¨ç¦å¡ï¼æ¥æç®¡çåè§è²çæéï¼å èå¯ä»¥å¼å¬å¸ææçé¨\n\nå¯ä»¥çå°ï¼æéä½ä¸ºä¸ä¸ªæ½è±¡çæ¦å¿µï¼å°æ§è¡èåå¯å·ä½æ§è¡çæä½ç¸åç¦»ã\n\nå¨ä¸æçè®¨è®ºä¸­ï¼é´æçè¾åºæ¯æéï¼permissionï¼ãä¸æ¦æäºæéï¼ä¾¿ç¥éäºå¯æ§è¡çæä½ï¼æ¥ä¸æ¥å°±æ¯æ§å¶çäºæäºã\n\nå¯¹äºæ§å¶ï¼æ¯æ ¹æ®æ§è¡èçæéï¼å¯¹å¶ææ§è¡çæä½è¿è¡å¤æ­ï¼å³å®åè®¸æç¦æ­¢å½åæä½çæ§è¡ãç°å®çæ´»ä¸­æ§å¶çå®ç°æ¹å¼ï¼å¤ç§å¤æ ·ï¼\n\n * é¨ç¦ï¼æ§å¶é¨çå¼å³\n * èªè¡è½¦éï¼æ§å¶è½¦è½®\n * äºèç½ web åç«¯æå¡ï¼æ§å¶æ¥å£è®¿é®ï¼åè®¸ææç»è®¿é®è¯·æ±\n\n\n# è®¤è¯ãææãé´æåæéæ§å¶çå³ç³»\n\nè®¤è¯ãææãé´æåæéæ§å¶è¿åä¸ªç¯èæ¯ä¸ä¸ªååä¾æ¬¡åçãä¸ä¸æ¸¸çå³ç³»ï¼\n\nè®¤è¯--\x3eææ--\x3eé´æ--\x3eæéæ§å¶\n\néè¦è¯´æçæ¯ï¼è¿åä¸ªç¯èå¨æäºæ¶åä¼åæ¶åçã ä¾å¦å¨ä¸é¢çå ä¸ªåºæ¯ï¼\n\n * ä½¿ç¨é¨ç¦å¡å¼é¨ï¼è®¤è¯ãææãé´æãæéæ§å¶åä¸ªç¯èä¸æ°åµæï¼å¨ç¬é´åæ¶åç\n * ç¨æ·çç½ç«ç»å½ï¼ç¨æ·å¨ä½¿ç¨ç¨æ·ååå¯ç è¿è¡ç»å½æ¶ï¼è®¤è¯åææä¸¤ä¸ªç¯èä¸åå®æï¼èé´æåæéæ§å¶ååçå¨åç»­çè¯·æ±è®¿é®ä¸­ï¼æ¯å¦å¨éè´­ç©åææ¯ä»æ¶ã\n\næ è®ºææ ·ï¼è¥ä»æ¶é´é¡ºåºæ¹é¢æ¥çï¼è¿åä¸ªç¯èæ¯ææ¶é´ååãä¾æ¬¡ç¸ç»§åççå³ç³»ã\n\nè®¤è¯åé´æçå³ç³»ï¼\n\nè¿ä¸¤ä¸ªæ¦å¿µå¨å¾å¤æ¶åæ¯è¢«æ··æ·æå¤çæ¦å¿µãè¢«æ··æ·çä¸»è¦åå ï¼å¦ä¸ææè¿°ï¼å¾å¤æ¶åè®¤è¯ãææãé´æåæéæ§å¶ä¸ååçï¼ä»¥è³äºè¢«è¯¯è§£ä¸ºï¼è®¤è¯å°±æ¯é´æï¼é´æå°±æ¯è®¤è¯ã\n\nå¶å®ä¸¤èæ¯ä¸ä¸æ ·çæ¦å¿µï¼ä¸¤èé½æå¯¹èº«ä»½çç¡®è®¤è¿ç¨ï¼ä½æ¯ä¸¤èçä¸»è¦åºå«å¨äºï¼\n\n * è®¤è¯æ¯ç¡®è®¤å£°æèçæ¬èº«èº«ä»½ï¼å¶ä½ä¸ºææçä¸æ¸¸è¡æ¥èå­å¨\n * é´ææ¯å¯¹å£°æèæå£°æççå®æ§è¿è¡ç¡®è®¤çè¿ç¨ï¼å¶ä½ä¸ºææçä¸æ¸¸è¡æ¥èå­å¨\n\n\n# jwt\n\n\n# åèèµæ\n\nçè§£ oauth 2.0",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"OAuth 2.0",frontmatter:{title:"OAuth 2.0",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ","å®å¨"],tags:["æ¶æ","å®å¨","è®¤è¯","ææ","OAuth 2.0"],permalink:"/pages/292687/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/02.%E5%AE%89%E5%85%A8/02.OAuth2.0.html",relativePath:"01.æ¶æ/02.å®å¨/02.OAuth2.0.md",key:"v-dc1b4da6",path:"/pages/292687/",headers:[{level:2,title:"ææç æ¨¡å¼",slug:"ææç æ¨¡å¼",normalizedTitle:"ææç æ¨¡å¼",charIndex:251},{level:2,title:"éèæ¨¡å¼",slug:"éèæ¨¡å¼",normalizedTitle:"éèæ¨¡å¼",charIndex:538},{level:2,title:"å¯ç æ¨¡å¼",slug:"å¯ç æ¨¡å¼",normalizedTitle:"å¯ç æ¨¡å¼",charIndex:298},{level:2,title:"å®¢æ·ç«¯å­è¯æ¨¡å¼",slug:"å®¢æ·ç«¯å­è¯æ¨¡å¼",normalizedTitle:"å®¢æ·ç«¯å­è¯æ¨¡å¼",charIndex:757},{level:2,title:"ä»¤ççä½¿ç¨",slug:"ä»¤ççä½¿ç¨",normalizedTitle:"ä»¤ççä½¿ç¨",charIndex:796},{level:2,title:"ä»¤ççæ´æ°",slug:"ä»¤ççæ´æ°",normalizedTitle:"ä»¤ççæ´æ°",charIndex:806},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1029}],headersStr:"ææç æ¨¡å¼ éèæ¨¡å¼ å¯ç æ¨¡å¼ å®¢æ·ç«¯å­è¯æ¨¡å¼ ä»¤ççä½¿ç¨ ä»¤ççæ´æ° åèèµæ",content:'# OAuth 2.0\n\n> OAuth æ¯ä¸ä¸ªå³äºææï¼authorizationï¼çå¼æ¾ç½ç»æ åï¼å¨å¨ä¸çå¾å°å¹¿æ³åºç¨ï¼ç®åççæ¬æ¯ 2.0 çã\n\nç®åæ¥è¯´ï¼OAuth æ¯ä¸ç§æææºå¶ãèµæºçææèåè¯ç³»ç»ï¼åæææç¬¬ä¸æ¹åºç¨è¿å¥ç³»ç»ï¼è®¿é®è¿äºèµæºãç³»ç»ä»èäº§çä¸ä¸ªç­æçè¿å¥ä»¤çï¼tokenï¼ï¼ç¨æ¥ä»£æ¿å¯ç ï¼ä¾ç¬¬ä¸æ¹åºç¨ä½¿ç¨ã\n\nå®¢æ·ç«¯å¿é¡»å¾å°ç¨æ·çææï¼authorization grantï¼ï¼æè½è·å¾ä»¤çï¼access tokenï¼ã\n\nOAuth 2.0 å®ä¹äºåç§æææ¹å¼ã\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\n\n# ææç æ¨¡å¼\n\nææç ï¼authorization codeï¼æ¹å¼ï¼æçæ¯ç¬¬ä¸æ¹åºç¨åç³è¯·ä¸ä¸ªææç ï¼ç¶ååç¨è¯¥ææç è·åä»¤çã\n\nè¿ç§æ¹å¼æ¯æå¸¸ç¨çæµç¨ï¼å®å¨æ§ä¹æé«ï¼å®éç¨äºé£äºæåç«¯ç Web åºç¨ãææç éè¿åç«¯ä¼ éï¼ä»¤çåæ¯å¨å­å¨åç«¯ï¼èä¸ææä¸èµæºæå¡å¨çéä¿¡é½å¨åç«¯å®æãè¿æ ·çååç«¯åç¦»ï¼å¯ä»¥é¿åä»¤çæ³æ¼ã\n\n\n# éèæ¨¡å¼\n\næäº Web åºç¨æ¯çº¯åç«¯åºç¨ï¼æ²¡æåç«¯ãè¿æ¶å°±ä¸è½ç¨ä¸é¢çæ¹å¼äºï¼å¿é¡»å°ä»¤çå¨å­å¨åç«¯ãRFC 6749 å°±è§å®äºç¬¬äºç§æ¹å¼ï¼åè®¸ç´æ¥ååç«¯é¢åä»¤çãè¿ç§æ¹å¼æ²¡æææç è¿ä¸ªä¸­é´æ­¥éª¤ï¼æä»¥ç§°ä¸ºï¼ææç ï¼"éèå¼"ï¼implicitï¼ã\n\n\n# å¯ç æ¨¡å¼\n\nå¦æä½ é«åº¦ä¿¡ä»»æä¸ªåºç¨ï¼RFC 6749 ä¹åè®¸ç¨æ·æç¨æ·ååå¯ç ï¼ç´æ¥åè¯è¯¥åºç¨ãè¯¥åºç¨å°±ä½¿ç¨ä½ çå¯ç ï¼ç³è¯·ä»¤çï¼è¿ç§æ¹å¼ç§°ä¸º"å¯ç å¼"ï¼passwordï¼ã\n\n\n# å®¢æ·ç«¯å­è¯æ¨¡å¼\n\néç¨äºæ²¡æåç«¯çå½ä»¤è¡åºç¨ï¼å³å¨å½ä»¤è¡ä¸è¯·æ±ä»¤çã\n\n\n# ä»¤ççä½¿ç¨\n\n\n# ä»¤ççæ´æ°\n\nå¦æç¨æ·è®¿é®çæ¶åï¼å®¢æ·ç«¯ç"è®¿é®ä»¤ç"å·²ç»è¿æï¼åéè¦ä½¿ç¨"æ´æ°ä»¤ç"ç³è¯·ä¸ä¸ªæ°çè®¿é®ä»¤çã\n\nå®¢æ·ç«¯ååºæ´æ°ä»¤çç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼æ­¤å¤çå¼åºå®ä¸º"refreshtoken"ï¼å¿éé¡¹ã\n * refresh_tokenï¼è¡¨ç¤ºæ©åæ¶å°çæ´æ°ä»¤çï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºç³è¯·çææèå´ï¼ä¸å¯ä»¥è¶åºä¸ä¸æ¬¡ç³è¯·çèå´ï¼å¦æçç¥è¯¥åæ°ï¼åè¡¨ç¤ºä¸ä¸ä¸æ¬¡ä¸è´\n\n\n# åèèµæ\n\n * RFC 6749\n * OAuth 2.0 çä¸ä¸ªç®åè§£é\n * çè§£ OAuth 2.0\n * The Simplest Guide To OAuth 2.0',normalizedContent:'# oauth 2.0\n\n> oauth æ¯ä¸ä¸ªå³äºææï¼authorizationï¼çå¼æ¾ç½ç»æ åï¼å¨å¨ä¸çå¾å°å¹¿æ³åºç¨ï¼ç®åççæ¬æ¯ 2.0 çã\n\nç®åæ¥è¯´ï¼oauth æ¯ä¸ç§æææºå¶ãèµæºçææèåè¯ç³»ç»ï¼åæææç¬¬ä¸æ¹åºç¨è¿å¥ç³»ç»ï¼è®¿é®è¿äºèµæºãç³»ç»ä»èäº§çä¸ä¸ªç­æçè¿å¥ä»¤çï¼tokenï¼ï¼ç¨æ¥ä»£æ¿å¯ç ï¼ä¾ç¬¬ä¸æ¹åºç¨ä½¿ç¨ã\n\nå®¢æ·ç«¯å¿é¡»å¾å°ç¨æ·çææï¼authorization grantï¼ï¼æè½è·å¾ä»¤çï¼access tokenï¼ã\n\noauth 2.0 å®ä¹äºåç§æææ¹å¼ã\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\n\n# ææç æ¨¡å¼\n\nææç ï¼authorization codeï¼æ¹å¼ï¼æçæ¯ç¬¬ä¸æ¹åºç¨åç³è¯·ä¸ä¸ªææç ï¼ç¶ååç¨è¯¥ææç è·åä»¤çã\n\nè¿ç§æ¹å¼æ¯æå¸¸ç¨çæµç¨ï¼å®å¨æ§ä¹æé«ï¼å®éç¨äºé£äºæåç«¯ç web åºç¨ãææç éè¿åç«¯ä¼ éï¼ä»¤çåæ¯å¨å­å¨åç«¯ï¼èä¸ææä¸èµæºæå¡å¨çéä¿¡é½å¨åç«¯å®æãè¿æ ·çååç«¯åç¦»ï¼å¯ä»¥é¿åä»¤çæ³æ¼ã\n\n\n# éèæ¨¡å¼\n\næäº web åºç¨æ¯çº¯åç«¯åºç¨ï¼æ²¡æåç«¯ãè¿æ¶å°±ä¸è½ç¨ä¸é¢çæ¹å¼äºï¼å¿é¡»å°ä»¤çå¨å­å¨åç«¯ãrfc 6749 å°±è§å®äºç¬¬äºç§æ¹å¼ï¼åè®¸ç´æ¥ååç«¯é¢åä»¤çãè¿ç§æ¹å¼æ²¡æææç è¿ä¸ªä¸­é´æ­¥éª¤ï¼æä»¥ç§°ä¸ºï¼ææç ï¼"éèå¼"ï¼implicitï¼ã\n\n\n# å¯ç æ¨¡å¼\n\nå¦æä½ é«åº¦ä¿¡ä»»æä¸ªåºç¨ï¼rfc 6749 ä¹åè®¸ç¨æ·æç¨æ·ååå¯ç ï¼ç´æ¥åè¯è¯¥åºç¨ãè¯¥åºç¨å°±ä½¿ç¨ä½ çå¯ç ï¼ç³è¯·ä»¤çï¼è¿ç§æ¹å¼ç§°ä¸º"å¯ç å¼"ï¼passwordï¼ã\n\n\n# å®¢æ·ç«¯å­è¯æ¨¡å¼\n\néç¨äºæ²¡æåç«¯çå½ä»¤è¡åºç¨ï¼å³å¨å½ä»¤è¡ä¸è¯·æ±ä»¤çã\n\n\n# ä»¤ççä½¿ç¨\n\n\n# ä»¤ççæ´æ°\n\nå¦æç¨æ·è®¿é®çæ¶åï¼å®¢æ·ç«¯ç"è®¿é®ä»¤ç"å·²ç»è¿æï¼åéè¦ä½¿ç¨"æ´æ°ä»¤ç"ç³è¯·ä¸ä¸ªæ°çè®¿é®ä»¤çã\n\nå®¢æ·ç«¯ååºæ´æ°ä»¤çç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼æ­¤å¤çå¼åºå®ä¸º"refreshtoken"ï¼å¿éé¡¹ã\n * refresh_tokenï¼è¡¨ç¤ºæ©åæ¶å°çæ´æ°ä»¤çï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºç³è¯·çææèå´ï¼ä¸å¯ä»¥è¶åºä¸ä¸æ¬¡ç³è¯·çèå´ï¼å¦æçç¥è¯¥åæ°ï¼åè¡¨ç¤ºä¸ä¸ä¸æ¬¡ä¸è´\n\n\n# åèèµæ\n\n * rfc 6749\n * oauth 2.0 çä¸ä¸ªç®åè§£é\n * çè§£ oauth 2.0\n * the simplest guide to oauth 2.0',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»æ¶ææ¦è¿°",frontmatter:{title:"ç³»ç»æ¶ææ¦è¿°",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ"],permalink:"/pages/ce2da4/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/02.%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E6%A6%82%E8%BF%B0.html",relativePath:"01.æ¶æ/02.ç³»ç»æ¶ææ¦è¿°.md",key:"v-265d3d7e",path:"/pages/ce2da4/",headers:[{level:2,title:"1. å¤§åç³»ç»æ¶ææ¼å",slug:"_1-å¤§åç³»ç»æ¶ææ¼å",normalizedTitle:"1. å¤§åç³»ç»æ¶ææ¼å",charIndex:13},{level:3,title:"1.1. åæºæ¶æ",slug:"_1-1-åæºæ¶æ",normalizedTitle:"1.1. åæºæ¶æ",charIndex:253},{level:3,title:"1.2. åºç¨æå¡åæ°æ®æå¡åç¦»",slug:"_1-2-åºç¨æå¡åæ°æ®æå¡åç¦»",normalizedTitle:"1.2. åºç¨æå¡åæ°æ®æå¡åç¦»",charIndex:440},{level:3,title:"1.3. ä½¿ç¨ç¼å­æ¹åæ§è½",slug:"_1-3-ä½¿ç¨ç¼å­æ¹åæ§è½",normalizedTitle:"1.3. ä½¿ç¨ç¼å­æ¹åæ§è½",charIndex:679},{level:3,title:"1.4. è´è½½åè¡¡",slug:"_1-4-è´è½½åè¡¡",normalizedTitle:"1.4. è´è½½åè¡¡",charIndex:949},{level:3,title:"1.5. æ°æ®åºè¯»ååç¦»",slug:"_1-5-æ°æ®åºè¯»ååç¦»",normalizedTitle:"1.5. æ°æ®åºè¯»ååç¦»",charIndex:1151},{level:3,title:"1.6. å¤çº§ç¼å­",slug:"_1-6-å¤çº§ç¼å­",normalizedTitle:"1.6. å¤çº§ç¼å­",charIndex:1509},{level:3,title:"1.7. ä¸å¡æå",slug:"_1-7-ä¸å¡æå",normalizedTitle:"1.7. ä¸å¡æå",charIndex:1766},{level:3,title:"1.8. ååºåè¡¨",slug:"_1-8-ååºåè¡¨",normalizedTitle:"1.8. ååºåè¡¨",charIndex:2120},{level:3,title:"1.9. åå¸å¼ç»ä»¶",slug:"_1-9-åå¸å¼ç»ä»¶",normalizedTitle:"1.9. åå¸å¼ç»ä»¶",charIndex:2299},{level:3,title:"1.10. å¾®æå¡",slug:"_1-10-å¾®æå¡",normalizedTitle:"1.10. å¾®æå¡",charIndex:2457},{level:2,title:"2. æ¶æè®¾è®¡çèé",slug:"_2-æ¶æè®¾è®¡çèé",normalizedTitle:"2. æ¶æè®¾è®¡çèé",charIndex:2695},{level:3,title:"2.1. ä»ä¹æ¯æ¶æ",slug:"_2-1-ä»ä¹æ¯æ¶æ",normalizedTitle:"2.1. ä»ä¹æ¯æ¶æ",charIndex:2766},{level:3,title:"2.2. æ¶æè®¾è®¡çç®æ ",slug:"_2-2-æ¶æè®¾è®¡çç®æ ",normalizedTitle:"2.2. æ¶æè®¾è®¡çç®æ ",charIndex:2938},{level:3,title:"2.3. æ¶æè®¾è®¡çåå",slug:"_2-3-æ¶æè®¾è®¡çåå",normalizedTitle:"2.3. æ¶æè®¾è®¡çåå",charIndex:3386},{level:4,title:"2.3.1. åéåå",slug:"_2-3-1-åéåå",normalizedTitle:"2.3.1. åéåå",charIndex:3428},{level:4,title:"2.3.2. ç®ååå",slug:"_2-3-2-ç®ååå",normalizedTitle:"2.3.2. ç®ååå",charIndex:3538},{level:4,title:"2.3.3. æ¼ååå",slug:"_2-3-3-æ¼ååå",normalizedTitle:"2.3.3. æ¼ååå",charIndex:3585},{level:4,title:"2.3.4. å¢¨è²å®å¾",slug:"_2-3-4-å¢¨è²å®å¾",normalizedTitle:"2.3.4. å¢¨è²å®å¾",charIndex:3634},{level:4,title:"2.3.5. åº·å¨å®å¾",slug:"_2-3-5-åº·å¨å®å¾",normalizedTitle:"2.3.5. åº·å¨å®å¾",charIndex:3730},{level:4,title:"2.3.6. äºå«å®å¾",slug:"_2-3-6-äºå«å®å¾",normalizedTitle:"2.3.6. äºå«å®å¾",charIndex:3823},{level:3,title:"2.4. é«æ§è½",slug:"_2-4-é«æ§è½",normalizedTitle:"2.4. é«æ§è½",charIndex:3839},{level:4,title:"2.4.1. æ§è½ææ ",slug:"_2-4-1-æ§è½ææ ",normalizedTitle:"2.4.1. æ§è½ææ ",charIndex:3901},{level:4,title:"2.4.2. æ§è½æåææ®µ",slug:"_2-4-2-æ§è½æåææ®µ",normalizedTitle:"2.4.2. æ§è½æåææ®µ",charIndex:4096},{level:3,title:"2.5. é«å¯ç¨",slug:"_2-5-é«å¯ç¨",normalizedTitle:"2.5. é«å¯ç¨",charIndex:4496},{level:4,title:"2.5.1. æ ç¶æåºç¨çé«å¯ç¨",slug:"_2-5-1-æ ç¶æåºç¨çé«å¯ç¨",normalizedTitle:"2.5.1. æ ç¶æåºç¨çé«å¯ç¨",charIndex:4670},{level:4,title:"2.5.2. æç¶æåºç¨çé«å¯ç¨",slug:"_2-5-2-æç¶æåºç¨çé«å¯ç¨",normalizedTitle:"2.5.2. æç¶æåºç¨çé«å¯ç¨",charIndex:4971},{level:4,title:"2.5.3. é«å¯ç¨ææ®µ",slug:"_2-5-3-é«å¯ç¨ææ®µ",normalizedTitle:"2.5.3. é«å¯ç¨ææ®µ",charIndex:5158},{level:3,title:"2.6. æ©å±æ§",slug:"_2-6-æ©å±æ§",normalizedTitle:"2.6. æ©å±æ§",charIndex:5688},{level:3,title:"2.7. ä¼¸ç¼©æ§",slug:"_2-7-ä¼¸ç¼©æ§",normalizedTitle:"2.7. ä¼¸ç¼©æ§",charIndex:6661},{level:3,title:"2.8. å®å¨æ§",slug:"_2-8-å®å¨æ§",normalizedTitle:"2.8. å®å¨æ§",charIndex:7142},{level:2,title:"3. å¸¸è§æ¶ææ¨¡å",slug:"_3-å¸¸è§æ¶ææ¨¡å",normalizedTitle:"3. å¸¸è§æ¶ææ¨¡å",charIndex:7379},{level:3,title:"3.1. åå±æ¶æ",slug:"_3-1-åå±æ¶æ",normalizedTitle:"3.1. åå±æ¶æ",charIndex:7393},{level:3,title:"3.2. äºä»¶é©±å¨æ¶æ",slug:"_3-2-äºä»¶é©±å¨æ¶æ",normalizedTitle:"3.2. äºä»¶é©±å¨æ¶æ",charIndex:7882},{level:3,title:"3.3. å¾®æ ¸æ¶æ",slug:"_3-3-å¾®æ ¸æ¶æ",normalizedTitle:"3.3. å¾®æ ¸æ¶æ",charIndex:8404},{level:3,title:"3.4. å¾®æå¡æ¶æ",slug:"_3-4-å¾®æå¡æ¶æ",normalizedTitle:"3.4. å¾®æå¡æ¶æ",charIndex:8784},{level:3,title:"3.5. äºæ¶æ",slug:"_3-5-äºæ¶æ",normalizedTitle:"3.5. äºæ¶æ",charIndex:9489},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:10216}],headersStr:"1. å¤§åç³»ç»æ¶ææ¼å 1.1. åæºæ¶æ 1.2. åºç¨æå¡åæ°æ®æå¡åç¦» 1.3. ä½¿ç¨ç¼å­æ¹åæ§è½ 1.4. è´è½½åè¡¡ 1.5. æ°æ®åºè¯»ååç¦» 1.6. å¤çº§ç¼å­ 1.7. ä¸å¡æå 1.8. ååºåè¡¨ 1.9. åå¸å¼ç»ä»¶ 1.10. å¾®æå¡ 2. æ¶æè®¾è®¡çèé 2.1. ä»ä¹æ¯æ¶æ 2.2. æ¶æè®¾è®¡çç®æ  2.3. æ¶æè®¾è®¡çåå 2.3.1. åéåå 2.3.2. ç®ååå 2.3.3. æ¼ååå 2.3.4. å¢¨è²å®å¾ 2.3.5. åº·å¨å®å¾ 2.3.6. äºå«å®å¾ 2.4. é«æ§è½ 2.4.1. æ§è½ææ  2.4.2. æ§è½æåææ®µ 2.5. é«å¯ç¨ 2.5.1. æ ç¶æåºç¨çé«å¯ç¨ 2.5.2. æç¶æåºç¨çé«å¯ç¨ 2.5.3. é«å¯ç¨ææ®µ 2.6. æ©å±æ§ 2.7. ä¼¸ç¼©æ§ 2.8. å®å¨æ§ 3. å¸¸è§æ¶ææ¨¡å 3.1. åå±æ¶æ 3.2. äºä»¶é©±å¨æ¶æ 3.3. å¾®æ ¸æ¶æ 3.4. å¾®æå¡æ¶æ 3.5. äºæ¶æ 4. åèèµæ",content:'# ç³»ç»æ¶ææ¦è¿°\n\n\n# 1. å¤§åç³»ç»æ¶ææ¼å\n\nä¸ä¸ªå¤§åç³»ç»çæ¶ææ¯ä¸ä¸ªæ¸è¿çæ¼åè¿ç¨ãç½é©¬ä¸æ¯ä¸å¤©å»ºæçï¼åçï¼å¾®ä¿¡ãæ·å®ç­å¤§åç³»ç»ç»ä¸æ¯ä¸è¹´èå°±çãéçä¸å¡çä¸æ­åå±ï¼ç¨æ·ä½éçå¢å ï¼ç³»ç»çå¤æåº¦å¿å¿ä¸æ­æåï¼æç»è¿«ä½¿ç³»ç»æ¶æè¿åï¼ä»¥åºå¯¹ææã\n\näºè§£å¤§åç³»ç»æ¶æçæ¼åè¿ç¨ï¼æå©äºæä»¬äºè§£æ¶æè¿åçåå±è§å¾åä¸çä¸äºæççåºå¯¹æ¹æ¡ãå¸®å©æä»¬å¨å®éå·¥ä½ä¸­ï¼å¦ä½å»æèæ¶æï¼å¦ä½å»åç»è§£å³æ¹æ¡ã\n\nå¤§åç³»ç»æ¶ææ¼åæ¯è¾å·æä»£è¡¨æ§çå°±æ¯å¤§åç½ç«çæ¼åè¿ç¨ãè¿éä»ç»ä¸ä¸å¤§åç½ç«æ¼åçä¸è¬è§å¾ã\n\n\n# 1.1. åæºæ¶æ\n\n * é®é¢ï¼ç½ç«è¿è¥åæï¼è®¿é®ç¨æ·å°ï¼ä¸å°æå¡å¨ç»°ç»°æä½ã\n * ç¹å¾ï¼åºç¨ç¨åºãæ°æ®åºãæä»¶ç­ææçèµæºé½å¨ä¸å°æå¡å¨ä¸ã\n * æè¿°ï¼éå¸¸æå¡å¨æä½ç³»ç»ä½¿ç¨ linuxï¼åºç¨ç¨åºä½¿ç¨ PHP å¼åï¼ç¶åé¨ç½²å¨ Apache ä¸ï¼æ°æ®åºä½¿ç¨ Mysqlï¼éä¿ç§°ä¸º LAMPãæ±éåç§åè´¹å¼æºè½¯ä»¶ä»¥åä¸å°å»ä»·æå¡å¨å°±å¯ä»¥å¼å§ç³»ç»çåå±ä¹è·¯äºã\n\n\n# 1.2. åºç¨æå¡åæ°æ®æå¡åç¦»\n\n * é®é¢ï¼è¶æ¥è¶å¤çç¨æ·è®¿é®å¯¼è´æ§è½è¶æ¥è¶å·®ï¼è¶æ¥è¶å¤çæ°æ®å¯¼è´å­å¨ç©ºé´ä¸è¶³ï¼ä¸å°æå¡å¨å·²ä¸è¶³ä»¥æ¯æã\n * ç¹å¾ï¼åºç¨æå¡å¨ãæ°æ®åºæå¡å¨ãæä»¶æå¡å¨åå«ç¬ç«é¨ç½²ã\n * æè¿°ï¼ä¸å°æå¡å¨å¯¹æ§è½è¦æ±åä¸ç¸åï¼\n   * åºç¨æå¡å¨è¦å¤çå¤§éä¸å¡é»è¾ï¼å æ­¤éè¦æ´å¿«æ´å¼ºå¤§ç CPUï¼\n   * æ°æ®åºæå¡å¨éè¦å¿«éç£çæ£ç´¢åæ°æ®ç¼å­ï¼å æ­¤éè¦æ´å¿«çç¡¬çåæ´å¤§çåå­ï¼\n   * æä»¶æå¡å¨éè¦å­å¨å¤§éæä»¶ï¼å æ­¤éè¦æ´å¤§å®¹éçç¡¬çã\n\n\n# 1.3. ä½¿ç¨ç¼å­æ¹åæ§è½\n\n * é®é¢ï¼éçç¨æ·éæ¸å¢å¤ï¼æ°æ®åºååå¤ªå¤§å¯¼è´è®¿é®å»¶è¿ã\n * ç¹å¾ï¼ç±äºç½ç«è®¿é®åè´¢å¯åéä¸æ ·éµå¾ªäºå«å®å¾ï¼80% çä¸å¡è®¿é®éä¸­å¨ 20% çæ°æ®ä¸ãå°æ°æ®åºä¸­è®¿é®è¾éä¸­çå°é¨åæ°æ®ç¼å­å¨åå­ä¸­ï¼å¯ä»¥åå°æ°æ®åºçè®¿é®æ¬¡æ°ï¼éä½æ°æ®åºçè®¿é®ååã\n * æè¿°ï¼ç¼å­åä¸ºä¸¤ç§ï¼åºç¨æå¡å¨ä¸çæ¬å°ç¼å­ååå¸å¼ç¼å­æå¡å¨ä¸çè¿ç¨ç¼å­ã\n   * æ¬å°ç¼å­è®¿é®éåº¦æ´å¿«ï¼ä½ç¼å­æ°æ®éæéï¼åæ¶å­å¨ä¸åºç¨ç¨åºäºç¨åå­çæåµã\n   * åå¸å¼ç¼å­å¯ä»¥éç¨éç¾¤æ¹å¼ï¼çè®ºä¸å¯ä»¥åå°ä¸ååå­å®¹ééå¶çç¼å­æå¡ã\n\n\n# 1.4. è´è½½åè¡¡\n\n * é®é¢ï¼ä½¿ç¨ç¼å­åï¼æ°æ®åºè®¿é®ååå¾å°ææç¼è§£ãä½æ¯åä¸åºç¨æå¡å¨è½å¤å¤ççè¯·æ±è¿æ¥æéï¼å¨è®¿é®é«å³°æï¼æä¸ºç¶é¢ã\n * ç¹å¾ï¼å¤å°æå¡å¨éè¿è´è½½åè¡¡åæ¶åå¤é¨æä¾æå¡ï¼è§£å³åä¸æå¡å¨å¤çè½ååå­å¨ç©ºé´ä¸è¶³çé®é¢ã\n * æè¿°ï¼ä½¿ç¨éç¾¤æ¯ç³»ç»è§£å³é«å¹¶åãæµ·éæ°æ®é®é¢çå¸¸ç¨ææ®µãéè¿åéç¾¤ä¸­è¿½å èµæºï¼æåç³»ç»çå¹¶åå¤çè½åï¼ä½¿å¾æå¡å¨çè´è½½ååä¸åæä¸ºæ´ä¸ªç³»ç»çç¶é¢ã\n\n\n# 1.5. æ°æ®åºè¯»ååç¦»\n\n * é®é¢ï¼ç½ç«ä½¿ç¨ç¼å­åï¼ä½¿ç»å¤§é¨åæ°æ®è¯»æä½è®¿é®é½å¯ä»¥ä¸éè¿æ°æ®åºå°±è½å®æï¼ä½æ¯ä»æä¸é¨åè¯»æä½åå¨é¨çåæä½éè¦è®¿é®æ°æ®åºï¼å¨ç½ç«çç¨æ·è¾¾å°ä¸å®è§æ¨¡åï¼æ°æ®åºå ä¸ºè´è½½ååè¿é«èæä¸ºç½ç«çç¶é¢ã\n * ç¹å¾ï¼ç®åå¤§é¨åçä¸»æµæ°æ®åºé½æä¾ä¸»ä»ç­å¤åè½ï¼éè¿éç½®ä¸¤å°æ°æ®åºä¸»ä»å³ç³»ï¼å¯ä»¥å°ä¸å°æ°æ®åºæå¡å¨çæ°æ®æ´æ°åæ­¥å°ä¸å°æå¡å¨ä¸ãç½ç«å©ç¨æ°æ®åºçä¸»ä»ç­å¤åè½ï¼å®ç°æ°æ®åºè¯»ååç¦»ï¼ä»èæ¹åæ°æ®åºè´è½½ååã\n * æè¿°ï¼åºç¨æå¡å¨å¨åæä½çæ¶åï¼è®¿é®ä¸»æ°æ®åºï¼ä¸»æ°æ®åºéè¿ä¸»ä»å¤å¶æºå¶å°æ°æ®æ´æ°åæ­¥å°ä»æ°æ®åºãè¿æ ·å½åºç¨æå¡å¨å¨è¯»æä½çæ¶åï¼è®¿é®ä»æ°æ®åºè·å¾æ°æ®ãä¸ºäºä¾¿äºåºç¨ç¨åºè®¿é®è¯»ååç¦»åçæ°æ®åºï¼éå¸¸å¨åºç¨æå¡å¨ç«¯ä½¿ç¨ä¸é¨çæ°æ®è®¿é®æ¨¡åï¼ä½¿æ°æ®åºè¯»ååç¦»çå¯¹åºç¨éæã\n\n\n# 1.6. å¤çº§ç¼å­\n\n * é®é¢ï¼ä¸­å½ç½ç»ç¯å¢å¤æï¼ä¸åå°åºçç¨æ·è®¿é®ç½ç«æ¶ï¼éåº¦å·®å«ä¹æå¤§ã\n * ç¹å¾ï¼éç¨ CDN åååä»£çå å¿«ç³»ç»çéæèµæºè®¿é®éåº¦ã\n * æè¿°ï¼CDN åååä»£ççåºæ¬åçé½æ¯ç¼å­ï¼åºå«å¨äºï¼\n   * CDN é¨ç½²å¨ç½ç»æä¾åçæºæ¿ï¼ä½¿ç¨æ·å¨è¯·æ±ç½ç«æå¡æ¶ï¼å¯ä»¥ä»è·ç¦»èªå·±æè¿çç½ç»æä¾åæºæ¿è·åæ°æ®ï¼\n   * èååä»£çåé¨ç½²å¨ç½ç«çä¸­å¿æºæ¿ï¼å½ç¨æ·è¯·æ±å°è¾¾ä¸­å¿æºæ¿åï¼é¦åè®¿é®çæå¡å¨æ¶ååä»£çæå¡å¨ï¼å¦æååä»£çæå¡å¨ä¸­ç¼å­çç¨æ·è¯·æ±çèµæºï¼å°±å°å¶ç´æ¥è¿åç»ç¨æ·ã\n\n\n# 1.7. ä¸å¡æå\n\n * é®é¢ï¼å¤§åç½ç«çä¸å¡åºæ¯æ¥çå¤æï¼åä¸ºå¤ä¸ªäº§åçº¿ã\n * ç¹å¾ï¼éç¨åèæ²»ä¹çææ®µå°æ´ä¸ªç½ç«ä¸å¡åæä¸åçäº§åçº¿ãç³»ç»ä¸æç§ä¸å¡è¿è¡æåæ¹é ï¼åºç¨æå¡å¨æç§ä¸å¡åºåè¿è¡åå«é¨ç½²ã\n * æè¿°ï¼åºç¨ä¹é´å¯ä»¥éè¿è¶é¾æ¥å»ºç«å³ç³»ï¼ä¹å¯ä»¥éè¿æ¶æ¯éåè¿è¡æ°æ®ååï¼å½ç¶æ´å¤çè¿æ¯éè¿è®¿é®åä¸ä¸ªæ°æ®å­å¨ç³»ç»æ¥ææä¸ä¸ªå³èçå®æ´ç³»ç»ã\n   * çºµåæåï¼å°ä¸ä¸ªå¤§åºç¨æåä¸ºå¤ä¸ªå°åºç¨ï¼å¦ææ°ä¸å¡è¾ä¸ºç¬ç«ï¼é£ä¹å°±ç´æ¥å°å¶è®¾è®¡é¨ç½²ä¸ºä¸ä¸ªç¬ç«ç Web åºç¨ç³»ç»ãçºµåæåç¸å¯¹è¾ä¸ºç®åï¼éè¿æ¢³çä¸å¡ï¼å°è¾å°ç¸å³çä¸å¡å¥ç¦»å³å¯ã\n   * æ¨ªåæåï¼å°å¤ç¨çä¸å¡æååºæ¥ï¼ç¬ç«é¨ç½²ä¸ºåå¸å¼æå¡ï¼æ°å¢ä¸å¡åªéè¦è°ç¨è¿äºåå¸å¼æå¡æ¨ªåæåéè¦è¯å«å¯å¤ç¨çä¸å¡ï¼è®¾è®¡æå¡æ¥å£ï¼è§èæå¡ä¾èµå³ç³»ã\n\n\n# 1.8. ååºåè¡¨\n\n * é®é¢ï¼éçå¤§åç½ç«ä¸å¡æç»­å¢é¿ï¼æ°æ®åºç»è¿è¯»ååç¦»ï¼ä»ä¸å°æå¡å¨æåä¸ºä¸¤å°æå¡å¨ï¼ä¾ç¶ä¸è½æ»¡è¶³éæ±ã\n * ç¹å¾ï¼æ°æ®åºéç¨åå¸å¼æ°æ®åºã\n * æè¿°ï¼åå¸å¼æ°æ®åºæ¯æ°æ®åºæåçæåæ¹æ³ï¼åªæå¨åè¡¨æ°æ®è§æ¨¡éå¸¸åºå¤§çæ¶åæä½¿ç¨ãä¸å°ä¸å¾å·²æ¶ï¼æ´å¸¸ç¨çæ°æ®åºæåææ®µæ¯ä¸å¡ååºï¼å°ä¸åçä¸å¡æ°æ®åºé¨ç½²å¨ä¸åçç©çæå¡å¨ä¸ã\n\n\n# 1.9. åå¸å¼ç»ä»¶\n\n * é®é¢ï¼éçç½ç«ä¸å¡è¶æ¥è¶å¤æï¼å¯¹æ°æ®å­å¨åæ£ç´¢çéæ±ä¹è¶æ¥è¶å¤æã\n * ç¹å¾ï¼ç³»ç»å¼å¥ NoSQL æ°æ®åºåæç´¢å¼æã\n * æè¿°ï¼NoSQL æ°æ®åºåæç´¢å¼æå¯¹å¯ä¼¸ç¼©çåå¸å¼ç¹æ§å·ææ´å¥½çæ¯æãåºç¨æå¡å¨éè¿ç»ä¸æ°æ®è®¿é®æ¨¡åè®¿é®åç§æ°æ®ï¼åè½»åºç¨ç¨åºç®¡çè¯¸å¤æ°æ®æºçéº»ç¦ã\n\n\n# 1.10. å¾®æå¡\n\n * é®é¢ï¼éçä¸å¡è¶æè¶å°ï¼å­å¨ç³»ç»è¶æ¥è¶åºå¤§ï¼åºç¨ç³»ç»æ´ä½å¤æç¨åº¦åææ°çº§ä¸åï¼é¨ç½²ç»´æ¤è¶æ¥è¶å°é¾ãç±äºææåºç¨è¦åæææ°æ®åºç³»ç»è¿æ¥ï¼æç»å¯¼è´æ°æ®åºè¿æ¥èµæºä¸è¶³ï¼æç»æå¡ã\n * ç¹å¾ï¼å¬å±ä¸å¡æååºæ¥ï¼ç¬ç«é¨ç½²ãç±è¿äºå¯å¤ç¨çä¸å¡è¿æ¥æ°æ®åºï¼éè¿åå¸å¼æå¡æä¾å±ç¨ä¸å¡æå¡ã\n * æè¿°ï¼å¤§åç½ç«çæ¶ææ¼åå°è¿éï¼åºæ¬ä¸å¤§å¤æ°çææ¯é®é¢é½å¾ä»¥è§£å³ï¼è¯¸å¦è·¨æ°æ®ä¸­å¿çå®æ¶æ°æ®åæ­¥åå·ä½ç½ç«ä¸å¡ç¸å³çé®é¢ä¹é½å¯ä»¥ç»åæ¹è¿ç°æææ¯æ¶ææ¥è§£å³ã\n\n\n# 2. æ¶æè®¾è®¡çèé\n\n> æ¯ä¸ä¸ªæ¨¡å¼æè¿°äºä¸ä¸ªä¸ä½éå¤åççé®é¢åè¯¥é®é¢è§£å³æ¹æ¡çæ ¸å¿ãè¿æ ·ï¼å°±å¯ä»¥ä¸æ­å¤ç¨è¯¥æ¹æ¡èåå°éå¤å·¥ä½ã\n\n\n# 2.1. ä»ä¹æ¯æ¶æ\n\næ¶ææ¯ä¸ä¸ªéå¸¸æ½è±¡çæ¦å¿µï¼æ¯ä¸ªäººç±äºææ¯çæ·±åº¦ãæç»´çè§è§ç­å·®å¼ï¼å¯¹äºæ¶æççè§£ï¼åä¸ç¸åã\n\nè¿éææç½ä¸ææ®µæ¯è¾ç²¾é«çå®ä¹ï¼\n\n * æ¶ææ¯è½¯ä»¶ç³»ç»çé¡¶å±è®¾è®¡ã\n * æ¡æ¶æ¯é¢åç¼ç¨æéç½®çåæåã\n * ç»ä»¶æ¯ä»ææ¯ç»´åº¦ä¸çå¤ç¨ã\n * æ¨¡åæ¯ä»ä¸å¡ç»´åº¦ä¸èè´£çååã\n * ç³»ç»æ¯ç¸äºååå¯è¿è¡çå®ä½ã\n\n\n# 2.2. æ¶æè®¾è®¡çç®æ \n\næ¶æè®¾è®¡çä¸»è¦ç®çæ¯ä¸ºäºè§£å³è½¯ä»¶ç³»ç»å¤æåº¦å¸¦æ¥çé®é¢ã\n\næ¶æè®¾è®¡åºè¯¥æéè®¾è®¡ãä»»ä½ç½ç«é½æ¯éçä¸å¡éæ­¥åå±ï¼ä¸æ­æ¼åèæï¼ä¸è¦ææä¸å³æ°¸é¸ã\n\nå³äºæ¶æè®¾è®¡çç®çï¼å¸¸è§çè¯¯åºæï¼\n\n * å ä¸ºæ¶æå¾éè¦ï¼æä»¥è¦åæ¶æè®¾è®¡\n * ä¸ºäºé«æ§è½ãé«å¯ç¨ãå¯æ©å±ï¼æä»¥è¦åæ¶æè®¾è®¡\n * å¤§åé½æ¯è¿ä¹åçï¼æä»¥æä»¬ä¹è¿ä¹å\n * è¿ç§æ°ææ¯å¾çé¼ï¼æä»¬ä¹ä¸å®è¦å¼å¥\n\næ¶æçååï¼\n\n * æ¶æè®¾è®¡åºè¯¥æéè®¾è®¡ãä»»ä½ç½ç«é½æ¯éçä¸å¡éæ­¥åå±ï¼ä¸æ­æ¼åèæï¼ä¸è¦ææä¸å³æ°¸é¸ã\n * é©±å¨ææ¯åå±çä¸»è¦åéæ¯ä¸å¡åå±ã\n * ä¸è¦ç²ç®è·é£å¤§å¬å¸çè§£å³æ¹æ¡ã\n * ä¸è¦ç²ç®è¿½æ±æµè¡ææ¯ï¼èè±ç¦»äºä¸å¡åå±çå®éæåµã\n * ä¸è¦æææé®é¢é½ä¸¢ç»ææ¯ãç°å®ä¸­ï¼æå¾å¤æ¡ä¾åè¯æä»¬ï¼å¾å¤é®é¢ä¸ä¸å®éè¦éè¿ææ¯æ¥è§£å³ãå½æ ¹ç»åºï¼ææ¯å§ç»é½æ¯ä¸å¡çè¾å©ï¼ä¸å¡é®é¢ç©¶ç«æ¯éè¿ææ¯æ¥è§£å³è¿æ¯ç´æ¥éè¿ä¸å¡æ¥è§£å³ï¼éè¦æ ¹æ®å®éæåµå»åæå¤æ­ãè¿å°±éè¦å¯¹ä¸å¡é¢åææ¯è¾æ·±å¥ççè§£åæèã\n\n\n# 2.3. æ¶æè®¾è®¡çåå\n\n> åéä¼äºåè¿>æ¼åä¼äºä¸æ­¥å°ä½>ç®åä¼äºå¤æ\n\n# 2.3.1. åéåå\n\næ²¡é£ä¹å¤äººï¼å´æ³å¹²é£ä¹å¤æ´»ï¼æ¯å¤±è´¥çç¬¬ä¸ä¸ªä¸»è¦åå ã\n\næ²¡æé£ä¹å¤ç§¯ç´¯ï¼å´æ³ä¸æ­¥ç»å¤©ï¼æ¯å¤±è´¥çç¬¬äºä¸ªä¸»è¦åå ã\n\næ²¡æé£ä¹åè¶çä¸å¡åºæ¯ï¼å´å¹»æ³çµåä¸éªæä¸ºå¤©æï¼æ¯å¤±è´¥çç¬¬ä¸ä¸ªä¸»è¦åå ã\n\n# 2.3.2. ç®ååå\n\nåé«å¤§ä¸çè§£å³æ¹æ¡å¦æä¸è½è½å°ï¼ä¹æ¯ç½æ¯ã\n\næä»¥ï¼åºå¯¹éæ±\n\n# 2.3.3. æ¼ååå\n\næ¼åä¼äºä¸æ­¥å°ä½ã\n\nä¸è¦å¦å¾è®¾è®¡ä¸ä¸ªä¸æ­¥å°ä½ï¼æ°¸ä¹ä¸åçæ¶æã\n\n# 2.3.4. å¢¨è²å®å¾\n\n * ä»»ä½äºé½æ²¡æè¡¨é¢çèµ·æ¥é£ä¹ç®åï¼\n * ææçäºé½ä¼æ¯ä½ é¢è®¡çæ¶é´é¿ï¼\n * ä¼åºéçäºæ»ä¼åºéï¼\n * å¦æä½ æå¿æç§æåµåçï¼é£ä¹å®å°±æ´æå¯è½åçã\n\n# 2.3.5. åº·å¨å®å¾\n\nç³»ç»è®¾è®¡(äº§åç»æ)ç­åç»ç»å½¢å¼ï¼æ¯ä¸ªè®¾è®¡ç³»ç»çç»ç»ï¼å¶äº§ççè®¾è®¡ç­åäºç»ç»ä¹é´çæ²éç»æï¼ç®åç¹è¯´å°±æ¯ï¼ç³»ç»çè®¾è®¡åéäºè®¾è®¡ç³»ç»çç»ç»çäººåæ¶æå½¢å¼ã\n\n# 2.3.6. äºå«å®å¾\n\n\n# 2.4. é«æ§è½\n\n> æ§è½æ¯è½¯ä»¶ç³»ç»çéè¦è¡¡éæ åãå¾å¤æ©å±æ§ãä¼¸ç¼©æ§ãå¯ç¨æ§çé®é¢ï¼æ¯ä¸ºäºè§£å³æ§è½é®é¢èå¼å¥çã\n\n# 2.4.1. æ§è½ææ \n\nååºå»¶æ¶ãå¹¶åå¤çè½åãåå­ãCPUãIO å¼éç­é½å¯ä»¥è§ä¸ºç³»ç»çæ§è½ææ ã\n\nåæç¨æ·ä½éãæ¥è®¿é®éçå³°å¼ï¼ä¼°ç®åºä¸ºäºå¹³ç¨³åºå¯¹å³°å¼è®¿é®æµéæéçå¹¶åéãååéãå¦ææ¯åºç¨åç³»ç»ï¼æ§è½å¤ç¨å°±å¥½ï¼æ²¡å¿è¦ä¸å³è¿½æ±é«æ§è½ãæ¯å¦ï¼ç¨æ·ä½éå¯è½è¿ä¸è¿ä¸ï¼ä¸å¤©æ»è®¿é®éå¯è½ä¹å°±ä¸ä¸¤å PVï¼å³°å¼ä¹å°±å ç¾ QPSï¼è¿æ ·çç³»ç»å¦æè¦èèæ¯ç§å ä¸ç QPSï¼æ¾ç¶æäºå¤èäºã\n\n# 2.4.2. æ§è½æåææ®µ\n\nå¸¸è§çæ§è½æåææ®µæï¼\n\n * åç«¯\n   * æµè§å¨ç¼å­\n   * éæèµæºåç¼©\n   * åçå¸å±é¡µé¢\n   * åå° cookie ä¼ è¾\n   * CDN\n * åºç¨æå¡\n   * è´è½½åè¡¡åååä»£ç\n   * æ¬å°ç¼å­\n   * åå¸å¼ç¼å­\n   * å¼æ­¥æ¶æ¯éå\n   * éç¾¤\n   * ä»£ç å±é¢ï¼ä½¿ç¨å¤çº¿ç¨ãæ¹ååå­ç®¡ç\n * æ°æ®åº\n   * ç´¢å¼\n   * æ°æ®åºç¼å­\n   * SQL ä¼å\n\n> æ³¨æï¼ç¼å­æ¯æ¹åè½¯ä»¶æ§è½çç¬¬ä¸ææ®µãç¼å­é¤äºå¯ä»¥å å¿«æ°æ®è®¿é®éåº¦ä»¥å¤ï¼è¿å¯ä»¥åè½»åç«¯åºç¨åæ°æ®å­å¨çè´è½½ååãæä»¥ï¼å¦æè¦æåç³»ç»æ§è½ï¼åºè¯¥ç¬¬ä¸æ¶é´æ³å°ç¼å­ã\n> \n> ä½¿ç¨ç¼å­æä¸¤ä¸ªåæï¼\n> \n>  * æ°æ®è®¿é®ç­ç¹ä¸ååï¼é¢ç¹è®¿é®çæ°æ®åºè¯¥æ¾å¨ç¼å­ä¸­ã\n>  * æ°æ®å¨æä¸ªæ¶é´æ®µææï¼ä¸è¿å¾å¿«è¿æï¼å¦åç¼å­æ°æ®ä¼å å·²ç»å¤±æèäº§çèè¯»ã\n\n\n# 2.5. é«å¯ç¨\n\n> ç³»ç»æ ä¸­æ­å°æ§è¡å¶åè½çè½åï¼ä»£è¡¨ç³»ç»çå¯ç¨æ§ç¨åº¦ï¼æ¯è¿è¡ç³»ç»è®¾è®¡æ¶çååä¹ä¸ã\n\né«æ§è½å¢å æºå¨ç®çå¨äºâæ©å±âå¤çæ§è½ï¼é«å¯ç¨å¢å æºå¨ç®çå¨äºâåä½âå¤çååã\n\nåç¹ç³»ç»ï¼æ¯æ æ³ä¿è¯é«å¯ç¨çãç³»ç»èªèº«æéãæ­çµãç¡¬ä»¶æéãç½ç»ç­ç­ï¼é½å¯è½å¯¼è´æå¡ä¸å¯ç¨ãé«å¯ç¨æ¹æ¡äºè±å«é¨ï¼æ¬è´¨ä¸é½æ¯éè¿âåä½âæ¥å®ç°é«å¯ç¨ã\n\n# 2.5.1. æ ç¶æåºç¨çé«å¯ç¨\n\næ ç¶æåºç¨ä¸è¬å·æå¹ç­æ§ï¼å³**æ è®ºå¨åªå°æºå¨ä¸è¿è¡è®¡ç®ï¼åæ ·çç®æ³åè¾å¥æ°æ®ï¼äº§åºçç»æé½æ¯ä¸æ ·çã**æä»¥ï¼è®¡ç®å¨ä»»æèç¹æå¡å¨ä¸æ§è¡ï¼ç»æé½ä¸æ ·ã\n\næ ç¶æåºç¨çé«å¯ç¨ï¼\n\n * éè¦å¢å ä¸ä¸ªä»»å¡åéå¨ï¼éæ©åéçä»»å¡åéå¨ä¹æ¯ä¸ä»¶å¤æçäºæï¼éè¦ç»¼åèèæ§è½ãææ¬ãå¯ç»´æ¤æ§ãå¯ç¨æ§ç­åæ¹é¢å ç´ ã\n * ä»»å¡åéå¨åçæ­£çä¸å¡æå¡å¨ä¹é´æè¿æ¥åäº¤äºï¼éè¦éæ©åéçè¿æ¥æ¹å¼ï¼å¹¶ä¸å¯¹è¿æ¥è¿è¡ç®¡çãä¾å¦ï¼è¿æ¥å»ºç«ãè¿æ¥æ£æµãè¿æ¥ä¸­æ­åå¦ä½å¤çç­ã\n * ä»»å¡åéå¨éè¦å¢å åéç®æ³ãä¾å¦ï¼å¸¸è§çåæºç®æ³æä¸»å¤ãä¸»ä¸»ï¼ä¸»å¤æ¹æ¡åå¯ä»¥ç»åä¸ºå·å¤ãæ¸©å¤ãç­å¤ã\n\n# 2.5.2. æç¶æåºç¨çé«å¯ç¨\n\næç¶æåºç¨ï¼æ¯æéè¦å­å¨æ°æ®çç³»ç»ï¼æ¯å¦åç§åå¸å¼å­å¨ãåæ ç¶æåºç¨ç¸æ¯ï¼æä¸ä¸ªæ¬è´¨ä¸çåºå«ï¼åèç¹éè¦éè¿åæ­¥ä¿ææ°æ®ä¸è´ãåå¸å¼é¢åéé¢æä¸ä¸ªèåç CAP å®çï¼ä»çè®ºä¸è®ºè¯äºå­å¨é«å¯ç¨çå¤æåº¦ãä¹å°±æ¯è¯´ï¼å­å¨é«å¯ç¨ä¸å¯è½åæ¶æ»¡è¶³âä¸è´æ§ãå¯ç¨æ§ãååºå®¹éæ§âï¼æå¤æ»¡è¶³å¶ä¸­ä¸¤ä¸ªï¼è¿å°±è¦æ±æä»¬å¨åæ¶æè®¾è®¡æ¶ç»åä¸å¡è¿è¡åèã\n\n# 2.5.3. é«å¯ç¨ææ®µ\n\né«å¯ç¨çå¸¸ç¨ææ®µï¼\n\n * è´è½½åè¡¡ - éè¿è´è½½åè¡¡è®¾å¤å»ºç«éç¾¤å±åå¯¹å¤æä¾æå¡ã\n * å¤ä»½ - æ°æ®å­å¨å¨å¤å°æå¡å¨ï¼äºç¸å¤ä»½ãå³ä½¿è®¿é®åè´è½½å¾å°çæå¡ä¹å¿é¡»é¨ç½²è³å°ä¸¤å°æå¡å¨ï¼ææä¸ä¸ªéç¾¤ï¼ç®çå°±æ¯éè¿åä½å®ç°æå¡çé«å¯ç¨ã\n   * å·å¤ä»½ - æ°æ®åºè¯¥å®æå¤ä»½ï¼\n   * ç­å¤ä»½ - ä¸ºäºä¿è¯å¨çº¿ä¸å¡é«å¯ç¨ï¼è¿éè¦å¯¹æ°æ®åºè¿è¡ä¸»ä»åç¦»ï¼å®æ¶åæ­¥ ã\n   * ç¾å¤ - ä¸ºäºæµå¾¡å°éãæµ·å¸ç­ä¸å¯æå ç´ å¯¼è´çç½ç«å®å¨ç«çªï¼æäºå¤§åç½ç«ä¼å¯¹æ´ä¸ªæ°æ®ä¸­å¿è¿è¡å¤ä»½ï¼å¨çèå´åé¨ç½² ç¾å¤æ°æ®ä¸­å¿ãç½ç«ç¨åºåæ°æ®å®æ¶åæ­¥å°å¤ä¸ªç¾å¤æ°æ®ä¸­å¿ã\n * èªå¨å - èªå¨åæ¯æï¼å¤§åç³»ç»æå¿è¦éè¿é¢åå¸éªè¯ãèªå¨åæµè¯ãèªå¨ååå¸ãç°åº¦åå¸ç­ææ®µï¼åå°å°æéå¼å¥çº¿ä¸ç¯å¢çå¯è½ãå¸¸è§èªå¨åææ®µæï¼\n   * åå¸è¿ç¨èªå¨å\n     * èªå¨åä»£ç ç®¡ç\n     * èªå¨åæµè¯\n     * èªå¨åå®å¨çæµ\n     * èªå¨åé¨ç½²\n   * è¿ç»´èªå¨å\n     * èªå¨åçæ§\n     * èªå¨åæ¥è­¦\n     * èªå¨åå¤±æè½¬ç§»\n     * èªå¨åå¤±ææ¢å¤\n     * èªå¨åéçº§\n     * èªå¨ååéèµæº\n\n\n# 2.6. æ©å±æ§\n\n> å¯æ©å±æ§æç³»ç»ä¸ºäºåºå¯¹å°æ¥éæ±ååèæä¾çä¸ç§æ©å±è½åï¼å½ææ°çéæ±åºç°æ¶ï¼ç³»ç»ä¸éè¦æèä»éè¦å°éä¿®æ¹å°±å¯ä»¥æ¯æï¼æ é¡»æ´ä¸ªç³»ç»éææèéå»ºã\n> \n> è¡¡éæ©å±æ§çæ åå°±æ¯å¢å æ°çä¸å¡äº§åæ¶ï¼æ¯å¦å¯ä»¥å®ç°å¯¹ç°æäº§åéææ å½±åï¼ä¸éè¦ä»»ä½æ¹å¨æå¾å°æ¹å¨ï¼æ¢æåè½å°±å¯ä»¥ä¸çº¿æ°äº§åã\n> \n> è½¯ä»¶åå±çä¸ä¸ªéè¦ç®æ åé©±å¨åæ¯éä½è½¯ä»¶è¦åæ§ãäºç©ä¹é´ç´æ¥å³ç³»è¶å°ï¼å½¼æ­¤å½±åå°±è¶å°ï¼ä¹å°±æ´å®¹æç¬ç«åå±ï¼å³æ©å±æ§å¥½ã\n\nä¸»è¦ææ®µæï¼\n\n * åå± - åå±æ¯æ©å±æ§è®¾è®¡çæåºæ¬ææ®µãéè¿åå±ï¼å¯ä»¥å°ä¸ä¸ªçè½¯ä»¶ç³»ç»ååä¸ºä¸åçé¨åï¼ä¾¿äºåå·¥åä½å¼ååç»´æ¤ï¼åå±é´å·æä¸å®çç¬ç«æ§ã\n   \n   * åå±æ¶æççº¦æï¼ç¦æ­¢è·¨å±æ¬¡çè°ç¨åéåè°ç¨ã\n   * å³ä½¿ç³»ç»è§æ¨¡å¾å°ï¼ä¹åºè¯¥èèéç¨åå±çæ¶æï¼è¿æ ·ä¾¿äºä»¥åæ©å±ã\n\n * åå² - å°ä¸åçåè½åæå¡åå²å¼æ¥ï¼åè£æé«åèãä½è¦åçæ¨¡åååãè¿æå©äºè½¯ä»¶çå¼ååç»´æ¤ï¼ä¾¿äºä¸åæ¨¡åçåå¸å¼é¨ç½²ï¼æé«ç³»ç»çå¹¶åå¤çè½åååè½æ©å±è½åã\n\n * å¼æ­¥ - ä¸å¡é´çæ¶æ¯ä¼ éä¸æ¯åæ­¥è°ç¨ï¼èæ¯å°ä¸ä¸ªä¸å¡æä½æåæå¤é¶æ®µï¼æ¯ä¸ªé¶æ®µé´éè¿å±äº«æ°æ®çæ¹å¼å¼æ­¥æ§è¡è¿è¡åä½ã\n   \n   * å¨åä¸æå¡å¨åé¨å¯éè¿å¤çº¿ç¨å±äº«åå­éåçæ¹å¼å®ç°å¼æ­¥ï¼å¤å¨ä¸å¡æä½åé¢ççº¿ç¨å°æä½è¾åºå°éåï¼åé¢ççº¿ç¨ä»éåä¸­è¯»åæ°æ®è¿è¡å¤çï¼\n   * å¨åå¸å¼ç³»ç»ä¸­ï¼å¤ä¸ªæå¡å¨éç¾¤éè¿åå¸å¼æ¶æ¯éåå®ç°å¼æ­¥ã\n\n * åå¸å¼ - å°ä¸å¡åå¯å¤ç¨æå¡åç¦»ï¼éè¿åå¸å¼æå¡æ¡æ¶è°ç¨ãåå¸å¼æ¯æå¤å°æå¡å¨é¨ç½²ç¸ååºç¨ææä¸ä¸ªéç¾¤ï¼éè¿è´è½½åè¡¡è®¾å¤å±åå¯¹å¤æä¾æå¡ãçæå³çæå¡å¯ä»¥ç¨æ´å¤çæºå¨å·¥ä½ï¼å³æ©å± CPUãåå­ãIO ç­èµæºï¼ä»èæé«ç³»ç»æ´ä½çååéåå¹¶åå¤çè½åã\n   \n   * å¸¸ç¨çåå¸å¼æ¹æ¡ï¼\n     * åå¸å¼åºç¨åæå¡\n     * åå¸å¼éæèµæº\n     * åå¸å¼æ°æ®åå­å¨\n     * åå¸å¼è®¡ç®\n   * åå¸å¼ä¹å¼å¥äºä¸äºé®é¢ï¼\n     * æå¡è°ç¨å¿é¡»éè¿ç½ç»ï¼ç½ç»å»¶è¿ä¼å½±åæ§è½ã\n     * æå¡å¨è¶å¤ï¼å®æºæ¦çä¹è¶å¤§ï¼å¯¼è´å¯ç¨æ§éä½ã\n     * æ°æ®ä¸è´æ§éå¸¸å°é¾ï¼åå¸å¼äºå¡ä¹é¾ä»¥ä¿è¯ã\n     * ç½ç«ä¾èµéç»¼å¤æï¼å¼åç®¡çç»´æ¤å°é¾ã\n\n\n# 2.7. ä¼¸ç¼©æ§\n\n> è¡¡éä¼¸ç¼©çæ åå°±æ¯æ¯å¦å¯ä»¥ç¨å¤å°æå¡å¨æå»ºéç¾¤ï¼æ¯å¦å®¹æåéç¾¤ä¸­å¢å æå¡å¨èç¹ãå¢å æå¡å¨èç¹åæ¯å¦å¯ä»¥æä¾åä¹åæ å·®å«çæå¡ãéç¾¤ä¸­å¯å®¹çº³çæ»æå¡å¨æ°æ¯å¦æéå¶ã\n\nä¼¸ç¼©æ§æ¯æéè¿å¢/åæå¡å¨èç¹æ°ï¼æ¥çµæ´»çæé«/éä½ç³»ç»å¤çè½åã\n\nä¸»è¦ææ®µæ:\n\n * åºç¨æå¡å¨éç¾¤ - åªè¦æå¡å¨ä¸ä¿å­æ°æ®ï¼åæææå¡å¨é½æ¯å¯¹ç­çï¼éè¿è´è½½åè¡¡è®¾å¤åéç¾¤ä¸­ä¸æ­å å¥æå¡å¨å³å¯\n * ç¼å­æå¡å¨éç¾¤ - å å¥æ°çæå¡å¨å¯è½ä¼å¯¼è´ç¼å­è·¯ç±å¤±æï¼è¿èå¯¼è´éç¾¤ä¸­çå¤§é¨åç¼å­æ°æ®é½æ æ³è®¿é®ãè½ç¶ç¼å­æ°æ®å¯ä»¥éè¿æ°æ®åºéæ°å è½½ï¼ä½æ¯å¦æåºç¨ä¸¥éä¾èµç¼å­ï¼å¯è½ä¼å¯¼è´ç½ç«å´©æºãéè¦æ¹è¿ç¼å­è·¯ç±ç®æ³ä¿è¯ç¼å­æ°æ®çå¯è®¿é®æ§ã\n * å³ç³»åæ°æ®åºéç¾¤ - å³ç³»åæ°æ®åºè½ç¶æ¯ææ°æ®å¤å¶ï¼ä¸»ä»ç­å¤ç­æºå¶ï¼ä½æ¯å¾é¾åå°å¤§è§æ¨¡éç¾¤çå¯ä¼¸ç¼©æ§ï¼å æ­¤å³ç³»åæ°æ®åºçéç¾¤ä¼¸ç¼©æ§æ¹æ¡å¿é¡»å¨æ°æ®åºä¹å¤å®ç°ï¼éè¿è·¯ç±ååºç­ææ®µå°é¨ç½²æå¤ä¸ªæ°æ®åºçæå¡å¨ç»æä¸ä¸ªéç¾¤ã\n * Nosql æ°æ®åºéç¾¤ - ç±äºåå¤©å°±æ¯ä¸ºäºåºå¯¹æµ·éæ°æ®èäº§çï¼å æ­¤å¯¹ä¼¸ç¼©æ§çæ¯æéå¸¸é½éå¸¸å¥½ã\n\n\n# 2.8. å®å¨æ§\n\nå®å¨æ¯æç³»ç»åºè¯¥å¯¹æ¶ææ»å»æä¸å®çæµæè½åï¼ä¿æ¤éè¦æ°æ®ä¸è¢«çªåã\n\n * å¯ç  å ææºæ ¡éªç  è¿è¡èº«ä»½è®¤è¯\n * ç»å½ãäº¤æç­éè¦æä½éè¦å¯¹ç½ç»éä¿¡è¿è¡ å å¯ï¼å­å¨çæææ°æ®å¦ç¨æ·ä¿¡æ¯ç­ä¹è¿è¡å å¯å¤ç\n * é²æ­¢æºå¨äººç¨åºæ»å»ç½ç«ï¼ä½¿ç¨ éªè¯ç  è¿è¡è¯å«\n * å¯¹å¸¸è§ç¨äº æ»å» ç½ç«ç XSS æ»å»ãSQL æ³¨å¥ãè¿è¡ç¼ç è½¬æ¢ç­ç¸åºå¤ç\n * å¯¹åå¾ä¿¡æ¯ãææä¿¡æ¯è¿è¡ è¿æ»¤\n * å¯¹äº¤æè½¬è´¦ç­éè¦æä½æ ¹æ®äº¤ææ¨¡å¼åäº¤æä¿¡æ¯è¿è¡ é£é©æ§å¶\n\n\n# 3. å¸¸è§æ¶ææ¨¡å\n\n\n# 3.1. åå±æ¶æ\n\nåå±æ¶æï¼layered architectureï¼æ¯æå¸¸è§çè½¯ä»¶æ¶æï¼ä¹æ¯äºå®ä¸çæ åæ¶æã\n\nè¿ç§æ¶æå°è½¯ä»¶åæè¥å¹²ä¸ªæ°´å¹³å±ï¼æ¯ä¸å±é½ææ¸æ°çè§è²ååå·¥ï¼ä¸éè¦ç¥éå¶ä»å±çç»èãå±ä¸å±ä¹é´éè¿æ¥å£éä¿¡ã\n\nåå±çç»ææå¸¸è§ã\n\n\n * è¡¨ç°å±ï¼presentationï¼ï¼ç¨æ·çé¢ï¼è´è´£è§è§åç¨æ·äºå¨\n * ä¸å¡å±ï¼businessï¼ï¼å®ç°ä¸å¡é»è¾\n * æä¹å±ï¼persistenceï¼ï¼æä¾æ°æ®ï¼SQL è¯­å¥å°±æ¾å¨è¿ä¸å±\n * æ°æ®åºï¼databaseï¼ ï¼ä¿å­æ°æ®\n\nä¼ç¹\n\n * ç»æç®åï¼å®¹æçè§£åå¼å\n * ä¸åæè½çç¨åºåå¯ä»¥åå·¥ï¼è´è´£ä¸åçå±ï¼å¤©ç¶éåå¤§å¤æ°è½¯ä»¶å¬å¸çç»ç»æ¶æ\n * æ¯ä¸å±é½å¯ä»¥ç¬ç«æµè¯ï¼å¶ä»å±çæ¥å£éè¿æ¨¡æè§£å³\n\nç¼ºç¹\n\n * ä¸æ¦ç¯å¢ååï¼éè¦ä»£ç è°æ´æå¢å åè½æ¶ï¼éå¸¸æ¯è¾éº»ç¦åè´¹æ¶\n * é¨ç½²æ¯è¾éº»ç¦ï¼å³ä½¿åªä¿®æ¹ä¸ä¸ªå°å°æ¹ï¼å¾å¾éè¦æ´ä¸ªè½¯ä»¶éæ°é¨ç½²ï¼ä¸å®¹æåæç»­åå¸\n * è½¯ä»¶åçº§æ¶ï¼å¯è½éè¦æ´ä¸ªæå¡æå\n * æ©å±æ§å·®ãç¨æ·è¯·æ±å¤§éå¢å æ¶ï¼å¿é¡»ä¾æ¬¡æ©å±æ¯ä¸å±ï¼ç±äºæ¯ä¸å±åé¨æ¯è¦åçï¼æ©å±ä¼å¾å°é¾\n\n\n# 3.2. äºä»¶é©±å¨æ¶æ\n\näºä»¶ï¼eventï¼æ¯ç¶æåçååæ¶ï¼è½¯ä»¶ååºçéç¥ã\n\näºä»¶é©±å¨æ¶æï¼event-driven architectureï¼å°±æ¯éè¿äºä»¶è¿è¡éä¿¡çè½¯ä»¶æ¶æãå®åæåä¸ªé¨åã\n\n\n * äºä»¶éåï¼event queueï¼ï¼æ¥æ¶äºä»¶çå¥å£\n * ååå¨ï¼event mediatorï¼ï¼å°ä¸åçäºä»¶ååå°ä¸åçä¸å¡é»è¾åå\n * äºä»¶ééï¼event channelï¼ï¼ååå¨ä¸å¤çå¨ä¹é´çèç³»æ¸ é\n * äºä»¶å¤çå¨ï¼event processorï¼ï¼å®ç°ä¸å¡é»è¾ï¼å¤çå®æåä¼ååºäºä»¶ï¼è§¦åä¸ä¸æ­¥æä½\n\nå¯¹äºç®åçé¡¹ç®ï¼äºä»¶éåãååå¨åäºä»¶ééï¼å¯ä»¥åä¸ºä¸ä½ï¼æ´ä¸ªè½¯ä»¶å°±åæäºä»¶ä»£çåäºä»¶å¤çå¨ä¸¤é¨åã\n\n\n\nä¼ç¹\n\n * åå¸å¼çå¼æ­¥æ¶æï¼äºä»¶å¤çå¨ä¹é´é«åº¦è§£è¦ï¼è½¯ä»¶çæ©å±æ§å¥½\n * éç¨æ§å¹¿ï¼åç§ç±»åçé¡¹ç®é½å¯ä»¥ç¨\n * æ§è½è¾å¥½ï¼å ä¸ºäºä»¶çå¼æ­¥æ¬è´¨ï¼è½¯ä»¶ä¸æäº§çå µå¡\n * äºä»¶å¤çå¨å¯ä»¥ç¬ç«å°å è½½åå¸è½½ï¼å®¹æé¨ç½²\n\nç¼ºç¹\n\n * æ¶åå¼æ­¥ç¼ç¨ï¼è¦èèè¿ç¨éä¿¡ãå¤±å»ååºç­æåµï¼ï¼å¼åç¸å¯¹å¤æ\n * é¾ä»¥æ¯æåå­æ§æä½ï¼å ä¸ºäºä»¶éè¿ä¼æ¶åå¤ä¸ªå¤çå¨ï¼å¾é¾åæ»\n * åå¸å¼åå¼æ­¥ç¹æ§å¯¼è´è¿ä¸ªæ¶æè¾é¾æµè¯\n\n\n# 3.3. å¾®æ ¸æ¶æ\n\nå¾®æ ¸æ¶æï¼microkernel architectureï¼åç§°ä¸º"æä»¶æ¶æ"ï¼plug-in architectureï¼ï¼æçæ¯è½¯ä»¶çåæ ¸ç¸å¯¹è¾å°ï¼ä¸»è¦åè½åä¸å¡é»è¾é½éè¿æä»¶å®ç°ã\n\nåæ ¸ï¼coreï¼éå¸¸åªåå«ç³»ç»è¿è¡çæå°åè½ãæä»¶åæ¯äºç¸ç¬ç«çï¼æä»¶ä¹é´çéä¿¡ï¼åºè¯¥åå°å°æä½ï¼é¿ååºç°äºç¸ä¾èµçé®é¢ã\n\n\n\nä¼ç¹\n\n * è¯å¥½çåè½å»¶ä¼¸æ§ï¼extensibilityï¼ï¼éè¦ä»ä¹åè½ï¼å¼åä¸ä¸ªæä»¶å³å¯\n * åè½ä¹é´æ¯éç¦»çï¼æä»¶å¯ä»¥ç¬ç«çå è½½åå¸è½½ï¼ä½¿å¾å®æ¯è¾å®¹æé¨ç½²ï¼\n * å¯å®å¶æ§é«ï¼éåºä¸åçå¼åéè¦\n * å¯ä»¥æ¸è¿å¼å°å¼åï¼éæ­¥å¢å åè½\n\nç¼ºç¹\n\n * æ©å±æ§ï¼scalabilityï¼å·®ï¼åæ ¸éå¸¸æ¯ä¸ä¸ªç¬ç«ååï¼ä¸å®¹æåæåå¸å¼\n * å¼åé¾åº¦ç¸å¯¹è¾é«ï¼å ä¸ºæ¶åå°æä»¶ä¸åæ ¸çéä¿¡ï¼ä»¥ååé¨çæä»¶ç»è®°æºå¶\n\n\n# 3.4. å¾®æå¡æ¶æ\n\nå¾®æå¡æ¶æï¼microservices architectureï¼æ¯æå¡å¯¼åæ¶æï¼service-oriented architectureï¼ç¼©å SOAï¼çåçº§ã\n\næ¯ä¸ä¸ªæå¡å°±æ¯ä¸ä¸ªç¬ç«çé¨ç½²ååï¼separately deployed unitï¼ãè¿äºååé½æ¯åå¸å¼çï¼äºç¸è§£è¦ï¼éè¿è¿ç¨éä¿¡åè®®ï¼æ¯å¦ RESTãSOAPï¼èç³»ã\n\n\n\nå¾®æå¡æ¶æåæä¸ç§å®ç°æ¨¡å¼ã\n\n * RESTful API æ¨¡å¼ï¼æå¡éè¿ API æä¾ï¼äºæå¡å°±å±äºè¿ä¸ç±»\n * RESTful åºç¨æ¨¡å¼ï¼æå¡éè¿ä¼ ç»çç½ç»åè®®æèåºç¨åè®®æä¾ï¼èåéå¸¸æ¯ä¸ä¸ªå¤åè½çåºç¨ç¨åºï¼å¸¸è§äºä¼ä¸åé¨\n * éä¸­æ¶æ¯æ¨¡å¼ï¼éç¨æ¶æ¯ä»£çï¼message brokerï¼ï¼å¯ä»¥å®ç°æ¶æ¯éåãè´è½½åè¡¡ãç»ä¸æ¥å¿åå¼å¸¸å¤çï¼ç¼ºç¹æ¯ä¼åºç°åç¹å¤±è´¥ï¼æ¶æ¯ä»£çå¯è½è¦åæéç¾¤\n\nä¼ç¹\n\n * æ©å±æ§å¥½ï¼åä¸ªæå¡ä¹é´ä½è¦å\n * å®¹æé¨ç½²ï¼è½¯ä»¶ä»åä¸å¯é¨ç½²ååï¼è¢«ææäºå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡é½æ¯å¯é¨ç½²åå\n * å®¹æå¼åï¼æ¯ä¸ªç»ä»¶é½å¯ä»¥è¿è¡æç»­éæå¼çå¼åï¼å¯ä»¥åå°å®æ¶é¨ç½²ï¼ä¸é´æ­å°åçº§\n * æäºæµè¯ï¼å¯ä»¥åç¬æµè¯æ¯ä¸ä¸ªæå¡\n\nç¼ºç¹\n\n * ç±äºå¼ºè°äºç¸ç¬ç«åä½è¦åï¼æå¡å¯è½ä¼æåå¾å¾ç»ãè¿å¯¼è´ç³»ç»ä¾èµå¤§éçå¾®æå¡ï¼åå¾å¾åä¹±åç¬¨éï¼æ§è½ä¹ä¼ä¸ä½³ã\n * ä¸æ¦æå¡ä¹é´éè¦éä¿¡ï¼å³ä¸ä¸ªæå¡è¦ç¨å°å¦ä¸ä¸ªæå¡ï¼ï¼æ´ä¸ªæ¶æå°±ä¼åå¾å¤æãå¸åçä¾å­å°±æ¯ä¸äºéç¨ç Utility ç±»ï¼ä¸ç§è§£å³æ¹æ¡æ¯æå®ä»¬æ·è´å°æ¯ä¸ä¸ªæå¡ä¸­å»ï¼ç¨åä½æ¢åæ¶æçç®åæ§ã\n * åå¸å¼çæ¬è´¨ä½¿å¾è¿ç§æ¶æå¾é¾å®ç°åå­æ§æä½ï¼äº¤æåæ»ä¼æ¯è¾å°é¾ã\n\n\n# 3.5. äºæ¶æ\n\näºç»æï¼cloud architectureï¼ä¸»è¦è§£å³æ©å±æ§åå¹¶åçé®é¢ï¼æ¯æå®¹ææ©å±çæ¶æã\n\nå®çé«æ©å±æ§ï¼ä¸»è¦åå æ¯æ²¡ä½¿ç¨ä¸­å¤®æ°æ®åºï¼èæ¯ææ°æ®é½å¤å¶å°åå­ä¸­ï¼åæå¯å¤å¶çåå­æ°æ®ååãç¶åï¼ä¸å¡å¤çè½åå°è£æä¸ä¸ªä¸ªå¤çååï¼prcessing unitï¼ãè®¿é®éå¢å ï¼å°±æ°å»ºå¤çååï¼è®¿é®éåå°ï¼å°±å³é­å¤çååãç±äºæ²¡æä¸­å¤®æ°æ®åºï¼æä»¥æ©å±æ§çæå¤§ç¶é¢æ¶å¤±äºãç±äºæ¯ä¸ªå¤çååçæ°æ®é½å¨åå­éï¼æå¥½è¦è¿è¡æ°æ®æä¹åã\n\n\n\nè¿ä¸ªæ¨¡å¼ä¸»è¦åæä¸¤é¨åï¼å¤çååï¼processing unitï¼åèæä¸­é´ä»¶ï¼virtualized middlewareï¼ã\n\n * å¤çååï¼å®ç°ä¸å¡é»è¾\n * èæä¸­é´ä»¶ï¼è´è´£éä¿¡ãä¿æ sessionsãæ°æ®å¤å¶ãåå¸å¼å¤çãå¤çååçé¨ç½²ã\n\nèæä¸­é´ä»¶ååå«åä¸ªç»ä»¶ã\n\n>  * æ¶æ¯ä¸­é´ä»¶ï¼Messaging Gridï¼ï¼ç®¡çç¨æ·è¯·æ±å sessionï¼å½ä¸ä¸ªè¯·æ±è¿æ¥ä»¥åï¼å³å®åéç»åªä¸ä¸ªå¤çååã\n>  * æ°æ®ä¸­é´ä»¶ï¼Data Gridï¼ï¼å°æ°æ®å¤å¶å°æ¯ä¸ä¸ªå¤çååï¼å³æ°æ®åæ­¥ãä¿è¯æä¸ªå¤çååé½å¾å°åæ ·çæ°æ®ã\n>  * å¤çä¸­é´ä»¶ï¼Processing Gridï¼ï¼å¯éï¼å¦æä¸ä¸ªè¯·æ±æ¶åä¸åç±»åçå¤çååï¼è¯¥ä¸­é´ä»¶è´è´£åè°å¤çåå\n>  * é¨ç½²ä¸­é´ä»¶ï¼Deployment Managerï¼ï¼è´è´£å¤çååçå¯å¨åå³é­ï¼çæ§è´è½½åååºæ¶é´ï¼å½è´è½½å¢å ï¼å°±æ°å¯å¨å¤çååï¼è´è½½åå°ï¼å°±å³é­å¤çååã\n\nä¼ç¹\n\n * é«è´è½½ï¼é«æ©å±æ§\n * å¨æé¨ç½²\n\nç¼ºç¹\n\n * å®ç°å¤æï¼ææ¬è¾é«\n * ä¸»è¦éåç½ç«ç±»åºç¨ï¼ä¸åéå¤§éæ°æ®ååçå¤§åæ°æ®åºåºç¨\n * è¾é¾æµè¯\n\n\n# 4. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ãä» 0 å¼å§å­¦æ¶æã\n * è½¯ä»¶æ¶æå¥é¨- é®ä¸å³°çç½ç»æ¥å¿',normalizedContent:'# ç³»ç»æ¶ææ¦è¿°\n\n\n# 1. å¤§åç³»ç»æ¶ææ¼å\n\nä¸ä¸ªå¤§åç³»ç»çæ¶ææ¯ä¸ä¸ªæ¸è¿çæ¼åè¿ç¨ãç½é©¬ä¸æ¯ä¸å¤©å»ºæçï¼åçï¼å¾®ä¿¡ãæ·å®ç­å¤§åç³»ç»ç»ä¸æ¯ä¸è¹´èå°±çãéçä¸å¡çä¸æ­åå±ï¼ç¨æ·ä½éçå¢å ï¼ç³»ç»çå¤æåº¦å¿å¿ä¸æ­æåï¼æç»è¿«ä½¿ç³»ç»æ¶æè¿åï¼ä»¥åºå¯¹ææã\n\näºè§£å¤§åç³»ç»æ¶æçæ¼åè¿ç¨ï¼æå©äºæä»¬äºè§£æ¶æè¿åçåå±è§å¾åä¸çä¸äºæççåºå¯¹æ¹æ¡ãå¸®å©æä»¬å¨å®éå·¥ä½ä¸­ï¼å¦ä½å»æèæ¶æï¼å¦ä½å»åç»è§£å³æ¹æ¡ã\n\nå¤§åç³»ç»æ¶ææ¼åæ¯è¾å·æä»£è¡¨æ§çå°±æ¯å¤§åç½ç«çæ¼åè¿ç¨ãè¿éä»ç»ä¸ä¸å¤§åç½ç«æ¼åçä¸è¬è§å¾ã\n\n\n# 1.1. åæºæ¶æ\n\n * é®é¢ï¼ç½ç«è¿è¥åæï¼è®¿é®ç¨æ·å°ï¼ä¸å°æå¡å¨ç»°ç»°æä½ã\n * ç¹å¾ï¼åºç¨ç¨åºãæ°æ®åºãæä»¶ç­ææçèµæºé½å¨ä¸å°æå¡å¨ä¸ã\n * æè¿°ï¼éå¸¸æå¡å¨æä½ç³»ç»ä½¿ç¨ linuxï¼åºç¨ç¨åºä½¿ç¨ php å¼åï¼ç¶åé¨ç½²å¨ apache ä¸ï¼æ°æ®åºä½¿ç¨ mysqlï¼éä¿ç§°ä¸º lampãæ±éåç§åè´¹å¼æºè½¯ä»¶ä»¥åä¸å°å»ä»·æå¡å¨å°±å¯ä»¥å¼å§ç³»ç»çåå±ä¹è·¯äºã\n\n\n# 1.2. åºç¨æå¡åæ°æ®æå¡åç¦»\n\n * é®é¢ï¼è¶æ¥è¶å¤çç¨æ·è®¿é®å¯¼è´æ§è½è¶æ¥è¶å·®ï¼è¶æ¥è¶å¤çæ°æ®å¯¼è´å­å¨ç©ºé´ä¸è¶³ï¼ä¸å°æå¡å¨å·²ä¸è¶³ä»¥æ¯æã\n * ç¹å¾ï¼åºç¨æå¡å¨ãæ°æ®åºæå¡å¨ãæä»¶æå¡å¨åå«ç¬ç«é¨ç½²ã\n * æè¿°ï¼ä¸å°æå¡å¨å¯¹æ§è½è¦æ±åä¸ç¸åï¼\n   * åºç¨æå¡å¨è¦å¤çå¤§éä¸å¡é»è¾ï¼å æ­¤éè¦æ´å¿«æ´å¼ºå¤§ç cpuï¼\n   * æ°æ®åºæå¡å¨éè¦å¿«éç£çæ£ç´¢åæ°æ®ç¼å­ï¼å æ­¤éè¦æ´å¿«çç¡¬çåæ´å¤§çåå­ï¼\n   * æä»¶æå¡å¨éè¦å­å¨å¤§éæä»¶ï¼å æ­¤éè¦æ´å¤§å®¹éçç¡¬çã\n\n\n# 1.3. ä½¿ç¨ç¼å­æ¹åæ§è½\n\n * é®é¢ï¼éçç¨æ·éæ¸å¢å¤ï¼æ°æ®åºååå¤ªå¤§å¯¼è´è®¿é®å»¶è¿ã\n * ç¹å¾ï¼ç±äºç½ç«è®¿é®åè´¢å¯åéä¸æ ·éµå¾ªäºå«å®å¾ï¼80% çä¸å¡è®¿é®éä¸­å¨ 20% çæ°æ®ä¸ãå°æ°æ®åºä¸­è®¿é®è¾éä¸­çå°é¨åæ°æ®ç¼å­å¨åå­ä¸­ï¼å¯ä»¥åå°æ°æ®åºçè®¿é®æ¬¡æ°ï¼éä½æ°æ®åºçè®¿é®ååã\n * æè¿°ï¼ç¼å­åä¸ºä¸¤ç§ï¼åºç¨æå¡å¨ä¸çæ¬å°ç¼å­ååå¸å¼ç¼å­æå¡å¨ä¸çè¿ç¨ç¼å­ã\n   * æ¬å°ç¼å­è®¿é®éåº¦æ´å¿«ï¼ä½ç¼å­æ°æ®éæéï¼åæ¶å­å¨ä¸åºç¨ç¨åºäºç¨åå­çæåµã\n   * åå¸å¼ç¼å­å¯ä»¥éç¨éç¾¤æ¹å¼ï¼çè®ºä¸å¯ä»¥åå°ä¸ååå­å®¹ééå¶çç¼å­æå¡ã\n\n\n# 1.4. è´è½½åè¡¡\n\n * é®é¢ï¼ä½¿ç¨ç¼å­åï¼æ°æ®åºè®¿é®ååå¾å°ææç¼è§£ãä½æ¯åä¸åºç¨æå¡å¨è½å¤å¤ççè¯·æ±è¿æ¥æéï¼å¨è®¿é®é«å³°æï¼æä¸ºç¶é¢ã\n * ç¹å¾ï¼å¤å°æå¡å¨éè¿è´è½½åè¡¡åæ¶åå¤é¨æä¾æå¡ï¼è§£å³åä¸æå¡å¨å¤çè½ååå­å¨ç©ºé´ä¸è¶³çé®é¢ã\n * æè¿°ï¼ä½¿ç¨éç¾¤æ¯ç³»ç»è§£å³é«å¹¶åãæµ·éæ°æ®é®é¢çå¸¸ç¨ææ®µãéè¿åéç¾¤ä¸­è¿½å èµæºï¼æåç³»ç»çå¹¶åå¤çè½åï¼ä½¿å¾æå¡å¨çè´è½½ååä¸åæä¸ºæ´ä¸ªç³»ç»çç¶é¢ã\n\n\n# 1.5. æ°æ®åºè¯»ååç¦»\n\n * é®é¢ï¼ç½ç«ä½¿ç¨ç¼å­åï¼ä½¿ç»å¤§é¨åæ°æ®è¯»æä½è®¿é®é½å¯ä»¥ä¸éè¿æ°æ®åºå°±è½å®æï¼ä½æ¯ä»æä¸é¨åè¯»æä½åå¨é¨çåæä½éè¦è®¿é®æ°æ®åºï¼å¨ç½ç«çç¨æ·è¾¾å°ä¸å®è§æ¨¡åï¼æ°æ®åºå ä¸ºè´è½½ååè¿é«èæä¸ºç½ç«çç¶é¢ã\n * ç¹å¾ï¼ç®åå¤§é¨åçä¸»æµæ°æ®åºé½æä¾ä¸»ä»ç­å¤åè½ï¼éè¿éç½®ä¸¤å°æ°æ®åºä¸»ä»å³ç³»ï¼å¯ä»¥å°ä¸å°æ°æ®åºæå¡å¨çæ°æ®æ´æ°åæ­¥å°ä¸å°æå¡å¨ä¸ãç½ç«å©ç¨æ°æ®åºçä¸»ä»ç­å¤åè½ï¼å®ç°æ°æ®åºè¯»ååç¦»ï¼ä»èæ¹åæ°æ®åºè´è½½ååã\n * æè¿°ï¼åºç¨æå¡å¨å¨åæä½çæ¶åï¼è®¿é®ä¸»æ°æ®åºï¼ä¸»æ°æ®åºéè¿ä¸»ä»å¤å¶æºå¶å°æ°æ®æ´æ°åæ­¥å°ä»æ°æ®åºãè¿æ ·å½åºç¨æå¡å¨å¨è¯»æä½çæ¶åï¼è®¿é®ä»æ°æ®åºè·å¾æ°æ®ãä¸ºäºä¾¿äºåºç¨ç¨åºè®¿é®è¯»ååç¦»åçæ°æ®åºï¼éå¸¸å¨åºç¨æå¡å¨ç«¯ä½¿ç¨ä¸é¨çæ°æ®è®¿é®æ¨¡åï¼ä½¿æ°æ®åºè¯»ååç¦»çå¯¹åºç¨éæã\n\n\n# 1.6. å¤çº§ç¼å­\n\n * é®é¢ï¼ä¸­å½ç½ç»ç¯å¢å¤æï¼ä¸åå°åºçç¨æ·è®¿é®ç½ç«æ¶ï¼éåº¦å·®å«ä¹æå¤§ã\n * ç¹å¾ï¼éç¨ cdn åååä»£çå å¿«ç³»ç»çéæèµæºè®¿é®éåº¦ã\n * æè¿°ï¼cdn åååä»£ççåºæ¬åçé½æ¯ç¼å­ï¼åºå«å¨äºï¼\n   * cdn é¨ç½²å¨ç½ç»æä¾åçæºæ¿ï¼ä½¿ç¨æ·å¨è¯·æ±ç½ç«æå¡æ¶ï¼å¯ä»¥ä»è·ç¦»èªå·±æè¿çç½ç»æä¾åæºæ¿è·åæ°æ®ï¼\n   * èååä»£çåé¨ç½²å¨ç½ç«çä¸­å¿æºæ¿ï¼å½ç¨æ·è¯·æ±å°è¾¾ä¸­å¿æºæ¿åï¼é¦åè®¿é®çæå¡å¨æ¶ååä»£çæå¡å¨ï¼å¦æååä»£çæå¡å¨ä¸­ç¼å­çç¨æ·è¯·æ±çèµæºï¼å°±å°å¶ç´æ¥è¿åç»ç¨æ·ã\n\n\n# 1.7. ä¸å¡æå\n\n * é®é¢ï¼å¤§åç½ç«çä¸å¡åºæ¯æ¥çå¤æï¼åä¸ºå¤ä¸ªäº§åçº¿ã\n * ç¹å¾ï¼éç¨åèæ²»ä¹çææ®µå°æ´ä¸ªç½ç«ä¸å¡åæä¸åçäº§åçº¿ãç³»ç»ä¸æç§ä¸å¡è¿è¡æåæ¹é ï¼åºç¨æå¡å¨æç§ä¸å¡åºåè¿è¡åå«é¨ç½²ã\n * æè¿°ï¼åºç¨ä¹é´å¯ä»¥éè¿è¶é¾æ¥å»ºç«å³ç³»ï¼ä¹å¯ä»¥éè¿æ¶æ¯éåè¿è¡æ°æ®ååï¼å½ç¶æ´å¤çè¿æ¯éè¿è®¿é®åä¸ä¸ªæ°æ®å­å¨ç³»ç»æ¥ææä¸ä¸ªå³èçå®æ´ç³»ç»ã\n   * çºµåæåï¼å°ä¸ä¸ªå¤§åºç¨æåä¸ºå¤ä¸ªå°åºç¨ï¼å¦ææ°ä¸å¡è¾ä¸ºç¬ç«ï¼é£ä¹å°±ç´æ¥å°å¶è®¾è®¡é¨ç½²ä¸ºä¸ä¸ªç¬ç«ç web åºç¨ç³»ç»ãçºµåæåç¸å¯¹è¾ä¸ºç®åï¼éè¿æ¢³çä¸å¡ï¼å°è¾å°ç¸å³çä¸å¡å¥ç¦»å³å¯ã\n   * æ¨ªåæåï¼å°å¤ç¨çä¸å¡æååºæ¥ï¼ç¬ç«é¨ç½²ä¸ºåå¸å¼æå¡ï¼æ°å¢ä¸å¡åªéè¦è°ç¨è¿äºåå¸å¼æå¡æ¨ªåæåéè¦è¯å«å¯å¤ç¨çä¸å¡ï¼è®¾è®¡æå¡æ¥å£ï¼è§èæå¡ä¾èµå³ç³»ã\n\n\n# 1.8. ååºåè¡¨\n\n * é®é¢ï¼éçå¤§åç½ç«ä¸å¡æç»­å¢é¿ï¼æ°æ®åºç»è¿è¯»ååç¦»ï¼ä»ä¸å°æå¡å¨æåä¸ºä¸¤å°æå¡å¨ï¼ä¾ç¶ä¸è½æ»¡è¶³éæ±ã\n * ç¹å¾ï¼æ°æ®åºéç¨åå¸å¼æ°æ®åºã\n * æè¿°ï¼åå¸å¼æ°æ®åºæ¯æ°æ®åºæåçæåæ¹æ³ï¼åªæå¨åè¡¨æ°æ®è§æ¨¡éå¸¸åºå¤§çæ¶åæä½¿ç¨ãä¸å°ä¸å¾å·²æ¶ï¼æ´å¸¸ç¨çæ°æ®åºæåææ®µæ¯ä¸å¡ååºï¼å°ä¸åçä¸å¡æ°æ®åºé¨ç½²å¨ä¸åçç©çæå¡å¨ä¸ã\n\n\n# 1.9. åå¸å¼ç»ä»¶\n\n * é®é¢ï¼éçç½ç«ä¸å¡è¶æ¥è¶å¤æï¼å¯¹æ°æ®å­å¨åæ£ç´¢çéæ±ä¹è¶æ¥è¶å¤æã\n * ç¹å¾ï¼ç³»ç»å¼å¥ nosql æ°æ®åºåæç´¢å¼æã\n * æè¿°ï¼nosql æ°æ®åºåæç´¢å¼æå¯¹å¯ä¼¸ç¼©çåå¸å¼ç¹æ§å·ææ´å¥½çæ¯æãåºç¨æå¡å¨éè¿ç»ä¸æ°æ®è®¿é®æ¨¡åè®¿é®åç§æ°æ®ï¼åè½»åºç¨ç¨åºç®¡çè¯¸å¤æ°æ®æºçéº»ç¦ã\n\n\n# 1.10. å¾®æå¡\n\n * é®é¢ï¼éçä¸å¡è¶æè¶å°ï¼å­å¨ç³»ç»è¶æ¥è¶åºå¤§ï¼åºç¨ç³»ç»æ´ä½å¤æç¨åº¦åææ°çº§ä¸åï¼é¨ç½²ç»´æ¤è¶æ¥è¶å°é¾ãç±äºææåºç¨è¦åæææ°æ®åºç³»ç»è¿æ¥ï¼æç»å¯¼è´æ°æ®åºè¿æ¥èµæºä¸è¶³ï¼æç»æå¡ã\n * ç¹å¾ï¼å¬å±ä¸å¡æååºæ¥ï¼ç¬ç«é¨ç½²ãç±è¿äºå¯å¤ç¨çä¸å¡è¿æ¥æ°æ®åºï¼éè¿åå¸å¼æå¡æä¾å±ç¨ä¸å¡æå¡ã\n * æè¿°ï¼å¤§åç½ç«çæ¶ææ¼åå°è¿éï¼åºæ¬ä¸å¤§å¤æ°çææ¯é®é¢é½å¾ä»¥è§£å³ï¼è¯¸å¦è·¨æ°æ®ä¸­å¿çå®æ¶æ°æ®åæ­¥åå·ä½ç½ç«ä¸å¡ç¸å³çé®é¢ä¹é½å¯ä»¥ç»åæ¹è¿ç°æææ¯æ¶ææ¥è§£å³ã\n\n\n# 2. æ¶æè®¾è®¡çèé\n\n> æ¯ä¸ä¸ªæ¨¡å¼æè¿°äºä¸ä¸ªä¸ä½éå¤åççé®é¢åè¯¥é®é¢è§£å³æ¹æ¡çæ ¸å¿ãè¿æ ·ï¼å°±å¯ä»¥ä¸æ­å¤ç¨è¯¥æ¹æ¡èåå°éå¤å·¥ä½ã\n\n\n# 2.1. ä»ä¹æ¯æ¶æ\n\næ¶ææ¯ä¸ä¸ªéå¸¸æ½è±¡çæ¦å¿µï¼æ¯ä¸ªäººç±äºææ¯çæ·±åº¦ãæç»´çè§è§ç­å·®å¼ï¼å¯¹äºæ¶æççè§£ï¼åä¸ç¸åã\n\nè¿éææç½ä¸ææ®µæ¯è¾ç²¾é«çå®ä¹ï¼\n\n * æ¶ææ¯è½¯ä»¶ç³»ç»çé¡¶å±è®¾è®¡ã\n * æ¡æ¶æ¯é¢åç¼ç¨æéç½®çåæåã\n * ç»ä»¶æ¯ä»ææ¯ç»´åº¦ä¸çå¤ç¨ã\n * æ¨¡åæ¯ä»ä¸å¡ç»´åº¦ä¸èè´£çååã\n * ç³»ç»æ¯ç¸äºååå¯è¿è¡çå®ä½ã\n\n\n# 2.2. æ¶æè®¾è®¡çç®æ \n\næ¶æè®¾è®¡çä¸»è¦ç®çæ¯ä¸ºäºè§£å³è½¯ä»¶ç³»ç»å¤æåº¦å¸¦æ¥çé®é¢ã\n\næ¶æè®¾è®¡åºè¯¥æéè®¾è®¡ãä»»ä½ç½ç«é½æ¯éçä¸å¡éæ­¥åå±ï¼ä¸æ­æ¼åèæï¼ä¸è¦ææä¸å³æ°¸é¸ã\n\nå³äºæ¶æè®¾è®¡çç®çï¼å¸¸è§çè¯¯åºæï¼\n\n * å ä¸ºæ¶æå¾éè¦ï¼æä»¥è¦åæ¶æè®¾è®¡\n * ä¸ºäºé«æ§è½ãé«å¯ç¨ãå¯æ©å±ï¼æä»¥è¦åæ¶æè®¾è®¡\n * å¤§åé½æ¯è¿ä¹åçï¼æä»¥æä»¬ä¹è¿ä¹å\n * è¿ç§æ°ææ¯å¾çé¼ï¼æä»¬ä¹ä¸å®è¦å¼å¥\n\næ¶æçååï¼\n\n * æ¶æè®¾è®¡åºè¯¥æéè®¾è®¡ãä»»ä½ç½ç«é½æ¯éçä¸å¡éæ­¥åå±ï¼ä¸æ­æ¼åèæï¼ä¸è¦ææä¸å³æ°¸é¸ã\n * é©±å¨ææ¯åå±çä¸»è¦åéæ¯ä¸å¡åå±ã\n * ä¸è¦ç²ç®è·é£å¤§å¬å¸çè§£å³æ¹æ¡ã\n * ä¸è¦ç²ç®è¿½æ±æµè¡ææ¯ï¼èè±ç¦»äºä¸å¡åå±çå®éæåµã\n * ä¸è¦æææé®é¢é½ä¸¢ç»ææ¯ãç°å®ä¸­ï¼æå¾å¤æ¡ä¾åè¯æä»¬ï¼å¾å¤é®é¢ä¸ä¸å®éè¦éè¿ææ¯æ¥è§£å³ãå½æ ¹ç»åºï¼ææ¯å§ç»é½æ¯ä¸å¡çè¾å©ï¼ä¸å¡é®é¢ç©¶ç«æ¯éè¿ææ¯æ¥è§£å³è¿æ¯ç´æ¥éè¿ä¸å¡æ¥è§£å³ï¼éè¦æ ¹æ®å®éæåµå»åæå¤æ­ãè¿å°±éè¦å¯¹ä¸å¡é¢åææ¯è¾æ·±å¥ççè§£åæèã\n\n\n# 2.3. æ¶æè®¾è®¡çåå\n\n> åéä¼äºåè¿>æ¼åä¼äºä¸æ­¥å°ä½>ç®åä¼äºå¤æ\n\n# 2.3.1. åéåå\n\næ²¡é£ä¹å¤äººï¼å´æ³å¹²é£ä¹å¤æ´»ï¼æ¯å¤±è´¥çç¬¬ä¸ä¸ªä¸»è¦åå ã\n\næ²¡æé£ä¹å¤ç§¯ç´¯ï¼å´æ³ä¸æ­¥ç»å¤©ï¼æ¯å¤±è´¥çç¬¬äºä¸ªä¸»è¦åå ã\n\næ²¡æé£ä¹åè¶çä¸å¡åºæ¯ï¼å´å¹»æ³çµåä¸éªæä¸ºå¤©æï¼æ¯å¤±è´¥çç¬¬ä¸ä¸ªä¸»è¦åå ã\n\n# 2.3.2. ç®ååå\n\nåé«å¤§ä¸çè§£å³æ¹æ¡å¦æä¸è½è½å°ï¼ä¹æ¯ç½æ¯ã\n\næä»¥ï¼åºå¯¹éæ±\n\n# 2.3.3. æ¼ååå\n\næ¼åä¼äºä¸æ­¥å°ä½ã\n\nä¸è¦å¦å¾è®¾è®¡ä¸ä¸ªä¸æ­¥å°ä½ï¼æ°¸ä¹ä¸åçæ¶æã\n\n# 2.3.4. å¢¨è²å®å¾\n\n * ä»»ä½äºé½æ²¡æè¡¨é¢çèµ·æ¥é£ä¹ç®åï¼\n * ææçäºé½ä¼æ¯ä½ é¢è®¡çæ¶é´é¿ï¼\n * ä¼åºéçäºæ»ä¼åºéï¼\n * å¦æä½ æå¿æç§æåµåçï¼é£ä¹å®å°±æ´æå¯è½åçã\n\n# 2.3.5. åº·å¨å®å¾\n\nç³»ç»è®¾è®¡(äº§åç»æ)ç­åç»ç»å½¢å¼ï¼æ¯ä¸ªè®¾è®¡ç³»ç»çç»ç»ï¼å¶äº§ççè®¾è®¡ç­åäºç»ç»ä¹é´çæ²éç»æï¼ç®åç¹è¯´å°±æ¯ï¼ç³»ç»çè®¾è®¡åéäºè®¾è®¡ç³»ç»çç»ç»çäººåæ¶æå½¢å¼ã\n\n# 2.3.6. äºå«å®å¾\n\n\n# 2.4. é«æ§è½\n\n> æ§è½æ¯è½¯ä»¶ç³»ç»çéè¦è¡¡éæ åãå¾å¤æ©å±æ§ãä¼¸ç¼©æ§ãå¯ç¨æ§çé®é¢ï¼æ¯ä¸ºäºè§£å³æ§è½é®é¢èå¼å¥çã\n\n# 2.4.1. æ§è½ææ \n\nååºå»¶æ¶ãå¹¶åå¤çè½åãåå­ãcpuãio å¼éç­é½å¯ä»¥è§ä¸ºç³»ç»çæ§è½ææ ã\n\nåæç¨æ·ä½éãæ¥è®¿é®éçå³°å¼ï¼ä¼°ç®åºä¸ºäºå¹³ç¨³åºå¯¹å³°å¼è®¿é®æµéæéçå¹¶åéãååéãå¦ææ¯åºç¨åç³»ç»ï¼æ§è½å¤ç¨å°±å¥½ï¼æ²¡å¿è¦ä¸å³è¿½æ±é«æ§è½ãæ¯å¦ï¼ç¨æ·ä½éå¯è½è¿ä¸è¿ä¸ï¼ä¸å¤©æ»è®¿é®éå¯è½ä¹å°±ä¸ä¸¤å pvï¼å³°å¼ä¹å°±å ç¾ qpsï¼è¿æ ·çç³»ç»å¦æè¦èèæ¯ç§å ä¸ç qpsï¼æ¾ç¶æäºå¤èäºã\n\n# 2.4.2. æ§è½æåææ®µ\n\nå¸¸è§çæ§è½æåææ®µæï¼\n\n * åç«¯\n   * æµè§å¨ç¼å­\n   * éæèµæºåç¼©\n   * åçå¸å±é¡µé¢\n   * åå° cookie ä¼ è¾\n   * cdn\n * åºç¨æå¡\n   * è´è½½åè¡¡åååä»£ç\n   * æ¬å°ç¼å­\n   * åå¸å¼ç¼å­\n   * å¼æ­¥æ¶æ¯éå\n   * éç¾¤\n   * ä»£ç å±é¢ï¼ä½¿ç¨å¤çº¿ç¨ãæ¹ååå­ç®¡ç\n * æ°æ®åº\n   * ç´¢å¼\n   * æ°æ®åºç¼å­\n   * sql ä¼å\n\n> æ³¨æï¼ç¼å­æ¯æ¹åè½¯ä»¶æ§è½çç¬¬ä¸ææ®µãç¼å­é¤äºå¯ä»¥å å¿«æ°æ®è®¿é®éåº¦ä»¥å¤ï¼è¿å¯ä»¥åè½»åç«¯åºç¨åæ°æ®å­å¨çè´è½½ååãæä»¥ï¼å¦æè¦æåç³»ç»æ§è½ï¼åºè¯¥ç¬¬ä¸æ¶é´æ³å°ç¼å­ã\n> \n> ä½¿ç¨ç¼å­æä¸¤ä¸ªåæï¼\n> \n>  * æ°æ®è®¿é®ç­ç¹ä¸ååï¼é¢ç¹è®¿é®çæ°æ®åºè¯¥æ¾å¨ç¼å­ä¸­ã\n>  * æ°æ®å¨æä¸ªæ¶é´æ®µææï¼ä¸è¿å¾å¿«è¿æï¼å¦åç¼å­æ°æ®ä¼å å·²ç»å¤±æèäº§çèè¯»ã\n\n\n# 2.5. é«å¯ç¨\n\n> ç³»ç»æ ä¸­æ­å°æ§è¡å¶åè½çè½åï¼ä»£è¡¨ç³»ç»çå¯ç¨æ§ç¨åº¦ï¼æ¯è¿è¡ç³»ç»è®¾è®¡æ¶çååä¹ä¸ã\n\né«æ§è½å¢å æºå¨ç®çå¨äºâæ©å±âå¤çæ§è½ï¼é«å¯ç¨å¢å æºå¨ç®çå¨äºâåä½âå¤çååã\n\nåç¹ç³»ç»ï¼æ¯æ æ³ä¿è¯é«å¯ç¨çãç³»ç»èªèº«æéãæ­çµãç¡¬ä»¶æéãç½ç»ç­ç­ï¼é½å¯è½å¯¼è´æå¡ä¸å¯ç¨ãé«å¯ç¨æ¹æ¡äºè±å«é¨ï¼æ¬è´¨ä¸é½æ¯éè¿âåä½âæ¥å®ç°é«å¯ç¨ã\n\n# 2.5.1. æ ç¶æåºç¨çé«å¯ç¨\n\næ ç¶æåºç¨ä¸è¬å·æå¹ç­æ§ï¼å³**æ è®ºå¨åªå°æºå¨ä¸è¿è¡è®¡ç®ï¼åæ ·çç®æ³åè¾å¥æ°æ®ï¼äº§åºçç»æé½æ¯ä¸æ ·çã**æä»¥ï¼è®¡ç®å¨ä»»æèç¹æå¡å¨ä¸æ§è¡ï¼ç»æé½ä¸æ ·ã\n\næ ç¶æåºç¨çé«å¯ç¨ï¼\n\n * éè¦å¢å ä¸ä¸ªä»»å¡åéå¨ï¼éæ©åéçä»»å¡åéå¨ä¹æ¯ä¸ä»¶å¤æçäºæï¼éè¦ç»¼åèèæ§è½ãææ¬ãå¯ç»´æ¤æ§ãå¯ç¨æ§ç­åæ¹é¢å ç´ ã\n * ä»»å¡åéå¨åçæ­£çä¸å¡æå¡å¨ä¹é´æè¿æ¥åäº¤äºï¼éè¦éæ©åéçè¿æ¥æ¹å¼ï¼å¹¶ä¸å¯¹è¿æ¥è¿è¡ç®¡çãä¾å¦ï¼è¿æ¥å»ºç«ãè¿æ¥æ£æµãè¿æ¥ä¸­æ­åå¦ä½å¤çç­ã\n * ä»»å¡åéå¨éè¦å¢å åéç®æ³ãä¾å¦ï¼å¸¸è§çåæºç®æ³æä¸»å¤ãä¸»ä¸»ï¼ä¸»å¤æ¹æ¡åå¯ä»¥ç»åä¸ºå·å¤ãæ¸©å¤ãç­å¤ã\n\n# 2.5.2. æç¶æåºç¨çé«å¯ç¨\n\næç¶æåºç¨ï¼æ¯æéè¦å­å¨æ°æ®çç³»ç»ï¼æ¯å¦åç§åå¸å¼å­å¨ãåæ ç¶æåºç¨ç¸æ¯ï¼æä¸ä¸ªæ¬è´¨ä¸çåºå«ï¼åèç¹éè¦éè¿åæ­¥ä¿ææ°æ®ä¸è´ãåå¸å¼é¢åéé¢æä¸ä¸ªèåç cap å®çï¼ä»çè®ºä¸è®ºè¯äºå­å¨é«å¯ç¨çå¤æåº¦ãä¹å°±æ¯è¯´ï¼å­å¨é«å¯ç¨ä¸å¯è½åæ¶æ»¡è¶³âä¸è´æ§ãå¯ç¨æ§ãååºå®¹éæ§âï¼æå¤æ»¡è¶³å¶ä¸­ä¸¤ä¸ªï¼è¿å°±è¦æ±æä»¬å¨åæ¶æè®¾è®¡æ¶ç»åä¸å¡è¿è¡åèã\n\n# 2.5.3. é«å¯ç¨ææ®µ\n\né«å¯ç¨çå¸¸ç¨ææ®µï¼\n\n * è´è½½åè¡¡ - éè¿è´è½½åè¡¡è®¾å¤å»ºç«éç¾¤å±åå¯¹å¤æä¾æå¡ã\n * å¤ä»½ - æ°æ®å­å¨å¨å¤å°æå¡å¨ï¼äºç¸å¤ä»½ãå³ä½¿è®¿é®åè´è½½å¾å°çæå¡ä¹å¿é¡»é¨ç½²è³å°ä¸¤å°æå¡å¨ï¼ææä¸ä¸ªéç¾¤ï¼ç®çå°±æ¯éè¿åä½å®ç°æå¡çé«å¯ç¨ã\n   * å·å¤ä»½ - æ°æ®åºè¯¥å®æå¤ä»½ï¼\n   * ç­å¤ä»½ - ä¸ºäºä¿è¯å¨çº¿ä¸å¡é«å¯ç¨ï¼è¿éè¦å¯¹æ°æ®åºè¿è¡ä¸»ä»åç¦»ï¼å®æ¶åæ­¥ ã\n   * ç¾å¤ - ä¸ºäºæµå¾¡å°éãæµ·å¸ç­ä¸å¯æå ç´ å¯¼è´çç½ç«å®å¨ç«çªï¼æäºå¤§åç½ç«ä¼å¯¹æ´ä¸ªæ°æ®ä¸­å¿è¿è¡å¤ä»½ï¼å¨çèå´åé¨ç½² ç¾å¤æ°æ®ä¸­å¿ãç½ç«ç¨åºåæ°æ®å®æ¶åæ­¥å°å¤ä¸ªç¾å¤æ°æ®ä¸­å¿ã\n * èªå¨å - èªå¨åæ¯æï¼å¤§åç³»ç»æå¿è¦éè¿é¢åå¸éªè¯ãèªå¨åæµè¯ãèªå¨ååå¸ãç°åº¦åå¸ç­ææ®µï¼åå°å°æéå¼å¥çº¿ä¸ç¯å¢çå¯è½ãå¸¸è§èªå¨åææ®µæï¼\n   * åå¸è¿ç¨èªå¨å\n     * èªå¨åä»£ç ç®¡ç\n     * èªå¨åæµè¯\n     * èªå¨åå®å¨çæµ\n     * èªå¨åé¨ç½²\n   * è¿ç»´èªå¨å\n     * èªå¨åçæ§\n     * èªå¨åæ¥è­¦\n     * èªå¨åå¤±æè½¬ç§»\n     * èªå¨åå¤±ææ¢å¤\n     * èªå¨åéçº§\n     * èªå¨ååéèµæº\n\n\n# 2.6. æ©å±æ§\n\n> å¯æ©å±æ§æç³»ç»ä¸ºäºåºå¯¹å°æ¥éæ±ååèæä¾çä¸ç§æ©å±è½åï¼å½ææ°çéæ±åºç°æ¶ï¼ç³»ç»ä¸éè¦æèä»éè¦å°éä¿®æ¹å°±å¯ä»¥æ¯æï¼æ é¡»æ´ä¸ªç³»ç»éææèéå»ºã\n> \n> è¡¡éæ©å±æ§çæ åå°±æ¯å¢å æ°çä¸å¡äº§åæ¶ï¼æ¯å¦å¯ä»¥å®ç°å¯¹ç°æäº§åéææ å½±åï¼ä¸éè¦ä»»ä½æ¹å¨æå¾å°æ¹å¨ï¼æ¢æåè½å°±å¯ä»¥ä¸çº¿æ°äº§åã\n> \n> è½¯ä»¶åå±çä¸ä¸ªéè¦ç®æ åé©±å¨åæ¯éä½è½¯ä»¶è¦åæ§ãäºç©ä¹é´ç´æ¥å³ç³»è¶å°ï¼å½¼æ­¤å½±åå°±è¶å°ï¼ä¹å°±æ´å®¹æç¬ç«åå±ï¼å³æ©å±æ§å¥½ã\n\nä¸»è¦ææ®µæï¼\n\n * åå± - åå±æ¯æ©å±æ§è®¾è®¡çæåºæ¬ææ®µãéè¿åå±ï¼å¯ä»¥å°ä¸ä¸ªçè½¯ä»¶ç³»ç»ååä¸ºä¸åçé¨åï¼ä¾¿äºåå·¥åä½å¼ååç»´æ¤ï¼åå±é´å·æä¸å®çç¬ç«æ§ã\n   \n   * åå±æ¶æççº¦æï¼ç¦æ­¢è·¨å±æ¬¡çè°ç¨åéåè°ç¨ã\n   * å³ä½¿ç³»ç»è§æ¨¡å¾å°ï¼ä¹åºè¯¥èèéç¨åå±çæ¶æï¼è¿æ ·ä¾¿äºä»¥åæ©å±ã\n\n * åå² - å°ä¸åçåè½åæå¡åå²å¼æ¥ï¼åè£æé«åèãä½è¦åçæ¨¡åååãè¿æå©äºè½¯ä»¶çå¼ååç»´æ¤ï¼ä¾¿äºä¸åæ¨¡åçåå¸å¼é¨ç½²ï¼æé«ç³»ç»çå¹¶åå¤çè½åååè½æ©å±è½åã\n\n * å¼æ­¥ - ä¸å¡é´çæ¶æ¯ä¼ éä¸æ¯åæ­¥è°ç¨ï¼èæ¯å°ä¸ä¸ªä¸å¡æä½æåæå¤é¶æ®µï¼æ¯ä¸ªé¶æ®µé´éè¿å±äº«æ°æ®çæ¹å¼å¼æ­¥æ§è¡è¿è¡åä½ã\n   \n   * å¨åä¸æå¡å¨åé¨å¯éè¿å¤çº¿ç¨å±äº«åå­éåçæ¹å¼å®ç°å¼æ­¥ï¼å¤å¨ä¸å¡æä½åé¢ççº¿ç¨å°æä½è¾åºå°éåï¼åé¢ççº¿ç¨ä»éåä¸­è¯»åæ°æ®è¿è¡å¤çï¼\n   * å¨åå¸å¼ç³»ç»ä¸­ï¼å¤ä¸ªæå¡å¨éç¾¤éè¿åå¸å¼æ¶æ¯éåå®ç°å¼æ­¥ã\n\n * åå¸å¼ - å°ä¸å¡åå¯å¤ç¨æå¡åç¦»ï¼éè¿åå¸å¼æå¡æ¡æ¶è°ç¨ãåå¸å¼æ¯æå¤å°æå¡å¨é¨ç½²ç¸ååºç¨ææä¸ä¸ªéç¾¤ï¼éè¿è´è½½åè¡¡è®¾å¤å±åå¯¹å¤æä¾æå¡ãçæå³çæå¡å¯ä»¥ç¨æ´å¤çæºå¨å·¥ä½ï¼å³æ©å± cpuãåå­ãio ç­èµæºï¼ä»èæé«ç³»ç»æ´ä½çååéåå¹¶åå¤çè½åã\n   \n   * å¸¸ç¨çåå¸å¼æ¹æ¡ï¼\n     * åå¸å¼åºç¨åæå¡\n     * åå¸å¼éæèµæº\n     * åå¸å¼æ°æ®åå­å¨\n     * åå¸å¼è®¡ç®\n   * åå¸å¼ä¹å¼å¥äºä¸äºé®é¢ï¼\n     * æå¡è°ç¨å¿é¡»éè¿ç½ç»ï¼ç½ç»å»¶è¿ä¼å½±åæ§è½ã\n     * æå¡å¨è¶å¤ï¼å®æºæ¦çä¹è¶å¤§ï¼å¯¼è´å¯ç¨æ§éä½ã\n     * æ°æ®ä¸è´æ§éå¸¸å°é¾ï¼åå¸å¼äºå¡ä¹é¾ä»¥ä¿è¯ã\n     * ç½ç«ä¾èµéç»¼å¤æï¼å¼åç®¡çç»´æ¤å°é¾ã\n\n\n# 2.7. ä¼¸ç¼©æ§\n\n> è¡¡éä¼¸ç¼©çæ åå°±æ¯æ¯å¦å¯ä»¥ç¨å¤å°æå¡å¨æå»ºéç¾¤ï¼æ¯å¦å®¹æåéç¾¤ä¸­å¢å æå¡å¨èç¹ãå¢å æå¡å¨èç¹åæ¯å¦å¯ä»¥æä¾åä¹åæ å·®å«çæå¡ãéç¾¤ä¸­å¯å®¹çº³çæ»æå¡å¨æ°æ¯å¦æéå¶ã\n\nä¼¸ç¼©æ§æ¯æéè¿å¢/åæå¡å¨èç¹æ°ï¼æ¥çµæ´»çæé«/éä½ç³»ç»å¤çè½åã\n\nä¸»è¦ææ®µæ:\n\n * åºç¨æå¡å¨éç¾¤ - åªè¦æå¡å¨ä¸ä¿å­æ°æ®ï¼åæææå¡å¨é½æ¯å¯¹ç­çï¼éè¿è´è½½åè¡¡è®¾å¤åéç¾¤ä¸­ä¸æ­å å¥æå¡å¨å³å¯\n * ç¼å­æå¡å¨éç¾¤ - å å¥æ°çæå¡å¨å¯è½ä¼å¯¼è´ç¼å­è·¯ç±å¤±æï¼è¿èå¯¼è´éç¾¤ä¸­çå¤§é¨åç¼å­æ°æ®é½æ æ³è®¿é®ãè½ç¶ç¼å­æ°æ®å¯ä»¥éè¿æ°æ®åºéæ°å è½½ï¼ä½æ¯å¦æåºç¨ä¸¥éä¾èµç¼å­ï¼å¯è½ä¼å¯¼è´ç½ç«å´©æºãéè¦æ¹è¿ç¼å­è·¯ç±ç®æ³ä¿è¯ç¼å­æ°æ®çå¯è®¿é®æ§ã\n * å³ç³»åæ°æ®åºéç¾¤ - å³ç³»åæ°æ®åºè½ç¶æ¯ææ°æ®å¤å¶ï¼ä¸»ä»ç­å¤ç­æºå¶ï¼ä½æ¯å¾é¾åå°å¤§è§æ¨¡éç¾¤çå¯ä¼¸ç¼©æ§ï¼å æ­¤å³ç³»åæ°æ®åºçéç¾¤ä¼¸ç¼©æ§æ¹æ¡å¿é¡»å¨æ°æ®åºä¹å¤å®ç°ï¼éè¿è·¯ç±ååºç­ææ®µå°é¨ç½²æå¤ä¸ªæ°æ®åºçæå¡å¨ç»æä¸ä¸ªéç¾¤ã\n * nosql æ°æ®åºéç¾¤ - ç±äºåå¤©å°±æ¯ä¸ºäºåºå¯¹æµ·éæ°æ®èäº§çï¼å æ­¤å¯¹ä¼¸ç¼©æ§çæ¯æéå¸¸é½éå¸¸å¥½ã\n\n\n# 2.8. å®å¨æ§\n\nå®å¨æ¯æç³»ç»åºè¯¥å¯¹æ¶ææ»å»æä¸å®çæµæè½åï¼ä¿æ¤éè¦æ°æ®ä¸è¢«çªåã\n\n * å¯ç  å ææºæ ¡éªç  è¿è¡èº«ä»½è®¤è¯\n * ç»å½ãäº¤æç­éè¦æä½éè¦å¯¹ç½ç»éä¿¡è¿è¡ å å¯ï¼å­å¨çæææ°æ®å¦ç¨æ·ä¿¡æ¯ç­ä¹è¿è¡å å¯å¤ç\n * é²æ­¢æºå¨äººç¨åºæ»å»ç½ç«ï¼ä½¿ç¨ éªè¯ç  è¿è¡è¯å«\n * å¯¹å¸¸è§ç¨äº æ»å» ç½ç«ç xss æ»å»ãsql æ³¨å¥ãè¿è¡ç¼ç è½¬æ¢ç­ç¸åºå¤ç\n * å¯¹åå¾ä¿¡æ¯ãææä¿¡æ¯è¿è¡ è¿æ»¤\n * å¯¹äº¤æè½¬è´¦ç­éè¦æä½æ ¹æ®äº¤ææ¨¡å¼åäº¤æä¿¡æ¯è¿è¡ é£é©æ§å¶\n\n\n# 3. å¸¸è§æ¶ææ¨¡å\n\n\n# 3.1. åå±æ¶æ\n\nåå±æ¶æï¼layered architectureï¼æ¯æå¸¸è§çè½¯ä»¶æ¶æï¼ä¹æ¯äºå®ä¸çæ åæ¶æã\n\nè¿ç§æ¶æå°è½¯ä»¶åæè¥å¹²ä¸ªæ°´å¹³å±ï¼æ¯ä¸å±é½ææ¸æ°çè§è²ååå·¥ï¼ä¸éè¦ç¥éå¶ä»å±çç»èãå±ä¸å±ä¹é´éè¿æ¥å£éä¿¡ã\n\nåå±çç»ææå¸¸è§ã\n\n\n * è¡¨ç°å±ï¼presentationï¼ï¼ç¨æ·çé¢ï¼è´è´£è§è§åç¨æ·äºå¨\n * ä¸å¡å±ï¼businessï¼ï¼å®ç°ä¸å¡é»è¾\n * æä¹å±ï¼persistenceï¼ï¼æä¾æ°æ®ï¼sql è¯­å¥å°±æ¾å¨è¿ä¸å±\n * æ°æ®åºï¼databaseï¼ ï¼ä¿å­æ°æ®\n\nä¼ç¹\n\n * ç»æç®åï¼å®¹æçè§£åå¼å\n * ä¸åæè½çç¨åºåå¯ä»¥åå·¥ï¼è´è´£ä¸åçå±ï¼å¤©ç¶éåå¤§å¤æ°è½¯ä»¶å¬å¸çç»ç»æ¶æ\n * æ¯ä¸å±é½å¯ä»¥ç¬ç«æµè¯ï¼å¶ä»å±çæ¥å£éè¿æ¨¡æè§£å³\n\nç¼ºç¹\n\n * ä¸æ¦ç¯å¢ååï¼éè¦ä»£ç è°æ´æå¢å åè½æ¶ï¼éå¸¸æ¯è¾éº»ç¦åè´¹æ¶\n * é¨ç½²æ¯è¾éº»ç¦ï¼å³ä½¿åªä¿®æ¹ä¸ä¸ªå°å°æ¹ï¼å¾å¾éè¦æ´ä¸ªè½¯ä»¶éæ°é¨ç½²ï¼ä¸å®¹æåæç»­åå¸\n * è½¯ä»¶åçº§æ¶ï¼å¯è½éè¦æ´ä¸ªæå¡æå\n * æ©å±æ§å·®ãç¨æ·è¯·æ±å¤§éå¢å æ¶ï¼å¿é¡»ä¾æ¬¡æ©å±æ¯ä¸å±ï¼ç±äºæ¯ä¸å±åé¨æ¯è¦åçï¼æ©å±ä¼å¾å°é¾\n\n\n# 3.2. äºä»¶é©±å¨æ¶æ\n\näºä»¶ï¼eventï¼æ¯ç¶æåçååæ¶ï¼è½¯ä»¶ååºçéç¥ã\n\näºä»¶é©±å¨æ¶æï¼event-driven architectureï¼å°±æ¯éè¿äºä»¶è¿è¡éä¿¡çè½¯ä»¶æ¶æãå®åæåä¸ªé¨åã\n\n\n * äºä»¶éåï¼event queueï¼ï¼æ¥æ¶äºä»¶çå¥å£\n * ååå¨ï¼event mediatorï¼ï¼å°ä¸åçäºä»¶ååå°ä¸åçä¸å¡é»è¾åå\n * äºä»¶ééï¼event channelï¼ï¼ååå¨ä¸å¤çå¨ä¹é´çèç³»æ¸ é\n * äºä»¶å¤çå¨ï¼event processorï¼ï¼å®ç°ä¸å¡é»è¾ï¼å¤çå®æåä¼ååºäºä»¶ï¼è§¦åä¸ä¸æ­¥æä½\n\nå¯¹äºç®åçé¡¹ç®ï¼äºä»¶éåãååå¨åäºä»¶ééï¼å¯ä»¥åä¸ºä¸ä½ï¼æ´ä¸ªè½¯ä»¶å°±åæäºä»¶ä»£çåäºä»¶å¤çå¨ä¸¤é¨åã\n\n\n\nä¼ç¹\n\n * åå¸å¼çå¼æ­¥æ¶æï¼äºä»¶å¤çå¨ä¹é´é«åº¦è§£è¦ï¼è½¯ä»¶çæ©å±æ§å¥½\n * éç¨æ§å¹¿ï¼åç§ç±»åçé¡¹ç®é½å¯ä»¥ç¨\n * æ§è½è¾å¥½ï¼å ä¸ºäºä»¶çå¼æ­¥æ¬è´¨ï¼è½¯ä»¶ä¸æäº§çå µå¡\n * äºä»¶å¤çå¨å¯ä»¥ç¬ç«å°å è½½åå¸è½½ï¼å®¹æé¨ç½²\n\nç¼ºç¹\n\n * æ¶åå¼æ­¥ç¼ç¨ï¼è¦èèè¿ç¨éä¿¡ãå¤±å»ååºç­æåµï¼ï¼å¼åç¸å¯¹å¤æ\n * é¾ä»¥æ¯æåå­æ§æä½ï¼å ä¸ºäºä»¶éè¿ä¼æ¶åå¤ä¸ªå¤çå¨ï¼å¾é¾åæ»\n * åå¸å¼åå¼æ­¥ç¹æ§å¯¼è´è¿ä¸ªæ¶æè¾é¾æµè¯\n\n\n# 3.3. å¾®æ ¸æ¶æ\n\nå¾®æ ¸æ¶æï¼microkernel architectureï¼åç§°ä¸º"æä»¶æ¶æ"ï¼plug-in architectureï¼ï¼æçæ¯è½¯ä»¶çåæ ¸ç¸å¯¹è¾å°ï¼ä¸»è¦åè½åä¸å¡é»è¾é½éè¿æä»¶å®ç°ã\n\nåæ ¸ï¼coreï¼éå¸¸åªåå«ç³»ç»è¿è¡çæå°åè½ãæä»¶åæ¯äºç¸ç¬ç«çï¼æä»¶ä¹é´çéä¿¡ï¼åºè¯¥åå°å°æä½ï¼é¿ååºç°äºç¸ä¾èµçé®é¢ã\n\n\n\nä¼ç¹\n\n * è¯å¥½çåè½å»¶ä¼¸æ§ï¼extensibilityï¼ï¼éè¦ä»ä¹åè½ï¼å¼åä¸ä¸ªæä»¶å³å¯\n * åè½ä¹é´æ¯éç¦»çï¼æä»¶å¯ä»¥ç¬ç«çå è½½åå¸è½½ï¼ä½¿å¾å®æ¯è¾å®¹æé¨ç½²ï¼\n * å¯å®å¶æ§é«ï¼éåºä¸åçå¼åéè¦\n * å¯ä»¥æ¸è¿å¼å°å¼åï¼éæ­¥å¢å åè½\n\nç¼ºç¹\n\n * æ©å±æ§ï¼scalabilityï¼å·®ï¼åæ ¸éå¸¸æ¯ä¸ä¸ªç¬ç«ååï¼ä¸å®¹æåæåå¸å¼\n * å¼åé¾åº¦ç¸å¯¹è¾é«ï¼å ä¸ºæ¶åå°æä»¶ä¸åæ ¸çéä¿¡ï¼ä»¥ååé¨çæä»¶ç»è®°æºå¶\n\n\n# 3.4. å¾®æå¡æ¶æ\n\nå¾®æå¡æ¶æï¼microservices architectureï¼æ¯æå¡å¯¼åæ¶æï¼service-oriented architectureï¼ç¼©å soaï¼çåçº§ã\n\næ¯ä¸ä¸ªæå¡å°±æ¯ä¸ä¸ªç¬ç«çé¨ç½²ååï¼separately deployed unitï¼ãè¿äºååé½æ¯åå¸å¼çï¼äºç¸è§£è¦ï¼éè¿è¿ç¨éä¿¡åè®®ï¼æ¯å¦ restãsoapï¼èç³»ã\n\n\n\nå¾®æå¡æ¶æåæä¸ç§å®ç°æ¨¡å¼ã\n\n * restful api æ¨¡å¼ï¼æå¡éè¿ api æä¾ï¼äºæå¡å°±å±äºè¿ä¸ç±»\n * restful åºç¨æ¨¡å¼ï¼æå¡éè¿ä¼ ç»çç½ç»åè®®æèåºç¨åè®®æä¾ï¼èåéå¸¸æ¯ä¸ä¸ªå¤åè½çåºç¨ç¨åºï¼å¸¸è§äºä¼ä¸åé¨\n * éä¸­æ¶æ¯æ¨¡å¼ï¼éç¨æ¶æ¯ä»£çï¼message brokerï¼ï¼å¯ä»¥å®ç°æ¶æ¯éåãè´è½½åè¡¡ãç»ä¸æ¥å¿åå¼å¸¸å¤çï¼ç¼ºç¹æ¯ä¼åºç°åç¹å¤±è´¥ï¼æ¶æ¯ä»£çå¯è½è¦åæéç¾¤\n\nä¼ç¹\n\n * æ©å±æ§å¥½ï¼åä¸ªæå¡ä¹é´ä½è¦å\n * å®¹æé¨ç½²ï¼è½¯ä»¶ä»åä¸å¯é¨ç½²ååï¼è¢«ææäºå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡é½æ¯å¯é¨ç½²åå\n * å®¹æå¼åï¼æ¯ä¸ªç»ä»¶é½å¯ä»¥è¿è¡æç»­éæå¼çå¼åï¼å¯ä»¥åå°å®æ¶é¨ç½²ï¼ä¸é´æ­å°åçº§\n * æäºæµè¯ï¼å¯ä»¥åç¬æµè¯æ¯ä¸ä¸ªæå¡\n\nç¼ºç¹\n\n * ç±äºå¼ºè°äºç¸ç¬ç«åä½è¦åï¼æå¡å¯è½ä¼æåå¾å¾ç»ãè¿å¯¼è´ç³»ç»ä¾èµå¤§éçå¾®æå¡ï¼åå¾å¾åä¹±åç¬¨éï¼æ§è½ä¹ä¼ä¸ä½³ã\n * ä¸æ¦æå¡ä¹é´éè¦éä¿¡ï¼å³ä¸ä¸ªæå¡è¦ç¨å°å¦ä¸ä¸ªæå¡ï¼ï¼æ´ä¸ªæ¶æå°±ä¼åå¾å¤æãå¸åçä¾å­å°±æ¯ä¸äºéç¨ç utility ç±»ï¼ä¸ç§è§£å³æ¹æ¡æ¯æå®ä»¬æ·è´å°æ¯ä¸ä¸ªæå¡ä¸­å»ï¼ç¨åä½æ¢åæ¶æçç®åæ§ã\n * åå¸å¼çæ¬è´¨ä½¿å¾è¿ç§æ¶æå¾é¾å®ç°åå­æ§æä½ï¼äº¤æåæ»ä¼æ¯è¾å°é¾ã\n\n\n# 3.5. äºæ¶æ\n\näºç»æï¼cloud architectureï¼ä¸»è¦è§£å³æ©å±æ§åå¹¶åçé®é¢ï¼æ¯æå®¹ææ©å±çæ¶æã\n\nå®çé«æ©å±æ§ï¼ä¸»è¦åå æ¯æ²¡ä½¿ç¨ä¸­å¤®æ°æ®åºï¼èæ¯ææ°æ®é½å¤å¶å°åå­ä¸­ï¼åæå¯å¤å¶çåå­æ°æ®ååãç¶åï¼ä¸å¡å¤çè½åå°è£æä¸ä¸ªä¸ªå¤çååï¼prcessing unitï¼ãè®¿é®éå¢å ï¼å°±æ°å»ºå¤çååï¼è®¿é®éåå°ï¼å°±å³é­å¤çååãç±äºæ²¡æä¸­å¤®æ°æ®åºï¼æä»¥æ©å±æ§çæå¤§ç¶é¢æ¶å¤±äºãç±äºæ¯ä¸ªå¤çååçæ°æ®é½å¨åå­éï¼æå¥½è¦è¿è¡æ°æ®æä¹åã\n\n\n\nè¿ä¸ªæ¨¡å¼ä¸»è¦åæä¸¤é¨åï¼å¤çååï¼processing unitï¼åèæä¸­é´ä»¶ï¼virtualized middlewareï¼ã\n\n * å¤çååï¼å®ç°ä¸å¡é»è¾\n * èæä¸­é´ä»¶ï¼è´è´£éä¿¡ãä¿æ sessionsãæ°æ®å¤å¶ãåå¸å¼å¤çãå¤çååçé¨ç½²ã\n\nèæä¸­é´ä»¶ååå«åä¸ªç»ä»¶ã\n\n>  * æ¶æ¯ä¸­é´ä»¶ï¼messaging gridï¼ï¼ç®¡çç¨æ·è¯·æ±å sessionï¼å½ä¸ä¸ªè¯·æ±è¿æ¥ä»¥åï¼å³å®åéç»åªä¸ä¸ªå¤çååã\n>  * æ°æ®ä¸­é´ä»¶ï¼data gridï¼ï¼å°æ°æ®å¤å¶å°æ¯ä¸ä¸ªå¤çååï¼å³æ°æ®åæ­¥ãä¿è¯æä¸ªå¤çååé½å¾å°åæ ·çæ°æ®ã\n>  * å¤çä¸­é´ä»¶ï¼processing gridï¼ï¼å¯éï¼å¦æä¸ä¸ªè¯·æ±æ¶åä¸åç±»åçå¤çååï¼è¯¥ä¸­é´ä»¶è´è´£åè°å¤çåå\n>  * é¨ç½²ä¸­é´ä»¶ï¼deployment managerï¼ï¼è´è´£å¤çååçå¯å¨åå³é­ï¼çæ§è´è½½åååºæ¶é´ï¼å½è´è½½å¢å ï¼å°±æ°å¯å¨å¤çååï¼è´è½½åå°ï¼å°±å³é­å¤çååã\n\nä¼ç¹\n\n * é«è´è½½ï¼é«æ©å±æ§\n * å¨æé¨ç½²\n\nç¼ºç¹\n\n * å®ç°å¤æï¼ææ¬è¾é«\n * ä¸»è¦éåç½ç«ç±»åºç¨ï¼ä¸åéå¤§éæ°æ®ååçå¤§åæ°æ®åºåºç¨\n * è¾é¾æµè¯\n\n\n# 4. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ãä» 0 å¼å§å­¦æ¶æã\n * è½¯ä»¶æ¶æå¥é¨- é®ä¸å³°çç½ç»æ¥å¿',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»é«æ§è½æ¶æ",frontmatter:{title:"ç³»ç»é«æ§è½æ¶æ",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","æ§è½"],permalink:"/pages/41c2c7/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/03.%E7%B3%BB%E7%BB%9F%E9%AB%98%E6%80%A7%E8%83%BD%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/03.ç³»ç»é«æ§è½æ¶æ.md",key:"v-4239add5",path:"/pages/41c2c7/",headers:[{level:2,title:"æ§è½ç®ä»",slug:"æ§è½ç®ä»",normalizedTitle:"æ§è½ç®ä»",charIndex:14},{level:3,title:"è®¡ç®æºèµæº",slug:"è®¡ç®æºèµæº",normalizedTitle:"è®¡ç®æºèµæº",charIndex:173},{level:3,title:"æ§è½ææ ",slug:"æ§è½ææ ",normalizedTitle:"æ§è½ææ ",charIndex:92},{level:4,title:"ååºæ¶é´",slug:"ååºæ¶é´",normalizedTitle:"ååºæ¶é´",charIndex:299},{level:4,title:"å¹¶åæ°",slug:"å¹¶åæ°",normalizedTitle:"å¹¶åæ°",charIndex:307},{level:4,title:"ååé",slug:"ååé",normalizedTitle:"ååé",charIndex:314},{level:4,title:"èµæºåéä½¿ç¨ç",slug:"èµæºåéä½¿ç¨ç",normalizedTitle:"èµæºåéä½¿ç¨ç",charIndex:339},{level:3,title:"æ§è½æµè¯",slug:"æ§è½æµè¯",normalizedTitle:"æ§è½æµè¯",charIndex:283},{level:3,title:"æ§è½ä¼åç­ç¥",slug:"æ§è½ä¼åç­ç¥",normalizedTitle:"æ§è½ä¼åç­ç¥",charIndex:1321},{level:2,title:"åºç¨æå¡æ§è½ä¼å",slug:"åºç¨æå¡æ§è½ä¼å",normalizedTitle:"åºç¨æå¡æ§è½ä¼å",charIndex:1487},{level:3,title:"ç¼å­",slug:"ç¼å­",normalizedTitle:"ç¼å­",charIndex:1092},{level:3,title:"å¹¶åæ¨¡å",slug:"å¹¶åæ¨¡å",normalizedTitle:"å¹¶åæ¨¡å",charIndex:1747},{level:4,title:"PPC",slug:"ppc",normalizedTitle:"ppc",charIndex:2013},{level:4,title:"prefork",slug:"prefork",normalizedTitle:"prefork",charIndex:2287},{level:4,title:"TPC",slug:"tpc",normalizedTitle:"tpc",charIndex:2868},{level:4,title:"prethread",slug:"prethread",normalizedTitle:"prethread",charIndex:3579},{level:4,title:"Reactor",slug:"reactor",normalizedTitle:"reactor",charIndex:4164},{level:3,title:"å¼æ­¥æä½",slug:"å¼æ­¥æä½",normalizedTitle:"å¼æ­¥æä½",charIndex:4692},{level:3,title:"è´è½½åè¡¡",slug:"è´è½½åè¡¡",normalizedTitle:"è´è½½åè¡¡",charIndex:4849},{level:3,title:"ä»£ç ä¼å",slug:"ä»£ç ä¼å",normalizedTitle:"ä»£ç ä¼å",charIndex:5021},{level:4,title:"å¤çº¿ç¨",slug:"å¤çº¿ç¨",normalizedTitle:"å¤çº¿ç¨",charIndex:2005},{level:5,title:"çº¿ç¨å®å¨é®é¢",slug:"çº¿ç¨å®å¨é®é¢",normalizedTitle:"çº¿ç¨å®å¨é®é¢",charIndex:5304},{level:4,title:"èµæºå¤ç¨",slug:"èµæºå¤ç¨",normalizedTitle:"èµæºå¤ç¨",charIndex:5463},{level:4,title:"æ°æ®ç»æ",slug:"æ°æ®ç»æ",normalizedTitle:"æ°æ®ç»æ",charIndex:5547},{level:4,title:"åå¾åæ¶",slug:"åå¾åæ¶",normalizedTitle:"åå¾åæ¶",charIndex:5574},{level:2,title:"å­å¨æ§è½ä¼å",slug:"å­å¨æ§è½ä¼å",normalizedTitle:"å­å¨æ§è½ä¼å",charIndex:5673},{level:3,title:"æ°æ®åº",slug:"æ°æ®åº",normalizedTitle:"æ°æ®åº",charIndex:262},{level:4,title:"æ°æ®åºè¯»ååç¦»",slug:"æ°æ®åºè¯»ååç¦»",normalizedTitle:"æ°æ®åºè¯»ååç¦»",charIndex:5691},{level:4,title:"æ°æ®åºååºåè¡¨",slug:"æ°æ®åºååºåè¡¨",normalizedTitle:"æ°æ®åºååºåè¡¨",charIndex:5749},{level:4,title:"Nosql",slug:"nosql",normalizedTitle:"nosql",charIndex:5836},{level:3,title:"æä»¶å­å¨",slug:"æä»¶å­å¨",normalizedTitle:"æä»¶å­å¨",charIndex:6402},{level:4,title:"æºæ¢°é®çååºæç¡¬ç",slug:"æºæ¢°é®çååºæç¡¬ç",normalizedTitle:"æºæ¢°é®çååºæç¡¬ç",charIndex:6410},{level:4,title:"B+æ°å LSM æ ",slug:"b-æ°å-lsm-æ ",normalizedTitle:"b+æ°å lsm æ ",charIndex:6451},{level:4,title:"RAID å HDFS",slug:"raid-å-hdfs",normalizedTitle:"raid å hdfs",charIndex:6733},{level:2,title:"åç«¯æ§è½ä¼å",slug:"åç«¯æ§è½ä¼å",normalizedTitle:"åç«¯æ§è½ä¼å",charIndex:1480},{level:3,title:"æµè§å¨è®¿é®ä¼å",slug:"æµè§å¨è®¿é®ä¼å",normalizedTitle:"æµè§å¨è®¿é®ä¼å",charIndex:7045},{level:3,title:"CDN",slug:"cdn",normalizedTitle:"cdn",charIndex:7606},{level:3,title:"ååä»£ç",slug:"ååä»£ç",normalizedTitle:"ååä»£ç",charIndex:7691},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:7924}],headersStr:"æ§è½ç®ä» è®¡ç®æºèµæº æ§è½ææ  ååºæ¶é´ å¹¶åæ° ååé èµæºåéä½¿ç¨ç æ§è½æµè¯ æ§è½ä¼åç­ç¥ åºç¨æå¡æ§è½ä¼å ç¼å­ å¹¶åæ¨¡å PPC prefork TPC prethread Reactor å¼æ­¥æä½ è´è½½åè¡¡ ä»£ç ä¼å å¤çº¿ç¨ çº¿ç¨å®å¨é®é¢ èµæºå¤ç¨ æ°æ®ç»æ åå¾åæ¶ å­å¨æ§è½ä¼å æ°æ®åº æ°æ®åºè¯»ååç¦» æ°æ®åºååºåè¡¨ Nosql æä»¶å­å¨ æºæ¢°é®çååºæç¡¬ç B+æ°å LSM æ  RAID å HDFS åç«¯æ§è½ä¼å æµè§å¨è®¿é®ä¼å CDN ååä»£ç åèèµæ",content:"# ç³»ç»é«æ§è½æ¶æ\n\n\n# æ§è½ç®ä»\n\nè¦è®¾è®¡é«æ§è½çç³»ç»æ¶æï¼åºè¯¥æä»¥ä¸çæç»´æ­¥éª¤ï¼\n\né¦åï¼è¦æç¡®å½±åæ§è½çå ç´ æåªäºï¼æ§è½çææ æåªäºï¼ââåå°æçæ¾ç¢ã\n\nå¶æ¬¡ï¼è¦äºè§£å¦ä½æµè¯æ§è½ææ ï¼æ§è½ä¼åï¼å¿é¡»è¦æååçææå¯¹æ¯ï¼æè½è¯ææ§è½ç¡®å®ææ¹åã\n\næ¥ä¸æ¥ï¼å­¦ä¹ éå¯¹ä¸ååºæ¯ä¸ï¼ä¸åæ§ææ çä¼åç­ç¥ä»¥åå·ä½å®æ½æ¹æ¡ãââè§æææã\n\n\n# è®¡ç®æºèµæº\n\näºè§£æ§è½ææ åï¼éè¦åç¥éåªäºè®¡ç®æºèµæºä¼å½±åæ§è½ãä¸è¬æ¥è¯´ï¼å½±åæ§è½çè®¡ç®æºèµæºåæ¬ï¼\n\n * CPU\n * åå­\n * ç£ç I/O\n * ç½ç» I/O\n * æ°æ®åº\n * éç«äº\n\n\n# æ§è½ææ \n\næ§è½æµè¯çä¸»è¦ææ æï¼\n\n * ååºæ¶é´\n * å¹¶åæ°\n * ååé\n   * QPS\n   * TPS\n * èµæºåéä½¿ç¨ç\n\n# ååºæ¶é´\n\nååºæ¶é´(RT)æ¯æä»å®¢æ·ç«¯åä¸ä¸ªè¯·æ±å¼å§è®¡æ¶ï¼å°å®¢æ·ç«¯æ¥æ¶å°ä»æå¡å¨ç«¯è¿åçååºç»æç»ææç»åçæ¶é´ï¼ååºæ¶é´ç±è¯·æ±åéæ¶é´ãç½ç»ä¼ è¾æ¶é´åæå¡å¨å¤çæ¶é´ä¸é¨åç»æã\n\nååºæ¶é´è¶ç­ï¼æ§è½è¶å¥½ï¼ä¸è¬ä¸ä¸ªæ¥å£çååºæ¶é´æ¯å¨æ¯«ç§çº§ã\n\nååºæ¶é´å¯ä»¥è¿ä¸æ­¥ç»åï¼\n\n * å®¢æ·ç«¯ååºæ¶é´\n * ç½ç»ååºæ¶é´\n * æå¡ç«¯ååºæ¶é´\n * æ°æ®åºååºæ¶é´\n\n# å¹¶åæ°\n\nå¹¶åæ°æ¯æç³»ç»è½åæ¶å¤ççè¯·æ±ãäºå¡æ°ã\n\nç³»ç»èªèº«ç CPU å¤çè½åãåå­ãä»¥åç³»ç»èªèº«ççº¿ç¨å¤ç¨ãéç«äºç­é½ä¼å½±åå¹¶åæ°ã\n\n# ååé\n\nååéè®¡ç®å¬å¼ï¼\n\nååé = å¹¶åæ° / å¹³åååºæ¶é´\n\n\nååéè¶å¤§ï¼æ§è½è¶å¥½ã\n\nä¸è¬ï¼ç³»ç»åç°ç»å¤é¨çæå¸¸è§çååéææ ï¼å°±æ¯ï¼\n\n * QPS(æ¯ç§æ¥è¯¢æ°) - å³ç³»ç»æ¯ç§å¯ä»¥å¤ççè¯»è¯·æ±ã\n * TPS(æ¯ç§äºå¡æ°) - å³ç³»ç»æ¯ç§å¯ä»¥å¤ççåè¯·æ±ã\n\nèå¨ç³»ç»åé¨ï¼å­å¨ä»¥ä¸ååéï¼\n\n * ç£çååé - ä½ç°äºç£çéæºè¯»åçæ§è½ã\n * ç½ç»ååé - é¤äºåéäºç½ç»å¸¦å®½ï¼CPU çå¤çè½åãç½å¡ãé²ç«å¢ãå¤é¨æ¥å£ä»¥å I/Oãç³»ç» IO ç®æ³é½ä¼å½±åå°ç½ç»ååéã\n\n# èµæºåéä½¿ç¨ç\n\néå¸¸ç± CPU å ç¨çãåå­ä½¿ç¨çãç£ç I/Oãç½ç» I/O ãå¯¹è±¡ä¸çº¿ç¨æ°æ¥è¡¨ç¤ºèµæºä½¿ç¨çãè¿äºææ ä¹æ¯ç³»ç»çæ§çéè¦åæ°ã\n\n\n# æ§è½æµè¯\n\næ§è½æµè¯ææ®µï¼\n\n * æ§è½æµè¯\n * è´è½½æµè¯\n * ååæµè¯\n * ç¨³å®æ§æµè¯\n\nå¯¹äº Java åºç¨èè¨ï¼æç®åçï¼å¯ä»¥ä½¿ç¨ Jmeter è¿è¡æ§è½æµè¯ã\n\næ§è½æµè¯æ¥åç¤ºä¾ï¼\n\n\n#### æ§è½æµè¯çé®é¢\n\næ§è½æµè¯æ¶ï¼éè¦æ³¨æä¸äºé®é¢ï¼\n\n * ç­èº«é®é¢ - ç³»ç»åå¼å§è¿è¡æ¶ï¼èªèº«å¯è½å è½½ç¼å­ï¼JVM å¯è½ä¼ä¼åç­ç¹ä»£ç ç­ï¼è¿äºè¡ä¸ºé½å¯è½ä½¿å¾ååæè¾å¤§çæ§è½å·®å¼ãæä»¥ï¼æ§è½æµè¯æ¶ï¼åºè¯¥åè·³è¿ä¸æ®µç­èº«æ¶é´ï¼ç­è¶äºç¨³å®åï¼åå¼å§æ§è½æµè¯ã\n * æµè¯ç»æä¸ç¨³å® - æ§è½æµè¯ä¸­ï¼æå¾å¤ä¸ç¨³å®çå ç´ ï¼å¦ç¯å¢ãç½ç»ç­ï¼å ä¹ä¸å¯è½æ¯æ¬¡é½æ¯ä¸æ ·çç»æãæä»¥åºè¯¥å¤æ¬¡æµè¯ï¼æ±å¹³åå¼ã\n * å¤ JVM æåµä¸çå½±å - åºå°½éé¿åä¸å°æºå¨é¨ç½²å¤ä¸ª JVM çæåµãå ä¸ºä»»æä¸ä¸ª JVM é½æ¥ææ´ä¸ªç³»ç»çèµæºä½¿ç¨æï¼æä»¥å¨æ§è½æµè¯æ¶ï¼å¯è½ä¼å½¼æ­¤å¹²æ°ã\n\n\n# æ§è½ä¼åç­ç¥\n\n 1. æ§è½åæ - å¦æè¯·æ±ååºæ¢ï¼å­å¨æ§è½é®é¢ãéè¦å¯¹è¯·æ±ç»åçåä¸ªç¯èéä¸åæï¼ææ¥å¯è½åºç°æ§è½ç¶é¢çå°æ¹ï¼å®ä½é®é¢ãæ£æ¥çæ§æ°æ®ï¼åæå½±åæ§è½çä¸»è¦å ç´ ï¼åå­ãç£çãç½ç»ãCPUï¼å¯è½æ¯ä»£ç ææ¶æè®¾è®¡ä¸åçï¼åæèæ¯ç³»ç»èµæºç¡®å®ä¸è¶³ã\n 2. æ§è½ä¼å - æ§è½ä¼åæ ¹æ®ç½ç«åå±æ¶æï¼å¤§è´å¯åä¸ºåç«¯æ§è½ä¼åãåºç¨æå¡æ§è½ä¼åãå­å¨æå¡æ§è½ä¼åã\n\n\n# åºç¨æå¡æ§è½ä¼å\n\n\n# ç¼å­\n\nç½ç«æ§è½ä¼åç¬¬ä¸å®å¾ï¼ç¬¬ä¸ä¼åèèä½¿ç¨ç¼å­æåæ§è½ã\n\nç¼å­æ¯ç¨äºå­å¨æ°æ®çç¡¬ä»¶æè½¯ä»¶çç»æé¨åï¼ä»¥ä½¿å¾åç»­æ´å¿«è®¿é®ç¸åºçæ°æ®ãç¼å­ä¸­çæ°æ®å¯è½æ¯æåè®¡ç®å¥½çç»æãæ°æ®çå¯æ¬ç­ã\n\n * åç¹åºç¨å¯ä»¥ä½¿ç¨è¿ç¨åç¼å­ï¼å¦ï¼ConcurrentHashMapãCaffeineï¼ï¼\n * åå¸å¼åºç¨å¯ä»¥ä½¿ç¨åå¸å¼ç¼å­ï¼å¦ï¼RedisãMemcachedï¼ï¼æè¿ç¨ç¼å­+åå¸å¼ç¼å­çå¤çº§ç¼å­æ¹æ¡ã\n\n> ç¼å­è§£å³æ¹æ¡è¯·åèï¼ç¼å­åºæ¬åç\n\n\n# å¹¶åæ¨¡å\n\né«å¹¶åéè¦æ ¹æ®ä¸¤ä¸ªæ¡ä»¶ååï¼è¿æ¥æ°éï¼è¯·æ±æ°éã\n\n * æµ·éè¿æ¥ï¼æåä¸ä¸ï¼æµ·éè¯·æ±ï¼ä¾å¦æ¢è´­ï¼ååä¸ç­\n * å¸¸éè¿æ¥ï¼å åä¸ç¾ï¼æµ·éè¯·æ±ï¼ä¾å¦ä¸­é´ä»¶\n * æµ·éè¿æ¥å¸¸éè¯·æ±ï¼ä¾å¦é¨æ·ç½ç«\n * å¸¸éè¿æ¥å¸¸éè¯·æ±ï¼ä¾å¦åé¨è¿è¥ç³»ç»ï¼ç®¡çç³»ç»\n\nåæå¡å¨é«æ§è½çå³é®ä¹ä¸å°±æ¯æå¡å¨éåçå¹¶åæ¨¡å\n\n * æå¡å¨å¦ä½ç®¡çè¿æ¥ã\n * æå¡å¨å¦ä½å¤çè¯·æ±ã\n\nä»¥ä¸ä¸¤ä¸ªè®¾è®¡ç¹æç»é½åæä½ç³»ç»ç I/O æ¨¡ååè¿ç¨æ¨¡åç¸å³ã\n\n * I/O æ¨¡åï¼é»å¡ãéé»å¡ãåæ­¥ãå¼æ­¥ã\n * è¿ç¨æ¨¡åï¼åè¿ç¨ãå¤è¿ç¨ãå¤çº¿ç¨ã\n\n# PPC\n\nPPC æ¯ Process Per Connection çç¼©åï¼å¶å«ä¹æ¯ææ¯æ¬¡ææ°çè¿æ¥å°±æ°å»ºä¸ä¸ªè¿ç¨å»ä¸é¨å¤çè¿ä¸ªè¿æ¥çè¯·æ±ï¼è¿æ¯ä¼ ç»ç UNIX ç½ç»æå¡å¨æéç¨çæ¨¡åãåºæ¬çæµç¨å¾æ¯ï¼\n\n\n\n * ç¶è¿ç¨æ¥åè¿æ¥ï¼å¾ä¸­ acceptï¼ã\n * ç¶è¿ç¨âforkâå­è¿ç¨ï¼å¾ä¸­ forkï¼ã\n * å­è¿ç¨å¤çè¿æ¥çè¯»åè¯·æ±ï¼å¾ä¸­å­è¿ç¨ readãä¸å¡å¤çãwriteï¼ã\n * å­è¿ç¨å³é­è¿æ¥ï¼å¾ä¸­å­è¿ç¨ä¸­ç closeï¼ã\n\nè¿ç§æ¨¡å¼çç¼ºç¹ï¼\n\n * fork ä»£ä»·é«\n * ç¶å­è¿ç¨éä¿¡å¤æ\n * æ¯æçå¹¶åè¿æ¥æ°éæé\n\n# prefork\n\nPPC æ¨¡å¼ä¸­ï¼å½è¿æ¥è¿æ¥æ¶æ fork æ°è¿ç¨æ¥å¤çè¿æ¥è¯·æ±ï¼ç±äº fork è¿ç¨ä»£ä»·é«ï¼ç¨æ·è®¿é®æ¶å¯è½æè§æ¯è¾æ¢ï¼prefork æ¨¡å¼çåºç°å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\né¡¾åæä¹ï¼prefork å°±æ¯æååå»ºè¿ç¨ï¼pre-forkï¼ãç³»ç»å¨å¯å¨çæ¶åå°±é¢ååå»ºå¥½è¿ç¨ï¼ç¶åæå¼å§æ¥åç¨æ·çè¯·æ±ï¼å½ææ°çè¿æ¥è¿æ¥çæ¶åï¼å°±å¯ä»¥çå» fork è¿ç¨çæä½ï¼è®©ç¨æ·è®¿é®æ´å¿«ãä½éªæ´å¥½ãprefork çåºæ¬ç¤ºæå¾æ¯ï¼\n\n\n\nprefork çå®ç°å³é®å°±æ¯å¤ä¸ªå­è¿ç¨é½ accept åä¸ä¸ª socketï¼å½ææ°çè¿æ¥è¿å¥æ¶ï¼æä½ç³»ç»ä¿è¯åªæä¸ä¸ªè¿ç¨è½æå accept æåãä½è¿éä¹å­å¨ä¸ä¸ªå°å°çé®é¢ï¼âæç¾¤âç°è±¡ï¼å°±æ¯æè½ç¶åªæä¸ä¸ªå­è¿ç¨è½ accept æåï¼ä½ææé»å¡å¨ accept ä¸çå­è¿ç¨é½ä¼è¢«å¤éï¼è¿æ ·å°±å¯¼è´äºä¸å¿è¦çè¿ç¨è°åº¦åä¸ä¸æåæ¢äºãå¹¸è¿çæ¯ï¼æä½ç³»ç»å¯ä»¥è§£å³è¿ä¸ªé®é¢ï¼ä¾å¦ Linux 2.6 çæ¬ååæ ¸å·²ç»è§£å³äº accept æç¾¤é®é¢ã\n\nprefork æ¨¡å¼å PPC ä¸æ ·ï¼è¿æ¯å­å¨ç¶å­è¿ç¨éä¿¡å¤æãæ¯æçå¹¶åè¿æ¥æ°éæéçé®é¢ï¼å æ­¤ç®åå®éåºç¨ä¹ä¸å¤ãApache æå¡å¨æä¾äº MPM prefork æ¨¡å¼ï¼æ¨èå¨éè¦å¯é æ§æèä¸æ§è½¯ä»¶å¼å®¹çç«ç¹æ¶éç¨è¿ç§æ¨¡å¼ï¼é»è®¤æåµä¸æå¤§æ¯æ 256 ä¸ªå¹¶åè¿æ¥ã\n\n# TPC\n\nTPC æ¯ Thread Per Connection çç¼©åï¼å¶å«ä¹æ¯ææ¯æ¬¡ææ°çè¿æ¥å°±æ°å»ºä¸ä¸ªçº¿ç¨å»ä¸é¨å¤çè¿ä¸ªè¿æ¥çè¯·æ±ãä¸è¿ç¨ç¸æ¯ï¼çº¿ç¨æ´è½»éçº§ï¼åå»ºçº¿ç¨çæ¶èæ¯è¿ç¨è¦å°å¾å¤ï¼åæ¶å¤çº¿ç¨æ¯å±äº«è¿ç¨åå­ç©ºé´çï¼çº¿ç¨éä¿¡ç¸æ¯è¿ç¨éä¿¡æ´ç®åãå æ­¤ï¼TPC å®éä¸æ¯è§£å³æèå¼±åäº PPC fork ä»£ä»·é«çé®é¢åç¶å­è¿ç¨éä¿¡å¤æçé®é¢ã\n\nTPC çåºæ¬æµç¨æ¯ï¼\n\n\n\n * ç¶è¿ç¨æ¥åè¿æ¥ï¼å¾ä¸­ acceptï¼ã\n * ç¶è¿ç¨åå»ºå­çº¿ç¨ï¼å¾ä¸­ pthreadï¼ã\n * å­çº¿ç¨å¤çè¿æ¥çè¯»åè¯·æ±ï¼å¾ä¸­å­çº¿ç¨ readãä¸å¡å¤çãwriteï¼ã\n * å­çº¿ç¨å³é­è¿æ¥ï¼å¾ä¸­å­çº¿ç¨ä¸­ç closeï¼ã\n\næ³¨æï¼å PPC ç¸æ¯ï¼ä¸»è¿ç¨ä¸ç¨âcloseâè¿æ¥äºãåå æ¯å¨äºå­çº¿ç¨æ¯å±äº«ä¸»è¿ç¨çè¿ç¨ç©ºé´çï¼è¿æ¥çæä»¶æè¿°ç¬¦å¹¶æ²¡æè¢«å¤å¶ï¼å æ­¤åªéè¦ä¸æ¬¡ close å³å¯ã\n\nTPC è½ç¶è§£å³äº fork ä»£ä»·é«åè¿ç¨éä¿¡å¤æçé®é¢ï¼ä½æ¯ä¹å¼å¥äºæ°çé®é¢ï¼å·ä½è¡¨ç°å¨ï¼\n\n * åå»ºçº¿ç¨è½ç¶æ¯åå»ºè¿ç¨ä»£ä»·ä½ï¼ä½å¹¶ä¸æ¯æ²¡æä»£ä»·ï¼é«å¹¶åæ¶ï¼ä¾å¦æ¯ç§ä¸ä¸è¿æ¥ï¼è¿æ¯ææ§è½é®é¢ã\n * æ é¡»è¿ç¨é´éä¿¡ï¼ä½æ¯çº¿ç¨é´çäºæ¥åå±äº«åå¼å¥äºå¤æåº¦ï¼å¯è½ä¸ä¸å°å¿å°±å¯¼è´äºæ­»éé®é¢ã\n * å¤çº¿ç¨ä¼åºç°äºç¸å½±åçæåµï¼æä¸ªçº¿ç¨åºç°å¼å¸¸æ¶ï¼å¯è½å¯¼è´æ´ä¸ªè¿ç¨éåºï¼ä¾å¦åå­è¶çï¼ã\n\né¤äºå¼å¥äºæ°çé®é¢ï¼TPC è¿æ¯å­å¨ CPU çº¿ç¨è°åº¦ååæ¢ä»£ä»·çé®é¢ãå æ­¤ï¼TPC æ¹æ¡æ¬è´¨ä¸å PPC æ¹æ¡åºæ¬ç±»ä¼¼ï¼å¨å¹¶åå ç¾è¿æ¥çåºæ¯ä¸ï¼åèæ´å¤å°æ¯éç¨ PPC çæ¹æ¡ï¼å ä¸º PPC æ¹æ¡ä¸ä¼ææ­»éçé£é©ï¼ä¹ä¸ä¼å¤è¿ç¨äºç¸å½±åï¼ç¨³å®æ§æ´é«ã\n\n# prethread\n\nTPC æ¨¡å¼ä¸­ï¼å½è¿æ¥è¿æ¥æ¶æåå»ºæ°ççº¿ç¨æ¥å¤çè¿æ¥è¯·æ±ï¼è½ç¶åå»ºçº¿ç¨æ¯åå»ºè¿ç¨è¦æ´å è½»éçº§ï¼ä½è¿æ¯æä¸å®çä»£ä»·ï¼è prethread æ¨¡å¼å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\nå prefork ç±»ä¼¼ï¼prethread æ¨¡å¼ä¼é¢ååå»ºçº¿ç¨ï¼ç¶åæå¼å§æ¥åç¨æ·çè¯·æ±ï¼å½ææ°çè¿æ¥è¿æ¥çæ¶åï¼å°±å¯ä»¥çå»åå»ºçº¿ç¨çæä½ï¼è®©ç¨æ·æè§æ´å¿«ãä½éªæ´å¥½ã\n\nç±äºå¤çº¿ç¨ä¹é´æ°æ®å±äº«åéä¿¡æ¯è¾æ¹ä¾¿ï¼å æ­¤å®éä¸ prethread çå®ç°æ¹å¼ç¸æ¯ prefork è¦çµæ´»ä¸äºï¼å¸¸è§çå®ç°æ¹å¼æä¸é¢å ç§ï¼\n\n * ä¸»è¿ç¨ acceptï¼ç¶åå°è¿æ¥äº¤ç»æä¸ªçº¿ç¨å¤çã\n * å­çº¿ç¨é½å°è¯å» acceptï¼æç»åªæä¸ä¸ªçº¿ç¨ accept æåï¼æ¹æ¡çåºæ¬ç¤ºæå¾å¦ä¸ï¼\n\n\n\nApache æå¡å¨ç MPM worker æ¨¡å¼æ¬è´¨ä¸å°±æ¯ä¸ç§ prethread æ¹æ¡ï¼ä½ç¨å¾®åäºæ¹è¿ãApache æå¡å¨ä¼é¦ååå»ºå¤ä¸ªè¿ç¨ï¼æ¯ä¸ªè¿ç¨éé¢ååå»ºå¤ä¸ªçº¿ç¨ï¼è¿æ ·åä¸»è¦æ¯ä¸ºäºèèç¨³å®æ§ï¼å³ï¼å³ä½¿æä¸ªå­è¿ç¨éé¢çæä¸ªçº¿ç¨å¼å¸¸å¯¼è´æ´ä¸ªå­è¿ç¨éåºï¼è¿ä¼æå¶ä»å­è¿ç¨ç»§ç»­æä¾æå¡ï¼ä¸ä¼å¯¼è´æ´ä¸ªæå¡å¨å¨é¨ææã\n\nprethread çè®ºä¸å¯ä»¥æ¯ prefork æ¯ææ´å¤çå¹¶åè¿æ¥ï¼Apache æå¡å¨ MPM worker æ¨¡å¼é»è®¤æ¯æ 16 Ã 25 = 400 ä¸ªå¹¶åå¤ççº¿ç¨ã\n\n# Reactor\n\nI/O å¤è·¯å¤ç¨ææ¯å½çº³èµ·æ¥æä¸¤ä¸ªå³é®å®ç°ç¹ï¼\n\n * å½å¤æ¡è¿æ¥å±ç¨ä¸ä¸ªé»å¡å¯¹è±¡åï¼è¿ç¨åªéè¦å¨ä¸ä¸ªé»å¡å¯¹è±¡ä¸ç­å¾ï¼èæ é¡»åè½®è¯¢ææè¿æ¥ï¼å¸¸è§çå®ç°æ¹å¼æ selectãepollãkqueue ç­ã\n * å½ææ¡è¿æ¥ææ°çæ°æ®å¯ä»¥å¤çæ¶ï¼æä½ç³»ç»ä¼éç¥è¿ç¨ï¼è¿ç¨ä»é»å¡ç¶æè¿åï¼å¼å§è¿è¡ä¸å¡å¤çã\n\nI/O å¤è·¯å¤ç¨ç»åçº¿ç¨æ± ï¼å®ç¾å°è§£å³äº PPC å TPC çé®é¢\n\nReactor æ¨¡å¼çæ ¸å¿ç»æé¨ååæ¬ Reactor åå¤çèµæºæ± ï¼è¿ç¨æ± æçº¿ç¨æ± ï¼ï¼å¶ä¸­ Reactor è´è´£çå¬ååéäºä»¶ï¼å¤çèµæºæ± è´è´£å¤çäºä»¶ãåç Reactor çå®ç°æ¯æ¯è¾ç®åçï¼ä½å®éä¸ç»åä¸åçä¸å¡åºæ¯ï¼Reactor æ¨¡å¼çå·ä½å®ç°æ¹æ¡çµæ´»å¤åï¼ä¸»è¦ä½ç°å¨ï¼\n\n * Reactor çæ°éå¯ä»¥ååï¼å¯ä»¥æ¯ä¸ä¸ª Reactorï¼ä¹å¯ä»¥æ¯å¤ä¸ª Reactorã\n * èµæºæ± çæ°éå¯ä»¥ååï¼ä»¥è¿ç¨ä¸ºä¾ï¼å¯ä»¥æ¯åä¸ªè¿ç¨ï¼ä¹å¯ä»¥æ¯å¤ä¸ªè¿ç¨ï¼çº¿ç¨ç±»ä¼¼ï¼ã\n\næç» Reactor æ¨¡å¼æè¿ä¸ç§å¸åçå®ç°æ¹æ¡ï¼\n\n * å Reactor åè¿ç¨ / çº¿ç¨ã\n * å Reactor å¤çº¿ç¨ã\n * å¤ Reactor å¤è¿ç¨ / çº¿ç¨ã\n\n\n# å¼æ­¥æä½\n\nå¼æ­¥å¤çä¸ä»å¯ä»¥åå°ç³»ç»æå¡é´çè¦ååº¦ï¼æé«æ©å±æ§ï¼äºå®ä¸ï¼å®è¿å¯ä»¥æé«ç³»ç»çæ§è½ãå¼æ­¥å¤çå¯ä»¥ææåå°ååºç­å¾æ¶é´ï¼ä»èæé«ååºéåº¦ã\n\nå¼æ­¥å¤çä¸è¬æ¯éè¿åå¸å¼æ¶æ¯éåçæ¹å¼ã\n\nå¼æ­¥å¤çå¯ä»¥è§£å³ä»¥ä¸é®é¢ï¼\n\n * å¼æ­¥ååº\n * åºç¨è§£è¦\n * æµéåé\n * æ¥å¿å¤ç\n * æ¶æ¯éè®¯\n\n\n# è´è½½åè¡¡\n\nå¨é«å¹¶ååºæ¯ä¸ï¼ä½¿ç¨è´è½½åè¡¡ææ¯ä¸ºä¸ä¸ªåºç¨æå»ºä¸ä¸ªç±å¤å°æå¡å¨ç»æçæå¡å¨éç¾¤ï¼å°å¹¶åè®¿é®è¯·æ±ååå°å¤å°æå¡å¨ä¸å¤çï¼é¿ååä¸æå¡å¨å è´è½½ååè¿å¤§èååºç¼æ¢ï¼ä½¿ç¨æ·è¯·æ±å·ææ´å¥½çååºå»¶è¿ç¹æ§ã\n\né«æ§è½éç¾¤çå¤ææ§ä¸»è¦ä½ç°å¨éè¦å¢å ä¸ä¸ªä»»å¡åéå¨ï¼ä»¥åä¸ºä»»å¡éæ©ä¸ä¸ªåéçä»»å¡åéç®æ³ã\n\n> ç¼å­è§£å³æ¹æ¡è¯·åèï¼è´è½½åè¡¡\n\n\n# ä»£ç ä¼å\n\n# å¤çº¿ç¨\n\nä»èµæºå©ç¨çè§åº¦çï¼ä½¿ç¨å¤çº¿ç¨çåå ä¸»è¦æä¸¤ä¸ªï¼IO é»å¡åå¤ CPUã\n\nçº¿ç¨æ°å¹¶éè¶å¤è¶å¥½ï¼é£ä¹å¯å¨å¤å°çº¿ç¨åéå¢ï¼\n\næä¸ªåèå¬å¼ï¼\n\nå¯å¨çº¿ç¨æ° = (ä»»å¡æ§è¡æ¶é´ / (ä»»å¡æ§è¡æ¶é´ - IO ç­å¾æ¶é´)) * CPU åæ ¸æ°\n\n\næä½³å¯å¨çº¿ç¨æ°å CPU åæ ¸æ°ææ­£æ¯ï¼å IO é»å¡æ¶é´æåæ¯ã\n\n * å¦æä»»å¡é½æ¯ CPU è®¡ç®åä»»å¡ï¼é£ä¹çº¿ç¨æ°æå¤ä¸è¦è¶è¿ CPU åæ ¸æ°ï¼å ä¸ºå¯å¨åå¤çº¿ç¨ï¼CPU ä¹æ¥ä¸åè°åº¦ï¼\n * ç¸åï¼å¦ææ¯ä»»å¡éè¦ç­å¾ç£çæä½ï¼ç½ç»ååºï¼é£ä¹å¤å¯å¨çº¿ç¨æå©äºä»»å¡å¹¶ç½èµï¼æé«ç³»ç»ååéã\n\n# çº¿ç¨å®å¨é®é¢\n\nçº¿ç¨å®å¨é®é¢æ¶æå¤ä¸ªçº¿ç¨å¹¶åè®¿é®æä¸ªèµæºï¼å¯¼è´æ°æ®æ··ä¹±ã\n\nè§£å³ææ®µæï¼\n\n * å°å¯¹è±¡è®¾è®¡ä¸ºæ ç¶æå¯¹è±¡ - å¸ååºç¨ï¼Servlet å°±æ¯æ ç¶æå¯¹è±¡ï¼å¯ä»¥è¢«æå¡å¨å¤çº¿ç¨å¹¶åè°ç¨å¤çç¨æ·è¯·æ±ã\n * ä½¿ç¨å±é¨å¯¹è±¡\n * å¹¶åè®¿é®èµæºæ¶ä½¿ç¨é - ä½æ¯å¼å¥éä¼äº§çæ§è½å¼éï¼åºå°½éä½¿ç¨è½»éçº§çéã\n\n# èµæºå¤ç¨\n\nåºè¯¥å°½éåå°é£äºå¼éå¾å¤§çç³»ç»èµæºçåå»ºåéæ¯ï¼å¦æ°æ®åºè¿æ¥ãç½ç»éä¿¡è¿æ¥ãçº¿ç¨ãå¤æå¯¹è±¡ç­ãä»ç¼ç¨è§åº¦ï¼èµæºå¤ç¨ä¸»è¦æä¸¤ç§æ¨¡å¼ï¼åä¾æ¨¡å¼åå¯¹è±¡æ± ã\n\n# æ°æ®ç»æ\n\næ ¹æ®å·ä½åºæ¯ï¼éæ©åéçæ°æ®ç»æã\n\n# åå¾åæ¶\n\nå¦æ Web åºç¨è¿è¡å¨ JVM ç­å·æåå¾åæ¶åè½çç¯å¢ä¸­ï¼é£ä¹åå¾åæ¶å¯è½ä¼å¯¹ç³»ç»çæ§è½ç¹æ§äº§çå·¨å¤§å½±åãç«å³åå¾åæ¶æºå¶æå©äºç¨åºä¼åååæ°è°ä¼ï¼ä»¥åç¼ååå­å®å¨çä»£ç ã\n\n\n# å­å¨æ§è½ä¼å\n\n\n# æ°æ®åº\n\n# æ°æ®åºè¯»ååç¦»\n\nè¯»ååç¦»çåºæ¬åçæ¯å°æ°æ®åºè¯»åæä½åæ£å°ä¸åçèç¹ä¸\n\n> è¯¦ç»è§£å³æ¹æ¡åèï¼åå¸å¼å­å¨\n\n# æ°æ®åºååºåè¡¨\n\næ°æ®åçææç§æä¸ªç»´åº¦å°å­æ¾å¨åä¸æ°æ®åºä¸­çæ°æ®åæ£å°å­æ¾è³å¤ä¸ªæ°æ®åºæè¡¨ä¸­ä»¥è¾¾å°æåæ§è½ç¶é¢ä»¥åå¯ç¨æ§çææã\n\n> è¯¦ç»è§£å³æ¹æ¡åèï¼åå¸å¼å­å¨\n\n# Nosql\n\nå³ç³»åæ°æ®åºçä¼å¿å¨äºï¼å­å¨ç»æåæ°æ®ï¼æå©äºè¿è¡åç§å¤ææ¥è¯¢ã\n\nä½æ¯ï¼å®ä¹å­å¨ä¸äºç¼ºç¹ï¼\n\n * å³ç³»æ°æ®åºå­å¨çæ¯è¡è®°å½ï¼æ æ³å­å¨æ°æ®ç»æ\n * å³ç³»æ°æ®åºç schema æ©å±å¾ä¸æ¹ä¾¿\n * å³ç³»æ°æ®åºå¨å¤§æ°æ®åºæ¯ä¸ I/O è¾é«\n * å³ç³»æ°æ®åºçå¨ææç´¢åè½æ¯è¾å¼±\n\nä¸ºäºè§£å³ä¸è¿°é®é¢ï¼åå«è¯çäºè§£å³ä¸åé®é¢ç Nosql æ°æ®åºã\n\nå¸¸è§ç NoSQL æ°æ®åºå¯ä»¥åä¸ºåç±»ï¼\n\n * K-V æ°æ®åºï¼KV å­å¨éå¸¸éåå­å¨ä¸æ¶åè¿å¤æ°æ®å³ç³»ä¸å¡å³ç³»çæ°æ®ï¼åæ¶è½ææåå°è¯»åç£ççæ¬¡æ°ï¼æ¯ SQL æ°æ®åºå­å¨æ¥ææ´å¥½çè¯»åæ§è½ï¼è½å¤è§£å³å³ç³»åæ°æ®åºæ æ³å­å¨æ°æ®ç»æçé®é¢ãä»¥ Redis ä¸ºä»£è¡¨ã\n * åå¼æ°æ®åºï¼éåäºæ¹éæ°æ®å¤çåå³æ¶æ¥è¯¢ï¼è§£å³å³ç³»æ°æ®åºå¤§æ°æ®åºæ¯ä¸ç I/O é®é¢ãä»¥ HBase ä¸ºä»£è¡¨ã\n * ææ¡£æ°æ®åºï¼ææ¡£æ°æ®åºï¼ä¹ç§°ä¸ºææ¡£åæ°æ®åºï¼æ¯æ¨å¨å°åç»æåæ°æ®å­å¨ä¸ºææ¡£çä¸ç§æ°æ®åºï¼å®å¯ä»¥è§£å³å³ç³»åæ°æ®åºè¡¨ç»æ schema æ©å±ä¸æ¹ä¾¿çé®é¢ãææ¡£æ°æ®åºéå¸¸ä»¥ JSON æ XML æ ¼å¼å­å¨æ°æ®ãä»¥ MongoDB ä¸ºä»£è¡¨ã\n * å¨ææç´¢å¼æï¼è§£å³å³ç³»åæ°æ®åºå¨ææç´¢åè½è¾å¼±çé®é¢ãä»¥ Elasticsearch ä¸ºä»£è¡¨ã\n\n> è¯¦æåèï¼Nosql ææ¯éå\n\n\n# æä»¶å­å¨\n\n# æºæ¢°é®çååºæç¡¬ç\n\nèèä½¿ç¨åºæç¡¬çæ¿ä»£æºæ¢°é®çï¼å ä¸ºå®çè¯»åéåº¦æ´å¿«ã\n\n# B+æ°å LSM æ \n\nä¼ ç»å³ç³»æ°æ®åºçæ°æ®åºç´¢å¼ä¸è¬é½ä½¿ç¨ä¸¤çº§ç´¢å¼ç B+ æ  ç»æï¼æ çå±æ¬¡æå¤ä¸å±ãå æ­¤å¯è½éè¦ 5 æ¬¡ç£çè®¿é®æè½æ´æ°ä¸æ¡è®°å½ï¼ä¸æ¬¡ç£çè®¿é®è·å¾æ°æ®ç´¢å¼åè¡ IDï¼ç¶ååè¿è¡ä¸æ¬¡æ°æ®æä»¶è¯»æä½åä¸æ¬¡æ°æ®æä»¶åæä½ï¼ã\n\nç±äºç£çè®¿é®æ¯éæºçï¼ä¼ ç»æºæ¢°é®çå¨æ°æ®éæºè®¿é®æ¶æ§è½è¾å·®ï¼æ¯æ¬¡æ°æ®è®¿é®é½éè¦å¤æ¬¡è®¿é®ç£çå½±åæ°æ®è®¿é®æ§è½ã\n\nè®¸å¤ Nosql æ°æ®åºä¸­çç´¢å¼éç¨ LSM æ  ä½ä¸ºä¸»è¦æ°æ®ç»æãLSM æ å¯è§ä¸ºä¸ä¸ª N é¶åå¹¶æ ãæ°æ®åæä½é½å¨åå­ä¸­è¿è¡ãå¨ LSM æ ä¸è¿è¡ä¸æ¬¡æ°æ®æ´æ°ä¸éè¦ç£çè®¿é®ï¼éåº¦è¿å¿«äº B+ æ ã\n\n# RAID å HDFS\n\nRAID æ¯ Redundant Array of Independent Disks çç¼©åï¼ä¸­æç®ç§°ä¸ºç¬ç«åä½ç£çéµåã\n\nRAID æ¯ä¸ç§æå¤åç¬ç«çç¡¬çï¼ç©çç¡¬çï¼æä¸åçæ¹å¼ç»åèµ·æ¥å½¢æä¸ä¸ªç¡¬çç»ï¼é»è¾ç¡¬çï¼ï¼ä»èæä¾æ¯åä¸ªç¡¬çæ´é«çå­å¨æ§è½åæä¾æ°æ®å¤ä»½ææ¯ã\n\nHDFS(åå¸å¼æä»¶ç³»ç») æ´è¢«å¤§åç½ç«æéçãå®å¯ä»¥éå MapReduce å¹¶åè®¡ç®ä»»å¡æ¡æ¶è¿è¡å¤§æ°æ®å¤çï¼å¯ä»¥å¨æ´ä¸ªéç¾¤ä¸å¹¶åè®¿é®ææç£çï¼æ é RAID æ¯æã\n\nHDFS å¯¹æ°æ®å­å¨ç©ºé´çç®¡çä»¥æ°æ®åï¼Blockï¼ä¸ºåä½ï¼é»è®¤ä¸º 64 MBãæä»¥ï¼HDFS æ´éåå­å¨è¾å¤§çæä»¶ã\n\n\n# åç«¯æ§è½ä¼å\n\n\n# æµè§å¨è®¿é®ä¼å\n\n 1. åå° HTTP è¯·æ± - HTTP è¯·æ±éè¦å»ºç«éä¿¡é¾è·¯ï¼è¿è¡æ°æ®ä¼ è¾ï¼å¼éé«æï¼æä»¥åå° HTTP è¯·æ±æ°å¯ä»¥æææé«è®¿é®æ§è½ãåå° HTTP çä¸»è¦ææ®µæ¯åå¹¶ CssãJavaScriptãå¾çã\n 2. ä½¿ç¨æµè§å¨ç¼å­ - å ä¸ºéæèµæºæä»¶æ´æ°é¢çä½ï¼å¯ä»¥ç¼å­æµè§å¨ä¸­ä»¥æé«æ§è½ãè®¾ç½® HTTP å¤´ä¸­ç Cache-Control å Expires å±æ§ï¼å¯è®¾å®æµè§å¨ç¼å­ã\n 3. å¯ç¨åç¼© - å¨æå¡å¨ç«¯åç¼©éæèµæºæä»¶ï¼å¨æµè§å¨ç«¯è§£åç¼©ï¼å¯ä»¥ææåå°ä¼ è¾çæ°æ®éãç±äºææ¬æä»¶åç¼©çå¯è¾¾ 80% ä»¥ä¸ï¼æä»¥å¯ä»¥å¯¹éæèµæºï¼å¦ HtmlãCssãJavaScrip è¿è¡åç¼©ã\n 4. CSS æ¾å¨é¡µé¢æä¸é¢ï¼JavaScript æ¾å¨é¡µé¢æä¸é¢ - æµè§å¨ä¼å¨ä¸è½½å®å¨é¨ç Css åæå¯¹æ´ä¸ªé¡µé¢è¿è¡æ¸²æï¼æä»¥æå¥½çåæ³æ¯å° Css æ¾å¨é¡µé¢æä¸é¢ï¼è®©æµè§å¨å°½å¿«ä¸è½½ Cssï¼JavaScript åç¸åï¼æµè§å¨å è½½ JavaScript åç«å³æ§è¡ï¼å¯è½ä¼é»å¡æ´ä¸ªé¡µé¢ï¼é æé¡µé¢æ¾ç¤ºç¼æ¢ï¼å æ­¤ JavaScript æå¥½æ¾å¨é¡µé¢æä¸é¢ã\n 5. åå° Cookie ä¼ è¾ - Cookie åå«å¨ HTTP æ¯æ¬¡çè¯·æ±åååºä¸­ï¼å¤ªå¤§ç Cookie ä¼ä¸¥éå½±åæ°æ®ä¼ è¾ã\n\n\n# CDN\n\nCDN ä¸è¬ç¼å­çæ¯éæèµæºã\n\nCDN çæ¬è´¨ä»ç¶æ¯ä¸ä¸ªç¼å­ï¼èä¸å°æ°æ®ç¼å­å¨ç¦»ç¨æ·æè¿çå°æ¹ï¼ä½¿ç¨æ·å·²æå¿«éåº¦è·åæ°æ®ï¼å³æè°ç½ç»è®¿é®ç¬¬ä¸è·³ã\n\n\n\n\n# ååä»£ç\n\nä¼ ç»ä»£çæå¡å¨ä½äºæµè§å¨ä¸ä¾§ï¼ä»£çæµè§å¨å° HTTP è¯·æ±åéå°äºèç½ä¸ï¼èååä»£çæå¡å¨ä½äºç½ç«æºæ¿ä¸ä¾§ï¼ä»£çç½ç«æå¡å¨æ¥æ¶ HTTP è¯·æ±ã\n\n\n\nååä»£çæå¡å¨å¯ä»¥éç½®ç¼å­åè½å é Web è¯·æ±ï¼å½ç¨æ·ç¬¬ä¸æ¬¡è®¿é®éæåå®¹æ¶ï¼éæåå®¹å°±ä¼è¢«ç¼å­å¨ååä»£çæå¡å¨ä¸ã\n\nååä»£çè¿å¯ä»¥å®ç°è´è½½åè¡¡ï¼éè¿è´è½½åè¡¡æå»ºçéç¾¤å¯ä»¥æé«ç³»ç»æ»ä½å¤çè½åã\n\nå ä¸ºææè¯·æ±é½å¿é¡»åç»è¿ååä»£çæå¡å¨ï¼æä»¥å¯ä»¥å±è½ä¸äºæ»å» IPï¼è¾¾å°ä¿æ¤ç½ç«å®å¨çä½ç¨ã\n\n\n# åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * Java æ§è½è°ä¼å®æ",normalizedContent:"# ç³»ç»é«æ§è½æ¶æ\n\n\n# æ§è½ç®ä»\n\nè¦è®¾è®¡é«æ§è½çç³»ç»æ¶æï¼åºè¯¥æä»¥ä¸çæç»´æ­¥éª¤ï¼\n\né¦åï¼è¦æç¡®å½±åæ§è½çå ç´ æåªäºï¼æ§è½çææ æåªäºï¼ââåå°æçæ¾ç¢ã\n\nå¶æ¬¡ï¼è¦äºè§£å¦ä½æµè¯æ§è½ææ ï¼æ§è½ä¼åï¼å¿é¡»è¦æååçææå¯¹æ¯ï¼æè½è¯ææ§è½ç¡®å®ææ¹åã\n\næ¥ä¸æ¥ï¼å­¦ä¹ éå¯¹ä¸ååºæ¯ä¸ï¼ä¸åæ§ææ çä¼åç­ç¥ä»¥åå·ä½å®æ½æ¹æ¡ãââè§æææã\n\n\n# è®¡ç®æºèµæº\n\näºè§£æ§è½ææ åï¼éè¦åç¥éåªäºè®¡ç®æºèµæºä¼å½±åæ§è½ãä¸è¬æ¥è¯´ï¼å½±åæ§è½çè®¡ç®æºèµæºåæ¬ï¼\n\n * cpu\n * åå­\n * ç£ç i/o\n * ç½ç» i/o\n * æ°æ®åº\n * éç«äº\n\n\n# æ§è½ææ \n\næ§è½æµè¯çä¸»è¦ææ æï¼\n\n * ååºæ¶é´\n * å¹¶åæ°\n * ååé\n   * qps\n   * tps\n * èµæºåéä½¿ç¨ç\n\n# ååºæ¶é´\n\nååºæ¶é´(rt)æ¯æä»å®¢æ·ç«¯åä¸ä¸ªè¯·æ±å¼å§è®¡æ¶ï¼å°å®¢æ·ç«¯æ¥æ¶å°ä»æå¡å¨ç«¯è¿åçååºç»æç»ææç»åçæ¶é´ï¼ååºæ¶é´ç±è¯·æ±åéæ¶é´ãç½ç»ä¼ è¾æ¶é´åæå¡å¨å¤çæ¶é´ä¸é¨åç»æã\n\nååºæ¶é´è¶ç­ï¼æ§è½è¶å¥½ï¼ä¸è¬ä¸ä¸ªæ¥å£çååºæ¶é´æ¯å¨æ¯«ç§çº§ã\n\nååºæ¶é´å¯ä»¥è¿ä¸æ­¥ç»åï¼\n\n * å®¢æ·ç«¯ååºæ¶é´\n * ç½ç»ååºæ¶é´\n * æå¡ç«¯ååºæ¶é´\n * æ°æ®åºååºæ¶é´\n\n# å¹¶åæ°\n\nå¹¶åæ°æ¯æç³»ç»è½åæ¶å¤ççè¯·æ±ãäºå¡æ°ã\n\nç³»ç»èªèº«ç cpu å¤çè½åãåå­ãä»¥åç³»ç»èªèº«ççº¿ç¨å¤ç¨ãéç«äºç­é½ä¼å½±åå¹¶åæ°ã\n\n# ååé\n\nååéè®¡ç®å¬å¼ï¼\n\nååé = å¹¶åæ° / å¹³åååºæ¶é´\n\n\nååéè¶å¤§ï¼æ§è½è¶å¥½ã\n\nä¸è¬ï¼ç³»ç»åç°ç»å¤é¨çæå¸¸è§çååéææ ï¼å°±æ¯ï¼\n\n * qps(æ¯ç§æ¥è¯¢æ°) - å³ç³»ç»æ¯ç§å¯ä»¥å¤ççè¯»è¯·æ±ã\n * tps(æ¯ç§äºå¡æ°) - å³ç³»ç»æ¯ç§å¯ä»¥å¤ççåè¯·æ±ã\n\nèå¨ç³»ç»åé¨ï¼å­å¨ä»¥ä¸ååéï¼\n\n * ç£çååé - ä½ç°äºç£çéæºè¯»åçæ§è½ã\n * ç½ç»ååé - é¤äºåéäºç½ç»å¸¦å®½ï¼cpu çå¤çè½åãç½å¡ãé²ç«å¢ãå¤é¨æ¥å£ä»¥å i/oãç³»ç» io ç®æ³é½ä¼å½±åå°ç½ç»ååéã\n\n# èµæºåéä½¿ç¨ç\n\néå¸¸ç± cpu å ç¨çãåå­ä½¿ç¨çãç£ç i/oãç½ç» i/o ãå¯¹è±¡ä¸çº¿ç¨æ°æ¥è¡¨ç¤ºèµæºä½¿ç¨çãè¿äºææ ä¹æ¯ç³»ç»çæ§çéè¦åæ°ã\n\n\n# æ§è½æµè¯\n\næ§è½æµè¯ææ®µï¼\n\n * æ§è½æµè¯\n * è´è½½æµè¯\n * ååæµè¯\n * ç¨³å®æ§æµè¯\n\nå¯¹äº java åºç¨èè¨ï¼æç®åçï¼å¯ä»¥ä½¿ç¨ jmeter è¿è¡æ§è½æµè¯ã\n\næ§è½æµè¯æ¥åç¤ºä¾ï¼\n\n\n#### æ§è½æµè¯çé®é¢\n\næ§è½æµè¯æ¶ï¼éè¦æ³¨æä¸äºé®é¢ï¼\n\n * ç­èº«é®é¢ - ç³»ç»åå¼å§è¿è¡æ¶ï¼èªèº«å¯è½å è½½ç¼å­ï¼jvm å¯è½ä¼ä¼åç­ç¹ä»£ç ç­ï¼è¿äºè¡ä¸ºé½å¯è½ä½¿å¾ååæè¾å¤§çæ§è½å·®å¼ãæä»¥ï¼æ§è½æµè¯æ¶ï¼åºè¯¥åè·³è¿ä¸æ®µç­èº«æ¶é´ï¼ç­è¶äºç¨³å®åï¼åå¼å§æ§è½æµè¯ã\n * æµè¯ç»æä¸ç¨³å® - æ§è½æµè¯ä¸­ï¼æå¾å¤ä¸ç¨³å®çå ç´ ï¼å¦ç¯å¢ãç½ç»ç­ï¼å ä¹ä¸å¯è½æ¯æ¬¡é½æ¯ä¸æ ·çç»æãæä»¥åºè¯¥å¤æ¬¡æµè¯ï¼æ±å¹³åå¼ã\n * å¤ jvm æåµä¸çå½±å - åºå°½éé¿åä¸å°æºå¨é¨ç½²å¤ä¸ª jvm çæåµãå ä¸ºä»»æä¸ä¸ª jvm é½æ¥ææ´ä¸ªç³»ç»çèµæºä½¿ç¨æï¼æä»¥å¨æ§è½æµè¯æ¶ï¼å¯è½ä¼å½¼æ­¤å¹²æ°ã\n\n\n# æ§è½ä¼åç­ç¥\n\n 1. æ§è½åæ - å¦æè¯·æ±ååºæ¢ï¼å­å¨æ§è½é®é¢ãéè¦å¯¹è¯·æ±ç»åçåä¸ªç¯èéä¸åæï¼ææ¥å¯è½åºç°æ§è½ç¶é¢çå°æ¹ï¼å®ä½é®é¢ãæ£æ¥çæ§æ°æ®ï¼åæå½±åæ§è½çä¸»è¦å ç´ ï¼åå­ãç£çãç½ç»ãcpuï¼å¯è½æ¯ä»£ç ææ¶æè®¾è®¡ä¸åçï¼åæèæ¯ç³»ç»èµæºç¡®å®ä¸è¶³ã\n 2. æ§è½ä¼å - æ§è½ä¼åæ ¹æ®ç½ç«åå±æ¶æï¼å¤§è´å¯åä¸ºåç«¯æ§è½ä¼åãåºç¨æå¡æ§è½ä¼åãå­å¨æå¡æ§è½ä¼åã\n\n\n# åºç¨æå¡æ§è½ä¼å\n\n\n# ç¼å­\n\nç½ç«æ§è½ä¼åç¬¬ä¸å®å¾ï¼ç¬¬ä¸ä¼åèèä½¿ç¨ç¼å­æåæ§è½ã\n\nç¼å­æ¯ç¨äºå­å¨æ°æ®çç¡¬ä»¶æè½¯ä»¶çç»æé¨åï¼ä»¥ä½¿å¾åç»­æ´å¿«è®¿é®ç¸åºçæ°æ®ãç¼å­ä¸­çæ°æ®å¯è½æ¯æåè®¡ç®å¥½çç»æãæ°æ®çå¯æ¬ç­ã\n\n * åç¹åºç¨å¯ä»¥ä½¿ç¨è¿ç¨åç¼å­ï¼å¦ï¼concurrenthashmapãcaffeineï¼ï¼\n * åå¸å¼åºç¨å¯ä»¥ä½¿ç¨åå¸å¼ç¼å­ï¼å¦ï¼redisãmemcachedï¼ï¼æè¿ç¨ç¼å­+åå¸å¼ç¼å­çå¤çº§ç¼å­æ¹æ¡ã\n\n> ç¼å­è§£å³æ¹æ¡è¯·åèï¼ç¼å­åºæ¬åç\n\n\n# å¹¶åæ¨¡å\n\né«å¹¶åéè¦æ ¹æ®ä¸¤ä¸ªæ¡ä»¶ååï¼è¿æ¥æ°éï¼è¯·æ±æ°éã\n\n * æµ·éè¿æ¥ï¼æåä¸ä¸ï¼æµ·éè¯·æ±ï¼ä¾å¦æ¢è´­ï¼ååä¸ç­\n * å¸¸éè¿æ¥ï¼å åä¸ç¾ï¼æµ·éè¯·æ±ï¼ä¾å¦ä¸­é´ä»¶\n * æµ·éè¿æ¥å¸¸éè¯·æ±ï¼ä¾å¦é¨æ·ç½ç«\n * å¸¸éè¿æ¥å¸¸éè¯·æ±ï¼ä¾å¦åé¨è¿è¥ç³»ç»ï¼ç®¡çç³»ç»\n\nåæå¡å¨é«æ§è½çå³é®ä¹ä¸å°±æ¯æå¡å¨éåçå¹¶åæ¨¡å\n\n * æå¡å¨å¦ä½ç®¡çè¿æ¥ã\n * æå¡å¨å¦ä½å¤çè¯·æ±ã\n\nä»¥ä¸ä¸¤ä¸ªè®¾è®¡ç¹æç»é½åæä½ç³»ç»ç i/o æ¨¡ååè¿ç¨æ¨¡åç¸å³ã\n\n * i/o æ¨¡åï¼é»å¡ãéé»å¡ãåæ­¥ãå¼æ­¥ã\n * è¿ç¨æ¨¡åï¼åè¿ç¨ãå¤è¿ç¨ãå¤çº¿ç¨ã\n\n# ppc\n\nppc æ¯ process per connection çç¼©åï¼å¶å«ä¹æ¯ææ¯æ¬¡ææ°çè¿æ¥å°±æ°å»ºä¸ä¸ªè¿ç¨å»ä¸é¨å¤çè¿ä¸ªè¿æ¥çè¯·æ±ï¼è¿æ¯ä¼ ç»ç unix ç½ç»æå¡å¨æéç¨çæ¨¡åãåºæ¬çæµç¨å¾æ¯ï¼\n\n\n\n * ç¶è¿ç¨æ¥åè¿æ¥ï¼å¾ä¸­ acceptï¼ã\n * ç¶è¿ç¨âforkâå­è¿ç¨ï¼å¾ä¸­ forkï¼ã\n * å­è¿ç¨å¤çè¿æ¥çè¯»åè¯·æ±ï¼å¾ä¸­å­è¿ç¨ readãä¸å¡å¤çãwriteï¼ã\n * å­è¿ç¨å³é­è¿æ¥ï¼å¾ä¸­å­è¿ç¨ä¸­ç closeï¼ã\n\nè¿ç§æ¨¡å¼çç¼ºç¹ï¼\n\n * fork ä»£ä»·é«\n * ç¶å­è¿ç¨éä¿¡å¤æ\n * æ¯æçå¹¶åè¿æ¥æ°éæé\n\n# prefork\n\nppc æ¨¡å¼ä¸­ï¼å½è¿æ¥è¿æ¥æ¶æ fork æ°è¿ç¨æ¥å¤çè¿æ¥è¯·æ±ï¼ç±äº fork è¿ç¨ä»£ä»·é«ï¼ç¨æ·è®¿é®æ¶å¯è½æè§æ¯è¾æ¢ï¼prefork æ¨¡å¼çåºç°å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\né¡¾åæä¹ï¼prefork å°±æ¯æååå»ºè¿ç¨ï¼pre-forkï¼ãç³»ç»å¨å¯å¨çæ¶åå°±é¢ååå»ºå¥½è¿ç¨ï¼ç¶åæå¼å§æ¥åç¨æ·çè¯·æ±ï¼å½ææ°çè¿æ¥è¿æ¥çæ¶åï¼å°±å¯ä»¥çå» fork è¿ç¨çæä½ï¼è®©ç¨æ·è®¿é®æ´å¿«ãä½éªæ´å¥½ãprefork çåºæ¬ç¤ºæå¾æ¯ï¼\n\n\n\nprefork çå®ç°å³é®å°±æ¯å¤ä¸ªå­è¿ç¨é½ accept åä¸ä¸ª socketï¼å½ææ°çè¿æ¥è¿å¥æ¶ï¼æä½ç³»ç»ä¿è¯åªæä¸ä¸ªè¿ç¨è½æå accept æåãä½è¿éä¹å­å¨ä¸ä¸ªå°å°çé®é¢ï¼âæç¾¤âç°è±¡ï¼å°±æ¯æè½ç¶åªæä¸ä¸ªå­è¿ç¨è½ accept æåï¼ä½ææé»å¡å¨ accept ä¸çå­è¿ç¨é½ä¼è¢«å¤éï¼è¿æ ·å°±å¯¼è´äºä¸å¿è¦çè¿ç¨è°åº¦åä¸ä¸æåæ¢äºãå¹¸è¿çæ¯ï¼æä½ç³»ç»å¯ä»¥è§£å³è¿ä¸ªé®é¢ï¼ä¾å¦ linux 2.6 çæ¬ååæ ¸å·²ç»è§£å³äº accept æç¾¤é®é¢ã\n\nprefork æ¨¡å¼å ppc ä¸æ ·ï¼è¿æ¯å­å¨ç¶å­è¿ç¨éä¿¡å¤æãæ¯æçå¹¶åè¿æ¥æ°éæéçé®é¢ï¼å æ­¤ç®åå®éåºç¨ä¹ä¸å¤ãapache æå¡å¨æä¾äº mpm prefork æ¨¡å¼ï¼æ¨èå¨éè¦å¯é æ§æèä¸æ§è½¯ä»¶å¼å®¹çç«ç¹æ¶éç¨è¿ç§æ¨¡å¼ï¼é»è®¤æåµä¸æå¤§æ¯æ 256 ä¸ªå¹¶åè¿æ¥ã\n\n# tpc\n\ntpc æ¯ thread per connection çç¼©åï¼å¶å«ä¹æ¯ææ¯æ¬¡ææ°çè¿æ¥å°±æ°å»ºä¸ä¸ªçº¿ç¨å»ä¸é¨å¤çè¿ä¸ªè¿æ¥çè¯·æ±ãä¸è¿ç¨ç¸æ¯ï¼çº¿ç¨æ´è½»éçº§ï¼åå»ºçº¿ç¨çæ¶èæ¯è¿ç¨è¦å°å¾å¤ï¼åæ¶å¤çº¿ç¨æ¯å±äº«è¿ç¨åå­ç©ºé´çï¼çº¿ç¨éä¿¡ç¸æ¯è¿ç¨éä¿¡æ´ç®åãå æ­¤ï¼tpc å®éä¸æ¯è§£å³æèå¼±åäº ppc fork ä»£ä»·é«çé®é¢åç¶å­è¿ç¨éä¿¡å¤æçé®é¢ã\n\ntpc çåºæ¬æµç¨æ¯ï¼\n\n\n\n * ç¶è¿ç¨æ¥åè¿æ¥ï¼å¾ä¸­ acceptï¼ã\n * ç¶è¿ç¨åå»ºå­çº¿ç¨ï¼å¾ä¸­ pthreadï¼ã\n * å­çº¿ç¨å¤çè¿æ¥çè¯»åè¯·æ±ï¼å¾ä¸­å­çº¿ç¨ readãä¸å¡å¤çãwriteï¼ã\n * å­çº¿ç¨å³é­è¿æ¥ï¼å¾ä¸­å­çº¿ç¨ä¸­ç closeï¼ã\n\næ³¨æï¼å ppc ç¸æ¯ï¼ä¸»è¿ç¨ä¸ç¨âcloseâè¿æ¥äºãåå æ¯å¨äºå­çº¿ç¨æ¯å±äº«ä¸»è¿ç¨çè¿ç¨ç©ºé´çï¼è¿æ¥çæä»¶æè¿°ç¬¦å¹¶æ²¡æè¢«å¤å¶ï¼å æ­¤åªéè¦ä¸æ¬¡ close å³å¯ã\n\ntpc è½ç¶è§£å³äº fork ä»£ä»·é«åè¿ç¨éä¿¡å¤æçé®é¢ï¼ä½æ¯ä¹å¼å¥äºæ°çé®é¢ï¼å·ä½è¡¨ç°å¨ï¼\n\n * åå»ºçº¿ç¨è½ç¶æ¯åå»ºè¿ç¨ä»£ä»·ä½ï¼ä½å¹¶ä¸æ¯æ²¡æä»£ä»·ï¼é«å¹¶åæ¶ï¼ä¾å¦æ¯ç§ä¸ä¸è¿æ¥ï¼è¿æ¯ææ§è½é®é¢ã\n * æ é¡»è¿ç¨é´éä¿¡ï¼ä½æ¯çº¿ç¨é´çäºæ¥åå±äº«åå¼å¥äºå¤æåº¦ï¼å¯è½ä¸ä¸å°å¿å°±å¯¼è´äºæ­»éé®é¢ã\n * å¤çº¿ç¨ä¼åºç°äºç¸å½±åçæåµï¼æä¸ªçº¿ç¨åºç°å¼å¸¸æ¶ï¼å¯è½å¯¼è´æ´ä¸ªè¿ç¨éåºï¼ä¾å¦åå­è¶çï¼ã\n\né¤äºå¼å¥äºæ°çé®é¢ï¼tpc è¿æ¯å­å¨ cpu çº¿ç¨è°åº¦ååæ¢ä»£ä»·çé®é¢ãå æ­¤ï¼tpc æ¹æ¡æ¬è´¨ä¸å ppc æ¹æ¡åºæ¬ç±»ä¼¼ï¼å¨å¹¶åå ç¾è¿æ¥çåºæ¯ä¸ï¼åèæ´å¤å°æ¯éç¨ ppc çæ¹æ¡ï¼å ä¸º ppc æ¹æ¡ä¸ä¼ææ­»éçé£é©ï¼ä¹ä¸ä¼å¤è¿ç¨äºç¸å½±åï¼ç¨³å®æ§æ´é«ã\n\n# prethread\n\ntpc æ¨¡å¼ä¸­ï¼å½è¿æ¥è¿æ¥æ¶æåå»ºæ°ççº¿ç¨æ¥å¤çè¿æ¥è¯·æ±ï¼è½ç¶åå»ºçº¿ç¨æ¯åå»ºè¿ç¨è¦æ´å è½»éçº§ï¼ä½è¿æ¯æä¸å®çä»£ä»·ï¼è prethread æ¨¡å¼å°±æ¯ä¸ºäºè§£å³è¿ä¸ªé®é¢ã\n\nå prefork ç±»ä¼¼ï¼prethread æ¨¡å¼ä¼é¢ååå»ºçº¿ç¨ï¼ç¶åæå¼å§æ¥åç¨æ·çè¯·æ±ï¼å½ææ°çè¿æ¥è¿æ¥çæ¶åï¼å°±å¯ä»¥çå»åå»ºçº¿ç¨çæä½ï¼è®©ç¨æ·æè§æ´å¿«ãä½éªæ´å¥½ã\n\nç±äºå¤çº¿ç¨ä¹é´æ°æ®å±äº«åéä¿¡æ¯è¾æ¹ä¾¿ï¼å æ­¤å®éä¸ prethread çå®ç°æ¹å¼ç¸æ¯ prefork è¦çµæ´»ä¸äºï¼å¸¸è§çå®ç°æ¹å¼æä¸é¢å ç§ï¼\n\n * ä¸»è¿ç¨ acceptï¼ç¶åå°è¿æ¥äº¤ç»æä¸ªçº¿ç¨å¤çã\n * å­çº¿ç¨é½å°è¯å» acceptï¼æç»åªæä¸ä¸ªçº¿ç¨ accept æåï¼æ¹æ¡çåºæ¬ç¤ºæå¾å¦ä¸ï¼\n\n\n\napache æå¡å¨ç mpm worker æ¨¡å¼æ¬è´¨ä¸å°±æ¯ä¸ç§ prethread æ¹æ¡ï¼ä½ç¨å¾®åäºæ¹è¿ãapache æå¡å¨ä¼é¦ååå»ºå¤ä¸ªè¿ç¨ï¼æ¯ä¸ªè¿ç¨éé¢ååå»ºå¤ä¸ªçº¿ç¨ï¼è¿æ ·åä¸»è¦æ¯ä¸ºäºèèç¨³å®æ§ï¼å³ï¼å³ä½¿æä¸ªå­è¿ç¨éé¢çæä¸ªçº¿ç¨å¼å¸¸å¯¼è´æ´ä¸ªå­è¿ç¨éåºï¼è¿ä¼æå¶ä»å­è¿ç¨ç»§ç»­æä¾æå¡ï¼ä¸ä¼å¯¼è´æ´ä¸ªæå¡å¨å¨é¨ææã\n\nprethread çè®ºä¸å¯ä»¥æ¯ prefork æ¯ææ´å¤çå¹¶åè¿æ¥ï¼apache æå¡å¨ mpm worker æ¨¡å¼é»è®¤æ¯æ 16 Ã 25 = 400 ä¸ªå¹¶åå¤ççº¿ç¨ã\n\n# reactor\n\ni/o å¤è·¯å¤ç¨ææ¯å½çº³èµ·æ¥æä¸¤ä¸ªå³é®å®ç°ç¹ï¼\n\n * å½å¤æ¡è¿æ¥å±ç¨ä¸ä¸ªé»å¡å¯¹è±¡åï¼è¿ç¨åªéè¦å¨ä¸ä¸ªé»å¡å¯¹è±¡ä¸ç­å¾ï¼èæ é¡»åè½®è¯¢ææè¿æ¥ï¼å¸¸è§çå®ç°æ¹å¼æ selectãepollãkqueue ç­ã\n * å½ææ¡è¿æ¥ææ°çæ°æ®å¯ä»¥å¤çæ¶ï¼æä½ç³»ç»ä¼éç¥è¿ç¨ï¼è¿ç¨ä»é»å¡ç¶æè¿åï¼å¼å§è¿è¡ä¸å¡å¤çã\n\ni/o å¤è·¯å¤ç¨ç»åçº¿ç¨æ± ï¼å®ç¾å°è§£å³äº ppc å tpc çé®é¢\n\nreactor æ¨¡å¼çæ ¸å¿ç»æé¨ååæ¬ reactor åå¤çèµæºæ± ï¼è¿ç¨æ± æçº¿ç¨æ± ï¼ï¼å¶ä¸­ reactor è´è´£çå¬ååéäºä»¶ï¼å¤çèµæºæ± è´è´£å¤çäºä»¶ãåç reactor çå®ç°æ¯æ¯è¾ç®åçï¼ä½å®éä¸ç»åä¸åçä¸å¡åºæ¯ï¼reactor æ¨¡å¼çå·ä½å®ç°æ¹æ¡çµæ´»å¤åï¼ä¸»è¦ä½ç°å¨ï¼\n\n * reactor çæ°éå¯ä»¥ååï¼å¯ä»¥æ¯ä¸ä¸ª reactorï¼ä¹å¯ä»¥æ¯å¤ä¸ª reactorã\n * èµæºæ± çæ°éå¯ä»¥ååï¼ä»¥è¿ç¨ä¸ºä¾ï¼å¯ä»¥æ¯åä¸ªè¿ç¨ï¼ä¹å¯ä»¥æ¯å¤ä¸ªè¿ç¨ï¼çº¿ç¨ç±»ä¼¼ï¼ã\n\næç» reactor æ¨¡å¼æè¿ä¸ç§å¸åçå®ç°æ¹æ¡ï¼\n\n * å reactor åè¿ç¨ / çº¿ç¨ã\n * å reactor å¤çº¿ç¨ã\n * å¤ reactor å¤è¿ç¨ / çº¿ç¨ã\n\n\n# å¼æ­¥æä½\n\nå¼æ­¥å¤çä¸ä»å¯ä»¥åå°ç³»ç»æå¡é´çè¦ååº¦ï¼æé«æ©å±æ§ï¼äºå®ä¸ï¼å®è¿å¯ä»¥æé«ç³»ç»çæ§è½ãå¼æ­¥å¤çå¯ä»¥ææåå°ååºç­å¾æ¶é´ï¼ä»èæé«ååºéåº¦ã\n\nå¼æ­¥å¤çä¸è¬æ¯éè¿åå¸å¼æ¶æ¯éåçæ¹å¼ã\n\nå¼æ­¥å¤çå¯ä»¥è§£å³ä»¥ä¸é®é¢ï¼\n\n * å¼æ­¥ååº\n * åºç¨è§£è¦\n * æµéåé\n * æ¥å¿å¤ç\n * æ¶æ¯éè®¯\n\n\n# è´è½½åè¡¡\n\nå¨é«å¹¶ååºæ¯ä¸ï¼ä½¿ç¨è´è½½åè¡¡ææ¯ä¸ºä¸ä¸ªåºç¨æå»ºä¸ä¸ªç±å¤å°æå¡å¨ç»æçæå¡å¨éç¾¤ï¼å°å¹¶åè®¿é®è¯·æ±ååå°å¤å°æå¡å¨ä¸å¤çï¼é¿ååä¸æå¡å¨å è´è½½ååè¿å¤§èååºç¼æ¢ï¼ä½¿ç¨æ·è¯·æ±å·ææ´å¥½çååºå»¶è¿ç¹æ§ã\n\né«æ§è½éç¾¤çå¤ææ§ä¸»è¦ä½ç°å¨éè¦å¢å ä¸ä¸ªä»»å¡åéå¨ï¼ä»¥åä¸ºä»»å¡éæ©ä¸ä¸ªåéçä»»å¡åéç®æ³ã\n\n> ç¼å­è§£å³æ¹æ¡è¯·åèï¼è´è½½åè¡¡\n\n\n# ä»£ç ä¼å\n\n# å¤çº¿ç¨\n\nä»èµæºå©ç¨çè§åº¦çï¼ä½¿ç¨å¤çº¿ç¨çåå ä¸»è¦æä¸¤ä¸ªï¼io é»å¡åå¤ cpuã\n\nçº¿ç¨æ°å¹¶éè¶å¤è¶å¥½ï¼é£ä¹å¯å¨å¤å°çº¿ç¨åéå¢ï¼\n\næä¸ªåèå¬å¼ï¼\n\nå¯å¨çº¿ç¨æ° = (ä»»å¡æ§è¡æ¶é´ / (ä»»å¡æ§è¡æ¶é´ - io ç­å¾æ¶é´)) * cpu åæ ¸æ°\n\n\næä½³å¯å¨çº¿ç¨æ°å cpu åæ ¸æ°ææ­£æ¯ï¼å io é»å¡æ¶é´æåæ¯ã\n\n * å¦æä»»å¡é½æ¯ cpu è®¡ç®åä»»å¡ï¼é£ä¹çº¿ç¨æ°æå¤ä¸è¦è¶è¿ cpu åæ ¸æ°ï¼å ä¸ºå¯å¨åå¤çº¿ç¨ï¼cpu ä¹æ¥ä¸åè°åº¦ï¼\n * ç¸åï¼å¦ææ¯ä»»å¡éè¦ç­å¾ç£çæä½ï¼ç½ç»ååºï¼é£ä¹å¤å¯å¨çº¿ç¨æå©äºä»»å¡å¹¶ç½èµï¼æé«ç³»ç»ååéã\n\n# çº¿ç¨å®å¨é®é¢\n\nçº¿ç¨å®å¨é®é¢æ¶æå¤ä¸ªçº¿ç¨å¹¶åè®¿é®æä¸ªèµæºï¼å¯¼è´æ°æ®æ··ä¹±ã\n\nè§£å³ææ®µæï¼\n\n * å°å¯¹è±¡è®¾è®¡ä¸ºæ ç¶æå¯¹è±¡ - å¸ååºç¨ï¼servlet å°±æ¯æ ç¶æå¯¹è±¡ï¼å¯ä»¥è¢«æå¡å¨å¤çº¿ç¨å¹¶åè°ç¨å¤çç¨æ·è¯·æ±ã\n * ä½¿ç¨å±é¨å¯¹è±¡\n * å¹¶åè®¿é®èµæºæ¶ä½¿ç¨é - ä½æ¯å¼å¥éä¼äº§çæ§è½å¼éï¼åºå°½éä½¿ç¨è½»éçº§çéã\n\n# èµæºå¤ç¨\n\nåºè¯¥å°½éåå°é£äºå¼éå¾å¤§çç³»ç»èµæºçåå»ºåéæ¯ï¼å¦æ°æ®åºè¿æ¥ãç½ç»éä¿¡è¿æ¥ãçº¿ç¨ãå¤æå¯¹è±¡ç­ãä»ç¼ç¨è§åº¦ï¼èµæºå¤ç¨ä¸»è¦æä¸¤ç§æ¨¡å¼ï¼åä¾æ¨¡å¼åå¯¹è±¡æ± ã\n\n# æ°æ®ç»æ\n\næ ¹æ®å·ä½åºæ¯ï¼éæ©åéçæ°æ®ç»æã\n\n# åå¾åæ¶\n\nå¦æ web åºç¨è¿è¡å¨ jvm ç­å·æåå¾åæ¶åè½çç¯å¢ä¸­ï¼é£ä¹åå¾åæ¶å¯è½ä¼å¯¹ç³»ç»çæ§è½ç¹æ§äº§çå·¨å¤§å½±åãç«å³åå¾åæ¶æºå¶æå©äºç¨åºä¼åååæ°è°ä¼ï¼ä»¥åç¼ååå­å®å¨çä»£ç ã\n\n\n# å­å¨æ§è½ä¼å\n\n\n# æ°æ®åº\n\n# æ°æ®åºè¯»ååç¦»\n\nè¯»ååç¦»çåºæ¬åçæ¯å°æ°æ®åºè¯»åæä½åæ£å°ä¸åçèç¹ä¸\n\n> è¯¦ç»è§£å³æ¹æ¡åèï¼åå¸å¼å­å¨\n\n# æ°æ®åºååºåè¡¨\n\næ°æ®åçææç§æä¸ªç»´åº¦å°å­æ¾å¨åä¸æ°æ®åºä¸­çæ°æ®åæ£å°å­æ¾è³å¤ä¸ªæ°æ®åºæè¡¨ä¸­ä»¥è¾¾å°æåæ§è½ç¶é¢ä»¥åå¯ç¨æ§çææã\n\n> è¯¦ç»è§£å³æ¹æ¡åèï¼åå¸å¼å­å¨\n\n# nosql\n\nå³ç³»åæ°æ®åºçä¼å¿å¨äºï¼å­å¨ç»æåæ°æ®ï¼æå©äºè¿è¡åç§å¤ææ¥è¯¢ã\n\nä½æ¯ï¼å®ä¹å­å¨ä¸äºç¼ºç¹ï¼\n\n * å³ç³»æ°æ®åºå­å¨çæ¯è¡è®°å½ï¼æ æ³å­å¨æ°æ®ç»æ\n * å³ç³»æ°æ®åºç schema æ©å±å¾ä¸æ¹ä¾¿\n * å³ç³»æ°æ®åºå¨å¤§æ°æ®åºæ¯ä¸ i/o è¾é«\n * å³ç³»æ°æ®åºçå¨ææç´¢åè½æ¯è¾å¼±\n\nä¸ºäºè§£å³ä¸è¿°é®é¢ï¼åå«è¯çäºè§£å³ä¸åé®é¢ç nosql æ°æ®åºã\n\nå¸¸è§ç nosql æ°æ®åºå¯ä»¥åä¸ºåç±»ï¼\n\n * k-v æ°æ®åºï¼kv å­å¨éå¸¸éåå­å¨ä¸æ¶åè¿å¤æ°æ®å³ç³»ä¸å¡å³ç³»çæ°æ®ï¼åæ¶è½ææåå°è¯»åç£ççæ¬¡æ°ï¼æ¯ sql æ°æ®åºå­å¨æ¥ææ´å¥½çè¯»åæ§è½ï¼è½å¤è§£å³å³ç³»åæ°æ®åºæ æ³å­å¨æ°æ®ç»æçé®é¢ãä»¥ redis ä¸ºä»£è¡¨ã\n * åå¼æ°æ®åºï¼éåäºæ¹éæ°æ®å¤çåå³æ¶æ¥è¯¢ï¼è§£å³å³ç³»æ°æ®åºå¤§æ°æ®åºæ¯ä¸ç i/o é®é¢ãä»¥ hbase ä¸ºä»£è¡¨ã\n * ææ¡£æ°æ®åºï¼ææ¡£æ°æ®åºï¼ä¹ç§°ä¸ºææ¡£åæ°æ®åºï¼æ¯æ¨å¨å°åç»æåæ°æ®å­å¨ä¸ºææ¡£çä¸ç§æ°æ®åºï¼å®å¯ä»¥è§£å³å³ç³»åæ°æ®åºè¡¨ç»æ schema æ©å±ä¸æ¹ä¾¿çé®é¢ãææ¡£æ°æ®åºéå¸¸ä»¥ json æ xml æ ¼å¼å­å¨æ°æ®ãä»¥ mongodb ä¸ºä»£è¡¨ã\n * å¨ææç´¢å¼æï¼è§£å³å³ç³»åæ°æ®åºå¨ææç´¢åè½è¾å¼±çé®é¢ãä»¥ elasticsearch ä¸ºä»£è¡¨ã\n\n> è¯¦æåèï¼nosql ææ¯éå\n\n\n# æä»¶å­å¨\n\n# æºæ¢°é®çååºæç¡¬ç\n\nèèä½¿ç¨åºæç¡¬çæ¿ä»£æºæ¢°é®çï¼å ä¸ºå®çè¯»åéåº¦æ´å¿«ã\n\n# b+æ°å lsm æ \n\nä¼ ç»å³ç³»æ°æ®åºçæ°æ®åºç´¢å¼ä¸è¬é½ä½¿ç¨ä¸¤çº§ç´¢å¼ç b+ æ  ç»æï¼æ çå±æ¬¡æå¤ä¸å±ãå æ­¤å¯è½éè¦ 5 æ¬¡ç£çè®¿é®æè½æ´æ°ä¸æ¡è®°å½ï¼ä¸æ¬¡ç£çè®¿é®è·å¾æ°æ®ç´¢å¼åè¡ idï¼ç¶ååè¿è¡ä¸æ¬¡æ°æ®æä»¶è¯»æä½åä¸æ¬¡æ°æ®æä»¶åæä½ï¼ã\n\nç±äºç£çè®¿é®æ¯éæºçï¼ä¼ ç»æºæ¢°é®çå¨æ°æ®éæºè®¿é®æ¶æ§è½è¾å·®ï¼æ¯æ¬¡æ°æ®è®¿é®é½éè¦å¤æ¬¡è®¿é®ç£çå½±åæ°æ®è®¿é®æ§è½ã\n\nè®¸å¤ nosql æ°æ®åºä¸­çç´¢å¼éç¨ lsm æ  ä½ä¸ºä¸»è¦æ°æ®ç»æãlsm æ å¯è§ä¸ºä¸ä¸ª n é¶åå¹¶æ ãæ°æ®åæä½é½å¨åå­ä¸­è¿è¡ãå¨ lsm æ ä¸è¿è¡ä¸æ¬¡æ°æ®æ´æ°ä¸éè¦ç£çè®¿é®ï¼éåº¦è¿å¿«äº b+ æ ã\n\n# raid å hdfs\n\nraid æ¯ redundant array of independent disks çç¼©åï¼ä¸­æç®ç§°ä¸ºç¬ç«åä½ç£çéµåã\n\nraid æ¯ä¸ç§æå¤åç¬ç«çç¡¬çï¼ç©çç¡¬çï¼æä¸åçæ¹å¼ç»åèµ·æ¥å½¢æä¸ä¸ªç¡¬çç»ï¼é»è¾ç¡¬çï¼ï¼ä»èæä¾æ¯åä¸ªç¡¬çæ´é«çå­å¨æ§è½åæä¾æ°æ®å¤ä»½ææ¯ã\n\nhdfs(åå¸å¼æä»¶ç³»ç») æ´è¢«å¤§åç½ç«æéçãå®å¯ä»¥éå mapreduce å¹¶åè®¡ç®ä»»å¡æ¡æ¶è¿è¡å¤§æ°æ®å¤çï¼å¯ä»¥å¨æ´ä¸ªéç¾¤ä¸å¹¶åè®¿é®ææç£çï¼æ é raid æ¯æã\n\nhdfs å¯¹æ°æ®å­å¨ç©ºé´çç®¡çä»¥æ°æ®åï¼blockï¼ä¸ºåä½ï¼é»è®¤ä¸º 64 mbãæä»¥ï¼hdfs æ´éåå­å¨è¾å¤§çæä»¶ã\n\n\n# åç«¯æ§è½ä¼å\n\n\n# æµè§å¨è®¿é®ä¼å\n\n 1. åå° http è¯·æ± - http è¯·æ±éè¦å»ºç«éä¿¡é¾è·¯ï¼è¿è¡æ°æ®ä¼ è¾ï¼å¼éé«æï¼æä»¥åå° http è¯·æ±æ°å¯ä»¥æææé«è®¿é®æ§è½ãåå° http çä¸»è¦ææ®µæ¯åå¹¶ cssãjavascriptãå¾çã\n 2. ä½¿ç¨æµè§å¨ç¼å­ - å ä¸ºéæèµæºæä»¶æ´æ°é¢çä½ï¼å¯ä»¥ç¼å­æµè§å¨ä¸­ä»¥æé«æ§è½ãè®¾ç½® http å¤´ä¸­ç cache-control å expires å±æ§ï¼å¯è®¾å®æµè§å¨ç¼å­ã\n 3. å¯ç¨åç¼© - å¨æå¡å¨ç«¯åç¼©éæèµæºæä»¶ï¼å¨æµè§å¨ç«¯è§£åç¼©ï¼å¯ä»¥ææåå°ä¼ è¾çæ°æ®éãç±äºææ¬æä»¶åç¼©çå¯è¾¾ 80% ä»¥ä¸ï¼æä»¥å¯ä»¥å¯¹éæèµæºï¼å¦ htmlãcssãjavascrip è¿è¡åç¼©ã\n 4. css æ¾å¨é¡µé¢æä¸é¢ï¼javascript æ¾å¨é¡µé¢æä¸é¢ - æµè§å¨ä¼å¨ä¸è½½å®å¨é¨ç css åæå¯¹æ´ä¸ªé¡µé¢è¿è¡æ¸²æï¼æä»¥æå¥½çåæ³æ¯å° css æ¾å¨é¡µé¢æä¸é¢ï¼è®©æµè§å¨å°½å¿«ä¸è½½ cssï¼javascript åç¸åï¼æµè§å¨å è½½ javascript åç«å³æ§è¡ï¼å¯è½ä¼é»å¡æ´ä¸ªé¡µé¢ï¼é æé¡µé¢æ¾ç¤ºç¼æ¢ï¼å æ­¤ javascript æå¥½æ¾å¨é¡µé¢æä¸é¢ã\n 5. åå° cookie ä¼ è¾ - cookie åå«å¨ http æ¯æ¬¡çè¯·æ±åååºä¸­ï¼å¤ªå¤§ç cookie ä¼ä¸¥éå½±åæ°æ®ä¼ è¾ã\n\n\n# cdn\n\ncdn ä¸è¬ç¼å­çæ¯éæèµæºã\n\ncdn çæ¬è´¨ä»ç¶æ¯ä¸ä¸ªç¼å­ï¼èä¸å°æ°æ®ç¼å­å¨ç¦»ç¨æ·æè¿çå°æ¹ï¼ä½¿ç¨æ·å·²æå¿«éåº¦è·åæ°æ®ï¼å³æè°ç½ç»è®¿é®ç¬¬ä¸è·³ã\n\n\n\n\n# ååä»£ç\n\nä¼ ç»ä»£çæå¡å¨ä½äºæµè§å¨ä¸ä¾§ï¼ä»£çæµè§å¨å° http è¯·æ±åéå°äºèç½ä¸ï¼èååä»£çæå¡å¨ä½äºç½ç«æºæ¿ä¸ä¾§ï¼ä»£çç½ç«æå¡å¨æ¥æ¶ http è¯·æ±ã\n\n\n\nååä»£çæå¡å¨å¯ä»¥éç½®ç¼å­åè½å é web è¯·æ±ï¼å½ç¨æ·ç¬¬ä¸æ¬¡è®¿é®éæåå®¹æ¶ï¼éæåå®¹å°±ä¼è¢«ç¼å­å¨ååä»£çæå¡å¨ä¸ã\n\nååä»£çè¿å¯ä»¥å®ç°è´è½½åè¡¡ï¼éè¿è´è½½åè¡¡æå»ºçéç¾¤å¯ä»¥æé«ç³»ç»æ»ä½å¤çè½åã\n\nå ä¸ºææè¯·æ±é½å¿é¡»åç»è¿ååä»£çæå¡å¨ï¼æä»¥å¯ä»¥å±è½ä¸äºæ»å» ipï¼è¾¾å°ä¿æ¤ç½ç«å®å¨çä½ç¨ã\n\n\n# åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * java æ§è½è°ä¼å®æ",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»é«å¯ç¨æ¶æ",frontmatter:{title:"ç³»ç»é«å¯ç¨æ¶æ",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","é«å¯ç¨"],permalink:"/pages/ad5762/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/04.%E7%B3%BB%E7%BB%9F%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/04.ç³»ç»é«å¯ç¨æ¶æ.md",key:"v-932f2d58",path:"/pages/ad5762/",headers:[{level:2,title:"1. é«å¯ç¨æ¶æç®ä»",slug:"_1-é«å¯ç¨æ¶æç®ä»",normalizedTitle:"1. é«å¯ç¨æ¶æç®ä»",charIndex:14},{level:3,title:"1.1. ç³»ç»å¯ç¨æ§çåº¦é",slug:"_1-1-ç³»ç»å¯ç¨æ§çåº¦é",normalizedTitle:"1.1. ç³»ç»å¯ç¨æ§çåº¦é",charIndex:29},{level:3,title:"1.2. æéåå ",slug:"_1-2-æéåå ",normalizedTitle:"1.2. æéåå ",charIndex:529},{level:3,title:"1.3. ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ",slug:"_1-3-ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ",normalizedTitle:"1.3. ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ",charIndex:1016},{level:2,title:"2. é«å¯ç¨æ¶æçè®º",slug:"_2-é«å¯ç¨æ¶æçè®º",normalizedTitle:"2. é«å¯ç¨æ¶æçè®º",charIndex:1506},{level:2,title:"3. æ¶ææ¨¡å¼",slug:"_3-æ¶ææ¨¡å¼",normalizedTitle:"3. æ¶ææ¨¡å¼",charIndex:2050},{level:3,title:"3.1. ä¸»å¤å¤å¶",slug:"_3-1-ä¸»å¤å¤å¶",normalizedTitle:"3.1. ä¸»å¤å¤å¶",charIndex:2062},{level:3,title:"3.2. ä¸»ä»å¤å¶",slug:"_3-2-ä¸»ä»å¤å¶",normalizedTitle:"3.2. ä¸»ä»å¤å¶",charIndex:2518},{level:3,title:"3.3. éç¾¤+ååº",slug:"_3-3-éç¾¤-ååº",normalizedTitle:"3.3. éç¾¤+ååº",charIndex:2957},{level:2,title:"4. é«å¯ç¨çåºç¨",slug:"_4-é«å¯ç¨çåºç¨",normalizedTitle:"4. é«å¯ç¨çåºç¨",charIndex:3128},{level:3,title:"4.1. è´è½½åè¡¡",slug:"_4-1-è´è½½åè¡¡",normalizedTitle:"4.1. è´è½½åè¡¡",charIndex:3342},{level:3,title:"4.2. åå¸å¼ Session",slug:"_4-2-åå¸å¼-session",normalizedTitle:"4.2. åå¸å¼ session",charIndex:3589},{level:2,title:"5. é«å¯ç¨çæå¡",slug:"_5-é«å¯ç¨çæå¡",normalizedTitle:"5. é«å¯ç¨çæå¡",charIndex:3902},{level:3,title:"5.1. åçº§ç®¡ç",slug:"_5-1-åçº§ç®¡ç",normalizedTitle:"5.1. åçº§ç®¡ç",charIndex:4107},{level:3,title:"5.2. è¶æ¶éè¯",slug:"_5-2-è¶æ¶éè¯",normalizedTitle:"5.2. è¶æ¶éè¯",charIndex:4274},{level:3,title:"5.3. å¼æ­¥è°ç¨",slug:"_5-3-å¼æ­¥è°ç¨",normalizedTitle:"5.3. å¼æ­¥è°ç¨",charIndex:4384},{level:3,title:"5.4. è¿è½½ä¿æ¤",slug:"_5-4-è¿è½½ä¿æ¤",normalizedTitle:"5.4. è¿è½½ä¿æ¤",charIndex:4546},{level:4,title:"éæµ",slug:"éæµ",normalizedTitle:"éæµ",charIndex:1459},{level:5,title:"åºäºè¯·æ±éæµ",slug:"åºäºè¯·æ±éæµ",normalizedTitle:"åºäºè¯·æ±éæµ",charIndex:4685},{level:5,title:"åºäºèµæºéæµ",slug:"åºäºèµæºéæµ",normalizedTitle:"åºäºèµæºéæµ",charIndex:4692},{level:4,title:"éçº§",slug:"éçº§",normalizedTitle:"éçº§",charIndex:4083},{level:4,title:"çæ­",slug:"çæ­",normalizedTitle:"çæ­",charIndex:4575},{level:3,title:"5.5. å¹ç­æ§è®¾è®¡",slug:"_5-5-å¹ç­æ§è®¾è®¡",normalizedTitle:"5.5. å¹ç­æ§è®¾è®¡",charIndex:5588},{level:2,title:"6. é«å¯ç¨çå­å¨",slug:"_6-é«å¯ç¨çå­å¨",normalizedTitle:"6. é«å¯ç¨çå­å¨",charIndex:5901},{level:3,title:"6.1. æ°æ®å¤ä»½",slug:"_6-1-æ°æ®å¤ä»½",normalizedTitle:"6.1. æ°æ®å¤ä»½",charIndex:6062},{level:3,title:"6.2. å¤±æè½¬ç§»",slug:"_6-2-å¤±æè½¬ç§»",normalizedTitle:"6.2. å¤±æè½¬ç§»",charIndex:6370},{level:4,title:"å¤±æç¡®è®¤",slug:"å¤±æç¡®è®¤",normalizedTitle:"å¤±æç¡®è®¤",charIndex:6426},{level:4,title:"è®¿é®è½¬ç§»",slug:"è®¿é®è½¬ç§»",normalizedTitle:"è®¿é®è½¬ç§»",charIndex:6559},{level:4,title:"æ°æ®æ¢å¤",slug:"æ°æ®æ¢å¤",normalizedTitle:"æ°æ®æ¢å¤",charIndex:6672},{level:2,title:"7. è¾å©ææ®µ",slug:"_7-è¾å©ææ®µ",normalizedTitle:"7. è¾å©ææ®µ",charIndex:6792},{level:3,title:"7.1. å¼å°å¤æ´»",slug:"_7-1-å¼å°å¤æ´»",normalizedTitle:"7.1. å¼å°å¤æ´»",charIndex:6804},{level:3,title:"7.2. åå¸æµç¨",slug:"_7-2-åå¸æµç¨",normalizedTitle:"7.2. åå¸æµç¨",charIndex:7348},{level:3,title:"7.3. ç³»ç»çæ§",slug:"_7-3-ç³»ç»çæ§",normalizedTitle:"7.3. ç³»ç»çæ§",charIndex:7422},{level:2,title:"8. åèèµæ",slug:"_8-åèèµæ",normalizedTitle:"8. åèèµæ",charIndex:8091}],headersStr:"1. é«å¯ç¨æ¶æç®ä» 1.1. ç³»ç»å¯ç¨æ§çåº¦é 1.2. æéåå  1.3. ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ 2. é«å¯ç¨æ¶æçè®º 3. æ¶ææ¨¡å¼ 3.1. ä¸»å¤å¤å¶ 3.2. ä¸»ä»å¤å¶ 3.3. éç¾¤+ååº 4. é«å¯ç¨çåºç¨ 4.1. è´è½½åè¡¡ 4.2. åå¸å¼ Session 5. é«å¯ç¨çæå¡ 5.1. åçº§ç®¡ç 5.2. è¶æ¶éè¯ 5.3. å¼æ­¥è°ç¨ 5.4. è¿è½½ä¿æ¤ éæµ åºäºè¯·æ±éæµ åºäºèµæºéæµ éçº§ çæ­ 5.5. å¹ç­æ§è®¾è®¡ 6. é«å¯ç¨çå­å¨ 6.1. æ°æ®å¤ä»½ 6.2. å¤±æè½¬ç§» å¤±æç¡®è®¤ è®¿é®è½¬ç§» æ°æ®æ¢å¤ 7. è¾å©ææ®µ 7.1. å¼å°å¤æ´» 7.2. åå¸æµç¨ 7.3. ç³»ç»çæ§ 8. åèèµæ",content:"# ç³»ç»é«å¯ç¨æ¶æ\n\n\n# 1. é«å¯ç¨æ¶æç®ä»\n\n\n# 1.1. ç³»ç»å¯ç¨æ§çåº¦é\n\nç³»ç»ä¸å¯ç¨ä¹è¢«ç§°ä½ç³»ç»æéï¼ä¸çéå¸¸ç¨å¤ä¸ª 9 æ¥è¡¡éç³»ç»çå¯ç¨æ§ãå¦ QQ çå¯ç¨æ§ä¸º 4 ä¸ª 9ï¼å³ 99.99% å¯ç¨ã\n\nç½ç«ä¸å¯ç¨æ¶é´ = æéä¿®å¤æ¶é´ç¹ - æéåç°æ¶é´ç¹\nç½ç«å¹´åº¦å¯ç¨æ§ææ  = (1 - ç½ç«ä¸å¯ç¨æ¶é´/å¹´åº¦æ»æ¶é´) * 100%\n\n\nå¯ç¨æ§è®¡éè¡¨ï¼\n\nå¯ç¨æ§çº§å«   ç³»ç»å¯ç¨æ§%    å®æºæ¶é´/å¹´     å®æºæ¶é´/æ    å®æºæ¶é´/å¨    å®æºæ¶é´/å¤©\nä¸å¯ç¨     90%       36.5 å¤©     73 å°æ¶     16.8 å°æ¶   144 åé\nåºæ¬å¯ç¨    99%       87.6 å°æ¶    7.3 å°æ¶    1.68 å°æ¶   14.4 åé\nè¾é«å¯ç¨    99.9%     8.76 å°æ¶    43.8 åé   10.1 åé   1.44 åé\né«å¯ç¨     99.99%    52.56 åé   4.38 åé   1.01 ç§    8.64 ç§\næé«å¯ç¨    99.999%   5.26 åé    26.28 ç§   6.06 ç§    0.86 ç§\n\n\n# 1.2. æéåå \n\nç³»ç»å®æºåå ä¸»è¦æä»¥ä¸ï¼\n\næ è®¡åç\n\n * ç³»ç»çº§æéï¼åæ¬ä¸»æºãæä½ç³»ç»ãä¸­é´ä»¶ãæ°æ®åºãç½ç»ãçµæºä»¥åå¤å´è®¾å¤ã\n * æ°æ®åä¸­ä»çæéï¼åæ¬äººåè¯¯æä½ãç¡¬çæéãæ°æ®ä¹±äºã\n * è¿æèªç¶ç¾å®³ãäººä¸ºç ´åï¼ä»¥åä¾çµé®é¢ç­ã\n\næè®¡åç\n\n * æ¥å¸¸ä»»å¡ï¼å¤ä»½ï¼å®¹éè§åï¼ç¨æ·åå®å¨ç®¡çï¼åå°æ¹å¤çåºç¨ã\n * è¿ç»´ç¸å³ï¼æ°æ®åºç»´æ¤ãåºç¨ç»´æ¤ãä¸­é´ä»¶ç»´æ¤ãæä½ç³»ç»ç»´æ¤ãç½ç»ç»´æ¤ã\n * åçº§ç¸å³ï¼æ°æ®åºãåºç¨ãä¸­é´ä»¶ãæä½ç³»ç»ãç½ç»ï¼åæ¬ç¡¬ä»¶åçº§ã\n\næä»¬åç»å®ä»¬å½ä¸ªç±»ã\n\n 1. ç½ç»é®é¢ãç½ç»é¾æ¥åºç°é®é¢ï¼ç½ç»å¸¦å®½åºç°æ¥å¡â¦â¦\n 2. æ§è½é®é¢ãæ°æ®åºæ¢ SQLãJava Full GCãç¡¬ç IO è¿å¤§ãCPU é£é«ãåå­ä¸è¶³â¦â¦\n 3. å®å¨é®é¢ãè¢«ç½ç»æ»å»ï¼å¦ DDoS ç­ã\n 4. è¿ç»´é®é¢ãç³»ç»æ»æ¯å¨è¢«æ´æ°åä¿®æ¹ï¼æ¶æä¹å¨ä¸æ­å°è¢«è°æ´ï¼çæ§é®é¢â¦â¦\n 5. ç®¡çé®é¢ãæ²¡ææ¢³çåºå³é®æå¡ä»¥åæå¡çä¾èµå³ç³»ï¼è¿è¡ä¿¡æ¯æ²¡æåæ§å¶ç³»ç»åæ­¥â¦â¦\n 6. ç¡¬ä»¶é®é¢ãç¡¬çæåãç½å¡åºé®é¢ãäº¤æ¢æºåºé®é¢ãæºæ¿æçµãæææºé®é¢â¦â¦\n\n\n# 1.3. ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ\n\néå¸¸ï¼ä¼ä¸çº§åºç¨ç³»ç»ä¸ºæé«ç³»ç»å¯ç¨æ§ï¼ä¼éç¨è¾æè´µçè½¯ç¡¬ä»¶è®¾å¤ï¼å½ç¶è¿æ ·çè®¾å¤ä¹æ¯è¾ç¨³å®ã\n\näºèç½å¬å¸æä¸äºåååå¬å¸åºäºææ¬èèï¼æ´å¤éç¨ PC çº§è½¯ç¡¬ä»¶è®¾å¤ï¼èçº¦ææ¬æä»åºçä»£ä»·å°±æ¯è®¾å¤è¾ä¸ºä¸ç¨³å®ãæå¡å¨ä¸å¹´ä¸­åºç°å æ¬¡å®æºï¼é«å¼ºåº¦è¯»åç£çå¯¼è´ç£çæåç­äºä»¶å®å±æ­£å¸¸ã\n\nç»¼ä¸ï¼ç¡¬ä»¶åºç°æéåºè§ä¸ºå¿ç¶çï¼èé«å¯ç¨çç³»ç»æ¶æè®¾è®¡ç®æ å°±æ¯è¦ä¿è¯å½åºç°ç¡¬ä»¶æéæ¶ï¼æå¡ä¾ç¶å¯ç¨ï¼æ°æ®ä¾ç¶è½å¤ä¿å­å¹¶è¢«è®¿é®ãå®ç°é«å¯ç¨çç³»ç»æ¶æçä¸»è¦ææ®µæ¯æ°æ®åæå¡çåä½å¤ä»½åå¤±æè½¬ç§»ï¼ä¸æ¦æäºæå¡å¨å®æºï¼å°±å°æå¡åæ¢å°å¶ä»å¯ç¨çæå¡å¨ä¸ï¼å¦æç£çæåï¼åä»å¤ä»½çç£çè¯»åæ°æ®ã\n\nå¤§åç³»ç»çåå±æ¶æåç©çæå¡å¨çåå¸å¼é¨ç½²ä½¿å¾ä½äºä¸åå±æ¬¡çæå¡å¨å·æä¸åçå¯ç¨æ§ç¹ç¹ãå³é­æå¡ææå¡å¨å®æºæ¶äº§ççå½±åä¹ä¸ç¸åï¼é«å¯ç¨çè§£å³æ¹æ¡ä¹å·®å¼çå¤§ãå¤§è´å¯ä»¥åä¸ºï¼\n\n * é«å¯ç¨çåºç¨ - ä¸»è¦ææ®µæ¯ï¼è´è½½åè¡¡\n * é«å¯ç¨çæå¡ - ä¸»è¦ææ®µæ¯ï¼åçº§ç®¡çãè¶æ¶éè¯ãå¼æ­¥è°ç¨ãéæµãéè§£ãæ­è·¯ãå¹ç­æ§è®¾è®¡\n * é«å¯ç¨çæ°æ® - ä¸»è¦ææ®µæ¯ï¼æ°æ®å¤ä»½åå¤±æè½¬ç§»\n\n\n# 2. é«å¯ç¨æ¶æçè®º\n\nå­¦ä¹ é«å¯ç¨æ¶æï¼é¦åéè¦äºè§£åå¸å¼åºç¡çè®ºï¼CAP å BASEã\n\nç¶åï¼å¾å¤èåçåå¸å¼ç³»ç»ï¼é½å©ç¨éä¸¾æºå¶ï¼æ¥ä¿è¯ä¸»èç¹å®æºæ¶çæéæ¢å¤ãå¦æè¦æ·±å¥çè§£éä¸¾æºå¶ï¼æå¿è¦äºè§£ï¼Paxos ç®æ³ å Raft ç®æ³ãPaxos å Raft æ¯ä¸ºäºå®ç°åå¸å¼ç³»ç»ä¸­é«å¯ç¨æ¶æèæåºçå±è¯æ§ç®æ³ï¼å·²ç»æä¸ºä¸çæ åã\n\nCAP å®çåç§°ä¸º CAP ååï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ ä¸è´æ§ï¼Cï¼Consistencyï¼ãå¯ç¨æ§ï¼Aï¼Availabilityï¼ å ååºå®¹å¿æ§ï¼Pï¼Partition Toleranceï¼ï¼æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\nBASE æ¯ åºæ¬å¯ç¨ï¼Basically Availableï¼ãè½¯ç¶æï¼Soft Stateï¼ å æç»ä¸è´æ§ï¼Eventually Consistentï¼ ä¸ä¸ªç­è¯­çç¼©åãBASE çè®ºæ¯å¯¹ CAP ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æï¼å®ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n> CAP å BASE çè®ºçè¯¦ç»è¯´æè¯·åèï¼åå¸å¼çè®º\n> \n> Paxos å Raft çè¯¦ç»è¯´æè¯·åèï¼Paxos ç®æ³ å Raft ç®æ³\n\n\n# 3. æ¶ææ¨¡å¼\n\n\n# 3.1. ä¸»å¤å¤å¶\n\nä¸»å¤å¤å¶æ¯æå¸¸è§ä¹æ¯æç®åçä¸ç§å­å¨é«å¯ç¨æ¹æ¡ï¼å ä¹ææçå­å¨ç³»ç»é½æä¾äºä¸»å¤å¤å¶çåè½ï¼ä¾å¦ MySQLãRedisãMongoDB ç­ã\n\nä¸»å¤å¤å¶è¦ç¹ï¼\n\n * å­å¨ä¸ä¸»å¤å¤ã\n * ä¸»æºè´è´£è¯»&åï¼å¹¶å®æå¤å¶æ°æ®ç»å¤æºã\n * ä¸æ¦ä¸»æºå®æºï¼å¯ä»¥éè¿äººå·¥ææ®µï¼å°å¶ä¸­ä¸ä¸ªå¤èç¹ä½ä¸ºä¸»èç¹ã\n\n\n\nä¼ç¹\n\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼å®¢æ·ç«¯å¯ä»¥ä¸æç¥å¤æºçå­å¨ãå³ä½¿ç¾é¾æ¢å¤åï¼åæ¥çå¤æºè¢«äººå·¥ä¿®æ¹ä¸ºä¸»æºåï¼å¯¹äºå®¢æ·ç«¯æ¥è¯´ï¼åªæ¯è®¤ä¸ºä¸»æºçå°åæ¢äºèå·²ï¼æ é¡»ç¥éæ¯åæ¥çå¤æºåçº§ä¸ºä¸»æºã\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼ä¸»æºåå¤æºä¹é´ï¼åªéè¦è¿è¡æ°æ®å¤å¶å³å¯ï¼æ é¡»è¿è¡ç¶æå¤æ­åä¸»å¤åæ¢è¿ç±»å¤æçæä½ã\n\nç¼ºç¹\n\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼æéåéè¦äººå·¥å¹²é¢ï¼æ æ³èªå¨æ¢å¤ã\n\néç¨åºæ¯\n\nç»¼åä¸»å¤å¤å¶æ¶æçä¼ç¼ºç¹ï¼åé¨çåå°ç®¡çç³»ç»ä½¿ç¨ä¸»å¤å¤å¶æ¶æçæåµä¼æ¯è¾å¤ï¼ä¾å¦å­¦çç®¡çç³»ç»ãåå·¥ç®¡çç³»ç»ãåæç®¡çç³»ç»ç­ï¼å ä¸ºè¿ç±»ç³»ç»çæ°æ®åæ´é¢çä½ï¼å³ä½¿å¨æäºåºæ¯ä¸ä¸¢å¤±æ°æ®ï¼ä¹å¯ä»¥éè¿äººå·¥çæ¹å¼è¡¥å¨ã\n\n\n# 3.2. ä¸»ä»å¤å¶\n\nä¸»ä»å¤å¶åä¸»å¤å¤å¶åªæä¸å­ä¹å·®ï¼åºå«å¨äºï¼ä¸»ä»å¤å¶æ¨¡å¼ä¸­ï¼ä»æºè¦æ¿æè¯»æä½ã\n\nä¸»ä»å¤å¶è¦ç¹ï¼\n\n * å­å¨ä¸ä¸»å¤ä»ã\n * ä¸»æºè´è´£è¯»&åï¼å¹¶å®æå¤å¶æ°æ®ç»ä»æºã\n * ä»æºåªè´è´£è¯»ã\n * ä¸æ¦ä¸»æºå®æºï¼å¯ä»¥éè¿äººå·¥ææ®µï¼å°å¶ä¸­ä¸ä¸ªä»èç¹ä½ä¸ºä¸»èç¹ã\n\n\n\nä¼ç¹\n\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä¸»æºæéæ¶ï¼è¯»æä½ç¸å³çä¸å¡å¯ä»¥ç»§ç»­è¿è¡ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä»æºæä¾è¯»æä½ï¼åæ¥äºç¡¬ä»¶çæ§è½ã\n\nç¼ºç¹\n\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼å®¢æ·ç«¯éè¦æç¥ä¸»ä»å³ç³»ï¼å¹¶å°ä¸åçæä½åç»ä¸åçæºå¨è¿è¡å¤çï¼å¤æåº¦æ¯ä¸»å¤å¤å¶è¦é«ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä»æºæä¾è¯»ä¸å¡ï¼å¦æä¸»ä»å¤å¶å»¶è¿æ¯è¾å¤§ï¼ä¸å¡ä¼å ä¸ºæ°æ®ä¸ä¸è´åºç°é®é¢ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼æéæ¶éè¦äººå·¥å¹²é¢ã\n\néç¨åºæ¯\n\nç»¼åä¸»ä»å¤å¶çä¼ç¼ºç¹ï¼ä¸è¬æåµä¸ï¼åå°è¯»å¤çä¸å¡ä½¿ç¨ä¸»ä»å¤å¶çå­å¨æ¶ææ¯è¾å¤ãä¾å¦ï¼è®ºåãBBSãæ°é»ç½ç«è¿ç±»ä¸å¡ï¼æ­¤ç±»ä¸å¡çè¯»æä½æ°éæ¯åæä½æ°éç 10 åçè³ 100 åä»¥ä¸ã\n\n\n# 3.3. éç¾¤+ååº\n\nå¨ä¸»å¤å¤å¶åä¸»ä»å¤å¶æ¨¡å¼ä¸­ï¼é½ç±ä¸ä¸ªå±æ§é®é¢ï¼\n\næ¯ä¸ªæºå¨ä¸å­å¨çé½æ¯å¨éæ°æ®ãä½æ¯ï¼åæºçæ°æ®å­å¨éæ»æ¯æä¸éçï¼å½æ°æ®éä¸åä¸º TB çº§çè³ PB çº§æ°æ®ï¼åæºç»ç©¶ææ æ³æ¯æçæ¶åãè¿æ¶ï¼å°±éè¦å¯¹æ°æ®è¿è¡åçï¼shardingï¼ã\n\nåçåçèç¹å¯ä»¥è§ä¸ºä¸ä¸ªç¬ç«çå­éï¼éå¯¹å­éï¼ä»»ç¶éè¦ä¿è¯é«å¯ç¨ã\n\n\n\n\n# 4. é«å¯ç¨çåºç¨\n\nåºç¨å±ä¸»è¦å¤çç½ç«åºç¨çä¸å¡é»è¾ï¼ä¸ä¸ªæ¾èçç¹ç¹æ¯åºç¨ç æ ç¶æ æ§ã\n\næè°ç æ ç¶æ çåºç¨æ¯æåºç¨æå¡å¨ä¸ä¿å­ä¸å¡çä¸ä¸æä¿¡æ¯ï¼èä»æ ¹æ®æ¯æ¬¡è¯·æ±æäº¤çæ°æ®è¿è¡ç¸åºçä¸å¡é»è¾å¤çï¼å¤ä¸ªæå¡å®ä¾ä¹é´å®å¨å¯¹ç­ï¼è¯·æ±æäº¤å°ä»»ææå¡å¨ï¼å¤çç»æé½æ¯å®å¨ä¸æ ·çã\n\nç±äºæ ç¶æåºç¨ï¼åå®ä¾ä¹é´ä¸ç¨èèæ°æ®ä¸è´æ§é®é¢ï¼æä»¥å¶é«å¯ç¨æ¹æ¡ç¸å¯¹ç®åãä¸»è¦ææ®µæ¯ï¼\n\n * è´è½½åè¡¡\n * åå¸å¼ Session\n\n\n# 4.1. è´è½½åè¡¡\n\nè´è½½åè¡¡ï¼é¡¾åæä¹ï¼ä¸»è¦ä½¿ç¨å¨ä¸å¡éåæ°æ®éè¾é«çæåµä¸ï¼å½åå°æå¡å¨ä¸è¶³ä»¥æ¿æææçè´è½½ååæ¶ï¼éè¿è´è½½åè¡¡ææ®µï¼å°æµéåæ°æ®åæå°ä¸ä¸ªéç¾¤ç»æçå¤å°æå¡å¨ä¸ï¼ä»¥æé«æ´ä½çè´è½½å¤çè½åã\n\næ ç¶æåºç¨çå¤±æè½¬ç§»å¯ä»¥å©ç¨è´è½½åè¡¡æ¥å®ç°ã\n\næ ç¶æçåºç¨å®ç°é«å¯ç¨æ¶æååç®åï¼ç±äºæå¡å¨ä¸ä¿å­è¯·æ±ç¶æï¼é£ä¹æææå¡å¨å®å¨å¯¹ç­ï¼å¨ä»»æèç¹æ§è¡åæ ·çè¯·æ±ï¼ç»ææ»æ¯ä¸è´çãè¿ç§æåµä¸ï¼æç®åçé«å¯ç¨æ¹æ¡å°±æ¯ä½¿ç¨è´è½½åè¡¡ã\n\n> è´è½½åè¡¡åçå¯ä»¥åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 4.2. åå¸å¼ Session\n\nåºç¨æå¡å¨çé«å¯ç¨æ¶æè®¾è®¡ä¸»è¦åºäºæå¡æ ç¶æè¿ä¸ç¹æ§ãäºå®ä¸ï¼ä¸å¡æ»æ¯æç¶æçï¼å¦è´­ç©è½¦è®°å½ç¨æ·çè´­ä¹°ä¿¡æ¯ï¼ç¨æ·çç»å½ç¶æï¼ææ°åå¸çæ¶æ¯ç­ç­ã\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç Session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç Sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nä¸ºäºè§£å³åå¸å¼ Session é®é¢ï¼å¸¸è§çè§£å³æ¹æ¡æï¼\n\n * ç²æ§ session\n * åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n * åºäºç¼å­ç session å±äº« â\n\n> åå¸å¼ä¼è¯åçå¯ä»¥åèï¼åå¸å¼ä¼è¯åºæ¬åç\n\n\n# 5. é«å¯ç¨çæå¡\n\nå¯å¤ç¨çæå¡ä¸ºä¸å¡äº§åæä¾åºç¡å¬å±æå¡ï¼å¤§åç³»ç»ä¸­è¿äºæå¡éå¸¸é½ç¬ç«åå¸å¼é¨ç½²ï¼è¢«å·ä½åºç¨è¿ç¨è°ç¨ãå¯å¤ç¨çæå¡ååºç¨ä¸æ ·ï¼ä¸è¬ä¹æ¯æ ç¶æçæå¡ï¼å æ­¤ï¼åæ ·å¯ä»¥ä½¿ç¨è´è½½åè¡¡çå¤±æè½¬ç§»ç­ç¥æ¥å®ç°é«å¯ç¨ã\n\né¤æ­¤ä»¥å¤ï¼è¿æä»¥ä¸ææ®µæ¥ä¿è¯æå¡çé«å¯ç¨ï¼\n\n * åçº§ç®¡ç\n * è¶æ¶éè¯\n * å¼æ­¥è°ç¨\n * è¿è½½ä¿æ¤\n   * éæµ\n   * éçº§\n   * æ­è·¯\n * å¹ç­æ§è®¾è®¡\n\n\n# 5.1. åçº§ç®¡ç\n\nå°æå¡æ ¹æ®ä¸å¡éè¦æ§è¿è¡åçº§ç®¡çï¼æ ¸å¿åºç¨åæå¡ä¼åä½¿ç¨æ´å¥½çç¡¬ä»¶ï¼å¨è¿ç»´ååºéåº¦ä¸ä¹æ ¼å¤è¿éã\n\nå¨æå¡é¨ç½²ä¸è¿è¡å¿è¦çéç¦»ï¼é¿åæéçè¿éååºãä½ä¼åçº§çæå¡éè¿å¯å¨ä¸åççº¿ç¨æé¨ç½²å¨ä¸åçèææºä¸è¿è¡éç¦»ï¼èé«ä¼åçº§çæå¡åéè¦é¨ç½²å¨ä¸åçç©çæºä¸ï¼æ ¸å¿æå¡åæ°æ®çè³è¦é¨ç½²å¨ä¸åå°åçæ°æ®ä¸­å¿ã\n\n\n# 5.2. è¶æ¶éè¯\n\nç±äºæå¡å¨å®æºãçº¿ç¨æ­»éç­åå ï¼å¯è½å¯¼è´åºç¨ç¨åºå¯¹æå¡ç«¯çè°ç¨å¤±å»ååºãæä»¥æå¿è¦å¼å¥è¶æ¶æºå¶ï¼ä¸æ¦è°ç¨è¶æ¶ï¼æå¡åæ¡æ¶æåºå¼å¸¸ï¼åºç¨ç¨åºæ ¹æ®æå¡è°åº¦ç­ç¥ï¼éæ©éè¯æè¯·æ±è½¬ç§»å°å¶ä»æºå¨ä¸ã\n\n\n# 5.3. å¼æ­¥è°ç¨\n\nå¯¹äºéè¦å³æ¶ååºçä¸å¡ï¼åºç¨å¨è°ç¨æå¡æ¶å¯ä»¥éè¿æ¶æ¯éåç­å¼æ­¥æ¹å¼å®æï¼é¿åä¸ä¸ªæå¡å¤±è´¥å¯¼è´æ´ä¸ªåºç¨è¯·æ±å¤±è´¥çæåµãå½ç¶ä¸æ¯æææå¡è°ç¨é½å¯ä»¥å¼æ­¥è°ç¨ï¼å¯¹äºè·åç¨æ·ä¿¡æ¯è¿ç±»è°ç¨ï¼éç¨å¼æ­¥æ¹å¼ä¼å»¶é¿ååºæ¶é´ï¼å¾ä¸å¿å¤±ï¼æ­¤å¤ï¼å¯¹äºé£äºå¿é¡»ç¡®è®¤æå¡è°ç¨æè½ç»§ç»­ä¸ä¸æ­¥æä½çåºç¨ä¹ä¸éå®é£ç¨å¼æ­¥è°ç¨ã\n\n\n# 5.4. è¿è½½ä¿æ¤\n\nè¿è½½ä¿æ¤çææ®µï¼ä¸è¬æï¼éæµãéçº§ãçæ­ã\n\n# éæµ\n\néçº§æ¯ä»ç³»ç»åè½ä¼åçº§çè§åº¦èèå¦ä½åºå¯¹æéï¼èéæµåæ¯ä»ç¨æ·è®¿é®ååçè§åº¦æ¥èèå¦ä½åºå¯¹æéãéæµæåªåè®¸ç³»ç»è½å¤æ¿åçè®¿é®éè¿æ¥ï¼è¶åºç³»ç»è®¿é®è½åçè¯·æ±å°è¢«ä¸¢å¼ã\n\nå¸¸è§çéæµæ¹å¼å¯ä»¥åä¸ºä¸¤ç±»ï¼åºäºè¯·æ±éæµååºäºèµæºéæµã\n\n# åºäºè¯·æ±éæµ\n\nåºäºè¯·æ±éæµæä»å¤é¨è®¿é®çè¯·æ±è§åº¦èèéæµï¼å¸¸è§çæ¹å¼æï¼éå¶æ»éãéå¶æ¶é´éã\n\néå¶æ»éçæ¹å¼æ¯éå¶æä¸ªææ çç´¯ç§¯ä¸éï¼å¸¸è§çæ¯éå¶å½åç³»ç»æå¡çç¨æ·æ»éï¼ä¾å¦æä¸ªç´æ­é´éå¶æ»ç¨æ·æ°ä¸éä¸º 100 ä¸ï¼è¶è¿ 100 ä¸åæ°çç¨æ·æ æ³è¿å¥ï¼æä¸ªæ¢è´­æ´»å¨ååæ°éåªæ 100 ä¸ªï¼éå¶åä¸æ¢è´­çç¨æ·ä¸éä¸º 1 ä¸ä¸ªï¼1 ä¸ä»¥åçç¨æ·ç´æ¥æç»ãéå¶æ¶é´éæéå¶ä¸æ®µæ¶é´åæä¸ªææ çä¸éï¼ä¾å¦ï¼1 åéååªåè®¸ 10000 ä¸ªç¨æ·è®¿é®ï¼æ¯ç§è¯·æ±å³°å¼æé«ä¸º 10 ä¸ã\n\næ è®ºæ¯éå¶æ»éè¿æ¯éå¶æ¶é´éï¼å±åçç¹ç¹é½æ¯å®ç°ç®åï¼ä½å¨å®è·µä¸­é¢ä¸´çä¸»è¦é®é¢æ¯æ¯è¾é¾ä»¥æ¾å°åéçéå¼ã\n\n# åºäºèµæºéæµ\n\nåºäºè¯·æ±éæµæ¯ä»ç³»ç»å¤é¨èèçï¼èåºäºèµæºéæµæ¯ä»ç³»ç»åé¨èèçï¼å³ï¼æ¾å°ç³»ç»åé¨å½±åæ§è½çå³é®èµæºï¼å¯¹å¶ä½¿ç¨ä¸éè¿è¡éå¶ãå¸¸è§çåé¨èµæºæï¼è¿æ¥æ°ãæä»¶å¥æãçº¿ç¨æ°ãè¯·æ±éåç­ã\n\nåºäºèµæºéæµç¸æ¯åºäºè¯·æ±éæµè½å¤æ´å ææå°åæ å½åç³»ç»çååï¼ä½å®è·µä¸­è®¾è®¡ä¹é¢ä¸´ä¸¤ä¸ªä¸»è¦çé¾ç¹ï¼å¦ä½ç¡®å®å³é®èµæºï¼å¦ä½ç¡®å®å³é®èµæºçéå¼ã\n\n# éçº§\n\néçº§æç³»ç»å°æäºä¸å¡æèæ¥å£çåè½éä½ï¼å¯ä»¥æ¯åªæä¾é¨ååè½ï¼ä¹å¯ä»¥æ¯å®å¨åæææåè½ã\n\nå¨æå¡è®¿é®çé«å³°æï¼æå¡å¯è½å ä¸ºå¤§éå¹¶åè°ç¨èæ§è½ä¸éï¼ä¸¥éæ¶å¯è½ä¼å¯¼è´å®æºãä¸ºäºä¿è¯æ ¸å¿åè½çæ­£å¸¸è¿è¡ï¼éè¦å¯¹æå¡è¿è¡éçº§ãéçº§æä¸¤ç§ææ®µï¼\n\næç»æå¡ - æç»ä½ä¼åçº§åºç¨çè°ç¨ï¼åå°æå¡è°ç¨å¹¶åæ°ï¼ç¡®ä¿æ ¸å¿åºç¨æ­£å¸¸ä½¿ç¨ãæèéæºæç»é¨åè°ç¨ï¼èçº¦èµæºï¼é¿åè¦æ­»å¤§å®¶ä¸èµ·æ­»çæ¨å§ã\n\nå³é­æå¡ - å³é­é¨åä¸éè¦çæå¡ï¼æèæå¡åé¨å³é­é¨åä¸éè¦çåè½ï¼ä»¥èçº¦èµæºã\n\n# çæ­\n\nçæ­åéçº§æ¯ä¸¤ä¸ªæ¯è¾å®¹ææ··æ·çæ¦å¿µï¼å ä¸ºåçº¯ä»åå­ä¸çå¥½åé½æç¦æ­¢æä¸ªåè½çææï¼ä½å¶å®åå¨å«ä¹æ¯ä¸åçï¼åå å¨äºéçº§çç®çæ¯åºå¯¹ç³»ç»èªèº«çæéï¼èçæ­çç®çæ¯åºå¯¹ä¾èµçå¤é¨ç³»ç»æéçæåµã\n\nçæ­æºå¶å®ç°çå³é®æ¯éè¦æä¸ä¸ªç»ä¸ç API è°ç¨å±ï¼ç± API è°ç¨å±æ¥è¿è¡éæ ·æèç»è®¡ï¼å¦ææ¥å£è°ç¨æ£è½å¨ä»£ç åå¤å°±æ²¡æ³è¿è¡ç»ä¸å¤çäºã\n\n\n# 5.5. å¹ç­æ§è®¾è®¡\n\næå¡è°ç¨å¤±è´¥åï¼è°ç¨æ¹ä¼å°è¯·æ±è½¬åå°å¶ä»æå¡å¨ä¸ï¼ä½æ¯è¿ä¸ªå¤±è´¥å¯è½æ¯èåçå¤±è´¥ãæ¯å¦æå¡å·²ç»å¤çæåï¼ä½å ä¸ºç½ç»æéå¯¼è´è°ç¨æ¹æ²¡ææ¶å°åºç­ï¼æç­å¾è¶æ¶ãè¿ç§æåµä¸ï¼éæ°åèµ·è¯·æ±ï¼å¯è½ä¼å¯¼è´éå¤æä½ï¼å¦ï¼åæ°æ®åºåå¥ä¸¤æ¡è®°å½ãå¦æè¿ä¸ªæä½æ¯æ¯è¾ææçäº¤ææä½ï¼å°±ä¼äº§çä¸¥éåæã\n\næå¡éå¤è°ç¨æ¶æ æ³é¿åçï¼ä½æ¯åªè¦è½ä»ä¸å¡å®ç°ä¸ä¿è¯ï¼éå¤è°ç¨åä¸æ¬¡è°ç¨çå¤çç»æä¸è´ï¼åä¸å¡å°±æ²¡æé®é¢ï¼è¿å°±æ¯å¹ç­æ§è®¾è®¡ã\n\næäºæå¡çä¸å¡å¤©ç¶å·æå¹ç­æ§ï¼æ¯å¦å°ç¨æ·æ§å«è®¾ä¸ºç·æ§ï¼ä¸ç®¡æ§è¡å¤å°æ¬¡ï¼ç»ææ¯ä¸è´çãä½æäºå¤æçä¸å¡ï¼è¦æ³ä¿è¯å¹ç­æ§ï¼å°±éè¦æ ¹æ®å¨å±æ§ç ID å»è¿è¡æææ§éªè¯ï¼éªè¯éè¿æè½ç»§ç»­æ§è¡ã\n\n\n# 6. é«å¯ç¨çå­å¨\n\nå¯¹äºç»å¤§é¨åè½¯ä»¶ç³»ç»èè¨ï¼æ°æ®é½æ¯æå®è´µçèæèµäº§ï¼ä¸æ¦ä¸¢å¤±ï¼å¯ä»¥è¯´æ¯æ¯ç­æ§çæå»ã\n\nä¿è¯å­å¨é«å¯ç¨çä¸»è¦ææ®µæ¯ï¼æ°æ®å¤ä»½åå¤±æè½¬ç§»ã\n\nå­å¨é«å¯ç¨æ¶æçå¤ææ§ä¸»è¦ä½ç°å¨ï¼å¦ä½åºå¯¹å¯æ¬åæ­¥å»¶è¿åä¸­æ­å¯¼è´çæ°æ®ä¸è´æ§é®é¢ã\n\n> æç¤ºï¼åå¼å§å­¦ä¹ è¿é¨ååå®¹åï¼å»ºè®®åå­¦ä¹  äºãé«å¯ç¨æ¶æçè®º\n\n\n# 6.1. æ°æ®å¤ä»½\n\næ°æ®å¤ä»½æ¯ä¿è¯æ°æ®æå¤ä¸ªå¯æ¬ï¼ä»»æå¯æ¬çä¸¢å¤±é½ä¸ä¼å¯¼è´æ°æ®çæ°¸ä¹ä¸¢å¤±ã\n\n * å·å¤ä»½ - å®æå°æ°æ®å¤å¶å°æç§å­å¨ä»è´¨ã\n * ç­å¤ä»½\n   * å¼æ­¥ç­å¤æ¹å¼ - å¼æ­¥ç­å¤æ¹å¼æ¯æå¤ä»½æ°æ®å¯æ¬çåå¥æä½å¼æ­¥å®æï¼åºç¨ç¨åºæ¶å°æ°æ®æå¡ç³»ç»çåæä½æåååºæ¶ï¼åªåæåäºä¸ä»½ï¼å­å¨ç³»ç»å°ä¼å¼æ­¥å°åå¶ä»å¯æ¬ã\n   * åæ­¥ç­å¤æ¹å¼ - åæ­¥ç­å¤æ¹å¼æ¯æå¤ä»½æ°æ®å¯æ¬çåå¥æä½åæ­¥å®æï¼å³åºç¨ç¨åºæ¶å°æ°æ®æå¡ç³»ç»çåæåååºæ¶ï¼å¤ä»½æ°æ®é½å·²ç»åæä½æåãä½æ¯å½åºç¨ç¨åºæ¶å°æ°æ®åæä½å¤±è´¥çååºå¼ï¼å¯è½æé¨åå¯æ¬æèå¨é¨å¯æ¬é½å·²ç»åå¥æåäºï¼å ä¸ºç½ç»æèç³»ç»æéï¼æ æ³è¿åæä½æåçååºï¼ã\n\n\n# 6.2. å¤±æè½¬ç§»\n\nå¤±æè½¬ç§»æ¯ä¿è¯ä»»æä¸ä¸ªå¯æ¬ä¸å¯è®¿é®æ¶ï¼å¯ä»¥å¿«éåæ¢è®¿é®å¶ä»å¯æ¬ï¼ä¿è¯ç³»ç»æ´ä½å¯ç¨ã\n\n# å¤±æç¡®è®¤\n\n\n\nå¤æ­æå¡å¨å®æºçææ®µæä¸¤ç§ï¼å¿è·³æ£æµåè®¿é®å¤±è´¥æ¥åã\n\nå¯¹äºåºç¨ç¨åºçè®¿é®å¤±è´¥æ¥åï¼æ§å¶ä¸­å¿è¿éè¦åä¸æ¬¡åéå¿è·³æ£æµè¿è¡ç¡®è®¤ï¼ä»¥åéè¯¯å¤æ­æå¡å¨å®æºãå ä¸ºä¸æ¦è¿è¡æ°æ®è®¿é®çå¤±æè½¬ç§»ï¼æå³çæ°æ®å­å¨å¤ä»½å¯æ¬ä¸ä¸è´ï¼éè¦è¿è¡åç»­ä¸ç³»åçå¤æå¨ä½ã\n\n# è®¿é®è½¬ç§»\n\nç¡®è®¤æå°æ°æ®æå¡å¨å®æºåï¼å°±éè¦å°æ°æ®è¯»åè®¿é®éæ°è·¯ç±å°å¶ä»æå¡å¨ä¸ãå¯¹äºå®å¨å¯¹ç­å­å¨çæå¡å¨ï¼å½å¶ä¸­ä¸å°å®æºåï¼åºç¨ç¨åºæ ¹æ®éç½®ç´æ¥åæ¢å°å¯¹ç­æå¡å¨ä¸ãå¦æå­å¨ä¸å¯¹ç­ï¼å°±éè¦éæ°è®¡ç®è·¯ç±ï¼éæ©å­å¨æå¡å¨ã\n\n# æ°æ®æ¢å¤\n\nå ä¸ºæå°æå¡å¨å®æºï¼æä»¥æ°æ®å­å¨çå¯æ¬æ°ç®ä¼åå°ï¼å¿é¡»å°å¯æ¬çæ°ç®æ¢å¤å°ç³»ç»è®¾å®çå¼ï¼å¦åï¼åææå¡å¨å®æºæ¶ï¼å°±å¯è½åºç°æ æ³è®¿é®è½¬ç§»ï¼æ°æ®æ°¸ä¹ä¸¢å¤±çæåµãå æ­¤ç³»ç»éè¦ä»å¥åº·çæå¡å¨å¤å¶æ°æ®ï¼å°æ°æ®å¯æ¬æ°ç®æ¢å¤å°è®¾å®å¼ã\n\n\n# 7. è¾å©ææ®µ\n\n\n# 7.1. å¼å°å¤æ´»\n\nå¼å°å¤æ´»æ¶æçå³é®ç¹å°±æ¯å¼å°ãå¤æ´»ï¼å¶ä¸­å¼å°å°±æ¯æå°çä½ç½®ä¸ä¸åçå°æ¹ï¼ç±»ä¼¼äºâä¸è¦æé¸¡èé½æ¾å¨åä¸ç¯®å­éâï¼å¤æ´»å°±æ¯æä¸åå°çä½ç½®ä¸çç³»ç»é½è½å¤æä¾ä¸å¡æå¡ï¼è¿éçâæ´»âæ¯æ´»å¨ãæ´»è·çææã\n\nå¼å°å¤æ´»æ¶æå¯ä»¥åä¸ºååå¼åºãè·¨åå¼å°ãè·¨å½å¼å°ã\n\nå¼å°å¤æ´»æ¶æçä»£ä»·ï¼\n\n * ç³»ç»å¤æåº¦ä¼åçè´¨çååï¼éè¦è®¾è®¡å¤æçå¼å°å¤æ´»æ¶æã\n * ææ¬ä¼ä¸åï¼æ¯ç«è¦å¤å¨ä¸ä¸ªæèå¤ä¸ªæºæ¿æ­å»ºç¬ç«çä¸å¥ä¸å¡ç³»ç»ã\n\nå¼å°å¤æ´»çè®¾è®¡ååï¼\n\n * ä¿è¯æ ¸å¿ä¸å¡çå¼å°å¤æ´»\n * ä¿è¯æ ¸å¿æ°æ®æç»ä¸è´æ§\n * éç¨å¤ç§ææ®µåæ­¥æ°æ®\n * åªä¿è¯ç»å¤§é¨åç¨æ·çå¼å°å¤æ´»\n\nå¼å°å¤æ´»è®¾è®¡æ­¥éª¤ï¼\n\n * ä¸å¡åçº§ - å¸¸è§çåçº§æ åæï¼\n   * æµéå¤§çä¸å¡\n   * æ ¸å¿ä¸å¡\n   * çå©ä¸å¡\n * æ°æ®åç±» - å¸¸è§çæ°æ®åæç»´åº¦æï¼\n   * æ°æ®é\n   * å¯ä¸æ§\n   * å®æ¶æ§\n   * å¯ä¸¢å®æ§\n   * å¯æ¢å¤æ§\n * æ°æ®åæ­¥ - å¸¸è§çæ°æ®åæ­¥æ¹æ¡\n   * å­å¨ç³»ç»åæ­¥\n   * æ¶æ¯éååæ­¥\n   * éå¤çæ\n * å¼å¸¸å¤ç - å¸¸è§å¼å¸¸å¤çæªæ½ï¼\n   * å¤ééåæ­¥\n   * åæ­¥åè®¿é®ç»å\n   * æ¥å¿è®°å½\n   * ç¨æ·è¡¥å¿\n\n\n# 7.2. åå¸æµç¨\n\né«å¯ç¨çè½¯ä»¶è´¨éä¿è¯çææ®µï¼\n\n * èªå¨åæµè¯\n * é¢åå¸éªè¯\n * ä»£ç æ§å¶\n * èªå¨ååå¸\n * ç°åº¦åå¸\n\n\n# 7.3. ç³»ç»çæ§\n\n> ä¸åè®¸æ²¡æçæ§çç³»ç»ä¸çº¿ã\n\n * çæ§æ°æ®éé\n   * ç¨æ·è¡ä¸ºæ¥å¿æ¶é\n     * æå¡ç«¯æ¥å¿æ¶é - ApacheãNginx ç­å ä¹ææ Web æå¡å¨é½å·å¤æ¥å¿è®°å½åè½ï¼åªè¦å¼å¯æ¥å¿è®°å½å³å¯ãå¦ææ¯æå¡å¨æ¯è¾å¤ï¼éè¦éä¸­ééæ¥å¿ï¼éå¸¸ä¼ä½¿ç¨ Elastic æ¥è¿è¡æ¶éã\n     * å®¢æ·ç«¯æ¥å¿æ¶é - å©ç¨é¡µé¢åµå¥ä¸é¨ç JavaScript èæ¬å¯ä»¥æ¶éç¨æ·çå®çæä½è¡ä¸ºã\n     * æ¥å¿åæ - å¯ä»¥å©ç¨ ElasticSearch åè¯­ä¹åæåæç´¢ï¼å©ç¨å®æ¶è®¡ç®æ¡æ¶ StormãFlink ç­å¼åæ¥å¿ç»è®¡ä¸åæå·¥å·ã\n   * æå¡å¨æ§è½çæ§ - æ¶éæå¡å¨æ§è½ææ ï¼å¦ç³»ç»è´è½½ãåå­å ç¨ãCPU å ç¨ãç£ç IOãç½ç» IO ç­ãå¸¸ç¨ççæ§å·¥å·æï¼Apache SkyWalking ãPinpoint ç­ã\n   * è¿è¡æ°æ®æ¥å - åºè¯¥çæ§ä¸äºä¸å·ä½ä¸å¡åºæ¯ç¸å³çææ¯åä¸å¡ææ ï¼å¦ï¼ç¼å­å½ä¸­çãå¹³åååºæ¶å»¶ãTPSãQPS ç­ã\n * çæ§ç®¡ç\n   * ç³»ç»æ¥è­¦ - è®¾ç½®éå¼ãå½è¾¾å°éå¼ï¼åæ¶è§¦ååè­¦ï¼ç­ä¿¡ãé®ä»¶ãéä¿¡å·¥å·åå¯ï¼ï¼éè¿åæ¶å¤æ­ç¶åµï¼é²æ£äºæªç¶ã\n   * å¤±æè½¬ç§» - çæ§ç³»ç»å¯ä»¥å¨åç°æéçæåµä¸ä¸»å¨éç¥åºç¨è¿è¡å¤±æè½¬ç§»ã\n   * èªå¨ä¼ééçº§\n     * ä¼ééçº§æ¯ä¸ºäºåºä»çªç¶çåçè®¿é®é«å³°ï¼ä¸»å¨å³é­é¨ååè½ï¼éæ¾é¨åèµæºï¼ä»¥ä¿è¯æ ¸å¿åè½çä¼åè®¿é®ã\n     * ç³»ç»å¨çæ§ç®¡çåºç¡ä¹ä¸å®ç°èªå¨ä¼ééçº§ï¼æ¯ææ§æ¶æççæ³ç¶æã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n * å·¦è³å¬é£",normalizedContent:"# ç³»ç»é«å¯ç¨æ¶æ\n\n\n# 1. é«å¯ç¨æ¶æç®ä»\n\n\n# 1.1. ç³»ç»å¯ç¨æ§çåº¦é\n\nç³»ç»ä¸å¯ç¨ä¹è¢«ç§°ä½ç³»ç»æéï¼ä¸çéå¸¸ç¨å¤ä¸ª 9 æ¥è¡¡éç³»ç»çå¯ç¨æ§ãå¦ qq çå¯ç¨æ§ä¸º 4 ä¸ª 9ï¼å³ 99.99% å¯ç¨ã\n\nç½ç«ä¸å¯ç¨æ¶é´ = æéä¿®å¤æ¶é´ç¹ - æéåç°æ¶é´ç¹\nç½ç«å¹´åº¦å¯ç¨æ§ææ  = (1 - ç½ç«ä¸å¯ç¨æ¶é´/å¹´åº¦æ»æ¶é´) * 100%\n\n\nå¯ç¨æ§è®¡éè¡¨ï¼\n\nå¯ç¨æ§çº§å«   ç³»ç»å¯ç¨æ§%    å®æºæ¶é´/å¹´     å®æºæ¶é´/æ    å®æºæ¶é´/å¨    å®æºæ¶é´/å¤©\nä¸å¯ç¨     90%       36.5 å¤©     73 å°æ¶     16.8 å°æ¶   144 åé\nåºæ¬å¯ç¨    99%       87.6 å°æ¶    7.3 å°æ¶    1.68 å°æ¶   14.4 åé\nè¾é«å¯ç¨    99.9%     8.76 å°æ¶    43.8 åé   10.1 åé   1.44 åé\né«å¯ç¨     99.99%    52.56 åé   4.38 åé   1.01 ç§    8.64 ç§\næé«å¯ç¨    99.999%   5.26 åé    26.28 ç§   6.06 ç§    0.86 ç§\n\n\n# 1.2. æéåå \n\nç³»ç»å®æºåå ä¸»è¦æä»¥ä¸ï¼\n\næ è®¡åç\n\n * ç³»ç»çº§æéï¼åæ¬ä¸»æºãæä½ç³»ç»ãä¸­é´ä»¶ãæ°æ®åºãç½ç»ãçµæºä»¥åå¤å´è®¾å¤ã\n * æ°æ®åä¸­ä»çæéï¼åæ¬äººåè¯¯æä½ãç¡¬çæéãæ°æ®ä¹±äºã\n * è¿æèªç¶ç¾å®³ãäººä¸ºç ´åï¼ä»¥åä¾çµé®é¢ç­ã\n\næè®¡åç\n\n * æ¥å¸¸ä»»å¡ï¼å¤ä»½ï¼å®¹éè§åï¼ç¨æ·åå®å¨ç®¡çï¼åå°æ¹å¤çåºç¨ã\n * è¿ç»´ç¸å³ï¼æ°æ®åºç»´æ¤ãåºç¨ç»´æ¤ãä¸­é´ä»¶ç»´æ¤ãæä½ç³»ç»ç»´æ¤ãç½ç»ç»´æ¤ã\n * åçº§ç¸å³ï¼æ°æ®åºãåºç¨ãä¸­é´ä»¶ãæä½ç³»ç»ãç½ç»ï¼åæ¬ç¡¬ä»¶åçº§ã\n\næä»¬åç»å®ä»¬å½ä¸ªç±»ã\n\n 1. ç½ç»é®é¢ãç½ç»é¾æ¥åºç°é®é¢ï¼ç½ç»å¸¦å®½åºç°æ¥å¡â¦â¦\n 2. æ§è½é®é¢ãæ°æ®åºæ¢ sqlãjava full gcãç¡¬ç io è¿å¤§ãcpu é£é«ãåå­ä¸è¶³â¦â¦\n 3. å®å¨é®é¢ãè¢«ç½ç»æ»å»ï¼å¦ ddos ç­ã\n 4. è¿ç»´é®é¢ãç³»ç»æ»æ¯å¨è¢«æ´æ°åä¿®æ¹ï¼æ¶æä¹å¨ä¸æ­å°è¢«è°æ´ï¼çæ§é®é¢â¦â¦\n 5. ç®¡çé®é¢ãæ²¡ææ¢³çåºå³é®æå¡ä»¥åæå¡çä¾èµå³ç³»ï¼è¿è¡ä¿¡æ¯æ²¡æåæ§å¶ç³»ç»åæ­¥â¦â¦\n 6. ç¡¬ä»¶é®é¢ãç¡¬çæåãç½å¡åºé®é¢ãäº¤æ¢æºåºé®é¢ãæºæ¿æçµãæææºé®é¢â¦â¦\n\n\n# 1.3. ä»ä¹æ¯é«å¯ç¨çç³»ç»æ¶æ\n\néå¸¸ï¼ä¼ä¸çº§åºç¨ç³»ç»ä¸ºæé«ç³»ç»å¯ç¨æ§ï¼ä¼éç¨è¾æè´µçè½¯ç¡¬ä»¶è®¾å¤ï¼å½ç¶è¿æ ·çè®¾å¤ä¹æ¯è¾ç¨³å®ã\n\näºèç½å¬å¸æä¸äºåååå¬å¸åºäºææ¬èèï¼æ´å¤éç¨ pc çº§è½¯ç¡¬ä»¶è®¾å¤ï¼èçº¦ææ¬æä»åºçä»£ä»·å°±æ¯è®¾å¤è¾ä¸ºä¸ç¨³å®ãæå¡å¨ä¸å¹´ä¸­åºç°å æ¬¡å®æºï¼é«å¼ºåº¦è¯»åç£çå¯¼è´ç£çæåç­äºä»¶å®å±æ­£å¸¸ã\n\nç»¼ä¸ï¼ç¡¬ä»¶åºç°æéåºè§ä¸ºå¿ç¶çï¼èé«å¯ç¨çç³»ç»æ¶æè®¾è®¡ç®æ å°±æ¯è¦ä¿è¯å½åºç°ç¡¬ä»¶æéæ¶ï¼æå¡ä¾ç¶å¯ç¨ï¼æ°æ®ä¾ç¶è½å¤ä¿å­å¹¶è¢«è®¿é®ãå®ç°é«å¯ç¨çç³»ç»æ¶æçä¸»è¦ææ®µæ¯æ°æ®åæå¡çåä½å¤ä»½åå¤±æè½¬ç§»ï¼ä¸æ¦æäºæå¡å¨å®æºï¼å°±å°æå¡åæ¢å°å¶ä»å¯ç¨çæå¡å¨ä¸ï¼å¦æç£çæåï¼åä»å¤ä»½çç£çè¯»åæ°æ®ã\n\nå¤§åç³»ç»çåå±æ¶æåç©çæå¡å¨çåå¸å¼é¨ç½²ä½¿å¾ä½äºä¸åå±æ¬¡çæå¡å¨å·æä¸åçå¯ç¨æ§ç¹ç¹ãå³é­æå¡ææå¡å¨å®æºæ¶äº§ççå½±åä¹ä¸ç¸åï¼é«å¯ç¨çè§£å³æ¹æ¡ä¹å·®å¼çå¤§ãå¤§è´å¯ä»¥åä¸ºï¼\n\n * é«å¯ç¨çåºç¨ - ä¸»è¦ææ®µæ¯ï¼è´è½½åè¡¡\n * é«å¯ç¨çæå¡ - ä¸»è¦ææ®µæ¯ï¼åçº§ç®¡çãè¶æ¶éè¯ãå¼æ­¥è°ç¨ãéæµãéè§£ãæ­è·¯ãå¹ç­æ§è®¾è®¡\n * é«å¯ç¨çæ°æ® - ä¸»è¦ææ®µæ¯ï¼æ°æ®å¤ä»½åå¤±æè½¬ç§»\n\n\n# 2. é«å¯ç¨æ¶æçè®º\n\nå­¦ä¹ é«å¯ç¨æ¶æï¼é¦åéè¦äºè§£åå¸å¼åºç¡çè®ºï¼cap å baseã\n\nç¶åï¼å¾å¤èåçåå¸å¼ç³»ç»ï¼é½å©ç¨éä¸¾æºå¶ï¼æ¥ä¿è¯ä¸»èç¹å®æºæ¶çæéæ¢å¤ãå¦æè¦æ·±å¥çè§£éä¸¾æºå¶ï¼æå¿è¦äºè§£ï¼paxos ç®æ³ å raft ç®æ³ãpaxos å raft æ¯ä¸ºäºå®ç°åå¸å¼ç³»ç»ä¸­é«å¯ç¨æ¶æèæåºçå±è¯æ§ç®æ³ï¼å·²ç»æä¸ºä¸çæ åã\n\ncap å®çåç§°ä¸º cap ååï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ ä¸è´æ§ï¼cï¼consistencyï¼ãå¯ç¨æ§ï¼aï¼availabilityï¼ å ååºå®¹å¿æ§ï¼pï¼partition toleranceï¼ï¼æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\nbase æ¯ åºæ¬å¯ç¨ï¼basically availableï¼ãè½¯ç¶æï¼soft stateï¼ å æç»ä¸è´æ§ï¼eventually consistentï¼ ä¸ä¸ªç­è¯­çç¼©åãbase çè®ºæ¯å¯¹ cap ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æï¼å®ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n> cap å base çè®ºçè¯¦ç»è¯´æè¯·åèï¼åå¸å¼çè®º\n> \n> paxos å raft çè¯¦ç»è¯´æè¯·åèï¼paxos ç®æ³ å raft ç®æ³\n\n\n# 3. æ¶ææ¨¡å¼\n\n\n# 3.1. ä¸»å¤å¤å¶\n\nä¸»å¤å¤å¶æ¯æå¸¸è§ä¹æ¯æç®åçä¸ç§å­å¨é«å¯ç¨æ¹æ¡ï¼å ä¹ææçå­å¨ç³»ç»é½æä¾äºä¸»å¤å¤å¶çåè½ï¼ä¾å¦ mysqlãredisãmongodb ç­ã\n\nä¸»å¤å¤å¶è¦ç¹ï¼\n\n * å­å¨ä¸ä¸»å¤å¤ã\n * ä¸»æºè´è´£è¯»&åï¼å¹¶å®æå¤å¶æ°æ®ç»å¤æºã\n * ä¸æ¦ä¸»æºå®æºï¼å¯ä»¥éè¿äººå·¥ææ®µï¼å°å¶ä¸­ä¸ä¸ªå¤èç¹ä½ä¸ºä¸»èç¹ã\n\n\n\nä¼ç¹\n\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼å®¢æ·ç«¯å¯ä»¥ä¸æç¥å¤æºçå­å¨ãå³ä½¿ç¾é¾æ¢å¤åï¼åæ¥çå¤æºè¢«äººå·¥ä¿®æ¹ä¸ºä¸»æºåï¼å¯¹äºå®¢æ·ç«¯æ¥è¯´ï¼åªæ¯è®¤ä¸ºä¸»æºçå°åæ¢äºèå·²ï¼æ é¡»ç¥éæ¯åæ¥çå¤æºåçº§ä¸ºä¸»æºã\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼ä¸»æºåå¤æºä¹é´ï¼åªéè¦è¿è¡æ°æ®å¤å¶å³å¯ï¼æ é¡»è¿è¡ç¶æå¤æ­åä¸»å¤åæ¢è¿ç±»å¤æçæä½ã\n\nç¼ºç¹\n\n * ä¸»å¤å¤å¶æ¶æä¸­ï¼æéåéè¦äººå·¥å¹²é¢ï¼æ æ³èªå¨æ¢å¤ã\n\néç¨åºæ¯\n\nç»¼åä¸»å¤å¤å¶æ¶æçä¼ç¼ºç¹ï¼åé¨çåå°ç®¡çç³»ç»ä½¿ç¨ä¸»å¤å¤å¶æ¶æçæåµä¼æ¯è¾å¤ï¼ä¾å¦å­¦çç®¡çç³»ç»ãåå·¥ç®¡çç³»ç»ãåæç®¡çç³»ç»ç­ï¼å ä¸ºè¿ç±»ç³»ç»çæ°æ®åæ´é¢çä½ï¼å³ä½¿å¨æäºåºæ¯ä¸ä¸¢å¤±æ°æ®ï¼ä¹å¯ä»¥éè¿äººå·¥çæ¹å¼è¡¥å¨ã\n\n\n# 3.2. ä¸»ä»å¤å¶\n\nä¸»ä»å¤å¶åä¸»å¤å¤å¶åªæä¸å­ä¹å·®ï¼åºå«å¨äºï¼ä¸»ä»å¤å¶æ¨¡å¼ä¸­ï¼ä»æºè¦æ¿æè¯»æä½ã\n\nä¸»ä»å¤å¶è¦ç¹ï¼\n\n * å­å¨ä¸ä¸»å¤ä»ã\n * ä¸»æºè´è´£è¯»&åï¼å¹¶å®æå¤å¶æ°æ®ç»ä»æºã\n * ä»æºåªè´è´£è¯»ã\n * ä¸æ¦ä¸»æºå®æºï¼å¯ä»¥éè¿äººå·¥ææ®µï¼å°å¶ä¸­ä¸ä¸ªä»èç¹ä½ä¸ºä¸»èç¹ã\n\n\n\nä¼ç¹\n\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä¸»æºæéæ¶ï¼è¯»æä½ç¸å³çä¸å¡å¯ä»¥ç»§ç»­è¿è¡ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä»æºæä¾è¯»æä½ï¼åæ¥äºç¡¬ä»¶çæ§è½ã\n\nç¼ºç¹\n\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼å®¢æ·ç«¯éè¦æç¥ä¸»ä»å³ç³»ï¼å¹¶å°ä¸åçæä½åç»ä¸åçæºå¨è¿è¡å¤çï¼å¤æåº¦æ¯ä¸»å¤å¤å¶è¦é«ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼ä»æºæä¾è¯»ä¸å¡ï¼å¦æä¸»ä»å¤å¶å»¶è¿æ¯è¾å¤§ï¼ä¸å¡ä¼å ä¸ºæ°æ®ä¸ä¸è´åºç°é®é¢ã\n * ä¸»ä»å¤å¶æ¶æä¸­ï¼æéæ¶éè¦äººå·¥å¹²é¢ã\n\néç¨åºæ¯\n\nç»¼åä¸»ä»å¤å¶çä¼ç¼ºç¹ï¼ä¸è¬æåµä¸ï¼åå°è¯»å¤çä¸å¡ä½¿ç¨ä¸»ä»å¤å¶çå­å¨æ¶ææ¯è¾å¤ãä¾å¦ï¼è®ºåãbbsãæ°é»ç½ç«è¿ç±»ä¸å¡ï¼æ­¤ç±»ä¸å¡çè¯»æä½æ°éæ¯åæä½æ°éç 10 åçè³ 100 åä»¥ä¸ã\n\n\n# 3.3. éç¾¤+ååº\n\nå¨ä¸»å¤å¤å¶åä¸»ä»å¤å¶æ¨¡å¼ä¸­ï¼é½ç±ä¸ä¸ªå±æ§é®é¢ï¼\n\næ¯ä¸ªæºå¨ä¸å­å¨çé½æ¯å¨éæ°æ®ãä½æ¯ï¼åæºçæ°æ®å­å¨éæ»æ¯æä¸éçï¼å½æ°æ®éä¸åä¸º tb çº§çè³ pb çº§æ°æ®ï¼åæºç»ç©¶ææ æ³æ¯æçæ¶åãè¿æ¶ï¼å°±éè¦å¯¹æ°æ®è¿è¡åçï¼shardingï¼ã\n\nåçåçèç¹å¯ä»¥è§ä¸ºä¸ä¸ªç¬ç«çå­éï¼éå¯¹å­éï¼ä»»ç¶éè¦ä¿è¯é«å¯ç¨ã\n\n\n\n\n# 4. é«å¯ç¨çåºç¨\n\nåºç¨å±ä¸»è¦å¤çç½ç«åºç¨çä¸å¡é»è¾ï¼ä¸ä¸ªæ¾èçç¹ç¹æ¯åºç¨ç æ ç¶æ æ§ã\n\næè°ç æ ç¶æ çåºç¨æ¯æåºç¨æå¡å¨ä¸ä¿å­ä¸å¡çä¸ä¸æä¿¡æ¯ï¼èä»æ ¹æ®æ¯æ¬¡è¯·æ±æäº¤çæ°æ®è¿è¡ç¸åºçä¸å¡é»è¾å¤çï¼å¤ä¸ªæå¡å®ä¾ä¹é´å®å¨å¯¹ç­ï¼è¯·æ±æäº¤å°ä»»ææå¡å¨ï¼å¤çç»æé½æ¯å®å¨ä¸æ ·çã\n\nç±äºæ ç¶æåºç¨ï¼åå®ä¾ä¹é´ä¸ç¨èèæ°æ®ä¸è´æ§é®é¢ï¼æä»¥å¶é«å¯ç¨æ¹æ¡ç¸å¯¹ç®åãä¸»è¦ææ®µæ¯ï¼\n\n * è´è½½åè¡¡\n * åå¸å¼ session\n\n\n# 4.1. è´è½½åè¡¡\n\nè´è½½åè¡¡ï¼é¡¾åæä¹ï¼ä¸»è¦ä½¿ç¨å¨ä¸å¡éåæ°æ®éè¾é«çæåµä¸ï¼å½åå°æå¡å¨ä¸è¶³ä»¥æ¿æææçè´è½½ååæ¶ï¼éè¿è´è½½åè¡¡ææ®µï¼å°æµéåæ°æ®åæå°ä¸ä¸ªéç¾¤ç»æçå¤å°æå¡å¨ä¸ï¼ä»¥æé«æ´ä½çè´è½½å¤çè½åã\n\næ ç¶æåºç¨çå¤±æè½¬ç§»å¯ä»¥å©ç¨è´è½½åè¡¡æ¥å®ç°ã\n\næ ç¶æçåºç¨å®ç°é«å¯ç¨æ¶æååç®åï¼ç±äºæå¡å¨ä¸ä¿å­è¯·æ±ç¶æï¼é£ä¹æææå¡å¨å®å¨å¯¹ç­ï¼å¨ä»»æèç¹æ§è¡åæ ·çè¯·æ±ï¼ç»ææ»æ¯ä¸è´çãè¿ç§æåµä¸ï¼æç®åçé«å¯ç¨æ¹æ¡å°±æ¯ä½¿ç¨è´è½½åè¡¡ã\n\n> è´è½½åè¡¡åçå¯ä»¥åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 4.2. åå¸å¼ session\n\nåºç¨æå¡å¨çé«å¯ç¨æ¶æè®¾è®¡ä¸»è¦åºäºæå¡æ ç¶æè¿ä¸ç¹æ§ãäºå®ä¸ï¼ä¸å¡æ»æ¯æç¶æçï¼å¦è´­ç©è½¦è®°å½ç¨æ·çè´­ä¹°ä¿¡æ¯ï¼ç¨æ·çç»å½ç¶æï¼ææ°åå¸çæ¶æ¯ç­ç­ã\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nä¸ºäºè§£å³åå¸å¼ session é®é¢ï¼å¸¸è§çè§£å³æ¹æ¡æï¼\n\n * ç²æ§ session\n * åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n * åºäºç¼å­ç session å±äº« â\n\n> åå¸å¼ä¼è¯åçå¯ä»¥åèï¼åå¸å¼ä¼è¯åºæ¬åç\n\n\n# 5. é«å¯ç¨çæå¡\n\nå¯å¤ç¨çæå¡ä¸ºä¸å¡äº§åæä¾åºç¡å¬å±æå¡ï¼å¤§åç³»ç»ä¸­è¿äºæå¡éå¸¸é½ç¬ç«åå¸å¼é¨ç½²ï¼è¢«å·ä½åºç¨è¿ç¨è°ç¨ãå¯å¤ç¨çæå¡ååºç¨ä¸æ ·ï¼ä¸è¬ä¹æ¯æ ç¶æçæå¡ï¼å æ­¤ï¼åæ ·å¯ä»¥ä½¿ç¨è´è½½åè¡¡çå¤±æè½¬ç§»ç­ç¥æ¥å®ç°é«å¯ç¨ã\n\né¤æ­¤ä»¥å¤ï¼è¿æä»¥ä¸ææ®µæ¥ä¿è¯æå¡çé«å¯ç¨ï¼\n\n * åçº§ç®¡ç\n * è¶æ¶éè¯\n * å¼æ­¥è°ç¨\n * è¿è½½ä¿æ¤\n   * éæµ\n   * éçº§\n   * æ­è·¯\n * å¹ç­æ§è®¾è®¡\n\n\n# 5.1. åçº§ç®¡ç\n\nå°æå¡æ ¹æ®ä¸å¡éè¦æ§è¿è¡åçº§ç®¡çï¼æ ¸å¿åºç¨åæå¡ä¼åä½¿ç¨æ´å¥½çç¡¬ä»¶ï¼å¨è¿ç»´ååºéåº¦ä¸ä¹æ ¼å¤è¿éã\n\nå¨æå¡é¨ç½²ä¸è¿è¡å¿è¦çéç¦»ï¼é¿åæéçè¿éååºãä½ä¼åçº§çæå¡éè¿å¯å¨ä¸åççº¿ç¨æé¨ç½²å¨ä¸åçèææºä¸è¿è¡éç¦»ï¼èé«ä¼åçº§çæå¡åéè¦é¨ç½²å¨ä¸åçç©çæºä¸ï¼æ ¸å¿æå¡åæ°æ®çè³è¦é¨ç½²å¨ä¸åå°åçæ°æ®ä¸­å¿ã\n\n\n# 5.2. è¶æ¶éè¯\n\nç±äºæå¡å¨å®æºãçº¿ç¨æ­»éç­åå ï¼å¯è½å¯¼è´åºç¨ç¨åºå¯¹æå¡ç«¯çè°ç¨å¤±å»ååºãæä»¥æå¿è¦å¼å¥è¶æ¶æºå¶ï¼ä¸æ¦è°ç¨è¶æ¶ï¼æå¡åæ¡æ¶æåºå¼å¸¸ï¼åºç¨ç¨åºæ ¹æ®æå¡è°åº¦ç­ç¥ï¼éæ©éè¯æè¯·æ±è½¬ç§»å°å¶ä»æºå¨ä¸ã\n\n\n# 5.3. å¼æ­¥è°ç¨\n\nå¯¹äºéè¦å³æ¶ååºçä¸å¡ï¼åºç¨å¨è°ç¨æå¡æ¶å¯ä»¥éè¿æ¶æ¯éåç­å¼æ­¥æ¹å¼å®æï¼é¿åä¸ä¸ªæå¡å¤±è´¥å¯¼è´æ´ä¸ªåºç¨è¯·æ±å¤±è´¥çæåµãå½ç¶ä¸æ¯æææå¡è°ç¨é½å¯ä»¥å¼æ­¥è°ç¨ï¼å¯¹äºè·åç¨æ·ä¿¡æ¯è¿ç±»è°ç¨ï¼éç¨å¼æ­¥æ¹å¼ä¼å»¶é¿ååºæ¶é´ï¼å¾ä¸å¿å¤±ï¼æ­¤å¤ï¼å¯¹äºé£äºå¿é¡»ç¡®è®¤æå¡è°ç¨æè½ç»§ç»­ä¸ä¸æ­¥æä½çåºç¨ä¹ä¸éå®é£ç¨å¼æ­¥è°ç¨ã\n\n\n# 5.4. è¿è½½ä¿æ¤\n\nè¿è½½ä¿æ¤çææ®µï¼ä¸è¬æï¼éæµãéçº§ãçæ­ã\n\n# éæµ\n\néçº§æ¯ä»ç³»ç»åè½ä¼åçº§çè§åº¦èèå¦ä½åºå¯¹æéï¼èéæµåæ¯ä»ç¨æ·è®¿é®ååçè§åº¦æ¥èèå¦ä½åºå¯¹æéãéæµæåªåè®¸ç³»ç»è½å¤æ¿åçè®¿é®éè¿æ¥ï¼è¶åºç³»ç»è®¿é®è½åçè¯·æ±å°è¢«ä¸¢å¼ã\n\nå¸¸è§çéæµæ¹å¼å¯ä»¥åä¸ºä¸¤ç±»ï¼åºäºè¯·æ±éæµååºäºèµæºéæµã\n\n# åºäºè¯·æ±éæµ\n\nåºäºè¯·æ±éæµæä»å¤é¨è®¿é®çè¯·æ±è§åº¦èèéæµï¼å¸¸è§çæ¹å¼æï¼éå¶æ»éãéå¶æ¶é´éã\n\néå¶æ»éçæ¹å¼æ¯éå¶æä¸ªææ çç´¯ç§¯ä¸éï¼å¸¸è§çæ¯éå¶å½åç³»ç»æå¡çç¨æ·æ»éï¼ä¾å¦æä¸ªç´æ­é´éå¶æ»ç¨æ·æ°ä¸éä¸º 100 ä¸ï¼è¶è¿ 100 ä¸åæ°çç¨æ·æ æ³è¿å¥ï¼æä¸ªæ¢è´­æ´»å¨ååæ°éåªæ 100 ä¸ªï¼éå¶åä¸æ¢è´­çç¨æ·ä¸éä¸º 1 ä¸ä¸ªï¼1 ä¸ä»¥åçç¨æ·ç´æ¥æç»ãéå¶æ¶é´éæéå¶ä¸æ®µæ¶é´åæä¸ªææ çä¸éï¼ä¾å¦ï¼1 åéååªåè®¸ 10000 ä¸ªç¨æ·è®¿é®ï¼æ¯ç§è¯·æ±å³°å¼æé«ä¸º 10 ä¸ã\n\næ è®ºæ¯éå¶æ»éè¿æ¯éå¶æ¶é´éï¼å±åçç¹ç¹é½æ¯å®ç°ç®åï¼ä½å¨å®è·µä¸­é¢ä¸´çä¸»è¦é®é¢æ¯æ¯è¾é¾ä»¥æ¾å°åéçéå¼ã\n\n# åºäºèµæºéæµ\n\nåºäºè¯·æ±éæµæ¯ä»ç³»ç»å¤é¨èèçï¼èåºäºèµæºéæµæ¯ä»ç³»ç»åé¨èèçï¼å³ï¼æ¾å°ç³»ç»åé¨å½±åæ§è½çå³é®èµæºï¼å¯¹å¶ä½¿ç¨ä¸éè¿è¡éå¶ãå¸¸è§çåé¨èµæºæï¼è¿æ¥æ°ãæä»¶å¥æãçº¿ç¨æ°ãè¯·æ±éåç­ã\n\nåºäºèµæºéæµç¸æ¯åºäºè¯·æ±éæµè½å¤æ´å ææå°åæ å½åç³»ç»çååï¼ä½å®è·µä¸­è®¾è®¡ä¹é¢ä¸´ä¸¤ä¸ªä¸»è¦çé¾ç¹ï¼å¦ä½ç¡®å®å³é®èµæºï¼å¦ä½ç¡®å®å³é®èµæºçéå¼ã\n\n# éçº§\n\néçº§æç³»ç»å°æäºä¸å¡æèæ¥å£çåè½éä½ï¼å¯ä»¥æ¯åªæä¾é¨ååè½ï¼ä¹å¯ä»¥æ¯å®å¨åæææåè½ã\n\nå¨æå¡è®¿é®çé«å³°æï¼æå¡å¯è½å ä¸ºå¤§éå¹¶åè°ç¨èæ§è½ä¸éï¼ä¸¥éæ¶å¯è½ä¼å¯¼è´å®æºãä¸ºäºä¿è¯æ ¸å¿åè½çæ­£å¸¸è¿è¡ï¼éè¦å¯¹æå¡è¿è¡éçº§ãéçº§æä¸¤ç§ææ®µï¼\n\næç»æå¡ - æç»ä½ä¼åçº§åºç¨çè°ç¨ï¼åå°æå¡è°ç¨å¹¶åæ°ï¼ç¡®ä¿æ ¸å¿åºç¨æ­£å¸¸ä½¿ç¨ãæèéæºæç»é¨åè°ç¨ï¼èçº¦èµæºï¼é¿åè¦æ­»å¤§å®¶ä¸èµ·æ­»çæ¨å§ã\n\nå³é­æå¡ - å³é­é¨åä¸éè¦çæå¡ï¼æèæå¡åé¨å³é­é¨åä¸éè¦çåè½ï¼ä»¥èçº¦èµæºã\n\n# çæ­\n\nçæ­åéçº§æ¯ä¸¤ä¸ªæ¯è¾å®¹ææ··æ·çæ¦å¿µï¼å ä¸ºåçº¯ä»åå­ä¸çå¥½åé½æç¦æ­¢æä¸ªåè½çææï¼ä½å¶å®åå¨å«ä¹æ¯ä¸åçï¼åå å¨äºéçº§çç®çæ¯åºå¯¹ç³»ç»èªèº«çæéï¼èçæ­çç®çæ¯åºå¯¹ä¾èµçå¤é¨ç³»ç»æéçæåµã\n\nçæ­æºå¶å®ç°çå³é®æ¯éè¦æä¸ä¸ªç»ä¸ç api è°ç¨å±ï¼ç± api è°ç¨å±æ¥è¿è¡éæ ·æèç»è®¡ï¼å¦ææ¥å£è°ç¨æ£è½å¨ä»£ç åå¤å°±æ²¡æ³è¿è¡ç»ä¸å¤çäºã\n\n\n# 5.5. å¹ç­æ§è®¾è®¡\n\næå¡è°ç¨å¤±è´¥åï¼è°ç¨æ¹ä¼å°è¯·æ±è½¬åå°å¶ä»æå¡å¨ä¸ï¼ä½æ¯è¿ä¸ªå¤±è´¥å¯è½æ¯èåçå¤±è´¥ãæ¯å¦æå¡å·²ç»å¤çæåï¼ä½å ä¸ºç½ç»æéå¯¼è´è°ç¨æ¹æ²¡ææ¶å°åºç­ï¼æç­å¾è¶æ¶ãè¿ç§æåµä¸ï¼éæ°åèµ·è¯·æ±ï¼å¯è½ä¼å¯¼è´éå¤æä½ï¼å¦ï¼åæ°æ®åºåå¥ä¸¤æ¡è®°å½ãå¦æè¿ä¸ªæä½æ¯æ¯è¾ææçäº¤ææä½ï¼å°±ä¼äº§çä¸¥éåæã\n\næå¡éå¤è°ç¨æ¶æ æ³é¿åçï¼ä½æ¯åªè¦è½ä»ä¸å¡å®ç°ä¸ä¿è¯ï¼éå¤è°ç¨åä¸æ¬¡è°ç¨çå¤çç»æä¸è´ï¼åä¸å¡å°±æ²¡æé®é¢ï¼è¿å°±æ¯å¹ç­æ§è®¾è®¡ã\n\næäºæå¡çä¸å¡å¤©ç¶å·æå¹ç­æ§ï¼æ¯å¦å°ç¨æ·æ§å«è®¾ä¸ºç·æ§ï¼ä¸ç®¡æ§è¡å¤å°æ¬¡ï¼ç»ææ¯ä¸è´çãä½æäºå¤æçä¸å¡ï¼è¦æ³ä¿è¯å¹ç­æ§ï¼å°±éè¦æ ¹æ®å¨å±æ§ç id å»è¿è¡æææ§éªè¯ï¼éªè¯éè¿æè½ç»§ç»­æ§è¡ã\n\n\n# 6. é«å¯ç¨çå­å¨\n\nå¯¹äºç»å¤§é¨åè½¯ä»¶ç³»ç»èè¨ï¼æ°æ®é½æ¯æå®è´µçèæèµäº§ï¼ä¸æ¦ä¸¢å¤±ï¼å¯ä»¥è¯´æ¯æ¯ç­æ§çæå»ã\n\nä¿è¯å­å¨é«å¯ç¨çä¸»è¦ææ®µæ¯ï¼æ°æ®å¤ä»½åå¤±æè½¬ç§»ã\n\nå­å¨é«å¯ç¨æ¶æçå¤ææ§ä¸»è¦ä½ç°å¨ï¼å¦ä½åºå¯¹å¯æ¬åæ­¥å»¶è¿åä¸­æ­å¯¼è´çæ°æ®ä¸è´æ§é®é¢ã\n\n> æç¤ºï¼åå¼å§å­¦ä¹ è¿é¨ååå®¹åï¼å»ºè®®åå­¦ä¹  äºãé«å¯ç¨æ¶æçè®º\n\n\n# 6.1. æ°æ®å¤ä»½\n\næ°æ®å¤ä»½æ¯ä¿è¯æ°æ®æå¤ä¸ªå¯æ¬ï¼ä»»æå¯æ¬çä¸¢å¤±é½ä¸ä¼å¯¼è´æ°æ®çæ°¸ä¹ä¸¢å¤±ã\n\n * å·å¤ä»½ - å®æå°æ°æ®å¤å¶å°æç§å­å¨ä»è´¨ã\n * ç­å¤ä»½\n   * å¼æ­¥ç­å¤æ¹å¼ - å¼æ­¥ç­å¤æ¹å¼æ¯æå¤ä»½æ°æ®å¯æ¬çåå¥æä½å¼æ­¥å®æï¼åºç¨ç¨åºæ¶å°æ°æ®æå¡ç³»ç»çåæä½æåååºæ¶ï¼åªåæåäºä¸ä»½ï¼å­å¨ç³»ç»å°ä¼å¼æ­¥å°åå¶ä»å¯æ¬ã\n   * åæ­¥ç­å¤æ¹å¼ - åæ­¥ç­å¤æ¹å¼æ¯æå¤ä»½æ°æ®å¯æ¬çåå¥æä½åæ­¥å®æï¼å³åºç¨ç¨åºæ¶å°æ°æ®æå¡ç³»ç»çåæåååºæ¶ï¼å¤ä»½æ°æ®é½å·²ç»åæä½æåãä½æ¯å½åºç¨ç¨åºæ¶å°æ°æ®åæä½å¤±è´¥çååºå¼ï¼å¯è½æé¨åå¯æ¬æèå¨é¨å¯æ¬é½å·²ç»åå¥æåäºï¼å ä¸ºç½ç»æèç³»ç»æéï¼æ æ³è¿åæä½æåçååºï¼ã\n\n\n# 6.2. å¤±æè½¬ç§»\n\nå¤±æè½¬ç§»æ¯ä¿è¯ä»»æä¸ä¸ªå¯æ¬ä¸å¯è®¿é®æ¶ï¼å¯ä»¥å¿«éåæ¢è®¿é®å¶ä»å¯æ¬ï¼ä¿è¯ç³»ç»æ´ä½å¯ç¨ã\n\n# å¤±æç¡®è®¤\n\n\n\nå¤æ­æå¡å¨å®æºçææ®µæä¸¤ç§ï¼å¿è·³æ£æµåè®¿é®å¤±è´¥æ¥åã\n\nå¯¹äºåºç¨ç¨åºçè®¿é®å¤±è´¥æ¥åï¼æ§å¶ä¸­å¿è¿éè¦åä¸æ¬¡åéå¿è·³æ£æµè¿è¡ç¡®è®¤ï¼ä»¥åéè¯¯å¤æ­æå¡å¨å®æºãå ä¸ºä¸æ¦è¿è¡æ°æ®è®¿é®çå¤±æè½¬ç§»ï¼æå³çæ°æ®å­å¨å¤ä»½å¯æ¬ä¸ä¸è´ï¼éè¦è¿è¡åç»­ä¸ç³»åçå¤æå¨ä½ã\n\n# è®¿é®è½¬ç§»\n\nç¡®è®¤æå°æ°æ®æå¡å¨å®æºåï¼å°±éè¦å°æ°æ®è¯»åè®¿é®éæ°è·¯ç±å°å¶ä»æå¡å¨ä¸ãå¯¹äºå®å¨å¯¹ç­å­å¨çæå¡å¨ï¼å½å¶ä¸­ä¸å°å®æºåï¼åºç¨ç¨åºæ ¹æ®éç½®ç´æ¥åæ¢å°å¯¹ç­æå¡å¨ä¸ãå¦æå­å¨ä¸å¯¹ç­ï¼å°±éè¦éæ°è®¡ç®è·¯ç±ï¼éæ©å­å¨æå¡å¨ã\n\n# æ°æ®æ¢å¤\n\nå ä¸ºæå°æå¡å¨å®æºï¼æä»¥æ°æ®å­å¨çå¯æ¬æ°ç®ä¼åå°ï¼å¿é¡»å°å¯æ¬çæ°ç®æ¢å¤å°ç³»ç»è®¾å®çå¼ï¼å¦åï¼åææå¡å¨å®æºæ¶ï¼å°±å¯è½åºç°æ æ³è®¿é®è½¬ç§»ï¼æ°æ®æ°¸ä¹ä¸¢å¤±çæåµãå æ­¤ç³»ç»éè¦ä»å¥åº·çæå¡å¨å¤å¶æ°æ®ï¼å°æ°æ®å¯æ¬æ°ç®æ¢å¤å°è®¾å®å¼ã\n\n\n# 7. è¾å©ææ®µ\n\n\n# 7.1. å¼å°å¤æ´»\n\nå¼å°å¤æ´»æ¶æçå³é®ç¹å°±æ¯å¼å°ãå¤æ´»ï¼å¶ä¸­å¼å°å°±æ¯æå°çä½ç½®ä¸ä¸åçå°æ¹ï¼ç±»ä¼¼äºâä¸è¦æé¸¡èé½æ¾å¨åä¸ç¯®å­éâï¼å¤æ´»å°±æ¯æä¸åå°çä½ç½®ä¸çç³»ç»é½è½å¤æä¾ä¸å¡æå¡ï¼è¿éçâæ´»âæ¯æ´»å¨ãæ´»è·çææã\n\nå¼å°å¤æ´»æ¶æå¯ä»¥åä¸ºååå¼åºãè·¨åå¼å°ãè·¨å½å¼å°ã\n\nå¼å°å¤æ´»æ¶æçä»£ä»·ï¼\n\n * ç³»ç»å¤æåº¦ä¼åçè´¨çååï¼éè¦è®¾è®¡å¤æçå¼å°å¤æ´»æ¶æã\n * ææ¬ä¼ä¸åï¼æ¯ç«è¦å¤å¨ä¸ä¸ªæèå¤ä¸ªæºæ¿æ­å»ºç¬ç«çä¸å¥ä¸å¡ç³»ç»ã\n\nå¼å°å¤æ´»çè®¾è®¡ååï¼\n\n * ä¿è¯æ ¸å¿ä¸å¡çå¼å°å¤æ´»\n * ä¿è¯æ ¸å¿æ°æ®æç»ä¸è´æ§\n * éç¨å¤ç§ææ®µåæ­¥æ°æ®\n * åªä¿è¯ç»å¤§é¨åç¨æ·çå¼å°å¤æ´»\n\nå¼å°å¤æ´»è®¾è®¡æ­¥éª¤ï¼\n\n * ä¸å¡åçº§ - å¸¸è§çåçº§æ åæï¼\n   * æµéå¤§çä¸å¡\n   * æ ¸å¿ä¸å¡\n   * çå©ä¸å¡\n * æ°æ®åç±» - å¸¸è§çæ°æ®åæç»´åº¦æï¼\n   * æ°æ®é\n   * å¯ä¸æ§\n   * å®æ¶æ§\n   * å¯ä¸¢å®æ§\n   * å¯æ¢å¤æ§\n * æ°æ®åæ­¥ - å¸¸è§çæ°æ®åæ­¥æ¹æ¡\n   * å­å¨ç³»ç»åæ­¥\n   * æ¶æ¯éååæ­¥\n   * éå¤çæ\n * å¼å¸¸å¤ç - å¸¸è§å¼å¸¸å¤çæªæ½ï¼\n   * å¤ééåæ­¥\n   * åæ­¥åè®¿é®ç»å\n   * æ¥å¿è®°å½\n   * ç¨æ·è¡¥å¿\n\n\n# 7.2. åå¸æµç¨\n\né«å¯ç¨çè½¯ä»¶è´¨éä¿è¯çææ®µï¼\n\n * èªå¨åæµè¯\n * é¢åå¸éªè¯\n * ä»£ç æ§å¶\n * èªå¨ååå¸\n * ç°åº¦åå¸\n\n\n# 7.3. ç³»ç»çæ§\n\n> ä¸åè®¸æ²¡æçæ§çç³»ç»ä¸çº¿ã\n\n * çæ§æ°æ®éé\n   * ç¨æ·è¡ä¸ºæ¥å¿æ¶é\n     * æå¡ç«¯æ¥å¿æ¶é - apacheãnginx ç­å ä¹ææ web æå¡å¨é½å·å¤æ¥å¿è®°å½åè½ï¼åªè¦å¼å¯æ¥å¿è®°å½å³å¯ãå¦ææ¯æå¡å¨æ¯è¾å¤ï¼éè¦éä¸­ééæ¥å¿ï¼éå¸¸ä¼ä½¿ç¨ elastic æ¥è¿è¡æ¶éã\n     * å®¢æ·ç«¯æ¥å¿æ¶é - å©ç¨é¡µé¢åµå¥ä¸é¨ç javascript èæ¬å¯ä»¥æ¶éç¨æ·çå®çæä½è¡ä¸ºã\n     * æ¥å¿åæ - å¯ä»¥å©ç¨ elasticsearch åè¯­ä¹åæåæç´¢ï¼å©ç¨å®æ¶è®¡ç®æ¡æ¶ stormãflink ç­å¼åæ¥å¿ç»è®¡ä¸åæå·¥å·ã\n   * æå¡å¨æ§è½çæ§ - æ¶éæå¡å¨æ§è½ææ ï¼å¦ç³»ç»è´è½½ãåå­å ç¨ãcpu å ç¨ãç£ç ioãç½ç» io ç­ãå¸¸ç¨ççæ§å·¥å·æï¼apache skywalking ãpinpoint ç­ã\n   * è¿è¡æ°æ®æ¥å - åºè¯¥çæ§ä¸äºä¸å·ä½ä¸å¡åºæ¯ç¸å³çææ¯åä¸å¡ææ ï¼å¦ï¼ç¼å­å½ä¸­çãå¹³åååºæ¶å»¶ãtpsãqps ç­ã\n * çæ§ç®¡ç\n   * ç³»ç»æ¥è­¦ - è®¾ç½®éå¼ãå½è¾¾å°éå¼ï¼åæ¶è§¦ååè­¦ï¼ç­ä¿¡ãé®ä»¶ãéä¿¡å·¥å·åå¯ï¼ï¼éè¿åæ¶å¤æ­ç¶åµï¼é²æ£äºæªç¶ã\n   * å¤±æè½¬ç§» - çæ§ç³»ç»å¯ä»¥å¨åç°æéçæåµä¸ä¸»å¨éç¥åºç¨è¿è¡å¤±æè½¬ç§»ã\n   * èªå¨ä¼ééçº§\n     * ä¼ééçº§æ¯ä¸ºäºåºä»çªç¶çåçè®¿é®é«å³°ï¼ä¸»å¨å³é­é¨ååè½ï¼éæ¾é¨åèµæºï¼ä»¥ä¿è¯æ ¸å¿åè½çä¼åè®¿é®ã\n     * ç³»ç»å¨çæ§ç®¡çåºç¡ä¹ä¸å®ç°èªå¨ä¼ééçº§ï¼æ¯ææ§æ¶æççæ³ç¶æã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n * å·¦è³å¬é£",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»ä¼¸ç¼©æ§æ¶æ",frontmatter:{title:"ç³»ç»ä¼¸ç¼©æ§æ¶æ",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","ä¼¸ç¼©æ§"],permalink:"/pages/ed2a88/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/05.%E7%B3%BB%E7%BB%9F%E4%BC%B8%E7%BC%A9%E6%80%A7%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/05.ç³»ç»ä¼¸ç¼©æ§æ¶æ.md",key:"v-6097cc9c",path:"/pages/ed2a88/",headers:[{level:2,title:"1. ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡",slug:"_1-ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"1. ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡",charIndex:69},{level:3,title:"1.1. ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼©",slug:"_1-1-ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼©",normalizedTitle:"1.1. ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼©",charIndex:87},{level:3,title:"1.2. åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼©",slug:"_1-2-åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼©",normalizedTitle:"1.2. åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼©",charIndex:197},{level:2,title:"2. åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡",slug:"_2-åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"2. åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡",charIndex:333},{level:3,title:"2.1. HTTP éå®åè´è½½åè¡¡",slug:"_2-1-http-éå®åè´è½½åè¡¡",normalizedTitle:"2.1. http éå®åè´è½½åè¡¡",charIndex:457},{level:3,title:"2.2. DNS ååè§£æè´è½½åè¡¡",slug:"_2-2-dns-ååè§£æè´è½½åè¡¡",normalizedTitle:"2.2. dns ååè§£æè´è½½åè¡¡",charIndex:631},{level:3,title:"2.3. ååä»£çè´è½½åè¡¡",slug:"_2-3-ååä»£çè´è½½åè¡¡",normalizedTitle:"2.3. ååä»£çè´è½½åè¡¡",charIndex:1164},{level:3,title:"2.4. IP è´è½½åè¡¡",slug:"_2-4-ip-è´è½½åè¡¡",normalizedTitle:"2.4. ip è´è½½åè¡¡",charIndex:1265},{level:3,title:"2.5. æ°æ®é¾è·¯å±è´è½½åè¡¡",slug:"_2-5-æ°æ®é¾è·¯å±è´è½½åè¡¡",normalizedTitle:"2.5. æ°æ®é¾è·¯å±è´è½½åè¡¡",charIndex:1571},{level:3,title:"2.6. è´è½½åè¡¡ç®æ³",slug:"_2-6-è´è½½åè¡¡ç®æ³",normalizedTitle:"2.6. è´è½½åè¡¡ç®æ³",charIndex:1914},{level:2,title:"3. åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡",slug:"_3-åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"3. åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡",charIndex:2512},{level:2,title:"4. æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡",slug:"_4-æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"4. æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡",charIndex:2566},{level:3,title:"4.1. å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",slug:"_4-1-å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"4.1. å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",charIndex:2588},{level:3,title:"4.2. NoSql æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",slug:"_4-2-nosql-æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",normalizedTitle:"4.2. nosql æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡",charIndex:2714},{level:2,title:"5. åèèµæ",slug:"_5-åèèµæ",normalizedTitle:"5. åèèµæ",charIndex:2785}],headersStr:"1. ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡ 1.1. ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼© 1.2. åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼© 2. åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡ 2.1. HTTP éå®åè´è½½åè¡¡ 2.2. DNS ååè§£æè´è½½åè¡¡ 2.3. ååä»£çè´è½½åè¡¡ 2.4. IP è´è½½åè¡¡ 2.5. æ°æ®é¾è·¯å±è´è½½åè¡¡ 2.6. è´è½½åè¡¡ç®æ³ 3. åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡ 4. æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡ 4.1. å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡ 4.2. NoSql æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡ 5. åèèµæ",content:"# ç³»ç»ä¼¸ç¼©æ§æ¶æ\n\n> ä¼¸ç¼©æ§æ¶ææ¯æä¸éè¦æ¹åç³»ç»çè½¯ç¡¬ä»¶è®¾è®¡ï¼ä»éè¿æ¹åé¨ç½²æå¡å¨æ°éå°±å¯ä»¥æ©å¤§æç¼©å°ç³»ç»çæå¡å¤çè½åã\n\n\n# 1. ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡\n\n\n# 1.1. ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼©\n\n * çºµååç¦»ï¼åå±ååç¦»ï¼ - å°ä¸å¡å¤çæµç¨ä¸çä¸åé¨ååç¦»é¨ç½²ï¼å®ç°ç³»ç»ä¼¸ç¼©æ§ã\n * æ¨ªååç¦»ï¼ä¸å¡åå²ååç¦»ï¼ - å°ä¸åçä¸å¡æ¨¡ååç¦»é¨ç½²ï¼å®ç°ç³»ç»ä¼¸ç¼©æ§ã\n\n\n# 1.2. åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼©\n\nå°ä¸ååè½åç¦»é¨ç½²å¯ä»¥å®ç°ä¸å®ç¨åº¦çä¼¸ç¼©æ§ï¼ä½æ¯éçè®¿é®ééæ­¥å¢å ï¼å³ä½¿åç¦»å°æå°ç²åº¦çç¬ç«é¨ç½²ï¼åä¸çæå¡å¨ä¹ä¸è½æ»¡è¶³ä¸å¡è§æ¨¡çè¦æ±ãå æ­¤å¿é¡»ä½¿ç¨æå¡å¨éç¾¤ï¼å³å°ç¸åæå¡é¨ç½²å¨å¤ææå¡å¨ä¸ææä¸ä¸ªéç¾¤æ´ä½å¯¹å¤æä¾æå¡ã\n\n\n# 2. åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\nå¦æ HTTP è¯·æ±ååè£ç½®å¯ä»¥æç¥æèå¯ä»¥éç½®éç¾¤çæå¡å¨æ°éï¼å¯ä»¥åæ¶åç°éç¾¤ä¸­æ°ä¸çº¿æä¸çº¿çæå¡å¨ï¼å¹¶è½åæ°ä¸çº¿çæå¡å¨ååè¯·æ±ï¼åæ­¢åå·²ä¸çº¿çæå¡å¨ååè¯·æ±ï¼é£ä¹å°±å®ç°äºåºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§ã\n\n\n# 2.1. HTTP éå®åè´è½½åè¡¡\n\n\n\nå©ç¨ HTTP éå®ååè®®å®ç°è´è½½åè¡¡ã\n\nè¿ç§è´è½½åè¡¡æ¹æ¡çä¼ç¹æ¯æ¯è¾ç®åã\n\nç¼ºç¹æ¯æµè§å¨éè¦ä¸¤æ¬¡è¯·æ±æå¡å¨æè½å®æä¸æ¬¡è®¿é®ï¼æ§è½è¾å·®ï¼éå®åæå¡å¨èªèº«çå¤çè½åæå¯è½æä¸ºç¶é¢ï¼æ´ä¸ªéç¾¤çä¼¸ç¼©æ§è§æ¨¡æéï¼ä½¿ç¨ HTTP 302 ååºç éå®åï¼å¯è½ä½¿æç´¢å¼æå¤æ­ä¸º SEO ä½å¼ï¼éä½æç´¢æåã\n\n\n# 2.2. DNS ååè§£æè´è½½åè¡¡\n\nå©ç¨ DNS å¤çååè§£æè¯·æ±çåæ¶è¿è¡è´è½½åè¡¡å¤ççä¸ç§æ¹æ¡ã\n\n\n\nå¨ DNS æå¡å¨ä¸­éç½®å¤ä¸ª A è®°å½ï¼å¦ï¼\n\n114.100.40.1 www.mysite.com\n114.100.40.2 www.mysite.com\n114.100.40.3 www.mysite.com\n\n\næ¯æ¬¡ååè§£æè¯·æ±é½ä¼æ ¹æ®è´è½½åè¡¡ç®æ³è®¡ç®ä¸ä¸ªä¸åç IP å°åè¿åï¼è¿æ · A è®°å½ä¸­éç½®çå¤ä¸ªæå¡å¨å°±ææä¸ä¸ªéç¾¤ï¼å¹¶å¯ä»¥å®ç°è´è½½åè¡¡ã\n\nDNS ååè§£æè´è½½åè¡¡çä¼ç¹ï¼\n\n * å°è´è½½åè¡¡çå·¥ä½è½¬äº¤ç»äº DNSï¼çæäºç½ç«ç®¡çç»´æ¤çéº»ç¦ã\n * åæ¶ï¼è®¸å¤ DNS æå¡å¨è¿æ¯æåºäºå°çä½ç½®çååè§£æï¼å³å°ååè§£ææè·ç¦»ç¨æ·å°çæè¿çä¸ä¸ªæå¡å¨å°åï¼è¿æ ·å¯ä»¥å å¿«ç¨æ·è®¿é®éåº¦ï¼æ¹åæ§è½ã\n\nDNS ååè§£æè´è½½åè¡¡çç¼ºç¹ï¼\n\n * DNS æ¯å¤çº§è§£æï¼æ¯ä¸çº§ DNS é½å¯è½ç¼å­ A è®°å½ï¼å½æå°æå¡å¨ä¸çº¿åï¼å³ä½¿ä¿®æ¹äº DNS ç A è®°å½ï¼è¦ä½¿å¶çæä¹éè¦è¾é¿æ¶é´ãè¿æ®µæ¶é´ï¼ä¾ç¶ä¼ååè§£æå°å·²ç»ä¸çº¿çæå¡å¨ï¼å¯¼è´ç¨æ·è®¿é®å¤±è´¥ã\n * DNS çè´è½½åè¡¡çæ§å¶æå¨ååæå¡åé£éï¼ç½ç«æ æ³å¯¹å¶åæ´å¤æ¹ååæ´å¼ºå¤§çç®¡çã\n\n\n# 2.3. ååä»£çè´è½½åè¡¡\n\nå¤§å¤æ°ååä»£çæå¡å¨åæ¶æä¾ååä»£çåè´è½½åè¡¡çåè½ã\n\n\n\nååä»£çæå¡å¨çä¼ç¹æ¯é¨ç½²ç®åãç¼ºç¹æ¯ååä»£çæå¡å¨æ¯ææè¯·æ±åååºçä¸­è½¬ç«ï¼å¶æ§è½å¯è½ä¼æä¸ºç¶é¢ã\n\n\n# 2.4. IP è´è½½åè¡¡\n\nå¨ç½ç»å±éè¿ä¿®æ¹è¯·æ±ç®æ å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nè´è½½åè¡¡æå¡å¨ï¼ç½å³æå¡å¨ï¼å¨æä½ç³»ç»åæ ¸è·åç½ç»æ°æ®åï¼æ ¹æ®è´è½½åè¡¡ç®æ³è®¡ç®å¾å°ä¸å°çå® Web æå¡å¨ 10.0.0.1ï¼ç¶åå°ç®ç IP å°åä¿®æ¹ä¸º 10.0.0.1ï¼ä¸éè¦éè¿ç¨æ·è¿ç¨ãçå® Web æå¡å¨å¤çå®æåï¼ååºæ°æ®ååå°è´è½½åè¡¡æå¡å¨ï¼è´è½½åè¡¡æå¡å¨åå°æ°æ®ååå°åä¿®æ¹ä¸ºèªèº«ç IP å°åï¼114.100.80.10ï¼åéç»æµè§å¨ã\n\nIP è´è½½åè¡¡å¨åæ ¸å®ææ°æ®ååï¼æä»¥å¤çæ§è½ä¼äºååä»£çè´è½½åè¡¡ãä½æ¯å ä¸ºææè¯·æ±ååºé½è¦ç»è¿è´è½½åè¡¡æå¡å¨ï¼éç¾¤çæå¤§ååºæ°æ®ååéåå¶äºè´è½½åè¡¡æå¡å¨ç½å¡å¸¦å®½ã\n\n\n# 2.5. æ°æ®é¾è·¯å±è´è½½åè¡¡\n\næ°æ®é¾è·¯å±è´è½½åè¡¡æ¯æå¨éä¿¡åè®®çæ°æ®é¾è·¯å±ä¿®æ¹ mac å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nè¿ç§æ¹å¼åç§°ä½ä¸è§ä¼ è¾æ¹å¼ï¼è´è½½åè¡¡æ°æ®ååè¿ç¨ä¸­ä¸ä¿®æ¹ IP å°åï¼åªä¿®æ¹ç®ç mac å°åï¼éè¿éç½®çå®ç©çæå¡å¨éç¾¤æææºå¨èæ IP åè´è½½åè¡¡æå¡å¨ IP å°åä¸è´ï¼ä»èè¾¾å°ä¸ä¿®æ¹æ°æ®åçæºå°ååç®çå°åå°±å¯ä»¥è¿è¡æ°æ®ååçç®çï¼ç±äºå®éå¤çè¯·æ±ççå®ç©çæå¡å¨ IP åæ°æ®è¯·æ±ç®ç IP ä¸è´ï¼ä¸éè¦éè¿è´è½½åè¡¡æå¡å¨è¿è¡å°åè½¬æ¢ï¼å¯å°ååºæ°æ®åç´æ¥è¿åç»ç¨æ·æµè§å¨ï¼é¿åè´è½½åè¡¡æå¡å¨ç½å¡å¸¦å®½æä¸ºç¶é¢ãè¿ç§è´è½½æ¹å¼åç§°ä½ç´æ¥è·¯ç±æ¹å¼ã\n\nå¨ Linux å¹³å°ä¸æå¥½çé¾è·¯å±è´è½½åè¡¡å¼æºäº§åæ¯ LVS(Linux Virtual Server)ã\n\n\n# 2.6. è´è½½åè¡¡ç®æ³\n\nè´è½½åè¡¡æå¡å¨çå®ç°å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\n 1. æ ¹æ®è´è½½åè¡¡ç®æ³å Web æå¡å¨åè¡¨è®¡ç®å¾å°éç¾¤ä¸­ä¸å° Web æå¡å¨çå°åã\n 2. å°è¯·æ±æ°æ®åéå°è¯¥å°åå¯¹åºç Web æå¡å¨ä¸ã\n\nè´è½½åè¡¡ç®æ³éå¸¸æä»¥ä¸å ç§ï¼\n\n * è½®è¯¢ï¼Round Robinï¼ - ææè¯·æ±è¢«ä¾æ¬¡ååå°æ¯å°åºç¨æå¡å¨ä¸ï¼å³æ¯å°æå¡å¨éè¦å¤ççè¯·æ±æ°æ®é½ç¸åï¼éåäºæææå¡å¨ç¡¬ä»¶é½ç¸åçåºæ¯ã\n * å æè½®è¯¢ï¼Weighted Round Robinï¼ - æ ¹æ®æå¡å¨ç¡¬ä»¶æ§è½æåµï¼å¨è½®è¯¢çåºç¡ä¸ï¼æç§éç½®æéå°è¯·æ±ååå°æ¯ä¸ªæå¡å¨ï¼é«æ§è½æå¡å¨è½åéæ´å¤è¯·æ±ã\n * éæºï¼Randomï¼ - è¯·æ±è¢«éæºåéå°åä¸ªåºç¨æå¡å¨ï¼å¨è®¸å¤åºåä¸ï¼è¿ç§æ¹æ¡é½å¾ç®åå®ç¨ï¼å ä¸ºå¥½çéæºæ°æ¬èº«å°±å¾å¹³åï¼å³ä½¿åºç¨æå¡å¨ç¡¬ä»¶éç½®ä¸åï¼ä¹å¯ä»¥ä½¿ç¨å æéæºç®æ³ã\n * æå°è¿æ¥ï¼Least Connectionï¼ - è®°å½æ¯ä¸ªåºç¨æå¡å¨æ­£å¨å¤ççè¿æ¥æ°ï¼å°æ°å°çè¯·æ±ååå°æå°è¿æ¥çæå¡å¨ä¸ï¼åºè¯¥è¯´ï¼è¿æ¯æç¬¦åè´è½½åè¡¡å®ä¹çç®æ³ã\n * æºå°å Hashï¼Source Hashï¼ - æ ¹æ®è¯·æ±æ¥æºç IP å°åè¿è¡ Hash è®¡ç®ï¼å¾å°åºç¨æå¡å¨ï¼è¿æ ·æ¥èªåä¸ä¸ª IP å°åçè¯·æ±æ»å¨åä¸ä¸ªæå¡å¨ä¸å¤çï¼è¯¥è¯·æ±çä¸ä¸æä¿¡æ¯å¯ä»¥å­å¨å¨è¿å°æå¡å¨ä¸ï¼å¨ä¸ä¸ªä¼è¯å¨æåéå¤ä½¿ç¨ï¼ä»èå®ç°ä¼è¯ç²æ»ã\n\n\n# 3. åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\nç®åæ¯è¾æµè¡çåå¸å¼éç¾¤ä¼¸ç¼©æ§æ¹æ¡å°±æ¯ï¼ä¸è´æ§ HASH ç®æ³\n\n\n# 4. æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\n\n# 4.1. å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡\n\n * ä¸»ä»å¤å¶ - ä¸»æµå³ç³»åæ°æ®åºä¸è¬é½æ¯æä¸»ä»å¤å¶ã\n * ååº - æ ¹æ®ä¸å¡å¯¹æ°æ®åºè¿è¡åå²ãå¶çº¦æ¡ä»¶æ¯è·¨åºçè¡¨ä¸è½è¿è¡ Join æä½ã\n * åè¡¨ - ä½¿ç¨æ°æ®åºåçä¸­é´ä»¶ï¼å¦ Cobar ç­ã\n\n\n# 4.2. NoSql æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡\n\nä¸è¬èè¨ï¼Nosql ä¸æ¯æ SQL å ACIDï¼ä½æ¯å¼ºåäºå¯¹äºé«å¯ç¨åä¼¸ç¼©æ§çæ¯æã\n\n\n# 5. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã",normalizedContent:"# ç³»ç»ä¼¸ç¼©æ§æ¶æ\n\n> ä¼¸ç¼©æ§æ¶ææ¯æä¸éè¦æ¹åç³»ç»çè½¯ç¡¬ä»¶è®¾è®¡ï¼ä»éè¿æ¹åé¨ç½²æå¡å¨æ°éå°±å¯ä»¥æ©å¤§æç¼©å°ç³»ç»çæå¡å¤çè½åã\n\n\n# 1. ç³»ç»æ¶æçä¼¸ç¼©æ§è®¾è®¡\n\n\n# 1.1. ä¸ååè½è¿è¡ç©çåç¦»å®ç°ä¼¸ç¼©\n\n * çºµååç¦»ï¼åå±ååç¦»ï¼ - å°ä¸å¡å¤çæµç¨ä¸çä¸åé¨ååç¦»é¨ç½²ï¼å®ç°ç³»ç»ä¼¸ç¼©æ§ã\n * æ¨ªååç¦»ï¼ä¸å¡åå²ååç¦»ï¼ - å°ä¸åçä¸å¡æ¨¡ååç¦»é¨ç½²ï¼å®ç°ç³»ç»ä¼¸ç¼©æ§ã\n\n\n# 1.2. åä¸åè½éè¿éç¾¤è§æ¨¡å®ç°ä¼¸ç¼©\n\nå°ä¸ååè½åç¦»é¨ç½²å¯ä»¥å®ç°ä¸å®ç¨åº¦çä¼¸ç¼©æ§ï¼ä½æ¯éçè®¿é®ééæ­¥å¢å ï¼å³ä½¿åç¦»å°æå°ç²åº¦çç¬ç«é¨ç½²ï¼åä¸çæå¡å¨ä¹ä¸è½æ»¡è¶³ä¸å¡è§æ¨¡çè¦æ±ãå æ­¤å¿é¡»ä½¿ç¨æå¡å¨éç¾¤ï¼å³å°ç¸åæå¡é¨ç½²å¨å¤ææå¡å¨ä¸ææä¸ä¸ªéç¾¤æ´ä½å¯¹å¤æä¾æå¡ã\n\n\n# 2. åºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\nå¦æ http è¯·æ±ååè£ç½®å¯ä»¥æç¥æèå¯ä»¥éç½®éç¾¤çæå¡å¨æ°éï¼å¯ä»¥åæ¶åç°éç¾¤ä¸­æ°ä¸çº¿æä¸çº¿çæå¡å¨ï¼å¹¶è½åæ°ä¸çº¿çæå¡å¨ååè¯·æ±ï¼åæ­¢åå·²ä¸çº¿çæå¡å¨ååè¯·æ±ï¼é£ä¹å°±å®ç°äºåºç¨æå¡å¨éç¾¤çä¼¸ç¼©æ§ã\n\n\n# 2.1. http éå®åè´è½½åè¡¡\n\n\n\nå©ç¨ http éå®ååè®®å®ç°è´è½½åè¡¡ã\n\nè¿ç§è´è½½åè¡¡æ¹æ¡çä¼ç¹æ¯æ¯è¾ç®åã\n\nç¼ºç¹æ¯æµè§å¨éè¦ä¸¤æ¬¡è¯·æ±æå¡å¨æè½å®æä¸æ¬¡è®¿é®ï¼æ§è½è¾å·®ï¼éå®åæå¡å¨èªèº«çå¤çè½åæå¯è½æä¸ºç¶é¢ï¼æ´ä¸ªéç¾¤çä¼¸ç¼©æ§è§æ¨¡æéï¼ä½¿ç¨ http 302 ååºç éå®åï¼å¯è½ä½¿æç´¢å¼æå¤æ­ä¸º seo ä½å¼ï¼éä½æç´¢æåã\n\n\n# 2.2. dns ååè§£æè´è½½åè¡¡\n\nå©ç¨ dns å¤çååè§£æè¯·æ±çåæ¶è¿è¡è´è½½åè¡¡å¤ççä¸ç§æ¹æ¡ã\n\n\n\nå¨ dns æå¡å¨ä¸­éç½®å¤ä¸ª a è®°å½ï¼å¦ï¼\n\n114.100.40.1 www.mysite.com\n114.100.40.2 www.mysite.com\n114.100.40.3 www.mysite.com\n\n\næ¯æ¬¡ååè§£æè¯·æ±é½ä¼æ ¹æ®è´è½½åè¡¡ç®æ³è®¡ç®ä¸ä¸ªä¸åç ip å°åè¿åï¼è¿æ · a è®°å½ä¸­éç½®çå¤ä¸ªæå¡å¨å°±ææä¸ä¸ªéç¾¤ï¼å¹¶å¯ä»¥å®ç°è´è½½åè¡¡ã\n\ndns ååè§£æè´è½½åè¡¡çä¼ç¹ï¼\n\n * å°è´è½½åè¡¡çå·¥ä½è½¬äº¤ç»äº dnsï¼çæäºç½ç«ç®¡çç»´æ¤çéº»ç¦ã\n * åæ¶ï¼è®¸å¤ dns æå¡å¨è¿æ¯æåºäºå°çä½ç½®çååè§£æï¼å³å°ååè§£ææè·ç¦»ç¨æ·å°çæè¿çä¸ä¸ªæå¡å¨å°åï¼è¿æ ·å¯ä»¥å å¿«ç¨æ·è®¿é®éåº¦ï¼æ¹åæ§è½ã\n\ndns ååè§£æè´è½½åè¡¡çç¼ºç¹ï¼\n\n * dns æ¯å¤çº§è§£æï¼æ¯ä¸çº§ dns é½å¯è½ç¼å­ a è®°å½ï¼å½æå°æå¡å¨ä¸çº¿åï¼å³ä½¿ä¿®æ¹äº dns ç a è®°å½ï¼è¦ä½¿å¶çæä¹éè¦è¾é¿æ¶é´ãè¿æ®µæ¶é´ï¼ä¾ç¶ä¼ååè§£æå°å·²ç»ä¸çº¿çæå¡å¨ï¼å¯¼è´ç¨æ·è®¿é®å¤±è´¥ã\n * dns çè´è½½åè¡¡çæ§å¶æå¨ååæå¡åé£éï¼ç½ç«æ æ³å¯¹å¶åæ´å¤æ¹ååæ´å¼ºå¤§çç®¡çã\n\n\n# 2.3. ååä»£çè´è½½åè¡¡\n\nå¤§å¤æ°ååä»£çæå¡å¨åæ¶æä¾ååä»£çåè´è½½åè¡¡çåè½ã\n\n\n\nååä»£çæå¡å¨çä¼ç¹æ¯é¨ç½²ç®åãç¼ºç¹æ¯ååä»£çæå¡å¨æ¯ææè¯·æ±åååºçä¸­è½¬ç«ï¼å¶æ§è½å¯è½ä¼æä¸ºç¶é¢ã\n\n\n# 2.4. ip è´è½½åè¡¡\n\nå¨ç½ç»å±éè¿ä¿®æ¹è¯·æ±ç®æ å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nè´è½½åè¡¡æå¡å¨ï¼ç½å³æå¡å¨ï¼å¨æä½ç³»ç»åæ ¸è·åç½ç»æ°æ®åï¼æ ¹æ®è´è½½åè¡¡ç®æ³è®¡ç®å¾å°ä¸å°çå® web æå¡å¨ 10.0.0.1ï¼ç¶åå°ç®ç ip å°åä¿®æ¹ä¸º 10.0.0.1ï¼ä¸éè¦éè¿ç¨æ·è¿ç¨ãçå® web æå¡å¨å¤çå®æåï¼ååºæ°æ®ååå°è´è½½åè¡¡æå¡å¨ï¼è´è½½åè¡¡æå¡å¨åå°æ°æ®ååå°åä¿®æ¹ä¸ºèªèº«ç ip å°åï¼114.100.80.10ï¼åéç»æµè§å¨ã\n\nip è´è½½åè¡¡å¨åæ ¸å®ææ°æ®ååï¼æä»¥å¤çæ§è½ä¼äºååä»£çè´è½½åè¡¡ãä½æ¯å ä¸ºææè¯·æ±ååºé½è¦ç»è¿è´è½½åè¡¡æå¡å¨ï¼éç¾¤çæå¤§ååºæ°æ®ååéåå¶äºè´è½½åè¡¡æå¡å¨ç½å¡å¸¦å®½ã\n\n\n# 2.5. æ°æ®é¾è·¯å±è´è½½åè¡¡\n\næ°æ®é¾è·¯å±è´è½½åè¡¡æ¯æå¨éä¿¡åè®®çæ°æ®é¾è·¯å±ä¿®æ¹ mac å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nè¿ç§æ¹å¼åç§°ä½ä¸è§ä¼ è¾æ¹å¼ï¼è´è½½åè¡¡æ°æ®ååè¿ç¨ä¸­ä¸ä¿®æ¹ ip å°åï¼åªä¿®æ¹ç®ç mac å°åï¼éè¿éç½®çå®ç©çæå¡å¨éç¾¤æææºå¨èæ ip åè´è½½åè¡¡æå¡å¨ ip å°åä¸è´ï¼ä»èè¾¾å°ä¸ä¿®æ¹æ°æ®åçæºå°ååç®çå°åå°±å¯ä»¥è¿è¡æ°æ®ååçç®çï¼ç±äºå®éå¤çè¯·æ±ççå®ç©çæå¡å¨ ip åæ°æ®è¯·æ±ç®ç ip ä¸è´ï¼ä¸éè¦éè¿è´è½½åè¡¡æå¡å¨è¿è¡å°åè½¬æ¢ï¼å¯å°ååºæ°æ®åç´æ¥è¿åç»ç¨æ·æµè§å¨ï¼é¿åè´è½½åè¡¡æå¡å¨ç½å¡å¸¦å®½æä¸ºç¶é¢ãè¿ç§è´è½½æ¹å¼åç§°ä½ç´æ¥è·¯ç±æ¹å¼ã\n\nå¨ linux å¹³å°ä¸æå¥½çé¾è·¯å±è´è½½åè¡¡å¼æºäº§åæ¯ lvs(linux virtual server)ã\n\n\n# 2.6. è´è½½åè¡¡ç®æ³\n\nè´è½½åè¡¡æå¡å¨çå®ç°å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\n 1. æ ¹æ®è´è½½åè¡¡ç®æ³å web æå¡å¨åè¡¨è®¡ç®å¾å°éç¾¤ä¸­ä¸å° web æå¡å¨çå°åã\n 2. å°è¯·æ±æ°æ®åéå°è¯¥å°åå¯¹åºç web æå¡å¨ä¸ã\n\nè´è½½åè¡¡ç®æ³éå¸¸æä»¥ä¸å ç§ï¼\n\n * è½®è¯¢ï¼round robinï¼ - ææè¯·æ±è¢«ä¾æ¬¡ååå°æ¯å°åºç¨æå¡å¨ä¸ï¼å³æ¯å°æå¡å¨éè¦å¤ççè¯·æ±æ°æ®é½ç¸åï¼éåäºæææå¡å¨ç¡¬ä»¶é½ç¸åçåºæ¯ã\n * å æè½®è¯¢ï¼weighted round robinï¼ - æ ¹æ®æå¡å¨ç¡¬ä»¶æ§è½æåµï¼å¨è½®è¯¢çåºç¡ä¸ï¼æç§éç½®æéå°è¯·æ±ååå°æ¯ä¸ªæå¡å¨ï¼é«æ§è½æå¡å¨è½åéæ´å¤è¯·æ±ã\n * éæºï¼randomï¼ - è¯·æ±è¢«éæºåéå°åä¸ªåºç¨æå¡å¨ï¼å¨è®¸å¤åºåä¸ï¼è¿ç§æ¹æ¡é½å¾ç®åå®ç¨ï¼å ä¸ºå¥½çéæºæ°æ¬èº«å°±å¾å¹³åï¼å³ä½¿åºç¨æå¡å¨ç¡¬ä»¶éç½®ä¸åï¼ä¹å¯ä»¥ä½¿ç¨å æéæºç®æ³ã\n * æå°è¿æ¥ï¼least connectionï¼ - è®°å½æ¯ä¸ªåºç¨æå¡å¨æ­£å¨å¤ççè¿æ¥æ°ï¼å°æ°å°çè¯·æ±ååå°æå°è¿æ¥çæå¡å¨ä¸ï¼åºè¯¥è¯´ï¼è¿æ¯æç¬¦åè´è½½åè¡¡å®ä¹çç®æ³ã\n * æºå°å hashï¼source hashï¼ - æ ¹æ®è¯·æ±æ¥æºç ip å°åè¿è¡ hash è®¡ç®ï¼å¾å°åºç¨æå¡å¨ï¼è¿æ ·æ¥èªåä¸ä¸ª ip å°åçè¯·æ±æ»å¨åä¸ä¸ªæå¡å¨ä¸å¤çï¼è¯¥è¯·æ±çä¸ä¸æä¿¡æ¯å¯ä»¥å­å¨å¨è¿å°æå¡å¨ä¸ï¼å¨ä¸ä¸ªä¼è¯å¨æåéå¤ä½¿ç¨ï¼ä»èå®ç°ä¼è¯ç²æ»ã\n\n\n# 3. åå¸å¼ç¼å­éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\nç®åæ¯è¾æµè¡çåå¸å¼éç¾¤ä¼¸ç¼©æ§æ¹æ¡å°±æ¯ï¼ä¸è´æ§ hash ç®æ³\n\n\n# 4. æ°æ®å­å¨æå¡éç¾¤çä¼¸ç¼©æ§è®¾è®¡\n\n\n# 4.1. å³ç³»åæ°æ®åºçä¼¸ç¼©æ§è®¾è®¡\n\n * ä¸»ä»å¤å¶ - ä¸»æµå³ç³»åæ°æ®åºä¸è¬é½æ¯æä¸»ä»å¤å¶ã\n * ååº - æ ¹æ®ä¸å¡å¯¹æ°æ®åºè¿è¡åå²ãå¶çº¦æ¡ä»¶æ¯è·¨åºçè¡¨ä¸è½è¿è¡ join æä½ã\n * åè¡¨ - ä½¿ç¨æ°æ®åºåçä¸­é´ä»¶ï¼å¦ cobar ç­ã\n\n\n# 4.2. nosql æ°æ®åºçä¼¸ç¼©æ§è®¾è®¡\n\nä¸è¬èè¨ï¼nosql ä¸æ¯æ sql å acidï¼ä½æ¯å¼ºåäºå¯¹äºé«å¯ç¨åä¼¸ç¼©æ§çæ¯æã\n\n\n# 5. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»æ©å±æ§æ¶æ",frontmatter:{title:"ç³»ç»æ©å±æ§æ¶æ",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","æ©å±æ§"],permalink:"/pages/1580de/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/06.%E7%B3%BB%E7%BB%9F%E6%89%A9%E5%B1%95%E6%80%A7%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/06.ç³»ç»æ©å±æ§æ¶æ.md",key:"v-6395f8b6",path:"/pages/1580de/",headers:[{level:2,title:"1. å¯æ©å±çåºæ¬ææ³",slug:"_1-å¯æ©å±çåºæ¬ææ³",normalizedTitle:"1. å¯æ©å±çåºæ¬ææ³",charIndex:328},{level:2,title:"2. å¯æ©å±æ¹å¼",slug:"_2-å¯æ©å±æ¹å¼",normalizedTitle:"2. å¯æ©å±æ¹å¼",charIndex:445},{level:3,title:"2.1. åå±æ¶æ",slug:"_2-1-åå±æ¶æ",normalizedTitle:"2.1. åå±æ¶æ",charIndex:525},{level:3,title:"2.2. SOA",slug:"_2-2-soa",normalizedTitle:"2.2. soa",charIndex:780},{level:3,title:"2.3. å¾®æå¡",slug:"_2-3-å¾®æå¡",normalizedTitle:"2.3. å¾®æå¡",charIndex:1221},{level:3,title:"2.4. å¾®åæ ¸",slug:"_2-4-å¾®åæ ¸",normalizedTitle:"2.4. å¾®åæ ¸",charIndex:1764},{level:2,title:"3. ææ©å±çç³»ç»æ¶æ",slug:"_3-ææ©å±çç³»ç»æ¶æ",normalizedTitle:"3. ææ©å±çç³»ç»æ¶æ",charIndex:2373},{level:2,title:"4. å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§",slug:"_4-å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§",normalizedTitle:"4. å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§",charIndex:2612},{level:3,title:"4.1. äºä»¶é©±å¨æ¶æ",slug:"_4-1-äºä»¶é©±å¨æ¶æ",normalizedTitle:"4.1. äºä»¶é©±å¨æ¶æ",charIndex:2636},{level:3,title:"4.2. åå¸å¼æ¶æ¯éå",slug:"_4-2-åå¸å¼æ¶æ¯éå",normalizedTitle:"4.2. åå¸å¼æ¶æ¯éå",charIndex:2759},{level:2,title:"5. å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å°",slug:"_5-å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å°",normalizedTitle:"5. å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å°",charIndex:3121},{level:2,title:"6. å¯æ©å±çæ°æ®ç»æ",slug:"_6-å¯æ©å±çæ°æ®ç»æ",normalizedTitle:"6. å¯æ©å±çæ°æ®ç»æ",charIndex:3455},{level:2,title:"7. å¼æ¾å¹³å°",slug:"_7-å¼æ¾å¹³å°",normalizedTitle:"7. å¼æ¾å¹³å°",charIndex:3637},{level:2,title:"8. åèèµæ",slug:"_8-åèèµæ",normalizedTitle:"8. åèèµæ",charIndex:3817}],headersStr:"1. å¯æ©å±çåºæ¬ææ³ 2. å¯æ©å±æ¹å¼ 2.1. åå±æ¶æ 2.2. SOA 2.3. å¾®æå¡ 2.4. å¾®åæ ¸ 3. ææ©å±çç³»ç»æ¶æ 4. å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§ 4.1. äºä»¶é©±å¨æ¶æ 4.2. åå¸å¼æ¶æ¯éå 5. å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å° 6. å¯æ©å±çæ°æ®ç»æ 7. å¼æ¾å¹³å° 8. åèèµæ",content:"# ç³»ç»æ©å±æ§æ¶æ\n\n> æ©å±æ§åä¼¸ç¼©æ§æ¯ä¸åçæ¦å¿µï¼\n> \n>  * æ©å±æ§ï¼Extensibilityï¼ - æå¯¹ç°æç³»ç»å½±åæå°çæåµä¸ï¼ç³»ç»åè½å¯æç»­æ©å±ææåçè½åãè¡¨ç°å¨ç³»ç»åºç¡è®¾æ½ç¨³å®ä¸éè¦ç»å¸¸åæ´ï¼åºç¨ä¹é´è¾å°ä¾èµåè¦åï¼å¯¹éæ±åæ´å¯ä»¥ææ·ååºãå®æ¯ç³»ç»æ¶æè®¾è®¡å±é¢çå¼é­ååï¼å¯¹æ©å±å¼æ¾ãå¯¹ä¿®æ¹å³é­ï¼ï¼æ¶æè®¾è®¡èèæªæ¥åè½æ©å±ï¼å½ç³»ç»å¢å æ°åè½æ¶ï¼ä¸éè¦å¯¹ç°æç³»ç»çç»æåä»£ç è¿è¡ä¿®æ¹ã\n>  * ä¼¸ç¼©æ§ï¼Scalabilityï¼ - æç³»ç»è½å¤éè¿å¢å åå°èªèº«èµæºè§æ¨¡çæ¹å¼å¢åèªå·±è®¡ç®å¤çäºå¡çè½åãå¦æè¿ç§å¢åæ¯ææ¯ä¾çï¼å°±è¢«ç§°ä½çº¿æ§ä¼¸ç¼©æ§ãå¨ç½ç«æ¶æä¸­ ï¼éå¸¸æå©ç¨éç¾¤çæ¹å¼å¢å æå¡å¨æ°éãæé«ç³»ç»çæ´ä½äºå¡ååè½åã\n\n\n# 1. å¯æ©å±çåºæ¬ææ³\n\n * é¢åæµç¨æåï¼å°æ´ä¸ªä¸å¡æµç¨æåä¸ºå ä¸ªé¶æ®µï¼æ¯ä¸ªé¶æ®µä½ä¸ºä¸é¨åã\n * é¢åæå¡æåï¼å°ç³»ç»æä¾çæå¡æåï¼æ¯ä¸ªæå¡ä½ä¸ºä¸é¨åã\n * é¢ååè½æåï¼å°ç³»ç»æä¾çåè½æåï¼æ¯ä¸ªåè½ä½ä¸ºä¸é¨åã\n\n\n# 2. å¯æ©å±æ¹å¼\n\nå¸åçå¯æ©å±ç³»ç»æ¶ææï¼\n\n * é¢åæµç¨æåï¼åå±æ¶æã\n * é¢åæå¡æåï¼SOAãå¾®æå¡ã\n * é¢ååè½æåï¼å¾®åæ ¸æ¶æã\n\n\n# 2.1. åå±æ¶æ\n\nåå±æ¶æçæ ¸å¿ç¹æ¶ï¼éè¦ä¿è¯åå±ä¹é´çå·®å¼è¶³å¤æ¸æ°ï¼è¾¹çè¶³å¤ææ¾ï¼è®©äººçå°æ¶æå¾åå°±è½çææ´ä¸ªæ¶æ\n\nåå±æ¶ææ¯å¾å¸¸è§çæ¶ææ¨¡å¼ï¼å®ä¹å« N å±æ¶æï¼éå¸¸æåµä¸ï¼N è³å°æ¯ 2 å±ãä¾å¦ï¼C/S æ¶æãB/S æ¶æãå¸¸è§çæ¯ 3 å±æ¶æï¼ä¾å¦ï¼MVCãMVP æ¶æï¼ã4 å±æ¶æï¼5 å±æ¶æçæ¯è¾å°è§ï¼ä¸è¬æ¯æ¯è¾å¤æçç³»ç»æä¼è¾¾å°æèè¶è¿ 5 å±ï¼æ¯å¦æä½ç³»ç»åæ ¸æ¶æã\n\nå¸ååå±æ¶æï¼\n\n * C/S æ¶æãB/S æ¶æ\n * MVC æ¶æãMVP æ¶æ\n * é»è¾åå±æ¶æ\n\n\n# 2.2. SOA\n\nSOA çå¨ç§°æ¯ Service Oriented Architectureï¼å³âé¢åæå¡çæ¶æâã\n\nSOA æåºäº 3 ä¸ªå³é®æ¦å¿µã\n\n * æå¡ - ææä¸å¡åè½é½æ¯ä¸é¡¹æå¡ï¼æå¡å°±æå³çè¦å¯¹å¤æä¾å¼æ¾çè½åï¼å½å¶ä»ç³»ç»éè¦ä½¿ç¨è¿é¡¹åè½æ¶ï¼æ é¡»å®å¶åå¼åã\n * ESB - ESB çå¨ç§°æ¯ Enterprise Service Busï¼å³ âä¼ä¸æå¡æ»çº¿âãESB å°ä¼ä¸ä¸­åä¸ªä¸åçæå¡è¿æ¥å¨ä¸èµ·ãå ä¸ºåä¸ªç¬ç«çæå¡æ¯å¼æçï¼å¦ææ²¡æç»ä¸çæ åï¼ååä¸ªå¼æç³»ç»å¯¹å¤æä¾çæ¥å£æ¯åå¼åæ ·çãSOA ä½¿ç¨ ESB æ¥å±è½å¼æç³»ç»å¯¹å¤æä¾åç§ä¸åçæ¥å£æ¹å¼ï¼ä»¥æ­¤æ¥è¾¾å°æå¡é´é«æçäºèäºéã\n * æ¾è¦å - æ¾è¦åçç®çæ¯åå°åä¸ªæå¡é´çä¾èµåäºç¸å½±åãå ä¸ºéç¨ SOA æ¶æåï¼åä¸ªæå¡æ¯ç¸äºç¬ç«è¿è¡çï¼çè³é½ä¸æ¸æ¥æä¸ªæå¡å°åºæå¤å°å¯¹å¶ä»æå¡çä¾èµãå¦æåä¸å°æ¾è¦åï¼æä¸ªæå¡ä¸åçº§ï¼ä¾èµå®çå¶ä»æå¡å¨é¨æéï¼è¿æ ·è¯å®æ¯æ æ³æ»¡è¶³ä¸å¡éæ±çã\n\n\n# 2.3. å¾®æå¡\n\nå¾®æå¡æ¯å»æ ESB åç SOAã\n\nå¾®æå¡çé®é¢ï¼\n\n * æå¡ååè¿ç»ï¼æå¡é´å³ç³»å¤æ - æå¡ååè¿ç»ï¼åä¸ªæå¡çå¤æåº¦ç¡®å®ä¸éäºï¼ä½æ´ä¸ªç³»ç»çå¤æåº¦å´ä¸åäºï¼å ä¸ºå¾®æå¡å°ç³»ç»åçå¤æåº¦è½¬ç§»ä¸ºç³»ç»é´çå¤æåº¦äºã\n * æå¡æ°éå¤ªå¤ï¼å¢éæçæ¥å§ä¸é\n * è°ç¨é¾å¤ªé¿ï¼æ§è½ä¸é\n * è°ç¨é¾å¤ªé¿ï¼é®é¢å®ä½å°é¾\n * æ²¡æèªå¨åæ¯æï¼æ æ³å¿«éäº¤ä»\n * æ²¡ææå¡æ²»çï¼å¾®æå¡æ°éå¤äºåç®¡çæ··ä¹±\n\nå¾®æå¡æåï¼\n\n * åºäºä¸å¡é»è¾æå\n * åºäºå¯æ©å±æå - å°å·²ç»æçåæ¹å¨ä¸å¤§çæå¡æåä¸ºç¨³å®æå¡ï¼å°ç»å¸¸åååè¿­ä»£çæå¡æåä¸ºåå¨æå¡ã\n * åºäºå¯é æ§æå - å°ç³»ç»ä¸­çä¸å¡æ¨¡åæç§ä¼åçº§æåºï¼å°å¯é æ§è¦æ±é«çæ ¸å¿æå¡åå¯é æ§è¦æ±ä½çéæ ¸å¿æå¡æåå¼æ¥ï¼ç¶åéç¹ä¿è¯æ ¸å¿æå¡çé«å¯ç¨ã\n\nåºç¡è®¾æ½ï¼\n\n * æå¡åç°ãæå¡è·¯ç±ãæå¡å®¹éï¼è¿æ¯æåºæ¬çå¾®æå¡åºç¡è®¾æ½ã\n * æ¥å£æ¡æ¶ãAPI ç½å³ï¼ä¸»è¦æ¯ä¸ºäºæåå¼åæçï¼æ¥å£æ¡æ¶æ¯æååé¨æå¡çå¼åæçï¼API ç½å³æ¯ä¸ºäºæåä¸å¤é¨æå¡å¯¹æ¥çæçã\n * èªå¨åé¨ç½²ãèªå¨åæµè¯ãéç½®ä¸­å¿ï¼ä¸»è¦æ¯ä¸ºäºæåæµè¯åè¿ç»´æçã\n * æå¡çæ§ãæå¡è·è¸ªãæå¡å®å¨ï¼ä¸»è¦æ¯ä¸ºäºè¿ä¸æ­¥æåè¿ç»´æçã\n\n\n# 2.4. å¾®åæ ¸\n\n\n\nå¾®åæ ¸çæ ¸å¿ç³»ç»è®¾è®¡çå³é®ææ¯æï¼æä»¶ç®¡çãæä»¶è¿æ¥åæä»¶éä¿¡ã\n\næä»¶ç®¡ç\n\næ ¸å¿ç³»ç»éè¦ç¥éå½åæåªäºæä»¶å¯ç¨ï¼å¦ä½å è½½è¿äºæä»¶ï¼ä»ä¹æ¶åå è½½æä»¶ãå¸¸è§çå®ç°æ¹æ³æ¯æä»¶æ³¨åè¡¨æºå¶ãæ ¸å¿ç³»ç»æä¾æä»¶æ³¨åè¡¨ï¼å¯ä»¥æ¯éç½®æä»¶ï¼ä¹å¯ä»¥æ¯ä»£ç ï¼è¿å¯ä»¥æ¯æ°æ®åºï¼ï¼æä»¶æ³¨åè¡¨å«ææ¯ä¸ªæä»¶æ¨¡åçä¿¡æ¯ï¼åæ¬å®çåå­ãä½ç½®ãå è½½æ¶æºï¼å¯å¨å°±å è½½ï¼è¿æ¯æéå è½½ï¼ç­ã\n\næä»¶è¿æ¥\n\næä»¶è¿æ¥ææä»¶å¦ä½è¿æ¥å°æ ¸å¿ç³»ç»ãéå¸¸æ¥è¯´ï¼æ ¸å¿ç³»ç»å¿é¡»å¶å®æä»¶åæ ¸å¿ç³»ç»çè¿æ¥è§èï¼ç¶åæä»¶æç§è§èå®ç°ï¼æ ¸å¿ç³»ç»æç§è§èå è½½å³å¯ã\n\nå¸¸è§çè¿æ¥æºå¶æ OSGiï¼Eclipse ä½¿ç¨ï¼ãæ¶æ¯æ¨¡å¼ãä¾èµæ³¨å¥ï¼Spring ä½¿ç¨ï¼ï¼çè³ä½¿ç¨åå¸å¼çåè®®é½æ¯å¯ä»¥çï¼æ¯å¦ RPC æè HTTP Web çæ¹å¼ã\n\næä»¶éä¿¡\n\næä»¶éä¿¡ææä»¶é´çéä¿¡ãè½ç¶è®¾è®¡çæ¶åæä»¶é´æ¯å®å¨è§£è¦çï¼ä½å®éä¸å¡è¿è¡è¿ç¨ä¸­ï¼å¿ç¶ä¼åºç°æä¸ªä¸å¡æµç¨éè¦å¤ä¸ªæä»¶åä½ï¼è¿å°±è¦æ±ä¸¤ä¸ªæä»¶é´è¿è¡éä¿¡ãç±äºæä»¶ä¹é´æ²¡æç´æ¥èç³»ï¼éä¿¡å¿é¡»éè¿æ ¸å¿ç³»ç»ï¼å æ­¤æ ¸å¿ç³»ç»éè¦æä¾æä»¶éä¿¡æºå¶ãè¿ç§æåµåè®¡ç®æºç±»ä¼¼ï¼è®¡ç®æºç CPUãç¡¬çãåå­ãç½å¡æ¯ç¬ç«è®¾è®¡çéä»¶ï¼ä½è®¡ç®æºè¿è¡è¿ç¨ä¸­ï¼CPU ååå­ãåå­åç¡¬çè¯å®æ¯æéä¿¡çï¼è®¡ç®æºéè¿ä¸»æ¿ä¸çæ»çº¿æä¾äºè¿äºç»ä»¶ä¹é´çéä¿¡åè½ãå¾®åæ ¸çæ ¸å¿ç³»ç»ä¹å¿é¡»æä¾ç±»ä¼¼çéä¿¡æºå¶ï¼åä¸ªæä»¶ä¹é´æè½è¿è¡æ­£å¸¸çéä¿¡ã\n\n\n# 3. ææ©å±çç³»ç»æ¶æ\n\n> ä½è¦åçç³»ç»æ´å®¹ææ©å±ãå¤ç¨ã\n\nå¯æ©å±æ¶æçæ ¸å¿ææ³æ¯æ¨¡ååï¼å¹¶å¨æ­¤åºç¡ä¸ï¼éä½æ¨¡åé´çè¦åæ§ï¼æé«æ¨¡åçå¤ç¨æ§ã\n\nåå±ååå²ä¸ä»å¯ä»¥è¿è¡æ¶æä¼¸ç¼©ï¼ä¹æ¯æ¨¡ååè®¾è®¡çéè¦ææ®µï¼å©ç¨åå±ååå²çæ¹å¼å°è½¯ä»¶åå²ä¸ºè¥å¹²ä¸ªä½è¦åçç¬ç«çç»ä»¶æ¨¡åï¼è¿äºç»ä»¶æ¨¡åä»¥æ¶æ¯ä¼ éåä¾èµè°ç¨çæ¹å¼èåæä¸ä¸ªå®æ´çç³»ç»ã\n\nå¨å¤§åç½ç«ä¸­ï¼è¿äºæ¨¡åéè¿åå¸å¼é¨ç½²çæ¹å¼ï¼ç¬ç«çæ¨¡åé¨ç½²å¨ç¬ç«çæå¡å¨ä¸ï¼ä»ç©çä¸åç¦»æ¨¡åé´çè¦åå³ç³»ï¼è¿ä¸æ­¥éä½è¦åæ§æé«å¤ç¨æ§ã\n\n\n# 4. å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§\n\n\n# 4.1. äºä»¶é©±å¨æ¶æ\n\näºä»¶é©±å¨æ¶æéè¿å¨ä½è¦åçæ¨¡åé´ä¼ è¾äºä»¶æ¶æ¯ï¼ä»¥ä¿ææ¨¡åçæ¾æ£è¦åï¼å¹¶åå©äºä»¶æ¶æ¯çéä¿¡å®ææ¨¡åé´åä½ãå¸åçäºä»¶é©±å¨æ¶æå°±æ¯æä½ç³»ç»ä¸­å¸¸è§ççäº§èæ¶è´¹èæ¨¡å¼ãå¨å¤§åç½ç«ä¸­ï¼æå¸¸è§çå®ç°ææ®µå°±æ¯åå¸å¼æ¶æ¯éåã\n\n\n# 4.2. åå¸å¼æ¶æ¯éå\n\næ¶æ¯çäº§èåºç¨ç¨åºéè¿è¿ç¨è®¿é®æ¥å£å°æ¶æ¯æ¨éç»æ¶æ¯éåæå¡å¨ï¼æ¶æ¯éåæå¡å¨å°æ¶æ¯åå¥æ¬å°åå­éååç«å³è¿åæåååºç»æ¶æ¯çäº§èãæ¶æ¯éåæå¡å¨æ ¹æ®æ¶æ¯è®¢éåè¡¨æ¥æ¾è®¢éè¯¥æ¶æ¯çæ¶æ¯æ¶è´¹èåºç¨ç¨åºï¼å°æ¶æ¯éåä¸­çæ¶æ¯æç§åè¿ååºï¼FIFOï¼çååå°æ¶æ¯éè¿è¿ç¨éä¿¡æ¥å£åéç»æ¶æ¯æ¶è´¹èç¨åºã\n\n\n\nå¨ä¼¸ç¼©æ§æ¹é¢ï¼ç±äºæ¶æ¯éåæå¡å¨ä¸çæ°æ®å¯ä»¥çä½æ¯å³æ¶å¤ççï¼å æ­¤ç±»ä¼¼äºæ ç¶æçæå¡å¨ï¼ä¼¸ç¼©æ§è®¾è®¡æ¯è¾ç®åãå°æ°æå¡å¨å å¥åå¸å¼æ¶æ¯éåéç¾¤ä¸­ï¼éç¥çäº§èæå¡å¨æ´æ¹æ¶æ¯éåæå¡å¨åè¡¨å³å¯ã\n\nå¨å¯ç¨æ§æ¹é¢ï¼ä¸ºäºé¿åæ¶è´¹èè¿ç¨å¤çç¼æ¢ï¼åå¸å¼æ¶æ¯éåæå¡å¨åå­ç©ºé´ä¸è¶³é æçé®é¢ï¼å¦æåå­éåå·²æ»¡ï¼ä¼å°æ¶æ¯åå¥ç£çï¼æ¶æ¯æ¨éæ¨¡åå¨å°åå­éåæ¶æ¯å¤çå®æä»¥åï¼å°ç£çåå®¹å è½½å°åå­éåç»§ç»­å¤çã\n\n\n# 5. å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å°\n\nå·¨æ é¸ç³»ç»çé®é¢ï¼\n\n * æå»ºãé¨ç½²å°é¾\n * ä»£ç åæ¯ç®¡çå°é¾\n * æ°æ®åºè¿æ¥èå°½\n * æ©å±ä¸å¡å°é¾\n\nèè§£å³å·¨æ é¸ç³»ç»é®é¢çæ¹æ¡å°±æ¯æåï¼\n\n * éè¿çºµåæåå°ä¸å¡æåå¤ä¸ªåºç¨ææ¨¡åï¼\n * éè¿æ¨ªåæåå°å¯å¤ç¨ä¸å¡ä½ä¸ºç¬ç«åºç¨ã\n\nç¶åï¼éè¦éè¿ä¸ä¸ªåå¸å¼æå¡ç®¡çæ¡æ¶å°è¿äºåºç¨ææå¡ç»ç»ç®¡çèµ·æ¥ï¼éè¿æ¥å£åè§£ç³»ç»è¦åæ§ï¼ä¸åå­ç³»ç»éè¿ç¸åçæ¥å£æè¿°è¿è¡æå¡è°ç¨ãå¸¸è§çåå¸å¼æå¡ç®¡çæ¡æ¶å¦ï¼Spring CloudãDubbo ç­ã\n\nå¤§åç½ç«åå¸å¼æå¡çéæ±ä¸ç¹ç¹ï¼\n\n * è´è½½åè¡¡\n * å¤±æè½¬ç§»\n * é«æçè¿ç¨éä¿¡\n * æ´åå¼æç³»ç»\n * å¯¹åºç¨æå°ä¾µå¥\n * çæ¬ç®¡ç\n * å®æ¶çæ§\n\n\n# 6. å¯æ©å±çæ°æ®ç»æ\n\nä¼ ç»çå³ç³»åæ°æ®åºä¸ºäºä¿è¯å³ç³»è¿ç®çæ­£ç¡®æ§ï¼å¨è®¾è®¡æ°æ®åºè¡¨ç»æçæ¶åï¼å°±éè¦æå®è¡¨ç schema ââå­æ®µåç§°ï¼æ°æ®ç±»åç­ï¼å¹¶è¦éµå¾ªç¹å®çè®¾è®¡èå¼ãè¿äºè§èå¸¦æ¥ä¸ä¸ªé®é¢ï¼é¾ä»¥é¢å¯¹éæ±åæ´å¸¦æ¥çææï¼æä»¥æäººéè¿é¢åè®¾è®¡ä¸äºåä½å­æ®µæ¥åºå¯¹ã\n\nè®¸å¤ NoSql æ°æ®åºä½¿ç¨ ColumnFamily è®¾è®¡æ¥è®¾è®¡å¯æ©å±çæ°æ®ç»æã\n\n\n# 7. å¼æ¾å¹³å°\n\nå¾å¤å¤§å¬å¸ä¼å©ç¨å¼æ¾å¹³å°æä¾å¤§éå¼æ¾æ§ API ä½¿å¾ä¼ä¸åä¸ªäººå¯ä»¥æ¹ä¾¿çæ¥å¥ä¸å¡ãéè¿å¼æ¾å¹³å°ï¼å¯ä»¥æå»ºçæåï¼æååçä»·å¼ä»¥åç«äºåã\n\nå¼æ¾å¹³å°ä¸æ¯ä¸æä¸å¤å®æçï¼è¿éè¦å¤§é OPEN API çæ²æ·ãç³»ç»æ¶æå¨è®¾è®¡ä¹åï¼åºè¯¥ææè¯çå°æªæ¥å¯è½è¢«å¤ç¨çæ¥å£å¥½å¥½è®¾è®¡ï¼ä»¥ä¾¿äºéè¦å¼æ¾ OPEN API æ¶ï¼å¯ä»¥ä¾¿æ·çæ´é²æå¡æ¥å£ã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã",normalizedContent:"# ç³»ç»æ©å±æ§æ¶æ\n\n> æ©å±æ§åä¼¸ç¼©æ§æ¯ä¸åçæ¦å¿µï¼\n> \n>  * æ©å±æ§ï¼extensibilityï¼ - æå¯¹ç°æç³»ç»å½±åæå°çæåµä¸ï¼ç³»ç»åè½å¯æç»­æ©å±ææåçè½åãè¡¨ç°å¨ç³»ç»åºç¡è®¾æ½ç¨³å®ä¸éè¦ç»å¸¸åæ´ï¼åºç¨ä¹é´è¾å°ä¾èµåè¦åï¼å¯¹éæ±åæ´å¯ä»¥ææ·ååºãå®æ¯ç³»ç»æ¶æè®¾è®¡å±é¢çå¼é­ååï¼å¯¹æ©å±å¼æ¾ãå¯¹ä¿®æ¹å³é­ï¼ï¼æ¶æè®¾è®¡èèæªæ¥åè½æ©å±ï¼å½ç³»ç»å¢å æ°åè½æ¶ï¼ä¸éè¦å¯¹ç°æç³»ç»çç»æåä»£ç è¿è¡ä¿®æ¹ã\n>  * ä¼¸ç¼©æ§ï¼scalabilityï¼ - æç³»ç»è½å¤éè¿å¢å åå°èªèº«èµæºè§æ¨¡çæ¹å¼å¢åèªå·±è®¡ç®å¤çäºå¡çè½åãå¦æè¿ç§å¢åæ¯ææ¯ä¾çï¼å°±è¢«ç§°ä½çº¿æ§ä¼¸ç¼©æ§ãå¨ç½ç«æ¶æä¸­ ï¼éå¸¸æå©ç¨éç¾¤çæ¹å¼å¢å æå¡å¨æ°éãæé«ç³»ç»çæ´ä½äºå¡ååè½åã\n\n\n# 1. å¯æ©å±çåºæ¬ææ³\n\n * é¢åæµç¨æåï¼å°æ´ä¸ªä¸å¡æµç¨æåä¸ºå ä¸ªé¶æ®µï¼æ¯ä¸ªé¶æ®µä½ä¸ºä¸é¨åã\n * é¢åæå¡æåï¼å°ç³»ç»æä¾çæå¡æåï¼æ¯ä¸ªæå¡ä½ä¸ºä¸é¨åã\n * é¢ååè½æåï¼å°ç³»ç»æä¾çåè½æåï¼æ¯ä¸ªåè½ä½ä¸ºä¸é¨åã\n\n\n# 2. å¯æ©å±æ¹å¼\n\nå¸åçå¯æ©å±ç³»ç»æ¶ææï¼\n\n * é¢åæµç¨æåï¼åå±æ¶æã\n * é¢åæå¡æåï¼soaãå¾®æå¡ã\n * é¢ååè½æåï¼å¾®åæ ¸æ¶æã\n\n\n# 2.1. åå±æ¶æ\n\nåå±æ¶æçæ ¸å¿ç¹æ¶ï¼éè¦ä¿è¯åå±ä¹é´çå·®å¼è¶³å¤æ¸æ°ï¼è¾¹çè¶³å¤ææ¾ï¼è®©äººçå°æ¶æå¾åå°±è½çææ´ä¸ªæ¶æ\n\nåå±æ¶ææ¯å¾å¸¸è§çæ¶ææ¨¡å¼ï¼å®ä¹å« n å±æ¶æï¼éå¸¸æåµä¸ï¼n è³å°æ¯ 2 å±ãä¾å¦ï¼c/s æ¶æãb/s æ¶æãå¸¸è§çæ¯ 3 å±æ¶æï¼ä¾å¦ï¼mvcãmvp æ¶æï¼ã4 å±æ¶æï¼5 å±æ¶æçæ¯è¾å°è§ï¼ä¸è¬æ¯æ¯è¾å¤æçç³»ç»æä¼è¾¾å°æèè¶è¿ 5 å±ï¼æ¯å¦æä½ç³»ç»åæ ¸æ¶æã\n\nå¸ååå±æ¶æï¼\n\n * c/s æ¶æãb/s æ¶æ\n * mvc æ¶æãmvp æ¶æ\n * é»è¾åå±æ¶æ\n\n\n# 2.2. soa\n\nsoa çå¨ç§°æ¯ service oriented architectureï¼å³âé¢åæå¡çæ¶æâã\n\nsoa æåºäº 3 ä¸ªå³é®æ¦å¿µã\n\n * æå¡ - ææä¸å¡åè½é½æ¯ä¸é¡¹æå¡ï¼æå¡å°±æå³çè¦å¯¹å¤æä¾å¼æ¾çè½åï¼å½å¶ä»ç³»ç»éè¦ä½¿ç¨è¿é¡¹åè½æ¶ï¼æ é¡»å®å¶åå¼åã\n * esb - esb çå¨ç§°æ¯ enterprise service busï¼å³ âä¼ä¸æå¡æ»çº¿âãesb å°ä¼ä¸ä¸­åä¸ªä¸åçæå¡è¿æ¥å¨ä¸èµ·ãå ä¸ºåä¸ªç¬ç«çæå¡æ¯å¼æçï¼å¦ææ²¡æç»ä¸çæ åï¼ååä¸ªå¼æç³»ç»å¯¹å¤æä¾çæ¥å£æ¯åå¼åæ ·çãsoa ä½¿ç¨ esb æ¥å±è½å¼æç³»ç»å¯¹å¤æä¾åç§ä¸åçæ¥å£æ¹å¼ï¼ä»¥æ­¤æ¥è¾¾å°æå¡é´é«æçäºèäºéã\n * æ¾è¦å - æ¾è¦åçç®çæ¯åå°åä¸ªæå¡é´çä¾èµåäºç¸å½±åãå ä¸ºéç¨ soa æ¶æåï¼åä¸ªæå¡æ¯ç¸äºç¬ç«è¿è¡çï¼çè³é½ä¸æ¸æ¥æä¸ªæå¡å°åºæå¤å°å¯¹å¶ä»æå¡çä¾èµãå¦æåä¸å°æ¾è¦åï¼æä¸ªæå¡ä¸åçº§ï¼ä¾èµå®çå¶ä»æå¡å¨é¨æéï¼è¿æ ·è¯å®æ¯æ æ³æ»¡è¶³ä¸å¡éæ±çã\n\n\n# 2.3. å¾®æå¡\n\nå¾®æå¡æ¯å»æ esb åç soaã\n\nå¾®æå¡çé®é¢ï¼\n\n * æå¡ååè¿ç»ï¼æå¡é´å³ç³»å¤æ - æå¡ååè¿ç»ï¼åä¸ªæå¡çå¤æåº¦ç¡®å®ä¸éäºï¼ä½æ´ä¸ªç³»ç»çå¤æåº¦å´ä¸åäºï¼å ä¸ºå¾®æå¡å°ç³»ç»åçå¤æåº¦è½¬ç§»ä¸ºç³»ç»é´çå¤æåº¦äºã\n * æå¡æ°éå¤ªå¤ï¼å¢éæçæ¥å§ä¸é\n * è°ç¨é¾å¤ªé¿ï¼æ§è½ä¸é\n * è°ç¨é¾å¤ªé¿ï¼é®é¢å®ä½å°é¾\n * æ²¡æèªå¨åæ¯æï¼æ æ³å¿«éäº¤ä»\n * æ²¡ææå¡æ²»çï¼å¾®æå¡æ°éå¤äºåç®¡çæ··ä¹±\n\nå¾®æå¡æåï¼\n\n * åºäºä¸å¡é»è¾æå\n * åºäºå¯æ©å±æå - å°å·²ç»æçåæ¹å¨ä¸å¤§çæå¡æåä¸ºç¨³å®æå¡ï¼å°ç»å¸¸åååè¿­ä»£çæå¡æåä¸ºåå¨æå¡ã\n * åºäºå¯é æ§æå - å°ç³»ç»ä¸­çä¸å¡æ¨¡åæç§ä¼åçº§æåºï¼å°å¯é æ§è¦æ±é«çæ ¸å¿æå¡åå¯é æ§è¦æ±ä½çéæ ¸å¿æå¡æåå¼æ¥ï¼ç¶åéç¹ä¿è¯æ ¸å¿æå¡çé«å¯ç¨ã\n\nåºç¡è®¾æ½ï¼\n\n * æå¡åç°ãæå¡è·¯ç±ãæå¡å®¹éï¼è¿æ¯æåºæ¬çå¾®æå¡åºç¡è®¾æ½ã\n * æ¥å£æ¡æ¶ãapi ç½å³ï¼ä¸»è¦æ¯ä¸ºäºæåå¼åæçï¼æ¥å£æ¡æ¶æ¯æååé¨æå¡çå¼åæçï¼api ç½å³æ¯ä¸ºäºæåä¸å¤é¨æå¡å¯¹æ¥çæçã\n * èªå¨åé¨ç½²ãèªå¨åæµè¯ãéç½®ä¸­å¿ï¼ä¸»è¦æ¯ä¸ºäºæåæµè¯åè¿ç»´æçã\n * æå¡çæ§ãæå¡è·è¸ªãæå¡å®å¨ï¼ä¸»è¦æ¯ä¸ºäºè¿ä¸æ­¥æåè¿ç»´æçã\n\n\n# 2.4. å¾®åæ ¸\n\n\n\nå¾®åæ ¸çæ ¸å¿ç³»ç»è®¾è®¡çå³é®ææ¯æï¼æä»¶ç®¡çãæä»¶è¿æ¥åæä»¶éä¿¡ã\n\næä»¶ç®¡ç\n\næ ¸å¿ç³»ç»éè¦ç¥éå½åæåªäºæä»¶å¯ç¨ï¼å¦ä½å è½½è¿äºæä»¶ï¼ä»ä¹æ¶åå è½½æä»¶ãå¸¸è§çå®ç°æ¹æ³æ¯æä»¶æ³¨åè¡¨æºå¶ãæ ¸å¿ç³»ç»æä¾æä»¶æ³¨åè¡¨ï¼å¯ä»¥æ¯éç½®æä»¶ï¼ä¹å¯ä»¥æ¯ä»£ç ï¼è¿å¯ä»¥æ¯æ°æ®åºï¼ï¼æä»¶æ³¨åè¡¨å«ææ¯ä¸ªæä»¶æ¨¡åçä¿¡æ¯ï¼åæ¬å®çåå­ãä½ç½®ãå è½½æ¶æºï¼å¯å¨å°±å è½½ï¼è¿æ¯æéå è½½ï¼ç­ã\n\næä»¶è¿æ¥\n\næä»¶è¿æ¥ææä»¶å¦ä½è¿æ¥å°æ ¸å¿ç³»ç»ãéå¸¸æ¥è¯´ï¼æ ¸å¿ç³»ç»å¿é¡»å¶å®æä»¶åæ ¸å¿ç³»ç»çè¿æ¥è§èï¼ç¶åæä»¶æç§è§èå®ç°ï¼æ ¸å¿ç³»ç»æç§è§èå è½½å³å¯ã\n\nå¸¸è§çè¿æ¥æºå¶æ osgiï¼eclipse ä½¿ç¨ï¼ãæ¶æ¯æ¨¡å¼ãä¾èµæ³¨å¥ï¼spring ä½¿ç¨ï¼ï¼çè³ä½¿ç¨åå¸å¼çåè®®é½æ¯å¯ä»¥çï¼æ¯å¦ rpc æè http web çæ¹å¼ã\n\næä»¶éä¿¡\n\næä»¶éä¿¡ææä»¶é´çéä¿¡ãè½ç¶è®¾è®¡çæ¶åæä»¶é´æ¯å®å¨è§£è¦çï¼ä½å®éä¸å¡è¿è¡è¿ç¨ä¸­ï¼å¿ç¶ä¼åºç°æä¸ªä¸å¡æµç¨éè¦å¤ä¸ªæä»¶åä½ï¼è¿å°±è¦æ±ä¸¤ä¸ªæä»¶é´è¿è¡éä¿¡ãç±äºæä»¶ä¹é´æ²¡æç´æ¥èç³»ï¼éä¿¡å¿é¡»éè¿æ ¸å¿ç³»ç»ï¼å æ­¤æ ¸å¿ç³»ç»éè¦æä¾æä»¶éä¿¡æºå¶ãè¿ç§æåµåè®¡ç®æºç±»ä¼¼ï¼è®¡ç®æºç cpuãç¡¬çãåå­ãç½å¡æ¯ç¬ç«è®¾è®¡çéä»¶ï¼ä½è®¡ç®æºè¿è¡è¿ç¨ä¸­ï¼cpu ååå­ãåå­åç¡¬çè¯å®æ¯æéä¿¡çï¼è®¡ç®æºéè¿ä¸»æ¿ä¸çæ»çº¿æä¾äºè¿äºç»ä»¶ä¹é´çéä¿¡åè½ãå¾®åæ ¸çæ ¸å¿ç³»ç»ä¹å¿é¡»æä¾ç±»ä¼¼çéä¿¡æºå¶ï¼åä¸ªæä»¶ä¹é´æè½è¿è¡æ­£å¸¸çéä¿¡ã\n\n\n# 3. ææ©å±çç³»ç»æ¶æ\n\n> ä½è¦åçç³»ç»æ´å®¹ææ©å±ãå¤ç¨ã\n\nå¯æ©å±æ¶æçæ ¸å¿ææ³æ¯æ¨¡ååï¼å¹¶å¨æ­¤åºç¡ä¸ï¼éä½æ¨¡åé´çè¦åæ§ï¼æé«æ¨¡åçå¤ç¨æ§ã\n\nåå±ååå²ä¸ä»å¯ä»¥è¿è¡æ¶æä¼¸ç¼©ï¼ä¹æ¯æ¨¡ååè®¾è®¡çéè¦ææ®µï¼å©ç¨åå±ååå²çæ¹å¼å°è½¯ä»¶åå²ä¸ºè¥å¹²ä¸ªä½è¦åçç¬ç«çç»ä»¶æ¨¡åï¼è¿äºç»ä»¶æ¨¡åä»¥æ¶æ¯ä¼ éåä¾èµè°ç¨çæ¹å¼èåæä¸ä¸ªå®æ´çç³»ç»ã\n\nå¨å¤§åç½ç«ä¸­ï¼è¿äºæ¨¡åéè¿åå¸å¼é¨ç½²çæ¹å¼ï¼ç¬ç«çæ¨¡åé¨ç½²å¨ç¬ç«çæå¡å¨ä¸ï¼ä»ç©çä¸åç¦»æ¨¡åé´çè¦åå³ç³»ï¼è¿ä¸æ­¥éä½è¦åæ§æé«å¤ç¨æ§ã\n\n\n# 4. å©ç¨åå¸å¼æ¶æ¯éåéä½ç³»ç»è¦åæ§\n\n\n# 4.1. äºä»¶é©±å¨æ¶æ\n\näºä»¶é©±å¨æ¶æéè¿å¨ä½è¦åçæ¨¡åé´ä¼ è¾äºä»¶æ¶æ¯ï¼ä»¥ä¿ææ¨¡åçæ¾æ£è¦åï¼å¹¶åå©äºä»¶æ¶æ¯çéä¿¡å®ææ¨¡åé´åä½ãå¸åçäºä»¶é©±å¨æ¶æå°±æ¯æä½ç³»ç»ä¸­å¸¸è§ççäº§èæ¶è´¹èæ¨¡å¼ãå¨å¤§åç½ç«ä¸­ï¼æå¸¸è§çå®ç°ææ®µå°±æ¯åå¸å¼æ¶æ¯éåã\n\n\n# 4.2. åå¸å¼æ¶æ¯éå\n\næ¶æ¯çäº§èåºç¨ç¨åºéè¿è¿ç¨è®¿é®æ¥å£å°æ¶æ¯æ¨éç»æ¶æ¯éåæå¡å¨ï¼æ¶æ¯éåæå¡å¨å°æ¶æ¯åå¥æ¬å°åå­éååç«å³è¿åæåååºç»æ¶æ¯çäº§èãæ¶æ¯éåæå¡å¨æ ¹æ®æ¶æ¯è®¢éåè¡¨æ¥æ¾è®¢éè¯¥æ¶æ¯çæ¶æ¯æ¶è´¹èåºç¨ç¨åºï¼å°æ¶æ¯éåä¸­çæ¶æ¯æç§åè¿ååºï¼fifoï¼çååå°æ¶æ¯éè¿è¿ç¨éä¿¡æ¥å£åéç»æ¶æ¯æ¶è´¹èç¨åºã\n\n\n\nå¨ä¼¸ç¼©æ§æ¹é¢ï¼ç±äºæ¶æ¯éåæå¡å¨ä¸çæ°æ®å¯ä»¥çä½æ¯å³æ¶å¤ççï¼å æ­¤ç±»ä¼¼äºæ ç¶æçæå¡å¨ï¼ä¼¸ç¼©æ§è®¾è®¡æ¯è¾ç®åãå°æ°æå¡å¨å å¥åå¸å¼æ¶æ¯éåéç¾¤ä¸­ï¼éç¥çäº§èæå¡å¨æ´æ¹æ¶æ¯éåæå¡å¨åè¡¨å³å¯ã\n\nå¨å¯ç¨æ§æ¹é¢ï¼ä¸ºäºé¿åæ¶è´¹èè¿ç¨å¤çç¼æ¢ï¼åå¸å¼æ¶æ¯éåæå¡å¨åå­ç©ºé´ä¸è¶³é æçé®é¢ï¼å¦æåå­éåå·²æ»¡ï¼ä¼å°æ¶æ¯åå¥ç£çï¼æ¶æ¯æ¨éæ¨¡åå¨å°åå­éåæ¶æ¯å¤çå®æä»¥åï¼å°ç£çåå®¹å è½½å°åå­éåç»§ç»­å¤çã\n\n\n# 5. å©ç¨åå¸å¼æå¡æé å¯å¤ç¨çä¸å¡å¹³å°\n\nå·¨æ é¸ç³»ç»çé®é¢ï¼\n\n * æå»ºãé¨ç½²å°é¾\n * ä»£ç åæ¯ç®¡çå°é¾\n * æ°æ®åºè¿æ¥èå°½\n * æ©å±ä¸å¡å°é¾\n\nèè§£å³å·¨æ é¸ç³»ç»é®é¢çæ¹æ¡å°±æ¯æåï¼\n\n * éè¿çºµåæåå°ä¸å¡æåå¤ä¸ªåºç¨ææ¨¡åï¼\n * éè¿æ¨ªåæåå°å¯å¤ç¨ä¸å¡ä½ä¸ºç¬ç«åºç¨ã\n\nç¶åï¼éè¦éè¿ä¸ä¸ªåå¸å¼æå¡ç®¡çæ¡æ¶å°è¿äºåºç¨ææå¡ç»ç»ç®¡çèµ·æ¥ï¼éè¿æ¥å£åè§£ç³»ç»è¦åæ§ï¼ä¸åå­ç³»ç»éè¿ç¸åçæ¥å£æè¿°è¿è¡æå¡è°ç¨ãå¸¸è§çåå¸å¼æå¡ç®¡çæ¡æ¶å¦ï¼spring cloudãdubbo ç­ã\n\nå¤§åç½ç«åå¸å¼æå¡çéæ±ä¸ç¹ç¹ï¼\n\n * è´è½½åè¡¡\n * å¤±æè½¬ç§»\n * é«æçè¿ç¨éä¿¡\n * æ´åå¼æç³»ç»\n * å¯¹åºç¨æå°ä¾µå¥\n * çæ¬ç®¡ç\n * å®æ¶çæ§\n\n\n# 6. å¯æ©å±çæ°æ®ç»æ\n\nä¼ ç»çå³ç³»åæ°æ®åºä¸ºäºä¿è¯å³ç³»è¿ç®çæ­£ç¡®æ§ï¼å¨è®¾è®¡æ°æ®åºè¡¨ç»æçæ¶åï¼å°±éè¦æå®è¡¨ç schema ââå­æ®µåç§°ï¼æ°æ®ç±»åç­ï¼å¹¶è¦éµå¾ªç¹å®çè®¾è®¡èå¼ãè¿äºè§èå¸¦æ¥ä¸ä¸ªé®é¢ï¼é¾ä»¥é¢å¯¹éæ±åæ´å¸¦æ¥çææï¼æä»¥æäººéè¿é¢åè®¾è®¡ä¸äºåä½å­æ®µæ¥åºå¯¹ã\n\nè®¸å¤ nosql æ°æ®åºä½¿ç¨ columnfamily è®¾è®¡æ¥è®¾è®¡å¯æ©å±çæ°æ®ç»æã\n\n\n# 7. å¼æ¾å¹³å°\n\nå¾å¤å¤§å¬å¸ä¼å©ç¨å¼æ¾å¹³å°æä¾å¤§éå¼æ¾æ§ api ä½¿å¾ä¼ä¸åä¸ªäººå¯ä»¥æ¹ä¾¿çæ¥å¥ä¸å¡ãéè¿å¼æ¾å¹³å°ï¼å¯ä»¥æå»ºçæåï¼æååçä»·å¼ä»¥åç«äºåã\n\nå¼æ¾å¹³å°ä¸æ¯ä¸æä¸å¤å®æçï¼è¿éè¦å¤§é open api çæ²æ·ãç³»ç»æ¶æå¨è®¾è®¡ä¹åï¼åºè¯¥ææè¯çå°æªæ¥å¯è½è¢«å¤ç¨çæ¥å£å¥½å¥½è®¾è®¡ï¼ä»¥ä¾¿äºéè¦å¼æ¾ open api æ¶ï¼å¯ä»¥ä¾¿æ·çæ´é²æå¡æ¥å£ã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»å®å¨æ§æ¶æ",frontmatter:{title:"ç³»ç»å®å¨æ§æ¶æ",date:"2018-07-05T15:11:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","å®å¨"],permalink:"/pages/039552/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/07.%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E6%80%A7%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/07.ç³»ç»å®å¨æ§æ¶æ.md",key:"v-11101d84",path:"/pages/039552/",headers:[{level:2,title:"1. è®¤è¯",slug:"_1-è®¤è¯",normalizedTitle:"1. è®¤è¯",charIndex:54},{level:3,title:"1.1. SSO",slug:"_1-1-sso",normalizedTitle:"1.1. sso",charIndex:64},{level:4,title:"1.1.1. Session å±äº«é®é¢",slug:"_1-1-1-session-å±äº«é®é¢",normalizedTitle:"1.1.1. session å±äº«é®é¢",charIndex:184},{level:4,title:"1.1.2. Cookie è·¨å",slug:"_1-1-2-cookie-è·¨å",normalizedTitle:"1.1.2. cookie è·¨å",charIndex:455},{level:4,title:"1.1.3. CAS",slug:"_1-1-3-cas",normalizedTitle:"1.1.3. cas",charIndex:837},{level:3,title:"1.2. Oauth 2.0",slug:"_1-2-oauth-2-0",normalizedTitle:"1.2. oauth 2.0",charIndex:2109},{level:4,title:"1.2.1. åºæ¬åç",slug:"_1-2-1-åºæ¬åç",normalizedTitle:"1.2.1. åºæ¬åç",charIndex:2127},{level:4,title:"1.2.2. æææ¨¡å¼",slug:"_1-2-2-æææ¨¡å¼",normalizedTitle:"1.2.2. æææ¨¡å¼",charIndex:2613},{level:4,title:"1.2.3. ææç æ¨¡å¼",slug:"_1-2-3-ææç æ¨¡å¼",normalizedTitle:"1.2.3. ææç æ¨¡å¼",charIndex:2827},{level:4,title:"1.2.4. ç®åæ¨¡å¼",slug:"_1-2-4-ç®åæ¨¡å¼",normalizedTitle:"1.2.4. ç®åæ¨¡å¼",charIndex:4943},{level:4,title:"1.2.5. æ´æ°ä»¤ç",slug:"_1-2-5-æ´æ°ä»¤ç",normalizedTitle:"1.2.5. æ´æ°ä»¤ç",charIndex:8081},{level:2,title:"2. é´æ",slug:"_2-é´æ",normalizedTitle:"2. é´æ",charIndex:8530},{level:3,title:"2.1. RBAC",slug:"_2-1-rbac",normalizedTitle:"2.1. rbac",charIndex:8540},{level:3,title:"2.2. è§è²ç»§æ¿",slug:"_2-2-è§è²ç»§æ¿",normalizedTitle:"2.2. è§è²ç»§æ¿",charIndex:8746},{level:4,title:"2.2.1. èè´£åç¦»(Separation of Duty)",slug:"_2-2-1-èè´£åç¦»-separation-of-duty",normalizedTitle:"2.2.1. èè´£åç¦»(separation of duty)",charIndex:8857},{level:3,title:"2.3. RBAC0 æ¨¡å",slug:"_2-3-rbac0-æ¨¡å",normalizedTitle:"2.3. rbac0 æ¨¡å",charIndex:9198},{level:3,title:"2.4. RBAC1 æ¨¡å",slug:"_2-4-rbac1-æ¨¡å",normalizedTitle:"2.4. rbac1 æ¨¡å",charIndex:9499},{level:3,title:"2.5. RBAC2 æ¨¡å",slug:"_2-5-rbac2-æ¨¡å",normalizedTitle:"2.5. rbac2 æ¨¡å",charIndex:9742},{level:3,title:"2.6. RBAC3 æ¨¡å",slug:"_2-6-rbac3-æ¨¡å",normalizedTitle:"2.6. rbac3 æ¨¡å",charIndex:10081},{level:3,title:"2.7. ä»ä¹æ¯æé",slug:"_2-7-ä»ä¹æ¯æé",normalizedTitle:"2.7. ä»ä¹æ¯æé",charIndex:10189},{level:3,title:"2.8. ç¨æ·ç»çä½¿ç¨",slug:"_2-8-ç¨æ·ç»çä½¿ç¨",normalizedTitle:"2.8. ç¨æ·ç»çä½¿ç¨",charIndex:11088},{level:3,title:"2.9. å®ä¾åæ",slug:"_2-9-å®ä¾åæ",normalizedTitle:"2.9. å®ä¾åæ",charIndex:11533},{level:3,title:"2.10. å¦ä½è®¾è®¡ RBAC æéç³»ç»",slug:"_2-10-å¦ä½è®¾è®¡-rbac-æéç³»ç»",normalizedTitle:"2.10. å¦ä½è®¾è®¡ rbac æéç³»ç»",charIndex:11547},{level:3,title:"2.11. å®ä¾åæ",slug:"_2-11-å®ä¾åæ",normalizedTitle:"2.11. å®ä¾åæ",charIndex:11960},{level:2,title:"3. å®¡è®¡",slug:"_3-å®¡è®¡",normalizedTitle:"3. å®¡è®¡",charIndex:12334},{level:2,title:"4. ç½ç«æ»å»",slug:"_4-ç½ç«æ»å»",normalizedTitle:"4. ç½ç«æ»å»",charIndex:12350},{level:3,title:"4.1. XSS",slug:"_4-1-xss",normalizedTitle:"4.1. xss",charIndex:12423},{level:4,title:"4.1.1. æ¦å¿µ",slug:"_4-1-1-æ¦å¿µ",normalizedTitle:"4.1.1. æ¦å¿µ",charIndex:12435},{level:4,title:"4.1.2. æ»å»ææ®µåç®ç",slug:"_4-1-2-æ»å»ææ®µåç®ç",normalizedTitle:"4.1.2. æ»å»ææ®µåç®ç",charIndex:12904},{level:4,title:"4.1.3. åºå¯¹ææ®µ",slug:"_4-1-3-åºå¯¹ææ®µ",normalizedTitle:"4.1.3. åºå¯¹ææ®µ",charIndex:13222},{level:3,title:"4.2. CSRF",slug:"_4-2-csrf",normalizedTitle:"4.2. csrf",charIndex:13556},{level:4,title:"4.2.1. æ¦å¿µ",slug:"_4-2-1-æ¦å¿µ",normalizedTitle:"4.2.1. æ¦å¿µ",charIndex:13569},{level:4,title:"4.2.2. æ»å»ææ®µåç®ç",slug:"_4-2-2-æ»å»ææ®µåç®ç",normalizedTitle:"4.2.2. æ»å»ææ®µåç®ç",charIndex:13777},{level:4,title:"4.2.3. åºå¯¹ææ®µ",slug:"_4-2-3-åºå¯¹ææ®µ",normalizedTitle:"4.2.3. åºå¯¹ææ®µ",charIndex:13910},{level:3,title:"4.3. SQL æ³¨å¥",slug:"_4-3-sql-æ³¨å¥",normalizedTitle:"4.3. sql æ³¨å¥",charIndex:14250},{level:4,title:"4.3.1. æ¦å¿µ",slug:"_4-3-1-æ¦å¿µ",normalizedTitle:"4.3.1. æ¦å¿µ",charIndex:14265},{level:4,title:"4.3.2. æ»å»ææ®µåç®ç",slug:"_4-3-2-æ»å»ææ®µåç®ç",normalizedTitle:"4.3.2. æ»å»ææ®µåç®ç",charIndex:15574},{level:4,title:"4.3.3. åºå¯¹ææ®µ",slug:"_4-3-3-åºå¯¹ææ®µ",normalizedTitle:"4.3.3. åºå¯¹ææ®µ",charIndex:15918},{level:3,title:"4.4. DoS",slug:"_4-4-dos",normalizedTitle:"4.4. dos",charIndex:16236},{level:4,title:"4.4.1. æ»å»æ¹å¼",slug:"_4-4-1-æ»å»æ¹å¼",normalizedTitle:"4.4.1. æ»å»æ¹å¼",charIndex:16464},{level:4,title:"4.4.2. åºå¯¹ææ®µ",slug:"_4-4-2-åºå¯¹ææ®µ",normalizedTitle:"4.4.2. åºå¯¹ææ®µ",charIndex:16502},{level:2,title:"5. å å¯ææ¯",slug:"_5-å å¯ææ¯",normalizedTitle:"5. å å¯ææ¯",charIndex:16695},{level:3,title:"5.1. æ¶æ¯æè¦",slug:"_5-1-æ¶æ¯æè¦",normalizedTitle:"5.1. æ¶æ¯æè¦",charIndex:16818},{level:3,title:"5.2. å å¯ç®æ³",slug:"_5-2-å å¯ç®æ³",normalizedTitle:"5.2. å å¯ç®æ³",charIndex:16903},{level:4,title:"5.2.1. å¯¹ç§°å å¯",slug:"_5-2-1-å¯¹ç§°å å¯",normalizedTitle:"5.2.1. å¯¹ç§°å å¯",charIndex:16916},{level:4,title:"5.2.2. éå¯¹ç§°å å¯",slug:"_5-2-2-éå¯¹ç§°å å¯",normalizedTitle:"5.2.2. éå¯¹ç§°å å¯",charIndex:17e3},{level:4,title:"5.2.3. å¯é¥å®å¨ç®¡ç",slug:"_5-2-3-å¯é¥å®å¨ç®¡ç",normalizedTitle:"5.2.3. å¯é¥å®å¨ç®¡ç",charIndex:17177},{level:3,title:"5.3. è¯ä¹¦",slug:"_5-3-è¯ä¹¦",normalizedTitle:"5.3. è¯ä¹¦",charIndex:17338},{level:4,title:"5.3.1. è¯ä¹¦åç",slug:"_5-3-1-è¯ä¹¦åç",normalizedTitle:"5.3.1. è¯ä¹¦åç",charIndex:17895},{level:2,title:"6. ä¿¡æ¯è¿æ»¤",slug:"_6-ä¿¡æ¯è¿æ»¤",normalizedTitle:"6. ä¿¡æ¯è¿æ»¤",charIndex:18341},{level:3,title:"6.1. ææ¬å¹é",slug:"_6-1-ææ¬å¹é",normalizedTitle:"6.1. ææ¬å¹é",charIndex:18394},{level:3,title:"6.2. é»åå",slug:"_6-2-é»åå",normalizedTitle:"6.2. é»åå",charIndex:18454},{level:3,title:"6.3. åç±»ç®æ³",slug:"_6-3-åç±»ç®æ³",normalizedTitle:"6.3. åç±»ç®æ³",charIndex:18634},{level:2,title:"7. é£é©æ§å¶",slug:"_7-é£é©æ§å¶",normalizedTitle:"7. é£é©æ§å¶",charIndex:18784},{level:3,title:"7.1. é£é©ç§ç±»",slug:"_7-1-é£é©ç§ç±»",normalizedTitle:"7.1. é£é©ç§ç±»",charIndex:18884},{level:3,title:"7.2. é£é©æ§å¶ææ®µ",slug:"_7-2-é£é©æ§å¶ææ®µ",normalizedTitle:"7.2. é£é©æ§å¶ææ®µ",charIndex:19016},{level:3,title:"7.3. è§åå¼æ",slug:"_7-3-è§åå¼æ",normalizedTitle:"7.3. è§åå¼æ",charIndex:19109},{level:3,title:"7.4. ç»è®¡æ¨¡å",slug:"_7-4-ç»è®¡æ¨¡å",normalizedTitle:"7.4. ç»è®¡æ¨¡å",charIndex:19346},{level:2,title:"8. åèèµæ",slug:"_8-åèèµæ",normalizedTitle:"8. åèèµæ",charIndex:19586}],headersStr:"1. è®¤è¯ 1.1. SSO 1.1.1. Session å±äº«é®é¢ 1.1.2. Cookie è·¨å 1.1.3. CAS 1.2. Oauth 2.0 1.2.1. åºæ¬åç 1.2.2. æææ¨¡å¼ 1.2.3. ææç æ¨¡å¼ 1.2.4. ç®åæ¨¡å¼ 1.2.5. æ´æ°ä»¤ç 2. é´æ 2.1. RBAC 2.2. è§è²ç»§æ¿ 2.2.1. èè´£åç¦»(Separation of Duty) 2.3. RBAC0 æ¨¡å 2.4. RBAC1 æ¨¡å 2.5. RBAC2 æ¨¡å 2.6. RBAC3 æ¨¡å 2.7. ä»ä¹æ¯æé 2.8. ç¨æ·ç»çä½¿ç¨ 2.9. å®ä¾åæ 2.10. å¦ä½è®¾è®¡ RBAC æéç³»ç» 2.11. å®ä¾åæ 3. å®¡è®¡ 4. ç½ç«æ»å» 4.1. XSS 4.1.1. æ¦å¿µ 4.1.2. æ»å»ææ®µåç®ç 4.1.3. åºå¯¹ææ®µ 4.2. CSRF 4.2.1. æ¦å¿µ 4.2.2. æ»å»ææ®µåç®ç 4.2.3. åºå¯¹ææ®µ 4.3. SQL æ³¨å¥ 4.3.1. æ¦å¿µ 4.3.2. æ»å»ææ®µåç®ç 4.3.3. åºå¯¹ææ®µ 4.4. DoS 4.4.1. æ»å»æ¹å¼ 4.4.2. åºå¯¹ææ®µ 5. å å¯ææ¯ 5.1. æ¶æ¯æè¦ 5.2. å å¯ç®æ³ 5.2.1. å¯¹ç§°å å¯ 5.2.2. éå¯¹ç§°å å¯ 5.2.3. å¯é¥å®å¨ç®¡ç 5.3. è¯ä¹¦ 5.3.1. è¯ä¹¦åç 6. ä¿¡æ¯è¿æ»¤ 6.1. ææ¬å¹é 6.2. é»åå 6.3. åç±»ç®æ³ 7. é£é©æ§å¶ 7.1. é£é©ç§ç±» 7.2. é£é©æ§å¶ææ®µ 7.3. è§åå¼æ 7.4. ç»è®¡æ¨¡å 8. åèèµæ",content:'# ç³»ç»å®å¨æ§æ¶æ\n\n> å³é®è¯ï¼XSSãCSRFãSQL æ³¨å¥ãDoSãæ¶æ¯æè¦ãå å¯ç®æ³ãè¯ä¹¦\n\n\n# 1. è®¤è¯\n\n\n# 1.1. SSO\n\nSSO(Single Sign On)ï¼å³åç¹ç»å½ãæè°åç¹ç»å½ï¼å°±æ¯åå¹³å°çè¯¸å¤åºç¨ç»éä¸æ¬¡ï¼ä¸ä¸æ¬¡å°±åç»éçåè½ã\n\nSSO éè¦è§£å³å¤ä¸ªå¼æç³»ç»ä¹é´çé®é¢ï¼\n\n * Session å±äº«é®é¢\n * è·¨åé®é¢\n\n# 1.1.1. Session å±äº«é®é¢\n\nåå¸å¼ Session çå ç§å®ç°ç­ç¥ï¼\n\n * ç²æ§ Session - ç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ Sessionã\n * åºç¨æå¡å¨é´ç Session å¤å¶å±äº« - ç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n * åºäºç¼å­ç Session å±äº« â ï¼æ¨èæ¹æ¡ï¼ - ä¸è¿éè¦ç¨åºèªèº«æ§å¶ Session è¯»åï¼å¯ä»¥èèåºäº spring-session + redis è¿ç§æççæ¹æ¡æ¥å¤çã\n\n> è¯¦æè¯·åèï¼Session åç\n\n# 1.1.2. Cookie è·¨å\n\nCookie ä¸è½è·¨åï¼æ¯å¦ï¼æµè§å¨ä¸ä¼æ www.google.com ç cookie ä¼ ç» www.baidu.comã\n\nè¿å°±å­å¨ä¸ä¸ªé®é¢ï¼ç±äºååä¸åï¼ç¨æ·å¨ç³»ç» A ç»å½åï¼æµè§å¨è®°å½ç³»ç» A ç Cookieï¼ä½æ¯è®¿é®ç³»ç» B çæ¶åä¸ä¼æºå¸¦è¿ä¸ª Cookieã\n\néå¯¹ Cookie ä¸è½è·¨å çé®é¢ï¼æå ç§è§£å³æ¹æ¡ï¼\n\n * æå¡ç«¯çæ Cookie åï¼è¿åç»å®¢æ·ç«¯ï¼å®¢æ·ç«¯è§£æ Cookie ï¼æå Token ï¼æ¯å¦ JWTï¼ï¼æ­¤åæ¯æ¬¡è¯·æ±é½æºå¸¦è¿ä¸ª Tokenã\n * å¤ä¸ªååå±äº« Cookieï¼å¨è¿å Cookie ç»å®¢æ·ç«¯çæ¶åï¼å¨ Cookie ä¸­è®¾ç½® domain ç½ååã\n * å° Token ä¿å­å¨ SessionStroage ä¸­ï¼ä¸ä¾èµ Cookie å°±æ²¡æè·¨åçé®é¢äºï¼ã\n\n# 1.1.3. CAS\n\nCAS æ¯å®ç° SSO çä¸»æµæ¹å¼ã\n\nCAS åä¸ºä¸¤é¨åï¼CAS Server å CAS Client\n\n * CAS Server - è´è´£ç¨æ·çè®¤è¯å·¥ä½ï¼å°±åæ¯æç¬¬ä¸æ¬¡ç»å½ç¨æ·çä¸ä¸ªæ è¯å­å¨è¿éï¼ä»¥ä¾¿æ­¤ç¨æ·å¨å¶ä»ç³»ç»ç»å½æ¶éªè¯å¶éä¸éè¦åæ¬¡ç»å½ã\n * CAS Client - ä¸å¡åºç¨ï¼éè¦æ¥å¥ CAS Serverãå½ç¨æ·è®¿é®æä»¬çåºç¨æ¶ï¼é¦åéè¦éå®åå° CAS Server ç«¯è¿è¡éªè¯ï¼è¦æ¯åæ¥ç»éè¿ï¼å°±åå»ç»å½ï¼éå®åå°ä¸æ¸¸ç³»ç»ï¼å¦åè¿è¡ç¨æ·åå¯ç ç»éæä½ã\n\næ¯è¯­ï¼\n\n * Ticket Granting Ticket (TGT) - å¯ä»¥è®¤ä¸ºæ¯ CAS Server æ ¹æ®ç¨æ·åãå¯ç çæçä¸å¼ ç¥¨ï¼å­å¨ Server ç«¯ã\n * Ticket Granting Cookie (TGC) - å¶å®å°±æ¯ä¸ä¸ª Cookieï¼å­æ¾ç¨æ·èº«ä»½ä¿¡æ¯ï¼ç± Server åç» Client ç«¯ã\n * Service Ticket (ST) - ç± TGT çæçä¸æ¬¡æ§ç¥¨æ®ï¼ç¨äºéªè¯ï¼åªè½ç¨ä¸æ¬¡ã\n\nCAS å·¥ä½æµç¨ï¼\n\n\n\n 1. ç¨æ·è®¿é® CAS Client Aï¼ä¸å¡ç³»ç»ï¼ï¼ç¬¬ä¸æ¬¡è®¿é®ï¼éå®åå°è®¤è¯æå¡ä¸­å¿ï¼CAS Serverï¼ãCAS Server åç°å½åè¯·æ±ä¸­æ²¡æ Cookieï¼åéå®åå° CAS Server çç»å½é¡µé¢ãéå®åè¯·æ±ç URL ä¸­åå«è®¿é®å°åï¼ä»¥ä¾¿è®¤è¯æååç´æ¥è·³è½¬å°è®¿é®é¡µé¢ã\n 2. ç¨æ·å¨ç»å½é¡µé¢è¾å¥ç¨æ·åãå¯ç ç­è®¤è¯ä¿¡æ¯ï¼è®¤è¯æååï¼CAS Server çæ TGTï¼åç¨ TGT çæä¸ä¸ª STãç¶åè¿å ST å TGCï¼Cookieï¼ç»æµè§å¨ã\n 3. æµè§å¨æºå¸¦ ST ååº¦è®¿é®ä¹åæ³è®¿é®ç CAS Client A é¡µé¢ã\n 4. CAS Client A æ¶å° ST åï¼å CAS Server éªè¯ ST çæææ§ãéªè¯éè¿ååè®¸ç¨æ·è®¿é®é¡µé¢ã\n 5. æ­¤æ¶ï¼å¦æç»å½å¦ä¸ä¸ª CAS Client Bï¼ä¼åéå®åå° CAS Serverï¼CAS Server å¯ä»¥å¤æ­è¿ä¸ª CAS Client B æ¯ç¬¬ä¸æ¬¡è®¿é®ï¼ä½æ¯æ¬å°æ TGCï¼æä»¥æ éåæ¬¡ç»å½ãç¨ TGC åå»ºä¸ä¸ª STï¼è¿åç»æµè§å¨ã\n 6. éå¤ç±»ä¼¼ 3ã4 æ­¥éª¤ã\n\n\n\nä»¥ä¸äºå½çº³æ»ç»å¦ä¸ï¼\n\n 1. è®¿é®æå¡ - ç¨æ·è®¿é® SSO Client èµæºã\n 2. å®åè®¤è¯ - SSO Client éå®åç¨æ·è¯·æ±å° SSO Serverã\n 3. ç¨æ·è®¤è¯ - ç¨æ·èº«ä»½è®¤è¯ã\n 4. åæ¾ç¥¨æ® - SSO Server ä¼äº§çä¸ä¸ª Service Ticket (ST) å¹¶è¿åç»æµè§å¨ã\n 5. éªè¯ç¥¨æ® - æµè§å¨æ¯æ¬¡è®¿é® SSO Client æ¶ï¼æºå¸¦ STï¼SSO Client å SSO Server éªè¯ç¥¨æ®ãåªæéªè¯éè¿ï¼æåè®¸è®¿é®ã\n 6. ä¼ è¾ç¨æ·ä¿¡æ¯ - SSO Server éªè¯ç¥¨æ®éè¿åï¼ä¼ è¾ç¨æ·è®¤è¯ç»æä¿¡æ¯ç» SSO Clientã\n\n\n# 1.2. Oauth 2.0\n\n# 1.2.1. åºæ¬åç\n\nOAuth å¨"å®¢æ·ç«¯"ä¸"æå¡æä¾å"ä¹é´ï¼è®¾ç½®äºä¸ä¸ªææå±ï¼authorization layerï¼ã"å®¢æ·ç«¯"ä¸è½ç´æ¥ç»å½"æå¡æä¾å"ï¼åªè½ç»å½ææå±ï¼ä»¥æ­¤å°ç¨æ·ä¸å®¢æ·ç«¯åºåå¼æ¥ã"å®¢æ·ç«¯"ç»å½ææå±æç¨çä»¤çï¼tokenï¼ï¼ä¸ç¨æ·çå¯ç ä¸åãç¨æ·å¯ä»¥å¨ç»å½çæ¶åï¼æå®ææå±ä»¤ççæéèå´åæææã\n\n"å®¢æ·ç«¯"ç»å½ææå±ä»¥åï¼"æå¡æä¾å"æ ¹æ®ä»¤ççæéèå´åæææï¼å"å®¢æ·ç«¯"å¼æ¾ç¨æ·å¨å­çèµæã\n\nOAuth 2.0 çè¿è¡æµç¨å¦ä¸å¾ï¼æèª RFC 6749ã\n\n\nï¼Aï¼ç¨æ·æå¼å®¢æ·ç«¯ä»¥åï¼å®¢æ·ç«¯è¦æ±ç¨æ·ç»äºææã\n\nï¼Bï¼ç¨æ·åæç»äºå®¢æ·ç«¯ææã\n\nï¼Cï¼å®¢æ·ç«¯ä½¿ç¨ä¸ä¸æ­¥è·å¾çææï¼åè®¤è¯æå¡å¨ç³è¯·ä»¤çã\n\nï¼Dï¼è®¤è¯æå¡å¨å¯¹å®¢æ·ç«¯è¿è¡è®¤è¯ä»¥åï¼ç¡®è®¤æ è¯¯ï¼åæåæ¾ä»¤çã\n\nï¼Eï¼å®¢æ·ç«¯ä½¿ç¨ä»¤çï¼åèµæºæå¡å¨ç³è¯·è·åèµæºã\n\nï¼Fï¼èµæºæå¡å¨ç¡®è®¤ä»¤çæ è¯¯ï¼åæåå®¢æ·ç«¯å¼æ¾èµæºã\n\nä¸é¾çåºæ¥ï¼ä¸é¢å­ä¸ªæ­¥éª¤ä¹ä¸­ï¼B æ¯å³é®ï¼å³ç¨æ·ææ ·æè½ç»äºå®¢æ·ç«¯ææãæäºè¿ä¸ªææä»¥åï¼å®¢æ·ç«¯å°±å¯ä»¥è·åä»¤çï¼è¿èå­ä»¤çè·åèµæºã\n\n# 1.2.2. æææ¨¡å¼\n\nå®¢æ·ç«¯å¿é¡»å¾å°ç¨æ·çææï¼authorization grantï¼ï¼æè½è·å¾ä»¤çï¼access tokenï¼ãOAuth 2.0 å®ä¹äºåç§æææ¹å¼ã\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\n# 1.2.3. ææç æ¨¡å¼\n\nææç æ¨¡å¼ï¼authorization codeï¼æ¯åè½æå®æ´ãæµç¨æä¸¥å¯çæææ¨¡å¼ãå®çç¹ç¹å°±æ¯éè¿å®¢æ·ç«¯çåå°æå¡å¨ï¼ä¸"æå¡æä¾å"çè®¤è¯æå¡å¨è¿è¡äºå¨ã\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼Aï¼ç¨æ·è®¿é®å®¢æ·ç«¯ï¼åèå°åèå¯¼åè®¤è¯æå¡å¨ã\n\nï¼Bï¼ç¨æ·éæ©æ¯å¦ç»äºå®¢æ·ç«¯ææã\n\nï¼Cï¼åè®¾ç¨æ·ç»äºææï¼è®¤è¯æå¡å¨å°ç¨æ·å¯¼åå®¢æ·ç«¯äºåæå®ç"éå®å URI"ï¼redirection URIï¼ï¼åæ¶éä¸ä¸ä¸ªææç ã\n\nï¼Dï¼å®¢æ·ç«¯æ¶å°ææç ï¼éä¸æ©åç"éå®å URI"ï¼åè®¤è¯æå¡å¨ç³è¯·ä»¤çãè¿ä¸æ­¥æ¯å¨å®¢æ·ç«¯çåå°çæå¡å¨ä¸å®æçï¼å¯¹ç¨æ·ä¸å¯è§ã\n\nï¼Eï¼è®¤è¯æå¡å¨æ ¸å¯¹äºææç åéå®å URIï¼ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼access tokenï¼åæ´æ°ä»¤çï¼refresh tokenï¼ã\n\nä¸é¢æ¯ä¸é¢è¿äºæ­¥éª¤æéè¦çåæ°ã\n\nA æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ç³è¯·è®¤è¯ç URIï¼åå«ä»¥ä¸åæ°ï¼\n\n * response_typeï¼è¡¨ç¤ºææç±»åï¼å¿éé¡¹ï¼æ­¤å¤çå¼åºå®ä¸º"code"\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ç IDï¼å¿éé¡¹\n * redirect_uriï¼è¡¨ç¤ºéå®å URIï¼å¯éé¡¹\n * scopeï¼è¡¨ç¤ºç³è¯·çæéèå´ï¼å¯éé¡¹\n * stateï¼è¡¨ç¤ºå®¢æ·ç«¯çå½åç¶æï¼å¯ä»¥æå®ä»»æå¼ï¼è®¤è¯æå¡å¨ä¼åå°ä¸å¨å°è¿åè¿ä¸ªå¼ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nGET /authorize?response_type=code&client_id=s6BhdRkqt3&state=xyz\n  &redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1\nHost: server.example.com\n\n\nC æ­¥éª¤ä¸­ï¼æå¡å¨ååºå®¢æ·ç«¯ç URIï¼åå«ä»¥ä¸åæ°ï¼\n\n * codeï¼è¡¨ç¤ºææç ï¼å¿éé¡¹ãè¯¥ç çæææåºè¯¥å¾ç­ï¼éå¸¸è®¾ä¸º 10 åéï¼å®¢æ·ç«¯åªè½ä½¿ç¨è¯¥ç ä¸æ¬¡ï¼å¦åä¼è¢«æææå¡å¨æç»ãè¯¥ç ä¸å®¢æ·ç«¯ ID åéå®å URIï¼æ¯ä¸ä¸å¯¹åºå³ç³»ã\n * stateï¼å¦æå®¢æ·ç«¯çè¯·æ±ä¸­åå«è¿ä¸ªåæ°ï¼è®¤è¯æå¡å¨çååºä¹å¿é¡»ä¸æ¨¡ä¸æ ·åå«è¿ä¸ªåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nHTTP/1.1 302 Found\nLocation: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA\n    &state=xyz\n\n\nD æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯åè®¤è¯æå¡å¨ç³è¯·ä»¤çç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * grant_typeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼å¿éé¡¹ï¼æ­¤å¤çå¼åºå®ä¸º"authorization_code"ã\n * codeï¼è¡¨ç¤ºä¸ä¸æ­¥è·å¾çææç ï¼å¿éé¡¹ã\n * redirect_uriï¼è¡¨ç¤ºéå®å URIï¼å¿éé¡¹ï¼ä¸å¿é¡»ä¸ A æ­¥éª¤ä¸­çè¯¥åæ°å¼ä¿æä¸è´ã\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ IDï¼å¿éé¡¹ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nPOST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&code=SplxlOBeZQQYbYS6WxSbIA\n&redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\n\n\nE æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åéç HTTP åå¤ï¼åå«ä»¥ä¸åæ°ï¼\n\n * access_tokenï¼è¡¨ç¤ºè®¿é®ä»¤çï¼å¿éé¡¹ã\n * token_typeï¼è¡¨ç¤ºä»¤çç±»åï¼è¯¥å¼å¤§å°åä¸ææï¼å¿éé¡¹ï¼å¯ä»¥æ¯ bearer ç±»åæ mac ç±»åã\n * expires_inï¼è¡¨ç¤ºè¿ææ¶é´ï¼åä½ä¸ºç§ãå¦æçç¥è¯¥åæ°ï¼å¿é¡»å¶ä»æ¹å¼è®¾ç½®è¿ææ¶é´ã\n * refresh_tokenï¼è¡¨ç¤ºæ´æ°ä»¤çï¼ç¨æ¥è·åä¸ä¸æ¬¡çè®¿é®ä»¤çï¼å¯éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¦æä¸å®¢æ·ç«¯ç³è¯·çèå´ä¸è´ï¼æ­¤é¡¹å¯çç¥ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nHTTP/1.1 200 OK\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\nPragma: no-cache\n\n{\n "access_token":"2YotnFZFEjr1zCsicMWpAA",\n "token_type":"example",\n "expires_in":3600,\n "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",\n "example_parameter":"example_value"\n}\n\n\nä»ä¸é¢ä»£ç å¯ä»¥çå°ï¼ç¸å³åæ°ä½¿ç¨ JSON æ ¼å¼åéï¼Content-Type: application/jsonï¼ãæ­¤å¤ï¼HTTP å¤´ä¿¡æ¯ä¸­æç¡®æå®ä¸å¾ç¼å­ã\n\n# 1.2.4. ç®åæ¨¡å¼\n\nç®åæ¨¡å¼ï¼implicit grant typeï¼ä¸éè¿ç¬¬ä¸æ¹åºç¨ç¨åºçæå¡å¨ï¼ç´æ¥å¨æµè§å¨ä¸­åè®¤è¯æå¡å¨ç³è¯·ä»¤çï¼è·³è¿äº"ææç "è¿ä¸ªæ­¥éª¤ï¼å æ­¤å¾åãæææ­¥éª¤å¨æµè§å¨ä¸­å®æï¼ä»¤çå¯¹è®¿é®èæ¯å¯è§çï¼ä¸å®¢æ·ç«¯ä¸éè¦è®¤è¯ã\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼Aï¼å®¢æ·ç«¯å°ç¨æ·å¯¼åè®¤è¯æå¡å¨ã\n\nï¼Bï¼ç¨æ·å³å®æ¯å¦ç»äºå®¢æ·ç«¯ææã\n\nï¼Cï¼åè®¾ç¨æ·ç»äºææï¼è®¤è¯æå¡å¨å°ç¨æ·å¯¼åå®¢æ·ç«¯æå®ç"éå®å URI"ï¼å¹¶å¨ URI ç Hash é¨ååå«äºè®¿é®ä»¤çã\n\nï¼Dï¼æµè§å¨åèµæºæå¡å¨ååºè¯·æ±ï¼å¶ä¸­ä¸åæ¬ä¸ä¸æ­¥æ¶å°ç Hash å¼ã\n\nï¼Eï¼èµæºæå¡å¨è¿åä¸ä¸ªç½é¡µï¼å¶ä¸­åå«çä»£ç å¯ä»¥è·å Hash å¼ä¸­çä»¤çã\n\nï¼Fï¼æµè§å¨æ§è¡ä¸ä¸æ­¥è·å¾çèæ¬ï¼æååºä»¤çã\n\nï¼Gï¼æµè§å¨å°ä»¤çåç»å®¢æ·ç«¯ã\n\nä¸é¢æ¯ä¸é¢è¿äºæ­¥éª¤æéè¦çåæ°ã\n\nA æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * response_typeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"token"ï¼å¿éé¡¹ã\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ç IDï¼å¿éé¡¹ã\n * redirect_uriï¼è¡¨ç¤ºéå®åç URIï¼å¯éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n * stateï¼è¡¨ç¤ºå®¢æ·ç«¯çå½åç¶æï¼å¯ä»¥æå®ä»»æå¼ï¼è®¤è¯æå¡å¨ä¼åå°ä¸å¨å°è¿åè¿ä¸ªå¼ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nGET /authorize?response_type=token&client_id=s6BhdRkqt3&state=xyz\n  &redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1\nHost: server.example.com\n\n\nC æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨ååºå®¢æ·ç«¯ç URIï¼åå«ä»¥ä¸åæ°ï¼\n\n * access_tokenï¼è¡¨ç¤ºè®¿é®ä»¤çï¼å¿éé¡¹ã\n * token_typeï¼è¡¨ç¤ºä»¤çç±»åï¼è¯¥å¼å¤§å°åä¸ææï¼å¿éé¡¹ã\n * expires_inï¼è¡¨ç¤ºè¿ææ¶é´ï¼åä½ä¸ºç§ãå¦æçç¥è¯¥åæ°ï¼å¿é¡»å¶ä»æ¹å¼è®¾ç½®è¿ææ¶é´ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¦æä¸å®¢æ·ç«¯ç³è¯·çèå´ä¸è´ï¼æ­¤é¡¹å¯çç¥ã\n * stateï¼å¦æå®¢æ·ç«¯çè¯·æ±ä¸­åå«è¿ä¸ªåæ°ï¼è®¤è¯æå¡å¨çååºä¹å¿é¡»ä¸æ¨¡ä¸æ ·åå«è¿ä¸ªåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nHTTP/1.1 302 Found\nLocation: http://example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA\n         &state=xyz&token_type=example&expires_in=3600\n\n\nå¨ä¸é¢çä¾å­ä¸­ï¼è®¤è¯æå¡å¨ç¨ HTTP å¤´ä¿¡æ¯ç Location æ ï¼æå®æµè§å¨éå®åçç½åãæ³¨æï¼å¨è¿ä¸ªç½åç Hash é¨ååå«äºä»¤çã\n\næ ¹æ®ä¸é¢ç D æ­¥éª¤ï¼ä¸ä¸æ­¥æµè§å¨ä¼è®¿é® Location æå®çç½åï¼ä½æ¯ Hash é¨åä¸ä¼åéãæ¥ä¸æ¥ç E æ­¥éª¤ï¼æå¡æä¾åçèµæºæå¡å¨åéè¿æ¥çä»£ç ï¼ä¼æååº Hash ä¸­çä»¤çã\n\nå¯ç æ¨¡å¼\n\nå¯ç æ¨¡å¼ï¼Resource Owner Password Credentials Grantï¼ä¸­ï¼ç¨æ·åå®¢æ·ç«¯æä¾èªå·±çç¨æ·ååå¯ç ãå®¢æ·ç«¯ä½¿ç¨è¿äºä¿¡æ¯ï¼å"æå¡åæä¾å"ç´¢è¦ææã\n\nå¨è¿ç§æ¨¡å¼ä¸­ï¼ç¨æ·å¿é¡»æèªå·±çå¯ç ç»å®¢æ·ç«¯ï¼ä½æ¯å®¢æ·ç«¯ä¸å¾å¨å­å¯ç ãè¿éå¸¸ç¨å¨ç¨æ·å¯¹å®¢æ·ç«¯é«åº¦ä¿¡ä»»çæåµä¸ï¼æ¯å¦å®¢æ·ç«¯æ¯æä½ç³»ç»çä¸é¨åï¼æèç±ä¸ä¸ªèåå¬å¸åºåãèè®¤è¯æå¡å¨åªæå¨å¶ä»æææ¨¡å¼æ æ³æ§è¡çæåµä¸ï¼æè½èèä½¿ç¨è¿ç§æ¨¡å¼ã\n\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼Aï¼ç¨æ·åå®¢æ·ç«¯æä¾ç¨æ·ååå¯ç ã\n\nï¼Bï¼å®¢æ·ç«¯å°ç¨æ·ååå¯ç åç»è®¤è¯æå¡å¨ï¼ååèè¯·æ±ä»¤çã\n\nï¼Cï¼è®¤è¯æå¡å¨ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯æä¾è®¿é®ä»¤çã\n\nB æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * grant_typeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"password"ï¼å¿éé¡¹ã\n * usernameï¼è¡¨ç¤ºç¨æ·åï¼å¿éé¡¹ã\n * passwordï¼è¡¨ç¤ºç¨æ·çå¯ç ï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nPOST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=password&username=johndoe&password=A3ddj3w\n\n\nC æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼ä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nHTTP/1.1 200 OK\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\nPragma: no-cache\n\n{\n "access_token":"2YotnFZFEjr1zCsicMWpAA",\n "token_type":"example",\n "expires_in":3600,\n "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",\n "example_parameter":"example_value"\n}\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸ªåæ°çå«ä¹åè§ãææç æ¨¡å¼ãä¸èã\n\næ´ä¸ªè¿ç¨ä¸­ï¼å®¢æ·ç«¯ä¸å¾ä¿å­ç¨æ·çå¯ç ã\n\nå®¢æ·ç«¯æ¨¡å¼\n\nå®¢æ·ç«¯æ¨¡å¼ï¼Client Credentials Grantï¼æå®¢æ·ç«¯ä»¥èªå·±çåä¹ï¼èä¸æ¯ä»¥ç¨æ·çåä¹ï¼å"æå¡æä¾å"è¿è¡è®¤è¯ãä¸¥æ ¼å°è¯´ï¼å®¢æ·ç«¯æ¨¡å¼å¹¶ä¸å±äº OAuth æ¡æ¶æè¦è§£å³çé®é¢ãå¨è¿ç§æ¨¡å¼ä¸­ï¼ç¨æ·ç´æ¥åå®¢æ·ç«¯æ³¨åï¼å®¢æ·ç«¯ä»¥èªå·±çåä¹è¦æ±"æå¡æä¾å"æä¾æå¡ï¼å¶å®ä¸å­å¨ææé®é¢ã\n\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼Aï¼å®¢æ·ç«¯åè®¤è¯æå¡å¨è¿è¡èº«ä»½è®¤è¯ï¼å¹¶è¦æ±ä¸ä¸ªè®¿é®ä»¤çã\n\nï¼Bï¼è®¤è¯æå¡å¨ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯æä¾è®¿é®ä»¤çã\n\nA æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"clientcredentials"ï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n\nPOST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=client_credentials\n\n\nè®¤è¯æå¡å¨å¿é¡»ä»¥æç§æ¹å¼ï¼éªè¯å®¢æ·ç«¯èº«ä»½ã\n\nB æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼ä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nHTTP/1.1 200 OK\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\nPragma: no-cache\n\n{\n "access_token":"2YotnFZFEjr1zCsicMWpAA",\n "token_type":"example",\n "expires_in":3600,\n "example_parameter":"example_value"\n}\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸ªåæ°çå«ä¹åè§ãææç æ¨¡å¼ãä¸èã\n\n# 1.2.5. æ´æ°ä»¤ç\n\nå¦æç¨æ·è®¿é®çæ¶åï¼å®¢æ·ç«¯ç"è®¿é®ä»¤ç"å·²ç»è¿æï¼åéè¦ä½¿ç¨"æ´æ°ä»¤ç"ç³è¯·ä¸ä¸ªæ°çè®¿é®ä»¤çã\n\nå®¢æ·ç«¯ååºæ´æ°ä»¤çç HTTP è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼æ­¤å¤çå¼åºå®ä¸º"refreshtoken"ï¼å¿éé¡¹ã\n * refresh_tokenï¼è¡¨ç¤ºæ©åæ¶å°çæ´æ°ä»¤çï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºç³è¯·çææèå´ï¼ä¸å¯ä»¥è¶åºä¸ä¸æ¬¡ç³è¯·çèå´ï¼å¦æçç¥è¯¥åæ°ï¼åè¡¨ç¤ºä¸ä¸ä¸æ¬¡ä¸è´ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nPOST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA\n\n\n\n# 2. é´æ\n\n\n# 2.1. RBAC\n\nRBACï¼Role-Based Access Controlï¼å³ï¼åºäºè§è²çæéæ§å¶ãéè¿è§è²å³èç¨æ·ï¼è§è²å³èæéçæ¹å¼é´æ¥èµäºç¨æ·æéã\n\næ¯ä¸ªç¨æ·å³èä¸ä¸ªæå¤ä¸ªè§è²ï¼æ¯ä¸ªè§è²å³èä¸ä¸ªæå¤ä¸ªæéï¼ä»èå¯ä»¥å®ç°äºéå¸¸çµæ´»çæéç®¡çãè§è²å¯ä»¥æ ¹æ®å®éä¸å¡éæ±çµæ´»åå»ºï¼è¿æ ·å°±çå»äºæ¯æ°å¢ä¸ä¸ªç¨æ·å°±è¦å³èä¸éæææéçéº»ç¦ãç®åæ¥è¯´ RBAC å°±æ¯ï¼ç¨æ·å³èè§è²ï¼è§è²å³èæéã\n\n\n\n\n# 2.2. è§è²ç»§æ¿\n\nè§è²ç»§æ¿(Hierarchical Role) å°±æ¯æè§è²å¯ä»¥ç»§æ¿äºå¶ä»è§è²ï¼å¨æ¥æå¶ä»è§è²æéçåæ¶ï¼èªå·±è¿å¯ä»¥å³èé¢å¤çæéãè¿ç§è®¾è®¡å¯ä»¥ç»è§è²åç»ååå±ï¼ä¸å®ç¨åº¦ç®åäºæéç®¡çå·¥ä½ã\n\n\n\n# 2.2.1. èè´£åç¦»(Separation of Duty)\n\nä¸ºäºé¿åç¨æ·æ¥æè¿å¤æéèäº§çå©çå²çªï¼ä¾å¦ä¸ä¸ªç¯®çè¿å¨ååæ¶æ¥æè£å¤çæéï¼çä¸ç¼å°±ç»ä½ å¤ç¯è§ç ä¸ç ï¼ï¼ï¼å¦ä¸ç§èè´£åç¦»æ©å±çç RBAC è¢«æåºã\n\nèè´£åç¦»æä¸¤ç§æ¨¡å¼ï¼\n\néæèè´£åç¦»(Static Separation of Duty)ï¼ç¨æ·æ æ³åæ¶è¢«èµäºæå²çªçè§è²ã\n\n\n\nå¨æèè´£åç¦»(Dynamic Separation of Duty)ï¼ç¨æ·å¨ä¸æ¬¡ä¼è¯ï¼Sessionï¼ä¸­ä¸è½åæ¶æ¿æ´»èªèº«ææ¥æçãäºç¸æå²çªçè§è²ï¼åªè½éæ©å¶ä¸ã\n\n\n\nè®²äºè¿ä¹å¤ RBACï¼é½è¿åªæ¯å¨ç¨æ·åæéä¹é´è¿è¡è®¾è®¡ï¼å¹¶æ²¡ææ¶åå°ç¨æ·åå¯¹è±¡ä¹é´çæéå¤æ­ï¼èå¨å®éä¸å¡ç³»ç»ä¸­éå¶ç¨æ·è½å¤ä½¿ç¨çå¯¹è±¡æ¯å¾å¸¸è§çéæ±ã\n\n\n# 2.3. RBAC0 æ¨¡å\n\næç®åçç¨æ·ãè§è²ãæéæ¨¡åãè¿éé¢ååå«äº 2 ç§ï¼\n\n 1. ç¨æ·åè§è²æ¯å¤å¯¹ä¸å³ç³»ï¼å³ï¼ä¸ä¸ªç¨æ·åªåå½ä¸ç§è§è²ï¼ä¸ç§è§è²å¯ä»¥æå¤ä¸ªç¨æ·æå½ã\n 2. ç¨æ·åè§è²æ¯å¤å¯¹å¤å³ç³»ï¼å³ï¼ä¸ä¸ªç¨æ·å¯åæ¶åå½å¤ç§è§è²ï¼ä¸ç§è§è²å¯ä»¥æå¤ä¸ªç¨æ·æå½ã\n\né£ä¹ï¼ä»ä¹æ¶åè¯¥ä½¿ç¨å¤å¯¹ä¸çæéä½ç³»ï¼ä»ä¹æ¶ååè¯¥ä½¿ç¨å¤å¯¹å¤çæéä½ç³»å¢ï¼\n\nå¦æç³»ç»åè½æ¯è¾åä¸ï¼ä½¿ç¨äººåè¾å°ï¼å²ä½æéç¸å¯¹æ¸æ°ä¸ç¡®ä¿ä¸ä¼åºç°å¼å²çæåµï¼æ­¤æ¶å¯ä»¥èèç¨å¤å¯¹ä¸çæéä½ç³»ãå¶ä½æåµå°½éä½¿ç¨å¤å¯¹å¤çæéä½ç³»ï¼ä¿è¯ç³»ç»çå¯æ©å±æ§ãå¦ï¼å¼ ä¸æ¢æ¯è¡æ¿ï¼ä¹è´è´£è´¢å¡å·¥ä½ï¼é£å¼ ä¸å°±åæ¶æ¥æè¡æ¿åè´¢å¡ä¸¤ä¸ªè§è²çæéã\n\n\n# 2.4. RBAC1 æ¨¡å\n\nç¸å¯¹äº RBAC0 æ¨¡åï¼å¢å äºå­è§è²ï¼å¼å¥äºç»§æ¿æ¦å¿µï¼å³å­è§è²å¯ä»¥ç»§æ¿ç¶è§è²çæææéã\n\n\n\n**ä½¿ç¨åºæ¯ï¼**å¦æä¸ªä¸å¡é¨é¨ï¼æç»çãä¸»ç®¡ãä¸åãä¸»ç®¡çæéä¸è½å¤§äºç»çï¼ä¸åçæéä¸è½å¤§äºä¸»ç®¡ï¼å¦æéç¨ RBAC0 æ¨¡ååæéç³»ç»ï¼æå¯è½åºç°åéæéå¤±è¯¯ï¼æç»åºç°ä¸»ç®¡æ¥æç»çé½æ²¡æçæéçæåµã\n\nè RBAC1 æ¨¡åå°±å¾å¥½è§£å³äºè¿ä¸ªé®é¢ï¼åå»ºå®ç»çè§è²å¹¶éç½®å¥½æéåï¼ä¸»ç®¡è§è²çæéç»§æ¿ç»çè§è²çæéï¼å¹¶ä¸æ¯æå¨ç»çæéä¸å åä¸»ç®¡æéã\n\n\n# 2.5. RBAC2 æ¨¡å\n\nåºäº RBAC0 æ¨¡åï¼å¢å äºå¯¹è§è²çä¸äºéå¶ï¼è§è²äºæ¥ãåºæ°çº¦æãåå³æ¡ä»¶è§è²ç­ã\n\n * **è§è²äºæ¥ï¼**åä¸ç¨æ·ä¸è½åéå°ä¸ç»äºæ¥è§è²éåä¸­çå¤ä¸ªè§è²ï¼äºæ¥è§è²æ¯ææéäºç¸å¶çº¦çä¸¤ä¸ªè§è²ãæ¡ä¾ï¼è´¢å¡ç³»ç»ä¸­ä¸ä¸ªç¨æ·ä¸è½åæ¶è¢«ææ´¾ç»ä¼è®¡è§è²åå®¡è®¡åè§è²ã\n * **åºæ°çº¦æï¼**ä¸ä¸ªè§è²è¢«åéçç¨æ·æ°éåéï¼å®æçæ¯æå¤å°ç¨æ·è½æ¥æè¿ä¸ªè§è²ãä¾å¦ï¼ä¸ä¸ªè§è²ä¸é¨ä¸ºå¬å¸ CEO åå»ºçï¼é£è¿ä¸ªè§è²çæ°éæ¯æéçã\n * **åå³æ¡ä»¶è§è²ï¼**æè¦æ³è·å¾è¾é«çæéï¼è¦é¦åæ¥æä½ä¸çº§çæéãä¾å¦ï¼åæå¯æ»ç»çæéï¼æè½ææ»ç»çæéã\n * **è¿è¡æ¶äºæ¥ï¼**ä¾å¦ï¼åè®¸ä¸ä¸ªç¨æ·å·æä¸¤ä¸ªè§è²çæåèµæ ¼ï¼ä½å¨è¿è¡ä¸­ä¸å¯åæ¶æ¿æ´»è¿ä¸¤ä¸ªè§è²ã\n\n\n# 2.6. RBAC3 æ¨¡å\n\nç§°ä¸ºç»ä¸æ¨¡åï¼å®åå«äº RBAC1 å RBAC2ï¼å©ç¨ä¼ éæ§ï¼ä¹æ RBAC0 åæ¬å¨åï¼ç»¼åäº RBAC0ãRBAC1 å RBAC2 çææç¹ç¹ï¼è¿éå°±ä¸å¨å¤æè¿°äºã\n\n\n\n\n# 2.7. ä»ä¹æ¯æé\n\nè¯´äºè¿ä¹ä¹ç¨æ·-è§è²-æéï¼å¯è½å°ä¼ä¼´ä»¬é½äºè§£äºä»ä¹æ¯ç¨æ·ãä»ä¹æ¯è§è²ãä½æ¯æçå°ä¼ä¼´ä¼å¥½å¥ï¼é£æéåæ¯ä¸ªä»ä¹ç©æå¢ï¼\n\næéæ¯èµæºçéåï¼è¿éçèµæºæçæ¯è½¯ä»¶ä¸­ææçåå®¹ï¼åæ¬æ¨¡åãèåãé¡µé¢ãå­æ®µãæä½åè½ï¼å¢å æ¹æ¥ï¼ç­ç­ãå·ä½çæééç½®ä¸ï¼ç®åå½¢å¼å¤ç§å¤æ ·ï¼æç§æä¸ªäººççè§£ï¼å¯ä»¥å°æéåä¸ºï¼é¡µé¢æéãæä½æéåæ°æ®æéï¼è¿ç§åç±»æ³ï¼ä¸»è¦æ¯ç»åèªå·±å¨å·¥ä½ä¸­çå®éæåµçè§£æ»ç»èæ¥ï¼è¥æä¸è¶³ä¹å¤ï¼ä¹è¯·å¤§å®¶æåºï¼ã\n\n**é¡µé¢æéï¼**ææç³»ç»é½æ¯ç±ä¸ä¸ªä¸ªçé¡µé¢ç»æï¼é¡µé¢åç»ææ¨¡åï¼ç¨æ·æ¯å¦è½çå°è¿ä¸ªé¡µé¢çèåãæ¯å¦è½è¿å¥è¿ä¸ªé¡µé¢å°±ç§°ä¸ºé¡µé¢æéã\n\nå¦ä¸å¾ï¼\n\n\n\nå®¢æ·åè¡¨ãå®¢æ·é»ååãå®¢æ·å®¡æ¹é¡µé¢ç»æäºå®¢æ·ç®¡çè¿ä¸ªæ¨¡åãå¯¹äºæ®éç¨æ·ï¼ä¸è½è¿è¡å®¡æ¹æä½ï¼å³æ å®¢æ·å®¡æ¹é¡µé¢æéï¼å¨ä»çè´¦å·ç»å½åä¾§è¾¹å¯¼èªæ åªæ¾ç¤ºå®¢æ·åè¡¨ãå®¢æ·é»ååä¸¤ä¸ªèåã\n\n**æä½æéï¼**ç¨æ·å¡æ¯å¨æä½ç³»ç»ä¸­çä»»ä½å¨ä½ãäº¤äºé½æ¯æä½æéï¼å¦å¢å æ¹æ¥ç­ã\n\n**æ°æ®æéï¼**ä¸è¬ä¸å¡ç®¡çç³»ç»ï¼é½ææ°æ®ç§å¯æ§çè¦æ±ï¼åªäºäººå¯ä»¥çå°åªäºæ°æ®ï¼ä¸å¯ä»¥çå°åªäºæ°æ®ã\n\nç®åä¸¾ä¸ªä¾å­ï¼æç³»ç»ä¸­æéå®é¨é¨ï¼éå®ä¸åè´è´£æ¨éååï¼éå®ä¸»ç®¡è´è´£ç®¡çéå®ä¸åæ¥å¸¸å·¥ä½ï¼ç»çè´è´£ç»ç»ç®¡çéå®ä¸»ç®¡ä½ä¸ã\n\nå¦ä¸å¾ï¼\n\n\n\næç§å®éçè§£ï¼âéå®ä¸åå¼ ä¸âç»å½æ¶ï¼åªè½çå°èªå·±è´è´£çæ°æ®ï¼éå®ä¸»ç®¡ 2 ç»å½æ¶ï¼è½çå°ä»æé¢å¯¼çææä¸å¡åè´è´£çæ°æ®ï¼ä½çä¸å°å¶ä»å¢éä¸å¡åè´è´£çæ°æ®ã\n\næ¢å¦å¤ä¸å¥è¯å°±æ¯ï¼æçå®¢æ·åªææåæçç´å±ä¸çº§ä»¥åç´å±ä¸çº§çé¢å¯¼è½çå°ï¼è¿å°±æ¯æçè§£çæ°æ®æéã\n\nè¦å®ç°æ°æ®æéæå¤ç§æ¹å¼ï¼\n\n 1. å¯ä»¥å©ç¨ RBAC1 æ¨¡åï¼éè¿è§è²åçº§æ¥å®ç°ã\n 2. å¨âç¨æ·-è§è²-æéâçåºç¡ä¸ï¼å¢å ç¨æ·ä¸ç»ç»çå³èå³ç³»ï¼ç¨ç»ç»å³å®ç¨æ·çæ°æ®æéã\n\nå·ä½å¦ä½åå¢ï¼\n\nâ  ç»ç»å±çº§ååï¼\n\n\n\n**â¡ æ°æ®å¯è§æéè§åå¶å®ï¼**ä¸çº§ç»ç»åªè½çå°ä¸çº§ç»ç»åå·¥è´è´£çæ°æ®ï¼èä¸è½çå°å¶ä»å¹³çº§ç»ç»åå¶ä¸çº§ç»ç»çåå·¥æ°æ®ç­ã\n\néè¿ä»¥ä¸ä¸¤ç¹ï¼ç³»ç»å°±å¯ä»¥å¨ç¨æ·ç»å½æ¶ï¼èªå¨å¤æ­è¦ç»ç¨æ·å±ç¤ºåªäºæ°æ®äºã\n\n\n# 2.8. ç¨æ·ç»çä½¿ç¨\n\nå½å¹³å°ç¨æ·åºæ°å¢å¤§ï¼è§è²ç±»åå¢å¤æ¶ï¼å¦æç´æ¥ç»ç¨æ·éè§è²ï¼ç®¡çåçå·¥ä½éå°±ä¼å¾å¤§ãè¿æ¶åæä»¬å¯ä»¥å¼å¥ä¸ä¸ªæ¦å¿µâç¨æ·ç»âï¼å°±æ¯å°ç¸åå±æ§çç¨æ·å½ç±»å°ä¸èµ·ã\n\nä¾å¦ï¼å å¥ç¨æ·ç»çæ¦å¿µåï¼å¯ä»¥å°é¨é¨çåä¸ä¸ªç¨æ·ç»ï¼åç»è¿ä¸ªé¨é¨ç´æ¥èµäºè§è²ï¼1 ä¸åå·¥é¨é¨å¯è½å°±å åä¸ªï¼ï¼ä½¿é¨é¨æ¥æé¨é¨æéï¼è¿æ ·è¿ä¸ªé¨é¨çææç¨æ·é½æäºé¨é¨æéï¼èä¸éè¦ä¸ºæ¯ä¸ä¸ªç¨æ·ååç¬æå®è§è²ï¼æå¤§çåå°äºåéæéçå·¥ä½éã\n\nåæ¶ï¼ä¹å¯ä»¥ä¸ºç¹å®çç¨æ·æå®è§è²ï¼è¿æ ·ç¨æ·é¤äºæ¥ææå±ç¨æ·ç»çæææéå¤ï¼è¿æ¥æèªèº«ç¹å®çæéã\n\nç¨æ·ç»çä¼ç¹ï¼é¤äºåå°å·¥ä½éï¼è¿ææ´ä¾¿äºçè§£ãå¢å å¤çº§ç®¡çå³ç³»ç­ãå¦ï¼æä»¬å¨è¿è¡ç»ç»æºæéç½®çæ¶åï¼é¤äºå å¥é¨é¨ï¼è¿å¯ä»¥å å¥ç§å®¤ãå²ä½ç­å±çº§ï¼æ¥ä¸ºç¨æ·ç»åé¨æåçæéè¿è¡ç­çº§ä¸çåºåã\n\nå³äºç¨æ·ç»çè¯¦ç»çé¾è§£ç­ï¼è¯·æ¥çhttps://wen.woshipm.com/question/detail/88fues.htmlãå¨è¿éä¹ååæè°¢ä¸ºæè§£ç­çæçæåä»¬ï¼\n\n\n# 2.9. å®ä¾åæ\n\n\n# 2.10. å¦ä½è®¾è®¡ RBAC æéç³»ç»\n\né¦åï¼æä»¬æèä¸ä¸ä¸ä¸ªç®åçæéç³»ç»åºè¯¥å·å¤åªäºåå®¹ï¼\n\nç­æ¡æ¾èæè§ï¼RBAC æ¨¡åï¼ç¨æ·-è§è²-æéãæä»¥æåºæ¬çæä»¬åºè¯¥å·å¤ç¨æ·ãè§è²ãæéè¿ä¸ä¸ªåå®¹ã\n\næ¥ä¸æ¥ï¼æä»¬æèï¼ç©¶ç«å¦ä½å°ä¸èå³èèµ·æ¥ãåé¡¾åæï¼è§è²ä½ä¸ºæ¢çº½ï¼å³èç¨æ·ãæéãæä»¥å¨ RBAC æ¨¡åä¸ï¼æä»¬åºè¯¥ï¼åå»ºä¸ä¸ªè§è²ï¼å¹¶ä¸ºè¿ä¸ªè§è²èµäºç¸åºæéï¼æåå°è§è²èµäºç¨æ·ã\n\nå°è¿ä¸ªé®é¢æ½è±¡ä¸ºæµç¨ï¼å¦ä¸å¾ï¼\n\n\n\nç°å¨ï¼åºæ¬çæµç¨é»è¾å·²ç»æ½è±¡åºæ¥äºï¼æ¥ä¸æ¥ï¼åæè¯¥å¦ä½è®¾è®¡å¢ï¼\n\n * ç¬¬ä¸æ­¥ï¼éè¦è§è²ç®¡çåè¡¨ï¼å¨è§è²ç®¡çåè¡¨è½å¿«éåå»ºä¸ä¸ªè§è²ï¼ä¸åå»ºè§è²çåæ¶è½ä¸ºè§è²éç½®æéï¼å¹¶ä¸æ¯æåå»ºæåçè§è²åè¡¨è½éæ¶è¿è¡æééç½®ççä¿®æ¹ï¼\n * ç¬¬äºæ­¥ï¼éè¦ç¨æ·ç®¡çåè¡¨ï¼å¨ç¨æ·ç®¡çåè¡¨è½å¿«éæ·»å ä¸ä¸ªç¨æ·ï¼ä¸æ·»å ç¨æ·æ¶æè®©ç¨æ·å³èè§è²çåè½ã\n\nç®åæ¥è¯´æéç³»ç»è®¾è®¡å°±åå«ä»¥ä¸ä¸¤æ­¥ï¼æ¥ä¸æ¥ä¸ºå¤§å®¶è¿è¡å®ä¾åæã\n\n\n# 2.11. å®ä¾åæ\n\nâ  åå»ºè§è²åè¡¨\n\n\n\nå¨è§è²åè¡¨å¿«éåå»ºä¸ä¸ªè§è²ï¼ç¹å»åå»ºè§è²ï¼æ¯æåå»ºè§è²æ¶éç½®æéã\n\n\n\nâ¡ åå»ºç¨æ·åè¡¨\n\n\n\nå¨ç¨æ·åè¡¨å¿«éåå»ºä¸ä¸ªç¨æ·ï¼æ¯æç¨æ·å³èè§è²çåè½ã\n\n\n\nä¸è¿°æ¡ä¾æ¯åºäºæç®åç RBAC0 æ¨¡ååå»ºï¼éç¨äºå¤§é¨åå¸¸è§çæéç®¡çç³»ç»ã\n\nä¸é¢ååæä¸ä¸ RBAC1 ä¸­è§è²åçº§å·ä½å¦ä½è®¾è®¡ã\n\n 1. å¨ RBAC0 çåºç¡ä¸ï¼å ä¸è§è²ç­çº§è¿ä¸ªå­æ®µã\n 2. æéåéè§åå¶å®ï¼ä½ç­çº§è§è²åªè½å¨é«ç­çº§è§è²æéåºç¡ä¸è¿è¡å åæéã\n\nå·ä½çé¢åç°å¦ä¸å¾ï¼\n\n\n\nä»¥ä¸å°±æ¯ç®åç RBAC ç³»ç»è®¾è®¡ï¼è¥éæ´å¤æçï¼è¿è¯·è¯»èæ ¹æ®ä¸é¢çåæèªè¡æ£æ©æèï¼å°½ç®¡æ ·å¼ä¸åï¼ä½ä¸åä¸ç¦»å¶å®ï¼çè§£æ¸æ¥ RBAC æ¨¡ååï¼ç»åèªå·±çä¸å¡å°±å¯ä»¥è®¾è®¡åºä¸å¥ç¬¦åèªå·±å¹³å°éæ±çè§è²æéç³»ç»ï¼å·ä½çå°±ä¸åå¤éè¿°äºã\n\n\n# 3. å®¡è®¡\n\nTODO\n\n\n# 4. ç½ç«æ»å»\n\näºèç½ç¯å¢é±¼é¾æ··æï¼ç½ç«è¢«æ»å»æ¯å¸¸è§ç°è±¡ï¼æä»¥äºè§£ä¸äºå¸¸è§çç½ç«æ»å»ææ®µååå¿è¦ãä¸é¢åä¸¾æ¯è¾å¸¸è§ç 4 ç§æ»å»ææ®µï¼\n\n\n# 4.1. XSS\n\n# 4.1.1. æ¦å¿µ\n\nè·¨ç«èæ¬ï¼Cross-site scriptingï¼éå¸¸ç®ç§°ä¸ºXSSï¼ æ¯ä¸ç§ç½ç«åºç¨ç¨åºçå®å¨æ¼æ´æ»å»ï¼æ¯ä»£ç æ³¨å¥çä¸ç§ãå®åè®¸æ¶æç¨æ·å°ä»£ç æ³¨å¥å°ç½é¡µä¸ï¼å¶ä»ç¨æ·å¨è§çç½é¡µæ¶å°±ä¼åå°å½±åãè¿ç±»æ»å»éå¸¸åå«äº HTML ä»¥åç¨æ·ç«¯èæ¬è¯­è¨ã\n\nXSS æ»å»ç¤ºä¾ï¼\n\nåå¦æä¸é¢ä¸ä¸ª textbox\n\n<input type="text" name="address1" value="value1from" />\n\n\nvalue1from æ¯æ¥èªç¨æ·çè¾å¥ï¼å¦æç¨æ·ä¸æ¯è¾å¥ value1from,èæ¯è¾å¥ "/><script>alert(document.cookie)<\/script><!- é£ä¹å°±ä¼åæï¼\n\n<input type="text" name="address1" value="" />\n<script>\n  alert(document.cookie)\n<\/script>\n<!- ">\n\n\nåµå¥ç JavaScript ä»£ç å°ä¼è¢«æ§è¡ãæ»å»çå¨åï¼åå³äºç¨æ·è¾å¥äºä»ä¹æ ·çèæ¬ã\n\n# 4.1.2. æ»å»ææ®µåç®ç\n\nå¸¸ç¨ç XSS æ»å»ææ®µåç®çæï¼\n\n * çç¨ cookieï¼è·åææä¿¡æ¯ã\n * å©ç¨æ¤å¥ Flashï¼éè¿ crossdomain æéè®¾ç½®è¿ä¸æ­¥è·åæ´é«æéï¼æèå©ç¨ Java ç­å¾å°ç±»ä¼¼çæä½ã\n * å©ç¨ iframeãframeãXMLHttpRequest æä¸è¿° Flash ç­æ¹å¼ï¼ä»¥ï¼è¢«æ»å»ï¼ç¨æ·çèº«ä»½æ§è¡ä¸äºç®¡çå¨ä½ï¼ææ§è¡ä¸äºä¸è¬çå¦åå¾®åãå å¥½åãåç§ä¿¡ç­æä½ã\n * å©ç¨å¯è¢«æ»å»çååå°å¶ä»åä¿¡ä»»çç¹ç¹ï¼ä»¥åä¿¡ä»»æ¥æºçèº«ä»½è¯·æ±ä¸äºå¹³æ¶ä¸åè®¸çæä½ï¼å¦è¿è¡ä¸å½çæç¥¨æ´»å¨ã\n * å¨è®¿é®éæå¤§çä¸äºé¡µé¢ä¸ç XSS å¯ä»¥æ»å»ä¸äºå°åç½ç«ï¼å®ç° DDoS æ»å»çææã\n\n# 4.1.3. åºå¯¹ææ®µ\n\n * è¿æ»¤ç¹æ®å­ç¬¦ - å°ç¨æ·ææä¾çåå®¹è¿è¡è¿æ»¤ï¼ä»èé¿å HTML å Jascript ä»£ç çè¿è¡ãå¦ > è½¬ä¹ä¸º &gtã< è½¬ä¹ä¸º &lt ç­ï¼å°±å¯ä»¥é²æ­¢å¤§é¨åæ»å»ãä¸ºäºé¿åå¯¹ä¸å¿è¦çåå®¹éè¯¯è½¬ç§»ï¼å¦ 3<5 ä¸­ç < éè¦è¿è¡ææ¬å¹éååè½¬ç§»ï¼å¦ï¼<img src= è¿æ ·çä¸ä¸æä¸­ç < æè½¬ä¹ã\n * è®¾ç½® Cookie ä¸º HttpOnly - è®¾ç½®äº HttpOnly ç Cookie å¯ä»¥é²æ­¢ JavaScript èæ¬è°ç¨ï¼å°±æ æ³éè¿ document.cookie è·åç¨æ· Cookie ä¿¡æ¯ã\n\n> ð åèéè¯»ï¼\n> \n>  * Wiki è¯æ¡ - è·¨ç«èæ¬\n>  * Web å®å¨æµè¯ä¹ XSS\n\n\n# 4.2. CSRF\n\n# 4.2.1. æ¦å¿µ\n\nè·¨ç«è¯·æ±ä¼ªé ï¼Cross-site request forgeryï¼CSRFï¼ï¼ä¹è¢«ç§°ä¸º one-click attack æè session ridingï¼éå¸¸ç¼©åä¸º CSRF æè XSRFãå®æ¯ä¸ç§ææç¨æ·å¨å½åå·²ç»å½ç Web åºç¨ç¨åºä¸æ§è¡éæ¬æçæä½çæ»å»æ¹æ³ãåè·¨ç«èæ¬ï¼XSSï¼ç¸æ¯ï¼XSS å©ç¨çæ¯ç¨æ·å¯¹æå®ç½ç«çä¿¡ä»»ï¼CSRF å©ç¨çæ¯ç½ç«å¯¹ç¨æ·ç½é¡µæµè§å¨çä¿¡ä»»ã\n\n# 4.2.2. æ»å»ææ®µåç®ç\n\nå¯ä»¥å¦æ­¤çè§£ CSRFï¼æ»å»èçç¨äºä½ çèº«ä»½ï¼ä»¥ä½ çåä¹åéæ¶æè¯·æ±ã\n\nCSRF è½åçäºå¤ªå¤ï¼\n\n * ä»¥ä½ åä¹åéé®ä»¶ï¼åæ¶æ¯\n * ç¨ä½ çè´¦å·è´­ä¹°åå\n * ç¨ä½ çåä¹å®æèæè´§å¸è½¬è´¦\n * æ³é²ä¸ªäººéç§\n * ...\n\n# 4.2.3. åºå¯¹ææ®µ\n\n * è¡¨å Token - CSRF æ¯ä¸ä¸ªä¼ªé ç¨æ·è¯·æ±çæä½ï¼æä»¥éè¦æé ç¨æ·è¯·æ±çææåæ°æå¯ä»¥ãè¡¨å Token éè¿å¨è¯·æ±åæ°ä¸­æ·»å éæºæ°çåæ³æ¥é»æ­¢æ»å»èè·å¾ææè¯·æ±åæ°ã\n * éªè¯ç  - è¯·æ±æäº¤æ¶ï¼éè¦ç¨æ·è¾å¥éªè¯ç ï¼ä»¥é¿åç¨æ·å¨ä¸ç¥æçæåµä¸è¢«æ»å»èä¼ªé è¯·æ±ã\n * Referer check - HTTP è¯·æ±å¤´ç Referer åä¸­è®°å½çè¯·æ±èµæºï¼å¯éè¿æ£æ¥è¯·æ±æ¥æºï¼éªè¯å¶æ¯å¦åæ³ã\n\n> ð åèéè¯»ï¼\n> \n>  * Wiki è¯æ¡ - è·¨ç«è¯·æ±ä¼ªé \n>  * æµè° CSRF æ»å»æ¹å¼\n>  * ãæ¯æ¥ä¸é¢ãCSRF æ¯ä»ä¹ï¼ãæ¯æ¥ä¸é¢ãCSRF æ¯ä»ä¹ï¼\n>  * WEB å®å¨ä¹-CSRFï¼è·¨ç«è¯·æ±ä¼ªé ï¼\n\n\n# 4.3. SQL æ³¨å¥\n\n# 4.3.1. æ¦å¿µ\n\nSQL æ³¨å¥æ»å»ï¼SQL injectionï¼ï¼æ¯åçäºåºç¨ç¨åºä¹æ°æ®å±çå®å¨æ¼æ´ãç®èè¨ä¹ï¼æ¯å¨è¾å¥çå­ç¬¦ä¸²ä¹ä¸­æ³¨å¥ SQL æä»¤ï¼å¨è®¾è®¡ä¸è¯çç¨åºå½ä¸­å¿½ç¥äºæ£æ¥ï¼é£ä¹è¿äºæ³¨å¥è¿å»çæä»¤å°±ä¼è¢«æ°æ®åºæå¡å¨è¯¯è®¤ä¸ºæ¯æ­£å¸¸ç SQL æä»¤èè¿è¡ï¼å æ­¤é­å°ç ´åææ¯å¥ä¾µã\n\næ»å»ç¤ºä¾ï¼\n\nèèä»¥ä¸ç®åçç»å½è¡¨åï¼\n\n<form action="/login" method="POST">\n  <p>Username: <input type="text" name="username" /></p>\n  <p>Password: <input type="password" name="password" /></p>\n  <p><input type="submit" value="ç»é" /></p>\n</form>\n\n\næä»¬çå¤çéé¢ç SQL å¯è½æ¯è¿æ ·çï¼\n\nusername:=r.Form.Get("username")\npassword:=r.Form.Get("password")\nsql:="SELECT * FROM user WHERE username=\'"+username+"\' AND password=\'"+password+"\'"\n\n\nå¦æç¨æ·çè¾å¥çç¨æ·åå¦ä¸ï¼å¯ç ä»»æ\n\nmyuser\' or \'foo\' = \'foo\' --\n\n\né£ä¹æä»¬ç SQL åæäºå¦ä¸æç¤ºï¼\n\nSELECT * FROM user WHERE username=\'myuser\' or \'foo\' = \'foo\' --\'\' AND password=\'xxx\'\n\n\nå¨ SQL éé¢ -- æ¯æ³¨éæ è®°ï¼æä»¥æ¥è¯¢è¯­å¥ä¼å¨æ­¤ä¸­æ­ãè¿å°±è®©æ»å»èå¨ä¸ç¥éä»»ä½åæ³ç¨æ·ååå¯ç çæåµä¸æåç»å½äºã\n\nå¯¹äº MSSQL è¿ææ´å å±é©çä¸ç§ SQL æ³¨å¥ï¼å°±æ¯æ§å¶ç³»ç»ï¼ä¸é¢è¿ä¸ªå¯æçä¾å­å°æ¼ç¤ºå¦ä½å¨æäºçæ¬ç MSSQL æ°æ®åºä¸æ§è¡ç³»ç»å½ä»¤ã\n\nsql:="SELECT * FROM products WHERE name LIKE \'%"+prod+"%\'"\nDb.Exec(sql)\n\n\nå¦ææ»å»æäº¤ a%\' exec master..xp_cmdshell \'net user test testpass /ADD\' -- ä½ä¸ºåé prod çå¼ï¼é£ä¹ sql å°ä¼åæ\n\nsql:="SELECT * FROM products WHERE name LIKE \'%a%\' exec master..xp_cmdshell \'net user test testpass /ADD\'--%\'"\n\n\nMSSQL æå¡å¨ä¼æ§è¡è¿æ¡ SQL è¯­å¥ï¼åæ¬å®åé¢é£ä¸ªç¨äºåç³»ç»æ·»å æ°ç¨æ·çå½ä»¤ãå¦æè¿ä¸ªç¨åºæ¯ä»¥ sa è¿è¡è MSSQLSERVER æå¡åæè¶³å¤çæéçè¯ï¼æ»å»èå°±å¯ä»¥è·å¾ä¸ä¸ªç³»ç»å¸å·æ¥è®¿é®ä¸»æºäºã\n\nè½ç¶ä»¥ä¸çä¾å­æ¯éå¯¹æä¸ç¹å®çæ°æ®åºç³»ç»çï¼ä½æ¯è¿å¹¶ä¸ä»£è¡¨ä¸è½å¯¹å¶å®æ°æ®åºç³»ç»å®æ½ç±»ä¼¼çæ»å»ãéå¯¹è¿ç§å®å¨æ¼æ´ï¼åªè¦ä½¿ç¨ä¸åæ¹æ³ï¼åç§æ°æ®åºé½æå¯è½é­æ®ã\n\n# 4.3.2. æ»å»ææ®µåç®ç\n\n * æ°æ®è¡¨ä¸­çæ°æ®å¤æ³ï¼ä¾å¦ä¸ªäººæºå¯æ°æ®ï¼è´¦æ·æ°æ®ï¼å¯ç ç­ã\n * æ°æ®ç»æè¢«é»å®¢æ¢ç¥ï¼å¾ä»¥åè¿ä¸æ­¥æ»å»ï¼ä¾å¦ SELECT * FROM sys.tablesï¼ã\n * æ°æ®åºæå¡å¨è¢«æ»å»ï¼ç³»ç»ç®¡çåè´¦æ·è¢«çªæ¹ï¼ä¾å¦ ALTER LOGIN sa WITH PASSWORD=\'xxxxxx\'ï¼ã\n * è·åç³»ç»è¾é«æéåï¼æå¯è½å¾ä»¥å¨ç½é¡µå å¥æ¶æé¾æ¥ãæ¶æä»£ç ä»¥å XSS ç­ã\n * ç»ç±æ°æ®åºæå¡å¨æä¾çæä½ç³»ç»æ¯æï¼è®©é»å®¢å¾ä»¥ä¿®æ¹ææ§å¶æä½ç³»ç»ï¼ä¾å¦ xp_cmdshell "net stop iisadmin"å¯åæ­¢æå¡å¨ç IIS æå¡ï¼ã\n * ç ´åç¡¬çæ°æ®ï¼ç«çªå¨ç³»ç»ï¼ä¾å¦ xp_cmdshell "FORMAT C:"ï¼ã\n\n# 4.3.3. åºå¯¹ææ®µ\n\n * ä½¿ç¨åæ°åæ¥è¯¢ - å»ºè®®ä½¿ç¨æ°æ®åºæä¾çåæ°åæ¥è¯¢æ¥å£ï¼åæ°åçè¯­å¥ä½¿ç¨åæ°èä¸æ¯å°ç¨æ·è¾å¥åéåµå¥å° SQL è¯­å¥ä¸­ï¼å³ä¸è¦ç´æ¥æ¼æ¥ SQL è¯­å¥ãä¾å¦ä½¿ç¨ database/sql éé¢çæ¥è¯¢å½æ° Prepare å Query ï¼æè Exec(query string, args ...interface{})ã\n * åå¼å·è½¬æ¢ - å¨ç»å SQL å­ç¬¦ä¸²æ¶ï¼åéå¯¹æä¼ å¥çåæ°è¿è¡å­ç¬¦æ¿æ¢ï¼å°åå¼å·å­ç¬¦æ¿æ¢ä¸ºè¿ç»­ 2 ä¸ªåå¼å·å­ç¬¦ï¼ã\n\n> ð åèéè¯»ï¼\n> \n>  * Wiki è¯æ¡ - SQL æ³¨å¥æ»å»\n>  * é¿å SQL æ³¨å¥\n>  * å®ä¾è®²è§£ SQL æ³¨å¥æ»å»\n\n\n# 4.4. DoS\n\næç»æå¡æ»å»ï¼denial-of-service attack, DoSï¼äº¦ç§°æ´ªæ°´æ»å»ï¼æ¯ä¸ç§ç½ç»æ»å»ææ³ï¼å¶ç®çå¨äºä½¿ç®æ çµèçç½ç»æç³»ç»èµæºèå°½ï¼ä½¿æå¡ææ¶ä¸­æ­æåæ­¢ï¼å¯¼è´å¶æ­£å¸¸ç¨æ·æ æ³è®¿é®ã\n\nå½é»å®¢ä½¿ç¨ç½ç»ä¸ä¸¤ä¸ªæä»¥ä¸è¢«æ»é·ççµèä½ä¸ºâåµå°¸âåç¹å®çç®æ åå¨âæç»æå¡âå¼æ»å»æ¶ï¼ç§°ä¸ºåå¸å¼æç»æå¡æ»å»ï¼distributed denial-of-service attackï¼ç¼©åï¼DDoS attackãDDoSï¼ã\n\n# 4.4.1. æ»å»æ¹å¼\n\n * å¸¦å®½æ¶èåæ»å»\n * èµæºæ¶èåæ»å»\n\n# 4.4.2. åºå¯¹ææ®µ\n\n * é²ç«å¢ - åè®¸ææç»ç¹å®éè®¯åè®®ï¼ç«¯å£æ IP å°åãå½æ»å»ä»å°æ°ä¸æ­£å¸¸ç IP å°åååºæ¶ï¼å¯ä»¥ç®åçä½¿ç¨æç»è§åé»æ­¢ä¸åä»æ»å»æº IP ååºçéä¿¡ã\n * è·¯ç±å¨ãäº¤æ¢æº - å·æéåº¦éå¶åè®¿é®æ§å¶è½åã\n * æµéæ¸æ´ - éè¿éç¨æ DoS è½¯ä»¶å¤çï¼å°æ­£å¸¸æµéåæ¶ææµéåºåå¼ã\n\n> ð åèéè¯»ï¼\n> \n>  * æç»æå¡æ»å»\n\n\n# 5. å å¯ææ¯\n\nå¯¹äºç½ç«æ¥è¯´ï¼ç¨æ·ä¿¡æ¯ãè´¦æ·ç­ç­æææ°æ®ä¸æ¦æ³æ¼ï¼åæä¸¥éï¼æä»¥ä¸ºäºä¿æ¤æ°æ®ï¼åºå¯¹è¿äºä¿¡æ¯è¿è¡å å¯å¤çã\n\nä¿¡æ¯å å¯ææ¯ä¸è¬åä¸ºï¼\n\n * æ¶æ¯æè¦\n * å å¯ç®æ³\n   * å¯¹ç§°å å¯\n   * éå¯¹ç§°å å¯\n * è¯ä¹¦\n\n\n# 5.1. æ¶æ¯æè¦\n\nå¸¸ç¨æ°å­ç­¾åç®æ³ï¼MD5ãSHA ç­ã\n\nåºç¨åºæ¯ï¼å°ç¨æ·å¯ç ä»¥æ¶æ¯æè¦å½¢å¼ä¿å­å°æ°æ®åºä¸­ã\n\n> ð åèéè¯»ï¼ Java ç¼ç åå å¯\n\n\n# 5.2. å å¯ç®æ³\n\n# 5.2.1. å¯¹ç§°å å¯\n\nå¯¹ç§°å å¯æå å¯åè§£å¯æä½¿ç¨çå¯é¥æ¯åä¸ä¸ªå¯é¥ã\n\nå¸¸ç¨å¯¹ç§°å å¯ç®æ³ï¼DESãAES ç­ã\n\nåºç¨åºæ¯ï¼Cookie å å¯ãéä¿¡æºå¯ç­ã\n\n# 5.2.2. éå¯¹ç§°å å¯\n\néå¯¹ç§°å å¯æå å¯åè§£å¯æä½¿ç¨çä¸æ¯åä¸ä¸ªå¯é¥ï¼èæ¯ä¸ä¸ªå¬ç§é¥å¯¹ãç¨å¬é¥å å¯çä¿¡æ¯å¿é¡»ç¨ç§é¥æè½è§£å¼ï¼åä¹ï¼ç¨ç§é¥å å¯çä¿¡æ¯åªæç¨å¬é¥æè½è§£å¼ã\n\nå¸¸ç¨éå¯¹ç§°å å¯ç®æ³ï¼RSA ç­ã\n\nåºç¨åºæ¯ï¼HTTPS ä¼ è¾ä¸­æµè§å¨ä½¿ç¨çæ°å­è¯ä¹¦å®è´¨ä¸æ¯ç»è¿æå¨æºæè®¤è¯çéå¯¹ç§°å å¯å¬é¥ã\n\n> ð åèéè¯»ï¼ Java ç¼ç åå å¯\n\n# 5.2.3. å¯é¥å®å¨ç®¡ç\n\nä¿è¯å¯é¥å®å¨çæ¹æ³ï¼\n\n 1. æå¯é¥åç®æ³æ¾å¨ä¸ä¸ªç¬ç«çæå¡å¨ä¸ï¼å¯¹å¤æä¾å å¯åè§£å¯æå¡ï¼åºç¨ç³»ç»éè¿è°ç¨è¿ä¸ªæå¡ï¼å®ç°æ°æ®çå è§£å¯ã\n 2. æå è§£å¯ç®æ³æ¾å¨åºç¨ç³»ç»ä¸­ï¼å¯é¥åæ¾å¨ç¬ç«æå¡å¨ä¸­ï¼ä¸ºäºæé«å¯é¥çå®å¨æ§ï¼å®éå­å¨æ¶ï¼å¯é¥è¢«ååææ°çï¼å å¯ååå«ä¿å­å¨ä¸åå­å¨ä»è´¨ä¸­ã\n\n\n# 5.3. è¯ä¹¦\n\nè¯ä¹¦å¯ä»¥ç§°ä¸ºä¿¡æ¯å®å¨å å¯çç»æææ®µãå¬å¼å¯é¥è®¤è¯ï¼è±è¯­ï¼Public key certificateï¼ï¼åç§°å¬å¼å¯é¥è¯ä¹¦ãå¬é¥è¯ä¹¦ãæ°å­è¯ä¹¦ï¼digital certificateï¼ãæ°å­è®¤è¯ãèº«ä»½è¯ä¹¦ï¼identity certificateï¼ãçµå­è¯ä¹¦æå®å¨è¯ä¹¦ï¼æ¯ç¨äºå¬å¼å¯é¥åºç¡å»ºè®¾ççµå­æä»¶ï¼ç¨æ¥è¯æå¬å¼å¯é¥æ¥æèçèº«ä»½ãæ­¤æä»¶åå«äºå¬é¥ä¿¡æ¯ãæ¥æèèº«ä»½ä¿¡æ¯ï¼ä¸»ä½ï¼ãä»¥åæ°å­è¯ä¹¦è®¤è¯æºæï¼åè¡èï¼å¯¹è¿ä»½æä»¶çæ°å­ç­¾åï¼ä»¥ä¿è¯è¿ä¸ªæä»¶çæ´ä½åå®¹æ­£ç¡®æ è¯¯ã\n\néè¿ä¿¡ä»»æå¨æ°å­è¯ä¹¦è®¤è¯æºæçæ ¹è¯ä¹¦ãåå¶ä½¿ç¨å¬å¼å¯é¥å å¯ä½æ°å­ç­¾åæ ¸åçå¬å¼å¯é¥è®¤è¯ï¼å½¢æä¿¡ä»»é¾æ¶æï¼å·²å¨ TLS å®ç°å¹¶å¨ä¸ç»´ç½ç HTTP ä»¥ HTTPSãå¨çµå­é®ä»¶ç SMTP ä»¥ STARTTLS å¼å¥å¹¶å¹¿æ³åºç¨ã\n\nä¼æå¨ç¥ï¼å¸¸è§çåºç¨å±åè®® HTTPãFTPãTelnet æ¬èº«ä¸ä¿è¯ä¿¡æ¯å®å¨ãä½æ¯å å¥äº SSL/TLS å å¯æ°æ®åæºå¶ç HTTPSãFTPSãTelnets æ¯ä¿¡æ¯å®å¨çãä¼ è¾å±å®å¨æ§åè®®ï¼Transport Layer Security, TLSï¼ï¼åå¶åèº«å®å¨å¥æ¥å±ï¼Secure Sockets Layer, SSLï¼æ¯ä¸ç§å®å¨åè®®ï¼ç®çæ¯ä¸ºäºèç½éä¿¡ï¼æä¾å®å¨åæ°æ®å®æ´æ§ä¿éã\n\n# 5.3.1. è¯ä¹¦åç\n\nSSL/TLS åè®®çåºæ¬æè·¯æ¯éç¨å¬é¥å å¯æ³ï¼ä¹å°±æ¯è¯´ï¼å®¢æ·ç«¯ååæå¡å¨ç«¯ç´¢è¦å¬é¥ï¼ç¶åç¨å¬é¥å å¯ä¿¡æ¯ï¼æå¡å¨æ¶å°å¯æåï¼ç¨èªå·±çç§é¥è§£å¯ã\n\nè¿éæä¸¤ä¸ªé®é¢ï¼\n\nï¼1ï¼å¦ä½ä¿è¯å¬é¥ä¸è¢«ç¯¡æ¹ï¼\n\nè§£å³æ¹æ³ï¼å°å¬é¥æ¾å¨æ°å­è¯ä¹¦ä¸­ãåªè¦è¯ä¹¦æ¯å¯ä¿¡çï¼å¬é¥å°±æ¯å¯ä¿¡çã\n\nï¼2ï¼å¬é¥å å¯è®¡ç®éå¤ªå¤§ï¼å¦ä½åå°èç¨çæ¶é´ï¼\n\nè§£å³æ¹æ³ï¼æ¯ä¸æ¬¡å¯¹è¯ï¼sessionï¼ï¼å®¢æ·ç«¯åæå¡å¨ç«¯é½çæä¸ä¸ª"å¯¹è¯å¯é¥"ï¼session keyï¼ï¼ç¨å®æ¥å å¯ä¿¡æ¯ãç±äº"å¯¹è¯å¯é¥"æ¯å¯¹ç§°å å¯ï¼æä»¥è¿ç®éåº¦éå¸¸å¿«ï¼èæå¡å¨å¬é¥åªç¨äºå å¯"å¯¹è¯å¯é¥"æ¬èº«ï¼è¿æ ·å°±åå°äºå å¯è¿ç®çæ¶èæ¶é´ã\n\nSSL/TLS åè®®çåºæ¬è¿ç¨æ¯è¿æ ·çï¼\n\n 1. å®¢æ·ç«¯åæå¡å¨ç«¯ç´¢è¦å¹¶éªè¯å¬é¥ã\n 2. åæ¹ååçæ"å¯¹è¯å¯é¥"ã\n 3. åæ¹éç¨"å¯¹è¯å¯é¥"è¿è¡å å¯éä¿¡ã\n\n> ð åèéè¯»ï¼\n> \n>  * ä¼ è¾å±å®å¨æ§åè®®\n>  * å¬å¼å¯é¥è®¤è¯\n>  * SSL/TLS åè®®è¿è¡æºå¶çæ¦è¿°\n\n\n# 6. ä¿¡æ¯è¿æ»¤\n\nå¨ç½ç»ä¸­ï¼å¹¿åååå¾ä¿¡æ¯å±¡è§ä¸é²ï¼æ³æ»¥æç¾ã\n\nå¸¸è§çä¿¡æ¯è¿æ»¤ä¸ååå¾ææ®µæï¼\n\n\n# 6.1. ææ¬å¹é\n\nè§£å³ææè¯è¿æ»¤ãç³»ç»ç»´æ¤ä¸ä»½ææè¯æ¸åï¼å¦æä¿¡æ¯ä¸­å«æææè¯ï¼åèªå¨è¿è¡è¿æ»¤ææç»ä¿¡æ¯ã\n\n\n# 6.2. é»åå\n\né»ååå°±æ¯å°ä¸äºå·²ç»è¢«è¯å«åºæè¿è§è¡ä¸ºç IPãååãé®ç®±ç­å å¥é»ååï¼æç»å¶è¯·æ±ã\n\né»ååå¯ä»¥éè¿ Hash è¡¨æ¥å®ç°ï¼æ¹æ³ç®åï¼å¤æåº¦å°ï¼éäºä¸è¬åºç¨åºæ¯ã\n\nä½å¦æé»åååè¡¨éå¸¸å¤§æ¶ï¼Hash è¡¨è¦å ç¨å¾å¤§çåå­ç©ºé´ï¼è¿æ¶å°±ä¸åä½¿ç¨äºãè¿ç§æåµä¸ï¼å¯ä»¥ä½¿ç¨å¸éè¿æ»¤å¨æ¥å®ç°ï¼å³éè¿ä¸ä¸ªäºè¿å¶åè¡¨åä¸ç»éæºæ°æ å°å½æ°æ¥å®ç°ã\n\n\n# 6.3. åç±»ç®æ³\n\nå¯¹äºæµ·éä¿¡æ¯ï¼é¾ä»¥éè¿äººå·¥å»å®¡æ ¸ãå¯¹å¹¿åè´´ã\n\nåå¾é®ä»¶ç­åå®¹çè¯å«æ¯è¾å¥½çèªå¨åæ¹æ³å°±æ¯éç¨åç±»ç®æ³ã\n\nç®åæ¥è¯´ï¼å³å°æ¹éå·²åç±»çæ ·æ¬è¾å¥åç±»ç®æ³è¿è¡è®­ç»ï¼å¾å°ä¸ä¸ªåç±»æ¨¡åï¼ç¶åå©ç¨åç±»ç®æ³ç»ååç±»æ¨¡åå»å¯¹ä¿¡æ¯è¿è¡è¯å«ãæ³äºè§£å·ä½åæ³ï¼éè¦å»çè§£æºå¨å­¦ä¹ ç¸å³ç¥è¯ã\n\n\n# 7. é£é©æ§å¶\n\nç½ç»ç»åå¡ãéèé¢åå¸¦æ¥æå¤§ä¾¿å©çåæ¶ï¼ä¹å°é£é©å¸¦ç»äºå¯¹ç½ç»å®å¨ä¸æ æç¥çäººä»¬ãç±äºäº¤æåæ¹ä¿¡æ¯çä¸å¯¹ç­ï¼ä½¿å¾äº¤æå­å¨çé£é©ï¼èå½äº¤æåçå¨ç½ç»ä¸æ¶ï¼é£é©å°±æ´å é¾ä»¥æ§å¶äºã\n\n\n# 7.1. é£é©ç§ç±»\n\n * è´¦æ·é£é© - çç¨è´¦æ·ãæ¶ææ³¨åè´¦æ·ç­\n * ä¹°å®¶é£é© - èåè¯¢çãæ¶æææ¶ãæ¶æä¸åãé»çåæ¢è´­ç­é¨ååç­\n * åå®¶é£é© - èååè´§ãåºå®è¿ç¦åãä¾µæç­\n * äº¤æé£é© - ä¿¡ç¨å¡çå·ãäº¤ææ¬ºè¯ãæ´é±ãå¥ç°ãçµä¿¡è¯éªç­\n\n\n# 7.2. é£é©æ§å¶ææ®µ\n\nå¤§åçµåç½ç«ç³»ç»æéèç³»ç»é½éå¤ä¸ä¸çé£æ§å¢éè¿è¡é£é©æ§å¶ãé£é©æ§å¶ææ®µæ¢åæ¬äººå·¥å®¡æ ¸ä¹åæ¬èªå¨å®¡æ ¸ã\n\nèªå¨é£æ§çææ¯ææ®µä¸»è¦æè§åå¼æåç»è®¡æ¨¡åã\n\n\n# 7.3. è§åå¼æ\n\nå¨äº¤æä¸­ï¼ä¹°å®¶ãåå®¶çæäºææ æ»¡è¶³ä¸å®æ¡ä»¶æ¶ï¼å°±ä¼è¢«è®¤ä¸ºå­å¨é£é©ãå¦ï¼äº¤æéé¢è¶è¿æä¸ªæ°å¼ï¼ç¨æ·æ¥èªé»ååï¼ç¨æ·åä¸æ¬¡ç»å½çå°åè·ç¦»å·®è·å¾å¤§ï¼ç¨æ·å¨ä¸å®æ¶é´åé¢ç¹äº¤æç­ç­ã\n\nå¦æä»¥ä¸è¿äºæ¡ä»¶é½éè¿ if ... else ... å¼æ ·çä»£ç å»å®ç°ï¼ä»£ç ç»´æ¤ãæ©å±ä¼éå¸¸ä¸ä¾¿ãå æ­¤ï¼å°±æäºè§åå¼ææ¥å¤çè¿ç±»é®é¢ãè§åå¼ææ¯ä¸ç§å°ä¸å¡è§ååè§åå¤çé»è¾ç¸åç¦»çææ¯ï¼ä¸å¡è§åç±è¿è¥äººåéè¿ç®¡ççé¢å»ç¼è¾ï¼å®ç°æ éä¿®æ¹ä»£ç ï¼å³å¯å®æ¶çä½¿ç¨æ°è§åã\n\n\n# 7.4. ç»è®¡æ¨¡å\n\nè§åå¼æè½ç¶ææ¯ç®åï¼ä½æ¯éçè§åä¸æ­å¢å ï¼è§æ¨¡è¶æ¥è¶å¤§ãå¯è½ä¼åºç°è§åå²çªï¼é¾ä»¥ç»´æ¤çæåµï¼å¹¶ä¸è§åè¶å¤ï¼æ§è½ä¹è¶å·®ã\n\nä¸ºäºè§£å³è¿ç§é®é¢ï¼å°±æäºç»è®¡æ¨¡åãç»è®¡æ¨¡åä¼ä½¿ç¨åç±»ç®æ³ææ´å¤æçæºå¨å­¦ä¹ ç®æ³è¿è¡æºè½ç»è®¡ãæ ¹æ®åå²äº¤æä¸­çä¿¡æ¯è®­ç»åç±»ï¼ç¶åå°ç»è¿ééå å·¥åçäº¤æä¿¡æ¯è¾å¥åç±»ç®æ³ï¼å¾å°äº¤æé£é©å¼ï¼ç¶ååºäºæ­¤ï¼ååºé¢æµã\n\nç»è¿ååè®­ç»åçç»è®¡æ¨¡åï¼åç¡®çä¸ä½äºè§åå¼æãä½æ¯ï¼éè¦æé¢åä¸å®¶ãè¡ä¸ä¸å®¶ä»å¥ï¼å»ºç«åççè®­ç»æ¨¡åï¼å¹¶ä¸æ­ä¼åã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * Wiki è¯æ¡ - è·¨ç«èæ¬\n * Web å®å¨æµè¯ä¹ XSS\n * Wiki è¯æ¡ - è·¨ç«è¯·æ±ä¼ªé \n * æµè° CSRF æ»å»æ¹å¼\n * ãæ¯æ¥ä¸é¢ãCSRF æ¯ä»ä¹ï¼ãæ¯æ¥ä¸é¢ãCSRF æ¯ä»ä¹ï¼\n * WEB å®å¨ä¹-CSRFï¼è·¨ç«è¯·æ±ä¼ªé ï¼\n * Wiki è¯æ¡ - SQL æ³¨å¥æ»å»\n * é¿å SQL æ³¨å¥\n * å®ä¾è®²è§£ SQL æ³¨å¥æ»å»\n * æç»æå¡æ»å»\n * ä¼ è¾å±å®å¨æ§åè®®\n * å¬å¼å¯é¥è®¤è¯\n * SSL/TLS åè®®è¿è¡æºå¶çæ¦è¿°\n * http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\n * CAS å®ç° SSO åç¹ç»å½åç\n * æéç³»ç»è®¾è®¡æ¨¡ååæï¼DACï¼MACï¼RBACï¼ABACï¼\n * RBAC æ¨¡åï¼åºäºç¨æ·-è§è²-æéæ§å¶çä¸äºæè',normalizedContent:'# ç³»ç»å®å¨æ§æ¶æ\n\n> å³é®è¯ï¼xssãcsrfãsql æ³¨å¥ãdosãæ¶æ¯æè¦ãå å¯ç®æ³ãè¯ä¹¦\n\n\n# 1. è®¤è¯\n\n\n# 1.1. sso\n\nsso(single sign on)ï¼å³åç¹ç»å½ãæè°åç¹ç»å½ï¼å°±æ¯åå¹³å°çè¯¸å¤åºç¨ç»éä¸æ¬¡ï¼ä¸ä¸æ¬¡å°±åç»éçåè½ã\n\nsso éè¦è§£å³å¤ä¸ªå¼æç³»ç»ä¹é´çé®é¢ï¼\n\n * session å±äº«é®é¢\n * è·¨åé®é¢\n\n# 1.1.1. session å±äº«é®é¢\n\nåå¸å¼ session çå ç§å®ç°ç­ç¥ï¼\n\n * ç²æ§ session - ç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ sessionã\n * åºç¨æå¡å¨é´ç session å¤å¶å±äº« - ç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n * åºäºç¼å­ç session å±äº« â ï¼æ¨èæ¹æ¡ï¼ - ä¸è¿éè¦ç¨åºèªèº«æ§å¶ session è¯»åï¼å¯ä»¥èèåºäº spring-session + redis è¿ç§æççæ¹æ¡æ¥å¤çã\n\n> è¯¦æè¯·åèï¼session åç\n\n# 1.1.2. cookie è·¨å\n\ncookie ä¸è½è·¨åï¼æ¯å¦ï¼æµè§å¨ä¸ä¼æ www.google.com ç cookie ä¼ ç» www.baidu.comã\n\nè¿å°±å­å¨ä¸ä¸ªé®é¢ï¼ç±äºååä¸åï¼ç¨æ·å¨ç³»ç» a ç»å½åï¼æµè§å¨è®°å½ç³»ç» a ç cookieï¼ä½æ¯è®¿é®ç³»ç» b çæ¶åä¸ä¼æºå¸¦è¿ä¸ª cookieã\n\néå¯¹ cookie ä¸è½è·¨å çé®é¢ï¼æå ç§è§£å³æ¹æ¡ï¼\n\n * æå¡ç«¯çæ cookie åï¼è¿åç»å®¢æ·ç«¯ï¼å®¢æ·ç«¯è§£æ cookie ï¼æå token ï¼æ¯å¦ jwtï¼ï¼æ­¤åæ¯æ¬¡è¯·æ±é½æºå¸¦è¿ä¸ª tokenã\n * å¤ä¸ªååå±äº« cookieï¼å¨è¿å cookie ç»å®¢æ·ç«¯çæ¶åï¼å¨ cookie ä¸­è®¾ç½® domain ç½ååã\n * å° token ä¿å­å¨ sessionstroage ä¸­ï¼ä¸ä¾èµ cookie å°±æ²¡æè·¨åçé®é¢äºï¼ã\n\n# 1.1.3. cas\n\ncas æ¯å®ç° sso çä¸»æµæ¹å¼ã\n\ncas åä¸ºä¸¤é¨åï¼cas server å cas client\n\n * cas server - è´è´£ç¨æ·çè®¤è¯å·¥ä½ï¼å°±åæ¯æç¬¬ä¸æ¬¡ç»å½ç¨æ·çä¸ä¸ªæ è¯å­å¨è¿éï¼ä»¥ä¾¿æ­¤ç¨æ·å¨å¶ä»ç³»ç»ç»å½æ¶éªè¯å¶éä¸éè¦åæ¬¡ç»å½ã\n * cas client - ä¸å¡åºç¨ï¼éè¦æ¥å¥ cas serverãå½ç¨æ·è®¿é®æä»¬çåºç¨æ¶ï¼é¦åéè¦éå®åå° cas server ç«¯è¿è¡éªè¯ï¼è¦æ¯åæ¥ç»éè¿ï¼å°±åå»ç»å½ï¼éå®åå°ä¸æ¸¸ç³»ç»ï¼å¦åè¿è¡ç¨æ·åå¯ç ç»éæä½ã\n\næ¯è¯­ï¼\n\n * ticket granting ticket (tgt) - å¯ä»¥è®¤ä¸ºæ¯ cas server æ ¹æ®ç¨æ·åãå¯ç çæçä¸å¼ ç¥¨ï¼å­å¨ server ç«¯ã\n * ticket granting cookie (tgc) - å¶å®å°±æ¯ä¸ä¸ª cookieï¼å­æ¾ç¨æ·èº«ä»½ä¿¡æ¯ï¼ç± server åç» client ç«¯ã\n * service ticket (st) - ç± tgt çæçä¸æ¬¡æ§ç¥¨æ®ï¼ç¨äºéªè¯ï¼åªè½ç¨ä¸æ¬¡ã\n\ncas å·¥ä½æµç¨ï¼\n\n\n\n 1. ç¨æ·è®¿é® cas client aï¼ä¸å¡ç³»ç»ï¼ï¼ç¬¬ä¸æ¬¡è®¿é®ï¼éå®åå°è®¤è¯æå¡ä¸­å¿ï¼cas serverï¼ãcas server åç°å½åè¯·æ±ä¸­æ²¡æ cookieï¼åéå®åå° cas server çç»å½é¡µé¢ãéå®åè¯·æ±ç url ä¸­åå«è®¿é®å°åï¼ä»¥ä¾¿è®¤è¯æååç´æ¥è·³è½¬å°è®¿é®é¡µé¢ã\n 2. ç¨æ·å¨ç»å½é¡µé¢è¾å¥ç¨æ·åãå¯ç ç­è®¤è¯ä¿¡æ¯ï¼è®¤è¯æååï¼cas server çæ tgtï¼åç¨ tgt çæä¸ä¸ª stãç¶åè¿å st å tgcï¼cookieï¼ç»æµè§å¨ã\n 3. æµè§å¨æºå¸¦ st ååº¦è®¿é®ä¹åæ³è®¿é®ç cas client a é¡µé¢ã\n 4. cas client a æ¶å° st åï¼å cas server éªè¯ st çæææ§ãéªè¯éè¿ååè®¸ç¨æ·è®¿é®é¡µé¢ã\n 5. æ­¤æ¶ï¼å¦æç»å½å¦ä¸ä¸ª cas client bï¼ä¼åéå®åå° cas serverï¼cas server å¯ä»¥å¤æ­è¿ä¸ª cas client b æ¯ç¬¬ä¸æ¬¡è®¿é®ï¼ä½æ¯æ¬å°æ tgcï¼æä»¥æ éåæ¬¡ç»å½ãç¨ tgc åå»ºä¸ä¸ª stï¼è¿åç»æµè§å¨ã\n 6. éå¤ç±»ä¼¼ 3ã4 æ­¥éª¤ã\n\n\n\nä»¥ä¸äºå½çº³æ»ç»å¦ä¸ï¼\n\n 1. è®¿é®æå¡ - ç¨æ·è®¿é® sso client èµæºã\n 2. å®åè®¤è¯ - sso client éå®åç¨æ·è¯·æ±å° sso serverã\n 3. ç¨æ·è®¤è¯ - ç¨æ·èº«ä»½è®¤è¯ã\n 4. åæ¾ç¥¨æ® - sso server ä¼äº§çä¸ä¸ª service ticket (st) å¹¶è¿åç»æµè§å¨ã\n 5. éªè¯ç¥¨æ® - æµè§å¨æ¯æ¬¡è®¿é® sso client æ¶ï¼æºå¸¦ stï¼sso client å sso server éªè¯ç¥¨æ®ãåªæéªè¯éè¿ï¼æåè®¸è®¿é®ã\n 6. ä¼ è¾ç¨æ·ä¿¡æ¯ - sso server éªè¯ç¥¨æ®éè¿åï¼ä¼ è¾ç¨æ·è®¤è¯ç»æä¿¡æ¯ç» sso clientã\n\n\n# 1.2. oauth 2.0\n\n# 1.2.1. åºæ¬åç\n\noauth å¨"å®¢æ·ç«¯"ä¸"æå¡æä¾å"ä¹é´ï¼è®¾ç½®äºä¸ä¸ªææå±ï¼authorization layerï¼ã"å®¢æ·ç«¯"ä¸è½ç´æ¥ç»å½"æå¡æä¾å"ï¼åªè½ç»å½ææå±ï¼ä»¥æ­¤å°ç¨æ·ä¸å®¢æ·ç«¯åºåå¼æ¥ã"å®¢æ·ç«¯"ç»å½ææå±æç¨çä»¤çï¼tokenï¼ï¼ä¸ç¨æ·çå¯ç ä¸åãç¨æ·å¯ä»¥å¨ç»å½çæ¶åï¼æå®ææå±ä»¤ççæéèå´åæææã\n\n"å®¢æ·ç«¯"ç»å½ææå±ä»¥åï¼"æå¡æä¾å"æ ¹æ®ä»¤ççæéèå´åæææï¼å"å®¢æ·ç«¯"å¼æ¾ç¨æ·å¨å­çèµæã\n\noauth 2.0 çè¿è¡æµç¨å¦ä¸å¾ï¼æèª rfc 6749ã\n\n\nï¼aï¼ç¨æ·æå¼å®¢æ·ç«¯ä»¥åï¼å®¢æ·ç«¯è¦æ±ç¨æ·ç»äºææã\n\nï¼bï¼ç¨æ·åæç»äºå®¢æ·ç«¯ææã\n\nï¼cï¼å®¢æ·ç«¯ä½¿ç¨ä¸ä¸æ­¥è·å¾çææï¼åè®¤è¯æå¡å¨ç³è¯·ä»¤çã\n\nï¼dï¼è®¤è¯æå¡å¨å¯¹å®¢æ·ç«¯è¿è¡è®¤è¯ä»¥åï¼ç¡®è®¤æ è¯¯ï¼åæåæ¾ä»¤çã\n\nï¼eï¼å®¢æ·ç«¯ä½¿ç¨ä»¤çï¼åèµæºæå¡å¨ç³è¯·è·åèµæºã\n\nï¼fï¼èµæºæå¡å¨ç¡®è®¤ä»¤çæ è¯¯ï¼åæåå®¢æ·ç«¯å¼æ¾èµæºã\n\nä¸é¾çåºæ¥ï¼ä¸é¢å­ä¸ªæ­¥éª¤ä¹ä¸­ï¼b æ¯å³é®ï¼å³ç¨æ·ææ ·æè½ç»äºå®¢æ·ç«¯ææãæäºè¿ä¸ªææä»¥åï¼å®¢æ·ç«¯å°±å¯ä»¥è·åä»¤çï¼è¿èå­ä»¤çè·åèµæºã\n\n# 1.2.2. æææ¨¡å¼\n\nå®¢æ·ç«¯å¿é¡»å¾å°ç¨æ·çææï¼authorization grantï¼ï¼æè½è·å¾ä»¤çï¼access tokenï¼ãoauth 2.0 å®ä¹äºåç§æææ¹å¼ã\n\n * ææç æ¨¡å¼ï¼authorization codeï¼\n * ç®åæ¨¡å¼ï¼implicitï¼\n * å¯ç æ¨¡å¼ï¼resource owner password credentialsï¼\n * å®¢æ·ç«¯æ¨¡å¼ï¼client credentialsï¼\n\n# 1.2.3. ææç æ¨¡å¼\n\nææç æ¨¡å¼ï¼authorization codeï¼æ¯åè½æå®æ´ãæµç¨æä¸¥å¯çæææ¨¡å¼ãå®çç¹ç¹å°±æ¯éè¿å®¢æ·ç«¯çåå°æå¡å¨ï¼ä¸"æå¡æä¾å"çè®¤è¯æå¡å¨è¿è¡äºå¨ã\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼aï¼ç¨æ·è®¿é®å®¢æ·ç«¯ï¼åèå°åèå¯¼åè®¤è¯æå¡å¨ã\n\nï¼bï¼ç¨æ·éæ©æ¯å¦ç»äºå®¢æ·ç«¯ææã\n\nï¼cï¼åè®¾ç¨æ·ç»äºææï¼è®¤è¯æå¡å¨å°ç¨æ·å¯¼åå®¢æ·ç«¯äºåæå®ç"éå®å uri"ï¼redirection uriï¼ï¼åæ¶éä¸ä¸ä¸ªææç ã\n\nï¼dï¼å®¢æ·ç«¯æ¶å°ææç ï¼éä¸æ©åç"éå®å uri"ï¼åè®¤è¯æå¡å¨ç³è¯·ä»¤çãè¿ä¸æ­¥æ¯å¨å®¢æ·ç«¯çåå°çæå¡å¨ä¸å®æçï¼å¯¹ç¨æ·ä¸å¯è§ã\n\nï¼eï¼è®¤è¯æå¡å¨æ ¸å¯¹äºææç åéå®å uriï¼ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼access tokenï¼åæ´æ°ä»¤çï¼refresh tokenï¼ã\n\nä¸é¢æ¯ä¸é¢è¿äºæ­¥éª¤æéè¦çåæ°ã\n\na æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ç³è¯·è®¤è¯ç uriï¼åå«ä»¥ä¸åæ°ï¼\n\n * response_typeï¼è¡¨ç¤ºææç±»åï¼å¿éé¡¹ï¼æ­¤å¤çå¼åºå®ä¸º"code"\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ç idï¼å¿éé¡¹\n * redirect_uriï¼è¡¨ç¤ºéå®å uriï¼å¯éé¡¹\n * scopeï¼è¡¨ç¤ºç³è¯·çæéèå´ï¼å¯éé¡¹\n * stateï¼è¡¨ç¤ºå®¢æ·ç«¯çå½åç¶æï¼å¯ä»¥æå®ä»»æå¼ï¼è®¤è¯æå¡å¨ä¼åå°ä¸å¨å°è¿åè¿ä¸ªå¼ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nget /authorize?response_type=code&client_id=s6bhdrkqt3&state=xyz\n  &redirect_uri=https%3a%2f%2fclient%2eexample%2ecom%2fcb http/1.1\nhost: server.example.com\n\n\nc æ­¥éª¤ä¸­ï¼æå¡å¨ååºå®¢æ·ç«¯ç uriï¼åå«ä»¥ä¸åæ°ï¼\n\n * codeï¼è¡¨ç¤ºææç ï¼å¿éé¡¹ãè¯¥ç çæææåºè¯¥å¾ç­ï¼éå¸¸è®¾ä¸º 10 åéï¼å®¢æ·ç«¯åªè½ä½¿ç¨è¯¥ç ä¸æ¬¡ï¼å¦åä¼è¢«æææå¡å¨æç»ãè¯¥ç ä¸å®¢æ·ç«¯ id åéå®å uriï¼æ¯ä¸ä¸å¯¹åºå³ç³»ã\n * stateï¼å¦æå®¢æ·ç«¯çè¯·æ±ä¸­åå«è¿ä¸ªåæ°ï¼è®¤è¯æå¡å¨çååºä¹å¿é¡»ä¸æ¨¡ä¸æ ·åå«è¿ä¸ªåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nhttp/1.1 302 found\nlocation: https://client.example.com/cb?code=splxlobezqqybys6wxsbia\n    &state=xyz\n\n\nd æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯åè®¤è¯æå¡å¨ç³è¯·ä»¤çç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * grant_typeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼å¿éé¡¹ï¼æ­¤å¤çå¼åºå®ä¸º"authorization_code"ã\n * codeï¼è¡¨ç¤ºä¸ä¸æ­¥è·å¾çææç ï¼å¿éé¡¹ã\n * redirect_uriï¼è¡¨ç¤ºéå®å uriï¼å¿éé¡¹ï¼ä¸å¿é¡»ä¸ a æ­¥éª¤ä¸­çè¯¥åæ°å¼ä¿æä¸è´ã\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ idï¼å¿éé¡¹ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\npost /token http/1.1\nhost: server.example.com\nauthorization: basic czzcagrsa3f0mzpnwdfmqmf0m2jw\ncontent-type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&code=splxlobezqqybys6wxsbia\n&redirect_uri=https%3a%2f%2fclient%2eexample%2ecom%2fcb\n\n\ne æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åéç http åå¤ï¼åå«ä»¥ä¸åæ°ï¼\n\n * access_tokenï¼è¡¨ç¤ºè®¿é®ä»¤çï¼å¿éé¡¹ã\n * token_typeï¼è¡¨ç¤ºä»¤çç±»åï¼è¯¥å¼å¤§å°åä¸ææï¼å¿éé¡¹ï¼å¯ä»¥æ¯ bearer ç±»åæ mac ç±»åã\n * expires_inï¼è¡¨ç¤ºè¿ææ¶é´ï¼åä½ä¸ºç§ãå¦æçç¥è¯¥åæ°ï¼å¿é¡»å¶ä»æ¹å¼è®¾ç½®è¿ææ¶é´ã\n * refresh_tokenï¼è¡¨ç¤ºæ´æ°ä»¤çï¼ç¨æ¥è·åä¸ä¸æ¬¡çè®¿é®ä»¤çï¼å¯éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¦æä¸å®¢æ·ç«¯ç³è¯·çèå´ä¸è´ï¼æ­¤é¡¹å¯çç¥ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nhttp/1.1 200 ok\ncontent-type: application/json;charset=utf-8\ncache-control: no-store\npragma: no-cache\n\n{\n "access_token":"2yotnfzfejr1zcsicmwpaa",\n "token_type":"example",\n "expires_in":3600,\n "refresh_token":"tgzv3jokf0xg5qx2tlkwia",\n "example_parameter":"example_value"\n}\n\n\nä»ä¸é¢ä»£ç å¯ä»¥çå°ï¼ç¸å³åæ°ä½¿ç¨ json æ ¼å¼åéï¼content-type: application/jsonï¼ãæ­¤å¤ï¼http å¤´ä¿¡æ¯ä¸­æç¡®æå®ä¸å¾ç¼å­ã\n\n# 1.2.4. ç®åæ¨¡å¼\n\nç®åæ¨¡å¼ï¼implicit grant typeï¼ä¸éè¿ç¬¬ä¸æ¹åºç¨ç¨åºçæå¡å¨ï¼ç´æ¥å¨æµè§å¨ä¸­åè®¤è¯æå¡å¨ç³è¯·ä»¤çï¼è·³è¿äº"ææç "è¿ä¸ªæ­¥éª¤ï¼å æ­¤å¾åãæææ­¥éª¤å¨æµè§å¨ä¸­å®æï¼ä»¤çå¯¹è®¿é®èæ¯å¯è§çï¼ä¸å®¢æ·ç«¯ä¸éè¦è®¤è¯ã\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼aï¼å®¢æ·ç«¯å°ç¨æ·å¯¼åè®¤è¯æå¡å¨ã\n\nï¼bï¼ç¨æ·å³å®æ¯å¦ç»äºå®¢æ·ç«¯ææã\n\nï¼cï¼åè®¾ç¨æ·ç»äºææï¼è®¤è¯æå¡å¨å°ç¨æ·å¯¼åå®¢æ·ç«¯æå®ç"éå®å uri"ï¼å¹¶å¨ uri ç hash é¨ååå«äºè®¿é®ä»¤çã\n\nï¼dï¼æµè§å¨åèµæºæå¡å¨ååºè¯·æ±ï¼å¶ä¸­ä¸åæ¬ä¸ä¸æ­¥æ¶å°ç hash å¼ã\n\nï¼eï¼èµæºæå¡å¨è¿åä¸ä¸ªç½é¡µï¼å¶ä¸­åå«çä»£ç å¯ä»¥è·å hash å¼ä¸­çä»¤çã\n\nï¼fï¼æµè§å¨æ§è¡ä¸ä¸æ­¥è·å¾çèæ¬ï¼æååºä»¤çã\n\nï¼gï¼æµè§å¨å°ä»¤çåç»å®¢æ·ç«¯ã\n\nä¸é¢æ¯ä¸é¢è¿äºæ­¥éª¤æéè¦çåæ°ã\n\na æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * response_typeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"token"ï¼å¿éé¡¹ã\n * client_idï¼è¡¨ç¤ºå®¢æ·ç«¯ç idï¼å¿éé¡¹ã\n * redirect_uriï¼è¡¨ç¤ºéå®åç uriï¼å¯éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n * stateï¼è¡¨ç¤ºå®¢æ·ç«¯çå½åç¶æï¼å¯ä»¥æå®ä»»æå¼ï¼è®¤è¯æå¡å¨ä¼åå°ä¸å¨å°è¿åè¿ä¸ªå¼ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nget /authorize?response_type=token&client_id=s6bhdrkqt3&state=xyz\n  &redirect_uri=https%3a%2f%2fclient%2eexample%2ecom%2fcb http/1.1\nhost: server.example.com\n\n\nc æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨ååºå®¢æ·ç«¯ç uriï¼åå«ä»¥ä¸åæ°ï¼\n\n * access_tokenï¼è¡¨ç¤ºè®¿é®ä»¤çï¼å¿éé¡¹ã\n * token_typeï¼è¡¨ç¤ºä»¤çç±»åï¼è¯¥å¼å¤§å°åä¸ææï¼å¿éé¡¹ã\n * expires_inï¼è¡¨ç¤ºè¿ææ¶é´ï¼åä½ä¸ºç§ãå¦æçç¥è¯¥åæ°ï¼å¿é¡»å¶ä»æ¹å¼è®¾ç½®è¿ææ¶é´ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¦æä¸å®¢æ·ç«¯ç³è¯·çèå´ä¸è´ï¼æ­¤é¡¹å¯çç¥ã\n * stateï¼å¦æå®¢æ·ç«¯çè¯·æ±ä¸­åå«è¿ä¸ªåæ°ï¼è®¤è¯æå¡å¨çååºä¹å¿é¡»ä¸æ¨¡ä¸æ ·åå«è¿ä¸ªåæ°ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nhttp/1.1 302 found\nlocation: http://example.com/cb#access_token=2yotnfzfejr1zcsicmwpaa\n         &state=xyz&token_type=example&expires_in=3600\n\n\nå¨ä¸é¢çä¾å­ä¸­ï¼è®¤è¯æå¡å¨ç¨ http å¤´ä¿¡æ¯ç location æ ï¼æå®æµè§å¨éå®åçç½åãæ³¨æï¼å¨è¿ä¸ªç½åç hash é¨ååå«äºä»¤çã\n\næ ¹æ®ä¸é¢ç d æ­¥éª¤ï¼ä¸ä¸æ­¥æµè§å¨ä¼è®¿é® location æå®çç½åï¼ä½æ¯ hash é¨åä¸ä¼åéãæ¥ä¸æ¥ç e æ­¥éª¤ï¼æå¡æä¾åçèµæºæå¡å¨åéè¿æ¥çä»£ç ï¼ä¼æååº hash ä¸­çä»¤çã\n\nå¯ç æ¨¡å¼\n\nå¯ç æ¨¡å¼ï¼resource owner password credentials grantï¼ä¸­ï¼ç¨æ·åå®¢æ·ç«¯æä¾èªå·±çç¨æ·ååå¯ç ãå®¢æ·ç«¯ä½¿ç¨è¿äºä¿¡æ¯ï¼å"æå¡åæä¾å"ç´¢è¦ææã\n\nå¨è¿ç§æ¨¡å¼ä¸­ï¼ç¨æ·å¿é¡»æèªå·±çå¯ç ç»å®¢æ·ç«¯ï¼ä½æ¯å®¢æ·ç«¯ä¸å¾å¨å­å¯ç ãè¿éå¸¸ç¨å¨ç¨æ·å¯¹å®¢æ·ç«¯é«åº¦ä¿¡ä»»çæåµä¸ï¼æ¯å¦å®¢æ·ç«¯æ¯æä½ç³»ç»çä¸é¨åï¼æèç±ä¸ä¸ªèåå¬å¸åºåãèè®¤è¯æå¡å¨åªæå¨å¶ä»æææ¨¡å¼æ æ³æ§è¡çæåµä¸ï¼æè½èèä½¿ç¨è¿ç§æ¨¡å¼ã\n\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼aï¼ç¨æ·åå®¢æ·ç«¯æä¾ç¨æ·ååå¯ç ã\n\nï¼bï¼å®¢æ·ç«¯å°ç¨æ·ååå¯ç åç»è®¤è¯æå¡å¨ï¼ååèè¯·æ±ä»¤çã\n\nï¼cï¼è®¤è¯æå¡å¨ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯æä¾è®¿é®ä»¤çã\n\nb æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * grant_typeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"password"ï¼å¿éé¡¹ã\n * usernameï¼è¡¨ç¤ºç¨æ·åï¼å¿éé¡¹ã\n * passwordï¼è¡¨ç¤ºç¨æ·çå¯ç ï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\npost /token http/1.1\nhost: server.example.com\nauthorization: basic czzcagrsa3f0mzpnwdfmqmf0m2jw\ncontent-type: application/x-www-form-urlencoded\n\ngrant_type=password&username=johndoe&password=a3ddj3w\n\n\nc æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼ä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nhttp/1.1 200 ok\ncontent-type: application/json;charset=utf-8\ncache-control: no-store\npragma: no-cache\n\n{\n "access_token":"2yotnfzfejr1zcsicmwpaa",\n "token_type":"example",\n "expires_in":3600,\n "refresh_token":"tgzv3jokf0xg5qx2tlkwia",\n "example_parameter":"example_value"\n}\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸ªåæ°çå«ä¹åè§ãææç æ¨¡å¼ãä¸èã\n\næ´ä¸ªè¿ç¨ä¸­ï¼å®¢æ·ç«¯ä¸å¾ä¿å­ç¨æ·çå¯ç ã\n\nå®¢æ·ç«¯æ¨¡å¼\n\nå®¢æ·ç«¯æ¨¡å¼ï¼client credentials grantï¼æå®¢æ·ç«¯ä»¥èªå·±çåä¹ï¼èä¸æ¯ä»¥ç¨æ·çåä¹ï¼å"æå¡æä¾å"è¿è¡è®¤è¯ãä¸¥æ ¼å°è¯´ï¼å®¢æ·ç«¯æ¨¡å¼å¹¶ä¸å±äº oauth æ¡æ¶æè¦è§£å³çé®é¢ãå¨è¿ç§æ¨¡å¼ä¸­ï¼ç¨æ·ç´æ¥åå®¢æ·ç«¯æ³¨åï¼å®¢æ·ç«¯ä»¥èªå·±çåä¹è¦æ±"æå¡æä¾å"æä¾æå¡ï¼å¶å®ä¸å­å¨ææé®é¢ã\n\n\n\nå®çæ­¥éª¤å¦ä¸ï¼\n\nï¼aï¼å®¢æ·ç«¯åè®¤è¯æå¡å¨è¿è¡èº«ä»½è®¤è¯ï¼å¹¶è¦æ±ä¸ä¸ªè®¿é®ä»¤çã\n\nï¼bï¼è®¤è¯æå¡å¨ç¡®è®¤æ è¯¯åï¼åå®¢æ·ç«¯æä¾è®¿é®ä»¤çã\n\na æ­¥éª¤ä¸­ï¼å®¢æ·ç«¯ååºç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºææç±»åï¼æ­¤å¤çå¼åºå®ä¸º"clientcredentials"ï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºæéèå´ï¼å¯éé¡¹ã\n\npost /token http/1.1\nhost: server.example.com\nauthorization: basic czzcagrsa3f0mzpnwdfmqmf0m2jw\ncontent-type: application/x-www-form-urlencoded\n\ngrant_type=client_credentials\n\n\nè®¤è¯æå¡å¨å¿é¡»ä»¥æç§æ¹å¼ï¼éªè¯å®¢æ·ç«¯èº«ä»½ã\n\nb æ­¥éª¤ä¸­ï¼è®¤è¯æå¡å¨åå®¢æ·ç«¯åéè®¿é®ä»¤çï¼ä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\nhttp/1.1 200 ok\ncontent-type: application/json;charset=utf-8\ncache-control: no-store\npragma: no-cache\n\n{\n "access_token":"2yotnfzfejr1zcsicmwpaa",\n "token_type":"example",\n "expires_in":3600,\n "example_parameter":"example_value"\n}\n\n\nä¸é¢ä»£ç ä¸­ï¼åä¸ªåæ°çå«ä¹åè§ãææç æ¨¡å¼ãä¸èã\n\n# 1.2.5. æ´æ°ä»¤ç\n\nå¦æç¨æ·è®¿é®çæ¶åï¼å®¢æ·ç«¯ç"è®¿é®ä»¤ç"å·²ç»è¿æï¼åéè¦ä½¿ç¨"æ´æ°ä»¤ç"ç³è¯·ä¸ä¸ªæ°çè®¿é®ä»¤çã\n\nå®¢æ·ç«¯ååºæ´æ°ä»¤çç http è¯·æ±ï¼åå«ä»¥ä¸åæ°ï¼\n\n * granttypeï¼è¡¨ç¤ºä½¿ç¨çæææ¨¡å¼ï¼æ­¤å¤çå¼åºå®ä¸º"refreshtoken"ï¼å¿éé¡¹ã\n * refresh_tokenï¼è¡¨ç¤ºæ©åæ¶å°çæ´æ°ä»¤çï¼å¿éé¡¹ã\n * scopeï¼è¡¨ç¤ºç³è¯·çææèå´ï¼ä¸å¯ä»¥è¶åºä¸ä¸æ¬¡ç³è¯·çèå´ï¼å¦æçç¥è¯¥åæ°ï¼åè¡¨ç¤ºä¸ä¸ä¸æ¬¡ä¸è´ã\n\nä¸é¢æ¯ä¸ä¸ªä¾å­ã\n\npost /token http/1.1\nhost: server.example.com\nauthorization: basic czzcagrsa3f0mzpnwdfmqmf0m2jw\ncontent-type: application/x-www-form-urlencoded\n\ngrant_type=refresh_token&refresh_token=tgzv3jokf0xg5qx2tlkwia\n\n\n\n# 2. é´æ\n\n\n# 2.1. rbac\n\nrbacï¼role-based access controlï¼å³ï¼åºäºè§è²çæéæ§å¶ãéè¿è§è²å³èç¨æ·ï¼è§è²å³èæéçæ¹å¼é´æ¥èµäºç¨æ·æéã\n\næ¯ä¸ªç¨æ·å³èä¸ä¸ªæå¤ä¸ªè§è²ï¼æ¯ä¸ªè§è²å³èä¸ä¸ªæå¤ä¸ªæéï¼ä»èå¯ä»¥å®ç°äºéå¸¸çµæ´»çæéç®¡çãè§è²å¯ä»¥æ ¹æ®å®éä¸å¡éæ±çµæ´»åå»ºï¼è¿æ ·å°±çå»äºæ¯æ°å¢ä¸ä¸ªç¨æ·å°±è¦å³èä¸éæææéçéº»ç¦ãç®åæ¥è¯´ rbac å°±æ¯ï¼ç¨æ·å³èè§è²ï¼è§è²å³èæéã\n\n\n\n\n# 2.2. è§è²ç»§æ¿\n\nè§è²ç»§æ¿(hierarchical role) å°±æ¯æè§è²å¯ä»¥ç»§æ¿äºå¶ä»è§è²ï¼å¨æ¥æå¶ä»è§è²æéçåæ¶ï¼èªå·±è¿å¯ä»¥å³èé¢å¤çæéãè¿ç§è®¾è®¡å¯ä»¥ç»è§è²åç»ååå±ï¼ä¸å®ç¨åº¦ç®åäºæéç®¡çå·¥ä½ã\n\n\n\n# 2.2.1. èè´£åç¦»(separation of duty)\n\nä¸ºäºé¿åç¨æ·æ¥æè¿å¤æéèäº§çå©çå²çªï¼ä¾å¦ä¸ä¸ªç¯®çè¿å¨ååæ¶æ¥æè£å¤çæéï¼çä¸ç¼å°±ç»ä½ å¤ç¯è§ç ä¸ç ï¼ï¼ï¼å¦ä¸ç§èè´£åç¦»æ©å±çç rbac è¢«æåºã\n\nèè´£åç¦»æä¸¤ç§æ¨¡å¼ï¼\n\néæèè´£åç¦»(static separation of duty)ï¼ç¨æ·æ æ³åæ¶è¢«èµäºæå²çªçè§è²ã\n\n\n\nå¨æèè´£åç¦»(dynamic separation of duty)ï¼ç¨æ·å¨ä¸æ¬¡ä¼è¯ï¼sessionï¼ä¸­ä¸è½åæ¶æ¿æ´»èªèº«ææ¥æçãäºç¸æå²çªçè§è²ï¼åªè½éæ©å¶ä¸ã\n\n\n\nè®²äºè¿ä¹å¤ rbacï¼é½è¿åªæ¯å¨ç¨æ·åæéä¹é´è¿è¡è®¾è®¡ï¼å¹¶æ²¡ææ¶åå°ç¨æ·åå¯¹è±¡ä¹é´çæéå¤æ­ï¼èå¨å®éä¸å¡ç³»ç»ä¸­éå¶ç¨æ·è½å¤ä½¿ç¨çå¯¹è±¡æ¯å¾å¸¸è§çéæ±ã\n\n\n# 2.3. rbac0 æ¨¡å\n\næç®åçç¨æ·ãè§è²ãæéæ¨¡åãè¿éé¢ååå«äº 2 ç§ï¼\n\n 1. ç¨æ·åè§è²æ¯å¤å¯¹ä¸å³ç³»ï¼å³ï¼ä¸ä¸ªç¨æ·åªåå½ä¸ç§è§è²ï¼ä¸ç§è§è²å¯ä»¥æå¤ä¸ªç¨æ·æå½ã\n 2. ç¨æ·åè§è²æ¯å¤å¯¹å¤å³ç³»ï¼å³ï¼ä¸ä¸ªç¨æ·å¯åæ¶åå½å¤ç§è§è²ï¼ä¸ç§è§è²å¯ä»¥æå¤ä¸ªç¨æ·æå½ã\n\né£ä¹ï¼ä»ä¹æ¶åè¯¥ä½¿ç¨å¤å¯¹ä¸çæéä½ç³»ï¼ä»ä¹æ¶ååè¯¥ä½¿ç¨å¤å¯¹å¤çæéä½ç³»å¢ï¼\n\nå¦æç³»ç»åè½æ¯è¾åä¸ï¼ä½¿ç¨äººåè¾å°ï¼å²ä½æéç¸å¯¹æ¸æ°ä¸ç¡®ä¿ä¸ä¼åºç°å¼å²çæåµï¼æ­¤æ¶å¯ä»¥èèç¨å¤å¯¹ä¸çæéä½ç³»ãå¶ä½æåµå°½éä½¿ç¨å¤å¯¹å¤çæéä½ç³»ï¼ä¿è¯ç³»ç»çå¯æ©å±æ§ãå¦ï¼å¼ ä¸æ¢æ¯è¡æ¿ï¼ä¹è´è´£è´¢å¡å·¥ä½ï¼é£å¼ ä¸å°±åæ¶æ¥æè¡æ¿åè´¢å¡ä¸¤ä¸ªè§è²çæéã\n\n\n# 2.4. rbac1 æ¨¡å\n\nç¸å¯¹äº rbac0 æ¨¡åï¼å¢å äºå­è§è²ï¼å¼å¥äºç»§æ¿æ¦å¿µï¼å³å­è§è²å¯ä»¥ç»§æ¿ç¶è§è²çæææéã\n\n\n\n**ä½¿ç¨åºæ¯ï¼**å¦æä¸ªä¸å¡é¨é¨ï¼æç»çãä¸»ç®¡ãä¸åãä¸»ç®¡çæéä¸è½å¤§äºç»çï¼ä¸åçæéä¸è½å¤§äºä¸»ç®¡ï¼å¦æéç¨ rbac0 æ¨¡ååæéç³»ç»ï¼æå¯è½åºç°åéæéå¤±è¯¯ï¼æç»åºç°ä¸»ç®¡æ¥æç»çé½æ²¡æçæéçæåµã\n\nè rbac1 æ¨¡åå°±å¾å¥½è§£å³äºè¿ä¸ªé®é¢ï¼åå»ºå®ç»çè§è²å¹¶éç½®å¥½æéåï¼ä¸»ç®¡è§è²çæéç»§æ¿ç»çè§è²çæéï¼å¹¶ä¸æ¯æå¨ç»çæéä¸å åä¸»ç®¡æéã\n\n\n# 2.5. rbac2 æ¨¡å\n\nåºäº rbac0 æ¨¡åï¼å¢å äºå¯¹è§è²çä¸äºéå¶ï¼è§è²äºæ¥ãåºæ°çº¦æãåå³æ¡ä»¶è§è²ç­ã\n\n * **è§è²äºæ¥ï¼**åä¸ç¨æ·ä¸è½åéå°ä¸ç»äºæ¥è§è²éåä¸­çå¤ä¸ªè§è²ï¼äºæ¥è§è²æ¯ææéäºç¸å¶çº¦çä¸¤ä¸ªè§è²ãæ¡ä¾ï¼è´¢å¡ç³»ç»ä¸­ä¸ä¸ªç¨æ·ä¸è½åæ¶è¢«ææ´¾ç»ä¼è®¡è§è²åå®¡è®¡åè§è²ã\n * **åºæ°çº¦æï¼**ä¸ä¸ªè§è²è¢«åéçç¨æ·æ°éåéï¼å®æçæ¯æå¤å°ç¨æ·è½æ¥æè¿ä¸ªè§è²ãä¾å¦ï¼ä¸ä¸ªè§è²ä¸é¨ä¸ºå¬å¸ ceo åå»ºçï¼é£è¿ä¸ªè§è²çæ°éæ¯æéçã\n * **åå³æ¡ä»¶è§è²ï¼**æè¦æ³è·å¾è¾é«çæéï¼è¦é¦åæ¥æä½ä¸çº§çæéãä¾å¦ï¼åæå¯æ»ç»çæéï¼æè½ææ»ç»çæéã\n * **è¿è¡æ¶äºæ¥ï¼**ä¾å¦ï¼åè®¸ä¸ä¸ªç¨æ·å·æä¸¤ä¸ªè§è²çæåèµæ ¼ï¼ä½å¨è¿è¡ä¸­ä¸å¯åæ¶æ¿æ´»è¿ä¸¤ä¸ªè§è²ã\n\n\n# 2.6. rbac3 æ¨¡å\n\nç§°ä¸ºç»ä¸æ¨¡åï¼å®åå«äº rbac1 å rbac2ï¼å©ç¨ä¼ éæ§ï¼ä¹æ rbac0 åæ¬å¨åï¼ç»¼åäº rbac0ãrbac1 å rbac2 çææç¹ç¹ï¼è¿éå°±ä¸å¨å¤æè¿°äºã\n\n\n\n\n# 2.7. ä»ä¹æ¯æé\n\nè¯´äºè¿ä¹ä¹ç¨æ·-è§è²-æéï¼å¯è½å°ä¼ä¼´ä»¬é½äºè§£äºä»ä¹æ¯ç¨æ·ãä»ä¹æ¯è§è²ãä½æ¯æçå°ä¼ä¼´ä¼å¥½å¥ï¼é£æéåæ¯ä¸ªä»ä¹ç©æå¢ï¼\n\næéæ¯èµæºçéåï¼è¿éçèµæºæçæ¯è½¯ä»¶ä¸­ææçåå®¹ï¼åæ¬æ¨¡åãèåãé¡µé¢ãå­æ®µãæä½åè½ï¼å¢å æ¹æ¥ï¼ç­ç­ãå·ä½çæééç½®ä¸ï¼ç®åå½¢å¼å¤ç§å¤æ ·ï¼æç§æä¸ªäººççè§£ï¼å¯ä»¥å°æéåä¸ºï¼é¡µé¢æéãæä½æéåæ°æ®æéï¼è¿ç§åç±»æ³ï¼ä¸»è¦æ¯ç»åèªå·±å¨å·¥ä½ä¸­çå®éæåµçè§£æ»ç»èæ¥ï¼è¥æä¸è¶³ä¹å¤ï¼ä¹è¯·å¤§å®¶æåºï¼ã\n\n**é¡µé¢æéï¼**ææç³»ç»é½æ¯ç±ä¸ä¸ªä¸ªçé¡µé¢ç»æï¼é¡µé¢åç»ææ¨¡åï¼ç¨æ·æ¯å¦è½çå°è¿ä¸ªé¡µé¢çèåãæ¯å¦è½è¿å¥è¿ä¸ªé¡µé¢å°±ç§°ä¸ºé¡µé¢æéã\n\nå¦ä¸å¾ï¼\n\n\n\nå®¢æ·åè¡¨ãå®¢æ·é»ååãå®¢æ·å®¡æ¹é¡µé¢ç»æäºå®¢æ·ç®¡çè¿ä¸ªæ¨¡åãå¯¹äºæ®éç¨æ·ï¼ä¸è½è¿è¡å®¡æ¹æä½ï¼å³æ å®¢æ·å®¡æ¹é¡µé¢æéï¼å¨ä»çè´¦å·ç»å½åä¾§è¾¹å¯¼èªæ åªæ¾ç¤ºå®¢æ·åè¡¨ãå®¢æ·é»ååä¸¤ä¸ªèåã\n\n**æä½æéï¼**ç¨æ·å¡æ¯å¨æä½ç³»ç»ä¸­çä»»ä½å¨ä½ãäº¤äºé½æ¯æä½æéï¼å¦å¢å æ¹æ¥ç­ã\n\n**æ°æ®æéï¼**ä¸è¬ä¸å¡ç®¡çç³»ç»ï¼é½ææ°æ®ç§å¯æ§çè¦æ±ï¼åªäºäººå¯ä»¥çå°åªäºæ°æ®ï¼ä¸å¯ä»¥çå°åªäºæ°æ®ã\n\nç®åä¸¾ä¸ªä¾å­ï¼æç³»ç»ä¸­æéå®é¨é¨ï¼éå®ä¸åè´è´£æ¨éååï¼éå®ä¸»ç®¡è´è´£ç®¡çéå®ä¸åæ¥å¸¸å·¥ä½ï¼ç»çè´è´£ç»ç»ç®¡çéå®ä¸»ç®¡ä½ä¸ã\n\nå¦ä¸å¾ï¼\n\n\n\næç§å®éçè§£ï¼âéå®ä¸åå¼ ä¸âç»å½æ¶ï¼åªè½çå°èªå·±è´è´£çæ°æ®ï¼éå®ä¸»ç®¡ 2 ç»å½æ¶ï¼è½çå°ä»æé¢å¯¼çææä¸å¡åè´è´£çæ°æ®ï¼ä½çä¸å°å¶ä»å¢éä¸å¡åè´è´£çæ°æ®ã\n\næ¢å¦å¤ä¸å¥è¯å°±æ¯ï¼æçå®¢æ·åªææåæçç´å±ä¸çº§ä»¥åç´å±ä¸çº§çé¢å¯¼è½çå°ï¼è¿å°±æ¯æçè§£çæ°æ®æéã\n\nè¦å®ç°æ°æ®æéæå¤ç§æ¹å¼ï¼\n\n 1. å¯ä»¥å©ç¨ rbac1 æ¨¡åï¼éè¿è§è²åçº§æ¥å®ç°ã\n 2. å¨âç¨æ·-è§è²-æéâçåºç¡ä¸ï¼å¢å ç¨æ·ä¸ç»ç»çå³èå³ç³»ï¼ç¨ç»ç»å³å®ç¨æ·çæ°æ®æéã\n\nå·ä½å¦ä½åå¢ï¼\n\nâ  ç»ç»å±çº§ååï¼\n\n\n\n**â¡ æ°æ®å¯è§æéè§åå¶å®ï¼**ä¸çº§ç»ç»åªè½çå°ä¸çº§ç»ç»åå·¥è´è´£çæ°æ®ï¼èä¸è½çå°å¶ä»å¹³çº§ç»ç»åå¶ä¸çº§ç»ç»çåå·¥æ°æ®ç­ã\n\néè¿ä»¥ä¸ä¸¤ç¹ï¼ç³»ç»å°±å¯ä»¥å¨ç¨æ·ç»å½æ¶ï¼èªå¨å¤æ­è¦ç»ç¨æ·å±ç¤ºåªäºæ°æ®äºã\n\n\n# 2.8. ç¨æ·ç»çä½¿ç¨\n\nå½å¹³å°ç¨æ·åºæ°å¢å¤§ï¼è§è²ç±»åå¢å¤æ¶ï¼å¦æç´æ¥ç»ç¨æ·éè§è²ï¼ç®¡çåçå·¥ä½éå°±ä¼å¾å¤§ãè¿æ¶åæä»¬å¯ä»¥å¼å¥ä¸ä¸ªæ¦å¿µâç¨æ·ç»âï¼å°±æ¯å°ç¸åå±æ§çç¨æ·å½ç±»å°ä¸èµ·ã\n\nä¾å¦ï¼å å¥ç¨æ·ç»çæ¦å¿µåï¼å¯ä»¥å°é¨é¨çåä¸ä¸ªç¨æ·ç»ï¼åç»è¿ä¸ªé¨é¨ç´æ¥èµäºè§è²ï¼1 ä¸åå·¥é¨é¨å¯è½å°±å åä¸ªï¼ï¼ä½¿é¨é¨æ¥æé¨é¨æéï¼è¿æ ·è¿ä¸ªé¨é¨çææç¨æ·é½æäºé¨é¨æéï¼èä¸éè¦ä¸ºæ¯ä¸ä¸ªç¨æ·ååç¬æå®è§è²ï¼æå¤§çåå°äºåéæéçå·¥ä½éã\n\nåæ¶ï¼ä¹å¯ä»¥ä¸ºç¹å®çç¨æ·æå®è§è²ï¼è¿æ ·ç¨æ·é¤äºæ¥ææå±ç¨æ·ç»çæææéå¤ï¼è¿æ¥æèªèº«ç¹å®çæéã\n\nç¨æ·ç»çä¼ç¹ï¼é¤äºåå°å·¥ä½éï¼è¿ææ´ä¾¿äºçè§£ãå¢å å¤çº§ç®¡çå³ç³»ç­ãå¦ï¼æä»¬å¨è¿è¡ç»ç»æºæéç½®çæ¶åï¼é¤äºå å¥é¨é¨ï¼è¿å¯ä»¥å å¥ç§å®¤ãå²ä½ç­å±çº§ï¼æ¥ä¸ºç¨æ·ç»åé¨æåçæéè¿è¡ç­çº§ä¸çåºåã\n\nå³äºç¨æ·ç»çè¯¦ç»çé¾è§£ç­ï¼è¯·æ¥çhttps://wen.woshipm.com/question/detail/88fues.htmlãå¨è¿éä¹ååæè°¢ä¸ºæè§£ç­çæçæåä»¬ï¼\n\n\n# 2.9. å®ä¾åæ\n\n\n# 2.10. å¦ä½è®¾è®¡ rbac æéç³»ç»\n\né¦åï¼æä»¬æèä¸ä¸ä¸ä¸ªç®åçæéç³»ç»åºè¯¥å·å¤åªäºåå®¹ï¼\n\nç­æ¡æ¾èæè§ï¼rbac æ¨¡åï¼ç¨æ·-è§è²-æéãæä»¥æåºæ¬çæä»¬åºè¯¥å·å¤ç¨æ·ãè§è²ãæéè¿ä¸ä¸ªåå®¹ã\n\næ¥ä¸æ¥ï¼æä»¬æèï¼ç©¶ç«å¦ä½å°ä¸èå³èèµ·æ¥ãåé¡¾åæï¼è§è²ä½ä¸ºæ¢çº½ï¼å³èç¨æ·ãæéãæä»¥å¨ rbac æ¨¡åä¸ï¼æä»¬åºè¯¥ï¼åå»ºä¸ä¸ªè§è²ï¼å¹¶ä¸ºè¿ä¸ªè§è²èµäºç¸åºæéï¼æåå°è§è²èµäºç¨æ·ã\n\nå°è¿ä¸ªé®é¢æ½è±¡ä¸ºæµç¨ï¼å¦ä¸å¾ï¼\n\n\n\nç°å¨ï¼åºæ¬çæµç¨é»è¾å·²ç»æ½è±¡åºæ¥äºï¼æ¥ä¸æ¥ï¼åæè¯¥å¦ä½è®¾è®¡å¢ï¼\n\n * ç¬¬ä¸æ­¥ï¼éè¦è§è²ç®¡çåè¡¨ï¼å¨è§è²ç®¡çåè¡¨è½å¿«éåå»ºä¸ä¸ªè§è²ï¼ä¸åå»ºè§è²çåæ¶è½ä¸ºè§è²éç½®æéï¼å¹¶ä¸æ¯æåå»ºæåçè§è²åè¡¨è½éæ¶è¿è¡æééç½®ççä¿®æ¹ï¼\n * ç¬¬äºæ­¥ï¼éè¦ç¨æ·ç®¡çåè¡¨ï¼å¨ç¨æ·ç®¡çåè¡¨è½å¿«éæ·»å ä¸ä¸ªç¨æ·ï¼ä¸æ·»å ç¨æ·æ¶æè®©ç¨æ·å³èè§è²çåè½ã\n\nç®åæ¥è¯´æéç³»ç»è®¾è®¡å°±åå«ä»¥ä¸ä¸¤æ­¥ï¼æ¥ä¸æ¥ä¸ºå¤§å®¶è¿è¡å®ä¾åæã\n\n\n# 2.11. å®ä¾åæ\n\nâ  åå»ºè§è²åè¡¨\n\n\n\nå¨è§è²åè¡¨å¿«éåå»ºä¸ä¸ªè§è²ï¼ç¹å»åå»ºè§è²ï¼æ¯æåå»ºè§è²æ¶éç½®æéã\n\n\n\nâ¡ åå»ºç¨æ·åè¡¨\n\n\n\nå¨ç¨æ·åè¡¨å¿«éåå»ºä¸ä¸ªç¨æ·ï¼æ¯æç¨æ·å³èè§è²çåè½ã\n\n\n\nä¸è¿°æ¡ä¾æ¯åºäºæç®åç rbac0 æ¨¡ååå»ºï¼éç¨äºå¤§é¨åå¸¸è§çæéç®¡çç³»ç»ã\n\nä¸é¢ååæä¸ä¸ rbac1 ä¸­è§è²åçº§å·ä½å¦ä½è®¾è®¡ã\n\n 1. å¨ rbac0 çåºç¡ä¸ï¼å ä¸è§è²ç­çº§è¿ä¸ªå­æ®µã\n 2. æéåéè§åå¶å®ï¼ä½ç­çº§è§è²åªè½å¨é«ç­çº§è§è²æéåºç¡ä¸è¿è¡å åæéã\n\nå·ä½çé¢åç°å¦ä¸å¾ï¼\n\n\n\nä»¥ä¸å°±æ¯ç®åç rbac ç³»ç»è®¾è®¡ï¼è¥éæ´å¤æçï¼è¿è¯·è¯»èæ ¹æ®ä¸é¢çåæèªè¡æ£æ©æèï¼å°½ç®¡æ ·å¼ä¸åï¼ä½ä¸åä¸ç¦»å¶å®ï¼çè§£æ¸æ¥ rbac æ¨¡ååï¼ç»åèªå·±çä¸å¡å°±å¯ä»¥è®¾è®¡åºä¸å¥ç¬¦åèªå·±å¹³å°éæ±çè§è²æéç³»ç»ï¼å·ä½çå°±ä¸åå¤éè¿°äºã\n\n\n# 3. å®¡è®¡\n\ntodo\n\n\n# 4. ç½ç«æ»å»\n\näºèç½ç¯å¢é±¼é¾æ··æï¼ç½ç«è¢«æ»å»æ¯å¸¸è§ç°è±¡ï¼æä»¥äºè§£ä¸äºå¸¸è§çç½ç«æ»å»ææ®µååå¿è¦ãä¸é¢åä¸¾æ¯è¾å¸¸è§ç 4 ç§æ»å»ææ®µï¼\n\n\n# 4.1. xss\n\n# 4.1.1. æ¦å¿µ\n\nè·¨ç«èæ¬ï¼cross-site scriptingï¼éå¸¸ç®ç§°ä¸ºxssï¼ æ¯ä¸ç§ç½ç«åºç¨ç¨åºçå®å¨æ¼æ´æ»å»ï¼æ¯ä»£ç æ³¨å¥çä¸ç§ãå®åè®¸æ¶æç¨æ·å°ä»£ç æ³¨å¥å°ç½é¡µä¸ï¼å¶ä»ç¨æ·å¨è§çç½é¡µæ¶å°±ä¼åå°å½±åãè¿ç±»æ»å»éå¸¸åå«äº html ä»¥åç¨æ·ç«¯èæ¬è¯­è¨ã\n\nxss æ»å»ç¤ºä¾ï¼\n\nåå¦æä¸é¢ä¸ä¸ª textbox\n\n<input type="text" name="address1" value="value1from" />\n\n\nvalue1from æ¯æ¥èªç¨æ·çè¾å¥ï¼å¦æç¨æ·ä¸æ¯è¾å¥ value1from,èæ¯è¾å¥ "/><script>alert(document.cookie)<\/script><!- é£ä¹å°±ä¼åæï¼\n\n<input type="text" name="address1" value="" />\n<script>\n  alert(document.cookie)\n<\/script>\n<!- ">\n\n\nåµå¥ç javascript ä»£ç å°ä¼è¢«æ§è¡ãæ»å»çå¨åï¼åå³äºç¨æ·è¾å¥äºä»ä¹æ ·çèæ¬ã\n\n# 4.1.2. æ»å»ææ®µåç®ç\n\nå¸¸ç¨ç xss æ»å»ææ®µåç®çæï¼\n\n * çç¨ cookieï¼è·åææä¿¡æ¯ã\n * å©ç¨æ¤å¥ flashï¼éè¿ crossdomain æéè®¾ç½®è¿ä¸æ­¥è·åæ´é«æéï¼æèå©ç¨ java ç­å¾å°ç±»ä¼¼çæä½ã\n * å©ç¨ iframeãframeãxmlhttprequest æä¸è¿° flash ç­æ¹å¼ï¼ä»¥ï¼è¢«æ»å»ï¼ç¨æ·çèº«ä»½æ§è¡ä¸äºç®¡çå¨ä½ï¼ææ§è¡ä¸äºä¸è¬çå¦åå¾®åãå å¥½åãåç§ä¿¡ç­æä½ã\n * å©ç¨å¯è¢«æ»å»çååå°å¶ä»åä¿¡ä»»çç¹ç¹ï¼ä»¥åä¿¡ä»»æ¥æºçèº«ä»½è¯·æ±ä¸äºå¹³æ¶ä¸åè®¸çæä½ï¼å¦è¿è¡ä¸å½çæç¥¨æ´»å¨ã\n * å¨è®¿é®éæå¤§çä¸äºé¡µé¢ä¸ç xss å¯ä»¥æ»å»ä¸äºå°åç½ç«ï¼å®ç° ddos æ»å»çææã\n\n# 4.1.3. åºå¯¹ææ®µ\n\n * è¿æ»¤ç¹æ®å­ç¬¦ - å°ç¨æ·ææä¾çåå®¹è¿è¡è¿æ»¤ï¼ä»èé¿å html å jascript ä»£ç çè¿è¡ãå¦ > è½¬ä¹ä¸º &gtã< è½¬ä¹ä¸º &lt ç­ï¼å°±å¯ä»¥é²æ­¢å¤§é¨åæ»å»ãä¸ºäºé¿åå¯¹ä¸å¿è¦çåå®¹éè¯¯è½¬ç§»ï¼å¦ 3<5 ä¸­ç < éè¦è¿è¡ææ¬å¹éååè½¬ç§»ï¼å¦ï¼<img src= è¿æ ·çä¸ä¸æä¸­ç < æè½¬ä¹ã\n * è®¾ç½® cookie ä¸º httponly - è®¾ç½®äº httponly ç cookie å¯ä»¥é²æ­¢ javascript èæ¬è°ç¨ï¼å°±æ æ³éè¿ document.cookie è·åç¨æ· cookie ä¿¡æ¯ã\n\n> ð åèéè¯»ï¼\n> \n>  * wiki è¯æ¡ - è·¨ç«èæ¬\n>  * web å®å¨æµè¯ä¹ xss\n\n\n# 4.2. csrf\n\n# 4.2.1. æ¦å¿µ\n\nè·¨ç«è¯·æ±ä¼ªé ï¼cross-site request forgeryï¼csrfï¼ï¼ä¹è¢«ç§°ä¸º one-click attack æè session ridingï¼éå¸¸ç¼©åä¸º csrf æè xsrfãå®æ¯ä¸ç§ææç¨æ·å¨å½åå·²ç»å½ç web åºç¨ç¨åºä¸æ§è¡éæ¬æçæä½çæ»å»æ¹æ³ãåè·¨ç«èæ¬ï¼xssï¼ç¸æ¯ï¼xss å©ç¨çæ¯ç¨æ·å¯¹æå®ç½ç«çä¿¡ä»»ï¼csrf å©ç¨çæ¯ç½ç«å¯¹ç¨æ·ç½é¡µæµè§å¨çä¿¡ä»»ã\n\n# 4.2.2. æ»å»ææ®µåç®ç\n\nå¯ä»¥å¦æ­¤çè§£ csrfï¼æ»å»èçç¨äºä½ çèº«ä»½ï¼ä»¥ä½ çåä¹åéæ¶æè¯·æ±ã\n\ncsrf è½åçäºå¤ªå¤ï¼\n\n * ä»¥ä½ åä¹åéé®ä»¶ï¼åæ¶æ¯\n * ç¨ä½ çè´¦å·è´­ä¹°åå\n * ç¨ä½ çåä¹å®æèæè´§å¸è½¬è´¦\n * æ³é²ä¸ªäººéç§\n * ...\n\n# 4.2.3. åºå¯¹ææ®µ\n\n * è¡¨å token - csrf æ¯ä¸ä¸ªä¼ªé ç¨æ·è¯·æ±çæä½ï¼æä»¥éè¦æé ç¨æ·è¯·æ±çææåæ°æå¯ä»¥ãè¡¨å token éè¿å¨è¯·æ±åæ°ä¸­æ·»å éæºæ°çåæ³æ¥é»æ­¢æ»å»èè·å¾ææè¯·æ±åæ°ã\n * éªè¯ç  - è¯·æ±æäº¤æ¶ï¼éè¦ç¨æ·è¾å¥éªè¯ç ï¼ä»¥é¿åç¨æ·å¨ä¸ç¥æçæåµä¸è¢«æ»å»èä¼ªé è¯·æ±ã\n * referer check - http è¯·æ±å¤´ç referer åä¸­è®°å½çè¯·æ±èµæºï¼å¯éè¿æ£æ¥è¯·æ±æ¥æºï¼éªè¯å¶æ¯å¦åæ³ã\n\n> ð åèéè¯»ï¼\n> \n>  * wiki è¯æ¡ - è·¨ç«è¯·æ±ä¼ªé \n>  * æµè° csrf æ»å»æ¹å¼\n>  * ãæ¯æ¥ä¸é¢ãcsrf æ¯ä»ä¹ï¼ãæ¯æ¥ä¸é¢ãcsrf æ¯ä»ä¹ï¼\n>  * web å®å¨ä¹-csrfï¼è·¨ç«è¯·æ±ä¼ªé ï¼\n\n\n# 4.3. sql æ³¨å¥\n\n# 4.3.1. æ¦å¿µ\n\nsql æ³¨å¥æ»å»ï¼sql injectionï¼ï¼æ¯åçäºåºç¨ç¨åºä¹æ°æ®å±çå®å¨æ¼æ´ãç®èè¨ä¹ï¼æ¯å¨è¾å¥çå­ç¬¦ä¸²ä¹ä¸­æ³¨å¥ sql æä»¤ï¼å¨è®¾è®¡ä¸è¯çç¨åºå½ä¸­å¿½ç¥äºæ£æ¥ï¼é£ä¹è¿äºæ³¨å¥è¿å»çæä»¤å°±ä¼è¢«æ°æ®åºæå¡å¨è¯¯è®¤ä¸ºæ¯æ­£å¸¸ç sql æä»¤èè¿è¡ï¼å æ­¤é­å°ç ´åææ¯å¥ä¾µã\n\næ»å»ç¤ºä¾ï¼\n\nèèä»¥ä¸ç®åçç»å½è¡¨åï¼\n\n<form action="/login" method="post">\n  <p>username: <input type="text" name="username" /></p>\n  <p>password: <input type="password" name="password" /></p>\n  <p><input type="submit" value="ç»é" /></p>\n</form>\n\n\næä»¬çå¤çéé¢ç sql å¯è½æ¯è¿æ ·çï¼\n\nusername:=r.form.get("username")\npassword:=r.form.get("password")\nsql:="select * from user where username=\'"+username+"\' and password=\'"+password+"\'"\n\n\nå¦æç¨æ·çè¾å¥çç¨æ·åå¦ä¸ï¼å¯ç ä»»æ\n\nmyuser\' or \'foo\' = \'foo\' --\n\n\né£ä¹æä»¬ç sql åæäºå¦ä¸æç¤ºï¼\n\nselect * from user where username=\'myuser\' or \'foo\' = \'foo\' --\'\' and password=\'xxx\'\n\n\nå¨ sql éé¢ -- æ¯æ³¨éæ è®°ï¼æä»¥æ¥è¯¢è¯­å¥ä¼å¨æ­¤ä¸­æ­ãè¿å°±è®©æ»å»èå¨ä¸ç¥éä»»ä½åæ³ç¨æ·ååå¯ç çæåµä¸æåç»å½äºã\n\nå¯¹äº mssql è¿ææ´å å±é©çä¸ç§ sql æ³¨å¥ï¼å°±æ¯æ§å¶ç³»ç»ï¼ä¸é¢è¿ä¸ªå¯æçä¾å­å°æ¼ç¤ºå¦ä½å¨æäºçæ¬ç mssql æ°æ®åºä¸æ§è¡ç³»ç»å½ä»¤ã\n\nsql:="select * from products where name like \'%"+prod+"%\'"\ndb.exec(sql)\n\n\nå¦ææ»å»æäº¤ a%\' exec master..xp_cmdshell \'net user test testpass /add\' -- ä½ä¸ºåé prod çå¼ï¼é£ä¹ sql å°ä¼åæ\n\nsql:="select * from products where name like \'%a%\' exec master..xp_cmdshell \'net user test testpass /add\'--%\'"\n\n\nmssql æå¡å¨ä¼æ§è¡è¿æ¡ sql è¯­å¥ï¼åæ¬å®åé¢é£ä¸ªç¨äºåç³»ç»æ·»å æ°ç¨æ·çå½ä»¤ãå¦æè¿ä¸ªç¨åºæ¯ä»¥ sa è¿è¡è mssqlserver æå¡åæè¶³å¤çæéçè¯ï¼æ»å»èå°±å¯ä»¥è·å¾ä¸ä¸ªç³»ç»å¸å·æ¥è®¿é®ä¸»æºäºã\n\nè½ç¶ä»¥ä¸çä¾å­æ¯éå¯¹æä¸ç¹å®çæ°æ®åºç³»ç»çï¼ä½æ¯è¿å¹¶ä¸ä»£è¡¨ä¸è½å¯¹å¶å®æ°æ®åºç³»ç»å®æ½ç±»ä¼¼çæ»å»ãéå¯¹è¿ç§å®å¨æ¼æ´ï¼åªè¦ä½¿ç¨ä¸åæ¹æ³ï¼åç§æ°æ®åºé½æå¯è½é­æ®ã\n\n# 4.3.2. æ»å»ææ®µåç®ç\n\n * æ°æ®è¡¨ä¸­çæ°æ®å¤æ³ï¼ä¾å¦ä¸ªäººæºå¯æ°æ®ï¼è´¦æ·æ°æ®ï¼å¯ç ç­ã\n * æ°æ®ç»æè¢«é»å®¢æ¢ç¥ï¼å¾ä»¥åè¿ä¸æ­¥æ»å»ï¼ä¾å¦ select * from sys.tablesï¼ã\n * æ°æ®åºæå¡å¨è¢«æ»å»ï¼ç³»ç»ç®¡çåè´¦æ·è¢«çªæ¹ï¼ä¾å¦ alter login sa with password=\'xxxxxx\'ï¼ã\n * è·åç³»ç»è¾é«æéåï¼æå¯è½å¾ä»¥å¨ç½é¡µå å¥æ¶æé¾æ¥ãæ¶æä»£ç ä»¥å xss ç­ã\n * ç»ç±æ°æ®åºæå¡å¨æä¾çæä½ç³»ç»æ¯æï¼è®©é»å®¢å¾ä»¥ä¿®æ¹ææ§å¶æä½ç³»ç»ï¼ä¾å¦ xp_cmdshell "net stop iisadmin"å¯åæ­¢æå¡å¨ç iis æå¡ï¼ã\n * ç ´åç¡¬çæ°æ®ï¼ç«çªå¨ç³»ç»ï¼ä¾å¦ xp_cmdshell "format c:"ï¼ã\n\n# 4.3.3. åºå¯¹ææ®µ\n\n * ä½¿ç¨åæ°åæ¥è¯¢ - å»ºè®®ä½¿ç¨æ°æ®åºæä¾çåæ°åæ¥è¯¢æ¥å£ï¼åæ°åçè¯­å¥ä½¿ç¨åæ°èä¸æ¯å°ç¨æ·è¾å¥åéåµå¥å° sql è¯­å¥ä¸­ï¼å³ä¸è¦ç´æ¥æ¼æ¥ sql è¯­å¥ãä¾å¦ä½¿ç¨ database/sql éé¢çæ¥è¯¢å½æ° prepare å query ï¼æè exec(query string, args ...interface{})ã\n * åå¼å·è½¬æ¢ - å¨ç»å sql å­ç¬¦ä¸²æ¶ï¼åéå¯¹æä¼ å¥çåæ°è¿è¡å­ç¬¦æ¿æ¢ï¼å°åå¼å·å­ç¬¦æ¿æ¢ä¸ºè¿ç»­ 2 ä¸ªåå¼å·å­ç¬¦ï¼ã\n\n> ð åèéè¯»ï¼\n> \n>  * wiki è¯æ¡ - sql æ³¨å¥æ»å»\n>  * é¿å sql æ³¨å¥\n>  * å®ä¾è®²è§£ sql æ³¨å¥æ»å»\n\n\n# 4.4. dos\n\næç»æå¡æ»å»ï¼denial-of-service attack, dosï¼äº¦ç§°æ´ªæ°´æ»å»ï¼æ¯ä¸ç§ç½ç»æ»å»ææ³ï¼å¶ç®çå¨äºä½¿ç®æ çµèçç½ç»æç³»ç»èµæºèå°½ï¼ä½¿æå¡ææ¶ä¸­æ­æåæ­¢ï¼å¯¼è´å¶æ­£å¸¸ç¨æ·æ æ³è®¿é®ã\n\nå½é»å®¢ä½¿ç¨ç½ç»ä¸ä¸¤ä¸ªæä»¥ä¸è¢«æ»é·ççµèä½ä¸ºâåµå°¸âåç¹å®çç®æ åå¨âæç»æå¡âå¼æ»å»æ¶ï¼ç§°ä¸ºåå¸å¼æç»æå¡æ»å»ï¼distributed denial-of-service attackï¼ç¼©åï¼ddos attackãddosï¼ã\n\n# 4.4.1. æ»å»æ¹å¼\n\n * å¸¦å®½æ¶èåæ»å»\n * èµæºæ¶èåæ»å»\n\n# 4.4.2. åºå¯¹ææ®µ\n\n * é²ç«å¢ - åè®¸ææç»ç¹å®éè®¯åè®®ï¼ç«¯å£æ ip å°åãå½æ»å»ä»å°æ°ä¸æ­£å¸¸ç ip å°åååºæ¶ï¼å¯ä»¥ç®åçä½¿ç¨æç»è§åé»æ­¢ä¸åä»æ»å»æº ip ååºçéä¿¡ã\n * è·¯ç±å¨ãäº¤æ¢æº - å·æéåº¦éå¶åè®¿é®æ§å¶è½åã\n * æµéæ¸æ´ - éè¿éç¨æ dos è½¯ä»¶å¤çï¼å°æ­£å¸¸æµéåæ¶ææµéåºåå¼ã\n\n> ð åèéè¯»ï¼\n> \n>  * æç»æå¡æ»å»\n\n\n# 5. å å¯ææ¯\n\nå¯¹äºç½ç«æ¥è¯´ï¼ç¨æ·ä¿¡æ¯ãè´¦æ·ç­ç­æææ°æ®ä¸æ¦æ³æ¼ï¼åæä¸¥éï¼æä»¥ä¸ºäºä¿æ¤æ°æ®ï¼åºå¯¹è¿äºä¿¡æ¯è¿è¡å å¯å¤çã\n\nä¿¡æ¯å å¯ææ¯ä¸è¬åä¸ºï¼\n\n * æ¶æ¯æè¦\n * å å¯ç®æ³\n   * å¯¹ç§°å å¯\n   * éå¯¹ç§°å å¯\n * è¯ä¹¦\n\n\n# 5.1. æ¶æ¯æè¦\n\nå¸¸ç¨æ°å­ç­¾åç®æ³ï¼md5ãsha ç­ã\n\nåºç¨åºæ¯ï¼å°ç¨æ·å¯ç ä»¥æ¶æ¯æè¦å½¢å¼ä¿å­å°æ°æ®åºä¸­ã\n\n> ð åèéè¯»ï¼ java ç¼ç åå å¯\n\n\n# 5.2. å å¯ç®æ³\n\n# 5.2.1. å¯¹ç§°å å¯\n\nå¯¹ç§°å å¯æå å¯åè§£å¯æä½¿ç¨çå¯é¥æ¯åä¸ä¸ªå¯é¥ã\n\nå¸¸ç¨å¯¹ç§°å å¯ç®æ³ï¼desãaes ç­ã\n\nåºç¨åºæ¯ï¼cookie å å¯ãéä¿¡æºå¯ç­ã\n\n# 5.2.2. éå¯¹ç§°å å¯\n\néå¯¹ç§°å å¯æå å¯åè§£å¯æä½¿ç¨çä¸æ¯åä¸ä¸ªå¯é¥ï¼èæ¯ä¸ä¸ªå¬ç§é¥å¯¹ãç¨å¬é¥å å¯çä¿¡æ¯å¿é¡»ç¨ç§é¥æè½è§£å¼ï¼åä¹ï¼ç¨ç§é¥å å¯çä¿¡æ¯åªæç¨å¬é¥æè½è§£å¼ã\n\nå¸¸ç¨éå¯¹ç§°å å¯ç®æ³ï¼rsa ç­ã\n\nåºç¨åºæ¯ï¼https ä¼ è¾ä¸­æµè§å¨ä½¿ç¨çæ°å­è¯ä¹¦å®è´¨ä¸æ¯ç»è¿æå¨æºæè®¤è¯çéå¯¹ç§°å å¯å¬é¥ã\n\n> ð åèéè¯»ï¼ java ç¼ç åå å¯\n\n# 5.2.3. å¯é¥å®å¨ç®¡ç\n\nä¿è¯å¯é¥å®å¨çæ¹æ³ï¼\n\n 1. æå¯é¥åç®æ³æ¾å¨ä¸ä¸ªç¬ç«çæå¡å¨ä¸ï¼å¯¹å¤æä¾å å¯åè§£å¯æå¡ï¼åºç¨ç³»ç»éè¿è°ç¨è¿ä¸ªæå¡ï¼å®ç°æ°æ®çå è§£å¯ã\n 2. æå è§£å¯ç®æ³æ¾å¨åºç¨ç³»ç»ä¸­ï¼å¯é¥åæ¾å¨ç¬ç«æå¡å¨ä¸­ï¼ä¸ºäºæé«å¯é¥çå®å¨æ§ï¼å®éå­å¨æ¶ï¼å¯é¥è¢«ååææ°çï¼å å¯ååå«ä¿å­å¨ä¸åå­å¨ä»è´¨ä¸­ã\n\n\n# 5.3. è¯ä¹¦\n\nè¯ä¹¦å¯ä»¥ç§°ä¸ºä¿¡æ¯å®å¨å å¯çç»æææ®µãå¬å¼å¯é¥è®¤è¯ï¼è±è¯­ï¼public key certificateï¼ï¼åç§°å¬å¼å¯é¥è¯ä¹¦ãå¬é¥è¯ä¹¦ãæ°å­è¯ä¹¦ï¼digital certificateï¼ãæ°å­è®¤è¯ãèº«ä»½è¯ä¹¦ï¼identity certificateï¼ãçµå­è¯ä¹¦æå®å¨è¯ä¹¦ï¼æ¯ç¨äºå¬å¼å¯é¥åºç¡å»ºè®¾ççµå­æä»¶ï¼ç¨æ¥è¯æå¬å¼å¯é¥æ¥æèçèº«ä»½ãæ­¤æä»¶åå«äºå¬é¥ä¿¡æ¯ãæ¥æèèº«ä»½ä¿¡æ¯ï¼ä¸»ä½ï¼ãä»¥åæ°å­è¯ä¹¦è®¤è¯æºæï¼åè¡èï¼å¯¹è¿ä»½æä»¶çæ°å­ç­¾åï¼ä»¥ä¿è¯è¿ä¸ªæä»¶çæ´ä½åå®¹æ­£ç¡®æ è¯¯ã\n\néè¿ä¿¡ä»»æå¨æ°å­è¯ä¹¦è®¤è¯æºæçæ ¹è¯ä¹¦ãåå¶ä½¿ç¨å¬å¼å¯é¥å å¯ä½æ°å­ç­¾åæ ¸åçå¬å¼å¯é¥è®¤è¯ï¼å½¢æä¿¡ä»»é¾æ¶æï¼å·²å¨ tls å®ç°å¹¶å¨ä¸ç»´ç½ç http ä»¥ httpsãå¨çµå­é®ä»¶ç smtp ä»¥ starttls å¼å¥å¹¶å¹¿æ³åºç¨ã\n\nä¼æå¨ç¥ï¼å¸¸è§çåºç¨å±åè®® httpãftpãtelnet æ¬èº«ä¸ä¿è¯ä¿¡æ¯å®å¨ãä½æ¯å å¥äº ssl/tls å å¯æ°æ®åæºå¶ç httpsãftpsãtelnets æ¯ä¿¡æ¯å®å¨çãä¼ è¾å±å®å¨æ§åè®®ï¼transport layer security, tlsï¼ï¼åå¶åèº«å®å¨å¥æ¥å±ï¼secure sockets layer, sslï¼æ¯ä¸ç§å®å¨åè®®ï¼ç®çæ¯ä¸ºäºèç½éä¿¡ï¼æä¾å®å¨åæ°æ®å®æ´æ§ä¿éã\n\n# 5.3.1. è¯ä¹¦åç\n\nssl/tls åè®®çåºæ¬æè·¯æ¯éç¨å¬é¥å å¯æ³ï¼ä¹å°±æ¯è¯´ï¼å®¢æ·ç«¯ååæå¡å¨ç«¯ç´¢è¦å¬é¥ï¼ç¶åç¨å¬é¥å å¯ä¿¡æ¯ï¼æå¡å¨æ¶å°å¯æåï¼ç¨èªå·±çç§é¥è§£å¯ã\n\nè¿éæä¸¤ä¸ªé®é¢ï¼\n\nï¼1ï¼å¦ä½ä¿è¯å¬é¥ä¸è¢«ç¯¡æ¹ï¼\n\nè§£å³æ¹æ³ï¼å°å¬é¥æ¾å¨æ°å­è¯ä¹¦ä¸­ãåªè¦è¯ä¹¦æ¯å¯ä¿¡çï¼å¬é¥å°±æ¯å¯ä¿¡çã\n\nï¼2ï¼å¬é¥å å¯è®¡ç®éå¤ªå¤§ï¼å¦ä½åå°èç¨çæ¶é´ï¼\n\nè§£å³æ¹æ³ï¼æ¯ä¸æ¬¡å¯¹è¯ï¼sessionï¼ï¼å®¢æ·ç«¯åæå¡å¨ç«¯é½çæä¸ä¸ª"å¯¹è¯å¯é¥"ï¼session keyï¼ï¼ç¨å®æ¥å å¯ä¿¡æ¯ãç±äº"å¯¹è¯å¯é¥"æ¯å¯¹ç§°å å¯ï¼æä»¥è¿ç®éåº¦éå¸¸å¿«ï¼èæå¡å¨å¬é¥åªç¨äºå å¯"å¯¹è¯å¯é¥"æ¬èº«ï¼è¿æ ·å°±åå°äºå å¯è¿ç®çæ¶èæ¶é´ã\n\nssl/tls åè®®çåºæ¬è¿ç¨æ¯è¿æ ·çï¼\n\n 1. å®¢æ·ç«¯åæå¡å¨ç«¯ç´¢è¦å¹¶éªè¯å¬é¥ã\n 2. åæ¹ååçæ"å¯¹è¯å¯é¥"ã\n 3. åæ¹éç¨"å¯¹è¯å¯é¥"è¿è¡å å¯éä¿¡ã\n\n> ð åèéè¯»ï¼\n> \n>  * ä¼ è¾å±å®å¨æ§åè®®\n>  * å¬å¼å¯é¥è®¤è¯\n>  * ssl/tls åè®®è¿è¡æºå¶çæ¦è¿°\n\n\n# 6. ä¿¡æ¯è¿æ»¤\n\nå¨ç½ç»ä¸­ï¼å¹¿åååå¾ä¿¡æ¯å±¡è§ä¸é²ï¼æ³æ»¥æç¾ã\n\nå¸¸è§çä¿¡æ¯è¿æ»¤ä¸ååå¾ææ®µæï¼\n\n\n# 6.1. ææ¬å¹é\n\nè§£å³ææè¯è¿æ»¤ãç³»ç»ç»´æ¤ä¸ä»½ææè¯æ¸åï¼å¦æä¿¡æ¯ä¸­å«æææè¯ï¼åèªå¨è¿è¡è¿æ»¤ææç»ä¿¡æ¯ã\n\n\n# 6.2. é»åå\n\né»ååå°±æ¯å°ä¸äºå·²ç»è¢«è¯å«åºæè¿è§è¡ä¸ºç ipãååãé®ç®±ç­å å¥é»ååï¼æç»å¶è¯·æ±ã\n\né»ååå¯ä»¥éè¿ hash è¡¨æ¥å®ç°ï¼æ¹æ³ç®åï¼å¤æåº¦å°ï¼éäºä¸è¬åºç¨åºæ¯ã\n\nä½å¦æé»åååè¡¨éå¸¸å¤§æ¶ï¼hash è¡¨è¦å ç¨å¾å¤§çåå­ç©ºé´ï¼è¿æ¶å°±ä¸åä½¿ç¨äºãè¿ç§æåµä¸ï¼å¯ä»¥ä½¿ç¨å¸éè¿æ»¤å¨æ¥å®ç°ï¼å³éè¿ä¸ä¸ªäºè¿å¶åè¡¨åä¸ç»éæºæ°æ å°å½æ°æ¥å®ç°ã\n\n\n# 6.3. åç±»ç®æ³\n\nå¯¹äºæµ·éä¿¡æ¯ï¼é¾ä»¥éè¿äººå·¥å»å®¡æ ¸ãå¯¹å¹¿åè´´ã\n\nåå¾é®ä»¶ç­åå®¹çè¯å«æ¯è¾å¥½çèªå¨åæ¹æ³å°±æ¯éç¨åç±»ç®æ³ã\n\nç®åæ¥è¯´ï¼å³å°æ¹éå·²åç±»çæ ·æ¬è¾å¥åç±»ç®æ³è¿è¡è®­ç»ï¼å¾å°ä¸ä¸ªåç±»æ¨¡åï¼ç¶åå©ç¨åç±»ç®æ³ç»ååç±»æ¨¡åå»å¯¹ä¿¡æ¯è¿è¡è¯å«ãæ³äºè§£å·ä½åæ³ï¼éè¦å»çè§£æºå¨å­¦ä¹ ç¸å³ç¥è¯ã\n\n\n# 7. é£é©æ§å¶\n\nç½ç»ç»åå¡ãéèé¢åå¸¦æ¥æå¤§ä¾¿å©çåæ¶ï¼ä¹å°é£é©å¸¦ç»äºå¯¹ç½ç»å®å¨ä¸æ æç¥çäººä»¬ãç±äºäº¤æåæ¹ä¿¡æ¯çä¸å¯¹ç­ï¼ä½¿å¾äº¤æå­å¨çé£é©ï¼èå½äº¤æåçå¨ç½ç»ä¸æ¶ï¼é£é©å°±æ´å é¾ä»¥æ§å¶äºã\n\n\n# 7.1. é£é©ç§ç±»\n\n * è´¦æ·é£é© - çç¨è´¦æ·ãæ¶ææ³¨åè´¦æ·ç­\n * ä¹°å®¶é£é© - èåè¯¢çãæ¶æææ¶ãæ¶æä¸åãé»çåæ¢è´­ç­é¨ååç­\n * åå®¶é£é© - èååè´§ãåºå®è¿ç¦åãä¾µæç­\n * äº¤æé£é© - ä¿¡ç¨å¡çå·ãäº¤ææ¬ºè¯ãæ´é±ãå¥ç°ãçµä¿¡è¯éªç­\n\n\n# 7.2. é£é©æ§å¶ææ®µ\n\nå¤§åçµåç½ç«ç³»ç»æéèç³»ç»é½éå¤ä¸ä¸çé£æ§å¢éè¿è¡é£é©æ§å¶ãé£é©æ§å¶ææ®µæ¢åæ¬äººå·¥å®¡æ ¸ä¹åæ¬èªå¨å®¡æ ¸ã\n\nèªå¨é£æ§çææ¯ææ®µä¸»è¦æè§åå¼æåç»è®¡æ¨¡åã\n\n\n# 7.3. è§åå¼æ\n\nå¨äº¤æä¸­ï¼ä¹°å®¶ãåå®¶çæäºææ æ»¡è¶³ä¸å®æ¡ä»¶æ¶ï¼å°±ä¼è¢«è®¤ä¸ºå­å¨é£é©ãå¦ï¼äº¤æéé¢è¶è¿æä¸ªæ°å¼ï¼ç¨æ·æ¥èªé»ååï¼ç¨æ·åä¸æ¬¡ç»å½çå°åè·ç¦»å·®è·å¾å¤§ï¼ç¨æ·å¨ä¸å®æ¶é´åé¢ç¹äº¤æç­ç­ã\n\nå¦æä»¥ä¸è¿äºæ¡ä»¶é½éè¿ if ... else ... å¼æ ·çä»£ç å»å®ç°ï¼ä»£ç ç»´æ¤ãæ©å±ä¼éå¸¸ä¸ä¾¿ãå æ­¤ï¼å°±æäºè§åå¼ææ¥å¤çè¿ç±»é®é¢ãè§åå¼ææ¯ä¸ç§å°ä¸å¡è§ååè§åå¤çé»è¾ç¸åç¦»çææ¯ï¼ä¸å¡è§åç±è¿è¥äººåéè¿ç®¡ççé¢å»ç¼è¾ï¼å®ç°æ éä¿®æ¹ä»£ç ï¼å³å¯å®æ¶çä½¿ç¨æ°è§åã\n\n\n# 7.4. ç»è®¡æ¨¡å\n\nè§åå¼æè½ç¶ææ¯ç®åï¼ä½æ¯éçè§åä¸æ­å¢å ï¼è§æ¨¡è¶æ¥è¶å¤§ãå¯è½ä¼åºç°è§åå²çªï¼é¾ä»¥ç»´æ¤çæåµï¼å¹¶ä¸è§åè¶å¤ï¼æ§è½ä¹è¶å·®ã\n\nä¸ºäºè§£å³è¿ç§é®é¢ï¼å°±æäºç»è®¡æ¨¡åãç»è®¡æ¨¡åä¼ä½¿ç¨åç±»ç®æ³ææ´å¤æçæºå¨å­¦ä¹ ç®æ³è¿è¡æºè½ç»è®¡ãæ ¹æ®åå²äº¤æä¸­çä¿¡æ¯è®­ç»åç±»ï¼ç¶åå°ç»è¿ééå å·¥åçäº¤æä¿¡æ¯è¾å¥åç±»ç®æ³ï¼å¾å°äº¤æé£é©å¼ï¼ç¶ååºäºæ­¤ï¼ååºé¢æµã\n\nç»è¿ååè®­ç»åçç»è®¡æ¨¡åï¼åç¡®çä¸ä½äºè§åå¼æãä½æ¯ï¼éè¦æé¢åä¸å®¶ãè¡ä¸ä¸å®¶ä»å¥ï¼å»ºç«åççè®­ç»æ¨¡åï¼å¹¶ä¸æ­ä¼åã\n\n\n# 8. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * wiki è¯æ¡ - è·¨ç«èæ¬\n * web å®å¨æµè¯ä¹ xss\n * wiki è¯æ¡ - è·¨ç«è¯·æ±ä¼ªé \n * æµè° csrf æ»å»æ¹å¼\n * ãæ¯æ¥ä¸é¢ãcsrf æ¯ä»ä¹ï¼ãæ¯æ¥ä¸é¢ãcsrf æ¯ä»ä¹ï¼\n * web å®å¨ä¹-csrfï¼è·¨ç«è¯·æ±ä¼ªé ï¼\n * wiki è¯æ¡ - sql æ³¨å¥æ»å»\n * é¿å sql æ³¨å¥\n * å®ä¾è®²è§£ sql æ³¨å¥æ»å»\n * æç»æå¡æ»å»\n * ä¼ è¾å±å®å¨æ§åè®®\n * å¬å¼å¯é¥è®¤è¯\n * ssl/tls åè®®è¿è¡æºå¶çæ¦è¿°\n * http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\n * cas å®ç° sso åç¹ç»å½åç\n * æéç³»ç»è®¾è®¡æ¨¡ååæï¼dacï¼macï¼rbacï¼abacï¼\n * rbac æ¨¡åï¼åºäºç¨æ·-è§è²-æéæ§å¶çä¸äºæè',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å¤§åç³»ç»æ ¸å¿ææ¯",frontmatter:{title:"å¤§åç³»ç»æ ¸å¿ææ¯",date:"2018-07-09T00:00:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","åå¸å¼"],permalink:"/pages/eb0425/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/08.%E5%A4%A7%E5%9E%8B%E7%B3%BB%E7%BB%9F%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF.html",relativePath:"01.æ¶æ/08.å¤§åç³»ç»æ ¸å¿ææ¯.md",key:"v-190803ce",path:"/pages/eb0425/",headers:[{level:2,title:"1. åå¸å¼äºå¡",slug:"_1-åå¸å¼äºå¡",normalizedTitle:"1. åå¸å¼äºå¡",charIndex:269},{level:2,title:"2. åå¸å¼é",slug:"_2-åå¸å¼é",normalizedTitle:"2. åå¸å¼é",charIndex:304},{level:3,title:"2.1. åºäºæ°æ®åºå®ç°åå¸å¼é",slug:"_2-1-åºäºæ°æ®åºå®ç°åå¸å¼é",normalizedTitle:"2.1. åºäºæ°æ®åºå®ç°åå¸å¼é",charIndex:450},{level:4,title:"å®ç°",slug:"å®ç°",normalizedTitle:"å®ç°",charIndex:395},{level:5,title:"1. åå»ºè¡¨",slug:"_1-åå»ºè¡¨",normalizedTitle:"1. åå»ºè¡¨",charIndex:476},{level:5,title:"2. è·åé",slug:"_2-è·åé",normalizedTitle:"2. è·åé",charIndex:933},{level:5,title:"3. éæ¾é",slug:"_3-éæ¾é",normalizedTitle:"3. éæ¾é",charIndex:1150},{level:4,title:"é®é¢",slug:"é®é¢",normalizedTitle:"é®é¢",charIndex:139},{level:4,title:"è§£å³åæ³",slug:"è§£å³åæ³",normalizedTitle:"è§£å³åæ³",charIndex:1487},{level:4,title:"å°ç»",slug:"å°ç»",normalizedTitle:"å°ç»",charIndex:1694},{level:3,title:"2.2. åºäº Redis å®ç°åå¸å¼é",slug:"_2-2-åºäº-redis-å®ç°åå¸å¼é",normalizedTitle:"2.2. åºäº redis å®ç°åå¸å¼é",charIndex:1786},{level:4,title:"Redis å½ä»¤",slug:"redis-å½ä»¤",normalizedTitle:"redis å½ä»¤",charIndex:1899},{level:4,title:"å®ç°",slug:"å®ç°-2",normalizedTitle:"å®ç°",charIndex:395},{level:4,title:"é®é¢",slug:"é®é¢-2",normalizedTitle:"é®é¢",charIndex:139},{level:4,title:"å°ç»",slug:"å°ç»-2",normalizedTitle:"å°ç»",charIndex:1694},{level:3,title:"2.3. åºäº ZooKeeper å®ç°åå¸å¼é",slug:"_2-3-åºäº-zookeeper-å®ç°åå¸å¼é",normalizedTitle:"2.3. åºäº zookeeper å®ç°åå¸å¼é",charIndex:2391},{level:4,title:"å®ç°",slug:"å®ç°-3",normalizedTitle:"å®ç°",charIndex:395},{level:4,title:"å°ç»",slug:"å°ç»-3",normalizedTitle:"å°ç»",charIndex:1694},{level:2,title:"3. åå¸å¼ Session",slug:"_3-åå¸å¼-session",normalizedTitle:"3. åå¸å¼ session",charIndex:3158},{level:3,title:"3.1. Sticky Sessions",slug:"_3-1-sticky-sessions",normalizedTitle:"3.1. sticky sessions",charIndex:3373},{level:3,title:"3.2. Session Replication",slug:"_3-2-session-replication",normalizedTitle:"3.2. session replication",charIndex:3502},{level:3,title:"3.3. Session Server",slug:"_3-3-session-server",normalizedTitle:"3.3. session server",charIndex:3612},{level:2,title:"4. åå¸å¼å­å¨",slug:"_4-åå¸å¼å­å¨",normalizedTitle:"4. åå¸å¼å­å¨",charIndex:3739},{level:2,title:"5. åå¸å¼ç¼å­",slug:"_5-åå¸å¼ç¼å­",normalizedTitle:"5. åå¸å¼ç¼å­",charIndex:3853},{level:2,title:"6. åå¸å¼è®¡ç®",slug:"_6-åå¸å¼è®¡ç®",normalizedTitle:"6. åå¸å¼è®¡ç®",charIndex:4194},{level:2,title:"7. è´è½½åè¡¡",slug:"_7-è´è½½åè¡¡",normalizedTitle:"7. è´è½½åè¡¡",charIndex:4207},{level:3,title:"7.1. ç®æ³",slug:"_7-1-ç®æ³",normalizedTitle:"7.1. ç®æ³",charIndex:4219},{level:4,title:"è½®è¯¢ï¼Round Robinï¼",slug:"è½®è¯¢-round-robin",normalizedTitle:"è½®è¯¢ï¼round robinï¼",charIndex:4230},{level:4,title:"å æè½®è¯¢ï¼Weighted Round Robbinï¼",slug:"å æè½®è¯¢-weighted-round-robbin",normalizedTitle:"å æè½®è¯¢ï¼weighted round robbinï¼",charIndex:4459},{level:4,title:"æå°è¿æ¥ï¼least Connectionsï¼",slug:"æå°è¿æ¥-least-connections",normalizedTitle:"æå°è¿æ¥ï¼least connectionsï¼",charIndex:4617},{level:4,title:"å ææå°è¿æ¥ï¼Weighted Least Connectionï¼",slug:"å ææå°è¿æ¥-weighted-least-connection",normalizedTitle:"å ææå°è¿æ¥ï¼weighted least connectionï¼",charIndex:4917},{level:4,title:"éæºç®æ³ï¼Randomï¼",slug:"éæºç®æ³-random",normalizedTitle:"éæºç®æ³ï¼randomï¼",charIndex:5008},{level:4,title:"æºå°ååå¸æ³ (IP Hash)",slug:"æºå°ååå¸æ³-ip-hash",normalizedTitle:"æºå°ååå¸æ³ (ip hash)",charIndex:5068},{level:3,title:"7.2. å®ç°",slug:"_7-2-å®ç°",normalizedTitle:"7.2. å®ç°",charIndex:5243},{level:4,title:"HTTP éå®å",slug:"http-éå®å",normalizedTitle:"http éå®å",charIndex:5254},{level:4,title:"DNS éå®å",slug:"dns-éå®å",normalizedTitle:"dns éå®å",charIndex:5392},{level:4,title:"ä¿®æ¹ MAC å°å",slug:"ä¿®æ¹-mac-å°å",normalizedTitle:"ä¿®æ¹ mac å°å",charIndex:5540},{level:4,title:"ä¿®æ¹ IP å°å",slug:"ä¿®æ¹-ip-å°å",normalizedTitle:"ä¿®æ¹ ip å°å",charIndex:5615},{level:4,title:"ä»£çèªå¨éç½®",slug:"ä»£çèªå¨éç½®",normalizedTitle:"ä»£çèªå¨éç½®",charIndex:5649},{level:2,title:"8. èµæ",slug:"_8-èµæ",normalizedTitle:"8. èµæ",charIndex:5803}],headersStr:"1. åå¸å¼äºå¡ 2. åå¸å¼é 2.1. åºäºæ°æ®åºå®ç°åå¸å¼é å®ç° 1. åå»ºè¡¨ 2. è·åé 3. éæ¾é é®é¢ è§£å³åæ³ å°ç» 2.2. åºäº Redis å®ç°åå¸å¼é Redis å½ä»¤ å®ç° é®é¢ å°ç» 2.3. åºäº ZooKeeper å®ç°åå¸å¼é å®ç° å°ç» 3. åå¸å¼ Session 3.1. Sticky Sessions 3.2. Session Replication 3.3. Session Server 4. åå¸å¼å­å¨ 5. åå¸å¼ç¼å­ 6. åå¸å¼è®¡ç® 7. è´è½½åè¡¡ 7.1. ç®æ³ è½®è¯¢ï¼Round Robinï¼ å æè½®è¯¢ï¼Weighted Round Robbinï¼ æå°è¿æ¥ï¼least Connectionsï¼ å ææå°è¿æ¥ï¼Weighted Least Connectionï¼ éæºç®æ³ï¼Randomï¼ æºå°ååå¸æ³ (IP Hash) 7.2. å®ç° HTTP éå®å DNS éå®å ä¿®æ¹ MAC å°å ä¿®æ¹ IP å°å ä»£çèªå¨éç½® 8. èµæ",content:"# å¤§åç³»ç»æ ¸å¿ææ¯\n\n> å¤§åç³»ç»çè®¾è®¡ç®æ å°±æ¯ä¸ºäºå¿«éãé«æãç¨³å®çå¤çæµ·éçæ°æ®ä»¥åé«å¹¶åçè¯·æ±ã\n> \n> åæºæå¡åéäºç¡¬ä»¶ï¼å®¢è§å­å¨çèµæºç¶é¢ï¼é¾ä»¥åºå¯¹ä¸æ­å¢é¿çæ°æ®éåè¯·æ±éï¼ä¸ºäºæç ´ç¶é¢ï¼å¤§åç³»ç»åºæ¬ä¸é½è¢«è®¾è®¡ä¸ºåå¸å¼ç³»ç»ã\n> \n> åå¸å¼ç³»ç»ç±äºå¶é¢ä¸´çå±æ§é®é¢ï¼å¨å¾å¤åºæ¯ä¸çè§£å³æ¹æ¡å¾å¾ä¹å­å¨çå±æ§ãå æ­¤ï¼æä»¬ä¼åç°ï¼å¾å¤ä¼ç§çå¤§åç³»ç»å¨è®¾è®¡æ¹æ¡ä¸å­å¨çå¾å¤çå±åç¹ã\n> \n> æ¬æä¸»è¦è®¨è®ºåºå¯¹åå¸å¼ç³»ç»å±æ§é®é¢çè§£å³æ¹æ¡ï¼è¿æ¢å¯ä»¥å æ·±å¯¹åå¸å¼ç³»ç»è¿ä½åçççè§£ï¼ä¹å¯ä»¥ä½ä¸ºè®¾è®¡å¤§ååå¸å¼ç³»ç»æ¶çåé´ã\n\n\n# 1. åå¸å¼äºå¡\n\n> åèï¼åå¸å¼åç#4-åå¸å¼äºå¡é®é¢\n\n\n# 2. åå¸å¼é\n\nJava åç API è½ç¶æå¹¶åéï¼ä½å¹¶æ²¡ææä¾åå¸å¼éçè½åï¼æä»¥éå¯¹åå¸å¼åºæ¯ä¸­çééè¦è§£å³çæ¹æ¡ã\n\nåå¸å¼éçè§£å³æ¹æ¡å¤§è´æä»¥ä¸å ç§ï¼\n\n * åºäºæ°æ®åºå®ç°\n * åºäºç¼å­ï¼redisï¼memcached ç­ï¼å®ç°\n * åºäº Zookeeper å®ç°\n\n\n# 2.1. åºäºæ°æ®åºå®ç°åå¸å¼é\n\n# å®ç°\n\n# 1. åå»ºè¡¨\n\nCREATE TABLE `methodLock` (\n  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é®',\n  `method_name` varchar(64) NOT NULL DEFAULT '' COMMENT 'éå®çæ¹æ³å',\n  `desc` varchar(1024) NOT NULL DEFAULT 'å¤æ³¨ä¿¡æ¯',\n  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'ä¿å­æ°æ®æ¶é´ï¼èªå¨çæ',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uidx_method_name` (`method_name `) USING BTREE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='éå®ä¸­çæ¹æ³';\n\n\n# 2. è·åé\n\næ³è¦éä½æä¸ªæ¹æ³æ¶ï¼æ§è¡ä»¥ä¸ SQLï¼\n\ninsert into methodLock(method_name,desc) values (âmethod_nameâ,âdescâ)\n\n\nå ä¸ºæä»¬å¯¹ method_name åäºå¯ä¸æ§çº¦æï¼è¿éå¦ææå¤ä¸ªè¯·æ±åæ¶æäº¤å°æ°æ®åºçè¯ï¼æ°æ®åºä¼ä¿è¯åªæä¸ä¸ªæä½å¯ä»¥æåï¼é£ä¹æä»¬å°±å¯ä»¥è®¤ä¸ºæä½æåçé£ä¸ªçº¿ç¨è·å¾äºè¯¥æ¹æ³çéï¼å¯ä»¥æ§è¡æ¹æ³ä½åå®¹ã\n\næåæå¥åè·åéã\n\n# 3. éæ¾é\n\nå½æ¹æ³æ§è¡å®æ¯ä¹åï¼æ³è¦éæ¾éçè¯ï¼éè¦æ§è¡ä»¥ä¸ Sql:\n\ndelete from methodLock where method_name ='method_name'\n\n\n# é®é¢\n\n 1. è¿æéå¼ºä¾èµæ°æ®åºçå¯ç¨æ§ãå¦ææ°æ®åºæ¯ä¸ä¸ªåç¹ï¼ä¸æ¦æ°æ®åºææï¼ä¼å¯¼è´ä¸å¡ç³»ç»ä¸å¯ç¨ã\n 2. è¿æéæ²¡æå¤±ææ¶é´ï¼ä¸æ¦è§£éæä½å¤±è´¥ï¼å°±ä¼å¯¼è´éè®°å½ä¸ç´å¨æ°æ®åºä¸­ï¼å¶ä»çº¿ç¨æ æ³åè·å¾å°éã\n 3. è¿æéåªè½æ¯éé»å¡çï¼å ä¸ºæ°æ®ç insert æä½ï¼ä¸æ¦æå¥å¤±è´¥å°±ä¼ç´æ¥æ¥éãæ²¡æè·å¾éççº¿ç¨å¹¶ä¸ä¼è¿å¥æééåï¼è¦æ³åæ¬¡è·å¾éå°±è¦åæ¬¡è§¦åè·å¾éæä½ã\n 4. è¿æéæ¯ééå¥çï¼åä¸ä¸ªçº¿ç¨å¨æ²¡æéæ¾éä¹åæ æ³åæ¬¡è·å¾è¯¥éãå ä¸ºæ°æ®ä¸­æ°æ®å·²ç»å­å¨äºã\n\n# è§£å³åæ³\n\n 1. åç¹é®é¢å¯ä»¥ç¨å¤æ°æ®åºå®ä¾ï¼åæ¶å¡ N ä¸ªè¡¨ï¼N/2+1 ä¸ªæåå°±ä»»å¡éå®æå\n 2. åä¸ä¸ªå®æ¶ä»»å¡ï¼éä¸æ®µæ¶é´æ¸é¤ä¸æ¬¡è¿æçæ°æ®ã\n 3. åä¸ä¸ª while å¾ªç¯ï¼ä¸æ­çéè¯æå¥ï¼ç´å°æåã\n 4. å¨æ°æ®åºè¡¨ä¸­å ä¸ªå­æ®µï¼è®°å½å½åè·å¾éçæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯ï¼é£ä¹ä¸æ¬¡åè·åéçæ¶ååæ¥è¯¢æ°æ®åºï¼å¦æå½åæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯å¨æ°æ®åºå¯ä»¥æ¥å°çè¯ï¼ç´æ¥æéåéç»ä»å°±å¯ä»¥äºã\n\n# å°ç»\n\n * ä¼ç¹: ç´æ¥åå©æ°æ®åºï¼å®¹æçè§£ã\n * ç¼ºç¹: ä¼æåç§åæ ·çé®é¢ï¼å¨è§£å³é®é¢çè¿ç¨ä¸­ä¼ä½¿æ´ä¸ªæ¹æ¡åå¾è¶æ¥è¶å¤æãæä½æ°æ®åºéè¦ä¸å®çå¼éï¼æ§è½é®é¢éè¦èèã\n\n\n# 2.2. åºäº Redis å®ç°åå¸å¼é\n\nç¸æ¯äºç¨æ°æ®åºæ¥å®ç°åå¸å¼éï¼åºäºç¼å­å®ç°çåå¸å¼éçæ§è½ä¼æ´å¥½ä¸äºãç®åæå¾å¤æççåå¸å¼äº§åï¼åæ¬ RedisãmemcacheãTair ç­ãè¿éä»¥ Redis ä¸¾ä¾ã\n\n# Redis å½ä»¤\n\n * setnx - setnx key valï¼å½ä¸ä»å½ key ä¸å­å¨æ¶ï¼set ä¸ä¸ª key ä¸º val çå­ç¬¦ä¸²ï¼è¿å 1ï¼è¥ key å­å¨ï¼åä»ä¹é½ä¸åï¼è¿å 0ã\n * expire - expire key timeoutï¼ä¸º key è®¾ç½®ä¸ä¸ªè¶æ¶æ¶é´ï¼åä½ä¸º secondï¼è¶è¿è¿ä¸ªæ¶é´éä¼èªå¨éæ¾ï¼é¿åæ­»éã\n * delete - delete keyï¼å é¤ key\n\n# å®ç°\n\nåç¹å®ç°æ­¥éª¤ï¼\n\n 1. è·åéçä½¿ç¨ï¼ä½¿ç¨ setnx å éï¼éç value å¼ä¸ºä¸ä¸ªéæºçæç UUIDï¼åä½¿ç¨ expire è®¾ç½®ä¸ä¸ªè¿æå¼ã\n 2. è·åéçæ¶åè¿è®¾ç½®ä¸ä¸ªè·åçè¶æ¶æ¶é´ï¼è¥è¶è¿è¿ä¸ªæ¶é´åæ¾å¼è·åéã\n 3. éæ¾éçæ¶åï¼éè¿ UUID å¤æ­æ¯ä¸æ¯è¯¥éï¼è¥æ¯è¯¥éï¼åæ§è¡ delete è¿è¡ééæ¾ã\n\n# é®é¢\n\n * åç¹é®é¢ãå¦æåæº redis ææäºï¼é£ä¹ç¨åºä¼è·çåºéã\n * å¦æè½¬ç§»ä½¿ç¨ slave èç¹ï¼å¤å¶ä¸æ¯åæ­¥å¤å¶ï¼ä¼åºç°å¤ä¸ªç¨åºè·åéçæåµ\n\n# å°ç»\n\nå¯ä»¥èèä½¿ç¨ redisson çè§£å³æ¹æ¡ã\n\n\n# 2.3. åºäº ZooKeeper å®ç°åå¸å¼é\n\n# å®ç°\n\nè¿ä¹æ¯ ZooKeeper å®¢æ·ç«¯ curator çåå¸å¼éå®ç°ã\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ A æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ B è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ A å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ B çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n# å°ç»\n\nZooKeeper çæ¬çåå¸å¼éé®é¢ç¸å¯¹æ¯è¾æ¥è¯´å°ã\n\n * éçå ç¨æ¶é´éå¶ï¼redis å°±æå ç¨æ¶é´éå¶ï¼è ZooKeeper åæ²¡æï¼æä¸»è¦çåå æ¯ redis ç®åæ²¡æåæ³ç¥éå·²ç»è·åéçå®¢æ·ç«¯çç¶æï¼æ¯å·²ç»æäºå¢è¿æ¯æ­£å¨æ§è¡èæ¶è¾é¿çä¸å¡é»è¾ãè ZooKeeper éè¿ä¸´æ¶èç¹å°±è½æ¸æ°ç¥éï¼å¦æä¸´æ¶èç¹å­å¨è¯´æè¿å¨æ§è¡ä¸å¡é»è¾ï¼å¦æä¸´æ¶èç¹ä¸å­å¨è¯´æå·²ç»æ§è¡å®æ¯éæ¾éæèæ¯æäºãç±æ­¤çæ¥ redis å¦æè½å ZooKeeper ä¸æ ·æ·»å ä¸äºä¸å®¢æ·ç«¯ç»å®çä¸´æ¶é®ï¼ä¹æ¯ä¸å¤§å¥½äºã\n * æ¯å¦åç¹æéï¼redis æ¬èº«æå¾å¤ä¸­ç©æ³ï¼å¦å®¢æ·ç«¯ä¸è´æ§ hashï¼æå¡å¨ç«¯ sentinel æ¹æ¡æè cluster æ¹æ¡ï¼å¾é¾åå°ä¸ç§åå¸å¼éæ¹å¼è½åºå¯¹ææè¿äºæ¹æ¡ãè ZooKeeper åªæä¸ç§ç©æ³ï¼å¤å°æºå¨çèç¹æ°æ®æ¯ä¸è´çï¼æ²¡æ redis çé£ä¹å¤çéº»ç¦å ç´ è¦èèã\n\næ»ä½ä¸æ¥è¯´ ZooKeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãä½ ZooKeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ Redis æ¹å¼ã\n\n\n# 3. åå¸å¼ Session\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç Session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç Sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nåå¸å¼ Session çå ç§å®ç°ç­ç¥ï¼\n\n 1. ç²æ§ session\n 2. åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n 3. åºäº cache DB ç¼å­ç session å±äº«\n\n\n# 3.1. Sticky Sessions\n\néè¦éç½®è´è½½åè¡¡å¨ï¼ä½¿å¾ä¸ä¸ªç¨æ·çææè¯·æ±é½è·¯ç±å°ä¸ä¸ªæå¡å¨èç¹ä¸ï¼è¿æ ·å°±å¯ä»¥æç¨æ·ç Session å­æ¾å¨è¯¥æå¡å¨èç¹ä¸­ã\n\nç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ Sessionã\n\n\n\n\n# 3.2. Session Replication\n\nå¨æå¡å¨èç¹ä¹é´è¿è¡ Session åæ­¥æä½ï¼è¿æ ·çè¯ç¨æ·å¯ä»¥è®¿é®ä»»ä½ä¸ä¸ªæå¡å¨èç¹ã\n\nç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n\n\n\n\n# 3.3. Session Server\n\nä½¿ç¨ä¸ä¸ªåç¬çæå¡å¨å­å¨ Session æ°æ®ï¼å¯ä»¥å­å¨ MySQL æ°æ®åºä¸ï¼ä¹å¯ä»¥å­å¨ Redis æè Memcached è¿ç§åå­åæ°æ®åºã\n\nç¼ºç¹ï¼éè¦å»å®ç°å­å Session çä»£ç ã\n\n\n\n\n# 4. åå¸å¼å­å¨\n\néå¸¸æä¸¤ç§è§£å³æ¹æ¡ï¼\n\n 1. æ°æ®åå¸ï¼å°±æ¯ææ°æ®ååå­å¨ä¸åçæå¡å¨ä¸ï¼ååºåè¡¨ï¼ã\n 2. æ°æ®å¤å¶ï¼è®©ææçæå¡å¨é½æç¸åçæ°æ®ï¼æä¾ç¸å½çæå¡ã\n\n> åèï¼åå¸å¼åç.md#2-æ°æ®åå¸\n\n\n# 5. åå¸å¼ç¼å­\n\nä½¿ç¨ç¼å­çå¥½å¤ï¼\n\n * æåæ°æ®è¯»åéåº¦\n * æåç³»ç»æ©å±è½åï¼éè¿æ©å±ç¼å­ï¼æåç³»ç»æ¿è½½è½å\n * éä½å­å¨ææ¬ï¼Cache+DB çæ¹å¼å¯ä»¥æ¿æåæéè¦å¤å° DB æè½æ¿æçè¯·æ±éï¼èçæºå¨ææ¬\n\næ ¹æ®ä¸å¡åºæ¯ï¼éå¸¸ç¼å­æä»¥ä¸å ç§ä½¿ç¨æ¹å¼\n\n * ææ±å¼(è¯»æ¶è§¦å)ï¼åå¥ DB å, ç¶åæç¸å³çæ°æ®ä¹åå¥ Cache\n * é¥¥é¥¿å¼(åæ¶è§¦å)ï¼åæ¥è¯¢ DB éçæ°æ®, ç¶åæç¸å³çæ°æ®åå¥ Cache\n * å®æå·æ°ï¼éåå¨ææ§çè·æ°æ®çä»»å¡ï¼æèåè¡¨åçæ°æ®ï¼èä¸ä¸è¦æ±ç»å¯¹å®æ¶æ§\n\nç¼å­åç±»ï¼\n\n * åºç¨åç¼å­ï¼å¦ï¼EHCache\n * åå¸å¼ç¼å­ï¼å¦ï¼MemachedãRedis\n\n> åèï¼åå¸å¼åç.md#6-åå¸å¼ç¼å­é®é¢\n\n\n# 6. åå¸å¼è®¡ç®\n\n\n# 7. è´è½½åè¡¡\n\n\n# 7.1. ç®æ³\n\n# è½®è¯¢ï¼Round Robinï¼\n\nè½®è¯¢ç®æ³ææ¯ä¸ªè¯·æ±è½®æµåéå°æ¯ä¸ªæå¡å¨ä¸ãä¸å¾ä¸­ï¼ä¸å±æ 6 ä¸ªå®¢æ·ç«¯äº§çäº 6 ä¸ªè¯·æ±ï¼è¿ 6 ä¸ªè¯·æ±æ (1, 2, 3, 4, 5, 6) çé¡ºåºåéãæåï¼(1, 3, 5) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(2, 4, 6) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\nè¯¥ç®æ³æ¯è¾éåæ¯ä¸ªæå¡å¨çæ§è½å·®ä¸å¤çåºæ¯ï¼å¦æææ§è½å­å¨å·®å¼çæåµä¸ï¼é£ä¹æ§è½è¾å·®çæå¡å¨å¯è½æ æ³æ¿æè¿å¤§çè´è½½ï¼ä¸å¾ç Server 2ï¼ã\n\n\n\n# å æè½®è¯¢ï¼Weighted Round Robbinï¼\n\nå æè½®è¯¢æ¯å¨è½®è¯¢çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½å·®å¼ï¼ä¸ºæå¡å¨èµäºä¸å®çæå¼ãä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 è¢«èµäºçæå¼ä¸º 5ï¼æå¡å¨ 2 è¢«èµäºçæå¼ä¸º 1ï¼é£ä¹ (1, 2, 3, 4, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(6) è¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\n# æå°è¿æ¥ï¼least Connectionsï¼\n\nç±äºæ¯ä¸ªè¯·æ±çè¿æ¥æ¶é´ä¸ä¸æ ·ï¼ä½¿ç¨è½®è¯¢æèå æè½®è¯¢ç®æ³çè¯ï¼å¯è½ä¼è®©ä¸å°æå¡å¨å½åè¿æ¥æ°è¿å¤§ï¼èå¦ä¸å°æå¡å¨çè¿æ¥è¿å°ï¼é æè´è½½ä¸åè¡¡ãä¾å¦ä¸å¾ä¸­ï¼(1, 3, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼ä½æ¯ (1, 3) å¾å¿«å°±æ­å¼è¿æ¥ï¼æ­¤æ¶åªæ (5) è¯·æ±è¿æ¥æå¡å¨ 1ï¼(2, 4, 6) è¯·æ±è¢«åéå°æå¡å¨ 2ï¼åªæ (2) çè¿æ¥æ­å¼ãè¯¥ç³»ç»ç»§ç»­è¿è¡æ¶ï¼æå¡å¨ 2 ä¼æ¿æè¿å¤§çè´è½½ã\n\n\n\næå°è¿æ¥ç®æ³å°±æ¯å°è¯·æ±åéç»å½åæå°è¿æ¥æ°çæå¡å¨ä¸ãä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 å½åè¿æ¥æ°æå°ï¼é£ä¹æ°å°æ¥çè¯·æ± 6 å°±ä¼è¢«åéå°æå¡å¨ 1 ä¸ã\n\n\n\n# å ææå°è¿æ¥ï¼Weighted Least Connectionï¼\n\nå¨æå°è¿æ¥çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½ä¸ºæ¯å°æå¡å¨åéæéï¼åæ ¹æ®æéè®¡ç®åºæ¯å°æå¡å¨è½å¤ççè¿æ¥æ°ã\n\n\n\n# éæºç®æ³ï¼Randomï¼\n\næè¯·æ±éæºåéå°æå¡å¨ä¸ãåè½®è¯¢ç®æ³ç±»ä¼¼ï¼è¯¥ç®æ³æ¯è¾éåæå¡å¨æ§è½å·®ä¸å¤çåºæ¯ã\n\n\n\n# æºå°ååå¸æ³ (IP Hash)\n\næºå°ååå¸éè¿å¯¹å®¢æ·ç«¯ IP åå¸è®¡ç®å¾å°çä¸ä¸ªæ°å¼ï¼ç¨è¯¥æ°å¼å¯¹æå¡å¨æ°éè¿è¡åæ¨¡è¿ç®ï¼åæ¨¡ç»æä¾¿æ¯ç®æ æå¡å¨çåºå·ã\n\n * ä¼ç¹ï¼ä¿è¯åä¸ IP çå®¢æ·ç«¯é½ä¼è¢« hash å°åä¸å°æå¡å¨ä¸ã\n * ç¼ºç¹ï¼ä¸å©äºéç¾¤æ©å±ï¼åå°æå¡å¨æ°éåæ´é½ä¼å½±å hash ç»æãå¯ä»¥éç¨ä¸è´æ§ Hash æ¹è¿ã\n\n\n\n\n# 7.2. å®ç°\n\n# HTTP éå®å\n\nHTTP éå®åè´è½½åè¡¡æå¡å¨æ¶å° HTTP è¯·æ±ä¹åä¼è¿åæå¡å¨çå°åï¼å¹¶å°è¯¥å°ååå¥ HTTP éå®åååºä¸­è¿åç»æµè§å¨ï¼æµè§å¨æ¶å°åéè¦åæ¬¡åéè¯·æ±ã\n\nç¼ºç¹ï¼\n\n * ç¨æ·è®¿é®çå»¶è¿ä¼å¢å ï¼\n * å¦æè´è½½åè¡¡å¨å®æºï¼å°±æ æ³è®¿é®è¯¥ç«ç¹ã\n\n\n\n# DNS éå®å\n\nä½¿ç¨ DNS ä½ä¸ºè´è½½åè¡¡å¨ï¼æ ¹æ®è´è½½æåµè¿åä¸åæå¡å¨ç IP å°åãå¤§åç½ç«åºæ¬ä½¿ç¨äºè¿ç§æ¹å¼åä¸ºç¬¬ä¸çº§è´è½½åè¡¡ææ®µï¼ç¶åå¨åé¨ä½¿ç¨å¶å®æ¹å¼åç¬¬äºçº§è´è½½åè¡¡ã\n\nç¼ºç¹ï¼\n\n * DNS æ¥æ¾è¡¨å¯è½ä¼è¢«å®¢æ·ç«¯ç¼å­èµ·æ¥ï¼é£ä¹ä¹åçææè¯·æ±é½ä¼è¢«éå®åå°åä¸ä¸ªæå¡å¨ã\n\n\n\n# ä¿®æ¹ MAC å°å\n\nä½¿ç¨ LVSï¼Linux Virtual Serverï¼è¿ç§é¾è·¯å±è´è½½åè¡¡å¨ï¼æ ¹æ®è´è½½æåµä¿®æ¹è¯·æ±ç MAC å°åã\n\n\n\n# ä¿®æ¹ IP å°å\n\nå¨ç½ç»å±ä¿®æ¹è¯·æ±çç®ç IP å°åã\n\n\n\n# ä»£çèªå¨éç½®\n\næ­£åä»£çä¸ååä»£ççåºå«ï¼\n\n * æ­£åä»£çï¼åçå¨å®¢æ·ç«¯ï¼æ¯ç±ç¨æ·ä¸»å¨åèµ·çãæ¯å¦ç¿»å¢ï¼å®¢æ·ç«¯éè¿ä¸»å¨è®¿é®ä»£çæå¡å¨ï¼è®©ä»£çæå¡å¨è·å¾éè¦çå¤ç½æ°æ®ï¼ç¶åè½¬ååå®¢æ·ç«¯ã\n * ååä»£çï¼åçå¨æå¡å¨ç«¯ï¼ç¨æ·ä¸ç¥éä»£ççå­å¨ã\n\nPAC æå¡å¨æ¯ç¨æ¥å¤æ­ä¸ä¸ªè¯·æ±æ¯å¦è¦ç»è¿ä»£çã\n\n\n\n\n# 8. èµæ\n\n * https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html\n * https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E5%88%86%E5%B8%83%E5%BC%8F%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90.md\n * https://www.jianshu.com/p/453c6e7ff81c\n * https://juejin.im/post/5a20cd8bf265da43163cdd9a\n * https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8\n * https://github.com/L316476844/distributed-session\n * åå¸å¼ç¼å­æ¶æåºç¡\n * é¿é P8 ææ¯ä¸å®¶ç»ç©¶åå¸å¼ç¼å­é®é¢",normalizedContent:"# å¤§åç³»ç»æ ¸å¿ææ¯\n\n> å¤§åç³»ç»çè®¾è®¡ç®æ å°±æ¯ä¸ºäºå¿«éãé«æãç¨³å®çå¤çæµ·éçæ°æ®ä»¥åé«å¹¶åçè¯·æ±ã\n> \n> åæºæå¡åéäºç¡¬ä»¶ï¼å®¢è§å­å¨çèµæºç¶é¢ï¼é¾ä»¥åºå¯¹ä¸æ­å¢é¿çæ°æ®éåè¯·æ±éï¼ä¸ºäºæç ´ç¶é¢ï¼å¤§åç³»ç»åºæ¬ä¸é½è¢«è®¾è®¡ä¸ºåå¸å¼ç³»ç»ã\n> \n> åå¸å¼ç³»ç»ç±äºå¶é¢ä¸´çå±æ§é®é¢ï¼å¨å¾å¤åºæ¯ä¸çè§£å³æ¹æ¡å¾å¾ä¹å­å¨çå±æ§ãå æ­¤ï¼æä»¬ä¼åç°ï¼å¾å¤ä¼ç§çå¤§åç³»ç»å¨è®¾è®¡æ¹æ¡ä¸å­å¨çå¾å¤çå±åç¹ã\n> \n> æ¬æä¸»è¦è®¨è®ºåºå¯¹åå¸å¼ç³»ç»å±æ§é®é¢çè§£å³æ¹æ¡ï¼è¿æ¢å¯ä»¥å æ·±å¯¹åå¸å¼ç³»ç»è¿ä½åçççè§£ï¼ä¹å¯ä»¥ä½ä¸ºè®¾è®¡å¤§ååå¸å¼ç³»ç»æ¶çåé´ã\n\n\n# 1. åå¸å¼äºå¡\n\n> åèï¼åå¸å¼åç#4-åå¸å¼äºå¡é®é¢\n\n\n# 2. åå¸å¼é\n\njava åç api è½ç¶æå¹¶åéï¼ä½å¹¶æ²¡ææä¾åå¸å¼éçè½åï¼æä»¥éå¯¹åå¸å¼åºæ¯ä¸­çééè¦è§£å³çæ¹æ¡ã\n\nåå¸å¼éçè§£å³æ¹æ¡å¤§è´æä»¥ä¸å ç§ï¼\n\n * åºäºæ°æ®åºå®ç°\n * åºäºç¼å­ï¼redisï¼memcached ç­ï¼å®ç°\n * åºäº zookeeper å®ç°\n\n\n# 2.1. åºäºæ°æ®åºå®ç°åå¸å¼é\n\n# å®ç°\n\n# 1. åå»ºè¡¨\n\ncreate table `methodlock` (\n  `id` int(11) not null auto_increment comment 'ä¸»é®',\n  `method_name` varchar(64) not null default '' comment 'éå®çæ¹æ³å',\n  `desc` varchar(1024) not null default 'å¤æ³¨ä¿¡æ¯',\n  `update_time` timestamp not null default current_timestamp on update current_timestamp comment 'ä¿å­æ°æ®æ¶é´ï¼èªå¨çæ',\n  primary key (`id`),\n  unique key `uidx_method_name` (`method_name `) using btree\n) engine=innodb default charset=utf8 comment='éå®ä¸­çæ¹æ³';\n\n\n# 2. è·åé\n\næ³è¦éä½æä¸ªæ¹æ³æ¶ï¼æ§è¡ä»¥ä¸ sqlï¼\n\ninsert into methodlock(method_name,desc) values (âmethod_nameâ,âdescâ)\n\n\nå ä¸ºæä»¬å¯¹ method_name åäºå¯ä¸æ§çº¦æï¼è¿éå¦ææå¤ä¸ªè¯·æ±åæ¶æäº¤å°æ°æ®åºçè¯ï¼æ°æ®åºä¼ä¿è¯åªæä¸ä¸ªæä½å¯ä»¥æåï¼é£ä¹æä»¬å°±å¯ä»¥è®¤ä¸ºæä½æåçé£ä¸ªçº¿ç¨è·å¾äºè¯¥æ¹æ³çéï¼å¯ä»¥æ§è¡æ¹æ³ä½åå®¹ã\n\næåæå¥åè·åéã\n\n# 3. éæ¾é\n\nå½æ¹æ³æ§è¡å®æ¯ä¹åï¼æ³è¦éæ¾éçè¯ï¼éè¦æ§è¡ä»¥ä¸ sql:\n\ndelete from methodlock where method_name ='method_name'\n\n\n# é®é¢\n\n 1. è¿æéå¼ºä¾èµæ°æ®åºçå¯ç¨æ§ãå¦ææ°æ®åºæ¯ä¸ä¸ªåç¹ï¼ä¸æ¦æ°æ®åºææï¼ä¼å¯¼è´ä¸å¡ç³»ç»ä¸å¯ç¨ã\n 2. è¿æéæ²¡æå¤±ææ¶é´ï¼ä¸æ¦è§£éæä½å¤±è´¥ï¼å°±ä¼å¯¼è´éè®°å½ä¸ç´å¨æ°æ®åºä¸­ï¼å¶ä»çº¿ç¨æ æ³åè·å¾å°éã\n 3. è¿æéåªè½æ¯éé»å¡çï¼å ä¸ºæ°æ®ç insert æä½ï¼ä¸æ¦æå¥å¤±è´¥å°±ä¼ç´æ¥æ¥éãæ²¡æè·å¾éççº¿ç¨å¹¶ä¸ä¼è¿å¥æééåï¼è¦æ³åæ¬¡è·å¾éå°±è¦åæ¬¡è§¦åè·å¾éæä½ã\n 4. è¿æéæ¯ééå¥çï¼åä¸ä¸ªçº¿ç¨å¨æ²¡æéæ¾éä¹åæ æ³åæ¬¡è·å¾è¯¥éãå ä¸ºæ°æ®ä¸­æ°æ®å·²ç»å­å¨äºã\n\n# è§£å³åæ³\n\n 1. åç¹é®é¢å¯ä»¥ç¨å¤æ°æ®åºå®ä¾ï¼åæ¶å¡ n ä¸ªè¡¨ï¼n/2+1 ä¸ªæåå°±ä»»å¡éå®æå\n 2. åä¸ä¸ªå®æ¶ä»»å¡ï¼éä¸æ®µæ¶é´æ¸é¤ä¸æ¬¡è¿æçæ°æ®ã\n 3. åä¸ä¸ª while å¾ªç¯ï¼ä¸æ­çéè¯æå¥ï¼ç´å°æåã\n 4. å¨æ°æ®åºè¡¨ä¸­å ä¸ªå­æ®µï¼è®°å½å½åè·å¾éçæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯ï¼é£ä¹ä¸æ¬¡åè·åéçæ¶ååæ¥è¯¢æ°æ®åºï¼å¦æå½åæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯å¨æ°æ®åºå¯ä»¥æ¥å°çè¯ï¼ç´æ¥æéåéç»ä»å°±å¯ä»¥äºã\n\n# å°ç»\n\n * ä¼ç¹: ç´æ¥åå©æ°æ®åºï¼å®¹æçè§£ã\n * ç¼ºç¹: ä¼æåç§åæ ·çé®é¢ï¼å¨è§£å³é®é¢çè¿ç¨ä¸­ä¼ä½¿æ´ä¸ªæ¹æ¡åå¾è¶æ¥è¶å¤æãæä½æ°æ®åºéè¦ä¸å®çå¼éï¼æ§è½é®é¢éè¦èèã\n\n\n# 2.2. åºäº redis å®ç°åå¸å¼é\n\nç¸æ¯äºç¨æ°æ®åºæ¥å®ç°åå¸å¼éï¼åºäºç¼å­å®ç°çåå¸å¼éçæ§è½ä¼æ´å¥½ä¸äºãç®åæå¾å¤æççåå¸å¼äº§åï¼åæ¬ redisãmemcacheãtair ç­ãè¿éä»¥ redis ä¸¾ä¾ã\n\n# redis å½ä»¤\n\n * setnx - setnx key valï¼å½ä¸ä»å½ key ä¸å­å¨æ¶ï¼set ä¸ä¸ª key ä¸º val çå­ç¬¦ä¸²ï¼è¿å 1ï¼è¥ key å­å¨ï¼åä»ä¹é½ä¸åï¼è¿å 0ã\n * expire - expire key timeoutï¼ä¸º key è®¾ç½®ä¸ä¸ªè¶æ¶æ¶é´ï¼åä½ä¸º secondï¼è¶è¿è¿ä¸ªæ¶é´éä¼èªå¨éæ¾ï¼é¿åæ­»éã\n * delete - delete keyï¼å é¤ key\n\n# å®ç°\n\nåç¹å®ç°æ­¥éª¤ï¼\n\n 1. è·åéçä½¿ç¨ï¼ä½¿ç¨ setnx å éï¼éç value å¼ä¸ºä¸ä¸ªéæºçæç uuidï¼åä½¿ç¨ expire è®¾ç½®ä¸ä¸ªè¿æå¼ã\n 2. è·åéçæ¶åè¿è®¾ç½®ä¸ä¸ªè·åçè¶æ¶æ¶é´ï¼è¥è¶è¿è¿ä¸ªæ¶é´åæ¾å¼è·åéã\n 3. éæ¾éçæ¶åï¼éè¿ uuid å¤æ­æ¯ä¸æ¯è¯¥éï¼è¥æ¯è¯¥éï¼åæ§è¡ delete è¿è¡ééæ¾ã\n\n# é®é¢\n\n * åç¹é®é¢ãå¦æåæº redis ææäºï¼é£ä¹ç¨åºä¼è·çåºéã\n * å¦æè½¬ç§»ä½¿ç¨ slave èç¹ï¼å¤å¶ä¸æ¯åæ­¥å¤å¶ï¼ä¼åºç°å¤ä¸ªç¨åºè·åéçæåµ\n\n# å°ç»\n\nå¯ä»¥èèä½¿ç¨ redisson çè§£å³æ¹æ¡ã\n\n\n# 2.3. åºäº zookeeper å®ç°åå¸å¼é\n\n# å®ç°\n\nè¿ä¹æ¯ zookeeper å®¢æ·ç«¯ curator çåå¸å¼éå®ç°ã\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ a æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ b è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ a å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ b çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n# å°ç»\n\nzookeeper çæ¬çåå¸å¼éé®é¢ç¸å¯¹æ¯è¾æ¥è¯´å°ã\n\n * éçå ç¨æ¶é´éå¶ï¼redis å°±æå ç¨æ¶é´éå¶ï¼è zookeeper åæ²¡æï¼æä¸»è¦çåå æ¯ redis ç®åæ²¡æåæ³ç¥éå·²ç»è·åéçå®¢æ·ç«¯çç¶æï¼æ¯å·²ç»æäºå¢è¿æ¯æ­£å¨æ§è¡èæ¶è¾é¿çä¸å¡é»è¾ãè zookeeper éè¿ä¸´æ¶èç¹å°±è½æ¸æ°ç¥éï¼å¦æä¸´æ¶èç¹å­å¨è¯´æè¿å¨æ§è¡ä¸å¡é»è¾ï¼å¦æä¸´æ¶èç¹ä¸å­å¨è¯´æå·²ç»æ§è¡å®æ¯éæ¾éæèæ¯æäºãç±æ­¤çæ¥ redis å¦æè½å zookeeper ä¸æ ·æ·»å ä¸äºä¸å®¢æ·ç«¯ç»å®çä¸´æ¶é®ï¼ä¹æ¯ä¸å¤§å¥½äºã\n * æ¯å¦åç¹æéï¼redis æ¬èº«æå¾å¤ä¸­ç©æ³ï¼å¦å®¢æ·ç«¯ä¸è´æ§ hashï¼æå¡å¨ç«¯ sentinel æ¹æ¡æè cluster æ¹æ¡ï¼å¾é¾åå°ä¸ç§åå¸å¼éæ¹å¼è½åºå¯¹ææè¿äºæ¹æ¡ãè zookeeper åªæä¸ç§ç©æ³ï¼å¤å°æºå¨çèç¹æ°æ®æ¯ä¸è´çï¼æ²¡æ redis çé£ä¹å¤çéº»ç¦å ç´ è¦èèã\n\næ»ä½ä¸æ¥è¯´ zookeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãä½ zookeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ redis æ¹å¼ã\n\n\n# 3. åå¸å¼ session\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nåå¸å¼ session çå ç§å®ç°ç­ç¥ï¼\n\n 1. ç²æ§ session\n 2. åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n 3. åºäº cache db ç¼å­ç session å±äº«\n\n\n# 3.1. sticky sessions\n\néè¦éç½®è´è½½åè¡¡å¨ï¼ä½¿å¾ä¸ä¸ªç¨æ·çææè¯·æ±é½è·¯ç±å°ä¸ä¸ªæå¡å¨èç¹ä¸ï¼è¿æ ·å°±å¯ä»¥æç¨æ·ç session å­æ¾å¨è¯¥æå¡å¨èç¹ä¸­ã\n\nç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ sessionã\n\n\n\n\n# 3.2. session replication\n\nå¨æå¡å¨èç¹ä¹é´è¿è¡ session åæ­¥æä½ï¼è¿æ ·çè¯ç¨æ·å¯ä»¥è®¿é®ä»»ä½ä¸ä¸ªæå¡å¨èç¹ã\n\nç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n\n\n\n\n# 3.3. session server\n\nä½¿ç¨ä¸ä¸ªåç¬çæå¡å¨å­å¨ session æ°æ®ï¼å¯ä»¥å­å¨ mysql æ°æ®åºä¸ï¼ä¹å¯ä»¥å­å¨ redis æè memcached è¿ç§åå­åæ°æ®åºã\n\nç¼ºç¹ï¼éè¦å»å®ç°å­å session çä»£ç ã\n\n\n\n\n# 4. åå¸å¼å­å¨\n\néå¸¸æä¸¤ç§è§£å³æ¹æ¡ï¼\n\n 1. æ°æ®åå¸ï¼å°±æ¯ææ°æ®ååå­å¨ä¸åçæå¡å¨ä¸ï¼ååºåè¡¨ï¼ã\n 2. æ°æ®å¤å¶ï¼è®©ææçæå¡å¨é½æç¸åçæ°æ®ï¼æä¾ç¸å½çæå¡ã\n\n> åèï¼åå¸å¼åç.md#2-æ°æ®åå¸\n\n\n# 5. åå¸å¼ç¼å­\n\nä½¿ç¨ç¼å­çå¥½å¤ï¼\n\n * æåæ°æ®è¯»åéåº¦\n * æåç³»ç»æ©å±è½åï¼éè¿æ©å±ç¼å­ï¼æåç³»ç»æ¿è½½è½å\n * éä½å­å¨ææ¬ï¼cache+db çæ¹å¼å¯ä»¥æ¿æåæéè¦å¤å° db æè½æ¿æçè¯·æ±éï¼èçæºå¨ææ¬\n\næ ¹æ®ä¸å¡åºæ¯ï¼éå¸¸ç¼å­æä»¥ä¸å ç§ä½¿ç¨æ¹å¼\n\n * ææ±å¼(è¯»æ¶è§¦å)ï¼åå¥ db å, ç¶åæç¸å³çæ°æ®ä¹åå¥ cache\n * é¥¥é¥¿å¼(åæ¶è§¦å)ï¼åæ¥è¯¢ db éçæ°æ®, ç¶åæç¸å³çæ°æ®åå¥ cache\n * å®æå·æ°ï¼éåå¨ææ§çè·æ°æ®çä»»å¡ï¼æèåè¡¨åçæ°æ®ï¼èä¸ä¸è¦æ±ç»å¯¹å®æ¶æ§\n\nç¼å­åç±»ï¼\n\n * åºç¨åç¼å­ï¼å¦ï¼ehcache\n * åå¸å¼ç¼å­ï¼å¦ï¼memachedãredis\n\n> åèï¼åå¸å¼åç.md#6-åå¸å¼ç¼å­é®é¢\n\n\n# 6. åå¸å¼è®¡ç®\n\n\n# 7. è´è½½åè¡¡\n\n\n# 7.1. ç®æ³\n\n# è½®è¯¢ï¼round robinï¼\n\nè½®è¯¢ç®æ³ææ¯ä¸ªè¯·æ±è½®æµåéå°æ¯ä¸ªæå¡å¨ä¸ãä¸å¾ä¸­ï¼ä¸å±æ 6 ä¸ªå®¢æ·ç«¯äº§çäº 6 ä¸ªè¯·æ±ï¼è¿ 6 ä¸ªè¯·æ±æ (1, 2, 3, 4, 5, 6) çé¡ºåºåéãæåï¼(1, 3, 5) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(2, 4, 6) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\nè¯¥ç®æ³æ¯è¾éåæ¯ä¸ªæå¡å¨çæ§è½å·®ä¸å¤çåºæ¯ï¼å¦æææ§è½å­å¨å·®å¼çæåµä¸ï¼é£ä¹æ§è½è¾å·®çæå¡å¨å¯è½æ æ³æ¿æè¿å¤§çè´è½½ï¼ä¸å¾ç server 2ï¼ã\n\n\n\n# å æè½®è¯¢ï¼weighted round robbinï¼\n\nå æè½®è¯¢æ¯å¨è½®è¯¢çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½å·®å¼ï¼ä¸ºæå¡å¨èµäºä¸å®çæå¼ãä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 è¢«èµäºçæå¼ä¸º 5ï¼æå¡å¨ 2 è¢«èµäºçæå¼ä¸º 1ï¼é£ä¹ (1, 2, 3, 4, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(6) è¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\n# æå°è¿æ¥ï¼least connectionsï¼\n\nç±äºæ¯ä¸ªè¯·æ±çè¿æ¥æ¶é´ä¸ä¸æ ·ï¼ä½¿ç¨è½®è¯¢æèå æè½®è¯¢ç®æ³çè¯ï¼å¯è½ä¼è®©ä¸å°æå¡å¨å½åè¿æ¥æ°è¿å¤§ï¼èå¦ä¸å°æå¡å¨çè¿æ¥è¿å°ï¼é æè´è½½ä¸åè¡¡ãä¾å¦ä¸å¾ä¸­ï¼(1, 3, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼ä½æ¯ (1, 3) å¾å¿«å°±æ­å¼è¿æ¥ï¼æ­¤æ¶åªæ (5) è¯·æ±è¿æ¥æå¡å¨ 1ï¼(2, 4, 6) è¯·æ±è¢«åéå°æå¡å¨ 2ï¼åªæ (2) çè¿æ¥æ­å¼ãè¯¥ç³»ç»ç»§ç»­è¿è¡æ¶ï¼æå¡å¨ 2 ä¼æ¿æè¿å¤§çè´è½½ã\n\n\n\næå°è¿æ¥ç®æ³å°±æ¯å°è¯·æ±åéç»å½åæå°è¿æ¥æ°çæå¡å¨ä¸ãä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 å½åè¿æ¥æ°æå°ï¼é£ä¹æ°å°æ¥çè¯·æ± 6 å°±ä¼è¢«åéå°æå¡å¨ 1 ä¸ã\n\n\n\n# å ææå°è¿æ¥ï¼weighted least connectionï¼\n\nå¨æå°è¿æ¥çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½ä¸ºæ¯å°æå¡å¨åéæéï¼åæ ¹æ®æéè®¡ç®åºæ¯å°æå¡å¨è½å¤ççè¿æ¥æ°ã\n\n\n\n# éæºç®æ³ï¼randomï¼\n\næè¯·æ±éæºåéå°æå¡å¨ä¸ãåè½®è¯¢ç®æ³ç±»ä¼¼ï¼è¯¥ç®æ³æ¯è¾éåæå¡å¨æ§è½å·®ä¸å¤çåºæ¯ã\n\n\n\n# æºå°ååå¸æ³ (ip hash)\n\næºå°ååå¸éè¿å¯¹å®¢æ·ç«¯ ip åå¸è®¡ç®å¾å°çä¸ä¸ªæ°å¼ï¼ç¨è¯¥æ°å¼å¯¹æå¡å¨æ°éè¿è¡åæ¨¡è¿ç®ï¼åæ¨¡ç»æä¾¿æ¯ç®æ æå¡å¨çåºå·ã\n\n * ä¼ç¹ï¼ä¿è¯åä¸ ip çå®¢æ·ç«¯é½ä¼è¢« hash å°åä¸å°æå¡å¨ä¸ã\n * ç¼ºç¹ï¼ä¸å©äºéç¾¤æ©å±ï¼åå°æå¡å¨æ°éåæ´é½ä¼å½±å hash ç»æãå¯ä»¥éç¨ä¸è´æ§ hash æ¹è¿ã\n\n\n\n\n# 7.2. å®ç°\n\n# http éå®å\n\nhttp éå®åè´è½½åè¡¡æå¡å¨æ¶å° http è¯·æ±ä¹åä¼è¿åæå¡å¨çå°åï¼å¹¶å°è¯¥å°ååå¥ http éå®åååºä¸­è¿åç»æµè§å¨ï¼æµè§å¨æ¶å°åéè¦åæ¬¡åéè¯·æ±ã\n\nç¼ºç¹ï¼\n\n * ç¨æ·è®¿é®çå»¶è¿ä¼å¢å ï¼\n * å¦æè´è½½åè¡¡å¨å®æºï¼å°±æ æ³è®¿é®è¯¥ç«ç¹ã\n\n\n\n# dns éå®å\n\nä½¿ç¨ dns ä½ä¸ºè´è½½åè¡¡å¨ï¼æ ¹æ®è´è½½æåµè¿åä¸åæå¡å¨ç ip å°åãå¤§åç½ç«åºæ¬ä½¿ç¨äºè¿ç§æ¹å¼åä¸ºç¬¬ä¸çº§è´è½½åè¡¡ææ®µï¼ç¶åå¨åé¨ä½¿ç¨å¶å®æ¹å¼åç¬¬äºçº§è´è½½åè¡¡ã\n\nç¼ºç¹ï¼\n\n * dns æ¥æ¾è¡¨å¯è½ä¼è¢«å®¢æ·ç«¯ç¼å­èµ·æ¥ï¼é£ä¹ä¹åçææè¯·æ±é½ä¼è¢«éå®åå°åä¸ä¸ªæå¡å¨ã\n\n\n\n# ä¿®æ¹ mac å°å\n\nä½¿ç¨ lvsï¼linux virtual serverï¼è¿ç§é¾è·¯å±è´è½½åè¡¡å¨ï¼æ ¹æ®è´è½½æåµä¿®æ¹è¯·æ±ç mac å°åã\n\n\n\n# ä¿®æ¹ ip å°å\n\nå¨ç½ç»å±ä¿®æ¹è¯·æ±çç®ç ip å°åã\n\n\n\n# ä»£çèªå¨éç½®\n\næ­£åä»£çä¸ååä»£ççåºå«ï¼\n\n * æ­£åä»£çï¼åçå¨å®¢æ·ç«¯ï¼æ¯ç±ç¨æ·ä¸»å¨åèµ·çãæ¯å¦ç¿»å¢ï¼å®¢æ·ç«¯éè¿ä¸»å¨è®¿é®ä»£çæå¡å¨ï¼è®©ä»£çæå¡å¨è·å¾éè¦çå¤ç½æ°æ®ï¼ç¶åè½¬ååå®¢æ·ç«¯ã\n * ååä»£çï¼åçå¨æå¡å¨ç«¯ï¼ç¨æ·ä¸ç¥éä»£ççå­å¨ã\n\npac æå¡å¨æ¯ç¨æ¥å¤æ­ä¸ä¸ªè¯·æ±æ¯å¦è¦ç»è¿ä»£çã\n\n\n\n\n# 8. èµæ\n\n * https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html\n * https://github.com/cyc2018/interview-notebook/blob/master/notes/%e5%88%86%e5%b8%83%e5%bc%8f%e9%97%ae%e9%a2%98%e5%88%86%e6%9e%90.md\n * https://www.jianshu.com/p/453c6e7ff81c\n * https://juejin.im/post/5a20cd8bf265da43163cdd9a\n * https://github.com/redisson/redisson/wiki/8.-%e5%88%86%e5%b8%83%e5%bc%8f%e9%94%81%e5%92%8c%e5%90%8c%e6%ad%a5%e5%99%a8\n * https://github.com/l316476844/distributed-session\n * åå¸å¼ç¼å­æ¶æåºç¡\n * é¿é p8 ææ¯ä¸å®¶ç»ç©¶åå¸å¼ç¼å­é®é¢",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"é¢åé©±å¨è®¾è®¡",frontmatter:{title:"é¢åé©±å¨è®¾è®¡",date:"2020-08-10T10:59:18.000Z",categories:["æ¶æ"],tags:["æ¶æ","è®¾è®¡","DDD"],permalink:"/pages/4dfb51/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/09.%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1.html",relativePath:"01.æ¶æ/09.é¢åé©±å¨è®¾è®¡.md",key:"v-6655d46f",path:"/pages/4dfb51/",headers:[{level:2,title:"1. DDD ç®ä»",slug:"_1-ddd-ç®ä»",normalizedTitle:"1. ddd ç®ä»",charIndex:13},{level:3,title:"1.1. è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿",slug:"_1-1-è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿",normalizedTitle:"1.1. è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿",charIndex:27},{level:3,title:"1.2. ä»ä¹æ¯ DDD",slug:"_1-2-ä»ä¹æ¯-ddd",normalizedTitle:"1.2. ä»ä¹æ¯ ddd",charIndex:375},{level:3,title:"1.3. DDD ä¸å¾®æå¡çå³ç³»",slug:"_1-3-ddd-ä¸å¾®æå¡çå³ç³»",normalizedTitle:"1.3. ddd ä¸å¾®æå¡çå³ç³»",charIndex:699},{level:2,title:"2. DDD æ ¸å¿æ¦å¿µ",slug:"_2-ddd-æ ¸å¿æ¦å¿µ",normalizedTitle:"2. ddd æ ¸å¿æ¦å¿µ",charIndex:947},{level:3,title:"2.1. å",slug:"_2-1-å",normalizedTitle:"2.1. å",charIndex:965},{level:3,title:"2.2. éç¨è¯­è¨åä¸ä¸æè¾¹ç",slug:"_2-2-éç¨è¯­è¨åä¸ä¸æè¾¹ç",normalizedTitle:"2.2. éç¨è¯­è¨åä¸ä¸æè¾¹ç",charIndex:1375},{level:3,title:"2.3. å®ä½åå¼å¯¹è±¡",slug:"_2-3-å®ä½åå¼å¯¹è±¡",normalizedTitle:"2.3. å®ä½åå¼å¯¹è±¡",charIndex:1634},{level:3,title:"2.4. èååèåè·",slug:"_2-4-èååèåè·",normalizedTitle:"2.4. èååèåè·",charIndex:1921},{level:4,title:"2.4.1. èåè®¾è®¡æ­¥éª¤",slug:"_2-4-1-èåè®¾è®¡æ­¥éª¤",normalizedTitle:"2.4.1. èåè®¾è®¡æ­¥éª¤",charIndex:2253},{level:4,title:"2.4.2. èåè®¾è®¡åå",slug:"_2-4-2-èåè®¾è®¡åå",normalizedTitle:"2.4.2. èåè®¾è®¡åå",charIndex:2558},{level:2,title:"3. æ¶ææ¨¡å",slug:"_3-æ¶ææ¨¡å",normalizedTitle:"3. æ¶ææ¨¡å",charIndex:2662},{level:3,title:"3.1. DDD æ¶æ",slug:"_3-1-ddd-æ¶æ",normalizedTitle:"3.1. ddd æ¶æ",charIndex:2674},{level:3,title:"3.2. æ´æ´æ¶æ",slug:"_3-2-æ´æ´æ¶æ",normalizedTitle:"3.2. æ´æ´æ¶æ",charIndex:2806},{level:3,title:"3.3. å­è¾¹å½¢æ¶æ",slug:"_3-3-å­è¾¹å½¢æ¶æ",normalizedTitle:"3.3. å­è¾¹å½¢æ¶æ",charIndex:2972},{level:3,title:"3.4. ä¸ç§æ¶æå¯¹æ¯",slug:"_3-4-ä¸ç§æ¶æå¯¹æ¯",normalizedTitle:"3.4. ä¸ç§æ¶æå¯¹æ¯",charIndex:3320},{level:4,title:"3.4.1. æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³»",slug:"_3-4-1-æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³»",normalizedTitle:"3.4.1. æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³»",charIndex:3372},{level:4,title:"3.4.2. ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å",slug:"_3-4-2-ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å",normalizedTitle:"3.4.2. ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å",charIndex:3548},{level:4,title:"3.4.3. å¾®æå¡è¦æåççæ¶æåå±",slug:"_3-4-3-å¾®æå¡è¦æåççæ¶æåå±",normalizedTitle:"3.4.3. å¾®æå¡è¦æåççæ¶æåå±",charIndex:3732},{level:4,title:"3.4.4. åºç¨åèµæºçè§£è¦ä¸éé",slug:"_3-4-4-åºç¨åèµæºçè§£è¦ä¸éé",normalizedTitle:"3.4.4. åºç¨åèµæºçè§£è¦ä¸éé",charIndex:3880},{level:2,title:"4. ä¸­å°æç¥",slug:"_4-ä¸­å°æç¥",normalizedTitle:"4. ä¸­å°æç¥",charIndex:4002},{level:3,title:"4.1. å¹³å°ä¸æ¯ä¸­å°",slug:"_4-1-å¹³å°ä¸æ¯ä¸­å°",normalizedTitle:"4.1. å¹³å°ä¸æ¯ä¸­å°",charIndex:4014},{level:3,title:"4.2. ä»ä¹æ¯ä¸­å°",slug:"_4-2-ä»ä¹æ¯ä¸­å°",normalizedTitle:"4.2. ä»ä¹æ¯ä¸­å°",charIndex:4334},{level:3,title:"4.3. æ°å­åè½¬åä¸­å°",slug:"_4-3-æ°å­åè½¬åä¸­å°",normalizedTitle:"4.3. æ°å­åè½¬åä¸­å°",charIndex:4598},{level:3,title:"4.4. åä¸­åå°åå",slug:"_4-4-åä¸­åå°åå",normalizedTitle:"4.4. åä¸­åå°åå",charIndex:4615},{level:4,title:"4.4.1. åå°",slug:"_4-4-1-åå°",normalizedTitle:"4.4.1. åå°",charIndex:4630},{level:4,title:"4.4.2. ä¸­å°",slug:"_4-4-2-ä¸­å°",normalizedTitle:"4.4.2. ä¸­å°",charIndex:4774},{level:4,title:"4.4.3. åå°",slug:"_4-4-3-åå°",normalizedTitle:"4.4.3. åå°",charIndex:5308},{level:3,title:"4.5. DDDãä¸­å°åå¾®æå¡çåä½",slug:"_4-5-dddãä¸­å°åå¾®æå¡çåä½",normalizedTitle:"4.5. dddãä¸­å°åå¾®æå¡çåä½",charIndex:5421},{level:3,title:"4.6. å¦ä½æå»ºä¸­å°",slug:"_4-6-å¦ä½æå»ºä¸­å°",normalizedTitle:"4.6. å¦ä½æå»ºä¸­å°",charIndex:5521},{level:4,title:"4.6.1. èªé¡¶åä¸ç­ç¥",slug:"_4-6-1-èªé¡¶åä¸ç­ç¥",normalizedTitle:"4.6.1. èªé¡¶åä¸ç­ç¥",charIndex:5536},{level:4,title:"4.6.2. èªé¡¶åä¸ç­ç¥",slug:"_4-6-2-èªé¡¶åä¸ç­ç¥",normalizedTitle:"4.6.2. èªé¡¶åä¸ç­ç¥",charIndex:5664},{level:4,title:"4.6.3. æå»ºæ­¥éª¤",slug:"_4-6-3-æå»ºæ­¥éª¤",normalizedTitle:"4.6.3. æå»ºæ­¥éª¤",charIndex:5830},{level:2,title:"5. è¾¹ç",slug:"_5-è¾¹ç",normalizedTitle:"5. è¾¹ç",charIndex:5915},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:6203}],headersStr:"1. DDD ç®ä» 1.1. è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿ 1.2. ä»ä¹æ¯ DDD 1.3. DDD ä¸å¾®æå¡çå³ç³» 2. DDD æ ¸å¿æ¦å¿µ 2.1. å 2.2. éç¨è¯­è¨åä¸ä¸æè¾¹ç 2.3. å®ä½åå¼å¯¹è±¡ 2.4. èååèåè· 2.4.1. èåè®¾è®¡æ­¥éª¤ 2.4.2. èåè®¾è®¡åå 3. æ¶ææ¨¡å 3.1. DDD æ¶æ 3.2. æ´æ´æ¶æ 3.3. å­è¾¹å½¢æ¶æ 3.4. ä¸ç§æ¶æå¯¹æ¯ 3.4.1. æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³» 3.4.2. ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å 3.4.3. å¾®æå¡è¦æåççæ¶æåå± 3.4.4. åºç¨åèµæºçè§£è¦ä¸éé 4. ä¸­å°æç¥ 4.1. å¹³å°ä¸æ¯ä¸­å° 4.2. ä»ä¹æ¯ä¸­å° 4.3. æ°å­åè½¬åä¸­å° 4.4. åä¸­åå°åå 4.4.1. åå° 4.4.2. ä¸­å° 4.4.3. åå° 4.5. DDDãä¸­å°åå¾®æå¡çåä½ 4.6. å¦ä½æå»ºä¸­å° 4.6.1. èªé¡¶åä¸ç­ç¥ 4.6.2. èªé¡¶åä¸ç­ç¥ 4.6.3. æå»ºæ­¥éª¤ 5. è¾¹ç 6. åèèµæ",content:"# é¢åé©±å¨è®¾è®¡\n\n\n# 1. DDD ç®ä»\n\n\n# 1.1. è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿\n\n**ç¬¬ä¸é¶æ®µæ¯åæºæ¶æï¼**éç¨é¢åè¿ç¨çè®¾è®¡æ¹æ³ï¼ç³»ç»åæ¬å®¢æ·ç«¯ UI å±åæ°æ®åºä¸¤å±ï¼éç¨ C/S æ¶ææ¨¡å¼ï¼æ´ä¸ªç³»ç»å´ç»æ°æ®åºé©±å¨è®¾è®¡åå¼åï¼å¹¶ä¸æ»æ¯ä»è®¾è®¡æ°æ®åºåå­æ®µå¼å§ã\n\n**ç¬¬äºé¶æ®µæ¯éä¸­å¼æ¶æï¼**éç¨é¢åå¯¹è±¡çè®¾è®¡æ¹æ³ï¼ç³»ç»åæ¬ä¸å¡æ¥å¥å±ãä¸å¡é»è¾å±åæ°æ®åºå±ï¼éç¨ç»å¸çä¸å±æ¶æï¼ä¹æé¨ååºç¨éç¨ä¼ ç»ç SOA æ¶æãè¿ç§æ¶æå®¹æä½¿ç³»ç»åå¾èè¿ï¼å¯æ©å±æ§åå¼¹æ§ä¼¸ç¼©æ§å·®ã\n\n**ç¬¬ä¸é¶æ®µæ¯åå¸å¼å¾®æå¡æ¶æï¼**éçå¾®æå¡æ¶æçå¿µçæåºï¼éä¸­å¼æ¶ææ­£ååå¸å¼å¾®æå¡æ¶ææ¼è¿ãå¾®æå¡æ¶æå¯ä»¥å¾å¥½å°å®ç°åºç¨ä¹é´çè§£è¦ï¼è§£å³åä½åºç¨æ©å±æ§åå¼¹æ§ä¼¸ç¼©è½åä¸è¶³çé®é¢ã\n\nå¨åæºåéä¸­å¼æ¶ææ¶ä»£ï¼ç³»ç»åæãè®¾è®¡åå¼åå¾å¾æ¯ç¬ç«ãåé¶æ®µå²è£è¿è¡çã\n\n\n# 1.2. ä»ä¹æ¯ DDD\n\nDDD æ¯ä¸ç§å¤çé«åº¦å¤æé¢åçè®¾è®¡ææ³ï¼å®è¯å¾åç¦»ææ¯å®ç°çå¤ææ§ï¼å¹¶å´ç»ä¸å¡æ¦å¿µæå»ºé¢åæ¨¡åæ¥æ§å¶ä¸å¡çå¤ææ§ï¼ä»¥è§£å³è½¯ä»¶é¾ä»¥çè§£ï¼é¾ä»¥æ¼è¿çé®é¢ãDDD ä¸æ¯æ¶æï¼èæ¯ä¸ç§æ¶æè®¾è®¡æ¹æ³è®ºï¼å®éè¿è¾¹çååå°å¤æä¸å¡é¢åç®ååï¼å¸®æä»¬è®¾è®¡åºæ¸æ°çé¢åååºç¨è¾¹çï¼å¯ä»¥å¾å®¹æå°å®ç°æ¶ææ¼è¿ãDDD åä¸ºä¸¤ä¸ªæç»´å±é¢ï¼\n\n * æç¥è®¾è®¡ä¸»è¦ä»ä¸å¡è§è§åºåï¼å»ºç«ä¸å¡é¢åæ¨¡åï¼ååé¢åè¾¹çï¼å»ºç«éç¨è¯­è¨çä¸ä¸æè¾¹çï¼ä¸ä¸æè¾¹çå¯ä»¥ä½ä¸ºå¾®æå¡è®¾è®¡çåèè¾¹çã\n * ææ¯è®¾è®¡åä»ææ¯è§è§åºåï¼ä¾§éäºé¢åæ¨¡åçææ¯å®ç°ï¼å®æè½¯ä»¶å¼ååè½å°ï¼åæ¬ï¼èåæ ¹ãå®ä½ãå¼å¯¹è±¡ãé¢åæå¡ãåºç¨æå¡åèµæºåºç­ä»£ç é»è¾çè®¾è®¡åå®ç°ã\n\n\n# 1.3. DDD ä¸å¾®æå¡çå³ç³»\n\nDDD æ¯ä¸ç§æ¶æè®¾è®¡æ¹æ³ï¼å¾®æå¡æ¯ä¸ç§æ¶æé£æ ¼ãä¸¤èé½æ¯ä¸ºäºæè§£ä¸å¡å¤æåº¦ï¼åçååé¢åè¾¹çï¼æç»­è°æ´ç°ææ¶æï¼ä¼åç°æä»£ç ï¼ä»¥ä¿ææ¶æåä»£ç ççå½åï¼ä¹å°±æ¯æä»¬å¸¸è¯´çæ¼è¿å¼æ¶æã\n\nDDD ä¸»è¦å³æ³¨ï¼ä»ä¸å¡é¢åè§è§ååé¢åè¾¹çï¼æå»ºéç¨è¯­è¨è¿è¡é«ææ²éï¼éè¿ä¸å¡æ½è±¡ï¼å»ºç«é¢åæ¨¡åï¼ç»´æä¸å¡åä»£ç çé»è¾ä¸è´æ§ã\n\nå¾®æå¡ä¸»è¦å³æ³¨ï¼è¿è¡æ¶çè¿ç¨é´éä¿¡ãå®¹éåæééç¦»ï¼å®ç°å»ä¸­å¿åæ°æ®ç®¡çåå»ä¸­å¿åæå¡æ²»çï¼å³æ³¨å¾®æå¡çç¬ç«å¼åãæµè¯ãæå»ºåé¨ç½²ã\n\n\n# 2. DDD æ ¸å¿æ¦å¿µ\n\n\n\n\n# 2.1. å\n\n * é¢åï¼é¢åå·ä½æä¸ç§ç¹å®çèå´ãé¢åæ¯ç¨æ¥éå®ä¸å¡è¾¹ççï¼é£ä¹å°±ä¼æå¤§å°ä¹åï¼é¢åè¶å¤§ï¼ä¸å¡èå´å°±è¶å¤§ï¼åä¹åç¸åã\n * å­åï¼é¢åå¯ä»¥è¿ä¸æ­¥ååä¸ºå­é¢åãæä»¬æåååºæ¥çå¤ä¸ªå­é¢åç§°ä¸ºå­åï¼æ¯ä¸ªå­åå¯¹åºä¸ä¸ªæ´å°çé®é¢åææ´å°çä¸å¡èå´ã\n * æ ¸å¿åï¼å³å®äº§ååå¬å¸æ ¸å¿ç«äºåçå­åæ¯æ ¸å¿åã\n * éç¨åï¼åæ¶è¢«å¤ä¸ªå­åä½¿ç¨çéç¨åè½å­åæ¯éç¨åã\n * æ¯æåï¼è¿æä¸ç§åè½å­åæ¯å¿éçï¼ä½æ¢éæ ¸å¿åä¹ééç¨åï¼å®å°±æ¯æ¯æåã\n\n> é¢åçæ ¸å¿ææ³å°±æ¯å°é®é¢åéçº§ç»åï¼æ¥éä½ä¸å¡çè§£åç³»ç»å®ç°çå¤æåº¦ãéè¿é¢åç»åï¼éæ­¥ç¼©å°å¾®æå¡éè¦è§£å³çé®é¢åï¼æå»ºåéçé¢åæ¨¡åï¼èé¢åæ¨¡åæ å°æç³»ç»å°±æ¯å¾®æå¡äºã\n> \n> æ ¸å¿åãæ¯æååéç¨åçä¸»è¦ç®æ æ¯ï¼éè¿é¢åååï¼åºåä¸åå­åå¨å¬å¸åçä¸ååè½å±æ§åéè¦æ§ï¼ä»èå¬å¸å¯å¯¹ä¸åå­åéåä¸åçèµæºæå¥åå»ºè®¾ç­ç¥ï¼å¶å³æ³¨åº¦ä¹ä¼ä¸ä¸æ ·ã\n\n\n# 2.2. éç¨è¯­è¨åä¸ä¸æè¾¹ç\n\néç¨è¯­è¨ï¼éè¿å¢éäº¤æµè¾¾æå±è¯æ§çï¼è½å¤ç®åãæ¸æ°ãåç¡®æè¿°ä¸å¡æ¶µä¹åè§åçè¯­è¨ã\n\nä¸ä¸æè¾¹çï¼éçå°±æ¯é¢åçè¾¹çï¼èä¸ä¸æåæ¯è¯­ä¹ç¯å¢ãéè¿é¢åçä¸ä¸æè¾¹çï¼æä»¬å°±å¯ä»¥å¨ç»ä¸çé¢åè¾¹çåç¨ç»ä¸çè¯­è¨è¿è¡äº¤æµãç»¼åä¸ä¸ï¼ä¸ä¸æè¾¹ççå®ä¹å°±æ¯ï¼ç¨æ¥å°è£éç¨è¯­è¨åé¢åå¯¹è±¡ï¼æä¾ä¸ä¸æç¯å¢ï¼ä¿è¯å¨é¢åä¹åçä¸äºæ¯è¯­ãä¸å¡ç¸å³å¯¹è±¡ç­ï¼éç¨è¯­è¨ï¼æä¸ä¸ªç¡®åçå«ä¹ï¼æ²¡æäºä¹æ§ãè¿ä¸ªè¾¹çå®ä¹äºæ¨¡åçéç¨èå´ï¼ä½¿å¢éæææåè½å¤æç¡®å°ç¥éä»ä¹åºè¯¥å¨æ¨¡åä¸­å®ç°ï¼ä»ä¹ä¸åºè¯¥å¨æ¨¡åä¸­å®ç°ã\n\n\n# 2.3. å®ä½åå¼å¯¹è±¡\n\nå®ä½æ¯å¤ä¸ªå±æ§ãæä½æè¡ä¸ºçè½½ä½ãå¨äºä»¶é£æ´ä¸­ï¼æä»¬å¯ä»¥æ ¹æ®å½ä»¤ãæä½æèäºä»¶ï¼æ¾åºäº§çè¿äºè¡ä¸ºçä¸å¡å®ä½å¯¹è±¡ï¼è¿èæç§ä¸å®çä¸å¡è§åå°ä¾å­åº¦é«åä¸å¡å³èç´§å¯çå¤ä¸ªå®ä½å¯¹è±¡åå¼å¯¹è±¡è¿è¡èç±»ï¼å½¢æèåãä½ å¯ä»¥è¿ä¹çè§£ï¼å®ä½åå¼å¯¹è±¡æ¯ç»æé¢åæ¨¡åçåºç¡ååã\n\næ¬è´¨ä¸ï¼å®ä½æ¯çå¾å°ãæ¸å¾ççå®å®å¨å¨çä¸å¡å¯¹è±¡ï¼å®ä½å·æä¸å¡å±æ§ãä¸å¡è¡ä¸ºåä¸å¡é»è¾ãèå¼å¯¹è±¡åªæ¯è¥å¹²ä¸ªå±æ§çéåï¼åªææ°æ®åå§åæä½åæéçä¸æ¶åä¿®æ¹æ°æ®çè¡ä¸ºï¼åºæ¬ä¸åå«ä¸å¡é»è¾ãå¼å¯¹è±¡çå±æ§éè½ç¶å¨ç©çä¸ç¬ç«åºæ¥äºï¼ä½å¨é»è¾ä¸å®ä»ç¶æ¯å®ä½å±æ§çä¸é¨åï¼ç¨äºæè¿°å®ä½çç¹å¾ã\n\n\n# 2.4. èååèåè·\n\né¢åæ¨¡ååçå®ä½åå¼å¯¹è±¡å°±å¥½æ¯ä¸ªä½ï¼èè½è®©å®ä½åå¼å¯¹è±¡ååå·¥ä½çç»ç»å°±æ¯èåï¼å®ç¨æ¥ç¡®ä¿è¿äºé¢åå¯¹è±¡å¨å®ç°å±åçä¸å¡é»è¾æ¶ï¼è½ä¿è¯æ°æ®çä¸è´æ§ã\n\nèåå°±æ¯ç±ä¸å¡åé»è¾ç´§å¯å³èçå®ä½åå¼å¯¹è±¡ç»åèæçï¼èåæ¯æ°æ®ä¿®æ¹åæä¹åçåºæ¬ååï¼æ¯ä¸ä¸ªèåå¯¹åºä¸ä¸ªä»å¨ï¼å®ç°æ°æ®çæä¹åãèåæä¸ä¸ªèåæ ¹åä¸ä¸æè¾¹çï¼è¿ä¸ªè¾¹çæ ¹æ®ä¸å¡åä¸èè´£åé«åèååï¼å®ä¹äºèååé¨åºè¯¥åå«åªäºå®ä½åå¼å¯¹è±¡ï¼èèåä¹é´çè¾¹çæ¯æ¾è¦åçã\n\nèåæ ¹çä¸»è¦ç®çæ¯ä¸ºäºé¿åç±äºå¤ææ°æ®æ¨¡åç¼ºå°ç»ä¸çä¸å¡è§åæ§å¶ï¼èå¯¼è´èåãå®ä½ä¹é´æ°æ®ä¸ä¸è´æ§çé®é¢ãå¦ææèåæ¯ä½ç»ç»ï¼é£èåæ ¹å°±æ¯è¿ä¸ªç»ç»çè´è´£äººãèåæ ¹ä¹ç§°ä¸ºæ ¹å®ä½ï¼å®ä¸ä»æ¯å®ä½ï¼è¿æ¯èåçç®¡çèã\n\n\n\n# 2.4.1. èåè®¾è®¡æ­¥éª¤\n\n * ç¬¬ 1 æ­¥ï¼éç¨äºä»¶é£æ´ï¼æ ¹æ®ä¸å¡è¡ä¸ºï¼æ¢³çåºææçå®ä½åå¼å¯¹è±¡ã\n * ç¬¬ 2 æ­¥ï¼ä»ä¼å¤å®ä½ä¸­éåºéåä½ä¸ºå¯¹è±¡ç®¡çèçæ ¹å®ä½ï¼ä¹å°±æ¯èåæ ¹ãå¤æ­ä¸ä¸ªå®ä½ æ¯å¦æ¯èåæ ¹ï¼ä½ å¯ä»¥ç»åä»¥ä¸åºæ¯åæï¼æ¯å¦æç¬ç«ççå½å¨æï¼æ¯å¦æå¨å±å¯ä¸ IDï¼ æ¯å¦å¯ä»¥åå»ºæä¿®æ¹å¶å®å¯¹è±¡ï¼æ¯å¦æä¸é¨çæ¨¡åæ¥ç®¡è¿ä¸ªå®ä½ã\n * ç¬¬ 3 æ­¥ï¼æ ¹æ®ä¸å¡åä¸èè´£åé«åèååï¼æ¾åºä¸èåæ ¹å³èçææç´§å¯ä¾èµçå®ä½åå¼ å¯¹è±¡ã\n * ç¬¬ 4 æ­¥ï¼å¨èååæ ¹æ®èåæ ¹ãå®ä½åå¼å¯¹è±¡çä¾èµå³ç³»ï¼ç»åºå¯¹è±¡çå¼ç¨åä¾èµæ¨¡åã\n * ç¬¬ 5 æ­¥ï¼å¤ä¸ªèåæ ¹æ®ä¸å¡è¯­ä¹åä¸ä¸æä¸èµ·ååå°åä¸ä¸ªéçä¸ä¸æåã\n\n# 2.4.2. èåè®¾è®¡åå\n\n * å¨ä¸è´æ§è¾¹çåå»ºæ¨¡çæ­£çä¸åæ¡ä»¶ã\n * è®¾è®¡å°èåã\n * éè¿å¯ä¸æ è¯å¼ç¨å¶å®èåã\n * å¨è¾¹çä¹å¤ä½¿ç¨æç»ä¸è´æ§ã\n * éè¿åºç¨å±å®ç°è·¨èåçæå¡è°ç¨ã\n\n\n# 3. æ¶ææ¨¡å\n\n\n# 3.1. DDD æ¶æ\n\n\n\nä¸å±æ¶æå DDD åå±æ¶ææ¼è¿ï¼ä¸»è¦åçå¨ä¸å¡é»è¾å±åæ°æ®è®¿é®å±ã\n\nDDD åå±æ¶æåå«ç¨æ·æ¥å£å±ãåºç¨å±ãé¢åå±ååºç¡å±ãéè¿è¿äºå±æ¬¡ååï¼æä»¬å¯ä»¥æç¡®å¾®æå¡åå±çèè½ï¼åå®åé¢åå¯¹è±¡çè¾¹çï¼ç¡®å®åé¢åå¯¹è±¡çåä½æ¹å¼ã\n\n\n# 3.2. æ´æ´æ¶æ\n\nå¨æ´æ´æ¶æéï¼åå¿åä»£è¡¨åºç¨è½¯ä»¶çä¸åé¨åï¼ä»éå°å¤ä¾æ¬¡æ¯é¢åæ¨¡åãé¢åæå¡ãåºç¨æå¡åæå¤å´çå®¹æååçåå®¹ï¼æ¯å¦ç¨æ·çé¢ååºç¡è®¾æ½ã\n\næ´æ´æ¶ææä¸»è¦çååæ¯ä¾èµååï¼å®å®ä¹äºåå±çä¾èµå³ç³»ï¼è¶å¾éä¾èµè¶ä½ï¼ä»£ç çº§å«è¶é«ï¼è¶æ¯æ ¸å¿è½åãå¤åä»£ç ä¾èµåªè½æåååï¼ååä¸éè¦ç¥éå¤åçä»»ä½æåµã\n\n\n\n\n# 3.3. å­è¾¹å½¢æ¶æ\n\nå­è¾¹å½¢æ¶æçæ ¸å¿çå¿µæ¯ï¼åºç¨æ¯éè¿ç«¯å£ä¸å¤é¨è¿è¡äº¤äºçãææ³è¿ä¹æ¯å¾®æå¡æ¶æä¸ API ç½å³çè¡çä¸»è¦åå å§ã\n\nä¹å°±æ¯è¯´ï¼å¨ä¸å¾çå­è¾¹å½¢æ¶æä¸­ï¼çº¢ååçæ ¸å¿ä¸å¡é»è¾ï¼åºç¨ç¨åºåé¢åæ¨¡åï¼ä¸å¤é¨èµæºï¼åæ¬ APPãWeb åºç¨ä»¥åæ°æ®åºèµæºç­ï¼å®å¨éç¦»ï¼ä»éè¿ééå¨è¿è¡äº¤äºãå®è§£å³äºä¸å¡é»è¾ä¸ç¨æ·çé¢çä»£ç äº¤éé®é¢ï¼å¾å¥½å°å®ç°äºååç«¯åç¦»ãå­è¾¹å½¢æ¶æåå±çä¾èµå³ç³»ä¸æ´æ´æ¶æä¸æ ·ï¼é½æ¯ç±å¤ååä¾èµã\n\nå­è¾¹å½¢æ¶æå°ç³»ç»åä¸ºåå­è¾¹å½¢åå¤å­è¾¹å½¢ä¸¤å±ï¼è¿ä¸¤å±çèè½ååå¦ä¸ï¼\n\nçº¢ååçå­è¾¹å½¢å®ç°åºç¨çæ ¸å¿ä¸å¡é»è¾ï¼\n\nå¤å­è¾¹å½¢å®æå¤é¨åºç¨ãé©±å¨ååºç¡èµæºç­çäº¤äºåè®¿é®ï¼å¯¹åç«¯åºç¨ä»¥ API ä¸»å¨ééçæ¹å¼æä¾æå¡ï¼å¯¹åºç¡èµæºä»¥ä¾èµåç½®è¢«å¨ééçæ¹å¼å®ç°èµæºè®¿é®ã\n\n\n# 3.4. ä¸ç§æ¶æå¯¹æ¯\n\nè¿ä¸ç§æ¶ææ¨¡åçè®¾è®¡ææ³æ­£æ¯å¾®æå¡æ¶æé«åèä½è¦åååçå®ç¾ä½ç°ã\n\n\n\n# 3.4.1. æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³»\n\nä¸­å°æ¬è´¨ä¸æ¯é¢åçå­åï¼å®å¯è½æ¯æ ¸å¿åï¼ä¹å¯è½æ¯éç¨åææ¯æåãéå¸¸å¤§å®¶è®¤ä¸ºé¿éçä¸­å°å¯¹åº DDD çéç¨åï¼å°éç¨çå¬å±è½åæ²æ·ä¸ºä¸­å°ï¼å¯¹å¤æä¾éç¨å±äº«æå¡ã\n\nDDDãä¸­å°ãå¾®æå¡è¿ä¸èä¹é´ä¼¼ä¹æ²¡ä»ä¹å³èï¼å®éä¸å®ä»¬çå³ç³»æ¯éå¸¸ç´§å¯çï¼ç»åå¨ä¸èµ·å¯ä»¥ä½ä¸º ä¸ä¸ªçè®ºä½ç³»ç¨äºä½ çä¸­å°åå¾®æå¡è®¾è®¡ã\n\n# 3.4.2. ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å\n\nä¸­å°éè¦ç«å¨å¨ä¼ä¸çé«åº¦èèè½åçå±äº«åå¤ç¨ã\n\nä¸­å°è®¾è®¡æ¶ï¼æä»¬éè¦å»ºç«ä¸­å°åææéçä¸ä¸æçé¢åæ¨¡åï¼DDD å»ºæ¨¡è¿ç¨ä¸­ä¼èèæ¶ææ¼è¿ååè½çéæ°ç»åãé¢åæ¨¡åå»ºç«çè¿ç¨ä¼å¯¹ä¸å¡ååºç¨è¿è¡æ¸æ°çé»è¾åç©çè¾¹çï¼å¾®æå¡ï¼ååãé¢åæ¨¡åçç»æä¼å½±åå°åç»­çç³»ç»æ¨¡åãæ¶ææ¨¡ååä»£ç æ¨¡åï¼æç»å½±åå°å¾®æå¡çæååé¡¹ç®è½å°ã\n\n# 3.4.3. å¾®æå¡è¦æåççæ¶æåå±\n\nå¾®æå¡è®¾è®¡è¦æåå±çè®¾è®¡ææ³ï¼è®©åå±åå¸å¶èï¼å»ºç«æ¾è¦åçå±é´å³ç³»ã\n\nä¸è¦æä¸é¢åæ å³çé»è¾æ¾å¨é¢åå±å®ç°ï¼ä¿è¯é¢åå±ççº¯æ´åé¢åé»è¾çç¨³å®ï¼é¿åæ±¡æé¢åæ¨¡åãä¹ä¸è¦æé¢åæ¨¡åçä¸å¡é»è¾æ¾å¨åºç¨å±ï¼è¿æ ·ä¼å¯¼è´åºç¨å±è¿äºåºå¤§ï¼æç»é¢åæ¨¡åä¼å¤±ç¦ã\n\n# 3.4.4. åºç¨åèµæºçè§£è¦ä¸éé\n\nä¼ ç»ä»¥æ°æ®ä¸ºä¸­å¿çè®¾è®¡æ¨¡å¼ï¼åºç¨ä¼å¯¹æ°æ®åºãç¼å­ãæä»¶ç³»ç»ç­åºç¡èµæºäº§çä¸¥éä¾èµã\n\næ­£æ¯ç±äºå®ä»¬ä¹é´çè¿ç§å¼ºä¾èµçå³ç³»ï¼æä»¬ä¸æ¦æ´æ¢åºç¡èµæºå°±ä¼å¯¹åºç¨äº§çå¾å¤§çå½±åï¼å æ­¤éè¦ä¸ºåºç¨åèµæºè§£è¦ã\n\n\n# 4. ä¸­å°æç¥\n\n\n# 4.1. å¹³å°ä¸æ¯ä¸­å°\n\nä¸­å°æºäºå¹³å°ï¼ä½å®çæç¥é«åº¦è¦æ¯å¹³å°é«å¾å¤ã\n\nå¹³å°åªæ¯å°é¨åéç¨çå¬å±è½åç¬ç«ä¸ºå±äº«å¹³å°ãè½ç¶å¯ä»¥éè¿ API æèæ°æ®å¯¹å¤æä¾å¬å±å±äº«æå¡ï¼è§£å³ç³»ç»éå¤å»ºè®¾çé®é¢ï¼ä½è¿ç±»å¹³å°å¹¶æ²¡æåä¼ä¸åçå¶å®å¹³å°æåºç¨ï¼å®ç°é¡µé¢ãä¸å¡æµç¨åæ°æ®ä»åç«¯å°åç«¯çå¨é¢èåï¼å¹¶ä¸æ²¡æå°æ ¸å¿ä¸å¡æå¡é¾è·¯ä½ä¸ºä¸ä¸ªæ´ä½æ¹æ¡èèï¼åå¹³å°ä»ç¶æ¯åç¦»ä¸ç¬ç«çã\n\nç®åççè§£å°±æ¯æä¼ ç»çååå°ä½ç³»ä¸­çåå°è¿è¡äºç»åãé¿éå·´å·´æåºäºå¤§ä¸­å°å°åå°çæç¥ãå°±æ¯å¼ºåä¸å¡åææ¯ä¸­å°ï¼æåç«¯çåºç¨åå¾æ´å°æ´çµæ´»ãå½ä¸­å°è¶å¼ºå¤§ï¼è½åå°±è¶å¼ºï¼è¶è½æ´å¥½çå¿«éååºåå°çä¸å¡éæ±ãæä¸ªæ¯å»ï¼å°±æ¯åå£¤è¶è¥æ²ï¼è¶éåçé¿ä¸åççç©ï¼æé å¥½ççæç³»ç»ã\n\n\n\n\n# 4.2. ä»ä¹æ¯ä¸­å°\n\nä¸­å°æ¯ä¸ä¸ªåºç¡ççå¿µåæ¶æï¼æä»¬è¦æææçåºç¡æå¡ç¨ä¸­å°çæè·¯å»ºè®¾ï¼è¿è¡èéï¼å±åæ¯æä¸ç«¯çä¸å¡ãä¸å¡ä¸­å°æ´å¤çæ¯æ¯æå¨çº¿ä¸å¡ï¼æ°æ®ä¸­å°æä¾äºåºç¡æ°æ®å¤çè½ååå¾å¤çæ°æ®äº§åç»ææä¸å¡æ¹å»ç¨ãä¸å¡ä¸­å°ãæ°æ®ä¸­å°ãç®æ³ä¸­å°ç­ç­ä¸èµ·æä¾å¯¹ä¸å±ä¸å¡çæ¯æã\n\nä¸­å°çå³é®è¯ï¼å±äº«ãèéãèåååæ°ãèéæ¯åå°ä»¥åä¸­å°ä¹é´çèéï¼èåæ¯åå°æµç¨åæ°æ®çèåï¼å¹¶ä»¥å±äº«çæ¹å¼æ¯æåç«¯ä¸çº¿ä¸å¡çåå±ååæ°ãå¶ä¸­æå³é®çæ¯å¿«éååºè½ååä¼ä¸çº§çæ ç¼èéåèåè½åï¼å°¤å¶æ¯å¯¹äºè·¨ä¸ç»è¥çè¶å¤§åä¼ä¸æ¥è¯´è³å³éè¦ã\n\n\n# 4.3. æ°å­åè½¬åä¸­å°\n\n\n# 4.4. åä¸­åå°åå\n\n# 4.4.1. åå°\n\nå¨åå°è®¾è®¡ä¸­æä»¬å¯ä»¥åé´å¾®åç«¯çè®¾è®¡ææ³ï¼å¨ä¼ä¸åä¸ä»å®ç°åç«¯è§£è¦åå¤ç¨ï¼è¿å¯ä»¥æ ¹æ®æ ¸å¿é¾è·¯åä¸å¡æµç¨ï¼éè¿å¯¹å¾®åç«¯é¡µé¢çå¨æç»ååæµç¨ç¼æï¼å®ç°åå°ä¸å¡çèåã\n\nåç«¯é¡µé¢å¯ä»¥å¾èªç¶å°èåå°ä¸åçç»ç«¯åæ¸ éåºç¨æ ¸å¿ä¸å¡é¾è·¯ä¸­ï¼å®ç°åç«¯é¡µé¢ãæµç¨ååè½å¤ç¨ã\n\n# 4.4.2. ä¸­å°\n\nä¸å¡ä¸­å°çå»ºè®¾å¯éç¨é¢åé©±å¨è®¾è®¡æ¹æ³ï¼éè¿é¢åå»ºæ¨¡ï¼å°å¯å¤ç¨çå¬å±è½åä»åä¸ªåä½å¥ç¦»ï¼æ²æ·å¹¶ç»åï¼éç¨å¾®æå¡æ¶ææ¨¡å¼ï¼å»ºè®¾æä¸ºå¯å±äº«çéç¨è½åä¸­å°ã\n\nåæ ·çï¼æä»¬å¯ä»¥å°æ ¸å¿è½åç¨å¾®æå¡æ¶ææ¨¡å¼ï¼å»ºè®¾æä¸ºå¯é¢åä¸åæ¸ éååºæ¯çå¯å¤ç¨çæ ¸å¿è½åä¸­å°ã ä¸å¡ä¸­å°ååå°ãç¬¬ä¸æ¹åå¶å®ä¸­å°æä¾ API æå¡ï¼å®ç°éç¨è½ååæ ¸å¿è½åçå¤ç¨ã\n\næ°æ®ä¸­å°çä¸»è¦ç®æ æ¯æéæ°æ®å­¤å²ï¼å®ç°ä¸å¡èåååæ°ï¼åæ¬ä¸å¤§ä¸»è¦èè½ï¼\n\n * ä¸æ¯å®æä¼ä¸å¨åæ°æ®çééä¸å­å¨ï¼å®ç°åä¸åä¸å¡ç±»å«ä¸­å°æ°æ®çæ±æ»åéä¸­ç®¡çã\n * äºæ¯æç§æ åçæ°æ®è§èææ°æ®æ¨¡åï¼å°æ°æ®æç§ä¸åä¸»é¢åæåºæ¯è¿è¡å å·¥åå¤çï¼å½¢æé¢åä¸åä¸»é¢ååºæ¯çæ°æ®åºç¨ï¼æ¯å¦å®¢æ·è§å¾ãä»£çäººè§å¾ãæ¸ éè§å¾ãæºæè§å¾ç­ä¸åæ°æ®ä½ç³»ã\n * ä¸æ¯å»ºç«ä¸å¡éæ±é©±å¨çæ°æ®ä½ç³»ï¼åºäºåä¸ªç»´åº¦çæ°æ®ï¼æ·±åº¦èåæ°æ®ä»·å¼ï¼æ¯æä¸å¡ååä¸æ¨¡å¼çåæ°ã\n\nç¸åºçï¼æ°æ®ä¸­å°çå»ºè®¾å°±å¯åä¸ºä¸æ­¥èµ°ï¼\n\n * ç¬¬ä¸æ­¥å®ç°åä¸­å°ä¸å¡æ°æ®çæ±éï¼è§£å³æ°æ®å­¤å²ååçº§æ°æ®å±äº«é®é¢ã\n * ç¬¬äºæ­¥å®ç°ä¼ä¸çº§å®æ¶æéå®æ¶å¨ç»´åº¦æ°æ®çæ·±åº¦èåãå å·¥åå±äº«ã\n * ç¬¬ä¸æ­¥èåæ°æ®ä»·å¼ï¼æ¯æä¸å¡åæ°ï¼å éä»æ°æ®è½¬æ¢ä¸ºä¸å¡ä»·å¼çè¿ç¨ã\n\n# 4.4.3. åå°\n\nåå°ä¸»è¦é¢åå®¢æ·ä»¥åç»ç«¯éå®èï¼å®ç°è¥éæ¨å¹¿ä»¥åäº¤æè½¬åï¼ä¸­å°ä¸»è¦é¢åè¿è¥äººåï¼å®æè¿è¥æ¯æï¼åå°ä¸»è¦é¢ååå°ç®¡çäººåï¼å®ç°æµç¨å®¡æ ¸ãåé¨ç®¡çä»¥ååå¤æ¯æï¼æ¯å¦éè´­ãäººåãè´¢å¡å OA ç­ç³»ç»ã\n\n\n# 4.5. DDDãä¸­å°åå¾®æå¡çåä½\n\nä¼ ç»ä¼ä¸å¯ä»¥å°éè¦å±äº«çå¬å±è½åè¿è¡é¢åå»ºæ¨¡ï¼å»ºè®¾å¯å±äº«çéç¨ä¸­å°ãé¤æ­¤ä¹å¤ï¼ä¼ ç»ä¼ä¸è¿ä¼å°æ ¸å¿è½åè¿è¡é¢åå»ºæ¨¡ï¼å»ºè®¾é¢åä¸åæ¸ éçå¯å¤ç¨çæ ¸å¿ä¸­å°ã\n\n\n# 4.6. å¦ä½æå»ºä¸­å°\n\n# 4.6.1. èªé¡¶åä¸ç­ç¥\n\nèªé¡¶åä¸çç­ç¥éç¨äºå¨æ°çåºç¨ç³»ç»å»ºè®¾ï¼ææ§ç³»ç»æ¨åéå»ºçæåµãè¿ç§ç­ç¥æ¯ååé¡¶å±è®¾è®¡ï¼ä»æé«é¢åéçº§åè§£ä¸ºä¸­å°ï¼åå«å»ºç«é¢åæ¨¡åï¼æ ¹æ®ä¸å¡å±æ§åä¸ºéç¨ä¸­å°ææ ¸å¿ä¸­å°ãé¢åå»ºæ¨¡è¿ç¨ä¸»è¦åºäºä¸å¡ç°ç¶ï¼ææ¶ä¸èèç³»ç»ç°ç¶ã\n\n# 4.6.2. èªé¡¶åä¸ç­ç¥\n\nèªåºåä¸ç­ç¥éç¨äºéçç³»ç»ä¸å¡æ¨¡åçæ¼è¿å¼éæãè¿ç§ç­ç¥æ¯åºäºä¸å¡åç³»ç»ç°ç¶å®æé¢åå»ºæ¨¡ãé¦ååå«å®æç³»ç»æå¨ä¸å¡åçé¢åå»ºæ¨¡ï¼ç¶åå¯¹é½ä¸å¡åï¼æ¾åºå·æåç±»æç¸ä¼¼ä¸å¡åè½çé¢åæ¨¡åï¼å¯¹æ¯åæé¢åæ¨¡åçå·®å¼ï¼éç»é¢åå¯¹è±¡ï¼éæé¢åæ¨¡åãè¿ä¸ªè¿ç¨ä¼æ²æ·å¬å±åå¤ç¨çä¸å¡è½åï¼ä¼å°åæ£çä¸å¡æ¨¡åæ´åã\n\n# 4.6.3. æå»ºæ­¥éª¤\n\nç¬¬ä¸æ­¥ï¼éå®ç³»ç»æå¨ä¸å¡åï¼æå»ºé¢åæ¨¡åã\n\n\n\nç¬¬äºæ­¥ï¼å¯¹é½ä¸å¡åï¼æå»ºä¸­å°ä¸å¡æ¨¡åã\n\nç¬¬ä¸æ­¥ï¼ä¸­å°å½ç±»ï¼æ ¹æ®é¢åæ¨¡åè®¾è®¡å¾®æå¡ã\n\n\n# 5. è¾¹ç\n\né»è¾è¾¹çï¼å¾®æå¡åèåä¹é´çè¾¹çæ¯é»è¾è¾¹çãå®æ¯ä¸ä¸ªèæçè¾¹çï¼å¼ºè°ä¸å¡çåèï¼å¯æ ¹æ®éè¦åæç©çè¾¹çï¼ä¹å°±æ¯è¯´èåä¹å¯ä»¥ç¬ç«ä¸ºå¾®æå¡ã\n\nç©çè¾¹çï¼å¾®æå¡ä¹é´çè¾¹çæ¯ç©çè¾¹çãå®å¼ºè°å¾®æå¡é¨ç½²åè¿è¡çéç¦»ï¼å³æ³¨å¾®æå¡çæå¡è°ç¨ãå®¹éåè¿è¡ç­ã\n\nä»£ç è¾¹çï¼ä¸åå±æèèåä¹é´ä»£ç ç®å½çè¾¹çæ¯ä»£ç è¾¹çãå®å¼ºè°çæ¯ä»£ç ä¹é´çéç¦»ï¼æ¹ä¾¿æ¶ææ¼è¿æ¶ä»£ç çéç»ã\n\néè¿ä»¥ä¸è¾¹çï¼æä»¬å¯ä»¥è®©ä¸å¡è½åé«åèãä»£ç æ¾è¦åï¼ä¸æ¸æ°çè¾¹çï¼å¯ä»¥å¿«éå®ç°å¾®æå¡ä»£ç çæååç»åï¼è½»æ¾å®ç°å¾®æå¡æ¶ææ¼è¿ãä½æä¸ç¹ä¸å®è¦æ ¼å¤æ³¨æï¼è¾¹çæ¸æ°çå¾®æå¡ï¼ä¸æ¯å¤§åä½åå°åä½çæ¼è¿ã\n\n\n# 6. åèèµæ\n\n * DDD å®æè¯¾",normalizedContent:"# é¢åé©±å¨è®¾è®¡\n\n\n# 1. ddd ç®ä»\n\n\n# 1.1. è½¯ä»¶æ¶ææ¨¡å¼çæ¼è¿\n\n**ç¬¬ä¸é¶æ®µæ¯åæºæ¶æï¼**éç¨é¢åè¿ç¨çè®¾è®¡æ¹æ³ï¼ç³»ç»åæ¬å®¢æ·ç«¯ ui å±åæ°æ®åºä¸¤å±ï¼éç¨ c/s æ¶ææ¨¡å¼ï¼æ´ä¸ªç³»ç»å´ç»æ°æ®åºé©±å¨è®¾è®¡åå¼åï¼å¹¶ä¸æ»æ¯ä»è®¾è®¡æ°æ®åºåå­æ®µå¼å§ã\n\n**ç¬¬äºé¶æ®µæ¯éä¸­å¼æ¶æï¼**éç¨é¢åå¯¹è±¡çè®¾è®¡æ¹æ³ï¼ç³»ç»åæ¬ä¸å¡æ¥å¥å±ãä¸å¡é»è¾å±åæ°æ®åºå±ï¼éç¨ç»å¸çä¸å±æ¶æï¼ä¹æé¨ååºç¨éç¨ä¼ ç»ç soa æ¶æãè¿ç§æ¶æå®¹æä½¿ç³»ç»åå¾èè¿ï¼å¯æ©å±æ§åå¼¹æ§ä¼¸ç¼©æ§å·®ã\n\n**ç¬¬ä¸é¶æ®µæ¯åå¸å¼å¾®æå¡æ¶æï¼**éçå¾®æå¡æ¶æçå¿µçæåºï¼éä¸­å¼æ¶ææ­£ååå¸å¼å¾®æå¡æ¶ææ¼è¿ãå¾®æå¡æ¶æå¯ä»¥å¾å¥½å°å®ç°åºç¨ä¹é´çè§£è¦ï¼è§£å³åä½åºç¨æ©å±æ§åå¼¹æ§ä¼¸ç¼©è½åä¸è¶³çé®é¢ã\n\nå¨åæºåéä¸­å¼æ¶ææ¶ä»£ï¼ç³»ç»åæãè®¾è®¡åå¼åå¾å¾æ¯ç¬ç«ãåé¶æ®µå²è£è¿è¡çã\n\n\n# 1.2. ä»ä¹æ¯ ddd\n\nddd æ¯ä¸ç§å¤çé«åº¦å¤æé¢åçè®¾è®¡ææ³ï¼å®è¯å¾åç¦»ææ¯å®ç°çå¤ææ§ï¼å¹¶å´ç»ä¸å¡æ¦å¿µæå»ºé¢åæ¨¡åæ¥æ§å¶ä¸å¡çå¤ææ§ï¼ä»¥è§£å³è½¯ä»¶é¾ä»¥çè§£ï¼é¾ä»¥æ¼è¿çé®é¢ãddd ä¸æ¯æ¶æï¼èæ¯ä¸ç§æ¶æè®¾è®¡æ¹æ³è®ºï¼å®éè¿è¾¹çååå°å¤æä¸å¡é¢åç®ååï¼å¸®æä»¬è®¾è®¡åºæ¸æ°çé¢åååºç¨è¾¹çï¼å¯ä»¥å¾å®¹æå°å®ç°æ¶ææ¼è¿ãddd åä¸ºä¸¤ä¸ªæç»´å±é¢ï¼\n\n * æç¥è®¾è®¡ä¸»è¦ä»ä¸å¡è§è§åºåï¼å»ºç«ä¸å¡é¢åæ¨¡åï¼ååé¢åè¾¹çï¼å»ºç«éç¨è¯­è¨çä¸ä¸æè¾¹çï¼ä¸ä¸æè¾¹çå¯ä»¥ä½ä¸ºå¾®æå¡è®¾è®¡çåèè¾¹çã\n * ææ¯è®¾è®¡åä»ææ¯è§è§åºåï¼ä¾§éäºé¢åæ¨¡åçææ¯å®ç°ï¼å®æè½¯ä»¶å¼ååè½å°ï¼åæ¬ï¼èåæ ¹ãå®ä½ãå¼å¯¹è±¡ãé¢åæå¡ãåºç¨æå¡åèµæºåºç­ä»£ç é»è¾çè®¾è®¡åå®ç°ã\n\n\n# 1.3. ddd ä¸å¾®æå¡çå³ç³»\n\nddd æ¯ä¸ç§æ¶æè®¾è®¡æ¹æ³ï¼å¾®æå¡æ¯ä¸ç§æ¶æé£æ ¼ãä¸¤èé½æ¯ä¸ºäºæè§£ä¸å¡å¤æåº¦ï¼åçååé¢åè¾¹çï¼æç»­è°æ´ç°ææ¶æï¼ä¼åç°æä»£ç ï¼ä»¥ä¿ææ¶æåä»£ç ççå½åï¼ä¹å°±æ¯æä»¬å¸¸è¯´çæ¼è¿å¼æ¶æã\n\nddd ä¸»è¦å³æ³¨ï¼ä»ä¸å¡é¢åè§è§ååé¢åè¾¹çï¼æå»ºéç¨è¯­è¨è¿è¡é«ææ²éï¼éè¿ä¸å¡æ½è±¡ï¼å»ºç«é¢åæ¨¡åï¼ç»´æä¸å¡åä»£ç çé»è¾ä¸è´æ§ã\n\nå¾®æå¡ä¸»è¦å³æ³¨ï¼è¿è¡æ¶çè¿ç¨é´éä¿¡ãå®¹éåæééç¦»ï¼å®ç°å»ä¸­å¿åæ°æ®ç®¡çåå»ä¸­å¿åæå¡æ²»çï¼å³æ³¨å¾®æå¡çç¬ç«å¼åãæµè¯ãæå»ºåé¨ç½²ã\n\n\n# 2. ddd æ ¸å¿æ¦å¿µ\n\n\n\n\n# 2.1. å\n\n * é¢åï¼é¢åå·ä½æä¸ç§ç¹å®çèå´ãé¢åæ¯ç¨æ¥éå®ä¸å¡è¾¹ççï¼é£ä¹å°±ä¼æå¤§å°ä¹åï¼é¢åè¶å¤§ï¼ä¸å¡èå´å°±è¶å¤§ï¼åä¹åç¸åã\n * å­åï¼é¢åå¯ä»¥è¿ä¸æ­¥ååä¸ºå­é¢åãæä»¬æåååºæ¥çå¤ä¸ªå­é¢åç§°ä¸ºå­åï¼æ¯ä¸ªå­åå¯¹åºä¸ä¸ªæ´å°çé®é¢åææ´å°çä¸å¡èå´ã\n * æ ¸å¿åï¼å³å®äº§ååå¬å¸æ ¸å¿ç«äºåçå­åæ¯æ ¸å¿åã\n * éç¨åï¼åæ¶è¢«å¤ä¸ªå­åä½¿ç¨çéç¨åè½å­åæ¯éç¨åã\n * æ¯æåï¼è¿æä¸ç§åè½å­åæ¯å¿éçï¼ä½æ¢éæ ¸å¿åä¹ééç¨åï¼å®å°±æ¯æ¯æåã\n\n> é¢åçæ ¸å¿ææ³å°±æ¯å°é®é¢åéçº§ç»åï¼æ¥éä½ä¸å¡çè§£åç³»ç»å®ç°çå¤æåº¦ãéè¿é¢åç»åï¼éæ­¥ç¼©å°å¾®æå¡éè¦è§£å³çé®é¢åï¼æå»ºåéçé¢åæ¨¡åï¼èé¢åæ¨¡åæ å°æç³»ç»å°±æ¯å¾®æå¡äºã\n> \n> æ ¸å¿åãæ¯æååéç¨åçä¸»è¦ç®æ æ¯ï¼éè¿é¢åååï¼åºåä¸åå­åå¨å¬å¸åçä¸ååè½å±æ§åéè¦æ§ï¼ä»èå¬å¸å¯å¯¹ä¸åå­åéåä¸åçèµæºæå¥åå»ºè®¾ç­ç¥ï¼å¶å³æ³¨åº¦ä¹ä¼ä¸ä¸æ ·ã\n\n\n# 2.2. éç¨è¯­è¨åä¸ä¸æè¾¹ç\n\néç¨è¯­è¨ï¼éè¿å¢éäº¤æµè¾¾æå±è¯æ§çï¼è½å¤ç®åãæ¸æ°ãåç¡®æè¿°ä¸å¡æ¶µä¹åè§åçè¯­è¨ã\n\nä¸ä¸æè¾¹çï¼éçå°±æ¯é¢åçè¾¹çï¼èä¸ä¸æåæ¯è¯­ä¹ç¯å¢ãéè¿é¢åçä¸ä¸æè¾¹çï¼æä»¬å°±å¯ä»¥å¨ç»ä¸çé¢åè¾¹çåç¨ç»ä¸çè¯­è¨è¿è¡äº¤æµãç»¼åä¸ä¸ï¼ä¸ä¸æè¾¹ççå®ä¹å°±æ¯ï¼ç¨æ¥å°è£éç¨è¯­è¨åé¢åå¯¹è±¡ï¼æä¾ä¸ä¸æç¯å¢ï¼ä¿è¯å¨é¢åä¹åçä¸äºæ¯è¯­ãä¸å¡ç¸å³å¯¹è±¡ç­ï¼éç¨è¯­è¨ï¼æä¸ä¸ªç¡®åçå«ä¹ï¼æ²¡æäºä¹æ§ãè¿ä¸ªè¾¹çå®ä¹äºæ¨¡åçéç¨èå´ï¼ä½¿å¢éæææåè½å¤æç¡®å°ç¥éä»ä¹åºè¯¥å¨æ¨¡åä¸­å®ç°ï¼ä»ä¹ä¸åºè¯¥å¨æ¨¡åä¸­å®ç°ã\n\n\n# 2.3. å®ä½åå¼å¯¹è±¡\n\nå®ä½æ¯å¤ä¸ªå±æ§ãæä½æè¡ä¸ºçè½½ä½ãå¨äºä»¶é£æ´ä¸­ï¼æä»¬å¯ä»¥æ ¹æ®å½ä»¤ãæä½æèäºä»¶ï¼æ¾åºäº§çè¿äºè¡ä¸ºçä¸å¡å®ä½å¯¹è±¡ï¼è¿èæç§ä¸å®çä¸å¡è§åå°ä¾å­åº¦é«åä¸å¡å³èç´§å¯çå¤ä¸ªå®ä½å¯¹è±¡åå¼å¯¹è±¡è¿è¡èç±»ï¼å½¢æèåãä½ å¯ä»¥è¿ä¹çè§£ï¼å®ä½åå¼å¯¹è±¡æ¯ç»æé¢åæ¨¡åçåºç¡ååã\n\næ¬è´¨ä¸ï¼å®ä½æ¯çå¾å°ãæ¸å¾ççå®å®å¨å¨çä¸å¡å¯¹è±¡ï¼å®ä½å·æä¸å¡å±æ§ãä¸å¡è¡ä¸ºåä¸å¡é»è¾ãèå¼å¯¹è±¡åªæ¯è¥å¹²ä¸ªå±æ§çéåï¼åªææ°æ®åå§åæä½åæéçä¸æ¶åä¿®æ¹æ°æ®çè¡ä¸ºï¼åºæ¬ä¸åå«ä¸å¡é»è¾ãå¼å¯¹è±¡çå±æ§éè½ç¶å¨ç©çä¸ç¬ç«åºæ¥äºï¼ä½å¨é»è¾ä¸å®ä»ç¶æ¯å®ä½å±æ§çä¸é¨åï¼ç¨äºæè¿°å®ä½çç¹å¾ã\n\n\n# 2.4. èååèåè·\n\né¢åæ¨¡ååçå®ä½åå¼å¯¹è±¡å°±å¥½æ¯ä¸ªä½ï¼èè½è®©å®ä½åå¼å¯¹è±¡ååå·¥ä½çç»ç»å°±æ¯èåï¼å®ç¨æ¥ç¡®ä¿è¿äºé¢åå¯¹è±¡å¨å®ç°å±åçä¸å¡é»è¾æ¶ï¼è½ä¿è¯æ°æ®çä¸è´æ§ã\n\nèåå°±æ¯ç±ä¸å¡åé»è¾ç´§å¯å³èçå®ä½åå¼å¯¹è±¡ç»åèæçï¼èåæ¯æ°æ®ä¿®æ¹åæä¹åçåºæ¬ååï¼æ¯ä¸ä¸ªèåå¯¹åºä¸ä¸ªä»å¨ï¼å®ç°æ°æ®çæä¹åãèåæä¸ä¸ªèåæ ¹åä¸ä¸æè¾¹çï¼è¿ä¸ªè¾¹çæ ¹æ®ä¸å¡åä¸èè´£åé«åèååï¼å®ä¹äºèååé¨åºè¯¥åå«åªäºå®ä½åå¼å¯¹è±¡ï¼èèåä¹é´çè¾¹çæ¯æ¾è¦åçã\n\nèåæ ¹çä¸»è¦ç®çæ¯ä¸ºäºé¿åç±äºå¤ææ°æ®æ¨¡åç¼ºå°ç»ä¸çä¸å¡è§åæ§å¶ï¼èå¯¼è´èåãå®ä½ä¹é´æ°æ®ä¸ä¸è´æ§çé®é¢ãå¦ææèåæ¯ä½ç»ç»ï¼é£èåæ ¹å°±æ¯è¿ä¸ªç»ç»çè´è´£äººãèåæ ¹ä¹ç§°ä¸ºæ ¹å®ä½ï¼å®ä¸ä»æ¯å®ä½ï¼è¿æ¯èåçç®¡çèã\n\n\n\n# 2.4.1. èåè®¾è®¡æ­¥éª¤\n\n * ç¬¬ 1 æ­¥ï¼éç¨äºä»¶é£æ´ï¼æ ¹æ®ä¸å¡è¡ä¸ºï¼æ¢³çåºææçå®ä½åå¼å¯¹è±¡ã\n * ç¬¬ 2 æ­¥ï¼ä»ä¼å¤å®ä½ä¸­éåºéåä½ä¸ºå¯¹è±¡ç®¡çèçæ ¹å®ä½ï¼ä¹å°±æ¯èåæ ¹ãå¤æ­ä¸ä¸ªå®ä½ æ¯å¦æ¯èåæ ¹ï¼ä½ å¯ä»¥ç»åä»¥ä¸åºæ¯åæï¼æ¯å¦æç¬ç«ççå½å¨æï¼æ¯å¦æå¨å±å¯ä¸ idï¼ æ¯å¦å¯ä»¥åå»ºæä¿®æ¹å¶å®å¯¹è±¡ï¼æ¯å¦æä¸é¨çæ¨¡åæ¥ç®¡è¿ä¸ªå®ä½ã\n * ç¬¬ 3 æ­¥ï¼æ ¹æ®ä¸å¡åä¸èè´£åé«åèååï¼æ¾åºä¸èåæ ¹å³èçææç´§å¯ä¾èµçå®ä½åå¼ å¯¹è±¡ã\n * ç¬¬ 4 æ­¥ï¼å¨èååæ ¹æ®èåæ ¹ãå®ä½åå¼å¯¹è±¡çä¾èµå³ç³»ï¼ç»åºå¯¹è±¡çå¼ç¨åä¾èµæ¨¡åã\n * ç¬¬ 5 æ­¥ï¼å¤ä¸ªèåæ ¹æ®ä¸å¡è¯­ä¹åä¸ä¸æä¸èµ·ååå°åä¸ä¸ªéçä¸ä¸æåã\n\n# 2.4.2. èåè®¾è®¡åå\n\n * å¨ä¸è´æ§è¾¹çåå»ºæ¨¡çæ­£çä¸åæ¡ä»¶ã\n * è®¾è®¡å°èåã\n * éè¿å¯ä¸æ è¯å¼ç¨å¶å®èåã\n * å¨è¾¹çä¹å¤ä½¿ç¨æç»ä¸è´æ§ã\n * éè¿åºç¨å±å®ç°è·¨èåçæå¡è°ç¨ã\n\n\n# 3. æ¶ææ¨¡å\n\n\n# 3.1. ddd æ¶æ\n\n\n\nä¸å±æ¶æå ddd åå±æ¶ææ¼è¿ï¼ä¸»è¦åçå¨ä¸å¡é»è¾å±åæ°æ®è®¿é®å±ã\n\nddd åå±æ¶æåå«ç¨æ·æ¥å£å±ãåºç¨å±ãé¢åå±ååºç¡å±ãéè¿è¿äºå±æ¬¡ååï¼æä»¬å¯ä»¥æç¡®å¾®æå¡åå±çèè½ï¼åå®åé¢åå¯¹è±¡çè¾¹çï¼ç¡®å®åé¢åå¯¹è±¡çåä½æ¹å¼ã\n\n\n# 3.2. æ´æ´æ¶æ\n\nå¨æ´æ´æ¶æéï¼åå¿åä»£è¡¨åºç¨è½¯ä»¶çä¸åé¨åï¼ä»éå°å¤ä¾æ¬¡æ¯é¢åæ¨¡åãé¢åæå¡ãåºç¨æå¡åæå¤å´çå®¹æååçåå®¹ï¼æ¯å¦ç¨æ·çé¢ååºç¡è®¾æ½ã\n\næ´æ´æ¶ææä¸»è¦çååæ¯ä¾èµååï¼å®å®ä¹äºåå±çä¾èµå³ç³»ï¼è¶å¾éä¾èµè¶ä½ï¼ä»£ç çº§å«è¶é«ï¼è¶æ¯æ ¸å¿è½åãå¤åä»£ç ä¾èµåªè½æåååï¼ååä¸éè¦ç¥éå¤åçä»»ä½æåµã\n\n\n\n\n# 3.3. å­è¾¹å½¢æ¶æ\n\nå­è¾¹å½¢æ¶æçæ ¸å¿çå¿µæ¯ï¼åºç¨æ¯éè¿ç«¯å£ä¸å¤é¨è¿è¡äº¤äºçãææ³è¿ä¹æ¯å¾®æå¡æ¶æä¸ api ç½å³çè¡çä¸»è¦åå å§ã\n\nä¹å°±æ¯è¯´ï¼å¨ä¸å¾çå­è¾¹å½¢æ¶æä¸­ï¼çº¢ååçæ ¸å¿ä¸å¡é»è¾ï¼åºç¨ç¨åºåé¢åæ¨¡åï¼ä¸å¤é¨èµæºï¼åæ¬ appãweb åºç¨ä»¥åæ°æ®åºèµæºç­ï¼å®å¨éç¦»ï¼ä»éè¿ééå¨è¿è¡äº¤äºãå®è§£å³äºä¸å¡é»è¾ä¸ç¨æ·çé¢çä»£ç äº¤éé®é¢ï¼å¾å¥½å°å®ç°äºååç«¯åç¦»ãå­è¾¹å½¢æ¶æåå±çä¾èµå³ç³»ä¸æ´æ´æ¶æä¸æ ·ï¼é½æ¯ç±å¤ååä¾èµã\n\nå­è¾¹å½¢æ¶æå°ç³»ç»åä¸ºåå­è¾¹å½¢åå¤å­è¾¹å½¢ä¸¤å±ï¼è¿ä¸¤å±çèè½ååå¦ä¸ï¼\n\nçº¢ååçå­è¾¹å½¢å®ç°åºç¨çæ ¸å¿ä¸å¡é»è¾ï¼\n\nå¤å­è¾¹å½¢å®æå¤é¨åºç¨ãé©±å¨ååºç¡èµæºç­çäº¤äºåè®¿é®ï¼å¯¹åç«¯åºç¨ä»¥ api ä¸»å¨ééçæ¹å¼æä¾æå¡ï¼å¯¹åºç¡èµæºä»¥ä¾èµåç½®è¢«å¨ééçæ¹å¼å®ç°èµæºè®¿é®ã\n\n\n# 3.4. ä¸ç§æ¶æå¯¹æ¯\n\nè¿ä¸ç§æ¶ææ¨¡åçè®¾è®¡ææ³æ­£æ¯å¾®æå¡æ¶æé«åèä½è¦åååçå®ç¾ä½ç°ã\n\n\n\n# 3.4.1. æ¶ææ¨¡ååä¸­å°ãå¾®æå¡çèç³»\n\nä¸­å°æ¬è´¨ä¸æ¯é¢åçå­åï¼å®å¯è½æ¯æ ¸å¿åï¼ä¹å¯è½æ¯éç¨åææ¯æåãéå¸¸å¤§å®¶è®¤ä¸ºé¿éçä¸­å°å¯¹åº ddd çéç¨åï¼å°éç¨çå¬å±è½åæ²æ·ä¸ºä¸­å°ï¼å¯¹å¤æä¾éç¨å±äº«æå¡ã\n\ndddãä¸­å°ãå¾®æå¡è¿ä¸èä¹é´ä¼¼ä¹æ²¡ä»ä¹å³èï¼å®éä¸å®ä»¬çå³ç³»æ¯éå¸¸ç´§å¯çï¼ç»åå¨ä¸èµ·å¯ä»¥ä½ä¸º ä¸ä¸ªçè®ºä½ç³»ç¨äºä½ çä¸­å°åå¾®æå¡è®¾è®¡ã\n\n# 3.4.2. ä¸­å°å»ºè®¾è¦èç¦é¢åæ¨¡å\n\nä¸­å°éè¦ç«å¨å¨ä¼ä¸çé«åº¦èèè½åçå±äº«åå¤ç¨ã\n\nä¸­å°è®¾è®¡æ¶ï¼æä»¬éè¦å»ºç«ä¸­å°åææéçä¸ä¸æçé¢åæ¨¡åï¼ddd å»ºæ¨¡è¿ç¨ä¸­ä¼èèæ¶ææ¼è¿ååè½çéæ°ç»åãé¢åæ¨¡åå»ºç«çè¿ç¨ä¼å¯¹ä¸å¡ååºç¨è¿è¡æ¸æ°çé»è¾åç©çè¾¹çï¼å¾®æå¡ï¼ååãé¢åæ¨¡åçç»æä¼å½±åå°åç»­çç³»ç»æ¨¡åãæ¶ææ¨¡ååä»£ç æ¨¡åï¼æç»å½±åå°å¾®æå¡çæååé¡¹ç®è½å°ã\n\n# 3.4.3. å¾®æå¡è¦æåççæ¶æåå±\n\nå¾®æå¡è®¾è®¡è¦æåå±çè®¾è®¡ææ³ï¼è®©åå±åå¸å¶èï¼å»ºç«æ¾è¦åçå±é´å³ç³»ã\n\nä¸è¦æä¸é¢åæ å³çé»è¾æ¾å¨é¢åå±å®ç°ï¼ä¿è¯é¢åå±ççº¯æ´åé¢åé»è¾çç¨³å®ï¼é¿åæ±¡æé¢åæ¨¡åãä¹ä¸è¦æé¢åæ¨¡åçä¸å¡é»è¾æ¾å¨åºç¨å±ï¼è¿æ ·ä¼å¯¼è´åºç¨å±è¿äºåºå¤§ï¼æç»é¢åæ¨¡åä¼å¤±ç¦ã\n\n# 3.4.4. åºç¨åèµæºçè§£è¦ä¸éé\n\nä¼ ç»ä»¥æ°æ®ä¸ºä¸­å¿çè®¾è®¡æ¨¡å¼ï¼åºç¨ä¼å¯¹æ°æ®åºãç¼å­ãæä»¶ç³»ç»ç­åºç¡èµæºäº§çä¸¥éä¾èµã\n\næ­£æ¯ç±äºå®ä»¬ä¹é´çè¿ç§å¼ºä¾èµçå³ç³»ï¼æä»¬ä¸æ¦æ´æ¢åºç¡èµæºå°±ä¼å¯¹åºç¨äº§çå¾å¤§çå½±åï¼å æ­¤éè¦ä¸ºåºç¨åèµæºè§£è¦ã\n\n\n# 4. ä¸­å°æç¥\n\n\n# 4.1. å¹³å°ä¸æ¯ä¸­å°\n\nä¸­å°æºäºå¹³å°ï¼ä½å®çæç¥é«åº¦è¦æ¯å¹³å°é«å¾å¤ã\n\nå¹³å°åªæ¯å°é¨åéç¨çå¬å±è½åç¬ç«ä¸ºå±äº«å¹³å°ãè½ç¶å¯ä»¥éè¿ api æèæ°æ®å¯¹å¤æä¾å¬å±å±äº«æå¡ï¼è§£å³ç³»ç»éå¤å»ºè®¾çé®é¢ï¼ä½è¿ç±»å¹³å°å¹¶æ²¡æåä¼ä¸åçå¶å®å¹³å°æåºç¨ï¼å®ç°é¡µé¢ãä¸å¡æµç¨åæ°æ®ä»åç«¯å°åç«¯çå¨é¢èåï¼å¹¶ä¸æ²¡æå°æ ¸å¿ä¸å¡æå¡é¾è·¯ä½ä¸ºä¸ä¸ªæ´ä½æ¹æ¡èèï¼åå¹³å°ä»ç¶æ¯åç¦»ä¸ç¬ç«çã\n\nç®åççè§£å°±æ¯æä¼ ç»çååå°ä½ç³»ä¸­çåå°è¿è¡äºç»åãé¿éå·´å·´æåºäºå¤§ä¸­å°å°åå°çæç¥ãå°±æ¯å¼ºåä¸å¡åææ¯ä¸­å°ï¼æåç«¯çåºç¨åå¾æ´å°æ´çµæ´»ãå½ä¸­å°è¶å¼ºå¤§ï¼è½åå°±è¶å¼ºï¼è¶è½æ´å¥½çå¿«éååºåå°çä¸å¡éæ±ãæä¸ªæ¯å»ï¼å°±æ¯åå£¤è¶è¥æ²ï¼è¶éåçé¿ä¸åççç©ï¼æé å¥½ççæç³»ç»ã\n\n\n\n\n# 4.2. ä»ä¹æ¯ä¸­å°\n\nä¸­å°æ¯ä¸ä¸ªåºç¡ççå¿µåæ¶æï¼æä»¬è¦æææçåºç¡æå¡ç¨ä¸­å°çæè·¯å»ºè®¾ï¼è¿è¡èéï¼å±åæ¯æä¸ç«¯çä¸å¡ãä¸å¡ä¸­å°æ´å¤çæ¯æ¯æå¨çº¿ä¸å¡ï¼æ°æ®ä¸­å°æä¾äºåºç¡æ°æ®å¤çè½ååå¾å¤çæ°æ®äº§åç»ææä¸å¡æ¹å»ç¨ãä¸å¡ä¸­å°ãæ°æ®ä¸­å°ãç®æ³ä¸­å°ç­ç­ä¸èµ·æä¾å¯¹ä¸å±ä¸å¡çæ¯æã\n\nä¸­å°çå³é®è¯ï¼å±äº«ãèéãèåååæ°ãèéæ¯åå°ä»¥åä¸­å°ä¹é´çèéï¼èåæ¯åå°æµç¨åæ°æ®çèåï¼å¹¶ä»¥å±äº«çæ¹å¼æ¯æåç«¯ä¸çº¿ä¸å¡çåå±ååæ°ãå¶ä¸­æå³é®çæ¯å¿«éååºè½ååä¼ä¸çº§çæ ç¼èéåèåè½åï¼å°¤å¶æ¯å¯¹äºè·¨ä¸ç»è¥çè¶å¤§åä¼ä¸æ¥è¯´è³å³éè¦ã\n\n\n# 4.3. æ°å­åè½¬åä¸­å°\n\n\n# 4.4. åä¸­åå°åå\n\n# 4.4.1. åå°\n\nå¨åå°è®¾è®¡ä¸­æä»¬å¯ä»¥åé´å¾®åç«¯çè®¾è®¡ææ³ï¼å¨ä¼ä¸åä¸ä»å®ç°åç«¯è§£è¦åå¤ç¨ï¼è¿å¯ä»¥æ ¹æ®æ ¸å¿é¾è·¯åä¸å¡æµç¨ï¼éè¿å¯¹å¾®åç«¯é¡µé¢çå¨æç»ååæµç¨ç¼æï¼å®ç°åå°ä¸å¡çèåã\n\nåç«¯é¡µé¢å¯ä»¥å¾èªç¶å°èåå°ä¸åçç»ç«¯åæ¸ éåºç¨æ ¸å¿ä¸å¡é¾è·¯ä¸­ï¼å®ç°åç«¯é¡µé¢ãæµç¨ååè½å¤ç¨ã\n\n# 4.4.2. ä¸­å°\n\nä¸å¡ä¸­å°çå»ºè®¾å¯éç¨é¢åé©±å¨è®¾è®¡æ¹æ³ï¼éè¿é¢åå»ºæ¨¡ï¼å°å¯å¤ç¨çå¬å±è½åä»åä¸ªåä½å¥ç¦»ï¼æ²æ·å¹¶ç»åï¼éç¨å¾®æå¡æ¶ææ¨¡å¼ï¼å»ºè®¾æä¸ºå¯å±äº«çéç¨è½åä¸­å°ã\n\nåæ ·çï¼æä»¬å¯ä»¥å°æ ¸å¿è½åç¨å¾®æå¡æ¶ææ¨¡å¼ï¼å»ºè®¾æä¸ºå¯é¢åä¸åæ¸ éååºæ¯çå¯å¤ç¨çæ ¸å¿è½åä¸­å°ã ä¸å¡ä¸­å°ååå°ãç¬¬ä¸æ¹åå¶å®ä¸­å°æä¾ api æå¡ï¼å®ç°éç¨è½ååæ ¸å¿è½åçå¤ç¨ã\n\næ°æ®ä¸­å°çä¸»è¦ç®æ æ¯æéæ°æ®å­¤å²ï¼å®ç°ä¸å¡èåååæ°ï¼åæ¬ä¸å¤§ä¸»è¦èè½ï¼\n\n * ä¸æ¯å®æä¼ä¸å¨åæ°æ®çééä¸å­å¨ï¼å®ç°åä¸åä¸å¡ç±»å«ä¸­å°æ°æ®çæ±æ»åéä¸­ç®¡çã\n * äºæ¯æç§æ åçæ°æ®è§èææ°æ®æ¨¡åï¼å°æ°æ®æç§ä¸åä¸»é¢åæåºæ¯è¿è¡å å·¥åå¤çï¼å½¢æé¢åä¸åä¸»é¢ååºæ¯çæ°æ®åºç¨ï¼æ¯å¦å®¢æ·è§å¾ãä»£çäººè§å¾ãæ¸ éè§å¾ãæºæè§å¾ç­ä¸åæ°æ®ä½ç³»ã\n * ä¸æ¯å»ºç«ä¸å¡éæ±é©±å¨çæ°æ®ä½ç³»ï¼åºäºåä¸ªç»´åº¦çæ°æ®ï¼æ·±åº¦èåæ°æ®ä»·å¼ï¼æ¯æä¸å¡ååä¸æ¨¡å¼çåæ°ã\n\nç¸åºçï¼æ°æ®ä¸­å°çå»ºè®¾å°±å¯åä¸ºä¸æ­¥èµ°ï¼\n\n * ç¬¬ä¸æ­¥å®ç°åä¸­å°ä¸å¡æ°æ®çæ±éï¼è§£å³æ°æ®å­¤å²ååçº§æ°æ®å±äº«é®é¢ã\n * ç¬¬äºæ­¥å®ç°ä¼ä¸çº§å®æ¶æéå®æ¶å¨ç»´åº¦æ°æ®çæ·±åº¦èåãå å·¥åå±äº«ã\n * ç¬¬ä¸æ­¥èåæ°æ®ä»·å¼ï¼æ¯æä¸å¡åæ°ï¼å éä»æ°æ®è½¬æ¢ä¸ºä¸å¡ä»·å¼çè¿ç¨ã\n\n# 4.4.3. åå°\n\nåå°ä¸»è¦é¢åå®¢æ·ä»¥åç»ç«¯éå®èï¼å®ç°è¥éæ¨å¹¿ä»¥åäº¤æè½¬åï¼ä¸­å°ä¸»è¦é¢åè¿è¥äººåï¼å®æè¿è¥æ¯æï¼åå°ä¸»è¦é¢ååå°ç®¡çäººåï¼å®ç°æµç¨å®¡æ ¸ãåé¨ç®¡çä»¥ååå¤æ¯æï¼æ¯å¦éè´­ãäººåãè´¢å¡å oa ç­ç³»ç»ã\n\n\n# 4.5. dddãä¸­å°åå¾®æå¡çåä½\n\nä¼ ç»ä¼ä¸å¯ä»¥å°éè¦å±äº«çå¬å±è½åè¿è¡é¢åå»ºæ¨¡ï¼å»ºè®¾å¯å±äº«çéç¨ä¸­å°ãé¤æ­¤ä¹å¤ï¼ä¼ ç»ä¼ä¸è¿ä¼å°æ ¸å¿è½åè¿è¡é¢åå»ºæ¨¡ï¼å»ºè®¾é¢åä¸åæ¸ éçå¯å¤ç¨çæ ¸å¿ä¸­å°ã\n\n\n# 4.6. å¦ä½æå»ºä¸­å°\n\n# 4.6.1. èªé¡¶åä¸ç­ç¥\n\nèªé¡¶åä¸çç­ç¥éç¨äºå¨æ°çåºç¨ç³»ç»å»ºè®¾ï¼ææ§ç³»ç»æ¨åéå»ºçæåµãè¿ç§ç­ç¥æ¯ååé¡¶å±è®¾è®¡ï¼ä»æé«é¢åéçº§åè§£ä¸ºä¸­å°ï¼åå«å»ºç«é¢åæ¨¡åï¼æ ¹æ®ä¸å¡å±æ§åä¸ºéç¨ä¸­å°ææ ¸å¿ä¸­å°ãé¢åå»ºæ¨¡è¿ç¨ä¸»è¦åºäºä¸å¡ç°ç¶ï¼ææ¶ä¸èèç³»ç»ç°ç¶ã\n\n# 4.6.2. èªé¡¶åä¸ç­ç¥\n\nèªåºåä¸ç­ç¥éç¨äºéçç³»ç»ä¸å¡æ¨¡åçæ¼è¿å¼éæãè¿ç§ç­ç¥æ¯åºäºä¸å¡åç³»ç»ç°ç¶å®æé¢åå»ºæ¨¡ãé¦ååå«å®æç³»ç»æå¨ä¸å¡åçé¢åå»ºæ¨¡ï¼ç¶åå¯¹é½ä¸å¡åï¼æ¾åºå·æåç±»æç¸ä¼¼ä¸å¡åè½çé¢åæ¨¡åï¼å¯¹æ¯åæé¢åæ¨¡åçå·®å¼ï¼éç»é¢åå¯¹è±¡ï¼éæé¢åæ¨¡åãè¿ä¸ªè¿ç¨ä¼æ²æ·å¬å±åå¤ç¨çä¸å¡è½åï¼ä¼å°åæ£çä¸å¡æ¨¡åæ´åã\n\n# 4.6.3. æå»ºæ­¥éª¤\n\nç¬¬ä¸æ­¥ï¼éå®ç³»ç»æå¨ä¸å¡åï¼æå»ºé¢åæ¨¡åã\n\n\n\nç¬¬äºæ­¥ï¼å¯¹é½ä¸å¡åï¼æå»ºä¸­å°ä¸å¡æ¨¡åã\n\nç¬¬ä¸æ­¥ï¼ä¸­å°å½ç±»ï¼æ ¹æ®é¢åæ¨¡åè®¾è®¡å¾®æå¡ã\n\n\n# 5. è¾¹ç\n\né»è¾è¾¹çï¼å¾®æå¡åèåä¹é´çè¾¹çæ¯é»è¾è¾¹çãå®æ¯ä¸ä¸ªèæçè¾¹çï¼å¼ºè°ä¸å¡çåèï¼å¯æ ¹æ®éè¦åæç©çè¾¹çï¼ä¹å°±æ¯è¯´èåä¹å¯ä»¥ç¬ç«ä¸ºå¾®æå¡ã\n\nç©çè¾¹çï¼å¾®æå¡ä¹é´çè¾¹çæ¯ç©çè¾¹çãå®å¼ºè°å¾®æå¡é¨ç½²åè¿è¡çéç¦»ï¼å³æ³¨å¾®æå¡çæå¡è°ç¨ãå®¹éåè¿è¡ç­ã\n\nä»£ç è¾¹çï¼ä¸åå±æèèåä¹é´ä»£ç ç®å½çè¾¹çæ¯ä»£ç è¾¹çãå®å¼ºè°çæ¯ä»£ç ä¹é´çéç¦»ï¼æ¹ä¾¿æ¶ææ¼è¿æ¶ä»£ç çéç»ã\n\néè¿ä»¥ä¸è¾¹çï¼æä»¬å¯ä»¥è®©ä¸å¡è½åé«åèãä»£ç æ¾è¦åï¼ä¸æ¸æ°çè¾¹çï¼å¯ä»¥å¿«éå®ç°å¾®æå¡ä»£ç çæååç»åï¼è½»æ¾å®ç°å¾®æå¡æ¶ææ¼è¿ãä½æä¸ç¹ä¸å®è¦æ ¼å¤æ³¨æï¼è¾¹çæ¸æ°çå¾®æå¡ï¼ä¸æ¯å¤§åä½åå°åä½çæ¼è¿ã\n\n\n# 6. åèèµæ\n\n * ddd å®æè¯¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ¶æè®¾è®¡",frontmatter:{title:"æ¶æè®¾è®¡",date:"2019-03-08T13:16:53.000Z",categories:["æ¶æ"],tags:["æ¶æ"],permalink:"/pages/cbf9f8/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/",relativePath:"01.æ¶æ/README.md",key:"v-510eccb8",path:"/pages/cbf9f8/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:472},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:581},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:971}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# æ¶æè®¾è®¡\n\næ¶æè®¾è®¡çç®çæ¯è§£å³è½¯ä»¶ç³»ç»çå¤æåº¦å¸¦æ¥çé®é¢ãæ¶æå³(éè¦)å³ç­ï¼æ¯å¨ä¸ä¸ªæçº¦æççå­éå»æ±è§£ææ¥è¿æåéçè§£ãè¿ä¸ªæçº¦æççå­æ¯å¢éç»éªãææ¬ãèµæºãè¿åº¦ãä¸å¡æå¤é¶æ®µç­æç¼ç»ãæºæå¨ä¸èµ·çç»¼åä½(äººï¼è´¢ï¼ç©ï¼æ¶é´ï¼äºæç­)ãæ¶ææ ä¼å£ï¼ä½æ¯å­å¨æ°å½çæ¶æç¨å¨åéçè½¯ä»¶ç³»ç»ä¸­ï¼èè¿äºå°±æ¯å³ç­çç»æã\n\næ¶æè®¾è®¡ååï¼åéååãç®åååãæ¼åååãåéä¼äºåè¿ => æ¼åä¼äºä¸æ­¥å°ä½ => ç®åä¼äºå¤æ\n\næ¶æè®¾è®¡æä¸å¡éæ±é©±å¨ï¼éè¦è¯å«åºä¸»è¦é®é¢ï¼ç¶åæ ¹æ®ä¸å¡ãææ¯ãå¢éãææ¬ç­ç»¼åè¯ä¼°æåºï¼ä¼åè§£å³å½åé¢ä¸´çæä¸»è¦çå¤æåº¦é®é¢ã\n\næ¶æè®¾è®¡ä¸è¬è¦ç»åºå¤å¥å¤éæ¹æ¡ï¼3 ~ 5 ä¸ªæä½³ï¼ï¼å¹¶è¯ä¼°åæ¹æ¡å©å¼ã\n\nè¯ä¼°æ¹æ¡æ¶ï¼åºè¯¥åååºå³æ³¨çç»´åº¦ï¼å¦ï¼åè½æ§ãæ§è½ãå¯ç¨æ§ãå¤æåº¦ãç¡¬ä»¶ææ¬ãè¿ç»´ææ¬ç­ï¼ï¼ç¶åæ ¹æ®è¿äºç»´åº¦å»è¯ä¼°æåï¼åç»¼åæéæåéå½æ¶æåµçæ¹æ¡ã\n\næ¶æå¤±è´¥çä¸»å ï¼\n\n * æ²¡é£ä¹å¤äººï¼å´æ³å¹²é£ä¹å¤æ´»\n * æ²¡æé£ä¹å¤ç§¯ç´¯ï¼å´æ³ä¸æ­¥ç»å¤©\n * æ²¡æé£ä¹åè¶çä¸å¡åºæ¯ï¼å´å¹»æ³çµåä¸éªæä¸ºå¤©æ\n\n\n# ð åå®¹\n\n * ç³»ç»æ¶æé¢è¯é¢\n * ç³»ç»æ¶ææ¦è¿°\n * ç³»ç»é«æ§è½æ¶æ\n * ç³»ç»é«å¯ç¨æ¶æ\n * ç³»ç»ä¼¸ç¼©æ§æ¶æ\n * ç³»ç»æ©å±æ§æ¶æ\n * ç³»ç»å®å¨æ§æ¶æ\n * å¤§åç³»ç»æ ¸å¿ææ¯\n * é¢åé©±å¨è®¾è®¡\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * ãå¤§åç½ç«ç³»ç»ä¸ Java ä¸­é´ä»¶å®è·µã\n   * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n   * ãä¼ä¸ IT æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æã - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * ãéæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ã - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n * æç¨\n   * system-design-primer\n   * ä» 0 å¼å§å­¦æ¶æ\n   * ä» 0 å¼å§å­¦å¾®æå¡\n   * RPC å®æä¸æ ¸å¿åç\n   * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n   * DDD å®æè¯¾\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# æ¶æè®¾è®¡\n\næ¶æè®¾è®¡çç®çæ¯è§£å³è½¯ä»¶ç³»ç»çå¤æåº¦å¸¦æ¥çé®é¢ãæ¶æå³(éè¦)å³ç­ï¼æ¯å¨ä¸ä¸ªæçº¦æççå­éå»æ±è§£ææ¥è¿æåéçè§£ãè¿ä¸ªæçº¦æççå­æ¯å¢éç»éªãææ¬ãèµæºãè¿åº¦ãä¸å¡æå¤é¶æ®µç­æç¼ç»ãæºæå¨ä¸èµ·çç»¼åä½(äººï¼è´¢ï¼ç©ï¼æ¶é´ï¼äºæç­)ãæ¶ææ ä¼å£ï¼ä½æ¯å­å¨æ°å½çæ¶æç¨å¨åéçè½¯ä»¶ç³»ç»ä¸­ï¼èè¿äºå°±æ¯å³ç­çç»æã\n\næ¶æè®¾è®¡ååï¼åéååãç®åååãæ¼åååãåéä¼äºåè¿ => æ¼åä¼äºä¸æ­¥å°ä½ => ç®åä¼äºå¤æ\n\næ¶æè®¾è®¡æä¸å¡éæ±é©±å¨ï¼éè¦è¯å«åºä¸»è¦é®é¢ï¼ç¶åæ ¹æ®ä¸å¡ãææ¯ãå¢éãææ¬ç­ç»¼åè¯ä¼°æåºï¼ä¼åè§£å³å½åé¢ä¸´çæä¸»è¦çå¤æåº¦é®é¢ã\n\næ¶æè®¾è®¡ä¸è¬è¦ç»åºå¤å¥å¤éæ¹æ¡ï¼3 ~ 5 ä¸ªæä½³ï¼ï¼å¹¶è¯ä¼°åæ¹æ¡å©å¼ã\n\nè¯ä¼°æ¹æ¡æ¶ï¼åºè¯¥åååºå³æ³¨çç»´åº¦ï¼å¦ï¼åè½æ§ãæ§è½ãå¯ç¨æ§ãå¤æåº¦ãç¡¬ä»¶ææ¬ãè¿ç»´ææ¬ç­ï¼ï¼ç¶åæ ¹æ®è¿äºç»´åº¦å»è¯ä¼°æåï¼åç»¼åæéæåéå½æ¶æåµçæ¹æ¡ã\n\næ¶æå¤±è´¥çä¸»å ï¼\n\n * æ²¡é£ä¹å¤äººï¼å´æ³å¹²é£ä¹å¤æ´»\n * æ²¡æé£ä¹å¤ç§¯ç´¯ï¼å´æ³ä¸æ­¥ç»å¤©\n * æ²¡æé£ä¹åè¶çä¸å¡åºæ¯ï¼å´å¹»æ³çµåä¸éªæä¸ºå¤©æ\n\n\n# ð åå®¹\n\n * ç³»ç»æ¶æé¢è¯é¢\n * ç³»ç»æ¶ææ¦è¿°\n * ç³»ç»é«æ§è½æ¶æ\n * ç³»ç»é«å¯ç¨æ¶æ\n * ç³»ç»ä¼¸ç¼©æ§æ¶æ\n * ç³»ç»æ©å±æ§æ¶æ\n * ç³»ç»å®å¨æ§æ¶æ\n * å¤§åç³»ç»æ ¸å¿ææ¯\n * é¢åé©±å¨è®¾è®¡\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * ãå¤§åç½ç«ç³»ç»ä¸ java ä¸­é´ä»¶å®è·µã\n   * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n   * ãä¼ä¸ it æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æã - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * ãéæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ã - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n * æç¨\n   * system-design-primer\n   * ä» 0 å¼å§å­¦æ¶æ\n   * ä» 0 å¼å§å­¦å¾®æå¡\n   * rpc å®æä¸æ ¸å¿åç\n   * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n   * ddd å®æè¯¾\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å¦ä½è®¾è®¡ç³»ç»",frontmatter:{title:"å¦ä½è®¾è®¡ç³»ç»",date:"2021-11-08T08:15:33.000Z",categories:["æ¶æ"],tags:["æ¶æ","è®¾è®¡"],permalink:"/pages/3d05e6/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%B3%BB%E7%BB%9F.html",relativePath:"01.æ¶æ/å¦ä½è®¾è®¡ç³»ç».md",key:"v-491fd7ec",path:"/pages/3d05e6/",headers:[{level:2,title:"1. ç³»ç»è®¾è®¡è¿ç¨",slug:"_1-ç³»ç»è®¾è®¡è¿ç¨",normalizedTitle:"1. ç³»ç»è®¾è®¡è¿ç¨",charIndex:13},{level:3,title:"1.1. æ­¥éª¤ä¸ãçº¦æåç¨ä¾",slug:"_1-1-æ­¥éª¤ä¸ãçº¦æåç¨ä¾",normalizedTitle:"1.1. æ­¥éª¤ä¸ãçº¦æåç¨ä¾",charIndex:27},{level:3,title:"1.2. æ­¥éª¤äºãé¡¶å±è®¾è®¡",slug:"_1-2-æ­¥éª¤äºãé¡¶å±è®¾è®¡",normalizedTitle:"1.2. æ­¥éª¤äºãé¡¶å±è®¾è®¡",charIndex:330},{level:3,title:"1.3. æ­¥éª¤ä¸ãåæç¶é¢",slug:"_1-3-æ­¥éª¤ä¸ãåæç¶é¢",normalizedTitle:"1.3. æ­¥éª¤ä¸ãåæç¶é¢",charIndex:467},{level:3,title:"1.4. æ­¥éª¤åãæ©å±è®¾è®¡",slug:"_1-4-æ­¥éª¤åãæ©å±è®¾è®¡",normalizedTitle:"1.4. æ­¥éª¤åãæ©å±è®¾è®¡",charIndex:794},{level:2,title:"2. åèèµæ",slug:"_2-åèèµæ",normalizedTitle:"2. åèèµæ",charIndex:1428}],headersStr:"1. ç³»ç»è®¾è®¡è¿ç¨ 1.1. æ­¥éª¤ä¸ãçº¦æåç¨ä¾ 1.2. æ­¥éª¤äºãé¡¶å±è®¾è®¡ 1.3. æ­¥éª¤ä¸ãåæç¶é¢ 1.4. æ­¥éª¤åãæ©å±è®¾è®¡ 2. åèèµæ",content:"# å¦ä½è®¾è®¡ç³»ç»\n\n\n# 1. ç³»ç»è®¾è®¡è¿ç¨\n\n\n# 1.1. æ­¥éª¤ä¸ãçº¦æåç¨ä¾\n\nå¯¹äºä»»ä½ç³»ç»è®¾è®¡ï¼ç¬¬ä¸ä»¶åºè¯¥åçäºæ¯ï¼éæç³»ç»ççº¦æå¹¶ç¡®å®ç³»ç»éè¦æ»¡è¶³åªäºç¨ä¾ã\n\næ°¸è¿ä¸è¦åè®¾æ²¡ææç¡®è¯´æçäºæãä¸å®è¦å°½åæ¶éãçè§£éæ±ï¼å¹¶è®¾è®¡ä¸ä¸ªå¾å¥½å°æ¶µçè¿äºè¦æ±çè§£å³æ¹æ¡ã\n\nä¾å¦ï¼URL ç¼©ç­æå¡å¯è½åªä¸ºå åä¸ªç¨æ·æä¾æå¡ï¼ä½æ¯ä¸ªç¨æ·é½å¯è½å±äº«æ°ç¾ä¸ä¸ª URLãå®å¯è½æ¨å¨å¤çå¯¹ç¼©ç­ç URL çæ°ç¾ä¸æ¬¡ç¹å»ææ°åæ¬¡ç¹å»ãè¯¥æå¡å¯è½å¿é¡»æä¾æå³æ¯ä¸ªç¼©ç­ç URL çå¤§éç»è®¡ä¿¡æ¯ï¼è¿ä¼å¢å æ¨çæ°æ®å¤§å°ï¼ï¼æèå¯è½æ ¹æ¬ä¸éè¦ç»è®¡ä¿¡æ¯ã\n\næ¨è¿å¿é¡»èèé¢æä¼åççç¨ä¾ãæ¨çç³»ç»å°æ ¹æ®å¶é¢æåè½è¿è¡è®¾è®¡ãä¸è¦å¿è®°ç¡®ä¿ä½ ç¥éé¢è¯å®ä¸å¼å§æ²¡æåè¯ä½ çææè¦æ±ã\n\n\n# 1.2. æ­¥éª¤äºãé¡¶å±è®¾è®¡\n\nä¸æ¦ç¡®å®äºè¦è®¾è®¡çç³»ç»çèå´ï¼æ¥ä¸æ¥å°±è¦åé¡¶å±è®¾è®¡ï¼æ¦è¿°ç³»ç»æ¶æä¸­æéçææéè¦ç»ä»¶ã\n\næ­¤æ¶ï¼åºè¯¥ç»å¶åºä¸»è¦ç»ä»¶ä»¥åå®ä»¬ä¹é´çè¿æ¥ãéå¸¸ï¼è¿ç§é¡¶å±è®¾è®¡æ¯åºäºä¸»æµææ¯çç»åãè¿å°±è¦æ±è®¾è®¡å¿é¡»çæè¿äºææ¯ï¼äºè§£å¶å©å¼ä»¥åéåä½¿ç¨çåºæ¯ã\n\n\n# 1.3. æ­¥éª¤ä¸ãåæç¶é¢\n\né¡¶å±è®¾è®¡å¾å¯è½ä¼éå°ä¸ä¸ªæå¤ä¸ªç¶é¢ãè¿å®å¨æ²¡é®é¢ï¼ä¸è¦ææä¸ä¸ªæ°ç³»ç»å¯ä»¥ç«å³å¤çä¸çä¸çææè´è½½ãå®åªéè¦å¯æ©å±ï¼ä»¥ä¾¿æ¨è½å¤ä½¿ç¨ä¸äºæ åå·¥å·åææ¯å¯¹å¶è¿è¡æ¹è¿ã\n\nç°å¨æäºé¡¶å±è®¾è®¡ï¼å°±è¦èèè¿äºç»ä»¶å¨ç³»ç»æ©å±æ¶é¢ä¸´çç¶é¢ãä¹è®¸ï¼ç³»ç»éè¦ä¸ä¸ªè´è½½åè¡¡å¨åéç¾¤æ¥å¤çç¨æ·è¯·æ±ãæèï¼ç±äºæ°æ®å®¹éåºå¤§ï¼ä»¥è³äºéè¦å°æ°æ®åºååºåè¡¨ï¼åå¸å¨å¤å°æºå¨ä¸ï¼ãè¿äºæ¹æ¡æä»ä¹å©å¼ï¼æ¯å¦éç¨ï¼æ°æ®åºæ¯å¦å¤ªæ¢ï¼æ¯å¦éè¦ä¸äºåå­ç¼å­ï¼\n\néå¸¸æ¯ä¸ªè§£å³æ¹æ¡é½æ¯æç§æè¡¡ååèãæ¹åæäºä¼ä½¿å¶ä»äºææ¶åãç¶èï¼éè¦çæ¯è½å¤è®¨è®ºè¿äºæè¡¡ï¼å¹¶æ ¹æ®å®ä¹ççº¦æåç¨ä¾æ¥è¡¡éå®ä»¬å¯¹ç³»ç»çå½±åã\n\nä¸æ¦åææ¸æ¥æ ¸å¿ç¶é¢ï¼å°±å¯ä»¥çæå¨ä¸ä¸æ­¥ä¸­å»è§£å³å®ä»¬ã\n\n\n# 1.4. æ­¥éª¤åãæ©å±è®¾è®¡\n\né¦åï¼ä½ éè¦äºè§£ä»¥ä¸ææ¯ææ®µï¼\n\n * åç´æ©å±\n * æ°´å¹³ç½å \n * ç¼å­\n * è´è½½åè¡¡\n * æ°æ®åºå¤å¶\n * æ°æ®åºååº\n * å¼æ­¥\n * NoSql\n\nå¨ç³»ç»è®¾è®¡æ¹é¢ï¼åé¡¾ç°å®ä¸­çæ¶æéå¸¸æç¨ãæ³¨æä½¿ç¨äºåªäºææ¯ãç»§ç»­ç ç©¶æ¯ä¸é¡¹æ°ææ¯ï¼ççå®è§£å³äºä»ä¹é®é¢ï¼å®çæ¿ä»£åæ¯ä»ä¹ï¼å®æé¿çå°æ¹ï¼ä»¥åå¤±è´¥çå°æ¹ã\n\nä¸åé½æ¯æè¡¡çç»æââè¿æ¯ç³»ç»è®¾è®¡ä¸­æåºæ¬çæ¦å¿µä¹ä¸ã\n\nä¸äºæ¨èçå­¦ä¹ èµæ\n\n * çäº§ä¸­çæ·±åº¦å­¦ä¹ ï¼å³äº EyeEm å¦ä½æå»ºå¨å¤§éå¾åä¸è¿è¡å¤ä¸ªæ·±åº¦å­¦ä¹ æ¨¡åççäº§ç³»ç»çç²¾å½©æäº\n * Uberï¼ä¸ç¯å³äº Uber å¦ä½å¿«éæ©å±çå¥½æç« ï¼å³äºå°æ¨çæå¡åè§£ä¸ºåå¸å¨è®¸å¤å­å¨åºä¸­çè®¸å¤å¾®æå¡ã\n * Facebookï¼Facebook å¦ä½å¨ç´æ­ä¸­åæ¶å¤ç 800,000 åè§ä¼\n * Kraken.ioï¼å¦ä½å¤§è§æ¨¡ç¼©æ¾å¾åä¼åï¼æ¬æå°æ´è¯¦ç»å°çä¸äºå·ä½ä½¿ç¨çç¡¬ä»¶æ¹æ¡ï¼ä»¥åé¨ç½²ãçæ§ç­éè¦æ¹é¢\n * Twitterï¼Twitter å¦ä½å¤çæ¯ç§ 3,000 å¼ å¾çä¸ä¼ ä»¥åä¸ºä»ä¹å®ä½¿ç¨çæ§æ¹å¼ç°å¨è¡ä¸é\n * æåï¼Twitter å­ç»ä»¶çä¸äºå¾å¥½çä¾å­ï¼å­å¨æ°æ®ï¼video | textï¼åæ¶é´è½´ï¼video | textï¼ã\n * æå³æ´é«çº§çç¤ºä¾ï¼è¯·æ¥ç GoogleãYoutubeï¼video | textï¼ãTumblrãStackOverflow å Datashift ä¸çè¿äºå¸å­ã\n\n\n# 2. åèèµæ\n\n * system-design-primer\n * System Design for Tech Interviews",normalizedContent:"# å¦ä½è®¾è®¡ç³»ç»\n\n\n# 1. ç³»ç»è®¾è®¡è¿ç¨\n\n\n# 1.1. æ­¥éª¤ä¸ãçº¦æåç¨ä¾\n\nå¯¹äºä»»ä½ç³»ç»è®¾è®¡ï¼ç¬¬ä¸ä»¶åºè¯¥åçäºæ¯ï¼éæç³»ç»ççº¦æå¹¶ç¡®å®ç³»ç»éè¦æ»¡è¶³åªäºç¨ä¾ã\n\næ°¸è¿ä¸è¦åè®¾æ²¡ææç¡®è¯´æçäºæãä¸å®è¦å°½åæ¶éãçè§£éæ±ï¼å¹¶è®¾è®¡ä¸ä¸ªå¾å¥½å°æ¶µçè¿äºè¦æ±çè§£å³æ¹æ¡ã\n\nä¾å¦ï¼url ç¼©ç­æå¡å¯è½åªä¸ºå åä¸ªç¨æ·æä¾æå¡ï¼ä½æ¯ä¸ªç¨æ·é½å¯è½å±äº«æ°ç¾ä¸ä¸ª urlãå®å¯è½æ¨å¨å¤çå¯¹ç¼©ç­ç url çæ°ç¾ä¸æ¬¡ç¹å»ææ°åæ¬¡ç¹å»ãè¯¥æå¡å¯è½å¿é¡»æä¾æå³æ¯ä¸ªç¼©ç­ç url çå¤§éç»è®¡ä¿¡æ¯ï¼è¿ä¼å¢å æ¨çæ°æ®å¤§å°ï¼ï¼æèå¯è½æ ¹æ¬ä¸éè¦ç»è®¡ä¿¡æ¯ã\n\næ¨è¿å¿é¡»èèé¢æä¼åççç¨ä¾ãæ¨çç³»ç»å°æ ¹æ®å¶é¢æåè½è¿è¡è®¾è®¡ãä¸è¦å¿è®°ç¡®ä¿ä½ ç¥éé¢è¯å®ä¸å¼å§æ²¡æåè¯ä½ çææè¦æ±ã\n\n\n# 1.2. æ­¥éª¤äºãé¡¶å±è®¾è®¡\n\nä¸æ¦ç¡®å®äºè¦è®¾è®¡çç³»ç»çèå´ï¼æ¥ä¸æ¥å°±è¦åé¡¶å±è®¾è®¡ï¼æ¦è¿°ç³»ç»æ¶æä¸­æéçææéè¦ç»ä»¶ã\n\næ­¤æ¶ï¼åºè¯¥ç»å¶åºä¸»è¦ç»ä»¶ä»¥åå®ä»¬ä¹é´çè¿æ¥ãéå¸¸ï¼è¿ç§é¡¶å±è®¾è®¡æ¯åºäºä¸»æµææ¯çç»åãè¿å°±è¦æ±è®¾è®¡å¿é¡»çæè¿äºææ¯ï¼äºè§£å¶å©å¼ä»¥åéåä½¿ç¨çåºæ¯ã\n\n\n# 1.3. æ­¥éª¤ä¸ãåæç¶é¢\n\né¡¶å±è®¾è®¡å¾å¯è½ä¼éå°ä¸ä¸ªæå¤ä¸ªç¶é¢ãè¿å®å¨æ²¡é®é¢ï¼ä¸è¦ææä¸ä¸ªæ°ç³»ç»å¯ä»¥ç«å³å¤çä¸çä¸çææè´è½½ãå®åªéè¦å¯æ©å±ï¼ä»¥ä¾¿æ¨è½å¤ä½¿ç¨ä¸äºæ åå·¥å·åææ¯å¯¹å¶è¿è¡æ¹è¿ã\n\nç°å¨æäºé¡¶å±è®¾è®¡ï¼å°±è¦èèè¿äºç»ä»¶å¨ç³»ç»æ©å±æ¶é¢ä¸´çç¶é¢ãä¹è®¸ï¼ç³»ç»éè¦ä¸ä¸ªè´è½½åè¡¡å¨åéç¾¤æ¥å¤çç¨æ·è¯·æ±ãæèï¼ç±äºæ°æ®å®¹éåºå¤§ï¼ä»¥è³äºéè¦å°æ°æ®åºååºåè¡¨ï¼åå¸å¨å¤å°æºå¨ä¸ï¼ãè¿äºæ¹æ¡æä»ä¹å©å¼ï¼æ¯å¦éç¨ï¼æ°æ®åºæ¯å¦å¤ªæ¢ï¼æ¯å¦éè¦ä¸äºåå­ç¼å­ï¼\n\néå¸¸æ¯ä¸ªè§£å³æ¹æ¡é½æ¯æç§æè¡¡ååèãæ¹åæäºä¼ä½¿å¶ä»äºææ¶åãç¶èï¼éè¦çæ¯è½å¤è®¨è®ºè¿äºæè¡¡ï¼å¹¶æ ¹æ®å®ä¹ççº¦æåç¨ä¾æ¥è¡¡éå®ä»¬å¯¹ç³»ç»çå½±åã\n\nä¸æ¦åææ¸æ¥æ ¸å¿ç¶é¢ï¼å°±å¯ä»¥çæå¨ä¸ä¸æ­¥ä¸­å»è§£å³å®ä»¬ã\n\n\n# 1.4. æ­¥éª¤åãæ©å±è®¾è®¡\n\né¦åï¼ä½ éè¦äºè§£ä»¥ä¸ææ¯ææ®µï¼\n\n * åç´æ©å±\n * æ°´å¹³ç½å \n * ç¼å­\n * è´è½½åè¡¡\n * æ°æ®åºå¤å¶\n * æ°æ®åºååº\n * å¼æ­¥\n * nosql\n\nå¨ç³»ç»è®¾è®¡æ¹é¢ï¼åé¡¾ç°å®ä¸­çæ¶æéå¸¸æç¨ãæ³¨æä½¿ç¨äºåªäºææ¯ãç»§ç»­ç ç©¶æ¯ä¸é¡¹æ°ææ¯ï¼ççå®è§£å³äºä»ä¹é®é¢ï¼å®çæ¿ä»£åæ¯ä»ä¹ï¼å®æé¿çå°æ¹ï¼ä»¥åå¤±è´¥çå°æ¹ã\n\nä¸åé½æ¯æè¡¡çç»æââè¿æ¯ç³»ç»è®¾è®¡ä¸­æåºæ¬çæ¦å¿µä¹ä¸ã\n\nä¸äºæ¨èçå­¦ä¹ èµæ\n\n * çäº§ä¸­çæ·±åº¦å­¦ä¹ ï¼å³äº eyeem å¦ä½æå»ºå¨å¤§éå¾åä¸è¿è¡å¤ä¸ªæ·±åº¦å­¦ä¹ æ¨¡åççäº§ç³»ç»çç²¾å½©æäº\n * uberï¼ä¸ç¯å³äº uber å¦ä½å¿«éæ©å±çå¥½æç« ï¼å³äºå°æ¨çæå¡åè§£ä¸ºåå¸å¨è®¸å¤å­å¨åºä¸­çè®¸å¤å¾®æå¡ã\n * facebookï¼facebook å¦ä½å¨ç´æ­ä¸­åæ¶å¤ç 800,000 åè§ä¼\n * kraken.ioï¼å¦ä½å¤§è§æ¨¡ç¼©æ¾å¾åä¼åï¼æ¬æå°æ´è¯¦ç»å°çä¸äºå·ä½ä½¿ç¨çç¡¬ä»¶æ¹æ¡ï¼ä»¥åé¨ç½²ãçæ§ç­éè¦æ¹é¢\n * twitterï¼twitter å¦ä½å¤çæ¯ç§ 3,000 å¼ å¾çä¸ä¼ ä»¥åä¸ºä»ä¹å®ä½¿ç¨çæ§æ¹å¼ç°å¨è¡ä¸é\n * æåï¼twitter å­ç»ä»¶çä¸äºå¾å¥½çä¾å­ï¼å­å¨æ°æ®ï¼video | textï¼åæ¶é´è½´ï¼video | textï¼ã\n * æå³æ´é«çº§çç¤ºä¾ï¼è¯·æ¥ç googleãyoutubeï¼video | textï¼ãtumblrãstackoverflow å datashift ä¸çè¿äºå¸å­ã\n\n\n# 2. åèèµæ\n\n * system-design-primer\n * system design for tech interviews",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç³»ç»æµè¯æ¶æ",frontmatter:{title:"ç³»ç»æµè¯æ¶æ",date:"2019-12-10T17:00:00.000Z",categories:["æ¶æ"],tags:["æ¶æ","è®¾è®¡","æµè¯"],permalink:"/pages/45e366/"},regularPath:"/01.%E6%9E%B6%E6%9E%84/%E7%B3%BB%E7%BB%9F%E6%B5%8B%E8%AF%95%E6%9E%B6%E6%9E%84.html",relativePath:"01.æ¶æ/ç³»ç»æµè¯æ¶æ.md",key:"v-b75e4ec2",path:"/pages/45e366/",headers:[{level:2,title:"1. æµè¯æ¹æ³åç±»",slug:"_1-æµè¯æ¹æ³åç±»",normalizedTitle:"1. æµè¯æ¹æ³åç±»",charIndex:301},{level:3,title:"1.1. ä»æµè¯è®¾è®¡æ¹æ³åç±»",slug:"_1-1-ä»æµè¯è®¾è®¡æ¹æ³åç±»",normalizedTitle:"1.1. ä»æµè¯è®¾è®¡æ¹æ³åç±»",charIndex:315},{level:3,title:"1.2. ä»æµè¯çç®çåç±»",slug:"_1-2-ä»æµè¯çç®çåç±»",normalizedTitle:"1.2. ä»æµè¯çç®çåç±»",charIndex:605},{level:4,title:"1.2.1. åè½æµè¯",slug:"_1-2-1-åè½æµè¯",normalizedTitle:"1.2.1. åè½æµè¯",charIndex:622},{level:4,title:"1.2.2. éåè½æµè¯",slug:"_1-2-2-éåè½æµè¯",normalizedTitle:"1.2.2. éåè½æµè¯",charIndex:1003},{level:2,title:"2. åèèµæ",slug:"_2-åèèµæ",normalizedTitle:"2. åèèµæ",charIndex:1415}],headersStr:"1. æµè¯æ¹æ³åç±» 1.1. ä»æµè¯è®¾è®¡æ¹æ³åç±» 1.2. ä»æµè¯çç®çåç±» 1.2.1. åè½æµè¯ 1.2.2. éåè½æµè¯ 2. åèèµæ",content:"# ç³»ç»æµè¯æ¶æ\n\n> è½¯ä»¶æµè¯æè¿°ä¸ç§ç¨æ¥ä¿è¿é´å®è½¯ä»¶çæ­£ç¡®æ§ãå®æ´æ§ãå®å¨æ§åè´¨éçè¿ç¨ãè½¯ä»¶æµè¯çç»å¸å®ä¹æ¯ï¼å¨è§å®çæ¡ä»¶ä¸å¯¹ç¨åºè¿è¡æä½ï¼ä»¥åç°ç¨åºéè¯¯ï¼è¡¡éè½¯ä»¶è´¨éï¼å¹¶å¯¹å¶æ¯å¦è½æ»¡è¶³è®¾è®¡è¦æ±è¿è¡è¯ä¼°çè¿ç¨ã\n> \n> ç°ä»£è½¯ä»¶å¼åé¡¹ç®ä¸­ï¼åå·¥æç¡®ï¼åºæ¬ä¸é½ä¼æç åãæµè¯ãQA ç­è§è²ãä¸åè§è²ç±äºå³æ³¨çè§è§ä¸åï¼æµè¯ç®æ åæµè¯æ¹æ³ä¹ä¸å®å¨ç¸åãæ¬æä¸»è¦ä»ç åãæµè¯çè§è§å»èéè½¯ä»¶æµè¯ææ¯ã\n> \n> æ³¨æï¼\n> \n>  * ä¸ºäºæ¹ä¾¿ï¼åªææµè¯äººåéè¦å³æ³¨çæµè¯ç¹ç¨ãæµè¯ãæ æ³¨ï¼\n>  * èåªæç åäººåéè¦å³æ³¨çæµè¯ç¹ç¨ãç åãæ æ³¨ï¼\n>  * é½éè¦å³æ³¨çæµè¯ç¹åä¸ä½æ æ³¨ã\n\n\n# 1. æµè¯æ¹æ³åç±»\n\n\n# 1.1. ä»æµè¯è®¾è®¡æ¹æ³åç±»\n\n * é»çæµè¯ãæµè¯ã - æè½¯ä»¶ç³»ç»å½ä½ä¸ä¸ªâé»ç®±âï¼æ æ³äºè§£æä½¿ç¨ç³»ç»çåé¨ç»æåç¥è¯ãä»è½¯ä»¶çè¡ä¸ºï¼èä¸æ¯åé¨ç»æåºåæ¥è®¾è®¡æµè¯ã\n * ç½çæµè¯ãç åã - è®¾è®¡èå¯ä»¥çå°è½¯ä»¶ç³»ç»çåé¨ç»æï¼å¹¶ä¸ä½¿ç¨è½¯ä»¶çåé¨ç¥è¯æ¥æå¯¼æµè¯æ°æ®åæ¹æ³çéæ©ã\n * ç°çæµè¯ - ä»äºé»çåç½çä¹é´ã\n\n> å°ç»ï¼\n> \n>  * é»æ²³æµè¯éå¸¸éå¯¹çæ¯è½¯ä»¶çè¡ä¸ºæåè½ï¼ä¸è¬æ¯æµè¯äººåä¸»è¦å³æ³¨çã\n>  * ç½çæµè¯éå¸¸åéè¦å¯¹è½¯ä»¶æä¸å®ç¨åº¦çäºè§£ï¼ä¸è¬æ¯å¼åäººåæå³æ³¨çã\n>  * ç°çæµè¯éå¸¸æ¯ä¸ºäºæµè¯è½¯ä»¶å¨ç¹å®çåºæ¯ä¸çè¡¨ç°ï¼èéä¸»åºæ¯ã\n\n\n# 1.2. ä»æµè¯çç®çåç±»\n\n# 1.2.1. åè½æµè¯\n\n * ååæµè¯ï¼Unit Testï¼ - å¨æä½ç²åº¦çåè½/åæ°ä¸éªè¯ç¨åºçåç¡®æ§ï¼æ¯å¦æµè¯ä¸ä¸ªå½æ°çæ­£ç¡®æ§ããç åã\n   * å¸¸ç¨ææ¯ï¼junit4ãjunit5ãmockitoãassertj-core\n * åè½æµè¯ï¼Functional Testï¼ - éªè¯æ¨¡åçåè½ããæµè¯ã\n * éææµè¯ï¼Integration Testï¼ - éªè¯å ä¸ªäºç¸æä¾èµå³ç³»çæ¨¡åçåè½ããæµè¯ã\n * åºæ¯æµè¯ï¼Scenario Testï¼- éªè¯å ä¸ªæ¨¡åæ¯å¦è½å®æä¸ä¸ªç¨æ·åºæ¯ããæµè¯ã\n * ç³»ç»æµè¯ï¼System Testï¼ - å¯¹äºæ´ä¸ªç³»ç»åè½çæµè¯ããæµè¯ã\n * Alpha æµè¯ - è½¯ä»¶æµè¯äººåå¨çå®ç¨æ·ç¯å¢ä¸­å¯¹è½¯ä»¶è¿è¡å¨é¢çæµè¯ããæµè¯ã\n * Beta æµè¯ - ä¹å«å¬æµï¼æ¯çå®çç¨æ·å¨çå®çç¯å¢ä¸­è¿è¡çæµè¯ã\n\n# 1.2.2. éåè½æµè¯\n\n * ååæµè¯ï¼Stress testï¼ - éªè¯è½¯ä»¶å¨è¶è¿è´è½½è®¾è®¡çæåµä¸ä»è½è¿åæ­£ç¡®çç»æï¼æ²¡æå´©æº\n * è´è½½æµè¯ï¼Load testï¼ - æµè¯è½¯ä»¶å¨è´è½½æåµä¸è½å¦æ­£å¸¸å·¥ä½\n * æ§è½æµè¯ï¼Performance testï¼ - æµè¯è½¯ä»¶çæè½ï¼æ¯å¦æä¾æ»¡æçæå¡è´¨éã\n   * å¸¸ç¨ææ¯ï¼JMeterãJMHã\n * è½¯ä»¶è¾å©åè½æµè¯ï¼Accessibility testï¼ - æµè¯è½¯ä»¶æ¯å¦åæ®ç¾ç¨æ·æä¾è¶³å¤çè¾å©åè½\n * æ¬å°å/å¨çåæµè¯ï¼Localization/Globalizationï¼\n * å¼å®¹æ§æµè¯ï¼Compatibility Testï¼\n * éç½®æµè¯ï¼Configuration Testï¼ - æµè¯è½¯ä»¶å¨åç§éç½®ä¸è½å¦æ­£å¸¸å·¥ä½\n * å¯ç¨æ§æµè¯ï¼Usability Testï¼ â æµè¯è½¯ä»¶æ¯å¦å¥½ç¨\n * å®å¨æ§æµè¯ï¼Security Testï¼\n\n\n# 2. åèèµæ\n\n * è½¯ä»¶æµè¯ (ä¸) è½¯ä»¶æµè¯æ¹æ³å¤§æ±æ»\n * Java å¾®åºåæµè¯æ¡æ¶ JMH",normalizedContent:"# ç³»ç»æµè¯æ¶æ\n\n> è½¯ä»¶æµè¯æè¿°ä¸ç§ç¨æ¥ä¿è¿é´å®è½¯ä»¶çæ­£ç¡®æ§ãå®æ´æ§ãå®å¨æ§åè´¨éçè¿ç¨ãè½¯ä»¶æµè¯çç»å¸å®ä¹æ¯ï¼å¨è§å®çæ¡ä»¶ä¸å¯¹ç¨åºè¿è¡æä½ï¼ä»¥åç°ç¨åºéè¯¯ï¼è¡¡éè½¯ä»¶è´¨éï¼å¹¶å¯¹å¶æ¯å¦è½æ»¡è¶³è®¾è®¡è¦æ±è¿è¡è¯ä¼°çè¿ç¨ã\n> \n> ç°ä»£è½¯ä»¶å¼åé¡¹ç®ä¸­ï¼åå·¥æç¡®ï¼åºæ¬ä¸é½ä¼æç åãæµè¯ãqa ç­è§è²ãä¸åè§è²ç±äºå³æ³¨çè§è§ä¸åï¼æµè¯ç®æ åæµè¯æ¹æ³ä¹ä¸å®å¨ç¸åãæ¬æä¸»è¦ä»ç åãæµè¯çè§è§å»èéè½¯ä»¶æµè¯ææ¯ã\n> \n> æ³¨æï¼\n> \n>  * ä¸ºäºæ¹ä¾¿ï¼åªææµè¯äººåéè¦å³æ³¨çæµè¯ç¹ç¨ãæµè¯ãæ æ³¨ï¼\n>  * èåªæç åäººåéè¦å³æ³¨çæµè¯ç¹ç¨ãç åãæ æ³¨ï¼\n>  * é½éè¦å³æ³¨çæµè¯ç¹åä¸ä½æ æ³¨ã\n\n\n# 1. æµè¯æ¹æ³åç±»\n\n\n# 1.1. ä»æµè¯è®¾è®¡æ¹æ³åç±»\n\n * é»çæµè¯ãæµè¯ã - æè½¯ä»¶ç³»ç»å½ä½ä¸ä¸ªâé»ç®±âï¼æ æ³äºè§£æä½¿ç¨ç³»ç»çåé¨ç»æåç¥è¯ãä»è½¯ä»¶çè¡ä¸ºï¼èä¸æ¯åé¨ç»æåºåæ¥è®¾è®¡æµè¯ã\n * ç½çæµè¯ãç åã - è®¾è®¡èå¯ä»¥çå°è½¯ä»¶ç³»ç»çåé¨ç»æï¼å¹¶ä¸ä½¿ç¨è½¯ä»¶çåé¨ç¥è¯æ¥æå¯¼æµè¯æ°æ®åæ¹æ³çéæ©ã\n * ç°çæµè¯ - ä»äºé»çåç½çä¹é´ã\n\n> å°ç»ï¼\n> \n>  * é»æ²³æµè¯éå¸¸éå¯¹çæ¯è½¯ä»¶çè¡ä¸ºæåè½ï¼ä¸è¬æ¯æµè¯äººåä¸»è¦å³æ³¨çã\n>  * ç½çæµè¯éå¸¸åéè¦å¯¹è½¯ä»¶æä¸å®ç¨åº¦çäºè§£ï¼ä¸è¬æ¯å¼åäººåæå³æ³¨çã\n>  * ç°çæµè¯éå¸¸æ¯ä¸ºäºæµè¯è½¯ä»¶å¨ç¹å®çåºæ¯ä¸çè¡¨ç°ï¼èéä¸»åºæ¯ã\n\n\n# 1.2. ä»æµè¯çç®çåç±»\n\n# 1.2.1. åè½æµè¯\n\n * ååæµè¯ï¼unit testï¼ - å¨æä½ç²åº¦çåè½/åæ°ä¸éªè¯ç¨åºçåç¡®æ§ï¼æ¯å¦æµè¯ä¸ä¸ªå½æ°çæ­£ç¡®æ§ããç åã\n   * å¸¸ç¨ææ¯ï¼junit4ãjunit5ãmockitoãassertj-core\n * åè½æµè¯ï¼functional testï¼ - éªè¯æ¨¡åçåè½ããæµè¯ã\n * éææµè¯ï¼integration testï¼ - éªè¯å ä¸ªäºç¸æä¾èµå³ç³»çæ¨¡åçåè½ããæµè¯ã\n * åºæ¯æµè¯ï¼scenario testï¼- éªè¯å ä¸ªæ¨¡åæ¯å¦è½å®æä¸ä¸ªç¨æ·åºæ¯ããæµè¯ã\n * ç³»ç»æµè¯ï¼system testï¼ - å¯¹äºæ´ä¸ªç³»ç»åè½çæµè¯ããæµè¯ã\n * alpha æµè¯ - è½¯ä»¶æµè¯äººåå¨çå®ç¨æ·ç¯å¢ä¸­å¯¹è½¯ä»¶è¿è¡å¨é¢çæµè¯ããæµè¯ã\n * beta æµè¯ - ä¹å«å¬æµï¼æ¯çå®çç¨æ·å¨çå®çç¯å¢ä¸­è¿è¡çæµè¯ã\n\n# 1.2.2. éåè½æµè¯\n\n * ååæµè¯ï¼stress testï¼ - éªè¯è½¯ä»¶å¨è¶è¿è´è½½è®¾è®¡çæåµä¸ä»è½è¿åæ­£ç¡®çç»æï¼æ²¡æå´©æº\n * è´è½½æµè¯ï¼load testï¼ - æµè¯è½¯ä»¶å¨è´è½½æåµä¸è½å¦æ­£å¸¸å·¥ä½\n * æ§è½æµè¯ï¼performance testï¼ - æµè¯è½¯ä»¶çæè½ï¼æ¯å¦æä¾æ»¡æçæå¡è´¨éã\n   * å¸¸ç¨ææ¯ï¼jmeterãjmhã\n * è½¯ä»¶è¾å©åè½æµè¯ï¼accessibility testï¼ - æµè¯è½¯ä»¶æ¯å¦åæ®ç¾ç¨æ·æä¾è¶³å¤çè¾å©åè½\n * æ¬å°å/å¨çåæµè¯ï¼localization/globalizationï¼\n * å¼å®¹æ§æµè¯ï¼compatibility testï¼\n * éç½®æµè¯ï¼configuration testï¼ - æµè¯è½¯ä»¶å¨åç§éç½®ä¸è½å¦æ­£å¸¸å·¥ä½\n * å¯ç¨æ§æµè¯ï¼usability testï¼ â æµè¯è½¯ä»¶æ¯å¦å¥½ç¨\n * å®å¨æ§æµè¯ï¼security testï¼\n\n\n# 2. åèèµæ\n\n * è½¯ä»¶æµè¯ (ä¸) è½¯ä»¶æµè¯æ¹æ³å¤§æ±æ»\n * java å¾®åºåæµè¯æ¡æ¶ jmh",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼é¢è¯æ»ç»",frontmatter:{title:"åå¸å¼é¢è¯æ»ç»",categories:["åå¸å¼","åå¸å¼ç»¼å"],tags:["åå¸å¼","åå¸å¼ç»¼å","é¢è¯"],abbrlink:"375c2802",date:"2018-07-10T16:02:00.000Z",permalink:"/pages/cd56bb/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%BC%E5%90%88/01.%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93.html",relativePath:"02.åå¸å¼/01.åå¸å¼ç»¼å/01.åå¸å¼é¢è¯æ»ç».md",key:"v-21ce6260",path:"/pages/cd56bb/",headers:[{level:2,title:"1. åå¸å¼ç¼å­",slug:"_1-åå¸å¼ç¼å­",normalizedTitle:"1. åå¸å¼ç¼å­",charIndex:14},{level:3,title:"1.1. Redis æä»ä¹æ°æ®ç±»åï¼åå«ç¨äºä»ä¹åºæ¯",slug:"_1-1-redis-æä»ä¹æ°æ®ç±»å-åå«ç¨äºä»ä¹åºæ¯",normalizedTitle:"1.1. redis æä»ä¹æ°æ®ç±»åï¼åå«ç¨äºä»ä¹åºæ¯",charIndex:27},{level:3,title:"1.2. Redis çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç",slug:"_1-2-redis-çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç",normalizedTitle:"1.2. redis çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç",charIndex:670},{level:3,title:"1.3. Redis ç key æ¯å¦ä½å¯»åç",slug:"_1-3-redis-ç-key-æ¯å¦ä½å¯»åç",normalizedTitle:"1.3. redis ç key æ¯å¦ä½å¯»åç",charIndex:953},{level:4,title:"1.3.1. èæ¯",slug:"_1-3-1-èæ¯",normalizedTitle:"1.3.1. èæ¯",charIndex:980},{level:4,title:"1.3.2. å¯»å key çæ­¥éª¤",slug:"_1-3-2-å¯»å-key-çæ­¥éª¤",normalizedTitle:"1.3.2. å¯»å key çæ­¥éª¤",charIndex:1698},{level:3,title:"1.4. Redis çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°çï¼",slug:"_1-4-redis-çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°ç",normalizedTitle:"1.4. redis çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°çï¼",charIndex:2144},{level:4,title:"1.4.1. Redis Cluster èç¹åé",slug:"_1-4-1-redis-cluster-èç¹åé",normalizedTitle:"1.4.1. redis cluster èç¹åé",charIndex:2276},{level:4,title:"1.4.2. Redis Cluster ä¸»ä»æ¨¡å¼",slug:"_1-4-2-redis-cluster-ä¸»ä»æ¨¡å¼",normalizedTitle:"1.4.2. redis cluster ä¸»ä»æ¨¡å¼",charIndex:2683},{level:4,title:"1.4.3. Redis Sentinel",slug:"_1-4-3-redis-sentinel",normalizedTitle:"1.4.3. redis sentinel",charIndex:2861},{level:3,title:"1.5. Redis å¦ä½å®ç°åå¸å¼éï¼ZooKeeper å¦ä½å®ç°åå¸å¼éï¼æ¯è¾äºèä¼å£ï¼",slug:"_1-5-redis-å¦ä½å®ç°åå¸å¼é-zookeeper-å¦ä½å®ç°åå¸å¼é-æ¯è¾äºèä¼å£",normalizedTitle:"1.5. redis å¦ä½å®ç°åå¸å¼éï¼zookeeper å¦ä½å®ç°åå¸å¼éï¼æ¯è¾äºèä¼å£ï¼",charIndex:3595},{level:4,title:"1.5.1. æ°æ®åºå®ç°",slug:"_1-5-1-æ°æ®åºå®ç°",normalizedTitle:"1.5.1. æ°æ®åºå®ç°",charIndex:3722},{level:4,title:"1.5.2. Redis å®ç°",slug:"_1-5-2-redis-å®ç°",normalizedTitle:"1.5.2. redis å®ç°",charIndex:3738},{level:4,title:"1.5.3. ZooKeeper å®ç°",slug:"_1-5-3-zookeeper-å®ç°",normalizedTitle:"1.5.3. zookeeper å®ç°",charIndex:3945},{level:4,title:"1.5.4. å®ç°å¯¹æ¯",slug:"_1-5-4-å®ç°å¯¹æ¯",normalizedTitle:"1.5.4. å®ç°å¯¹æ¯",charIndex:4183},{level:3,title:"1.6. Redis çæä¹åæ¹å¼ï¼æä»ä¹ä¼ç¼ºç¹ï¼æä¹åå®ç°åçï¼",slug:"_1-6-redis-çæä¹åæ¹å¼-æä»ä¹ä¼ç¼ºç¹-æä¹åå®ç°åç",normalizedTitle:"1.6. redis çæä¹åæ¹å¼ï¼æä»ä¹ä¼ç¼ºç¹ï¼æä¹åå®ç°åçï¼",charIndex:4280},{level:4,title:"1.6.1. RDB å¿«ç§ï¼snapshotï¼",slug:"_1-6-1-rdb-å¿«ç§-snapshot",normalizedTitle:"1.6.1. rdb å¿«ç§ï¼snapshotï¼",charIndex:4317},{level:5,title:"å¿«ç§çåç",slug:"å¿«ç§çåç",normalizedTitle:"å¿«ç§çåç",charIndex:4367},{level:5,title:"å¿«ç§çä¼ç¹",slug:"å¿«ç§çä¼ç¹",normalizedTitle:"å¿«ç§çä¼ç¹",charIndex:4716},{level:5,title:"å¿«ç§çç¼ºç¹",slug:"å¿«ç§çç¼ºç¹",normalizedTitle:"å¿«ç§çç¼ºç¹",charIndex:4935},{level:4,title:"1.6.2. AOF",slug:"_1-6-2-aof",normalizedTitle:"1.6.2. aof",charIndex:5085},{level:4,title:"1.6.3. AOF çåç",slug:"_1-6-3-aof-çåç",normalizedTitle:"1.6.3. aof çåç",charIndex:5152},{level:4,title:"1.6.4. AOF çä¼ç¹",slug:"_1-6-4-aof-çä¼ç¹",normalizedTitle:"1.6.4. aof çä¼ç¹",charIndex:5430},{level:4,title:"1.6.5. AOF çç¼ºç¹",slug:"_1-6-5-aof-çç¼ºç¹",normalizedTitle:"1.6.5. aof çç¼ºç¹",charIndex:5833},{level:3,title:"1.7. Redis è¿æç­ç¥æåªäºï¼",slug:"_1-7-redis-è¿æç­ç¥æåªäº",normalizedTitle:"1.7. redis è¿æç­ç¥æåªäºï¼",charIndex:6035},{level:3,title:"1.8. Redis å Memcached æä»ä¹åºå«ï¼",slug:"_1-8-redis-å-memcached-æä»ä¹åºå«",normalizedTitle:"1.8. redis å memcached æä»ä¹åºå«ï¼",charIndex:6331},{level:3,title:"1.9. ä¸ºä»ä¹åçº¿ç¨ç Redis æ§è½åèä¼äºå¤çº¿ç¨ç Memcachedï¼",slug:"_1-9-ä¸ºä»ä¹åçº¿ç¨ç-redis-æ§è½åèä¼äºå¤çº¿ç¨ç-memcached",normalizedTitle:"1.9. ä¸ºä»ä¹åçº¿ç¨ç redis æ§è½åèä¼äºå¤çº¿ç¨ç memcachedï¼",charIndex:6851},{level:2,title:"2. åå¸å¼æ¶æ¯éåï¼MQï¼",slug:"_2-åå¸å¼æ¶æ¯éå-mq",normalizedTitle:"2. åå¸å¼æ¶æ¯éåï¼mqï¼",charIndex:7072},{level:3,title:"2.1. ä¸ºä»ä¹ä½¿ç¨ MQï¼",slug:"_2-1-ä¸ºä»ä¹ä½¿ç¨-mq",normalizedTitle:"2.1. ä¸ºä»ä¹ä½¿ç¨ mqï¼",charIndex:7091},{level:3,title:"2.2. å¦ä½ä¿è¯ MQ çé«å¯ç¨ï¼",slug:"_2-2-å¦ä½ä¿è¯-mq-çé«å¯ç¨",normalizedTitle:"2.2. å¦ä½ä¿è¯ mq çé«å¯ç¨ï¼",charIndex:7302},{level:4,title:"2.2.1. æ°æ®å¤å¶",slug:"_2-2-1-æ°æ®å¤å¶",normalizedTitle:"2.2.1. æ°æ®å¤å¶",charIndex:7324},{level:4,title:"2.2.2. éä¸¾ä¸»æå¡å¨",slug:"_2-2-2-éä¸¾ä¸»æå¡å¨",normalizedTitle:"2.2.2. éä¸¾ä¸»æå¡å¨",charIndex:7486},{level:3,title:"2.3. MQ æåªäºå¸¸è§é®é¢ï¼å¦ä½è§£å³è¿äºé®é¢ï¼",slug:"_2-3-mq-æåªäºå¸¸è§é®é¢-å¦ä½è§£å³è¿äºé®é¢",normalizedTitle:"2.3. mq æåªäºå¸¸è§é®é¢ï¼å¦ä½è§£å³è¿äºé®é¢ï¼",charIndex:7504},{level:4,title:"2.3.1. æ¶æ¯çé¡ºåºé®é¢",slug:"_2-3-1-æ¶æ¯çé¡ºåºé®é¢",normalizedTitle:"2.3.1. æ¶æ¯çé¡ºåºé®é¢",charIndex:7570},{level:4,title:"2.3.2. æ¶æ¯çéå¤é®é¢",slug:"_2-3-2-æ¶æ¯çéå¤é®é¢",normalizedTitle:"2.3.2. æ¶æ¯çéå¤é®é¢",charIndex:7914},{level:3,title:"2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ åæä»ä¹ä¼ç¼ºç¹ï¼",slug:"_2-4-kafka-activemq-rabbitmq-rocketmq-åæä»ä¹ä¼ç¼ºç¹",normalizedTitle:"2.4. kafka, activemq, rabbitmq, rocketmq åæä»ä¹ä¼ç¼ºç¹ï¼",charIndex:8146},{level:3,title:"3.1. Dubbo çå®ç°è¿ç¨ï¼",slug:"_3-1-dubbo-çå®ç°è¿ç¨",normalizedTitle:"3.1. dubbo çå®ç°è¿ç¨ï¼",charIndex:8219},{level:3,title:"3.2. Dubbo è´è½½åè¡¡ç­ç¥æåªäºï¼",slug:"_3-2-dubbo-è´è½½åè¡¡ç­ç¥æåªäº",normalizedTitle:"3.2. dubbo è´è½½åè¡¡ç­ç¥æåªäºï¼",charIndex:8643},{level:5,title:"Random",slug:"random",normalizedTitle:"random",charIndex:8668},{level:5,title:"RoundRobin",slug:"roundrobin",normalizedTitle:"roundrobin",charIndex:8754},{level:5,title:"LeastActive",slug:"leastactive",normalizedTitle:"leastactive",charIndex:8857},{level:5,title:"ConsistentHash",slug:"consistenthash",normalizedTitle:"consistenthash",charIndex:8943},{level:3,title:"3.3. Dubbo éç¾¤å®¹éç­ç¥ ï¼",slug:"_3-3-dubbo-éç¾¤å®¹éç­ç¥",normalizedTitle:"3.3. dubbo éç¾¤å®¹éç­ç¥ ï¼",charIndex:9257},{level:3,title:"3.4. å¨æä»£çç­ç¥ï¼",slug:"_3-4-å¨æä»£çç­ç¥",normalizedTitle:"3.4. å¨æä»£çç­ç¥ï¼",charIndex:9685},{level:3,title:"3.5. Dubbo æ¯æåªäºåºåååè®®ï¼Hessianï¼Hessian çæ°æ®ç»æï¼",slug:"_3-5-dubbo-æ¯æåªäºåºåååè®®-hessian-hessian-çæ°æ®ç»æ",normalizedTitle:"3.5. dubbo æ¯æåªäºåºåååè®®ï¼hessianï¼hessian çæ°æ®ç»æï¼",charIndex:10385},{level:3,title:"3.6. Protoco Buffer æ¯ä»ä¹ï¼",slug:"_3-6-protoco-buffer-æ¯ä»ä¹",normalizedTitle:"3.6. protoco buffer æ¯ä»ä¹ï¼",charIndex:10961},{level:3,title:"3.7. æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼",slug:"_3-7-æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡å",normalizedTitle:"3.7. æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼",charIndex:11311},{level:3,title:"3.8. ZooKeeper åçæ¯ä»ä¹ï¼ZooKeeper æä»ä¹ç¨ï¼",slug:"_3-8-zookeeper-åçæ¯ä»ä¹-zookeeper-æä»ä¹ç¨",normalizedTitle:"3.8. zookeeper åçæ¯ä»ä¹ï¼zookeeper æä»ä¹ç¨ï¼",charIndex:11403},{level:3,title:"3.9. Netty æä»ä¹ç¨ï¼NIO/BIO/AIO æä»ä¹ç¨ï¼æä»ä¹åºå«ï¼",slug:"_3-9-netty-æä»ä¹ç¨-nio-bio-aio-æä»ä¹ç¨-æä»ä¹åºå«",normalizedTitle:"3.9. netty æä»ä¹ç¨ï¼nio/bio/aio æä»ä¹ç¨ï¼æä»ä¹åºå«ï¼",charIndex:11668},{level:3,title:"3.10. ä¸ºä»ä¹è¦è¿è¡ç³»ç»æåï¼æåä¸ç¨ Dubbo å¯ä»¥åï¼",slug:"_3-10-ä¸ºä»ä¹è¦è¿è¡ç³»ç»æå-æåä¸ç¨-dubbo-å¯ä»¥å",normalizedTitle:"3.10. ä¸ºä»ä¹è¦è¿è¡ç³»ç»æåï¼æåä¸ç¨ dubbo å¯ä»¥åï¼",charIndex:12441},{level:3,title:"3.11. Dubbo å Thrift æä»ä¹åºå«ï¼",slug:"_3-11-dubbo-å-thrift-æä»ä¹åºå«",normalizedTitle:"3.11. dubbo å thrift æä»ä¹åºå«ï¼",charIndex:12759},{level:2,title:"4. åå¸å¼éåºæ¬åç",slug:"_4-åå¸å¼éåºæ¬åç",normalizedTitle:"4. åå¸å¼éåºæ¬åç",charIndex:12846}],headersStr:"1. åå¸å¼ç¼å­ 1.1. Redis æä»ä¹æ°æ®ç±»åï¼åå«ç¨äºä»ä¹åºæ¯ 1.2. Redis çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç 1.3. Redis ç key æ¯å¦ä½å¯»åç 1.3.1. èæ¯ 1.3.2. å¯»å key çæ­¥éª¤ 1.4. Redis çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°çï¼ 1.4.1. Redis Cluster èç¹åé 1.4.2. Redis Cluster ä¸»ä»æ¨¡å¼ 1.4.3. Redis Sentinel 1.5. Redis å¦ä½å®ç°åå¸å¼éï¼ZooKeeper å¦ä½å®ç°åå¸å¼éï¼æ¯è¾äºèä¼å£ï¼ 1.5.1. æ°æ®åºå®ç° 1.5.2. Redis å®ç° 1.5.3. ZooKeeper å®ç° 1.5.4. å®ç°å¯¹æ¯ 1.6. Redis çæä¹åæ¹å¼ï¼æä»ä¹ä¼ç¼ºç¹ï¼æä¹åå®ç°åçï¼ 1.6.1. RDB å¿«ç§ï¼snapshotï¼ å¿«ç§çåç å¿«ç§çä¼ç¹ å¿«ç§çç¼ºç¹ 1.6.2. AOF 1.6.3. AOF çåç 1.6.4. AOF çä¼ç¹ 1.6.5. AOF çç¼ºç¹ 1.7. Redis è¿æç­ç¥æåªäºï¼ 1.8. Redis å Memcached æä»ä¹åºå«ï¼ 1.9. ä¸ºä»ä¹åçº¿ç¨ç Redis æ§è½åèä¼äºå¤çº¿ç¨ç Memcachedï¼ 2. åå¸å¼æ¶æ¯éåï¼MQï¼ 2.1. ä¸ºä»ä¹ä½¿ç¨ MQï¼ 2.2. å¦ä½ä¿è¯ MQ çé«å¯ç¨ï¼ 2.2.1. æ°æ®å¤å¶ 2.2.2. éä¸¾ä¸»æå¡å¨ 2.3. MQ æåªäºå¸¸è§é®é¢ï¼å¦ä½è§£å³è¿äºé®é¢ï¼ 2.3.1. æ¶æ¯çé¡ºåºé®é¢ 2.3.2. æ¶æ¯çéå¤é®é¢ 2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ åæä»ä¹ä¼ç¼ºç¹ï¼ 3.1. Dubbo çå®ç°è¿ç¨ï¼ 3.2. Dubbo è´è½½åè¡¡ç­ç¥æåªäºï¼ Random RoundRobin LeastActive ConsistentHash 3.3. Dubbo éç¾¤å®¹éç­ç¥ ï¼ 3.4. å¨æä»£çç­ç¥ï¼ 3.5. Dubbo æ¯æåªäºåºåååè®®ï¼Hessianï¼Hessian çæ°æ®ç»æï¼ 3.6. Protoco Buffer æ¯ä»ä¹ï¼ 3.7. æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼ 3.8. ZooKeeper åçæ¯ä»ä¹ï¼ZooKeeper æä»ä¹ç¨ï¼ 3.9. Netty æä»ä¹ç¨ï¼NIO/BIO/AIO æä»ä¹ç¨ï¼æä»ä¹åºå«ï¼ 3.10. ä¸ºä»ä¹è¦è¿è¡ç³»ç»æåï¼æåä¸ç¨ Dubbo å¯ä»¥åï¼ 3.11. Dubbo å Thrift æä»ä¹åºå«ï¼ 4. åå¸å¼éåºæ¬åç",content:'# åå¸å¼é¢è¯æ»ç»\n\n\n# 1. åå¸å¼ç¼å­\n\n\n# 1.1. Redis æä»ä¹æ°æ®ç±»åï¼åå«ç¨äºä»ä¹åºæ¯\n\næ°æ®ç±»å     å¯ä»¥å­å¨çå¼        æä½\nSTRING   å­ç¬¦ä¸²ãæ´æ°æèæµ®ç¹æ°   å¯¹æ´ä¸ªå­ç¬¦ä¸²æèå­ç¬¦ä¸²çå¶ä¸­ä¸é¨åæ§è¡æä½\n                       å¯¹æ´æ°åæµ®ç¹æ°æ§è¡èªå¢æèèªåæä½\nLIST     åè¡¨            ä»ä¸¤ç«¯åå¥æèå¼¹åºåç´ \n                       è¯»ååä¸ªæèå¤ä¸ªåç´ \n                       è¿è¡ä¿®åªï¼åªä¿çä¸ä¸ªèå´åçåç´ \nSET      æ åºéå          æ·»å ãè·åãç§»é¤åä¸ªåç´ \n                       æ£æ¥ä¸ä¸ªåç´ æ¯å¦å­å¨äºéåä¸­\n                       è®¡ç®äº¤éãå¹¶éãå·®é\n                       ä»éåéé¢éæºè·ååç´ \nHASH     åå«é®å¼å¯¹çæ åºæ£åè¡¨   æ·»å ãè·åãç§»é¤åä¸ªé®å¼å¯¹\n                       è·åææé®å¼å¯¹\n                       æ£æ¥æä¸ªé®æ¯å¦å­å¨\nZSET     æåºéå          æ·»å ãè·åãå é¤åç´ \n                       æ ¹æ®åå¼èå´æèæåæ¥è·ååç´ \n                       è®¡ç®ä¸ä¸ªé®çæå\n\n> What Redis data structures look like\n\n\n# 1.2. Redis çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç\n\n 1. ä»æå¡å¨è¿æ¥ä¸»æå¡å¨ï¼åé SYNC å½ä»¤ï¼\n 2. ä¸»æå¡å¨æ¥æ¶å° SYNC å½ååï¼å¼å§æ§è¡ BGSAVE å½ä»¤çæ RDB æä»¶å¹¶ä½¿ç¨ç¼å²åºè®°å½æ­¤åæ§è¡çææåå½ä»¤ï¼\n 3. ä¸»æå¡å¨ BGSAVE æ§è¡å®åï¼åææä»æå¡å¨åéå¿«ç§æä»¶ï¼å¹¶å¨åéæé´ç»§ç»­è®°å½è¢«æ§è¡çåå½ä»¤ï¼\n 4. ä»æå¡å¨æ¶å°å¿«ç§æä»¶åä¸¢å¼æææ§æ°æ®ï¼è½½å¥æ¶å°çå¿«ç§ï¼\n 5. ä¸»æå¡å¨å¿«ç§åéå®æ¯åå¼å§åä»æå¡å¨åéç¼å²åºä¸­çåå½ä»¤ï¼\n 6. ä»æå¡å¨å®æå¯¹å¿«ç§çè½½å¥ï¼å¼å§æ¥æ¶å½ä»¤è¯·æ±ï¼å¹¶æ§è¡æ¥èªä¸»æå¡å¨ç¼å²åºçåå½ä»¤ï¼\n\n\n# 1.3. Redis ç key æ¯å¦ä½å¯»åç\n\n# 1.3.1. èæ¯\n\nï¼1ï¼redis ä¸­çæ¯ä¸ä¸ªæ°æ®åºï¼é½ç±ä¸ä¸ª redisDb çç»æå­å¨ãå¶ä¸­ï¼\n\n * redisDb.id å­å¨ç redis æ°æ®åºä»¥æ´æ°è¡¨ç¤ºçå·ç ã\n * redisDb.dict å­å¨çè¯¥åºææçé®å¼å¯¹æ°æ®ã\n * redisDb.expires ä¿å­çæ¯ä¸ä¸ªé®çè¿ææ¶é´ã\n\nï¼2ï¼å½ redis æå¡å¨åå§åæ¶ï¼ä¼é¢ååé 16 ä¸ªæ°æ®åºï¼è¯¥æ°éå¯ä»¥éè¿éç½®æä»¶éç½®ï¼ï¼æææ°æ®åºä¿å­å°ç»æ redisServer çä¸ä¸ªæå redisServer.db æ°ç»ä¸­ãå½æä»¬éæ©æ°æ®åº select number æ¶ï¼ç¨åºç´æ¥éè¿ redisServer.db[number] æ¥åæ¢æ°æ®åºãææ¶åå½ç¨åºéè¦ç¥éèªå·±æ¯å¨åªä¸ªæ°æ®åºæ¶ï¼ç´æ¥è¯»å redisDb.id å³å¯ã\n\nï¼3ï¼redis çå­å¸ä½¿ç¨åå¸è¡¨ä½ä¸ºå¶åºå±å®ç°ãdict ç±»åä½¿ç¨çä¸¤ä¸ªæååå¸è¡¨çæéï¼å¶ä¸­ 0 å·åå¸è¡¨ï¼ht[0]ï¼ä¸»è¦ç¨äºå­å¨æ°æ®åºçææé®å¼ï¼è 1 å·åå¸è¡¨ä¸»è¦ç¨äºç¨åºå¯¹ 0 å·åå¸è¡¨è¿è¡ rehash æ¶ä½¿ç¨ï¼rehash ä¸è¬æ¯å¨æ·»å æ°å¼æ¶ä¼è§¦åï¼è¿éä¸åè¿å¤çèµè¿°ãæä»¥ redis ä¸­æ¥æ¾ä¸ä¸ª keyï¼å¶å®å°±æ¯å¯¹è¿è¡è¯¥ dict ç»æä¸­ç ht[0] è¿è¡æ¥æ¾æä½ã\n\nï¼4ï¼æ¢ç¶æ¯åå¸ï¼é£ä¹æä»¬ç¥éå°±ä¼æåå¸ç¢°æï¼é£ä¹å½å¤ä¸ªé®åå¸ä¹åä¸ºåä¸ä¸ªå¼æä¹åå¢ï¼redis éåé¾è¡¨çæ¹å¼æ¥å­å¨å¤ä¸ªåå¸ç¢°æçé®ãä¹å°±æ¯è¯´ï¼å½æ ¹æ® key çåå¸å¼æ¾å°è¯¥åè¡¨åï¼å¦æåè¡¨çé¿åº¦å¤§äº 1ï¼é£ä¹æä»¬éè¦éåè¯¥é¾è¡¨æ¥æ¾å°æä»¬ææ¥æ¾ç keyãå½ç¶ï¼ä¸è¬æåµä¸é¾è¡¨é¿åº¦é½ä¸ºæ¯ 1ï¼æä»¥æ¶é´å¤æåº¦å¯çä½ o(1)ã\n\n# 1.3.2. å¯»å key çæ­¥éª¤\n\n 1. å½æ¿å°ä¸ä¸ª key åï¼redis åå¤æ­å½ååºç 0 å·åå¸è¡¨æ¯å¦ä¸ºç©ºï¼å³ï¼if (dict->ht[0].size == 0)ãå¦æä¸º true ç´æ¥è¿å NULLã\n 2. å¤æ­è¯¥ 0 å·åå¸è¡¨æ¯å¦éè¦ rehashï¼å ä¸ºå¦æå¨è¿è¡ rehashï¼é£ä¹ä¸¤ä¸ªè¡¨ä¸­èæå¯è½å­å¨è¯¥ keyãå¦ææ­£å¨è¿è¡ rehashï¼å°è°ç¨ä¸æ¬¡_dictRehashStep æ¹æ³ï¼_dictRehashStep ç¨äºå¯¹æ°æ®åºå­å¸ãä»¥ååå¸é®çå­å¸è¿è¡è¢«å¨ rehashï¼è¿éä¸ä½èµè¿°ã\n 3. è®¡ç®åå¸è¡¨ï¼æ ¹æ®å½åå­å¸ä¸ key è¿è¡åå¸å¼çè®¡ç®ã\n 4. æ ¹æ®åå¸å¼ä¸å½åå­å¸è®¡ç®åå¸è¡¨çç´¢å¼å¼ã\n 5. æ ¹æ®ç´¢å¼å¼å¨åå¸è¡¨ä¸­ååºé¾è¡¨ï¼éåè¯¥é¾è¡¨æ¾å° key çä½ç½®ãä¸è¬æåµï¼è¯¥é¾è¡¨é¿åº¦ä¸º 1ã\n 6. å½ ht[0] æ¥æ¾å®äºä¹åï¼åè¿è¡äºæ¬¡ rehash å¤æ­ï¼å¦ææªå¨ rehashingï¼åç´æ¥ç»æï¼å¦åå¯¹ ht[1]éå¤ 345 æ­¥éª¤ã\n\n\n# 1.4. Redis çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°çï¼\n\nRedis Cluster æ¯ Redis çåå¸å¼è§£å³æ¹æ¡ï¼å¨ Redis 3.0 çæ¬æ­£å¼æ¨åºçã\n\nRedis Cluster å»ä¸­å¿åï¼æ¯ä¸ªèç¹ä¿å­æ°æ®åæ´ä¸ªéç¾¤ç¶æï¼æ¯ä¸ªèç¹é½åå¶ä»ææèç¹è¿æ¥ã\n\n# 1.4.1. Redis Cluster èç¹åé\n\nRedis Cluster ç¹ç¹ï¼\n\n 1. ææç redis èç¹å½¼æ­¤äºè(PING-PONG æºå¶)ï¼åé¨ä½¿ç¨äºè¿å¶åè®®ä¼åä¼ è¾éåº¦åå¸¦å®½ã\n 2. èç¹ç fail æ¯éè¿éç¾¤ä¸­è¶è¿åæ°çèç¹æ£æµå¤±ææ¶æçæã\n 3. å®¢æ·ç«¯ä¸ redis èç¹ç´è¿,ä¸éè¦ä¸­é´ proxy å±ãå®¢æ·ç«¯ä¸éè¦è¿æ¥éç¾¤ææèç¹ï¼è¿æ¥éç¾¤ä¸­ä»»ä½ä¸ä¸ªå¯ç¨èç¹å³å¯ã\n 4. redis-cluster æææçç©çèç¹æ å°å°[0-16383] åå¸æ§½ (hash slot)ä¸ï¼ä¸ä¸å®æ¯å¹³ååéï¼,cluster è´è´£ç»´æ¤ node<->slot<->valueã\n 5. Redis éç¾¤é¢åå¥½ 16384 ä¸ªæ¡¶ï¼å½éè¦å¨ Redis éç¾¤ä¸­æ¾ç½®ä¸ä¸ª key-value æ¶ï¼æ ¹æ® CRC16(key) mod 16384 çå¼ï¼å³å®å°ä¸ä¸ª key æ¾å°åªä¸ªæ¡¶ä¸­ã\n\n# 1.4.2. Redis Cluster ä¸»ä»æ¨¡å¼\n\nRedis Cluster ä¸ºäºä¿è¯æ°æ®çé«å¯ç¨æ§ï¼å å¥äºä¸»ä»æ¨¡å¼ã\n\nä¸ä¸ªä¸»èç¹å¯¹åºä¸ä¸ªæå¤ä¸ªä»èç¹ï¼ä¸»èç¹æä¾æ°æ®å­åï¼ä»èç¹åæ¯ä»ä¸»èç¹æåæ°æ®å¤ä»½ãå½è¿ä¸ªä¸»èç¹ææåï¼å°±ä¼æè¿ä¸ªä»èç¹éåä¸ä¸ªæ¥åå½ä¸»èç¹ï¼ä»èä¿è¯éç¾¤ä¸ä¼ææãæä»¥ï¼å¨éç¾¤å»ºç«çæ¶åï¼ä¸å®è¦ä¸ºæ¯ä¸ªä¸»èç¹é½æ·»å äºä»èç¹ã\n\n# 1.4.3. Redis Sentinel\n\nRedis Sentinel ç¨äºç®¡çå¤ä¸ª Redis æå¡å¨ï¼å®æä¸ä¸ªåè½ï¼\n\n * çæ§ï¼Monitoringï¼ - Sentinel ä¼ä¸æ­å°æ£æ¥ä½ çä¸»æå¡å¨åä»æå¡å¨æ¯å¦è¿ä½æ­£å¸¸ã\n * æéï¼Notificationï¼ - å½è¢«çæ§çæä¸ª Redis æå¡å¨åºç°é®é¢æ¶ï¼ Sentinel å¯ä»¥éè¿ API åç®¡çåæèå¶ä»åºç¨ç¨åºåééç¥ã\n * èªå¨æéè¿ç§»ï¼Automatic failoverï¼ - å½ä¸ä¸ªä¸»æå¡å¨ä¸è½æ­£å¸¸å·¥ä½æ¶ï¼ Sentinel ä¼å¼å§ä¸æ¬¡èªå¨æéè¿ç§»æä½ï¼ å®ä¼å°å¤±æä¸»æå¡å¨çå¶ä¸­ä¸ä¸ªä»æå¡å¨åçº§ä¸ºæ°çä¸»æå¡å¨ï¼ å¹¶è®©å¤±æä¸»æå¡å¨çå¶ä»ä»æå¡å¨æ¹ä¸ºå¤å¶æ°çä¸»æå¡å¨ï¼ å½å®¢æ·ç«¯è¯å¾è¿æ¥å¤±æçä¸»æå¡å¨æ¶ï¼ éç¾¤ä¹ä¼åå®¢æ·ç«¯è¿åæ°ä¸»æå¡å¨çå°åï¼ ä½¿å¾éç¾¤å¯ä»¥ä½¿ç¨æ°ä¸»æå¡å¨ä»£æ¿å¤±ææå¡å¨ã\n\nRedis éç¾¤ä¸­åºè¯¥æå¥æ°ä¸ªèç¹ï¼æä»¥è³å°æä¸ä¸ªèç¹ã\n\nå¨åµçæ§éç¾¤ä¸­çä¸»æå¡å¨åºç°æéæ¶ï¼éè¦æ ¹æ® quorum éä¸¾åºä¸ä¸ªå¨åµæ¥æ§è¡æéè½¬ç§»ãéä¸¾éè¦ majorityï¼å³å¤§å¤æ°å¨åµæ¯è¿è¡çï¼2 ä¸ªå¨åµç majority=2ï¼3 ä¸ªå¨åµç majority=2ï¼5 ä¸ªå¨åµç majority=3ï¼4 ä¸ªå¨åµç majority=2ï¼ã\n\nåè®¾éç¾¤ä»ä»é¨ç½² 2 ä¸ªèç¹\n\n+----+         +----+\n| M1 |---------| R1 |\n| S1 |         | S2 |\n+----+         +----+\n\n\nå¦æ M1 å S1 æå¨æå¡å¨å®æºï¼åå¨åµåªæ 1 ä¸ªï¼æ æ³æ»¡è¶³ majority æ¥è¿è¡éä¸¾ï¼å°±ä¸è½æ§è¡æéè½¬ç§»ã\n\n\n# 1.5. Redis å¦ä½å®ç°åå¸å¼éï¼ZooKeeper å¦ä½å®ç°åå¸å¼éï¼æ¯è¾äºèä¼å£ï¼\n\nåå¸å¼éçä¸ç§å®ç°ï¼\n\n * åºäºæ°æ®åºå®ç°åå¸å¼éï¼\n * åºäºç¼å­ï¼Redis ç­ï¼å®ç°åå¸å¼éï¼\n * åºäº Zookeeper å®ç°åå¸å¼éï¼\n\n# 1.5.1. æ°æ®åºå®ç°\n\n# 1.5.2. Redis å®ç°\n\n 1. è·åéçæ¶åï¼ä½¿ç¨ setnx å éï¼å¹¶ä½¿ç¨ expire å½ä»¤ä¸ºéæ·»å ä¸ä¸ªè¶æ¶æ¶é´ï¼è¶è¿è¯¥æ¶é´åèªå¨éæ¾éï¼éç value å¼ä¸ºä¸ä¸ªéæºçæç UUIDï¼éè¿æ­¤å¨éæ¾éçæ¶åè¿è¡å¤æ­ã\n 2. è·åéçæ¶åè¿è®¾ç½®ä¸ä¸ªè·åçè¶æ¶æ¶é´ï¼è¥è¶è¿è¿ä¸ªæ¶é´åæ¾å¼è·åéã\n 3. éæ¾éçæ¶åï¼éè¿ UUID å¤æ­æ¯ä¸æ¯è¯¥éï¼è¥æ¯è¯¥éï¼åæ§è¡ delete è¿è¡ééæ¾ã\n\n# 1.5.3. ZooKeeper å®ç°\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ A æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ B è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ A å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ B çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n# 1.5.4. å®ç°å¯¹æ¯\n\nZooKeeper å·å¤é«å¯ç¨ãå¯éå¥ãé»å¡éç¹æ§ï¼å¯è§£å³å¤±ææ­»éé®é¢ã ä½ ZooKeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ Redis æ¹å¼ã\n\n\n# 1.6. Redis çæä¹åæ¹å¼ï¼æä»ä¹ä¼ç¼ºç¹ï¼æä¹åå®ç°åçï¼\n\n# 1.6.1. RDB å¿«ç§ï¼snapshotï¼\n\nå°å­å¨äºæä¸æ¶å»çæææ°æ®é½åå¥å°ç¡¬çä¸­ã\n\n# å¿«ç§çåç\n\nå¨é»è®¤æåµä¸ï¼Redis å°æ°æ®åºå¿«ç§ä¿å­å¨åå­ä¸º dump.rdb çäºè¿å¶æä»¶ä¸­ãä½ å¯ä»¥å¯¹ Redis è¿è¡è®¾ç½®ï¼ è®©å®å¨âN ç§åæ°æ®éè³å°æ M ä¸ªæ¹å¨âè¿ä¸æ¡ä»¶è¢«æ»¡è¶³æ¶ï¼ èªå¨ä¿å­ä¸æ¬¡æ°æ®éãä½ ä¹å¯ä»¥éè¿è°ç¨ SAVE æè BGSAVEï¼æå¨è®© Redis è¿è¡æ°æ®éä¿å­æä½ãè¿ç§æä¹åæ¹å¼è¢«ç§°ä¸ºå¿«ç§ã\n\nå½ Redis éè¦ä¿å­ dump.rdb æä»¶æ¶ï¼ æå¡å¨æ§è¡ä»¥ä¸æä½:\n\n * Redis åå»ºä¸ä¸ªå­è¿ç¨ã\n * å­è¿ç¨å°æ°æ®éåå¥å°ä¸ä¸ªä¸´æ¶å¿«ç§æä»¶ä¸­ã\n * å½å­è¿ç¨å®æå¯¹æ°å¿«ç§æä»¶çåå¥æ¶ï¼Redis ç¨æ°å¿«ç§æä»¶æ¿æ¢åæ¥çå¿«ç§æä»¶ï¼å¹¶å é¤æ§çå¿«ç§æä»¶ã\n\nè¿ç§å·¥ä½æ¹å¼ä½¿å¾ Redis å¯ä»¥ä»åæ¶å¤å¶ï¼copy-on-writeï¼æºå¶ä¸­è·çã\n\n# å¿«ç§çä¼ç¹\n\n * å®ä¿å­äºæä¸ªæ¶é´ç¹çæ°æ®éï¼éå¸¸éç¨äºæ°æ®éçå¤ä»½ã\n * å¾æ¹ä¾¿ä¼ éå°å¦ä¸ä¸ªè¿ç«¯æ°æ®ä¸­å¿æèäºé©¬éç S3ï¼å¯è½å å¯ï¼ï¼éå¸¸éç¨äºç¾é¾æ¢å¤ã\n * å¿«ç§å¨ä¿å­ RDB æä»¶æ¶ç¶è¿ç¨å¯ä¸éè¦åçå°±æ¯ fork åºä¸ä¸ªå­è¿ç¨ï¼æ¥ä¸æ¥çå·¥ä½å¨é¨ç±å­è¿ç¨æ¥åï¼ç¶è¿ç¨ä¸éè¦ååå¶ä» IO æä½ï¼æä»¥å¿«ç§æä¹åæ¹å¼å¯ä»¥æå¤§å redis çæ§è½ã\n * ä¸ AOF ç¸æ¯ï¼å¨æ¢å¤å¤§çæ°æ®éçæ¶åï¼DB æ¹å¼ä¼æ´å¿«ä¸äºã\n\n# å¿«ç§çç¼ºç¹\n\n * å¦æä½ å¸æå¨ redis æå¤åæ­¢å·¥ä½ï¼ä¾å¦çµæºä¸­æ­ï¼çæåµä¸ä¸¢å¤±çæ°æ®æå°çè¯ï¼é£ä¹å¿«ç§ä¸éåä½ ã\n * å¿«ç§éè¦ç»å¸¸ fork å­è¿ç¨æ¥ä¿å­æ°æ®éå°ç¡¬çä¸ãå½æ°æ®éæ¯è¾å¤§çæ¶åï¼fork çè¿ç¨æ¯éå¸¸èæ¶çï¼å¯è½ä¼å¯¼è´ Redis å¨ä¸äºæ¯«ç§çº§åä¸è½ååºå®¢æ·ç«¯çè¯·æ±ã\n\n# 1.6.2. AOF\n\nAOF æä¹åæ¹å¼è®°å½æ¯æ¬¡å¯¹æå¡å¨æ§è¡çåæä½ãå½æå¡å¨éå¯çæ¶åä¼éæ°æ§è¡è¿äºå½ä»¤æ¥æ¢å¤åå§çæ°æ®ã\n\n# 1.6.3. AOF çåç\n\n * Redis åå»ºä¸ä¸ªå­è¿ç¨ã\n * å­è¿ç¨å¼å§å°æ° AOF æä»¶çåå®¹åå¥å°ä¸´æ¶æä»¶ã\n * å¯¹äºæææ°æ§è¡çåå¥å½ä»¤ï¼ç¶è¿ç¨ä¸è¾¹å°å®ä»¬ç´¯ç§¯å°ä¸ä¸ªåå­ç¼å­ä¸­ï¼ä¸è¾¹å°è¿äºæ¹å¨è¿½å å°ç°æ AOF æä»¶çæ«å°¾ï¼è¿æ ·æ ·å³ä½¿å¨éåçä¸­éåçåæºï¼ç°æç AOF æä»¶ä¹è¿æ¯å®å¨çã\n * å½å­è¿ç¨å®æéåå·¥ä½æ¶ï¼å®ç»ç¶è¿ç¨åéä¸ä¸ªä¿¡å·ï¼ç¶è¿ç¨å¨æ¥æ¶å°ä¿¡å·ä¹åï¼å°åå­ç¼å­ä¸­çæææ°æ®è¿½å å°æ° AOF æä»¶çæ«å°¾ã\n * æå®ï¼ç°å¨ Redis åå­å°ç¨æ°æä»¶æ¿æ¢æ§æä»¶ï¼ä¹åææå½ä»¤é½ä¼ç´æ¥è¿½å å°æ° AOF æä»¶çæ«å°¾ã\n\n# 1.6.4. AOF çä¼ç¹\n\n * ä½¿ç¨é»è®¤çæ¯ç§ fsync ç­ç¥ï¼Redis çæ§è½ä¾ç¶å¾å¥½(fsync æ¯ç±åå°çº¿ç¨è¿è¡å¤çç,ä¸»çº¿ç¨ä¼å°½åå¤çå®¢æ·ç«¯è¯·æ±)ï¼ä¸æ¦åºç°æéï¼ä½¿ç¨ AOF ï¼ä½ æå¤ä¸¢å¤± 1 ç§çæ°æ®ã\n * AOF æä»¶æ¯ä¸ä¸ªåªè¿è¡è¿½å çæ¥å¿æä»¶ï¼æä»¥ä¸éè¦åå¥ seekï¼å³ä½¿ç±äºæäºåå (ç£çç©ºé´å·²æ»¡ï¼åçè¿ç¨ä¸­å®æºç­ç­)æªæ§è¡å®æ´çåå¥å½ä»¤ï¼ä½ ä¹ä¹å¯ä½¿ç¨ redis-check-aof å·¥å·ä¿®å¤è¿äºé®é¢ã\n * Redis å¯ä»¥å¨ AOF æä»¶ä½ç§¯åå¾è¿å¤§æ¶ï¼èªå¨å°å¨åå°å¯¹ AOF è¿è¡éåï¼éååçæ° AOF æä»¶åå«äºæ¢å¤å½åæ°æ®éæéçæå°å½ä»¤éåãæ´ä¸ªéåæä½æ¯ç»å¯¹å®å¨çã\n * AOF æä»¶æåºå°ä¿å­äºå¯¹æ°æ®åºæ§è¡çææåå¥æä½ï¼è¿äºåå¥æä½ä»¥ Redis åè®®çæ ¼å¼ä¿å­ãå æ­¤ AOF æä»¶çåå®¹éå¸¸å®¹æè¢«äººè¯»æï¼å¯¹æä»¶è¿è¡åæï¼parseï¼ä¹å¾è½»æ¾ã\n\n# 1.6.5. AOF çç¼ºç¹\n\n * å¯¹äºç¸åçæ°æ®éæ¥è¯´ï¼AOF æä»¶çä½ç§¯éå¸¸è¦å¤§äº RDB æä»¶çä½ç§¯ã\n * æ ¹æ®æä½¿ç¨ç fsync ç­ç¥ï¼AOF çéåº¦å¯è½ä¼æ¢äºå¿«ç§ãå¨ä¸è¬æåµä¸ï¼æ¯ç§ fsync çæ§è½ä¾ç¶éå¸¸é«ï¼èå³é­ fsync å¯ä»¥è®© AOF çéåº¦åå¿«ç§ä¸æ ·å¿«ï¼å³ä½¿å¨é«è´è·ä¹ä¸ä¹æ¯å¦æ­¤ãä¸è¿å¨å¤çå·¨å¤§çåå¥è½½å¥æ¶ï¼å¿«ç§å¯ä»¥æä¾æ´æä¿è¯çæå¤§å»¶è¿æ¶é´ï¼latencyï¼ã\n\n\n# 1.7. Redis è¿æç­ç¥æåªäºï¼\n\n * noeviction - å½åå­ä½¿ç¨è¾¾å°éå¼çæ¶åï¼ææå¼èµ·ç³è¯·åå­çå½ä»¤ä¼æ¥éã\n * allkeys-lru - å¨ä¸»é®ç©ºé´ä¸­ï¼ä¼åç§»é¤æè¿æªä½¿ç¨ç keyã\n * allkeys-random - å¨ä¸»é®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-lru - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ä¼åç§»é¤æè¿æªä½¿ç¨ç keyã\n * volatile-random - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-ttl - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼å·ææ´æ©è¿ææ¶é´ç key ä¼åç§»é¤ã\n\n\n# 1.8. Redis å Memcached æä»ä¹åºå«ï¼\n\nä¸¤èé½æ¯éå³ç³»ååå­é®å¼æ°æ®åºãæä»¥ä¸ä¸»è¦ä¸åï¼\n\næ°æ®ç±»å\n\n * Memcached ä»æ¯æå­ç¬¦ä¸²ç±»åï¼\n * è Redis æ¯æäºç§ä¸åç§ç±»çæ°æ®ç±»åï¼ä½¿å¾å®å¯ä»¥æ´çµæ´»å°è§£å³é®é¢ã\n\næ°æ®æä¹å\n\n * Memcached ä¸æ¯ææä¹åï¼\n * Redis æ¯æä¸¤ç§æä¹åç­ç¥ï¼RDB å¿«ç§å AOF æ¥å¿ã\n\nåå¸å¼\n\n * Memcached ä¸æ¯æåå¸å¼ï¼åªè½éè¿å¨å®¢æ·ç«¯ä½¿ç¨åä¸è´æ§åå¸è¿æ ·çåå¸å¼ç®æ³æ¥å®ç°åå¸å¼å­å¨ï¼è¿ç§æ¹å¼å¨å­å¨åæ¥è¯¢æ¶é½éè¦åå¨å®¢æ·ç«¯è®¡ç®ä¸æ¬¡æ°æ®æå¨çèç¹ã\n * Redis Cluster å®ç°äºåå¸å¼çæ¯æã\n\nåå­ç®¡çæºå¶\n\n * Memcached å°åå­åå²æç¹å®é¿åº¦çåæ¥å­å¨æ°æ®ï¼ä»¥å®å¨è§£å³åå­ç¢ççé®é¢ï¼ä½æ¯è¿ç§æ¹å¼ä¼ä½¿å¾åå­çå©ç¨çä¸é«ï¼ä¾å¦åçå¤§å°ä¸º 128 bytesï¼åªå­å¨ 100 bytes çæ°æ®ï¼é£ä¹å©ä¸ç 28 bytes å°±æµªè´¹æäºã\n * å¨ Redis ä¸­ï¼å¹¶ä¸æ¯æææ°æ®é½ä¸ç´å­å¨å¨åå­ä¸­ï¼å¯ä»¥å°ä¸äºå¾ä¹æ²¡ç¨ç value äº¤æ¢å°ç£çãè Memcached çæ°æ®åä¼ä¸ç´å¨åå­ä¸­ã\n\n\n# 1.9. ä¸ºä»ä¹åçº¿ç¨ç Redis æ§è½åèä¼äºå¤çº¿ç¨ç Memcachedï¼\n\nRedis å¿«éçåå ï¼\n\n 1. ç»å¤§é¨åè¯·æ±æ¯çº¯ç²¹çåå­æä½ï¼éå¸¸å¿«éï¼\n 2. éç¨åçº¿ç¨,é¿åäºä¸å¿è¦çä¸ä¸æåæ¢åç«äºæ¡ä»¶\n 3. éé»å¡ IO\n\nåé¨å®ç°éç¨ epollï¼éç¨äº epoll+èªå·±å®ç°çç®åçäºä»¶æ¡æ¶ãepoll ä¸­çè¯»ãåãå³é­ãè¿æ¥é½è½¬åæäºäºä»¶ï¼ç¶åå©ç¨ epoll çå¤è·¯å¤ç¨ç¹æ§ï¼ç»ä¸å¨ io ä¸æµªè´¹ä¸ç¹æ¶é´ã\n\n\n# 2. åå¸å¼æ¶æ¯éåï¼MQï¼\n\n\n# 2.1. ä¸ºä»ä¹ä½¿ç¨ MQï¼\n\n * å¼æ­¥å¤ç - ç¸æ¯äºä¼ ç»çä¸²è¡ãå¹¶è¡æ¹å¼ï¼æé«äºç³»ç»ååéã\n * åºç¨è§£è¦ - ç³»ç»é´éè¿æ¶æ¯éä¿¡ï¼ä¸ç¨å³å¿å¶ä»ç³»ç»çå¤çã\n * æµéåé - å¯ä»¥éè¿æ¶æ¯éåé¿åº¦æ§å¶è¯·æ±éï¼å¯ä»¥ç¼è§£ç­æ¶é´åçé«å¹¶åè¯·æ±ã\n * æ¥å¿å¤ç - è§£å³å¤§éæ¥å¿ä¼ è¾ã\n * æ¶æ¯éè®¯ - æ¶æ¯éåä¸è¬é½åç½®äºé«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨å¨çº¯çæ¶æ¯éè®¯ãæ¯å¦å®ç°ç¹å¯¹ç¹æ¶æ¯éåï¼æèèå¤©å®¤ç­ã\n\n\n# 2.2. å¦ä½ä¿è¯ MQ çé«å¯ç¨ï¼\n\n# 2.2.1. æ°æ®å¤å¶\n\n 1. å°ææ Broker åå¾åéç Partition æåº\n 2. å°ç¬¬ i ä¸ª Partition åéå°ç¬¬ï¼i mod nï¼ä¸ª Broker ä¸\n 3. å°ç¬¬ i ä¸ª Partition çç¬¬ j ä¸ª Replica åéå°ç¬¬ï¼(i + j) mode nï¼ä¸ª Broker ä¸\n\n# 2.2.2. éä¸¾ä¸»æå¡å¨\n\n\n# 2.3. MQ æåªäºå¸¸è§é®é¢ï¼å¦ä½è§£å³è¿äºé®é¢ï¼\n\nMQ çå¸¸è§é®é¢æï¼\n\n 1. æ¶æ¯çé¡ºåºé®é¢\n 2. æ¶æ¯çéå¤é®é¢\n\n# 2.3.1. æ¶æ¯çé¡ºåºé®é¢\n\næ¶æ¯æåºæçæ¯å¯ä»¥æç§æ¶æ¯çåéé¡ºåºæ¥æ¶è´¹ã\n\nåå¦çäº§èäº§çäº 2 æ¡æ¶æ¯ï¼M1ãM2ï¼åå® M1 åéå° S1ï¼M2 åéå° S2ï¼å¦æè¦ä¿è¯ M1 åäº M2 è¢«æ¶è´¹ï¼æä¹åï¼\n\n\nè§£å³æ¹æ¡ï¼\n\nï¼1ï¼ä¿è¯çäº§è - MQServer - æ¶è´¹èæ¯ä¸å¯¹ä¸å¯¹ä¸çå³ç³»\n\n\nç¼ºé·ï¼\n * å¹¶è¡åº¦å°±ä¼æä¸ºæ¶æ¯ç³»ç»çç¶é¢ï¼ååéä¸å¤ï¼\n * æ´å¤çå¼å¸¸å¤çï¼æ¯å¦ï¼åªè¦æ¶è´¹ç«¯åºç°é®é¢ï¼å°±ä¼å¯¼è´æ´ä¸ªå¤çæµç¨é»å¡ï¼æä»¬ä¸å¾ä¸è±è´¹æ´å¤çç²¾åæ¥è§£å³é»å¡çé®é¢ã\n\nï¼2ï¼éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ã\n\n * ä¸å³æ³¨ä¹±åºçåºç¨å®éå¤§éå­å¨\n * éåæ åºå¹¶ä¸æå³çæ¶æ¯æ åº\n\næä»¥ä»ä¸å¡å±é¢æ¥ä¿è¯æ¶æ¯çé¡ºåºèä¸ä»ä»æ¯ä¾èµäºæ¶æ¯ç³»ç»ï¼æ¯ä¸ç§æ´åççæ¹å¼ã\n\n# 2.3.2. æ¶æ¯çéå¤é®é¢\n\né ææ¶æ¯éå¤çæ ¹æ¬åå æ¯ï¼ç½ç»ä¸å¯è¾¾ã\n\næä»¥è§£å³è¿ä¸ªé®é¢çåæ³å°±æ¯ç»è¿è¿ä¸ªé®é¢ãé£ä¹é®é¢å°±åæäºï¼å¦ææ¶è´¹ç«¯æ¶å°ä¸¤æ¡ä¸æ ·çæ¶æ¯ï¼åºè¯¥ææ ·å¤çï¼\n\næ¶è´¹ç«¯å¤çæ¶æ¯çä¸å¡é»è¾ä¿æå¹ç­æ§ãåªè¦ä¿æå¹ç­æ§ï¼ä¸ç®¡æ¥å¤å°æ¡éå¤æ¶æ¯ï¼æåå¤ççç»æé½ä¸æ ·ã ä¿è¯æ¯æ¡æ¶æ¯é½æå¯ä¸ç¼å·ä¸ä¿è¯æ¶æ¯å¤çæåä¸å»éè¡¨çæ¥å¿åæ¶åºç°ãå©ç¨ä¸å¼ æ¥å¿è¡¨æ¥è®°å½å·²ç»å¤çæåçæ¶æ¯ç IDï¼å¦ææ°å°çæ¶æ¯ ID å·²ç»å¨æ¥å¿è¡¨ä¸­ï¼é£ä¹å°±ä¸åå¤çè¿æ¡æ¶æ¯ã\n\n\n# 2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ åæä»ä¹ä¼ç¼ºç¹ï¼\n\n\n## 3. åå¸å¼æå¡ï¼RPCï¼\n\n\n# 3.1. Dubbo çå®ç°è¿ç¨ï¼\n\n\n\nèç¹è§è²ï¼\n\nèç¹          è§è²è¯´æ\nProvider    æ´é²æå¡çæå¡æä¾æ¹\nConsumer    è°ç¨è¿ç¨æå¡çæå¡æ¶è´¹æ¹\nRegistry    æå¡æ³¨åä¸åç°çæ³¨åä¸­å¿\nMonitor     ç»è®¡æå¡çè°ç¨æ¬¡æ°åè°ç¨æ¶é´ççæ§ä¸­å¿\nContainer   æå¡è¿è¡å®¹å¨\n\nè°ç¨å³ç³»ï¼\n\n 1. å¡å®¹å¨è´è´£å¯å¨ï¼å è½½ï¼è¿è¡æå¡æä¾èã\n 2. æå¡æä¾èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿æ³¨åèªå·±æä¾çæå¡ã\n 3. æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿è®¢éèªå·±æéçæå¡ã\n 4. æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æ¶è´¹èï¼å¦ææåæ´ï¼æ³¨åä¸­å¿å°åºäºé¿è¿æ¥æ¨éåæ´æ°æ®ç»æ¶è´¹èã\n 5. æå¡æ¶è´¹èï¼ä»æä¾èå°ååè¡¨ä¸­ï¼åºäºè½¯è´è½½åè¡¡ç®æ³ï¼éä¸å°æä¾èè¿è¡è°ç¨ï¼å¦æè°ç¨å¤±è´¥ï¼åéå¦ä¸å°è°ç¨ã\n 6. æå¡æ¶è´¹èåæä¾èï¼å¨åå­ä¸­ç´¯è®¡è°ç¨æ¬¡æ°åè°ç¨æ¶é´ï¼å®æ¶æ¯åéåéä¸æ¬¡ç»è®¡æ°æ®å°çæ§ä¸­å¿ã\n\n\n# 3.2. Dubbo è´è½½åè¡¡ç­ç¥æåªäºï¼\n\n# Random\n\n * éæºï¼ææéè®¾ç½®éæºæ¦çã\n * å¨ä¸ä¸ªæªé¢ä¸ç¢°æçæ¦çé«ï¼ä½è°ç¨éè¶å¤§åå¸è¶ååï¼èä¸ææ¦çä½¿ç¨æéåä¹æ¯è¾ååï¼æå©äºå¨æè°æ´æä¾èæéã\n\n# RoundRobin\n\n * è½®å¾ªï¼æå¬çº¦åçæéè®¾ç½®è½®å¾ªæ¯çã\n * å­å¨æ¢çæä¾èç´¯ç§¯è¯·æ±çé®é¢ï¼æ¯å¦ï¼ç¬¬äºå°æºå¨å¾æ¢ï¼ä½æ²¡æï¼å½è¯·æ±è°å°ç¬¬äºå°æ¶å°±å¡å¨é£ï¼ä¹èä¹ä¹ï¼ææè¯·æ±é½å¡å¨è°å°ç¬¬äºå°ä¸ã\n\n# LeastActive\n\n * æå°æ´»è·è°ç¨æ°ï¼ç¸åæ´»è·æ°çéæºï¼æ´»è·æ°æè°ç¨ååè®¡æ°å·®ã\n * ä½¿æ¢çæä¾èæ¶å°æ´å°è¯·æ±ï¼å ä¸ºè¶æ¢çæä¾èçè°ç¨ååè®¡æ°å·®ä¼è¶å¤§ã\n\n# ConsistentHash\n\n * ä¸è´æ§ Hashï¼ç¸ååæ°çè¯·æ±æ»æ¯åå°åä¸æä¾èã\n * å½æä¸å°æä¾èææ¶ï¼åæ¬åå¾è¯¥æä¾èçè¯·æ±ï¼åºäºèæèç¹ï¼å¹³æå°å¶å®æä¾èï¼ä¸ä¼å¼èµ·å§çåå¨ã\n * ç®æ³åè§ï¼http://en.wikipedia.org/wiki/Consistent_hashing\n * ç¼ºçåªå¯¹ç¬¬ä¸ä¸ªåæ° Hashï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.arguments" value="0,1" />\n * ç¼ºçç¨ 160 ä»½èæèç¹ï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.nodes" value="320" />\n\n\n# 3.3. Dubbo éç¾¤å®¹éç­ç¥ ï¼\n\n\n- **Failover** - å¤±è´¥èªå¨åæ¢ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãå¯éè¿ retries="2" æ¥è®¾ç½®éè¯æ¬¡æ°(ä¸å«ç¬¬ä¸æ¬¡)ã - **Failfast** - å¿«éå¤±è´¥ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ã - **Failsafe** - å¤±è´¥å®å¨ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã - **Failback** - å¤±è´¥èªå¨æ¢å¤ï¼åå°è®°å½å¤±è´¥è¯·æ±ï¼å®æ¶éåãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã - **Forking** - å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºãå¯éè¿ forks="2" æ¥è®¾ç½®æå¤§å¹¶è¡æ°ã - **Broadcast** - æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\n\n# 3.4. å¨æä»£çç­ç¥ï¼\n\nDubbo ä½ä¸º RPC æ¡æ¶ï¼é¦åè¦å®æçå°±æ¯è·¨ç³»ç»ï¼è·¨ç½ç»çæå¡è°ç¨ãæ¶è´¹æ¹ä¸æä¾æ¹éµå¾ªç»ä¸çæ¥å£å®ä¹ï¼æ¶è´¹æ¹è°ç¨æ¥å£æ¶ï¼Dubbo å°å¶è½¬æ¢æç»ä¸æ ¼å¼çæ°æ®ç»æï¼éè¿ç½ç»ä¼ è¾ï¼æä¾æ¹æ ¹æ®è§åæ¾å°æ¥å£å®ç°ï¼éè¿åå°å®æè°ç¨ãä¹å°±æ¯è¯´ï¼æ¶è´¹æ¹è·åçæ¯å¯¹è¿ç¨æå¡çä¸ä¸ªä»£ç(Proxy)ï¼èæä¾æ¹å ä¸ºè¦æ¯æä¸åçæ¥å£å®ç°ï¼éè¦ä¸ä¸ªåè£å±(Wrapper)ãè°ç¨çè¿ç¨å¤§æ¦æ¯è¿æ ·ï¼\n\n\næ¶è´¹æ¹ç Proxy åæä¾æ¹ç Wrapper å¾ä»¥è®© Dubbo æå»ºåºå¤æãç»ä¸çä½ç³»ãèè¿ç§å¨æä»£çä¸åè£ä¹æ¯éè¿åºäº SPI çæä»¶æ¹å¼å®ç°çï¼å®çæ¥å£å°±æ¯**ProxyFactory**ã\n\n@SPI("javassist")\npublic interface ProxyFactory {\n\n    @Adaptive({Constants.PROXY_KEY})\n    <T> T getProxy(Invoker<T> invoker) throws RpcException;\n\n    @Adaptive({Constants.PROXY_KEY})\n    <T> Invoker<T> getInvoker(T proxy, Class<T> type, URL url) throws RpcException;\n\n}\n\n\nProxyFactory æä¸¤ç§å®ç°æ¹å¼ï¼ä¸ç§æ¯åºäº JDK çä»£çå®ç°ï¼ä¸ç§æ¯åºäº javassist çå®ç°ãProxyFactory æ¥å£ä¸å®ä¹äº@SPI("javassist")ï¼é»è®¤ä¸º javassist çå®ç°ã\n\n\n# 3.5. Dubbo æ¯æåªäºåºåååè®®ï¼Hessianï¼Hessian çæ°æ®ç»æï¼\n\n 1. dubbo åºååï¼é¿éå°ä¸æçç java åºååå®ç°ã\n 2. hessian2 åºååï¼hessian æ¯ä¸ç§è·¨è¯­è¨çé«æäºè¿å¶çåºååæ¹å¼ï¼ä½è¿éå®éä¸æ¯åçç hessian2 åºååï¼èæ¯é¿éä¿®æ¹è¿ç hessian liteï¼å®æ¯ dubbo RPC é»è®¤å¯ç¨çåºååæ¹å¼ã\n 3. json åºååï¼ç®åæä¸¤ç§å®ç°ï¼ä¸ç§æ¯éç¨çé¿éç fastjson åºï¼å¦ä¸ç§æ¯éç¨ dubbo ä¸­èªå·²å®ç°çç®å json åºï¼ä¸è¬æåµä¸ï¼json è¿ç§ææ¬åºååæ§è½ä¸å¦äºè¿å¶åºååã\n 4. java åºååï¼ä¸»è¦æ¯éç¨ JDK èªå¸¦ç java åºååå®ç°ï¼æ§è½å¾ä¸çæ³ã\n 5. Kryo å FSTï¼Kryo å FST çæ§è½ä¾ç¶æ®éä¼äº hessian å dubbo åºååã\n\nHessian åºååä¸ Java é»è®¤çåºåååºå«ï¼\n\nHessian æ¯ä¸ä¸ªè½»éçº§ç remoting on http å·¥å·ï¼éç¨çæ¯ Binary RPC åè®®ï¼æä»¥å®å¾éåäºåéäºè¿å¶æ°æ®ï¼åæ¶åå·æé²ç«å¢ç©¿éè½åã\n\n 1. Hessian æ¯æè·¨è¯­è¨ä¸²è¡\n 2. æ¯ java åºååå·ææ´å¥½çæ§è½åæç¨æ§\n 3. æ¯æçè¯­è¨æ¯è¾å¤\n\n\n# 3.6. Protoco Buffer æ¯ä»ä¹ï¼\n\nProtocol Buffer æ¯ Google åºåçä¸ç§è½»é & é«æçç»æåæ°æ®å­å¨æ ¼å¼ï¼æ§è½æ¯ JsonãXML ççå¼ºï¼å¤ªï¼å¤ï¼\n\nProtocol Buffer çåºåå & ååºååç®å & éåº¦å¿«çåå æ¯ï¼\n\n 1. ç¼ç  / è§£ç  æ¹å¼ç®åï¼åªéè¦ç®åçæ°å­¦è¿ç® = ä½ç§»ç­ç­ï¼\n 2. éç¨ Protocol Buffer èªèº«çæ¡æ¶ä»£ç  å ç¼è¯å¨ å±åå®æ\n\nProtocol Buffer çæ°æ®åç¼©ææå¥½ï¼å³åºåååçæ°æ®éä½ç§¯å°ï¼çåå æ¯ï¼\n\n 1. éç¨äºç¬ç¹çç¼ç æ¹å¼ï¼å¦ VarintãZigzag ç¼ç æ¹å¼ç­ç­\n 2. éç¨ T - L - V çæ°æ®å­å¨æ¹å¼ï¼åå°äºåéç¬¦çä½¿ç¨ & æ°æ®å­å¨å¾ç´§å\n\n\n# 3.7. æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼\n\nå¯ä»¥ãDubbo æ¶è´¹èå¨åºç¨å¯å¨æ¶ä¼ä»æ³¨åä¸­å¿æåå·²æ³¨åççäº§èçå°åæ¥å£ï¼å¹¶ç¼å­å¨æ¬å°ãæ¯æ¬¡è°ç¨æ¶ï¼æç§æ¬å°å­å¨çå°åè¿è¡è°ç¨ã\n\n\n# 3.8. ZooKeeper åçæ¯ä»ä¹ï¼ZooKeeper æä»ä¹ç¨ï¼\n\nZooKeeper æ¯ä¸ä¸ªåå¸å¼åºç¨åè°ç³»ç»ï¼å·²ç»ç¨å°äºè®¸å¤åå¸å¼é¡¹ç®ä¸­ï¼ç¨æ¥å®æç»ä¸å½åæå¡ãç¶æåæ­¥æå¡ãéç¾¤ç®¡çãåå¸å¼åºç¨éç½®é¡¹çç®¡çç­å·¥ä½ã\n\n\n 1. æ¯ä¸ª Server å¨åå­ä¸­å­å¨äºä¸ä»½æ°æ®ï¼\n 2. Zookeeper å¯å¨æ¶ï¼å°ä»å®ä¾ä¸­éä¸¾ä¸ä¸ª leaderï¼Paxos åè®®ï¼ï¼\n 3. Leader è´è´£å¤çæ°æ®æ´æ°ç­æä½ï¼Zab åè®®ï¼ï¼\n 4. ä¸ä¸ªæ´æ°æä½æåï¼å½ä¸ä»å½å¤§å¤æ° Server å¨åå­ä¸­æåä¿®æ¹æ°æ®ã\n\n\n# 3.9. Netty æä»ä¹ç¨ï¼NIO/BIO/AIO æä»ä¹ç¨ï¼æä»ä¹åºå«ï¼\n\nNetty æ¯ä¸ä¸ªâç½ç»éè®¯æ¡æ¶âã\n\nNetty è¿è¡äºä»¶å¤ççæµç¨ãChannelæ¯è¿æ¥çééï¼æ¯ ChannelEvent çäº§çèï¼èChannelPipelineå¯ä»¥çè§£ä¸º ChannelHandler çéåã\n\n\n> åèï¼https://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md\n\nIO çæ¹å¼éå¸¸åä¸ºå ç§ï¼\n\n * åæ­¥é»å¡ç BIO\n * åæ­¥éé»å¡ç NIO\n * å¼æ­¥éé»å¡ç AIO\n\nå¨ä½¿ç¨åæ­¥ I/O çç½ç»åºç¨ä¸­ï¼å¦æè¦åæ¶å¤çå¤ä¸ªå®¢æ·ç«¯è¯·æ±ï¼ææ¯å¨å®¢æ·ç«¯è¦åæ¶åå¤ä¸ªæå¡å¨è¿è¡éè®¯ï¼å°±å¿é¡»ä½¿ç¨å¤çº¿ç¨æ¥å¤çã\n\nNIO åºäº Reactorï¼å½ socket ææµå¯è¯»æå¯åå¥ socket æ¶ï¼æä½ç³»ç»ä¼ç¸åºçéç¥å¼ç¨ç¨åºè¿è¡å¤çï¼åºç¨åå°æµè¯»åå°ç¼å²åºæåå¥æä½ç³»ç»ãä¹å°±æ¯è¯´ï¼è¿ä¸ªæ¶åï¼å·²ç»ä¸æ¯ä¸ä¸ªè¿æ¥å°±è¦å¯¹åºä¸ä¸ªå¤ççº¿ç¨äºï¼èæ¯ææçè¯·æ±ï¼å¯¹åºä¸ä¸ªçº¿ç¨ï¼å½è¿æ¥æ²¡ææ°æ®æ¶ï¼æ¯æ²¡æå·¥ä½çº¿ç¨æ¥å¤ççã\n\nä¸ NIO ä¸åï¼å½è¿è¡è¯»åæä½æ¶ï¼åªé¡»ç´æ¥è°ç¨ API ç read æ write æ¹æ³å³å¯ãè¿ä¸¤ç§æ¹æ³åä¸ºå¼æ­¥çï¼å¯¹äºè¯»æä½èè¨ï¼å½ææµå¯è¯»åæ¶ï¼æä½ç³»ç»ä¼å°å¯è¯»çæµä¼ å¥ read æ¹æ³çç¼å²åºï¼å¹¶éç¥åºç¨ç¨åºï¼å¯¹äºåæä½èè¨ï¼å½æä½ç³»ç»å° write æ¹æ³ä¼ éçæµåå¥å®æ¯æ¶ï¼æä½ç³»ç»ä¸»å¨éç¥åºç¨ç¨åºã å³å¯ä»¥çè§£ä¸ºï¼read/write æ¹æ³é½æ¯å¼æ­¥çï¼å®æåä¼ä¸»å¨è°ç¨åè°å½æ°ã\n\n> åèï¼https://blog.csdn.net/skiof007/article/details/52873421\n\n\n# 3.10. ä¸ºä»ä¹è¦è¿è¡ç³»ç»æåï¼æåä¸ç¨ Dubbo å¯ä»¥åï¼\n\nç³»ç»æåä»èµæºè§åº¦åä¸ºï¼åºç¨æååæ°æ®åºæåã\n\nä»éç¨çååé¡ºåºå¯åä¸ºï¼æ°´å¹³æ©å±ãåç´æåãä¸å¡æåãæ°´å¹³æåã\n\n\næ¯å¦ä½¿ç¨æå¡ä¾æ®å®éä¸å¡åºæ¯æ¥å³å®ã\n\nå½åç´åºç¨è¶æ¥è¶å¤ï¼åºç¨ä¹é´äº¤äºä¸å¯é¿åï¼å°æ ¸å¿ä¸å¡æ½ååºæ¥ï¼ä½ä¸ºç¬ç«çæå¡ï¼éæ¸å½¢æç¨³å®çæå¡ä¸­å¿ï¼ä½¿åç«¯åºç¨è½æ´å¿«éçååºå¤åçå¸åºéæ±ãæ­¤æ¶ï¼ç¨äºæé«ä¸å¡å¤ç¨åæ´åçåå¸å¼æå¡æ¡æ¶(RPC)æ¯å³é®ã\n\nå½æå¡è¶æ¥è¶å¤ï¼å®¹éçè¯ä¼°ï¼å°æå¡èµæºçæµªè´¹ç­é®é¢éæ¸æ¾ç°ï¼æ­¤æ¶éå¢å ä¸ä¸ªè°åº¦ä¸­å¿åºäºè®¿é®ååå®æ¶ç®¡çéç¾¤å®¹éï¼æé«éç¾¤å©ç¨çãæ­¤æ¶ï¼ç¨äºæé«æºå¨å©ç¨ççèµæºè°åº¦åæ²»çä¸­å¿(SOA)æ¯å³é®ã\n\n\n# 3.11. Dubbo å Thrift æä»ä¹åºå«ï¼\n\n * Thrift æ¯è·¨è¯­è¨ç RPC æ¡æ¶ã\n * Dubbo æ¯ææå¡æ²»çï¼è Thrift ä¸æ¯æã\n\n\n# 4. åå¸å¼éåºæ¬åç\n\n> åå¸å¼éæå ç§å®ç°æ¹å¼ï¼å®ç°çè¦ç¹æ¯ä»ä¹ï¼\n> \n> åå¸å¼éåæ¹æ¡æä»ä¹å©å¼ï¼å¦ä½éæ©æ¹æ¡ï¼ä¸ºä»ä¹ï¼\n> \n> Redis åå¸å¼éå¦ä½ä¿è¯å¯éå¥æ§ï¼\n> \n> è¯¦ç»åå®¹è¯·åèï¼åå¸å¼é\n\nãç­é¢æè·¯ã\n\nå®ç°æ¹å¼ä¸è¬æï¼\n\n * åºäºæ°æ®åºå®ç°ï¼\n   * å»ºä¸å¼ è¡¨ï¼t_dlockï¼ï¼å³é®å­æ®µæï¼idãmethod_nameãtimeã\n   * åè¡¨ä¸­æå¥è®°å½æåï¼å³ä¸ºè·åéæåãéè¦æ³¨æçæ¯ï¼è·åéä¸è¬æ¯éè¿èªææ¹å¼ï¼å¹¶è®¾ç½®å°è¯æ¬¡æ°ï¼è¶è¿æå¤§å°è¯æ¬¡æ°ï¼æå¤å®è·åéå¤±è´¥ã\n   * å é¤è®°å½ï¼å³ä¸ºéæ¾éã\n   * å ä¸ºæ°æ®åºæ²¡ææ·æ±°æºå¶ï¼ä¸ºäºé¿åè·åéæ°¸ä¸éæ¾ï¼åºç¨éè¦èªèº«å®ç°å®ææ£æ¥ï¼å é¤è¿æè®°å½ï¼æ ¹æ® time å¤æ­ï¼ã\n * åºäº Redis å®ç°\n   * çæä¸ä¸ªåå¸å¼ ID ä½ä¸º keyï¼éè¿ setnx åå¥\n   * åå¥æåï¼å³ä¸ºè·åéæåãéè¦æ³¨æçæ¯ï¼è·åéä¸è¬æ¯éè¿èªææ¹å¼ï¼å¹¶è®¾ç½®å°è¯æ¬¡æ°ï¼è¶è¿æå¤§å°è¯æ¬¡æ°ï¼æå¤å®è·åéå¤±è´¥ã\n   * å é¤ keyï¼å³ä¸ºè·åéå¤±è´¥ã\n   * Redis èªèº«æåå­æ·æ±°ç­ç¥ï¼æä»¥åªè¦è®¾ç½® expireï¼å°±å¯ä»¥è®© key èªå¨è¿æã\n * åºäº ZooKeeper å®ç°\n   * åå»ºä¸ä¸ªèç¹ï¼ææèç¹é½ Watch æ­¤èç¹ã\n   * ä»»æèç¹çä»»æçº¿ç¨åªè¦åè¿ä¸ªèç¹åå»ºä¸´æ¶å­èç¹æåï¼å³ä¸ºè·åéæåã\n   * ç±äºåå»ºä¸´æ¶å­èç¹æ¯åå­æ§çï¼ä¸å­å¨ç«æï¼ä¸éè¦èªæå°è¯ï¼æ§è½å¾å¥½ã\n   * å ä¸º ZooKeeper åªè¦åèç¹æ­å¼ä¼è¯ï¼å°±ä¼èªå¨å é¤ä¸´æ¶èç¹ãå³ä¸ºå é¤éãæä»¥æ éè¿ææºå¶ã\n\nä»å®ç°æ¹å¼å¯ä»¥çåºï¼ä¸ç§æ¹æ¡çå¯¹æ¯ï¼\n\n * Mysql æ¹æ¡æ§è½æå·®ï¼å¹¶ä¸å½±å Mysql ååéãèä¸è¿è¦ç¨åºä¿è¯å®¹éå¤çãä¸å»ºè®®éç¨è¿ç§æ¹æ¡ã\n * Redis æ¹æ¡éè¦ä¸æ­èªæå°è¯è·åéï¼åºç¨ä¼æ¶èä¸äºæ§è½å¼éãèä¸ä¸ºäºä¿è¯åå¸å¼éçå¯éå¥æ§ï¼éè¦è®¾ç½®å¯¹äºææèç¹ãææçº¿ç¨é½å¯ä¸çåå¸å¼ IDï¼çæ ID ä¹éè¦ä¸å®ç CPU å¼éã\n * ZooKeeper æ¹æ¡å®ç°æç®åï¼æç¨³å®ãæ¯æ¨èçæ¹æ¡ãä½æ¯å®ä¹æä¸ä¸ªé®é¢ï¼ZooKeeper çä¸»ä»æ¶æï¼ææåé½ç± Master èç¹è´è´£ï¼æä»¥ ZooKeeper èªèº«æä¸å®çæ§è½ç¶é¢ã',normalizedContent:'# åå¸å¼é¢è¯æ»ç»\n\n\n# 1. åå¸å¼ç¼å­\n\n\n# 1.1. redis æä»ä¹æ°æ®ç±»åï¼åå«ç¨äºä»ä¹åºæ¯\n\næ°æ®ç±»å     å¯ä»¥å­å¨çå¼        æä½\nstring   å­ç¬¦ä¸²ãæ´æ°æèæµ®ç¹æ°   å¯¹æ´ä¸ªå­ç¬¦ä¸²æèå­ç¬¦ä¸²çå¶ä¸­ä¸é¨åæ§è¡æä½\n                       å¯¹æ´æ°åæµ®ç¹æ°æ§è¡èªå¢æèèªåæä½\nlist     åè¡¨            ä»ä¸¤ç«¯åå¥æèå¼¹åºåç´ \n                       è¯»ååä¸ªæèå¤ä¸ªåç´ \n                       è¿è¡ä¿®åªï¼åªä¿çä¸ä¸ªèå´åçåç´ \nset      æ åºéå          æ·»å ãè·åãç§»é¤åä¸ªåç´ \n                       æ£æ¥ä¸ä¸ªåç´ æ¯å¦å­å¨äºéåä¸­\n                       è®¡ç®äº¤éãå¹¶éãå·®é\n                       ä»éåéé¢éæºè·ååç´ \nhash     åå«é®å¼å¯¹çæ åºæ£åè¡¨   æ·»å ãè·åãç§»é¤åä¸ªé®å¼å¯¹\n                       è·åææé®å¼å¯¹\n                       æ£æ¥æä¸ªé®æ¯å¦å­å¨\nzset     æåºéå          æ·»å ãè·åãå é¤åç´ \n                       æ ¹æ®åå¼èå´æèæåæ¥è·ååç´ \n                       è®¡ç®ä¸ä¸ªé®çæå\n\n> what redis data structures look like\n\n\n# 1.2. redis çä¸»ä»å¤å¶æ¯å¦ä½å®ç°ç\n\n 1. ä»æå¡å¨è¿æ¥ä¸»æå¡å¨ï¼åé sync å½ä»¤ï¼\n 2. ä¸»æå¡å¨æ¥æ¶å° sync å½ååï¼å¼å§æ§è¡ bgsave å½ä»¤çæ rdb æä»¶å¹¶ä½¿ç¨ç¼å²åºè®°å½æ­¤åæ§è¡çææåå½ä»¤ï¼\n 3. ä¸»æå¡å¨ bgsave æ§è¡å®åï¼åææä»æå¡å¨åéå¿«ç§æä»¶ï¼å¹¶å¨åéæé´ç»§ç»­è®°å½è¢«æ§è¡çåå½ä»¤ï¼\n 4. ä»æå¡å¨æ¶å°å¿«ç§æä»¶åä¸¢å¼æææ§æ°æ®ï¼è½½å¥æ¶å°çå¿«ç§ï¼\n 5. ä¸»æå¡å¨å¿«ç§åéå®æ¯åå¼å§åä»æå¡å¨åéç¼å²åºä¸­çåå½ä»¤ï¼\n 6. ä»æå¡å¨å®æå¯¹å¿«ç§çè½½å¥ï¼å¼å§æ¥æ¶å½ä»¤è¯·æ±ï¼å¹¶æ§è¡æ¥èªä¸»æå¡å¨ç¼å²åºçåå½ä»¤ï¼\n\n\n# 1.3. redis ç key æ¯å¦ä½å¯»åç\n\n# 1.3.1. èæ¯\n\nï¼1ï¼redis ä¸­çæ¯ä¸ä¸ªæ°æ®åºï¼é½ç±ä¸ä¸ª redisdb çç»æå­å¨ãå¶ä¸­ï¼\n\n * redisdb.id å­å¨ç redis æ°æ®åºä»¥æ´æ°è¡¨ç¤ºçå·ç ã\n * redisdb.dict å­å¨çè¯¥åºææçé®å¼å¯¹æ°æ®ã\n * redisdb.expires ä¿å­çæ¯ä¸ä¸ªé®çè¿ææ¶é´ã\n\nï¼2ï¼å½ redis æå¡å¨åå§åæ¶ï¼ä¼é¢ååé 16 ä¸ªæ°æ®åºï¼è¯¥æ°éå¯ä»¥éè¿éç½®æä»¶éç½®ï¼ï¼æææ°æ®åºä¿å­å°ç»æ redisserver çä¸ä¸ªæå redisserver.db æ°ç»ä¸­ãå½æä»¬éæ©æ°æ®åº select number æ¶ï¼ç¨åºç´æ¥éè¿ redisserver.db[number] æ¥åæ¢æ°æ®åºãææ¶åå½ç¨åºéè¦ç¥éèªå·±æ¯å¨åªä¸ªæ°æ®åºæ¶ï¼ç´æ¥è¯»å redisdb.id å³å¯ã\n\nï¼3ï¼redis çå­å¸ä½¿ç¨åå¸è¡¨ä½ä¸ºå¶åºå±å®ç°ãdict ç±»åä½¿ç¨çä¸¤ä¸ªæååå¸è¡¨çæéï¼å¶ä¸­ 0 å·åå¸è¡¨ï¼ht[0]ï¼ä¸»è¦ç¨äºå­å¨æ°æ®åºçææé®å¼ï¼è 1 å·åå¸è¡¨ä¸»è¦ç¨äºç¨åºå¯¹ 0 å·åå¸è¡¨è¿è¡ rehash æ¶ä½¿ç¨ï¼rehash ä¸è¬æ¯å¨æ·»å æ°å¼æ¶ä¼è§¦åï¼è¿éä¸åè¿å¤çèµè¿°ãæä»¥ redis ä¸­æ¥æ¾ä¸ä¸ª keyï¼å¶å®å°±æ¯å¯¹è¿è¡è¯¥ dict ç»æä¸­ç ht[0] è¿è¡æ¥æ¾æä½ã\n\nï¼4ï¼æ¢ç¶æ¯åå¸ï¼é£ä¹æä»¬ç¥éå°±ä¼æåå¸ç¢°æï¼é£ä¹å½å¤ä¸ªé®åå¸ä¹åä¸ºåä¸ä¸ªå¼æä¹åå¢ï¼redis éåé¾è¡¨çæ¹å¼æ¥å­å¨å¤ä¸ªåå¸ç¢°æçé®ãä¹å°±æ¯è¯´ï¼å½æ ¹æ® key çåå¸å¼æ¾å°è¯¥åè¡¨åï¼å¦æåè¡¨çé¿åº¦å¤§äº 1ï¼é£ä¹æä»¬éè¦éåè¯¥é¾è¡¨æ¥æ¾å°æä»¬ææ¥æ¾ç keyãå½ç¶ï¼ä¸è¬æåµä¸é¾è¡¨é¿åº¦é½ä¸ºæ¯ 1ï¼æä»¥æ¶é´å¤æåº¦å¯çä½ o(1)ã\n\n# 1.3.2. å¯»å key çæ­¥éª¤\n\n 1. å½æ¿å°ä¸ä¸ª key åï¼redis åå¤æ­å½ååºç 0 å·åå¸è¡¨æ¯å¦ä¸ºç©ºï¼å³ï¼if (dict->ht[0].size == 0)ãå¦æä¸º true ç´æ¥è¿å nullã\n 2. å¤æ­è¯¥ 0 å·åå¸è¡¨æ¯å¦éè¦ rehashï¼å ä¸ºå¦æå¨è¿è¡ rehashï¼é£ä¹ä¸¤ä¸ªè¡¨ä¸­èæå¯è½å­å¨è¯¥ keyãå¦ææ­£å¨è¿è¡ rehashï¼å°è°ç¨ä¸æ¬¡_dictrehashstep æ¹æ³ï¼_dictrehashstep ç¨äºå¯¹æ°æ®åºå­å¸ãä»¥ååå¸é®çå­å¸è¿è¡è¢«å¨ rehashï¼è¿éä¸ä½èµè¿°ã\n 3. è®¡ç®åå¸è¡¨ï¼æ ¹æ®å½åå­å¸ä¸ key è¿è¡åå¸å¼çè®¡ç®ã\n 4. æ ¹æ®åå¸å¼ä¸å½åå­å¸è®¡ç®åå¸è¡¨çç´¢å¼å¼ã\n 5. æ ¹æ®ç´¢å¼å¼å¨åå¸è¡¨ä¸­ååºé¾è¡¨ï¼éåè¯¥é¾è¡¨æ¾å° key çä½ç½®ãä¸è¬æåµï¼è¯¥é¾è¡¨é¿åº¦ä¸º 1ã\n 6. å½ ht[0] æ¥æ¾å®äºä¹åï¼åè¿è¡äºæ¬¡ rehash å¤æ­ï¼å¦ææªå¨ rehashingï¼åç´æ¥ç»æï¼å¦åå¯¹ ht[1]éå¤ 345 æ­¥éª¤ã\n\n\n# 1.4. redis çéç¾¤æ¨¡å¼æ¯å¦ä½å®ç°çï¼\n\nredis cluster æ¯ redis çåå¸å¼è§£å³æ¹æ¡ï¼å¨ redis 3.0 çæ¬æ­£å¼æ¨åºçã\n\nredis cluster å»ä¸­å¿åï¼æ¯ä¸ªèç¹ä¿å­æ°æ®åæ´ä¸ªéç¾¤ç¶æï¼æ¯ä¸ªèç¹é½åå¶ä»ææèç¹è¿æ¥ã\n\n# 1.4.1. redis cluster èç¹åé\n\nredis cluster ç¹ç¹ï¼\n\n 1. ææç redis èç¹å½¼æ­¤äºè(ping-pong æºå¶)ï¼åé¨ä½¿ç¨äºè¿å¶åè®®ä¼åä¼ è¾éåº¦åå¸¦å®½ã\n 2. èç¹ç fail æ¯éè¿éç¾¤ä¸­è¶è¿åæ°çèç¹æ£æµå¤±ææ¶æçæã\n 3. å®¢æ·ç«¯ä¸ redis èç¹ç´è¿,ä¸éè¦ä¸­é´ proxy å±ãå®¢æ·ç«¯ä¸éè¦è¿æ¥éç¾¤ææèç¹ï¼è¿æ¥éç¾¤ä¸­ä»»ä½ä¸ä¸ªå¯ç¨èç¹å³å¯ã\n 4. redis-cluster æææçç©çèç¹æ å°å°[0-16383] åå¸æ§½ (hash slot)ä¸ï¼ä¸ä¸å®æ¯å¹³ååéï¼,cluster è´è´£ç»´æ¤ node<->slot<->valueã\n 5. redis éç¾¤é¢åå¥½ 16384 ä¸ªæ¡¶ï¼å½éè¦å¨ redis éç¾¤ä¸­æ¾ç½®ä¸ä¸ª key-value æ¶ï¼æ ¹æ® crc16(key) mod 16384 çå¼ï¼å³å®å°ä¸ä¸ª key æ¾å°åªä¸ªæ¡¶ä¸­ã\n\n# 1.4.2. redis cluster ä¸»ä»æ¨¡å¼\n\nredis cluster ä¸ºäºä¿è¯æ°æ®çé«å¯ç¨æ§ï¼å å¥äºä¸»ä»æ¨¡å¼ã\n\nä¸ä¸ªä¸»èç¹å¯¹åºä¸ä¸ªæå¤ä¸ªä»èç¹ï¼ä¸»èç¹æä¾æ°æ®å­åï¼ä»èç¹åæ¯ä»ä¸»èç¹æåæ°æ®å¤ä»½ãå½è¿ä¸ªä¸»èç¹ææåï¼å°±ä¼æè¿ä¸ªä»èç¹éåä¸ä¸ªæ¥åå½ä¸»èç¹ï¼ä»èä¿è¯éç¾¤ä¸ä¼ææãæä»¥ï¼å¨éç¾¤å»ºç«çæ¶åï¼ä¸å®è¦ä¸ºæ¯ä¸ªä¸»èç¹é½æ·»å äºä»èç¹ã\n\n# 1.4.3. redis sentinel\n\nredis sentinel ç¨äºç®¡çå¤ä¸ª redis æå¡å¨ï¼å®æä¸ä¸ªåè½ï¼\n\n * çæ§ï¼monitoringï¼ - sentinel ä¼ä¸æ­å°æ£æ¥ä½ çä¸»æå¡å¨åä»æå¡å¨æ¯å¦è¿ä½æ­£å¸¸ã\n * æéï¼notificationï¼ - å½è¢«çæ§çæä¸ª redis æå¡å¨åºç°é®é¢æ¶ï¼ sentinel å¯ä»¥éè¿ api åç®¡çåæèå¶ä»åºç¨ç¨åºåééç¥ã\n * èªå¨æéè¿ç§»ï¼automatic failoverï¼ - å½ä¸ä¸ªä¸»æå¡å¨ä¸è½æ­£å¸¸å·¥ä½æ¶ï¼ sentinel ä¼å¼å§ä¸æ¬¡èªå¨æéè¿ç§»æä½ï¼ å®ä¼å°å¤±æä¸»æå¡å¨çå¶ä¸­ä¸ä¸ªä»æå¡å¨åçº§ä¸ºæ°çä¸»æå¡å¨ï¼ å¹¶è®©å¤±æä¸»æå¡å¨çå¶ä»ä»æå¡å¨æ¹ä¸ºå¤å¶æ°çä¸»æå¡å¨ï¼ å½å®¢æ·ç«¯è¯å¾è¿æ¥å¤±æçä¸»æå¡å¨æ¶ï¼ éç¾¤ä¹ä¼åå®¢æ·ç«¯è¿åæ°ä¸»æå¡å¨çå°åï¼ ä½¿å¾éç¾¤å¯ä»¥ä½¿ç¨æ°ä¸»æå¡å¨ä»£æ¿å¤±ææå¡å¨ã\n\nredis éç¾¤ä¸­åºè¯¥æå¥æ°ä¸ªèç¹ï¼æä»¥è³å°æä¸ä¸ªèç¹ã\n\nå¨åµçæ§éç¾¤ä¸­çä¸»æå¡å¨åºç°æéæ¶ï¼éè¦æ ¹æ® quorum éä¸¾åºä¸ä¸ªå¨åµæ¥æ§è¡æéè½¬ç§»ãéä¸¾éè¦ majorityï¼å³å¤§å¤æ°å¨åµæ¯è¿è¡çï¼2 ä¸ªå¨åµç majority=2ï¼3 ä¸ªå¨åµç majority=2ï¼5 ä¸ªå¨åµç majority=3ï¼4 ä¸ªå¨åµç majority=2ï¼ã\n\nåè®¾éç¾¤ä»ä»é¨ç½² 2 ä¸ªèç¹\n\n+----+         +----+\n| m1 |---------| r1 |\n| s1 |         | s2 |\n+----+         +----+\n\n\nå¦æ m1 å s1 æå¨æå¡å¨å®æºï¼åå¨åµåªæ 1 ä¸ªï¼æ æ³æ»¡è¶³ majority æ¥è¿è¡éä¸¾ï¼å°±ä¸è½æ§è¡æéè½¬ç§»ã\n\n\n# 1.5. redis å¦ä½å®ç°åå¸å¼éï¼zookeeper å¦ä½å®ç°åå¸å¼éï¼æ¯è¾äºèä¼å£ï¼\n\nåå¸å¼éçä¸ç§å®ç°ï¼\n\n * åºäºæ°æ®åºå®ç°åå¸å¼éï¼\n * åºäºç¼å­ï¼redis ç­ï¼å®ç°åå¸å¼éï¼\n * åºäº zookeeper å®ç°åå¸å¼éï¼\n\n# 1.5.1. æ°æ®åºå®ç°\n\n# 1.5.2. redis å®ç°\n\n 1. è·åéçæ¶åï¼ä½¿ç¨ setnx å éï¼å¹¶ä½¿ç¨ expire å½ä»¤ä¸ºéæ·»å ä¸ä¸ªè¶æ¶æ¶é´ï¼è¶è¿è¯¥æ¶é´åèªå¨éæ¾éï¼éç value å¼ä¸ºä¸ä¸ªéæºçæç uuidï¼éè¿æ­¤å¨éæ¾éçæ¶åè¿è¡å¤æ­ã\n 2. è·åéçæ¶åè¿è®¾ç½®ä¸ä¸ªè·åçè¶æ¶æ¶é´ï¼è¥è¶è¿è¿ä¸ªæ¶é´åæ¾å¼è·åéã\n 3. éæ¾éçæ¶åï¼éè¿ uuid å¤æ­æ¯ä¸æ¯è¯¥éï¼è¥æ¯è¯¥éï¼åæ§è¡ delete è¿è¡ééæ¾ã\n\n# 1.5.3. zookeeper å®ç°\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ a æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ b è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ a å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ b çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n# 1.5.4. å®ç°å¯¹æ¯\n\nzookeeper å·å¤é«å¯ç¨ãå¯éå¥ãé»å¡éç¹æ§ï¼å¯è§£å³å¤±ææ­»éé®é¢ã ä½ zookeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ redis æ¹å¼ã\n\n\n# 1.6. redis çæä¹åæ¹å¼ï¼æä»ä¹ä¼ç¼ºç¹ï¼æä¹åå®ç°åçï¼\n\n# 1.6.1. rdb å¿«ç§ï¼snapshotï¼\n\nå°å­å¨äºæä¸æ¶å»çæææ°æ®é½åå¥å°ç¡¬çä¸­ã\n\n# å¿«ç§çåç\n\nå¨é»è®¤æåµä¸ï¼redis å°æ°æ®åºå¿«ç§ä¿å­å¨åå­ä¸º dump.rdb çäºè¿å¶æä»¶ä¸­ãä½ å¯ä»¥å¯¹ redis è¿è¡è®¾ç½®ï¼ è®©å®å¨ân ç§åæ°æ®éè³å°æ m ä¸ªæ¹å¨âè¿ä¸æ¡ä»¶è¢«æ»¡è¶³æ¶ï¼ èªå¨ä¿å­ä¸æ¬¡æ°æ®éãä½ ä¹å¯ä»¥éè¿è°ç¨ save æè bgsaveï¼æå¨è®© redis è¿è¡æ°æ®éä¿å­æä½ãè¿ç§æä¹åæ¹å¼è¢«ç§°ä¸ºå¿«ç§ã\n\nå½ redis éè¦ä¿å­ dump.rdb æä»¶æ¶ï¼ æå¡å¨æ§è¡ä»¥ä¸æä½:\n\n * redis åå»ºä¸ä¸ªå­è¿ç¨ã\n * å­è¿ç¨å°æ°æ®éåå¥å°ä¸ä¸ªä¸´æ¶å¿«ç§æä»¶ä¸­ã\n * å½å­è¿ç¨å®æå¯¹æ°å¿«ç§æä»¶çåå¥æ¶ï¼redis ç¨æ°å¿«ç§æä»¶æ¿æ¢åæ¥çå¿«ç§æä»¶ï¼å¹¶å é¤æ§çå¿«ç§æä»¶ã\n\nè¿ç§å·¥ä½æ¹å¼ä½¿å¾ redis å¯ä»¥ä»åæ¶å¤å¶ï¼copy-on-writeï¼æºå¶ä¸­è·çã\n\n# å¿«ç§çä¼ç¹\n\n * å®ä¿å­äºæä¸ªæ¶é´ç¹çæ°æ®éï¼éå¸¸éç¨äºæ°æ®éçå¤ä»½ã\n * å¾æ¹ä¾¿ä¼ éå°å¦ä¸ä¸ªè¿ç«¯æ°æ®ä¸­å¿æèäºé©¬éç s3ï¼å¯è½å å¯ï¼ï¼éå¸¸éç¨äºç¾é¾æ¢å¤ã\n * å¿«ç§å¨ä¿å­ rdb æä»¶æ¶ç¶è¿ç¨å¯ä¸éè¦åçå°±æ¯ fork åºä¸ä¸ªå­è¿ç¨ï¼æ¥ä¸æ¥çå·¥ä½å¨é¨ç±å­è¿ç¨æ¥åï¼ç¶è¿ç¨ä¸éè¦ååå¶ä» io æä½ï¼æä»¥å¿«ç§æä¹åæ¹å¼å¯ä»¥æå¤§å redis çæ§è½ã\n * ä¸ aof ç¸æ¯ï¼å¨æ¢å¤å¤§çæ°æ®éçæ¶åï¼db æ¹å¼ä¼æ´å¿«ä¸äºã\n\n# å¿«ç§çç¼ºç¹\n\n * å¦æä½ å¸æå¨ redis æå¤åæ­¢å·¥ä½ï¼ä¾å¦çµæºä¸­æ­ï¼çæåµä¸ä¸¢å¤±çæ°æ®æå°çè¯ï¼é£ä¹å¿«ç§ä¸éåä½ ã\n * å¿«ç§éè¦ç»å¸¸ fork å­è¿ç¨æ¥ä¿å­æ°æ®éå°ç¡¬çä¸ãå½æ°æ®éæ¯è¾å¤§çæ¶åï¼fork çè¿ç¨æ¯éå¸¸èæ¶çï¼å¯è½ä¼å¯¼è´ redis å¨ä¸äºæ¯«ç§çº§åä¸è½ååºå®¢æ·ç«¯çè¯·æ±ã\n\n# 1.6.2. aof\n\naof æä¹åæ¹å¼è®°å½æ¯æ¬¡å¯¹æå¡å¨æ§è¡çåæä½ãå½æå¡å¨éå¯çæ¶åä¼éæ°æ§è¡è¿äºå½ä»¤æ¥æ¢å¤åå§çæ°æ®ã\n\n# 1.6.3. aof çåç\n\n * redis åå»ºä¸ä¸ªå­è¿ç¨ã\n * å­è¿ç¨å¼å§å°æ° aof æä»¶çåå®¹åå¥å°ä¸´æ¶æä»¶ã\n * å¯¹äºæææ°æ§è¡çåå¥å½ä»¤ï¼ç¶è¿ç¨ä¸è¾¹å°å®ä»¬ç´¯ç§¯å°ä¸ä¸ªåå­ç¼å­ä¸­ï¼ä¸è¾¹å°è¿äºæ¹å¨è¿½å å°ç°æ aof æä»¶çæ«å°¾ï¼è¿æ ·æ ·å³ä½¿å¨éåçä¸­éåçåæºï¼ç°æç aof æä»¶ä¹è¿æ¯å®å¨çã\n * å½å­è¿ç¨å®æéåå·¥ä½æ¶ï¼å®ç»ç¶è¿ç¨åéä¸ä¸ªä¿¡å·ï¼ç¶è¿ç¨å¨æ¥æ¶å°ä¿¡å·ä¹åï¼å°åå­ç¼å­ä¸­çæææ°æ®è¿½å å°æ° aof æä»¶çæ«å°¾ã\n * æå®ï¼ç°å¨ redis åå­å°ç¨æ°æä»¶æ¿æ¢æ§æä»¶ï¼ä¹åææå½ä»¤é½ä¼ç´æ¥è¿½å å°æ° aof æä»¶çæ«å°¾ã\n\n# 1.6.4. aof çä¼ç¹\n\n * ä½¿ç¨é»è®¤çæ¯ç§ fsync ç­ç¥ï¼redis çæ§è½ä¾ç¶å¾å¥½(fsync æ¯ç±åå°çº¿ç¨è¿è¡å¤çç,ä¸»çº¿ç¨ä¼å°½åå¤çå®¢æ·ç«¯è¯·æ±)ï¼ä¸æ¦åºç°æéï¼ä½¿ç¨ aof ï¼ä½ æå¤ä¸¢å¤± 1 ç§çæ°æ®ã\n * aof æä»¶æ¯ä¸ä¸ªåªè¿è¡è¿½å çæ¥å¿æä»¶ï¼æä»¥ä¸éè¦åå¥ seekï¼å³ä½¿ç±äºæäºåå (ç£çç©ºé´å·²æ»¡ï¼åçè¿ç¨ä¸­å®æºç­ç­)æªæ§è¡å®æ´çåå¥å½ä»¤ï¼ä½ ä¹ä¹å¯ä½¿ç¨ redis-check-aof å·¥å·ä¿®å¤è¿äºé®é¢ã\n * redis å¯ä»¥å¨ aof æä»¶ä½ç§¯åå¾è¿å¤§æ¶ï¼èªå¨å°å¨åå°å¯¹ aof è¿è¡éåï¼éååçæ° aof æä»¶åå«äºæ¢å¤å½åæ°æ®éæéçæå°å½ä»¤éåãæ´ä¸ªéåæä½æ¯ç»å¯¹å®å¨çã\n * aof æä»¶æåºå°ä¿å­äºå¯¹æ°æ®åºæ§è¡çææåå¥æä½ï¼è¿äºåå¥æä½ä»¥ redis åè®®çæ ¼å¼ä¿å­ãå æ­¤ aof æä»¶çåå®¹éå¸¸å®¹æè¢«äººè¯»æï¼å¯¹æä»¶è¿è¡åæï¼parseï¼ä¹å¾è½»æ¾ã\n\n# 1.6.5. aof çç¼ºç¹\n\n * å¯¹äºç¸åçæ°æ®éæ¥è¯´ï¼aof æä»¶çä½ç§¯éå¸¸è¦å¤§äº rdb æä»¶çä½ç§¯ã\n * æ ¹æ®æä½¿ç¨ç fsync ç­ç¥ï¼aof çéåº¦å¯è½ä¼æ¢äºå¿«ç§ãå¨ä¸è¬æåµä¸ï¼æ¯ç§ fsync çæ§è½ä¾ç¶éå¸¸é«ï¼èå³é­ fsync å¯ä»¥è®© aof çéåº¦åå¿«ç§ä¸æ ·å¿«ï¼å³ä½¿å¨é«è´è·ä¹ä¸ä¹æ¯å¦æ­¤ãä¸è¿å¨å¤çå·¨å¤§çåå¥è½½å¥æ¶ï¼å¿«ç§å¯ä»¥æä¾æ´æä¿è¯çæå¤§å»¶è¿æ¶é´ï¼latencyï¼ã\n\n\n# 1.7. redis è¿æç­ç¥æåªäºï¼\n\n * noeviction - å½åå­ä½¿ç¨è¾¾å°éå¼çæ¶åï¼ææå¼èµ·ç³è¯·åå­çå½ä»¤ä¼æ¥éã\n * allkeys-lru - å¨ä¸»é®ç©ºé´ä¸­ï¼ä¼åç§»é¤æè¿æªä½¿ç¨ç keyã\n * allkeys-random - å¨ä¸»é®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-lru - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼ä¼åç§»é¤æè¿æªä½¿ç¨ç keyã\n * volatile-random - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼éæºç§»é¤æä¸ª keyã\n * volatile-ttl - å¨è®¾ç½®äºè¿ææ¶é´çé®ç©ºé´ä¸­ï¼å·ææ´æ©è¿ææ¶é´ç key ä¼åç§»é¤ã\n\n\n# 1.8. redis å memcached æä»ä¹åºå«ï¼\n\nä¸¤èé½æ¯éå³ç³»ååå­é®å¼æ°æ®åºãæä»¥ä¸ä¸»è¦ä¸åï¼\n\næ°æ®ç±»å\n\n * memcached ä»æ¯æå­ç¬¦ä¸²ç±»åï¼\n * è redis æ¯æäºç§ä¸åç§ç±»çæ°æ®ç±»åï¼ä½¿å¾å®å¯ä»¥æ´çµæ´»å°è§£å³é®é¢ã\n\næ°æ®æä¹å\n\n * memcached ä¸æ¯ææä¹åï¼\n * redis æ¯æä¸¤ç§æä¹åç­ç¥ï¼rdb å¿«ç§å aof æ¥å¿ã\n\nåå¸å¼\n\n * memcached ä¸æ¯æåå¸å¼ï¼åªè½éè¿å¨å®¢æ·ç«¯ä½¿ç¨åä¸è´æ§åå¸è¿æ ·çåå¸å¼ç®æ³æ¥å®ç°åå¸å¼å­å¨ï¼è¿ç§æ¹å¼å¨å­å¨åæ¥è¯¢æ¶é½éè¦åå¨å®¢æ·ç«¯è®¡ç®ä¸æ¬¡æ°æ®æå¨çèç¹ã\n * redis cluster å®ç°äºåå¸å¼çæ¯æã\n\nåå­ç®¡çæºå¶\n\n * memcached å°åå­åå²æç¹å®é¿åº¦çåæ¥å­å¨æ°æ®ï¼ä»¥å®å¨è§£å³åå­ç¢ççé®é¢ï¼ä½æ¯è¿ç§æ¹å¼ä¼ä½¿å¾åå­çå©ç¨çä¸é«ï¼ä¾å¦åçå¤§å°ä¸º 128 bytesï¼åªå­å¨ 100 bytes çæ°æ®ï¼é£ä¹å©ä¸ç 28 bytes å°±æµªè´¹æäºã\n * å¨ redis ä¸­ï¼å¹¶ä¸æ¯æææ°æ®é½ä¸ç´å­å¨å¨åå­ä¸­ï¼å¯ä»¥å°ä¸äºå¾ä¹æ²¡ç¨ç value äº¤æ¢å°ç£çãè memcached çæ°æ®åä¼ä¸ç´å¨åå­ä¸­ã\n\n\n# 1.9. ä¸ºä»ä¹åçº¿ç¨ç redis æ§è½åèä¼äºå¤çº¿ç¨ç memcachedï¼\n\nredis å¿«éçåå ï¼\n\n 1. ç»å¤§é¨åè¯·æ±æ¯çº¯ç²¹çåå­æä½ï¼éå¸¸å¿«éï¼\n 2. éç¨åçº¿ç¨,é¿åäºä¸å¿è¦çä¸ä¸æåæ¢åç«äºæ¡ä»¶\n 3. éé»å¡ io\n\nåé¨å®ç°éç¨ epollï¼éç¨äº epoll+èªå·±å®ç°çç®åçäºä»¶æ¡æ¶ãepoll ä¸­çè¯»ãåãå³é­ãè¿æ¥é½è½¬åæäºäºä»¶ï¼ç¶åå©ç¨ epoll çå¤è·¯å¤ç¨ç¹æ§ï¼ç»ä¸å¨ io ä¸æµªè´¹ä¸ç¹æ¶é´ã\n\n\n# 2. åå¸å¼æ¶æ¯éåï¼mqï¼\n\n\n# 2.1. ä¸ºä»ä¹ä½¿ç¨ mqï¼\n\n * å¼æ­¥å¤ç - ç¸æ¯äºä¼ ç»çä¸²è¡ãå¹¶è¡æ¹å¼ï¼æé«äºç³»ç»ååéã\n * åºç¨è§£è¦ - ç³»ç»é´éè¿æ¶æ¯éä¿¡ï¼ä¸ç¨å³å¿å¶ä»ç³»ç»çå¤çã\n * æµéåé - å¯ä»¥éè¿æ¶æ¯éåé¿åº¦æ§å¶è¯·æ±éï¼å¯ä»¥ç¼è§£ç­æ¶é´åçé«å¹¶åè¯·æ±ã\n * æ¥å¿å¤ç - è§£å³å¤§éæ¥å¿ä¼ è¾ã\n * æ¶æ¯éè®¯ - æ¶æ¯éåä¸è¬é½åç½®äºé«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨å¨çº¯çæ¶æ¯éè®¯ãæ¯å¦å®ç°ç¹å¯¹ç¹æ¶æ¯éåï¼æèèå¤©å®¤ç­ã\n\n\n# 2.2. å¦ä½ä¿è¯ mq çé«å¯ç¨ï¼\n\n# 2.2.1. æ°æ®å¤å¶\n\n 1. å°ææ broker åå¾åéç partition æåº\n 2. å°ç¬¬ i ä¸ª partition åéå°ç¬¬ï¼i mod nï¼ä¸ª broker ä¸\n 3. å°ç¬¬ i ä¸ª partition çç¬¬ j ä¸ª replica åéå°ç¬¬ï¼(i + j) mode nï¼ä¸ª broker ä¸\n\n# 2.2.2. éä¸¾ä¸»æå¡å¨\n\n\n# 2.3. mq æåªäºå¸¸è§é®é¢ï¼å¦ä½è§£å³è¿äºé®é¢ï¼\n\nmq çå¸¸è§é®é¢æï¼\n\n 1. æ¶æ¯çé¡ºåºé®é¢\n 2. æ¶æ¯çéå¤é®é¢\n\n# 2.3.1. æ¶æ¯çé¡ºåºé®é¢\n\næ¶æ¯æåºæçæ¯å¯ä»¥æç§æ¶æ¯çåéé¡ºåºæ¥æ¶è´¹ã\n\nåå¦çäº§èäº§çäº 2 æ¡æ¶æ¯ï¼m1ãm2ï¼åå® m1 åéå° s1ï¼m2 åéå° s2ï¼å¦æè¦ä¿è¯ m1 åäº m2 è¢«æ¶è´¹ï¼æä¹åï¼\n\n\nè§£å³æ¹æ¡ï¼\n\nï¼1ï¼ä¿è¯çäº§è - mqserver - æ¶è´¹èæ¯ä¸å¯¹ä¸å¯¹ä¸çå³ç³»\n\n\nç¼ºé·ï¼\n * å¹¶è¡åº¦å°±ä¼æä¸ºæ¶æ¯ç³»ç»çç¶é¢ï¼ååéä¸å¤ï¼\n * æ´å¤çå¼å¸¸å¤çï¼æ¯å¦ï¼åªè¦æ¶è´¹ç«¯åºç°é®é¢ï¼å°±ä¼å¯¼è´æ´ä¸ªå¤çæµç¨é»å¡ï¼æä»¬ä¸å¾ä¸è±è´¹æ´å¤çç²¾åæ¥è§£å³é»å¡çé®é¢ã\n\nï¼2ï¼éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ã\n\n * ä¸å³æ³¨ä¹±åºçåºç¨å®éå¤§éå­å¨\n * éåæ åºå¹¶ä¸æå³çæ¶æ¯æ åº\n\næä»¥ä»ä¸å¡å±é¢æ¥ä¿è¯æ¶æ¯çé¡ºåºèä¸ä»ä»æ¯ä¾èµäºæ¶æ¯ç³»ç»ï¼æ¯ä¸ç§æ´åççæ¹å¼ã\n\n# 2.3.2. æ¶æ¯çéå¤é®é¢\n\né ææ¶æ¯éå¤çæ ¹æ¬åå æ¯ï¼ç½ç»ä¸å¯è¾¾ã\n\næä»¥è§£å³è¿ä¸ªé®é¢çåæ³å°±æ¯ç»è¿è¿ä¸ªé®é¢ãé£ä¹é®é¢å°±åæäºï¼å¦ææ¶è´¹ç«¯æ¶å°ä¸¤æ¡ä¸æ ·çæ¶æ¯ï¼åºè¯¥ææ ·å¤çï¼\n\næ¶è´¹ç«¯å¤çæ¶æ¯çä¸å¡é»è¾ä¿æå¹ç­æ§ãåªè¦ä¿æå¹ç­æ§ï¼ä¸ç®¡æ¥å¤å°æ¡éå¤æ¶æ¯ï¼æåå¤ççç»æé½ä¸æ ·ã ä¿è¯æ¯æ¡æ¶æ¯é½æå¯ä¸ç¼å·ä¸ä¿è¯æ¶æ¯å¤çæåä¸å»éè¡¨çæ¥å¿åæ¶åºç°ãå©ç¨ä¸å¼ æ¥å¿è¡¨æ¥è®°å½å·²ç»å¤çæåçæ¶æ¯ç idï¼å¦ææ°å°çæ¶æ¯ id å·²ç»å¨æ¥å¿è¡¨ä¸­ï¼é£ä¹å°±ä¸åå¤çè¿æ¡æ¶æ¯ã\n\n\n# 2.4. kafka, activemq, rabbitmq, rocketmq åæä»ä¹ä¼ç¼ºç¹ï¼\n\n\n## 3. åå¸å¼æå¡ï¼rpcï¼\n\n\n# 3.1. dubbo çå®ç°è¿ç¨ï¼\n\n\n\nèç¹è§è²ï¼\n\nèç¹          è§è²è¯´æ\nprovider    æ´é²æå¡çæå¡æä¾æ¹\nconsumer    è°ç¨è¿ç¨æå¡çæå¡æ¶è´¹æ¹\nregistry    æå¡æ³¨åä¸åç°çæ³¨åä¸­å¿\nmonitor     ç»è®¡æå¡çè°ç¨æ¬¡æ°åè°ç¨æ¶é´ççæ§ä¸­å¿\ncontainer   æå¡è¿è¡å®¹å¨\n\nè°ç¨å³ç³»ï¼\n\n 1. å¡å®¹å¨è´è´£å¯å¨ï¼å è½½ï¼è¿è¡æå¡æä¾èã\n 2. æå¡æä¾èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿æ³¨åèªå·±æä¾çæå¡ã\n 3. æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼åæ³¨åä¸­å¿è®¢éèªå·±æéçæå¡ã\n 4. æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æ¶è´¹èï¼å¦ææåæ´ï¼æ³¨åä¸­å¿å°åºäºé¿è¿æ¥æ¨éåæ´æ°æ®ç»æ¶è´¹èã\n 5. æå¡æ¶è´¹èï¼ä»æä¾èå°ååè¡¨ä¸­ï¼åºäºè½¯è´è½½åè¡¡ç®æ³ï¼éä¸å°æä¾èè¿è¡è°ç¨ï¼å¦æè°ç¨å¤±è´¥ï¼åéå¦ä¸å°è°ç¨ã\n 6. æå¡æ¶è´¹èåæä¾èï¼å¨åå­ä¸­ç´¯è®¡è°ç¨æ¬¡æ°åè°ç¨æ¶é´ï¼å®æ¶æ¯åéåéä¸æ¬¡ç»è®¡æ°æ®å°çæ§ä¸­å¿ã\n\n\n# 3.2. dubbo è´è½½åè¡¡ç­ç¥æåªäºï¼\n\n# random\n\n * éæºï¼ææéè®¾ç½®éæºæ¦çã\n * å¨ä¸ä¸ªæªé¢ä¸ç¢°æçæ¦çé«ï¼ä½è°ç¨éè¶å¤§åå¸è¶ååï¼èä¸ææ¦çä½¿ç¨æéåä¹æ¯è¾ååï¼æå©äºå¨æè°æ´æä¾èæéã\n\n# roundrobin\n\n * è½®å¾ªï¼æå¬çº¦åçæéè®¾ç½®è½®å¾ªæ¯çã\n * å­å¨æ¢çæä¾èç´¯ç§¯è¯·æ±çé®é¢ï¼æ¯å¦ï¼ç¬¬äºå°æºå¨å¾æ¢ï¼ä½æ²¡æï¼å½è¯·æ±è°å°ç¬¬äºå°æ¶å°±å¡å¨é£ï¼ä¹èä¹ä¹ï¼ææè¯·æ±é½å¡å¨è°å°ç¬¬äºå°ä¸ã\n\n# leastactive\n\n * æå°æ´»è·è°ç¨æ°ï¼ç¸åæ´»è·æ°çéæºï¼æ´»è·æ°æè°ç¨ååè®¡æ°å·®ã\n * ä½¿æ¢çæä¾èæ¶å°æ´å°è¯·æ±ï¼å ä¸ºè¶æ¢çæä¾èçè°ç¨ååè®¡æ°å·®ä¼è¶å¤§ã\n\n# consistenthash\n\n * ä¸è´æ§ hashï¼ç¸ååæ°çè¯·æ±æ»æ¯åå°åä¸æä¾èã\n * å½æä¸å°æä¾èææ¶ï¼åæ¬åå¾è¯¥æä¾èçè¯·æ±ï¼åºäºèæèç¹ï¼å¹³æå°å¶å®æä¾èï¼ä¸ä¼å¼èµ·å§çåå¨ã\n * ç®æ³åè§ï¼http://en.wikipedia.org/wiki/consistent_hashing\n * ç¼ºçåªå¯¹ç¬¬ä¸ä¸ªåæ° hashï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.arguments" value="0,1" />\n * ç¼ºçç¨ 160 ä»½èæèç¹ï¼å¦æè¦ä¿®æ¹ï¼è¯·éç½® <dubbo:parameter key="hash.nodes" value="320" />\n\n\n# 3.3. dubbo éç¾¤å®¹éç­ç¥ ï¼\n\n\n- **failover** - å¤±è´¥èªå¨åæ¢ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãå¯éè¿ retries="2" æ¥è®¾ç½®éè¯æ¬¡æ°(ä¸å«ç¬¬ä¸æ¬¡)ã - **failfast** - å¿«éå¤±è´¥ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ã - **failsafe** - å¤±è´¥å®å¨ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã - **failback** - å¤±è´¥èªå¨æ¢å¤ï¼åå°è®°å½å¤±è´¥è¯·æ±ï¼å®æ¶éåãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã - **forking** - å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºãå¯éè¿ forks="2" æ¥è®¾ç½®æå¤§å¹¶è¡æ°ã - **broadcast** - æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\n\n# 3.4. å¨æä»£çç­ç¥ï¼\n\ndubbo ä½ä¸º rpc æ¡æ¶ï¼é¦åè¦å®æçå°±æ¯è·¨ç³»ç»ï¼è·¨ç½ç»çæå¡è°ç¨ãæ¶è´¹æ¹ä¸æä¾æ¹éµå¾ªç»ä¸çæ¥å£å®ä¹ï¼æ¶è´¹æ¹è°ç¨æ¥å£æ¶ï¼dubbo å°å¶è½¬æ¢æç»ä¸æ ¼å¼çæ°æ®ç»æï¼éè¿ç½ç»ä¼ è¾ï¼æä¾æ¹æ ¹æ®è§åæ¾å°æ¥å£å®ç°ï¼éè¿åå°å®æè°ç¨ãä¹å°±æ¯è¯´ï¼æ¶è´¹æ¹è·åçæ¯å¯¹è¿ç¨æå¡çä¸ä¸ªä»£ç(proxy)ï¼èæä¾æ¹å ä¸ºè¦æ¯æä¸åçæ¥å£å®ç°ï¼éè¦ä¸ä¸ªåè£å±(wrapper)ãè°ç¨çè¿ç¨å¤§æ¦æ¯è¿æ ·ï¼\n\n\næ¶è´¹æ¹ç proxy åæä¾æ¹ç wrapper å¾ä»¥è®© dubbo æå»ºåºå¤æãç»ä¸çä½ç³»ãèè¿ç§å¨æä»£çä¸åè£ä¹æ¯éè¿åºäº spi çæä»¶æ¹å¼å®ç°çï¼å®çæ¥å£å°±æ¯**proxyfactory**ã\n\n@spi("javassist")\npublic interface proxyfactory {\n\n    @adaptive({constants.proxy_key})\n    <t> t getproxy(invoker<t> invoker) throws rpcexception;\n\n    @adaptive({constants.proxy_key})\n    <t> invoker<t> getinvoker(t proxy, class<t> type, url url) throws rpcexception;\n\n}\n\n\nproxyfactory æä¸¤ç§å®ç°æ¹å¼ï¼ä¸ç§æ¯åºäº jdk çä»£çå®ç°ï¼ä¸ç§æ¯åºäº javassist çå®ç°ãproxyfactory æ¥å£ä¸å®ä¹äº@spi("javassist")ï¼é»è®¤ä¸º javassist çå®ç°ã\n\n\n# 3.5. dubbo æ¯æåªäºåºåååè®®ï¼hessianï¼hessian çæ°æ®ç»æï¼\n\n 1. dubbo åºååï¼é¿éå°ä¸æçç java åºååå®ç°ã\n 2. hessian2 åºååï¼hessian æ¯ä¸ç§è·¨è¯­è¨çé«æäºè¿å¶çåºååæ¹å¼ï¼ä½è¿éå®éä¸æ¯åçç hessian2 åºååï¼èæ¯é¿éä¿®æ¹è¿ç hessian liteï¼å®æ¯ dubbo rpc é»è®¤å¯ç¨çåºååæ¹å¼ã\n 3. json åºååï¼ç®åæä¸¤ç§å®ç°ï¼ä¸ç§æ¯éç¨çé¿éç fastjson åºï¼å¦ä¸ç§æ¯éç¨ dubbo ä¸­èªå·²å®ç°çç®å json åºï¼ä¸è¬æåµä¸ï¼json è¿ç§ææ¬åºååæ§è½ä¸å¦äºè¿å¶åºååã\n 4. java åºååï¼ä¸»è¦æ¯éç¨ jdk èªå¸¦ç java åºååå®ç°ï¼æ§è½å¾ä¸çæ³ã\n 5. kryo å fstï¼kryo å fst çæ§è½ä¾ç¶æ®éä¼äº hessian å dubbo åºååã\n\nhessian åºååä¸ java é»è®¤çåºåååºå«ï¼\n\nhessian æ¯ä¸ä¸ªè½»éçº§ç remoting on http å·¥å·ï¼éç¨çæ¯ binary rpc åè®®ï¼æä»¥å®å¾éåäºåéäºè¿å¶æ°æ®ï¼åæ¶åå·æé²ç«å¢ç©¿éè½åã\n\n 1. hessian æ¯æè·¨è¯­è¨ä¸²è¡\n 2. æ¯ java åºååå·ææ´å¥½çæ§è½åæç¨æ§\n 3. æ¯æçè¯­è¨æ¯è¾å¤\n\n\n# 3.6. protoco buffer æ¯ä»ä¹ï¼\n\nprotocol buffer æ¯ google åºåçä¸ç§è½»é & é«æçç»æåæ°æ®å­å¨æ ¼å¼ï¼æ§è½æ¯ jsonãxml ççå¼ºï¼å¤ªï¼å¤ï¼\n\nprotocol buffer çåºåå & ååºååç®å & éåº¦å¿«çåå æ¯ï¼\n\n 1. ç¼ç  / è§£ç  æ¹å¼ç®åï¼åªéè¦ç®åçæ°å­¦è¿ç® = ä½ç§»ç­ç­ï¼\n 2. éç¨ protocol buffer èªèº«çæ¡æ¶ä»£ç  å ç¼è¯å¨ å±åå®æ\n\nprotocol buffer çæ°æ®åç¼©ææå¥½ï¼å³åºåååçæ°æ®éä½ç§¯å°ï¼çåå æ¯ï¼\n\n 1. éç¨äºç¬ç¹çç¼ç æ¹å¼ï¼å¦ varintãzigzag ç¼ç æ¹å¼ç­ç­\n 2. éç¨ t - l - v çæ°æ®å­å¨æ¹å¼ï¼åå°äºåéç¬¦çä½¿ç¨ & æ°æ®å­å¨å¾ç´§å\n\n\n# 3.7. æ³¨åä¸­å¿æäºå¯ä»¥ç»§ç»­éä¿¡åï¼\n\nå¯ä»¥ãdubbo æ¶è´¹èå¨åºç¨å¯å¨æ¶ä¼ä»æ³¨åä¸­å¿æåå·²æ³¨åççäº§èçå°åæ¥å£ï¼å¹¶ç¼å­å¨æ¬å°ãæ¯æ¬¡è°ç¨æ¶ï¼æç§æ¬å°å­å¨çå°åè¿è¡è°ç¨ã\n\n\n# 3.8. zookeeper åçæ¯ä»ä¹ï¼zookeeper æä»ä¹ç¨ï¼\n\nzookeeper æ¯ä¸ä¸ªåå¸å¼åºç¨åè°ç³»ç»ï¼å·²ç»ç¨å°äºè®¸å¤åå¸å¼é¡¹ç®ä¸­ï¼ç¨æ¥å®æç»ä¸å½åæå¡ãç¶æåæ­¥æå¡ãéç¾¤ç®¡çãåå¸å¼åºç¨éç½®é¡¹çç®¡çç­å·¥ä½ã\n\n\n 1. æ¯ä¸ª server å¨åå­ä¸­å­å¨äºä¸ä»½æ°æ®ï¼\n 2. zookeeper å¯å¨æ¶ï¼å°ä»å®ä¾ä¸­éä¸¾ä¸ä¸ª leaderï¼paxos åè®®ï¼ï¼\n 3. leader è´è´£å¤çæ°æ®æ´æ°ç­æä½ï¼zab åè®®ï¼ï¼\n 4. ä¸ä¸ªæ´æ°æä½æåï¼å½ä¸ä»å½å¤§å¤æ° server å¨åå­ä¸­æåä¿®æ¹æ°æ®ã\n\n\n# 3.9. netty æä»ä¹ç¨ï¼nio/bio/aio æä»ä¹ç¨ï¼æä»ä¹åºå«ï¼\n\nnetty æ¯ä¸ä¸ªâç½ç»éè®¯æ¡æ¶âã\n\nnetty è¿è¡äºä»¶å¤ççæµç¨ãchannelæ¯è¿æ¥çééï¼æ¯ channelevent çäº§çèï¼èchannelpipelineå¯ä»¥çè§£ä¸º channelhandler çéåã\n\n\n> åèï¼https://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md\n\nio çæ¹å¼éå¸¸åä¸ºå ç§ï¼\n\n * åæ­¥é»å¡ç bio\n * åæ­¥éé»å¡ç nio\n * å¼æ­¥éé»å¡ç aio\n\nå¨ä½¿ç¨åæ­¥ i/o çç½ç»åºç¨ä¸­ï¼å¦æè¦åæ¶å¤çå¤ä¸ªå®¢æ·ç«¯è¯·æ±ï¼ææ¯å¨å®¢æ·ç«¯è¦åæ¶åå¤ä¸ªæå¡å¨è¿è¡éè®¯ï¼å°±å¿é¡»ä½¿ç¨å¤çº¿ç¨æ¥å¤çã\n\nnio åºäº reactorï¼å½ socket ææµå¯è¯»æå¯åå¥ socket æ¶ï¼æä½ç³»ç»ä¼ç¸åºçéç¥å¼ç¨ç¨åºè¿è¡å¤çï¼åºç¨åå°æµè¯»åå°ç¼å²åºæåå¥æä½ç³»ç»ãä¹å°±æ¯è¯´ï¼è¿ä¸ªæ¶åï¼å·²ç»ä¸æ¯ä¸ä¸ªè¿æ¥å°±è¦å¯¹åºä¸ä¸ªå¤ççº¿ç¨äºï¼èæ¯ææçè¯·æ±ï¼å¯¹åºä¸ä¸ªçº¿ç¨ï¼å½è¿æ¥æ²¡ææ°æ®æ¶ï¼æ¯æ²¡æå·¥ä½çº¿ç¨æ¥å¤ççã\n\nä¸ nio ä¸åï¼å½è¿è¡è¯»åæä½æ¶ï¼åªé¡»ç´æ¥è°ç¨ api ç read æ write æ¹æ³å³å¯ãè¿ä¸¤ç§æ¹æ³åä¸ºå¼æ­¥çï¼å¯¹äºè¯»æä½èè¨ï¼å½ææµå¯è¯»åæ¶ï¼æä½ç³»ç»ä¼å°å¯è¯»çæµä¼ å¥ read æ¹æ³çç¼å²åºï¼å¹¶éç¥åºç¨ç¨åºï¼å¯¹äºåæä½èè¨ï¼å½æä½ç³»ç»å° write æ¹æ³ä¼ éçæµåå¥å®æ¯æ¶ï¼æä½ç³»ç»ä¸»å¨éç¥åºç¨ç¨åºã å³å¯ä»¥çè§£ä¸ºï¼read/write æ¹æ³é½æ¯å¼æ­¥çï¼å®æåä¼ä¸»å¨è°ç¨åè°å½æ°ã\n\n> åèï¼https://blog.csdn.net/skiof007/article/details/52873421\n\n\n# 3.10. ä¸ºä»ä¹è¦è¿è¡ç³»ç»æåï¼æåä¸ç¨ dubbo å¯ä»¥åï¼\n\nç³»ç»æåä»èµæºè§åº¦åä¸ºï¼åºç¨æååæ°æ®åºæåã\n\nä»éç¨çååé¡ºåºå¯åä¸ºï¼æ°´å¹³æ©å±ãåç´æåãä¸å¡æåãæ°´å¹³æåã\n\n\næ¯å¦ä½¿ç¨æå¡ä¾æ®å®éä¸å¡åºæ¯æ¥å³å®ã\n\nå½åç´åºç¨è¶æ¥è¶å¤ï¼åºç¨ä¹é´äº¤äºä¸å¯é¿åï¼å°æ ¸å¿ä¸å¡æ½ååºæ¥ï¼ä½ä¸ºç¬ç«çæå¡ï¼éæ¸å½¢æç¨³å®çæå¡ä¸­å¿ï¼ä½¿åç«¯åºç¨è½æ´å¿«éçååºå¤åçå¸åºéæ±ãæ­¤æ¶ï¼ç¨äºæé«ä¸å¡å¤ç¨åæ´åçåå¸å¼æå¡æ¡æ¶(rpc)æ¯å³é®ã\n\nå½æå¡è¶æ¥è¶å¤ï¼å®¹éçè¯ä¼°ï¼å°æå¡èµæºçæµªè´¹ç­é®é¢éæ¸æ¾ç°ï¼æ­¤æ¶éå¢å ä¸ä¸ªè°åº¦ä¸­å¿åºäºè®¿é®ååå®æ¶ç®¡çéç¾¤å®¹éï¼æé«éç¾¤å©ç¨çãæ­¤æ¶ï¼ç¨äºæé«æºå¨å©ç¨ççèµæºè°åº¦åæ²»çä¸­å¿(soa)æ¯å³é®ã\n\n\n# 3.11. dubbo å thrift æä»ä¹åºå«ï¼\n\n * thrift æ¯è·¨è¯­è¨ç rpc æ¡æ¶ã\n * dubbo æ¯ææå¡æ²»çï¼è thrift ä¸æ¯æã\n\n\n# 4. åå¸å¼éåºæ¬åç\n\n> åå¸å¼éæå ç§å®ç°æ¹å¼ï¼å®ç°çè¦ç¹æ¯ä»ä¹ï¼\n> \n> åå¸å¼éåæ¹æ¡æä»ä¹å©å¼ï¼å¦ä½éæ©æ¹æ¡ï¼ä¸ºä»ä¹ï¼\n> \n> redis åå¸å¼éå¦ä½ä¿è¯å¯éå¥æ§ï¼\n> \n> è¯¦ç»åå®¹è¯·åèï¼åå¸å¼é\n\nãç­é¢æè·¯ã\n\nå®ç°æ¹å¼ä¸è¬æï¼\n\n * åºäºæ°æ®åºå®ç°ï¼\n   * å»ºä¸å¼ è¡¨ï¼t_dlockï¼ï¼å³é®å­æ®µæï¼idãmethod_nameãtimeã\n   * åè¡¨ä¸­æå¥è®°å½æåï¼å³ä¸ºè·åéæåãéè¦æ³¨æçæ¯ï¼è·åéä¸è¬æ¯éè¿èªææ¹å¼ï¼å¹¶è®¾ç½®å°è¯æ¬¡æ°ï¼è¶è¿æå¤§å°è¯æ¬¡æ°ï¼æå¤å®è·åéå¤±è´¥ã\n   * å é¤è®°å½ï¼å³ä¸ºéæ¾éã\n   * å ä¸ºæ°æ®åºæ²¡ææ·æ±°æºå¶ï¼ä¸ºäºé¿åè·åéæ°¸ä¸éæ¾ï¼åºç¨éè¦èªèº«å®ç°å®ææ£æ¥ï¼å é¤è¿æè®°å½ï¼æ ¹æ® time å¤æ­ï¼ã\n * åºäº redis å®ç°\n   * çæä¸ä¸ªåå¸å¼ id ä½ä¸º keyï¼éè¿ setnx åå¥\n   * åå¥æåï¼å³ä¸ºè·åéæåãéè¦æ³¨æçæ¯ï¼è·åéä¸è¬æ¯éè¿èªææ¹å¼ï¼å¹¶è®¾ç½®å°è¯æ¬¡æ°ï¼è¶è¿æå¤§å°è¯æ¬¡æ°ï¼æå¤å®è·åéå¤±è´¥ã\n   * å é¤ keyï¼å³ä¸ºè·åéå¤±è´¥ã\n   * redis èªèº«æåå­æ·æ±°ç­ç¥ï¼æä»¥åªè¦è®¾ç½® expireï¼å°±å¯ä»¥è®© key èªå¨è¿æã\n * åºäº zookeeper å®ç°\n   * åå»ºä¸ä¸ªèç¹ï¼ææèç¹é½ watch æ­¤èç¹ã\n   * ä»»æèç¹çä»»æçº¿ç¨åªè¦åè¿ä¸ªèç¹åå»ºä¸´æ¶å­èç¹æåï¼å³ä¸ºè·åéæåã\n   * ç±äºåå»ºä¸´æ¶å­èç¹æ¯åå­æ§çï¼ä¸å­å¨ç«æï¼ä¸éè¦èªæå°è¯ï¼æ§è½å¾å¥½ã\n   * å ä¸º zookeeper åªè¦åèç¹æ­å¼ä¼è¯ï¼å°±ä¼èªå¨å é¤ä¸´æ¶èç¹ãå³ä¸ºå é¤éãæä»¥æ éè¿ææºå¶ã\n\nä»å®ç°æ¹å¼å¯ä»¥çåºï¼ä¸ç§æ¹æ¡çå¯¹æ¯ï¼\n\n * mysql æ¹æ¡æ§è½æå·®ï¼å¹¶ä¸å½±å mysql ååéãèä¸è¿è¦ç¨åºä¿è¯å®¹éå¤çãä¸å»ºè®®éç¨è¿ç§æ¹æ¡ã\n * redis æ¹æ¡éè¦ä¸æ­èªæå°è¯è·åéï¼åºç¨ä¼æ¶èä¸äºæ§è½å¼éãèä¸ä¸ºäºä¿è¯åå¸å¼éçå¯éå¥æ§ï¼éè¦è®¾ç½®å¯¹äºææèç¹ãææçº¿ç¨é½å¯ä¸çåå¸å¼ idï¼çæ id ä¹éè¦ä¸å®ç cpu å¼éã\n * zookeeper æ¹æ¡å®ç°æç®åï¼æç¨³å®ãæ¯æ¨èçæ¹æ¡ãä½æ¯å®ä¹æä¸ä¸ªé®é¢ï¼zookeeper çä¸»ä»æ¶æï¼ææåé½ç± master èç¹è´è´£ï¼æä»¥ zookeeper èªèº«æä¸å®çæ§è½ç¶é¢ã',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼çè®º",frontmatter:{title:"åå¸å¼çè®º",categories:["åå¸å¼","åå¸å¼çè®º"],tags:["åå¸å¼","åå¸å¼çè®º"],abbrlink:41166861,date:"2021-11-08T08:15:33.000Z",permalink:"/pages/367308/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/02.%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA/01.%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA.html",relativePath:"02.åå¸å¼/02.åå¸å¼çè®º/01.åå¸å¼çè®º.md",key:"v-6ef572de",path:"/pages/367308/",headers:[{level:2,title:"1. åå¸å¼ç¹æ§ååç±»",slug:"_1-åå¸å¼ç¹æ§ååç±»",normalizedTitle:"1. åå¸å¼ç¹æ§ååç±»",charIndex:14},{level:3,title:"1.1. åå¸å¼ç¹æ§",slug:"_1-1-åå¸å¼ç¹æ§",normalizedTitle:"1.1. åå¸å¼ç¹æ§",charIndex:30},{level:3,title:"1.2. åå¸å¼åç±»",slug:"_1-2-åå¸å¼åç±»",normalizedTitle:"1.2. åå¸å¼åç±»",charIndex:300},{level:2,title:"2. CAP å®ç",slug:"_2-cap-å®ç",normalizedTitle:"2. cap å®ç",charIndex:571},{level:3,title:"2.1. ä¸è´æ§",slug:"_2-1-ä¸è´æ§",normalizedTitle:"2.1. ä¸è´æ§",charIndex:900},{level:3,title:"2.2. å¯ç¨æ§",slug:"_2-2-å¯ç¨æ§",normalizedTitle:"2.2. å¯ç¨æ§",charIndex:1406},{level:3,title:"2.3. ååºå®¹éæ§",slug:"_2-3-ååºå®¹éæ§",normalizedTitle:"2.3. ååºå®¹éæ§",charIndex:1555},{level:3,title:"2.4. AP or CP",slug:"_2-4-ap-or-cp",normalizedTitle:"2.4. ap or cp",charIndex:2273},{level:2,title:"3. BASE å®ç",slug:"_3-base-å®ç",normalizedTitle:"3. base å®ç",charIndex:2776},{level:3,title:"3.1. ä»ä¹æ¯ BASE å®ç",slug:"_3-1-ä»ä¹æ¯-base-å®ç",normalizedTitle:"3.1. ä»ä¹æ¯ base å®ç",charIndex:2791},{level:3,title:"3.2. BASE vs. ACID",slug:"_3-2-base-vs-acid",normalizedTitle:"3.2. base vs. acid",charIndex:3261},{level:2,title:"4. éè¯¯çåå¸å¼åè®¾",slug:"_4-éè¯¯çåå¸å¼åè®¾",normalizedTitle:"4. éè¯¯çåå¸å¼åè®¾",charIndex:3481},{level:2,title:"5. æå åº­å°åé®é¢",slug:"_5-æå åº­å°åé®é¢",normalizedTitle:"5. æå åº­å°åé®é¢",charIndex:3771},{level:3,title:"5.1. é®é¢æè¿°",slug:"_5-1-é®é¢æè¿°",normalizedTitle:"5.1. é®é¢æè¿°",charIndex:3982},{level:3,title:"5.2. é®é¢åæ",slug:"_5-2-é®é¢åæ",normalizedTitle:"5.2. é®é¢åæ",charIndex:4550},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:4890}],headersStr:"1. åå¸å¼ç¹æ§ååç±» 1.1. åå¸å¼ç¹æ§ 1.2. åå¸å¼åç±» 2. CAP å®ç 2.1. ä¸è´æ§ 2.2. å¯ç¨æ§ 2.3. ååºå®¹éæ§ 2.4. AP or CP 3. BASE å®ç 3.1. ä»ä¹æ¯ BASE å®ç 3.2. BASE vs. ACID 4. éè¯¯çåå¸å¼åè®¾ 5. æå åº­å°åé®é¢ 5.1. é®é¢æè¿° 5.2. é®é¢åæ 6. åèèµæ",content:'# åå¸å¼çè®º\n\n\n\n\n# 1. åå¸å¼ç¹æ§ååç±»\n\n\n# 1.1. åå¸å¼ç¹æ§\n\n * æ§è½ï¼ç¨äºè¡¡éä¸ä¸ªç³»ç»å¤çåç§ä»»å¡çè½åã\n   * ååéï¼ç³»ç»å¨ä¸å®æ¶é´åå¯ä»¥å¤ççä»»å¡æ°ã\n     * QPSï¼å³æ¯ç§æ¥è¯¢æ°\n     * TPSï¼å³æ¯ç§äºå¡æ°\n   * ååºæ¶é´ï¼ç³»ç»ååºä¸ä¸ªè¯·æ±æè¾å¥éè¦è±è´¹çæ¶é´ã\n * å¯ç¨æ§ï¼æçæ¯ç³»ç»å¨é¢å¯¹åç§å¼å¸¸æ¶å¯ä»¥æ­£ç¡®æä¾æå¡çè½åãç³»ç»çå¯ç¨æ§å¯ä»¥ç¨ç³»ç»åæ­¢æå¡çæ¶é´ä¸æ»çæ¶é´ä¹æ¯è¡¡éã\n * å¯æ©å±æ§ï¼æçæ¯åå¸å¼ç³»ç»éè¿æ©å±éç¾¤æºå¨è§æ¨¡æé«ç³»ç»æ§è½ (ååãååºæ¶é´ã å®ææ¶é´)ãå­å¨å®¹éãè®¡ç®è½åçç¹æ§ï¼æ¯åå¸å¼ç³»ç»çç¹ææ§è´¨ã\n\n\n# 1.2. åå¸å¼åç±»\n\n * åå¸å¼è®¡ç®ï¼è§£å³åºç¨çåå¸å¼è®¡ç®é®é¢ãåºäºåå¸å¼è®¡ç®æ¨¡å¼ï¼åæ¬æ¹å¤çè®¡ç®ãç¦»çº¿è®¡ç®ãå¨çº¿è®¡ç®ãèåè®¡ç®ç­ï¼æ ¹æ®åºç¨ç±»åæå»ºé«ææºè½çåå¸å¼è®¡ç®æ¡æ¶ã\n * åå¸å¼å­å¨ï¼è§£å³æ°æ®çåå¸å¼åå¤ååé®é¢ãåæ¬åå¸å¼æ°æ®åºãåå¸å¼æä»¶ç³»ç»ãåå¸å¼ç¼å­ç­ï¼æ¯æä¸åç±»åçæ°æ®çå­å¨åç®¡çã\n * åå¸å¼éä¿¡ï¼è§£å³è¿ç¨é´çåå¸å¼éä¿¡é®é¢ãéè¿æ¶æ¯éåãè¿ç¨è°ç¨ç­æ¹å¼ï¼å®ç°ç®åé«æçéä¿¡ã\n * åå¸å¼èµæºç®¡çï¼è§£å³èµæºçåå¸å¼åå¼ææ§é®é¢ãå° CPUãåå­ãIO ç­ç©çèµæºèæåï¼æ°åé»è¾èµæºæ± ï¼ä»¥ä¾¿ç»ä¸ç®¡çã\n\n\n# 2. CAP å®ç\n\n> CAP å®çæ¯å å·å¤§å­¦è®¡ç®æºç§å­¦å®¶åéåÂ·å¸é²å°æåºæ¥ççæ³ï¼åæ¥è¢«è¯ææä¸ºåå¸å¼è®¡ç®é¢åå¬è®¤çå®çã\n\nCAP å®çï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\nCAP å°±æ¯å ConsistencyãAvailabilityãPartition Tolerance çé¦å­æ¯èå½åã\n\n\n\n * ä¸è´æ§ï¼Consistencyï¼ï¼å¨ä»»ä½ç»å®æ¶é´ï¼ç½ç»ä¸­çææèç¹é½å·æå®å¨ç¸åï¼æè¿ï¼çå¼ã\n * å¯ç¨æ§ï¼Availabilityï¼ï¼å¯¹ç½ç»çæ¯ä¸ªè¯·æ±é½ä¼æ¶å°ååºï¼ä½ä¸è½ä¿è¯è¿åçæ°æ®æ¯ææ°çã\n * ååºå®¹éæ§ï¼Partition Toleranceï¼ï¼å³ä½¿ä»»ææ°éçèç¹åºç°æéï¼ç½ç»ä»ä¼ç»§ç»­è¿è¡ã\n\n\n# 2.1. ä¸è´æ§\n\nä¸è´æ§ï¼Consistencyï¼æçæ¯å¤ä¸ªæ°æ®å¯æ¬æ¯å¦è½ä¿æä¸è´çç¹æ§ã\n\nå¨ä¸è´æ§çæ¡ä»¶ä¸ï¼åå¸å¼ç³»ç»å¨æ§è¡åæä½æååï¼å¦æææç¨æ·é½è½å¤è¯»åå°ææ°çå¼ï¼è¯¥ç³»ç»å°±è¢«è®¤ä¸ºå·æå¼ºä¸è´æ§ã\n\næ°æ®ä¸è´æ§åå¯ä»¥åä¸ºä»¥ä¸å ç¹ï¼\n\n * å¼ºä¸è´æ§ - æ°æ®æ´æ°æä½ç»æåæä½ååºæ»æ¯ä¸è´çï¼å³æä½ååºéç¥æ´æ°å¤±è´¥ï¼é£ä¹æ°æ®ä¸å®æ²¡æè¢«æ´æ°ï¼èä¸æ¯å¤äºä¸ç¡®å®ç¶æã\n * æç»ä¸è´æ§ - å³ç©çå­å¨çæ°æ®å¯è½æ¯ä¸ä¸è´çï¼ç»ç«¯ç¨æ·è®¿é®å°çæ°æ®å¯è½ä¹æ¯ä¸ä¸è´çï¼ä½ç³»ç»ç»è¿ä¸æ®µæ¶é´çèªæä¿®å¤åä¿®æ­£ï¼æ°æ®æç»ä¼è¾¾å°ä¸è´ã\n\nä¸¾ä¾æ¥è¯´ï¼ææ¡è®°å½æ¯ v0ï¼ç¨æ·å G1 åèµ·ä¸ä¸ªåæä½ï¼å°å¶æ¹ä¸º v1ã\n\n\n\næ¥ä¸æ¥ï¼ç¨æ·çè¯»æä½å°±ä¼å¾å° v1ãè¿å°±å«ä¸è´æ§ã\n\n\n\né®é¢æ¯ï¼ç¨æ·æå¯è½å G2 åèµ·è¯»æä½ï¼ç±äº G2 çå¼æ²¡æåçååï¼å æ­¤è¿åçæ¯ v0ãG1 å G2 è¯»æä½çç»æä¸ä¸è´ï¼è¿å°±ä¸æ»¡è¶³ä¸è´æ§äºã\n\n\n\nä¸ºäºè®© G2 ä¹è½åä¸º v1ï¼å°±è¦å¨ G1 åæä½çæ¶åï¼è®© G1 å G2 åéä¸æ¡æ¶æ¯ï¼è¦æ± G2 ä¹æ¹æ v1ã\n\n\n\nè¿æ ·çè¯ï¼ç¨æ·å G2 åèµ·è¯»æä½ï¼ä¹è½å¾å° v1ã\n\n\n\n\n# 2.2. å¯ç¨æ§\n\nå¯ç¨æ§æåå¸å¼ç³»ç»å¨é¢å¯¹åç§å¼å¸¸æ¶å¯ä»¥æä¾æ­£å¸¸æå¡çè½åï¼å¯ä»¥ç¨ç³»ç»å¯ç¨æ¶é´å æ»æ¶é´çæ¯å¼æ¥è¡¡éï¼4 ä¸ª 9 çå¯ç¨æ§è¡¨ç¤ºç³»ç» 99.99% çæ¶é´æ¯å¯ç¨çã\n\nå¨å¯ç¨æ§æ¡ä»¶ä¸ï¼ç³»ç»æä¾çæå¡ä¸ç´å¤äºå¯ç¨çç¶æï¼å¯¹äºç¨æ·çæ¯ä¸ä¸ªæä½è¯·æ±æ»æ¯è½å¤å¨æéçæ¶é´åè¿åç»æã\n\n\n# 2.3. ååºå®¹éæ§\n\nååºå®¹éæ§ï¼Partition Toleranceï¼æ åå¸å¼ç³»ç»å¨éå°ä»»ä½ç½ç»ååºæéçæ¶åï¼ä»ç¶éè¦è½å¯¹å¤æä¾ä¸è´æ§åå¯ç¨æ§çæå¡ï¼é¤éæ¯æ´ä¸ªç½ç»ç¯å¢é½åçäºæéã\n\nå¨ä¸ä¸ªåå¸å¼ç³»ç»éé¢ï¼èç¹ç»æçç½ç»æ¬æ¥åºè¯¥æ¯è¿éçãç¶èå¯è½å ä¸ºä¸äºæéï¼ä½¿å¾æäºèç¹ä¹é´ä¸è¿éäºï¼æ´ä¸ªç½ç»å°±åæäºå ååºåãæ°æ®å°±æ£å¸å¨äºè¿äºä¸è¿éçåºåä¸­ï¼è¿å°±å«ååºã\n\nåè®¾ï¼æä¸ªæ°æ®é¡¹åªå¨ä¸ä¸ªèç¹ä¸­ä¿å­ï¼é£ä¹ååºåºç°åï¼åè¿ä¸ªèç¹ä¸è¿éçé¨åå°±è®¿é®ä¸å°è¿ä¸ªæ°æ®äºãè¿æ¶ååºå°±æ¯æ æ³å®¹å¿çã\n\næé«ååºå®¹éæ§çåæ³å°±æ¯ä¸ä¸ªæ°æ®é¡¹å¤å¶å°å¤ä¸ªèç¹ä¸ï¼é£ä¹åºç°ååºä¹åï¼è¿ä¸æ°æ®é¡¹å°±å¯è½åå¸å°åä¸ªåºéãå®¹éæ§å°±æé«äºã\n\nç¶èï¼è¦ææ°æ®å¤å¶å°å¤ä¸ªèç¹ï¼å°±ä¼å¸¦æ¥ä¸è´æ§çé®é¢ï¼å°±æ¯å¤ä¸ªèç¹ä¸é¢çæ°æ®å¯è½æ¯ä¸ä¸è´çãè¦ä¿è¯ä¸è´ï¼æ¯æ¬¡åæä½å°±é½è¦ç­å¾å¨é¨èç¹åæåï¼èè¿ç­å¾åä¼å¸¦æ¥å¯ç¨æ§çé®é¢ã\n\næ»çæ¥è¯´å°±æ¯ï¼æ°æ®å­å¨çèç¹è¶å¤ï¼ååºå®¹éæ§è¶é«ï¼ä½è¦å¤å¶æ´æ°çæ°æ®å°±è¶å¤ï¼ä¸è´æ§å°±è¶é¾ä¿è¯ãä¸ºäºä¿è¯ä¸è´æ§ï¼æ´æ°ææèç¹æ°æ®æéè¦çæ¶é´å°±è¶é¿ï¼å¯ç¨æ§å°±ä¼éä½ã\n\nå¤§å¤æ°åå¸å¼ç³»ç»é½åå¸å¨å¤ä¸ªå­ç½ç»ï¼æ¯ä¸ªå­ç½ç»å°±å«åä¸ä¸ªåºï¼Partitionï¼ãååºå®¹éçæææ¯ï¼åºé´éä¿¡å¯è½å¤±è´¥ãæ¯å¦ï¼ä¸å°æå¡å¨æ¾å¨ä¸­å½ï¼å¦ä¸å°æå¡å¨æ¾å¨ç¾å½ï¼è¿å°±æ¯ä¸¤ä¸ªåºï¼å®ä»¬ä¹é´å¯è½æ æ³éä¿¡ã\n\n\n\nä¸å¾ä¸­ï¼G1 å G2 æ¯ä¸¤å°è·¨åºçæå¡å¨ãG1 å G2 åéä¸æ¡æ¶æ¯ï¼G2 å¯è½æ æ³æ¶å°ãç³»ç»è®¾è®¡çæ¶åï¼å¿é¡»èèå°è¿ç§æåµã\n\nä¸è¬æ¥è¯´ï¼ååºå®¹éæ æ³é¿åï¼å æ­¤å¯ä»¥è®¤ä¸º CAP ç P æ»æ¯æç«ãCAP å®çåè¯æä»¬ï¼å©ä¸ç C å A æ æ³åæ¶åå°ã\n\n\n# 2.4. AP or CP\n\nå¨åå¸å¼ç³»ç»ä¸­ï¼ååºå®¹éæ§å¿ä¸å¯å°ï¼å ä¸ºéè¦æ»æ¯åè®¾ç½ç»æ¯ä¸å¯é çãå æ­¤ï¼CAP çè®ºå®éå¨æ¯è¦å¨å¯ç¨æ§åä¸è´æ§ä¹é´åæè¡¡ã\n\nç±äºåå¸å¼æ°æ®å­å¨ï¼å¦åºåé¾ï¼çæ§è´¨ï¼ååºå®¹éæ§æ¯ä¸ä¸ªæ¢å®çäºå®ï¼ç½ç»ä¸­æ»ä¼æå¤±è´¥/æ æ³è®¿é®çèç¹ï¼å°¤å¶æ¯å ä¸ºäºèç½çä¸ç¨³å®ç¹æ§ï¼ã CAP å®çæåºï¼å½å­å¨ Pï¼ååºï¼æ¶ï¼å¿é¡»å¨ Cï¼ä¸è´æ§ï¼æ Aï¼å¯ç¨æ§ï¼ä¹é´è¿è¡éæ©ã\n\nï¼1ï¼AP æ¨¡å¼\n\n> AP æ¨¡å¼ï¼å¯¹ç½ç»çæ¯ä¸ªè¯·æ±é½ä¼æ¶å°ååºï¼å³ä½¿ç½ç»ç±äºç½ç»ååºæéèæ æ³ä¿è¯å®æ¯ææ°çã\n\néæ© AP æ¨¡å¼ï¼å®ç°äºæå¡çé«å¯ç¨ãç¨æ·è®¿é®ç³»ç»çæ¶åï¼é½è½å¾å°ååºæ°æ®ï¼ä¸ä¼åºç°ååºéè¯¯ï¼ä½æ¯ï¼å½åºç°ååºæéæ¶ï¼ç¸åçè¯»æä½ï¼è®¿é®ä¸åçèç¹ï¼å¾å°ååºæ°æ®å¯è½ä¸ä¸æ ·ã\n\nï¼2ï¼CP æ¨¡å¼\n\n> CP æ¨¡å¼ï¼å¦æç±äºç½ç»ååºï¼æéèç¹ï¼èæ æ³ä¿è¯ç¹å®ä¿¡æ¯æ¯ææ°çï¼åç³»ç»å°è¿åéè¯¯æè¶æ¶ã\n\néæ© CP æ¨¡å¼ï¼è¿æ ·è½å¤æä¾ä¸é¨åçå¯ç¨æ§ãéç¨ CP æ¨¡åçåå¸å¼ç³»ç»ï¼ä¸æ¦å ä¸ºæ¶æ¯ä¸¢å¤±ãå»¶è¿è¿é«åçäºç½ç»ååºï¼å°±å½±åç¨æ·çä½éªåä¸å¡çå¯ç¨æ§ãå ä¸ºä¸ºäºé²æ­¢æ°æ®ä¸ä¸è´ï¼éç¾¤å°æç»æ°æ°æ®çåå¥ã\n\n\n# 3. BASE å®ç\n\n\n# 3.1. ä»ä¹æ¯ BASE å®ç\n\n> BASE å®çæ¯å¯¹ CAP ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æã\n\nBASE æ¯ åºæ¬å¯ç¨ï¼Basically Availableï¼ãè½¯ç¶æï¼Soft Stateï¼ å æç»ä¸è´æ§ï¼Eventually Consistentï¼ ä¸ä¸ªç­è¯­çç¼©åã\n\nBASE çè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n * **åºæ¬å¯ç¨ï¼Basically Availableï¼**åå¸å¼ç³»ç»å¨åºç°æéçæ¶åï¼ä¿è¯æ ¸å¿å¯ç¨ï¼åè®¸æå¤±é¨åå¯ç¨æ§ãä¾å¦ï¼çµåå¨åä¿éæ¶ï¼ä¸ºäºä¿è¯è´­ç©ç³»ç»çç¨³å®æ§ï¼é¨åæ¶è´¹èå¯è½ä¼è¢«å¼å¯¼å°ä¸ä¸ªéçº§çé¡µé¢ã\n * è½¯ç¶æï¼Soft Stateï¼æåè®¸ç³»ç»ä¸­çæ°æ®å­å¨ä¸­é´ç¶æï¼å¹¶è®¤ä¸ºè¯¥ä¸­é´ç¶æä¸ä¼å½±åç³»ç»æ´ä½å¯ç¨æ§ï¼å³åè®¸ç³»ç»ä¸åèç¹çæ°æ®å¯æ¬ä¹é´è¿è¡åæ­¥çè¿ç¨å­å¨å»¶æ¶ã\n * æç»ä¸è´æ§ï¼Eventually Consistentï¼å¼ºè°çæ¯ç³»ç»ä¸­ææçæ°æ®å¯æ¬ï¼å¨ç»è¿ä¸æ®µæ¶é´çåæ­¥åï¼æç»è½è¾¾å°ä¸è´çç¶æã\n\n\n\n\n# 3.2. BASE vs. ACID\n\nBASE ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\nACID è¦æ±å¼ºä¸è´æ§ï¼éå¸¸è¿ç¨å¨ä¼ ç»çæ°æ®åºç³»ç»ä¸ãè BASE è¦æ±æç»ä¸è´æ§ï¼éè¿çºç²å¼ºä¸è´æ§æ¥è¾¾å°å¯ç¨æ§ï¼éå¸¸è¿ç¨å¨å¤§ååå¸å¼ç³»ç»ä¸­ã\n\nå¨å®éçåå¸å¼åºæ¯ä¸­ï¼ä¸åä¸å¡åååç»ä»¶å¯¹ä¸è´æ§çè¦æ±æ¯ä¸åçï¼å æ­¤ ACID å BASE å¾å¾ä¼ç»åå¨ä¸èµ·ä½¿ç¨ã\n\n\n# 4. éè¯¯çåå¸å¼åè®¾\n\n> åå®¹æèª Fallacies of Distributed Computing\n\néçæ¶é´çæ¨ç§»ï¼æ¯ä¸æ¡é½ä¼è¢«è¯ææ¯éè¯¯çï¼ä¹é½ä¼å¯¼è´ä¸¥éçé®é¢ï¼ä»¥åçè¦çå­¦ä¹ ä½éªï¼\n\n * ç½ç»æ¯ç¨³å®ç\n * ç½ç»ä¼ è¾çå»¶è¿æ¯é¶\n * ç½ç»çå¸¦å®½æ¯æ ç©·å¤§\n * ç½ç»æ¯å®å¨ç\n * ç½ç»çææä¸ä¼æ¹å\n * åªæä¸ä¸ªç³»ç»ç®¡çå\n * ä¼ è¾æ°æ®çææ¬ä¸ºé¶\n * æ´ä¸ªç½ç»æ¯åæç\n\nä¸ºä»ä¹æä»¬è¦æ·±å»å°è®¤è¯è¿ 8 ä¸ªéè¯¯ï¼\n\næ¯å ä¸ºï¼è¿è¦æä»¬æ¸æ¥å°è®¤è¯å°ââå¨åå¸å¼ç³»ç»ä¸­ï¼éè¯¯æ¯ä¸å¯è½é¿åçãæ¢ç¶éè¯¯æ å¯é¿åï¼é£ä¹ï¼æä»¬åºè¯¥åçæ¯ï¼å°å®¹éä¹ä½ä¸ºåè½å»å®ç°ã\n\n\n# 5. æå åº­å°åé®é¢\n\n> æå åº­å°åé®é¢æ¯ç±è±æ¯å©Â·å°æ³¢ç¹å¨å¶ååè®ºæä¸­æåºçåå¸å¼å¯¹ç­ç½ç»éä¿¡å®¹éé®é¢ã\n> \n> å¨åå¸å¼è®¡ç®ä¸­ï¼ä¸åçèç¹éè¿éè®¯äº¤æ¢ä¿¡æ¯è¾¾æå±è¯èæç§åä¸å¥åä½ç­ç¥è¡å¨ãä½ææ¶åï¼ç³»ç»ä¸­çèç¹å¯è½åºéèåééè¯¯çä¿¡æ¯ï¼ç¨äºä¼ éä¿¡æ¯çéè®¯ç½ç»ä¹å¯è½å¯¼è´ä¿¡æ¯æåï¼ä½¿å¾ç½ç»ä¸­ä¸åçæåå³äºå¨ä½åä½çç­ç¥å¾åºä¸åç»è®ºï¼ä»èç ´åç³»ç»ä¸è´æ§ãæå åº­å°åé®é¢è¢«è®¤ä¸ºæ¯å®¹éæ§é®é¢ä¸­æé¾çé®é¢ç±»åä¹ä¸ã\n\n\n# 5.1. é®é¢æè¿°\n\nä¸ç¾¤æå åº­å°ååé¢ä¸æ¯åéå±åå´å°ä¸åº§åå¸ã\n\nä¸ºäºç®åé®é¢ï¼åéçè¡å¨ç­ç¥åªæä¸¤ç§ï¼è¿æ»ï¼Attackï¼åé¢ç®ç§° Aï¼æ æ¤éï¼Retreatï¼åé¢ç®ç§° Rï¼ãå¦æè¿äºåéä¸æ¯ç»ä¸è¿æ»ææ¤éï¼å°±å¯è½å åµåä¸è¶³å¯¼è´å¤±è´¥ãå æ­¤ï¼å°åä»¬éè¿æç¥¨æ¥è¾¾æä¸è´ç­ç¥ï¼åè¿æåéã\n\nå ä¸ºå°åä»¬åå«å¨åå¸çä¸åæ¹ä½ï¼æä»¥ä»ä»¬åªè½éè¿ä¿¡ä½¿äºç¸èç³»ãå¨æç¥¨è¿ç¨ä¸­ï¼æ¯ä½å°åé½å°èªå·±çæç¥¨ä¿¡æ¯ï¼A æ Rï¼éç¥å¶ä»ææå°åï¼è¿æ ·ä¸æ¥æ¯ä½å°åæ ¹æ®èªå·±çæç¥¨åå¶ä»ææå°åéæ¥çä¿¡æ¯å°±å¯ä»¥åæåºå±åçæç¥¨ç»æèå³å®è¡å¨ç­ç¥ã\n\nè¿ä¸ªæ½è±¡æ¨¡åçé®é¢å¨äºï¼å°åä¸­å¯è½å­å¨åå¾ï¼ä»ä»¬ä¸ä»ä¼ååºè¯¯å¯¼æ§æç¥¨ï¼è¿å¯è½éæ©æ§å°åéæç¥¨ä¿¡æ¯ã\n\nç±äºå°åä¹é´éè¦éè¿ä¿¡ä½¿éè®¯ï¼ååå°åå¯è½éè¿ä¼ªé ä¿¡ä»¶æ¥ä»¥å¶ä»å°åçèº«ä»½åéåæç¥¨ãèå³ä½¿å¨ä¿è¯ææå°åå¿ è¯çæåµä¸ï¼ä¹ä¸è½æé¤ä¿¡ä½¿è¢«æäººæªæï¼çè³è¢«æäººé´è°æ¿æ¢ç­æåµãå æ­¤å¾é¾éè¿ä¿è¯äººåå¯é æ§åéè®¯å¯é æ§æ¥è§£å³é®é¢ã\n\nåä½¿é£äºå¿ è¯ï¼ææ¯æ²¡æåºéï¼çå°åä»ç¶è½éè¿å¤æ°å³å®æ¥å³å®ä»ä»¬çæç¥ï¼ä¾¿ç§°è¾¾å°äºæå åº­å®¹éãå¨æ­¤ï¼ç¥¨é½ä¼æä¸ä¸ªé»è®¤å¼ï¼è¥æ¶æ¯ï¼ç¥¨ï¼æ²¡æè¢«æ¶å°ï¼åä½¿ç¨æ­¤é»è®¤å¼æ¥æç¥¨ã\n\nä¸è¿°çæäºå¯ä»¥æ å°å°åå¸å¼ç³»ç»ä¸­ï¼å°åä»£è¡¨åå¸å¼ç³»ç»ä¸­çèç¹ï¼ä¿¡ä½¿ä»£è¡¨éä¿¡ç³»ç»ï¼åå¾ä»£è¡¨æéæå¼å¸¸ã\n\n\n\n\n# 5.2. é®é¢åæ\n\n> å°ä¼¯ç¹éå¯¹æå åº­å°åé®é¢ï¼ç»åºäºä¸¤ä¸ªè§£å³æ¹æ¡ï¼å£å¤´åè®®åä¹¦é¢åè®®ã\n> \n> æ¬æä»ç»ä¸ä¸å£å¤´åè®®ã\n\nå¨å£å¤´åè®®ä¸­ï¼æå åº­å°åé®é¢è¢«ç®åä¸ºå°å - å¯å®æ¨¡åï¼å¶æ ¸å¿è§åå¦ä¸ï¼\n\n * å¿ è¯çå¯å®éµå®åä¸å½ä»¤ã\n * è¥å°åæ¯å¿ è¯çï¼ææå¿ è¯çå¯å®é½æ§è¡ä»çå½ä»¤ã\n * å¦æåå¾äººæ°ä¸º mï¼å°åäººæ°ä¸è½å°äº 3m + 1 ï¼é£ä¹æå åº­å°åé®é¢å°±è½è§£å³äºã\n\nç¤ºä¾ä¸ãåå¾äººæ°ä¸º 1ï¼å°åäººæ°ä¸º 3\n\n\n\nè¿ä¸ªç¤ºä¾ä¸­ï¼å°åäººæ°ä¸æ»¡è¶³ 3m + 1ï¼æ æ³ä¿è¯å¿ è¯çå¯å®é½æ§è¡å°åçå½ä»¤ã\n\nç¤ºä¾äºãåå¾äººæ°ä¸º 1ï¼å°åäººæ°ä¸º 4\n\n\n\nè¿ä¸ªç¤ºä¾ä¸­ï¼å°åäººæ°æ»¡è¶³ 3m + 1ï¼æ è®ºæ¯å¯å®ä¸­æåå¾ï¼è¿æ¯å°åæ¯åå¾ï¼é½è½ä¿è¯å¿ è¯çå¯å®æ§è¡å°åçå½ä»¤ã\n\n\n# 6. åèèµæ\n\n * Wiki - æå åº­å°åé®é¢\n * æå åº­å°åé®é¢è§é¢è®²è§£ - ææ°¸ä¹èå¸è®²è§£çéä¿ææ\n * Fallacies of Distributed Computing - åå¸å¼ç³»ç»æ°æå¸¸ç¯ç 8 ä¸ªéè¯¯ï¼å¹¶æ¢è®¨äºå¶ä¼å¸¦æ¥çå½±åã\n * Distributed Systems for Fun and Profit - ä¸æ¬å­¦ä¹ å°åï¼æ¶µçäºåå¸å¼ç³»ç»ä¸­çå³é®é®é¢ï¼åæ¬æ¶é´çä½ç¨åä¸åçå¤å¶ç­ç¥ã\n * A Note on Distributed Systems - è¿æ¯ä¸ç¯ç»å¸çè®ºæï¼è®²è¿°äºä¸ºä»ä¹å¨åå¸å¼ç³»ç»ä¸­ï¼è¿ç¨äº¤äºä¸è½åæ¬å°å¯¹è±¡é£æ ·è¿è¡ã\n * Amazonâs Highly Available Key-value Store\n * CAP Theorem\n * CAP twelve years later: How the "rules" have changed\n * CAP å®ççå«ä¹ - by é®ä¸å³°\n * ç¥ä¸æ ·ç CAP çè®ºè¢«åºç¨å¨ä½æ¹\n * BASE: An Acid Alternative',normalizedContent:'# åå¸å¼çè®º\n\n\n\n\n# 1. åå¸å¼ç¹æ§ååç±»\n\n\n# 1.1. åå¸å¼ç¹æ§\n\n * æ§è½ï¼ç¨äºè¡¡éä¸ä¸ªç³»ç»å¤çåç§ä»»å¡çè½åã\n   * ååéï¼ç³»ç»å¨ä¸å®æ¶é´åå¯ä»¥å¤ççä»»å¡æ°ã\n     * qpsï¼å³æ¯ç§æ¥è¯¢æ°\n     * tpsï¼å³æ¯ç§äºå¡æ°\n   * ååºæ¶é´ï¼ç³»ç»ååºä¸ä¸ªè¯·æ±æè¾å¥éè¦è±è´¹çæ¶é´ã\n * å¯ç¨æ§ï¼æçæ¯ç³»ç»å¨é¢å¯¹åç§å¼å¸¸æ¶å¯ä»¥æ­£ç¡®æä¾æå¡çè½åãç³»ç»çå¯ç¨æ§å¯ä»¥ç¨ç³»ç»åæ­¢æå¡çæ¶é´ä¸æ»çæ¶é´ä¹æ¯è¡¡éã\n * å¯æ©å±æ§ï¼æçæ¯åå¸å¼ç³»ç»éè¿æ©å±éç¾¤æºå¨è§æ¨¡æé«ç³»ç»æ§è½ (ååãååºæ¶é´ã å®ææ¶é´)ãå­å¨å®¹éãè®¡ç®è½åçç¹æ§ï¼æ¯åå¸å¼ç³»ç»çç¹ææ§è´¨ã\n\n\n# 1.2. åå¸å¼åç±»\n\n * åå¸å¼è®¡ç®ï¼è§£å³åºç¨çåå¸å¼è®¡ç®é®é¢ãåºäºåå¸å¼è®¡ç®æ¨¡å¼ï¼åæ¬æ¹å¤çè®¡ç®ãç¦»çº¿è®¡ç®ãå¨çº¿è®¡ç®ãèåè®¡ç®ç­ï¼æ ¹æ®åºç¨ç±»åæå»ºé«ææºè½çåå¸å¼è®¡ç®æ¡æ¶ã\n * åå¸å¼å­å¨ï¼è§£å³æ°æ®çåå¸å¼åå¤ååé®é¢ãåæ¬åå¸å¼æ°æ®åºãåå¸å¼æä»¶ç³»ç»ãåå¸å¼ç¼å­ç­ï¼æ¯æä¸åç±»åçæ°æ®çå­å¨åç®¡çã\n * åå¸å¼éä¿¡ï¼è§£å³è¿ç¨é´çåå¸å¼éä¿¡é®é¢ãéè¿æ¶æ¯éåãè¿ç¨è°ç¨ç­æ¹å¼ï¼å®ç°ç®åé«æçéä¿¡ã\n * åå¸å¼èµæºç®¡çï¼è§£å³èµæºçåå¸å¼åå¼ææ§é®é¢ãå° cpuãåå­ãio ç­ç©çèµæºèæåï¼æ°åé»è¾èµæºæ± ï¼ä»¥ä¾¿ç»ä¸ç®¡çã\n\n\n# 2. cap å®ç\n\n> cap å®çæ¯å å·å¤§å­¦è®¡ç®æºç§å­¦å®¶åéåÂ·å¸é²å°æåºæ¥ççæ³ï¼åæ¥è¢«è¯ææä¸ºåå¸å¼è®¡ç®é¢åå¬è®¤çå®çã\n\ncap å®çï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\ncap å°±æ¯å consistencyãavailabilityãpartition tolerance çé¦å­æ¯èå½åã\n\n\n\n * ä¸è´æ§ï¼consistencyï¼ï¼å¨ä»»ä½ç»å®æ¶é´ï¼ç½ç»ä¸­çææèç¹é½å·æå®å¨ç¸åï¼æè¿ï¼çå¼ã\n * å¯ç¨æ§ï¼availabilityï¼ï¼å¯¹ç½ç»çæ¯ä¸ªè¯·æ±é½ä¼æ¶å°ååºï¼ä½ä¸è½ä¿è¯è¿åçæ°æ®æ¯ææ°çã\n * ååºå®¹éæ§ï¼partition toleranceï¼ï¼å³ä½¿ä»»ææ°éçèç¹åºç°æéï¼ç½ç»ä»ä¼ç»§ç»­è¿è¡ã\n\n\n# 2.1. ä¸è´æ§\n\nä¸è´æ§ï¼consistencyï¼æçæ¯å¤ä¸ªæ°æ®å¯æ¬æ¯å¦è½ä¿æä¸è´çç¹æ§ã\n\nå¨ä¸è´æ§çæ¡ä»¶ä¸ï¼åå¸å¼ç³»ç»å¨æ§è¡åæä½æååï¼å¦æææç¨æ·é½è½å¤è¯»åå°ææ°çå¼ï¼è¯¥ç³»ç»å°±è¢«è®¤ä¸ºå·æå¼ºä¸è´æ§ã\n\næ°æ®ä¸è´æ§åå¯ä»¥åä¸ºä»¥ä¸å ç¹ï¼\n\n * å¼ºä¸è´æ§ - æ°æ®æ´æ°æä½ç»æåæä½ååºæ»æ¯ä¸è´çï¼å³æä½ååºéç¥æ´æ°å¤±è´¥ï¼é£ä¹æ°æ®ä¸å®æ²¡æè¢«æ´æ°ï¼èä¸æ¯å¤äºä¸ç¡®å®ç¶æã\n * æç»ä¸è´æ§ - å³ç©çå­å¨çæ°æ®å¯è½æ¯ä¸ä¸è´çï¼ç»ç«¯ç¨æ·è®¿é®å°çæ°æ®å¯è½ä¹æ¯ä¸ä¸è´çï¼ä½ç³»ç»ç»è¿ä¸æ®µæ¶é´çèªæä¿®å¤åä¿®æ­£ï¼æ°æ®æç»ä¼è¾¾å°ä¸è´ã\n\nä¸¾ä¾æ¥è¯´ï¼ææ¡è®°å½æ¯ v0ï¼ç¨æ·å g1 åèµ·ä¸ä¸ªåæä½ï¼å°å¶æ¹ä¸º v1ã\n\n\n\næ¥ä¸æ¥ï¼ç¨æ·çè¯»æä½å°±ä¼å¾å° v1ãè¿å°±å«ä¸è´æ§ã\n\n\n\né®é¢æ¯ï¼ç¨æ·æå¯è½å g2 åèµ·è¯»æä½ï¼ç±äº g2 çå¼æ²¡æåçååï¼å æ­¤è¿åçæ¯ v0ãg1 å g2 è¯»æä½çç»æä¸ä¸è´ï¼è¿å°±ä¸æ»¡è¶³ä¸è´æ§äºã\n\n\n\nä¸ºäºè®© g2 ä¹è½åä¸º v1ï¼å°±è¦å¨ g1 åæä½çæ¶åï¼è®© g1 å g2 åéä¸æ¡æ¶æ¯ï¼è¦æ± g2 ä¹æ¹æ v1ã\n\n\n\nè¿æ ·çè¯ï¼ç¨æ·å g2 åèµ·è¯»æä½ï¼ä¹è½å¾å° v1ã\n\n\n\n\n# 2.2. å¯ç¨æ§\n\nå¯ç¨æ§æåå¸å¼ç³»ç»å¨é¢å¯¹åç§å¼å¸¸æ¶å¯ä»¥æä¾æ­£å¸¸æå¡çè½åï¼å¯ä»¥ç¨ç³»ç»å¯ç¨æ¶é´å æ»æ¶é´çæ¯å¼æ¥è¡¡éï¼4 ä¸ª 9 çå¯ç¨æ§è¡¨ç¤ºç³»ç» 99.99% çæ¶é´æ¯å¯ç¨çã\n\nå¨å¯ç¨æ§æ¡ä»¶ä¸ï¼ç³»ç»æä¾çæå¡ä¸ç´å¤äºå¯ç¨çç¶æï¼å¯¹äºç¨æ·çæ¯ä¸ä¸ªæä½è¯·æ±æ»æ¯è½å¤å¨æéçæ¶é´åè¿åç»æã\n\n\n# 2.3. ååºå®¹éæ§\n\nååºå®¹éæ§ï¼partition toleranceï¼æ åå¸å¼ç³»ç»å¨éå°ä»»ä½ç½ç»ååºæéçæ¶åï¼ä»ç¶éè¦è½å¯¹å¤æä¾ä¸è´æ§åå¯ç¨æ§çæå¡ï¼é¤éæ¯æ´ä¸ªç½ç»ç¯å¢é½åçäºæéã\n\nå¨ä¸ä¸ªåå¸å¼ç³»ç»éé¢ï¼èç¹ç»æçç½ç»æ¬æ¥åºè¯¥æ¯è¿éçãç¶èå¯è½å ä¸ºä¸äºæéï¼ä½¿å¾æäºèç¹ä¹é´ä¸è¿éäºï¼æ´ä¸ªç½ç»å°±åæäºå ååºåãæ°æ®å°±æ£å¸å¨äºè¿äºä¸è¿éçåºåä¸­ï¼è¿å°±å«ååºã\n\nåè®¾ï¼æä¸ªæ°æ®é¡¹åªå¨ä¸ä¸ªèç¹ä¸­ä¿å­ï¼é£ä¹ååºåºç°åï¼åè¿ä¸ªèç¹ä¸è¿éçé¨åå°±è®¿é®ä¸å°è¿ä¸ªæ°æ®äºãè¿æ¶ååºå°±æ¯æ æ³å®¹å¿çã\n\næé«ååºå®¹éæ§çåæ³å°±æ¯ä¸ä¸ªæ°æ®é¡¹å¤å¶å°å¤ä¸ªèç¹ä¸ï¼é£ä¹åºç°ååºä¹åï¼è¿ä¸æ°æ®é¡¹å°±å¯è½åå¸å°åä¸ªåºéãå®¹éæ§å°±æé«äºã\n\nç¶èï¼è¦ææ°æ®å¤å¶å°å¤ä¸ªèç¹ï¼å°±ä¼å¸¦æ¥ä¸è´æ§çé®é¢ï¼å°±æ¯å¤ä¸ªèç¹ä¸é¢çæ°æ®å¯è½æ¯ä¸ä¸è´çãè¦ä¿è¯ä¸è´ï¼æ¯æ¬¡åæä½å°±é½è¦ç­å¾å¨é¨èç¹åæåï¼èè¿ç­å¾åä¼å¸¦æ¥å¯ç¨æ§çé®é¢ã\n\næ»çæ¥è¯´å°±æ¯ï¼æ°æ®å­å¨çèç¹è¶å¤ï¼ååºå®¹éæ§è¶é«ï¼ä½è¦å¤å¶æ´æ°çæ°æ®å°±è¶å¤ï¼ä¸è´æ§å°±è¶é¾ä¿è¯ãä¸ºäºä¿è¯ä¸è´æ§ï¼æ´æ°ææèç¹æ°æ®æéè¦çæ¶é´å°±è¶é¿ï¼å¯ç¨æ§å°±ä¼éä½ã\n\nå¤§å¤æ°åå¸å¼ç³»ç»é½åå¸å¨å¤ä¸ªå­ç½ç»ï¼æ¯ä¸ªå­ç½ç»å°±å«åä¸ä¸ªåºï¼partitionï¼ãååºå®¹éçæææ¯ï¼åºé´éä¿¡å¯è½å¤±è´¥ãæ¯å¦ï¼ä¸å°æå¡å¨æ¾å¨ä¸­å½ï¼å¦ä¸å°æå¡å¨æ¾å¨ç¾å½ï¼è¿å°±æ¯ä¸¤ä¸ªåºï¼å®ä»¬ä¹é´å¯è½æ æ³éä¿¡ã\n\n\n\nä¸å¾ä¸­ï¼g1 å g2 æ¯ä¸¤å°è·¨åºçæå¡å¨ãg1 å g2 åéä¸æ¡æ¶æ¯ï¼g2 å¯è½æ æ³æ¶å°ãç³»ç»è®¾è®¡çæ¶åï¼å¿é¡»èèå°è¿ç§æåµã\n\nä¸è¬æ¥è¯´ï¼ååºå®¹éæ æ³é¿åï¼å æ­¤å¯ä»¥è®¤ä¸º cap ç p æ»æ¯æç«ãcap å®çåè¯æä»¬ï¼å©ä¸ç c å a æ æ³åæ¶åå°ã\n\n\n# 2.4. ap or cp\n\nå¨åå¸å¼ç³»ç»ä¸­ï¼ååºå®¹éæ§å¿ä¸å¯å°ï¼å ä¸ºéè¦æ»æ¯åè®¾ç½ç»æ¯ä¸å¯é çãå æ­¤ï¼cap çè®ºå®éå¨æ¯è¦å¨å¯ç¨æ§åä¸è´æ§ä¹é´åæè¡¡ã\n\nç±äºåå¸å¼æ°æ®å­å¨ï¼å¦åºåé¾ï¼çæ§è´¨ï¼ååºå®¹éæ§æ¯ä¸ä¸ªæ¢å®çäºå®ï¼ç½ç»ä¸­æ»ä¼æå¤±è´¥/æ æ³è®¿é®çèç¹ï¼å°¤å¶æ¯å ä¸ºäºèç½çä¸ç¨³å®ç¹æ§ï¼ã cap å®çæåºï¼å½å­å¨ pï¼ååºï¼æ¶ï¼å¿é¡»å¨ cï¼ä¸è´æ§ï¼æ aï¼å¯ç¨æ§ï¼ä¹é´è¿è¡éæ©ã\n\nï¼1ï¼ap æ¨¡å¼\n\n> ap æ¨¡å¼ï¼å¯¹ç½ç»çæ¯ä¸ªè¯·æ±é½ä¼æ¶å°ååºï¼å³ä½¿ç½ç»ç±äºç½ç»ååºæéèæ æ³ä¿è¯å®æ¯ææ°çã\n\néæ© ap æ¨¡å¼ï¼å®ç°äºæå¡çé«å¯ç¨ãç¨æ·è®¿é®ç³»ç»çæ¶åï¼é½è½å¾å°ååºæ°æ®ï¼ä¸ä¼åºç°ååºéè¯¯ï¼ä½æ¯ï¼å½åºç°ååºæéæ¶ï¼ç¸åçè¯»æä½ï¼è®¿é®ä¸åçèç¹ï¼å¾å°ååºæ°æ®å¯è½ä¸ä¸æ ·ã\n\nï¼2ï¼cp æ¨¡å¼\n\n> cp æ¨¡å¼ï¼å¦æç±äºç½ç»ååºï¼æéèç¹ï¼èæ æ³ä¿è¯ç¹å®ä¿¡æ¯æ¯ææ°çï¼åç³»ç»å°è¿åéè¯¯æè¶æ¶ã\n\néæ© cp æ¨¡å¼ï¼è¿æ ·è½å¤æä¾ä¸é¨åçå¯ç¨æ§ãéç¨ cp æ¨¡åçåå¸å¼ç³»ç»ï¼ä¸æ¦å ä¸ºæ¶æ¯ä¸¢å¤±ãå»¶è¿è¿é«åçäºç½ç»ååºï¼å°±å½±åç¨æ·çä½éªåä¸å¡çå¯ç¨æ§ãå ä¸ºä¸ºäºé²æ­¢æ°æ®ä¸ä¸è´ï¼éç¾¤å°æç»æ°æ°æ®çåå¥ã\n\n\n# 3. base å®ç\n\n\n# 3.1. ä»ä¹æ¯ base å®ç\n\n> base å®çæ¯å¯¹ cap ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æã\n\nbase æ¯ åºæ¬å¯ç¨ï¼basically availableï¼ãè½¯ç¶æï¼soft stateï¼ å æç»ä¸è´æ§ï¼eventually consistentï¼ ä¸ä¸ªç­è¯­çç¼©åã\n\nbase çè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n * **åºæ¬å¯ç¨ï¼basically availableï¼**åå¸å¼ç³»ç»å¨åºç°æéçæ¶åï¼ä¿è¯æ ¸å¿å¯ç¨ï¼åè®¸æå¤±é¨åå¯ç¨æ§ãä¾å¦ï¼çµåå¨åä¿éæ¶ï¼ä¸ºäºä¿è¯è´­ç©ç³»ç»çç¨³å®æ§ï¼é¨åæ¶è´¹èå¯è½ä¼è¢«å¼å¯¼å°ä¸ä¸ªéçº§çé¡µé¢ã\n * è½¯ç¶æï¼soft stateï¼æåè®¸ç³»ç»ä¸­çæ°æ®å­å¨ä¸­é´ç¶æï¼å¹¶è®¤ä¸ºè¯¥ä¸­é´ç¶æä¸ä¼å½±åç³»ç»æ´ä½å¯ç¨æ§ï¼å³åè®¸ç³»ç»ä¸åèç¹çæ°æ®å¯æ¬ä¹é´è¿è¡åæ­¥çè¿ç¨å­å¨å»¶æ¶ã\n * æç»ä¸è´æ§ï¼eventually consistentï¼å¼ºè°çæ¯ç³»ç»ä¸­ææçæ°æ®å¯æ¬ï¼å¨ç»è¿ä¸æ®µæ¶é´çåæ­¥åï¼æç»è½è¾¾å°ä¸è´çç¶æã\n\n\n\n\n# 3.2. base vs. acid\n\nbase ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\nacid è¦æ±å¼ºä¸è´æ§ï¼éå¸¸è¿ç¨å¨ä¼ ç»çæ°æ®åºç³»ç»ä¸ãè base è¦æ±æç»ä¸è´æ§ï¼éè¿çºç²å¼ºä¸è´æ§æ¥è¾¾å°å¯ç¨æ§ï¼éå¸¸è¿ç¨å¨å¤§ååå¸å¼ç³»ç»ä¸­ã\n\nå¨å®éçåå¸å¼åºæ¯ä¸­ï¼ä¸åä¸å¡åååç»ä»¶å¯¹ä¸è´æ§çè¦æ±æ¯ä¸åçï¼å æ­¤ acid å base å¾å¾ä¼ç»åå¨ä¸èµ·ä½¿ç¨ã\n\n\n# 4. éè¯¯çåå¸å¼åè®¾\n\n> åå®¹æèª fallacies of distributed computing\n\néçæ¶é´çæ¨ç§»ï¼æ¯ä¸æ¡é½ä¼è¢«è¯ææ¯éè¯¯çï¼ä¹é½ä¼å¯¼è´ä¸¥éçé®é¢ï¼ä»¥åçè¦çå­¦ä¹ ä½éªï¼\n\n * ç½ç»æ¯ç¨³å®ç\n * ç½ç»ä¼ è¾çå»¶è¿æ¯é¶\n * ç½ç»çå¸¦å®½æ¯æ ç©·å¤§\n * ç½ç»æ¯å®å¨ç\n * ç½ç»çææä¸ä¼æ¹å\n * åªæä¸ä¸ªç³»ç»ç®¡çå\n * ä¼ è¾æ°æ®çææ¬ä¸ºé¶\n * æ´ä¸ªç½ç»æ¯åæç\n\nä¸ºä»ä¹æä»¬è¦æ·±å»å°è®¤è¯è¿ 8 ä¸ªéè¯¯ï¼\n\næ¯å ä¸ºï¼è¿è¦æä»¬æ¸æ¥å°è®¤è¯å°ââå¨åå¸å¼ç³»ç»ä¸­ï¼éè¯¯æ¯ä¸å¯è½é¿åçãæ¢ç¶éè¯¯æ å¯é¿åï¼é£ä¹ï¼æä»¬åºè¯¥åçæ¯ï¼å°å®¹éä¹ä½ä¸ºåè½å»å®ç°ã\n\n\n# 5. æå åº­å°åé®é¢\n\n> æå åº­å°åé®é¢æ¯ç±è±æ¯å©Â·å°æ³¢ç¹å¨å¶ååè®ºæä¸­æåºçåå¸å¼å¯¹ç­ç½ç»éä¿¡å®¹éé®é¢ã\n> \n> å¨åå¸å¼è®¡ç®ä¸­ï¼ä¸åçèç¹éè¿éè®¯äº¤æ¢ä¿¡æ¯è¾¾æå±è¯èæç§åä¸å¥åä½ç­ç¥è¡å¨ãä½ææ¶åï¼ç³»ç»ä¸­çèç¹å¯è½åºéèåééè¯¯çä¿¡æ¯ï¼ç¨äºä¼ éä¿¡æ¯çéè®¯ç½ç»ä¹å¯è½å¯¼è´ä¿¡æ¯æåï¼ä½¿å¾ç½ç»ä¸­ä¸åçæåå³äºå¨ä½åä½çç­ç¥å¾åºä¸åç»è®ºï¼ä»èç ´åç³»ç»ä¸è´æ§ãæå åº­å°åé®é¢è¢«è®¤ä¸ºæ¯å®¹éæ§é®é¢ä¸­æé¾çé®é¢ç±»åä¹ä¸ã\n\n\n# 5.1. é®é¢æè¿°\n\nä¸ç¾¤æå åº­å°ååé¢ä¸æ¯åéå±åå´å°ä¸åº§åå¸ã\n\nä¸ºäºç®åé®é¢ï¼åéçè¡å¨ç­ç¥åªæä¸¤ç§ï¼è¿æ»ï¼attackï¼åé¢ç®ç§° aï¼æ æ¤éï¼retreatï¼åé¢ç®ç§° rï¼ãå¦æè¿äºåéä¸æ¯ç»ä¸è¿æ»ææ¤éï¼å°±å¯è½å åµåä¸è¶³å¯¼è´å¤±è´¥ãå æ­¤ï¼å°åä»¬éè¿æç¥¨æ¥è¾¾æä¸è´ç­ç¥ï¼åè¿æåéã\n\nå ä¸ºå°åä»¬åå«å¨åå¸çä¸åæ¹ä½ï¼æä»¥ä»ä»¬åªè½éè¿ä¿¡ä½¿äºç¸èç³»ãå¨æç¥¨è¿ç¨ä¸­ï¼æ¯ä½å°åé½å°èªå·±çæç¥¨ä¿¡æ¯ï¼a æ rï¼éç¥å¶ä»ææå°åï¼è¿æ ·ä¸æ¥æ¯ä½å°åæ ¹æ®èªå·±çæç¥¨åå¶ä»ææå°åéæ¥çä¿¡æ¯å°±å¯ä»¥åæåºå±åçæç¥¨ç»æèå³å®è¡å¨ç­ç¥ã\n\nè¿ä¸ªæ½è±¡æ¨¡åçé®é¢å¨äºï¼å°åä¸­å¯è½å­å¨åå¾ï¼ä»ä»¬ä¸ä»ä¼ååºè¯¯å¯¼æ§æç¥¨ï¼è¿å¯è½éæ©æ§å°åéæç¥¨ä¿¡æ¯ã\n\nç±äºå°åä¹é´éè¦éè¿ä¿¡ä½¿éè®¯ï¼ååå°åå¯è½éè¿ä¼ªé ä¿¡ä»¶æ¥ä»¥å¶ä»å°åçèº«ä»½åéåæç¥¨ãèå³ä½¿å¨ä¿è¯ææå°åå¿ è¯çæåµä¸ï¼ä¹ä¸è½æé¤ä¿¡ä½¿è¢«æäººæªæï¼çè³è¢«æäººé´è°æ¿æ¢ç­æåµãå æ­¤å¾é¾éè¿ä¿è¯äººåå¯é æ§åéè®¯å¯é æ§æ¥è§£å³é®é¢ã\n\nåä½¿é£äºå¿ è¯ï¼ææ¯æ²¡æåºéï¼çå°åä»ç¶è½éè¿å¤æ°å³å®æ¥å³å®ä»ä»¬çæç¥ï¼ä¾¿ç§°è¾¾å°äºæå åº­å®¹éãå¨æ­¤ï¼ç¥¨é½ä¼æä¸ä¸ªé»è®¤å¼ï¼è¥æ¶æ¯ï¼ç¥¨ï¼æ²¡æè¢«æ¶å°ï¼åä½¿ç¨æ­¤é»è®¤å¼æ¥æç¥¨ã\n\nä¸è¿°çæäºå¯ä»¥æ å°å°åå¸å¼ç³»ç»ä¸­ï¼å°åä»£è¡¨åå¸å¼ç³»ç»ä¸­çèç¹ï¼ä¿¡ä½¿ä»£è¡¨éä¿¡ç³»ç»ï¼åå¾ä»£è¡¨æéæå¼å¸¸ã\n\n\n\n\n# 5.2. é®é¢åæ\n\n> å°ä¼¯ç¹éå¯¹æå åº­å°åé®é¢ï¼ç»åºäºä¸¤ä¸ªè§£å³æ¹æ¡ï¼å£å¤´åè®®åä¹¦é¢åè®®ã\n> \n> æ¬æä»ç»ä¸ä¸å£å¤´åè®®ã\n\nå¨å£å¤´åè®®ä¸­ï¼æå åº­å°åé®é¢è¢«ç®åä¸ºå°å - å¯å®æ¨¡åï¼å¶æ ¸å¿è§åå¦ä¸ï¼\n\n * å¿ è¯çå¯å®éµå®åä¸å½ä»¤ã\n * è¥å°åæ¯å¿ è¯çï¼ææå¿ è¯çå¯å®é½æ§è¡ä»çå½ä»¤ã\n * å¦æåå¾äººæ°ä¸º mï¼å°åäººæ°ä¸è½å°äº 3m + 1 ï¼é£ä¹æå åº­å°åé®é¢å°±è½è§£å³äºã\n\nç¤ºä¾ä¸ãåå¾äººæ°ä¸º 1ï¼å°åäººæ°ä¸º 3\n\n\n\nè¿ä¸ªç¤ºä¾ä¸­ï¼å°åäººæ°ä¸æ»¡è¶³ 3m + 1ï¼æ æ³ä¿è¯å¿ è¯çå¯å®é½æ§è¡å°åçå½ä»¤ã\n\nç¤ºä¾äºãåå¾äººæ°ä¸º 1ï¼å°åäººæ°ä¸º 4\n\n\n\nè¿ä¸ªç¤ºä¾ä¸­ï¼å°åäººæ°æ»¡è¶³ 3m + 1ï¼æ è®ºæ¯å¯å®ä¸­æåå¾ï¼è¿æ¯å°åæ¯åå¾ï¼é½è½ä¿è¯å¿ è¯çå¯å®æ§è¡å°åçå½ä»¤ã\n\n\n# 6. åèèµæ\n\n * wiki - æå åº­å°åé®é¢\n * æå åº­å°åé®é¢è§é¢è®²è§£ - ææ°¸ä¹èå¸è®²è§£çéä¿ææ\n * fallacies of distributed computing - åå¸å¼ç³»ç»æ°æå¸¸ç¯ç 8 ä¸ªéè¯¯ï¼å¹¶æ¢è®¨äºå¶ä¼å¸¦æ¥çå½±åã\n * distributed systems for fun and profit - ä¸æ¬å­¦ä¹ å°åï¼æ¶µçäºåå¸å¼ç³»ç»ä¸­çå³é®é®é¢ï¼åæ¬æ¶é´çä½ç¨åä¸åçå¤å¶ç­ç¥ã\n * a note on distributed systems - è¿æ¯ä¸ç¯ç»å¸çè®ºæï¼è®²è¿°äºä¸ºä»ä¹å¨åå¸å¼ç³»ç»ä¸­ï¼è¿ç¨äº¤äºä¸è½åæ¬å°å¯¹è±¡é£æ ·è¿è¡ã\n * amazonâs highly available key-value store\n * cap theorem\n * cap twelve years later: how the "rules" have changed\n * cap å®ççå«ä¹ - by é®ä¸å³°\n * ç¥ä¸æ ·ç cap çè®ºè¢«åºç¨å¨ä½æ¹\n * base: an acid alternative',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ·±å¥åæå±è¯æ§ç®æ³ Paxos",frontmatter:{title:"æ·±å¥åæå±è¯æ§ç®æ³ Paxos",categories:["åå¸å¼","åå¸å¼çè®º"],tags:["åå¸å¼","åå¸å¼çè®º","å±è¯æ§","Paxos"],abbrlink:"9a1bd25e",date:"2020-02-02T22:00:00.000Z",permalink:"/pages/874539/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/02.%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA/02.%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95Paxos.html",relativePath:"02.åå¸å¼/02.åå¸å¼çè®º/02.åå¸å¼ç®æ³Paxos.md",key:"v-47519682",path:"/pages/874539/",headers:[{level:2,title:"1. Paxos èæ¯",slug:"_1-paxos-èæ¯",normalizedTitle:"1. paxos èæ¯",charIndex:152},{level:2,title:"2. Basic Paxos ç®æ³",slug:"_2-basic-paxos-ç®æ³",normalizedTitle:"2. basic paxos ç®æ³",charIndex:668},{level:3,title:"2.1. è§è²",slug:"_2-1-è§è²",normalizedTitle:"2.1. è§è²",charIndex:690},{level:3,title:"2.2. ç®æ³",slug:"_2-2-ç®æ³",normalizedTitle:"2.2. ç®æ³",charIndex:1010},{level:3,title:"2.3. å®ä¾",slug:"_2-3-å®ä¾",normalizedTitle:"2.3. å®ä¾",charIndex:2137},{level:4,title:"!img",slug:"img-https-pic2-zhimg-com-80-v2-3ae48cb81d39079022666ccb35821c71-hd-jpg",normalizedTitle:"!img",charIndex:null},{level:2,title:"3. Multi Paxos ææ³",slug:"_3-multi-paxos-ææ³",normalizedTitle:"3. multi paxos ææ³",charIndex:2826},{level:3,title:"3.1. Basic Paxos çé®é¢",slug:"_3-1-basic-paxos-çé®é¢",normalizedTitle:"3.1. basic paxos çé®é¢",charIndex:2848},{level:3,title:"3.2. Multi Paxos çæ¹è¿",slug:"_3-2-multi-paxos-çæ¹è¿",normalizedTitle:"3.2. multi paxos çæ¹è¿",charIndex:3053},{level:2,title:"4. æ»ç»",slug:"_4-æ»ç»",normalizedTitle:"4. æ»ç»",charIndex:3930},{level:2,title:"5. åèèµæ",slug:"_5-åèèµæ",normalizedTitle:"5. åèèµæ",charIndex:4193}],headersStr:"1. Paxos èæ¯ 2. Basic Paxos ç®æ³ 2.1. è§è² 2.2. ç®æ³ 2.3. å®ä¾ !img 3. Multi Paxos ææ³ 3.1. Basic Paxos çé®é¢ 3.2. Multi Paxos çæ¹è¿ 4. æ»ç» 5. åèèµæ",content:"# æ·±å¥åæå±è¯æ§ç®æ³ Paxos\n\n> Paxos æ¯ä¸ç§åºäºæ¶æ¯ä¼ éä¸å·æå®¹éæ§çå±è¯æ§ï¼consensusï¼ç®æ³ã\n> \n> Paxos ç®æ³è§£å³çé®é¢æ­£æ¯åå¸å¼ä¸è´æ§é®é¢ãå¨ä¸ä¸ªèç¹æ°ä¸º 2N+1 çåå¸å¼éç¾¤ä¸­ï¼åªè¦åæ°ä»¥ä¸çèç¹ï¼N + 1ï¼è¿æ­£å¸¸å·¥ä½ï¼æ´ä¸ªç³»ç»ä»å¯ä»¥æ­£å¸¸å·¥ä½ã\n\n\n\n\n# 1. Paxos èæ¯\n\nPaxos æ¯ Leslie Lamport äº 1990 å¹´æåºçä¸ç§åºäºæ¶æ¯ä¼ éä¸å·æé«åº¦å®¹éç¹æ§çå±è¯ï¼consensusï¼ç®æ³ã\n\nä¸ºæè¿° Paxos ç®æ³ï¼Lamport èæäºä¸ä¸ªå«å Paxos çå¸èåé¦ï¼è¿ä¸ªå²æç§è®®ä¼æ°ä¸»å¶çæ¿æ²»æ¨¡å¼å¶è®¢æ³å¾ï¼ä½æ¯æ²¡æäººæ¿æå°èªå·±çå¨é¨æ¶é´åç²¾åæ¾å¨è¿ç§äºæä¸ãæä»¥æ è®ºæ¯è®®åï¼è®®é¿æèä¼ éçº¸æ¡çæå¡åé½ä¸è½æ¿è¯ºå«äººéè¦æ¶ä¸å®ä¼åºç°ï¼ä¹æ æ³æ¿è¯ºæ¹åå³è®®æèä¼ éæ¶æ¯çæ¶é´ã\n\nPaxos ç®æ³åå« 2 ä¸ªé¨åï¼\n\n * Basic Paxos ç®æ³ï¼æè¿°çå¤èç¹ä¹é´å¦ä½å°±æä¸ªå¼è¾¾æå±è¯ã\n * Multi Paxos ææ³ï¼æè¿°çæ¯æ§è¡å¤ä¸ª Basic Paxos å®ä¾ï¼å°±ä¸ç³»åå¼è¾¾æå±è¯ã\n\nPaxos ç®æ³è§£å³çé®é¢æ­£æ¯åå¸å¼ä¸è´æ§é®é¢ï¼å³ä¸ä¸ªåå¸å¼ç³»ç»ä¸­çåä¸ªè¿ç¨å¦ä½å°±æä¸ªå¼ï¼å³è®®ï¼è¾¾æä¸è´ã\n\nPaxos ç®æ³è¿è¡å¨åè®¸å®æºæéçå¼æ­¥ç³»ç»ä¸­ï¼ä¸è¦æ±å¯é çæ¶æ¯ä¼ éï¼å¯å®¹å¿æ¶æ¯ä¸¢å¤±ãå»¶è¿ãä¹±åºä»¥åéå¤ãå®å©ç¨å¤§å¤æ° (Majority) æºå¶ä¿è¯äº 2N+1 çå®¹éè½åï¼å³ 2N+1 ä¸ªèç¹çç³»ç»æå¤åè®¸ N ä¸ªèç¹åæ¶åºç°æéã\n\n\n# 2. Basic Paxos ç®æ³\n\n\n# 2.1. è§è²\n\nPaxos å°åå¸å¼ç³»ç»ä¸­çèç¹åä¸ºä»¥ä¸è§è²ï¼\n\n * æè®®èï¼Proposerï¼ï¼ååºææ¡ï¼Proposalï¼ãProposal ä¿¡æ¯åæ¬ææ¡ç¼å· (Proposal ID) åæè®®çå¼ (Value)ã\n * å³ç­èï¼Acceptorï¼ï¼å¯¹æ¯ä¸ª Proposal è¿è¡æç¥¨ï¼è¥ Proposal è·å¾å¤æ° Acceptor çæ¥åï¼åç§°è¯¥ Proposal è¢«æ¹åã\n * å­¦ä¹ èï¼Learnerï¼ï¼ä¸åä¸å³ç­ï¼ä» Proposers/Acceptors å­¦ä¹ ãè®°å½ææ°è¾¾æå±è¯çææ¡ï¼Valueï¼ã\n\nå¨å¤å¯æ¬ç¶ææºä¸­ï¼æ¯ä¸ªå¯æ¬é½åæ¶å·æ ProposerãAcceptorãLearner ä¸ç§è§è²ã\n\n\n\n\n# 2.2. ç®æ³\n\nPaxos ç®æ³éè¿ä¸ä¸ªå³è®®åä¸ºä¸¤ä¸ªé¶æ®µï¼Learn é¶æ®µä¹åå³è®®å·²ç»å½¢æï¼ï¼\n\n 1. ç¬¬ä¸é¶æ®µï¼Prepare é¶æ®µãProposer å Acceptors ååº Prepare è¯·æ±ï¼Acceptors éå¯¹æ¶å°ç Prepare è¯·æ±è¿è¡ Promise æ¿è¯ºã\n 2. ç¬¬äºé¶æ®µï¼Accept é¶æ®µãProposer æ¶å°å¤æ° Acceptors æ¿è¯ºç Promise åï¼å Acceptors ååº Propose è¯·æ±ï¼Acceptors éå¯¹æ¶å°ç Propose è¯·æ±è¿è¡ Accept å¤çã\n 3. ç¬¬ä¸é¶æ®µï¼Learn é¶æ®µãProposer å¨æ¶å°å¤æ° Acceptors ç Accept ä¹åï¼æ å¿çæ¬æ¬¡ Accept æåï¼å³è®®å½¢æï¼å°å½¢æçå³è®®åéç»ææ Learnersã\n\nPaxos ç®æ³æµç¨ä¸­çæ¯æ¡æ¶æ¯æè¿°å¦ä¸ï¼\n\n * Prepare: Proposer çæå¨å±å¯ä¸ä¸éå¢ç Proposal ID (å¯ä½¿ç¨æ¶é´æ³å  Server ID)ï¼åææ Acceptors åé Prepare è¯·æ±ï¼è¿éæ éæºå¸¦ææ¡åå®¹ï¼åªæºå¸¦ Proposal ID å³å¯ã\n\n * Promise: Acceptors æ¶å° Prepare è¯·æ±åï¼ååºâä¸¤ä¸ªæ¿è¯ºï¼ä¸ä¸ªåºç­âã\n   \n   * ä¸¤ä¸ªæ¿è¯ºï¼\n     \n     * ä¸åæ¥å Proposal ID å°äºç­äºå½åè¯·æ±ç Prepare è¯·æ±ã\n     * ä¸åæ¥å Proposal ID å°äºå½åè¯·æ±ç Propose è¯·æ±ã\n   \n   * ä¸ä¸ªåºç­ï¼\n     \n     * ä¸è¿èä»¥åä½åºçæ¿è¯ºä¸ï¼åå¤å·²ç» Accept è¿çææ¡ä¸­ Proposal ID æå¤§çé£ä¸ªææ¡ç Value å Proposal IDï¼æ²¡æåè¿åç©ºå¼ã\n\n * Propose: Proposer æ¶å°å¤æ° Acceptors ç Promise åºç­åï¼ä»åºç­ä¸­éæ© Proposal ID æå¤§çææ¡ç Valueï¼ä½ä¸ºæ¬æ¬¡è¦åèµ·çææ¡ãå¦æææåºç­çææ¡ Value åä¸ºç©ºå¼ï¼åå¯ä»¥èªå·±éæå³å®ææ¡ Valueãç¶åæºå¸¦å½å Proposal IDï¼åææ Acceptors åé Propose è¯·æ±ã\n\n * Accept: Acceptor æ¶å° Propose è¯·æ±åï¼å¨ä¸è¿èèªå·±ä¹åä½åºçæ¿è¯ºä¸ï¼æ¥åå¹¶æä¹åå½å Proposal ID åææ¡ Valueã\n\n * Learn: Proposer æ¶å°å¤æ° Acceptors ç Accept åï¼å³è®®å½¢æï¼å°å½¢æçå³è®®åéç»ææ Learnersã\n\n\n# 2.3. å®ä¾\n\nä¸é¢ä¸¾å ä¸ªä¾å­ï¼å®ä¾ 1 å¦ä¸å¾ï¼\n\n\n\nå¾ä¸­ P ä»£è¡¨ Prepare é¶æ®µï¼A ä»£è¡¨ Accept é¶æ®µã3.1 ä»£è¡¨ Proposal ID ä¸º 3.1ï¼å¶ä¸­ 3 ä¸ºæ¶é´æ³ï¼1 ä¸º Server IDãX å Y ä»£è¡¨æè®® Valueã\n\nå®ä¾ 1 ä¸­ P 3.1 è¾¾æå¤æ°æ´¾ï¼å¶ Value(X) è¢« Acceptï¼ç¶å P 4.5 å­¦ä¹ å° Value(X)ï¼å¹¶ Acceptã\n\n#\n\nå®ä¾ 2 ä¸­ P 3.1 æ²¡æè¢«å¤æ°æ´¾ Acceptï¼åªæ S3 Acceptï¼ï¼ä½æ¯è¢« P 4.5 å­¦ä¹ å°ï¼P 4.5 å°èªå·±ç Value ç± Y æ¿æ¢ä¸º Xï¼Acceptï¼Xï¼ã\n\nPaxos ç®æ³å®ä¾ 3\n\nå®ä¾ 3 ä¸­ P 3.1 æ²¡æè¢«å¤æ°æ´¾ Acceptï¼åªæ S1 Acceptï¼ï¼åæ¶ä¹æ²¡æè¢« P 4.5 å­¦ä¹ å°ãç±äº P 4.5 Propose çææåºç­ï¼åæªè¿å Valueï¼å P 4.5 å¯ä»¥ Accept èªå·±ç Value (Y)ãåç»­ P 3.1 ç Accept (X) ä¼å¤±è´¥ï¼å·²ç» Accept ç S1ï¼ä¼è¢«è¦çã\n\nPaxos ç®æ³å¯è½å½¢ææ´»éèæ°¸è¿ä¸ä¼ç»æï¼å¦ä¸å¾å®ä¾æç¤ºï¼\n\nPaxos ç®æ³å½¢ææ´»é\n\nåé¡¾ä¸¤ä¸ªæ¿è¯ºä¹ä¸ï¼Acceptor ä¸ååºç­ Proposal ID å°äºç­äºå½åè¯·æ±ç Prepare è¯·æ±ãæå³çéè¦åºç­ Proposal ID å¤§äºå½åè¯·æ±ç Prepare è¯·æ±ã\n\nä¸¤ä¸ª Proposers äº¤æ¿ Prepare æåï¼è Accept å¤±è´¥ï¼å½¢ææ´»éï¼Livelockï¼ã\n\n\n# 3. Multi Paxos ææ³\n\n\n# 3.1. Basic Paxos çé®é¢\n\nBasic Paxos æä»¥ä¸é®é¢ï¼å¯¼è´å®ä¸è½åºç¨äºå®éï¼\n\n * Basic Paxos ç®æ³åªè½å¯¹ä¸ä¸ªå¼å½¢æå³è®®ã\n * Basic Paxos ç®æ³ä¼æ¶èå¤§éç½ç»å¸¦å®½ãBasic Paxos ä¸­ï¼å³è®®çå½¢æè³å°éè¦ä¸¤æ¬¡ç½ç»éä¿¡ï¼å¨é«å¹¶åæåµä¸å¯è½éè¦æ´å¤çç½ç»éä¿¡ï¼æç«¯æåµä¸çè³å¯è½å½¢ææ´»éãå¦ææ³è¿ç»­ç¡®å®å¤ä¸ªå¼ï¼Basic Paxos æä¸å®äºã\n\n\n# 3.2. Multi Paxos çæ¹è¿\n\nMulti Paxos æ­£æ¯ä¸ºè§£å³ä»¥ä¸é®é¢èæåºãMulti Paxos åºäº Basic Paxos åäºä¸¤ç¹æ¹è¿ï¼\n\n * éå¯¹æ¯ä¸ä¸ªè¦ç¡®å®çå¼ï¼è¿è¡ä¸æ¬¡ Paxos ç®æ³å®ä¾ï¼Instanceï¼ï¼å½¢æå³è®®ãæ¯ä¸ä¸ª Paxos å®ä¾ä½¿ç¨å¯ä¸ç Instance ID æ è¯ã\n * å¨ææ Proposer ä¸­éä¸¾ä¸ä¸ª Leaderï¼ç± Leader å¯ä¸å°æäº¤ Proposal ç» Acceptor è¿è¡è¡¨å³ãè¿æ ·æ²¡æ Proposer ç«äºï¼è§£å³äºæ´»éé®é¢ãå¨ç³»ç»ä¸­ä»æä¸ä¸ª Leader è¿è¡ Value æäº¤çæåµä¸ï¼Prepare é¶æ®µå°±å¯ä»¥è·³è¿ï¼ä»èå°ä¸¤é¶æ®µåä¸ºä¸é¶æ®µï¼æé«æçã\n\nMulti Paxos é¦åéè¦éä¸¾ Leaderï¼Leader çç¡®å®ä¹æ¯ä¸æ¬¡å³è®®çå½¢æï¼æä»¥å¯æ§è¡ä¸æ¬¡ Basic Paxos å®ä¾æ¥éä¸¾åºä¸ä¸ª Leaderãéåº Leader ä¹ååªè½ç± Leader æäº¤ Proposalï¼å¨ Leader å®æºä¹åæå¡ä¸´æ¶ä¸å¯ç¨ï¼éè¦éæ°éä¸¾ Leader ç»§ç»­æå¡ãå¨ç³»ç»ä¸­ä»æä¸ä¸ª Leader è¿è¡ Proposal æäº¤çæåµä¸ï¼Prepare é¶æ®µå¯ä»¥è·³è¿ã\n\nMulti Paxos éè¿æ¹å Prepare é¶æ®µçä½ç¨èå´è³åé¢ Leader æäº¤çææå®ä¾ï¼ä»èä½¿å¾ Leader çè¿ç»­æäº¤åªéè¦æ§è¡ä¸æ¬¡ Prepare é¶æ®µï¼åç»­åªéè¦æ§è¡ Accept é¶æ®µï¼å°ä¸¤é¶æ®µåä¸ºä¸é¶æ®µï¼æé«äºæçãä¸ºäºåºåè¿ç»­æäº¤çå¤ä¸ªå®ä¾ï¼æ¯ä¸ªå®ä¾ä½¿ç¨ä¸ä¸ª Instance ID æ è¯ï¼Instance ID ç± Leader æ¬å°éå¢çæå³å¯ã\n\nMulti Paxos åè®¸æå¤ä¸ªèªè®¤ä¸ºæ¯ Leader çèç¹å¹¶åæäº¤ Proposal èä¸å½±åå¶å®å¨æ§ï¼è¿æ ·çåºæ¯å³éåä¸º Basic Paxosã\n\nChubby å Boxwood åä½¿ç¨ Multi PaxosãZooKeeper ä½¿ç¨ç Zab ä¹æ¯ Multi Paxos çåå½¢ã\n\n\n# 4. æ»ç»\n\nä½ å¯ä»¥çå°ï¼Basic Paxos æ¯éè¿äºé¶æ®µæäº¤çæ¹å¼æ¥è¾¾æå±è¯çãäºé¶æ®µæäº¤æ¯è¾¾æå±è¯çå¸¸ç¨æ¹å¼ï¼å¦æä½ éè¦è®¾è®¡æ°çå±è¯ç®æ³çæ¶åï¼ä¹å¯ä»¥èèè¿ä¸ªæ¹å¼ã\n\né¤äºå±è¯ï¼Basic Paxos è¿å®ç°äºå®¹éï¼å¨å°äºä¸åçèç¹åºç°æéæ¶ï¼éç¾¤ä¹è½å·¥ä½ãå®ä¸ååå¸å¼äºå¡ç®æ³é£æ ·ï¼å¿é¡»è¦ææèç¹é½åæåææäº¤æä½ï¼å ä¸ºâææèç¹é½åæâè¿ä¸ªååï¼å¨åºç°èç¹æéçæ¶åä¼å¯¼è´æ´ä¸ªéç¾¤ä¸å¯ç¨ãä¹å°±æ¯è¯´ï¼âå¤§å¤æ°èç¹é½åæâçååï¼èµäºäº Basic Paxos å®¹éçè½åï¼è®©å®è½å¤å®¹å¿å°äºä¸åçèç¹çæéã\n\n\n# 5. åèèµæ\n\n * Part-time Parliament è®ºæ\n * Paxos Made Simple è®ºæ\n * Paxos ç®æ³è¯¦è§£\n * Wiki - Paxos ç®æ³\n * ä¸è´æ§ç®æ³ï¼PaxosãRaftãZabï¼\n * Raft ä½èè®²è§£ Paxos è§é¢\n * Paxos ç®æ³è®²è§£è§é¢",normalizedContent:"# æ·±å¥åæå±è¯æ§ç®æ³ paxos\n\n> paxos æ¯ä¸ç§åºäºæ¶æ¯ä¼ éä¸å·æå®¹éæ§çå±è¯æ§ï¼consensusï¼ç®æ³ã\n> \n> paxos ç®æ³è§£å³çé®é¢æ­£æ¯åå¸å¼ä¸è´æ§é®é¢ãå¨ä¸ä¸ªèç¹æ°ä¸º 2n+1 çåå¸å¼éç¾¤ä¸­ï¼åªè¦åæ°ä»¥ä¸çèç¹ï¼n + 1ï¼è¿æ­£å¸¸å·¥ä½ï¼æ´ä¸ªç³»ç»ä»å¯ä»¥æ­£å¸¸å·¥ä½ã\n\n\n\n\n# 1. paxos èæ¯\n\npaxos æ¯ leslie lamport äº 1990 å¹´æåºçä¸ç§åºäºæ¶æ¯ä¼ éä¸å·æé«åº¦å®¹éç¹æ§çå±è¯ï¼consensusï¼ç®æ³ã\n\nä¸ºæè¿° paxos ç®æ³ï¼lamport èæäºä¸ä¸ªå«å paxos çå¸èåé¦ï¼è¿ä¸ªå²æç§è®®ä¼æ°ä¸»å¶çæ¿æ²»æ¨¡å¼å¶è®¢æ³å¾ï¼ä½æ¯æ²¡æäººæ¿æå°èªå·±çå¨é¨æ¶é´åç²¾åæ¾å¨è¿ç§äºæä¸ãæä»¥æ è®ºæ¯è®®åï¼è®®é¿æèä¼ éçº¸æ¡çæå¡åé½ä¸è½æ¿è¯ºå«äººéè¦æ¶ä¸å®ä¼åºç°ï¼ä¹æ æ³æ¿è¯ºæ¹åå³è®®æèä¼ éæ¶æ¯çæ¶é´ã\n\npaxos ç®æ³åå« 2 ä¸ªé¨åï¼\n\n * basic paxos ç®æ³ï¼æè¿°çå¤èç¹ä¹é´å¦ä½å°±æä¸ªå¼è¾¾æå±è¯ã\n * multi paxos ææ³ï¼æè¿°çæ¯æ§è¡å¤ä¸ª basic paxos å®ä¾ï¼å°±ä¸ç³»åå¼è¾¾æå±è¯ã\n\npaxos ç®æ³è§£å³çé®é¢æ­£æ¯åå¸å¼ä¸è´æ§é®é¢ï¼å³ä¸ä¸ªåå¸å¼ç³»ç»ä¸­çåä¸ªè¿ç¨å¦ä½å°±æä¸ªå¼ï¼å³è®®ï¼è¾¾æä¸è´ã\n\npaxos ç®æ³è¿è¡å¨åè®¸å®æºæéçå¼æ­¥ç³»ç»ä¸­ï¼ä¸è¦æ±å¯é çæ¶æ¯ä¼ éï¼å¯å®¹å¿æ¶æ¯ä¸¢å¤±ãå»¶è¿ãä¹±åºä»¥åéå¤ãå®å©ç¨å¤§å¤æ° (majority) æºå¶ä¿è¯äº 2n+1 çå®¹éè½åï¼å³ 2n+1 ä¸ªèç¹çç³»ç»æå¤åè®¸ n ä¸ªèç¹åæ¶åºç°æéã\n\n\n# 2. basic paxos ç®æ³\n\n\n# 2.1. è§è²\n\npaxos å°åå¸å¼ç³»ç»ä¸­çèç¹åä¸ºä»¥ä¸è§è²ï¼\n\n * æè®®èï¼proposerï¼ï¼ååºææ¡ï¼proposalï¼ãproposal ä¿¡æ¯åæ¬ææ¡ç¼å· (proposal id) åæè®®çå¼ (value)ã\n * å³ç­èï¼acceptorï¼ï¼å¯¹æ¯ä¸ª proposal è¿è¡æç¥¨ï¼è¥ proposal è·å¾å¤æ° acceptor çæ¥åï¼åç§°è¯¥ proposal è¢«æ¹åã\n * å­¦ä¹ èï¼learnerï¼ï¼ä¸åä¸å³ç­ï¼ä» proposers/acceptors å­¦ä¹ ãè®°å½ææ°è¾¾æå±è¯çææ¡ï¼valueï¼ã\n\nå¨å¤å¯æ¬ç¶ææºä¸­ï¼æ¯ä¸ªå¯æ¬é½åæ¶å·æ proposerãacceptorãlearner ä¸ç§è§è²ã\n\n\n\n\n# 2.2. ç®æ³\n\npaxos ç®æ³éè¿ä¸ä¸ªå³è®®åä¸ºä¸¤ä¸ªé¶æ®µï¼learn é¶æ®µä¹åå³è®®å·²ç»å½¢æï¼ï¼\n\n 1. ç¬¬ä¸é¶æ®µï¼prepare é¶æ®µãproposer å acceptors ååº prepare è¯·æ±ï¼acceptors éå¯¹æ¶å°ç prepare è¯·æ±è¿è¡ promise æ¿è¯ºã\n 2. ç¬¬äºé¶æ®µï¼accept é¶æ®µãproposer æ¶å°å¤æ° acceptors æ¿è¯ºç promise åï¼å acceptors ååº propose è¯·æ±ï¼acceptors éå¯¹æ¶å°ç propose è¯·æ±è¿è¡ accept å¤çã\n 3. ç¬¬ä¸é¶æ®µï¼learn é¶æ®µãproposer å¨æ¶å°å¤æ° acceptors ç accept ä¹åï¼æ å¿çæ¬æ¬¡ accept æåï¼å³è®®å½¢æï¼å°å½¢æçå³è®®åéç»ææ learnersã\n\npaxos ç®æ³æµç¨ä¸­çæ¯æ¡æ¶æ¯æè¿°å¦ä¸ï¼\n\n * prepare: proposer çæå¨å±å¯ä¸ä¸éå¢ç proposal id (å¯ä½¿ç¨æ¶é´æ³å  server id)ï¼åææ acceptors åé prepare è¯·æ±ï¼è¿éæ éæºå¸¦ææ¡åå®¹ï¼åªæºå¸¦ proposal id å³å¯ã\n\n * promise: acceptors æ¶å° prepare è¯·æ±åï¼ååºâä¸¤ä¸ªæ¿è¯ºï¼ä¸ä¸ªåºç­âã\n   \n   * ä¸¤ä¸ªæ¿è¯ºï¼\n     \n     * ä¸åæ¥å proposal id å°äºç­äºå½åè¯·æ±ç prepare è¯·æ±ã\n     * ä¸åæ¥å proposal id å°äºå½åè¯·æ±ç propose è¯·æ±ã\n   \n   * ä¸ä¸ªåºç­ï¼\n     \n     * ä¸è¿èä»¥åä½åºçæ¿è¯ºä¸ï¼åå¤å·²ç» accept è¿çææ¡ä¸­ proposal id æå¤§çé£ä¸ªææ¡ç value å proposal idï¼æ²¡æåè¿åç©ºå¼ã\n\n * propose: proposer æ¶å°å¤æ° acceptors ç promise åºç­åï¼ä»åºç­ä¸­éæ© proposal id æå¤§çææ¡ç valueï¼ä½ä¸ºæ¬æ¬¡è¦åèµ·çææ¡ãå¦æææåºç­çææ¡ value åä¸ºç©ºå¼ï¼åå¯ä»¥èªå·±éæå³å®ææ¡ valueãç¶åæºå¸¦å½å proposal idï¼åææ acceptors åé propose è¯·æ±ã\n\n * accept: acceptor æ¶å° propose è¯·æ±åï¼å¨ä¸è¿èèªå·±ä¹åä½åºçæ¿è¯ºä¸ï¼æ¥åå¹¶æä¹åå½å proposal id åææ¡ valueã\n\n * learn: proposer æ¶å°å¤æ° acceptors ç accept åï¼å³è®®å½¢æï¼å°å½¢æçå³è®®åéç»ææ learnersã\n\n\n# 2.3. å®ä¾\n\nä¸é¢ä¸¾å ä¸ªä¾å­ï¼å®ä¾ 1 å¦ä¸å¾ï¼\n\n\n\nå¾ä¸­ p ä»£è¡¨ prepare é¶æ®µï¼a ä»£è¡¨ accept é¶æ®µã3.1 ä»£è¡¨ proposal id ä¸º 3.1ï¼å¶ä¸­ 3 ä¸ºæ¶é´æ³ï¼1 ä¸º server idãx å y ä»£è¡¨æè®® valueã\n\nå®ä¾ 1 ä¸­ p 3.1 è¾¾æå¤æ°æ´¾ï¼å¶ value(x) è¢« acceptï¼ç¶å p 4.5 å­¦ä¹ å° value(x)ï¼å¹¶ acceptã\n\n#\n\nå®ä¾ 2 ä¸­ p 3.1 æ²¡æè¢«å¤æ°æ´¾ acceptï¼åªæ s3 acceptï¼ï¼ä½æ¯è¢« p 4.5 å­¦ä¹ å°ï¼p 4.5 å°èªå·±ç value ç± y æ¿æ¢ä¸º xï¼acceptï¼xï¼ã\n\npaxos ç®æ³å®ä¾ 3\n\nå®ä¾ 3 ä¸­ p 3.1 æ²¡æè¢«å¤æ°æ´¾ acceptï¼åªæ s1 acceptï¼ï¼åæ¶ä¹æ²¡æè¢« p 4.5 å­¦ä¹ å°ãç±äº p 4.5 propose çææåºç­ï¼åæªè¿å valueï¼å p 4.5 å¯ä»¥ accept èªå·±ç value (y)ãåç»­ p 3.1 ç accept (x) ä¼å¤±è´¥ï¼å·²ç» accept ç s1ï¼ä¼è¢«è¦çã\n\npaxos ç®æ³å¯è½å½¢ææ´»éèæ°¸è¿ä¸ä¼ç»æï¼å¦ä¸å¾å®ä¾æç¤ºï¼\n\npaxos ç®æ³å½¢ææ´»é\n\nåé¡¾ä¸¤ä¸ªæ¿è¯ºä¹ä¸ï¼acceptor ä¸ååºç­ proposal id å°äºç­äºå½åè¯·æ±ç prepare è¯·æ±ãæå³çéè¦åºç­ proposal id å¤§äºå½åè¯·æ±ç prepare è¯·æ±ã\n\nä¸¤ä¸ª proposers äº¤æ¿ prepare æåï¼è accept å¤±è´¥ï¼å½¢ææ´»éï¼livelockï¼ã\n\n\n# 3. multi paxos ææ³\n\n\n# 3.1. basic paxos çé®é¢\n\nbasic paxos æä»¥ä¸é®é¢ï¼å¯¼è´å®ä¸è½åºç¨äºå®éï¼\n\n * basic paxos ç®æ³åªè½å¯¹ä¸ä¸ªå¼å½¢æå³è®®ã\n * basic paxos ç®æ³ä¼æ¶èå¤§éç½ç»å¸¦å®½ãbasic paxos ä¸­ï¼å³è®®çå½¢æè³å°éè¦ä¸¤æ¬¡ç½ç»éä¿¡ï¼å¨é«å¹¶åæåµä¸å¯è½éè¦æ´å¤çç½ç»éä¿¡ï¼æç«¯æåµä¸çè³å¯è½å½¢ææ´»éãå¦ææ³è¿ç»­ç¡®å®å¤ä¸ªå¼ï¼basic paxos æä¸å®äºã\n\n\n# 3.2. multi paxos çæ¹è¿\n\nmulti paxos æ­£æ¯ä¸ºè§£å³ä»¥ä¸é®é¢èæåºãmulti paxos åºäº basic paxos åäºä¸¤ç¹æ¹è¿ï¼\n\n * éå¯¹æ¯ä¸ä¸ªè¦ç¡®å®çå¼ï¼è¿è¡ä¸æ¬¡ paxos ç®æ³å®ä¾ï¼instanceï¼ï¼å½¢æå³è®®ãæ¯ä¸ä¸ª paxos å®ä¾ä½¿ç¨å¯ä¸ç instance id æ è¯ã\n * å¨ææ proposer ä¸­éä¸¾ä¸ä¸ª leaderï¼ç± leader å¯ä¸å°æäº¤ proposal ç» acceptor è¿è¡è¡¨å³ãè¿æ ·æ²¡æ proposer ç«äºï¼è§£å³äºæ´»éé®é¢ãå¨ç³»ç»ä¸­ä»æä¸ä¸ª leader è¿è¡ value æäº¤çæåµä¸ï¼prepare é¶æ®µå°±å¯ä»¥è·³è¿ï¼ä»èå°ä¸¤é¶æ®µåä¸ºä¸é¶æ®µï¼æé«æçã\n\nmulti paxos é¦åéè¦éä¸¾ leaderï¼leader çç¡®å®ä¹æ¯ä¸æ¬¡å³è®®çå½¢æï¼æä»¥å¯æ§è¡ä¸æ¬¡ basic paxos å®ä¾æ¥éä¸¾åºä¸ä¸ª leaderãéåº leader ä¹ååªè½ç± leader æäº¤ proposalï¼å¨ leader å®æºä¹åæå¡ä¸´æ¶ä¸å¯ç¨ï¼éè¦éæ°éä¸¾ leader ç»§ç»­æå¡ãå¨ç³»ç»ä¸­ä»æä¸ä¸ª leader è¿è¡ proposal æäº¤çæåµä¸ï¼prepare é¶æ®µå¯ä»¥è·³è¿ã\n\nmulti paxos éè¿æ¹å prepare é¶æ®µçä½ç¨èå´è³åé¢ leader æäº¤çææå®ä¾ï¼ä»èä½¿å¾ leader çè¿ç»­æäº¤åªéè¦æ§è¡ä¸æ¬¡ prepare é¶æ®µï¼åç»­åªéè¦æ§è¡ accept é¶æ®µï¼å°ä¸¤é¶æ®µåä¸ºä¸é¶æ®µï¼æé«äºæçãä¸ºäºåºåè¿ç»­æäº¤çå¤ä¸ªå®ä¾ï¼æ¯ä¸ªå®ä¾ä½¿ç¨ä¸ä¸ª instance id æ è¯ï¼instance id ç± leader æ¬å°éå¢çæå³å¯ã\n\nmulti paxos åè®¸æå¤ä¸ªèªè®¤ä¸ºæ¯ leader çèç¹å¹¶åæäº¤ proposal èä¸å½±åå¶å®å¨æ§ï¼è¿æ ·çåºæ¯å³éåä¸º basic paxosã\n\nchubby å boxwood åä½¿ç¨ multi paxosãzookeeper ä½¿ç¨ç zab ä¹æ¯ multi paxos çåå½¢ã\n\n\n# 4. æ»ç»\n\nä½ å¯ä»¥çå°ï¼basic paxos æ¯éè¿äºé¶æ®µæäº¤çæ¹å¼æ¥è¾¾æå±è¯çãäºé¶æ®µæäº¤æ¯è¾¾æå±è¯çå¸¸ç¨æ¹å¼ï¼å¦æä½ éè¦è®¾è®¡æ°çå±è¯ç®æ³çæ¶åï¼ä¹å¯ä»¥èèè¿ä¸ªæ¹å¼ã\n\né¤äºå±è¯ï¼basic paxos è¿å®ç°äºå®¹éï¼å¨å°äºä¸åçèç¹åºç°æéæ¶ï¼éç¾¤ä¹è½å·¥ä½ãå®ä¸ååå¸å¼äºå¡ç®æ³é£æ ·ï¼å¿é¡»è¦ææèç¹é½åæåææäº¤æä½ï¼å ä¸ºâææèç¹é½åæâè¿ä¸ªååï¼å¨åºç°èç¹æéçæ¶åä¼å¯¼è´æ´ä¸ªéç¾¤ä¸å¯ç¨ãä¹å°±æ¯è¯´ï¼âå¤§å¤æ°èç¹é½åæâçååï¼èµäºäº basic paxos å®¹éçè½åï¼è®©å®è½å¤å®¹å¿å°äºä¸åçèç¹çæéã\n\n\n# 5. åèèµæ\n\n * part-time parliament è®ºæ\n * paxos made simple è®ºæ\n * paxos ç®æ³è¯¦è§£\n * wiki - paxos ç®æ³\n * ä¸è´æ§ç®æ³ï¼paxosãraftãzabï¼\n * raft ä½èè®²è§£ paxos è§é¢\n * paxos ç®æ³è®²è§£è§é¢",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ·±å¥åæå±è¯æ§ç®æ³ Raft",frontmatter:{title:"æ·±å¥åæå±è¯æ§ç®æ³ Raft",categories:["åå¸å¼","åå¸å¼çè®º"],tags:["åå¸å¼","åå¸å¼çè®º","å±è¯æ§","Raft"],abbrlink:"5f26a66c",date:"2020-02-01T22:07:00.000Z",permalink:"/pages/e40812/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/02.%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA/03.%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95Raft.html",relativePath:"02.åå¸å¼/02.åå¸å¼çè®º/03.åå¸å¼ç®æ³Raft.md",key:"v-67c5593b",path:"/pages/e40812/",headers:[{level:2,title:"1. Raft ç®ä»",slug:"_1-raft-ç®ä»",normalizedTitle:"1. raft ç®ä»",charIndex:23},{level:3,title:"1.1. åå¸å¼ä¸è´æ§",slug:"_1-1-åå¸å¼ä¸è´æ§",normalizedTitle:"1.1. åå¸å¼ä¸è´æ§",charIndex:392},{level:3,title:"1.2. å¤å¶ç¶ææº",slug:"_1-2-å¤å¶ç¶ææº",normalizedTitle:"1.2. å¤å¶ç¶ææº",charIndex:728},{level:3,title:"1.3. RAFT åºç¨",slug:"_1-3-raft-åºç¨",normalizedTitle:"1.3. raft åºç¨",charIndex:1523},{level:2,title:"2. Raft åºç¡",slug:"_2-raft-åºç¡",normalizedTitle:"2. raft åºç¡",charIndex:1768},{level:3,title:"2.1. æå¡å¨è§è²",slug:"_2-1-æå¡å¨è§è²",normalizedTitle:"2.1. æå¡å¨è§è²",charIndex:1876},{level:3,title:"2.2. ä»»æ",slug:"_2-2-ä»»æ",normalizedTitle:"2.2. ä»»æ",charIndex:2346},{level:3,title:"2.3. RPC",slug:"_2-3-rpc",normalizedTitle:"2.3. rpc",charIndex:2832},{level:2,title:"3. éä¸¾ Leader",slug:"_3-éä¸¾-leader",normalizedTitle:"3. éä¸¾ leader",charIndex:3013},{level:3,title:"3.1. éä¸¾è§å",slug:"_3-1-éä¸¾è§å",normalizedTitle:"3.1. éä¸¾è§å",charIndex:3030},{level:4,title:"èªå·±æä¸º Leader",slug:"èªå·±æä¸º-leader",normalizedTitle:"èªå·±æä¸º leader",charIndex:3375},{level:4,title:"å¶ä»çæå¡å¨æä¸º Leader",slug:"å¶ä»çæå¡å¨æä¸º-leader",normalizedTitle:"å¶ä»çæå¡å¨æä¸º leader",charIndex:3390},{level:4,title:"æ²¡æä»»ä½æå¡å¨æä¸º Leader",slug:"æ²¡æä»»ä½æå¡å¨æä¸º-leader",normalizedTitle:"æ²¡æä»»ä½æå¡å¨æä¸º leader",charIndex:3409},{level:3,title:"3.2. å Candidate éä¸¾",slug:"_3-2-å-candidate-éä¸¾",normalizedTitle:"3.2. å candidate éä¸¾",charIndex:4447},{level:3,title:"3.3. å¤ Candidate éä¸¾",slug:"_3-3-å¤-candidate-éä¸¾",normalizedTitle:"3.3. å¤ candidate éä¸¾",charIndex:4770},{level:2,title:"4. æ¥å¿å¤å¶",slug:"_4-æ¥å¿å¤å¶",normalizedTitle:"4. æ¥å¿å¤å¶",charIndex:4990},{level:3,title:"4.1. æ¥å¿æ ¼å¼",slug:"_4-1-æ¥å¿æ ¼å¼",normalizedTitle:"4.1. æ¥å¿æ ¼å¼",charIndex:5002},{level:3,title:"4.2. æ¥å¿å¤å¶æµç¨",slug:"_4-2-æ¥å¿å¤å¶æµç¨",normalizedTitle:"4.2. æ¥å¿å¤å¶æµç¨",charIndex:5577},{level:3,title:"4.3. æ¥å¿ä¸è´æ§",slug:"_4-3-æ¥å¿ä¸è´æ§",normalizedTitle:"4.3. æ¥å¿ä¸è´æ§",charIndex:6102},{level:4,title:"Leader å Follower æ¥å¿ä¸ä¸è´çå¯è½",slug:"leader-å-follower-æ¥å¿ä¸ä¸è´çå¯è½",normalizedTitle:"leader å follower æ¥å¿ä¸ä¸è´çå¯è½",charIndex:6220},{level:4,title:"Leader å Follower æ¥å¿ä¸è´çä¿è¯",slug:"leader-å-follower-æ¥å¿ä¸è´çä¿è¯",normalizedTitle:"leader å follower æ¥å¿ä¸è´çä¿è¯",charIndex:6673},{level:2,title:"5. å®å¨æ§",slug:"_5-å®å¨æ§",normalizedTitle:"5. å®å¨æ§",charIndex:6963},{level:3,title:"5.1. éä¸¾éå¶",slug:"_5-1-éä¸¾éå¶",normalizedTitle:"5.1. éä¸¾éå¶",charIndex:7091},{level:3,title:"5.2. æäº¤æ§ä»»æçæ¥å¿æ¡ç®",slug:"_5-2-æäº¤æ§ä»»æçæ¥å¿æ¡ç®",normalizedTitle:"5.2. æäº¤æ§ä»»æçæ¥å¿æ¡ç®",charIndex:7570},{level:2,title:"6. æ¥å¿åç¼©",slug:"_6-æ¥å¿åç¼©",normalizedTitle:"6. æ¥å¿åç¼©",charIndex:8536},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:9048}],headersStr:"1. Raft ç®ä» 1.1. åå¸å¼ä¸è´æ§ 1.2. å¤å¶ç¶ææº 1.3. RAFT åºç¨ 2. Raft åºç¡ 2.1. æå¡å¨è§è² 2.2. ä»»æ 2.3. RPC 3. éä¸¾ Leader 3.1. éä¸¾è§å èªå·±æä¸º Leader å¶ä»çæå¡å¨æä¸º Leader æ²¡æä»»ä½æå¡å¨æä¸º Leader 3.2. å Candidate éä¸¾ 3.3. å¤ Candidate éä¸¾ 4. æ¥å¿å¤å¶ 4.1. æ¥å¿æ ¼å¼ 4.2. æ¥å¿å¤å¶æµç¨ 4.3. æ¥å¿ä¸è´æ§ Leader å Follower æ¥å¿ä¸ä¸è´çå¯è½ Leader å Follower æ¥å¿ä¸è´çä¿è¯ 5. å®å¨æ§ 5.1. éä¸¾éå¶ 5.2. æäº¤æ§ä»»æçæ¥å¿æ¡ç® 6. æ¥å¿åç¼© 7. åèèµæ",content:"# æ·±å¥åæå±è¯æ§ç®æ³ Raft\n\n\n\n\n# 1. Raft ç®ä»\n\nRaft æ¯ä¸ç§ä¸ºäºç®¡çæ¥å¿å¤å¶çåå¸å¼ä¸è´æ§ç®æ³ã\n\nRaft åºç°ä¹åï¼Paxos ä¸ç´æ¯åå¸å¼ä¸è´æ§ç®æ³çæ åãPaxos é¾ä»¥çè§£ï¼æ´é¾ä»¥å®ç°ãRaft çè®¾è®¡ç®æ æ¯ç®å Paxosï¼ä½¿å¾ç®æ³æ¢å®¹æçè§£ï¼ä¹å®¹æå®ç°ã\n\nPaxos å Raft é½æ¯åå¸å¼ä¸è´æ§ç®æ³ï¼è¿ä¸ªè¿ç¨å¦åæç¥¨éä¸¾é¢è¢ï¼Leaderï¼ï¼åéèï¼Candidateï¼éè¦è¯´æå¤§å¤æ°æç¥¨èï¼Followerï¼æç¥¨ç»ä»ï¼ä¸æ¦éä¸¾åºé¢è¢ï¼å°±ç±é¢è¢åå·æ½ä»¤ãPaxos å Raft çåºå«å¨äºéä¸¾çå·ä½è¿ç¨ä¸åã\n\nRaft å¯ä»¥è§£å³åå¸å¼ CAP çè®ºä¸­ç CPï¼å³ ä¸è´æ§ï¼Cï¼Consistencyï¼ å ååºå®¹å¿æ§ï¼Pï¼Partition Toleranceï¼ï¼å¹¶ä¸è½è§£å³ å¯ç¨æ§ï¼Aï¼Availabilityï¼ çé®é¢ã\n\n\n# 1.1. åå¸å¼ä¸è´æ§\n\nåå¸å¼ä¸è´æ§ (distributed consensus) æ¯åå¸å¼ç³»ç»ä¸­æåºæ¬çé®é¢ï¼ç¨æ¥ä¿è¯ä¸ä¸ªåå¸å¼ç³»ç»çå¯é æ§ä»¥åå®¹éè½åãç®åæ¥è¯´ï¼åå¸å¼ä¸è´æ§æ¯æå¤ä¸ªæå¡å¨çä¿æç¶æä¸è´ã\n\nå¨åå¸å¼ç³»ç»ä¸­ï¼å¯è½åºç°åç§æå¤ï¼æ­çµãç½ç»æ¥å¡ãCPU/åå­èå°½ç­ç­ï¼ï¼ä½¿å¾æå¡å¨å®æºææ æ³è®¿é®ï¼æç»å¯¼è´æ æ³åå¶ä»æå¡å¨ä¿æç¶æä¸è´ãä¸ºäºåºå¯¹è¿ç§æåµï¼å°±éè¦æä¸ç§ä¸è´æ§åè®®æ¥è¿è¡å®¹éï¼ä½¿å¾åå¸å¼ç³»ç»ä¸­å³ä½¿æé¨åæå¡å¨å®æºææ æ³è®¿é®ï¼æ´ä½ä¾ç¶å¯ä»¥å¯¹å¤æä¾æå¡ã\n\nä»¥å®¹éæ¹å¼è¾¾æä¸è´ï¼èªç¶ä¸è½è¦æ±æææå¡å¨é½è¾¾æä¸è´ç¶æï¼åªè¦è¶è¿åæ°ä»¥ä¸çæå¡å¨è¾¾æä¸è´å°±å¯ä»¥äºãåè®¾æ N å°æå¡å¨ï¼ å¤§äºç­äº N/2 + 1 å°æå¡å¨å°±ç®æ¯åæ°ä»¥ä¸äº ã\n\n\n# 1.2. å¤å¶ç¶ææº\n\nå¤å¶ç¶ææºï¼Replicated State Machinesï¼ æ¯æä¸ç»æå¡å¨ä¸çç¶ææºäº§çç¸åç¶æçå¯æ¬ï¼å¹¶ä¸å¨ä¸äºæºå¨å®æçæåµä¸ä¹å¯ä»¥ç»§ç»­è¿è¡ãä¸è´æ§ç®æ³ç®¡ççæ¥èªå®¢æ·ç«¯æä»¤çå¤å¶æ¥å¿ãç¶ææºä»æ¥å¿ä¸­å¤çç¸åé¡ºåºçç¸åæä»¤ï¼æä»¥äº§ççç»æä¹æ¯ç¸åçã\n\n\n\nå¤å¶ç¶ææºéå¸¸é½æ¯åºäºå¤å¶æ¥å¿å®ç°çï¼å¦ä¸å¾ãæ¯ä¸ä¸ªæå¡å¨å­å¨ä¸ä¸ªåå«ä¸ç³»åæä»¤çæ¥å¿ï¼å¹¶ä¸æç§æ¥å¿çé¡ºåºè¿è¡æ§è¡ãæ¯ä¸ä¸ªæ¥å¿é½æç§ç¸åçé¡ºåºåå«ç¸åçæä»¤ï¼æä»¥æ¯ä¸ä¸ªæå¡å¨é½æ§è¡ç¸åçæä»¤åºåãå ä¸ºæ¯ä¸ªç¶ææºé½æ¯ç¡®å®çï¼æ¯ä¸æ¬¡æ§è¡æä½é½äº§çç¸åçç¶æååæ ·çåºåã\n\nä¿è¯å¤å¶æ¥å¿ç¸åå°±æ¯ä¸è´æ§ç®æ³çå·¥ä½äºãå¨ä¸å°æå¡å¨ä¸ï¼ä¸è´æ§æ¨¡åæ¥æ¶å®¢æ·ç«¯åéæ¥çæä»¤ç¶åå¢å å°èªå·±çæ¥å¿ä¸­å»ãå®åå¶ä»æå¡å¨ä¸çä¸è´æ§æ¨¡åè¿è¡éä¿¡æ¥ä¿è¯æ¯ä¸ä¸ªæå¡å¨ä¸çæ¥å¿æç»é½ä»¥ç¸åçé¡ºåºåå«ç¸åçè¯·æ±ï¼å°½ç®¡æäºæå¡å¨ä¼å®æºãä¸æ¦æä»¤è¢«æ­£ç¡®çå¤å¶ï¼æ¯ä¸ä¸ªæå¡å¨çç¶ææºæç§æ¥å¿é¡ºåºå¤çä»ä»¬ï¼ç¶åè¾åºç»æè¢«è¿åç»å®¢æ·ç«¯ãå æ­¤ï¼æå¡å¨éç¾¤çèµ·æ¥å½¢æä¸ä¸ªé«å¯é çç¶ææºã\n\nå®éç³»ç»ä¸­ä½¿ç¨çä¸è´æ§ç®æ³éå¸¸å«æä»¥ä¸ç¹æ§ï¼\n\n * å®å¨æ§ä¿è¯ï¼ç»å¯¹ä¸ä¼è¿åä¸ä¸ªéè¯¯çç»æï¼ï¼å¨éæå åº­éè¯¯æåµä¸ï¼åæ¬ç½ç»å»¶è¿ãååºãä¸¢åãåä½åä¹±åºç­éè¯¯é½å¯ä»¥ä¿è¯æ­£ç¡®ã\n * å¯ç¨æ§ï¼éç¾¤ä¸­åªè¦æå¤§å¤æ°çæºå¨å¯è¿è¡å¹¶ä¸è½å¤ç¸äºéä¿¡ãåå®¢æ·ç«¯éä¿¡ï¼å°±å¯ä»¥ä¿è¯å¯ç¨ãå æ­¤ï¼ä¸ä¸ªå¸åçåå« 5 ä¸ªèç¹çéç¾¤å¯ä»¥å®¹å¿ä¸¤ä¸ªèç¹çå¤±è´¥ãæå¡å¨è¢«åæ­¢å°±è®¤ä¸ºæ¯å¤±è´¥ãä»ä»¬å½æç¨³å®çå­å¨çæ¶åå¯ä»¥ä»ç¶æä¸­æ¢å¤åæ¥å¹¶éæ°å å¥éç¾¤ã\n * ä¸ä¾èµæ¶åºæ¥ä¿è¯ä¸è´æ§ï¼ç©çæ¶ééè¯¯æèæç«¯çæ¶æ¯å»¶è¿åªæå¨æåæåµä¸æä¼å¯¼è´å¯ç¨æ§é®é¢ã\n * éå¸¸æåµä¸ï¼ä¸æ¡æä»¤å¯ä»¥å°½å¯è½å¿«çå¨éç¾¤ä¸­å¤§å¤æ°èç¹ååºä¸è½®è¿ç¨è¿ç¨è°ç¨æ¶å®æãå°é¨åæ¯è¾æ¢çèç¹ä¸ä¼å½±åç³»ç»æ´ä½çæ§è½ã\n\n\n# 1.3. RAFT åºç¨\n\nRAFT å¯ä»¥åä»ä¹ï¼\n\néè¿ RAFT æä¾çå¤å¶ç¶ææºï¼å¯ä»¥è§£å³åå¸å¼ç³»ç»çå¤å¶ãä¿®å¤ãèç¹ç®¡çç­é®é¢ãRaft æå¤§çç®åå½ååå¸å¼ç³»ç»çè®¾è®¡ä¸å®ç°ï¼è®©å¼åèåªå³æ³¨äºä¸å¡é»è¾ï¼å°å¶æ½è±¡å®ç°æå¯¹åºçç¶ææºå³å¯ãåºäºè¿å¥æ¡æ¶ï¼å¯ä»¥æå»ºå¾å¤åå¸å¼åºç¨ï¼\n\n * åå¸å¼éæå¡ï¼æ¯å¦ Zookeeper\n * åå¸å¼å­å¨ç³»ç»ï¼æ¯å¦åå¸å¼æ¶æ¯éåãåå¸å¼åç³»ç»ãåå¸å¼æä»¶ç³»ç»ãåå¸å¼è¡¨æ ¼ç³»ç»ç­\n * é«å¯é åä¿¡æ¯ç®¡çï¼æ¯å¦åç±» Master æ¨¡åç HA\n\n\n# 2. Raft åºç¡\n\nRaft å°ä¸è´æ§é®é¢åè§£æäºä¸ä¸ªå­é®é¢ï¼\n\n * éä¸¾ Leader\n * æ¥å¿å¤å¶\n * å®å¨æ§\n\nå¨åç»­ç« èï¼ä¼è¯¦ç»è®²è§£è¿ä¸ªå­é®é¢ãç°å¨ï¼åäºè§£ä¸ä¸ Raft çä¸äºæ ¸å¿æ¦å¿µã\n\n\n# 2.1. æå¡å¨è§è²\n\nå¨ Raft ä¸­ï¼ä»»ä½æ¶å»ï¼æ¯ä¸ªæå¡å¨é½å¤äºè¿ä¸ä¸ªè§è²ä¹ä¸ ï¼\n\n * Leader - é¢å¯¼èï¼éå¸¸ä¸ä¸ªç³»ç»ä¸­æ¯ä¸ä¸»ï¼Leaderï¼å¤ä»ï¼Followerï¼ãLeader è´è´£å¤çææçå®¢æ·ç«¯è¯·æ±ã\n * Follower - è·éèï¼ä¸ä¼åéä»»ä½è¯·æ±ï¼åªæ¯ç®åç ååºæ¥èª Leader æè Candidate çè¯·æ±ã\n * Candidate - åéèï¼éä¸¾æ° Leader æ¶çä¸´æ¶è§è²ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n>  * Follower åªååºæ¥èªå¶ä»æå¡å¨çè¯·æ±ãå¨ä¸å®æ¶éåï¼å¦æ Follower æ¥æ¶ä¸å°æ¶æ¯ï¼å°±ä¼è½¬åæ Candidateï¼å¹¶åèµ·éä¸¾ã\n>  * Candidate å Follower åèµ·æç¥¨è¯·æ±ï¼å¦æè·å¾éç¾¤ä¸­åæ°ä»¥ä¸çéç¥¨ï¼å°±ä¼è½¬åä¸º Leaderã\n>  * å¨ä¸ä¸ª Term åï¼Leader å§ç»ä¿æä¸åï¼ç´å°ä¸çº¿äºãLeader éè¦å¨ææ§åææ Follower åéå¿è·³æ¶æ¯ï¼ä»¥é»æ­¢ Follower è½¬åä¸º Candidateã\n\n\n# 2.2. ä»»æ\n\n\n\nRaft ææ¶é´åå²æä»»æé¿åº¦ç ä»»æï¼Termï¼ï¼ä»»æç¨è¿ç»­çæ´æ°æ è®°ãæ¯ä¸æ®µä»»æä»ä¸æ¬¡éä¸¾å¼å§ãRaft ä¿è¯äºå¨ä¸ä¸ªç»å®çä»»æåï¼æå¤åªæä¸ä¸ªé¢å¯¼èã\n\n * å¦æéä¸¾æåï¼Leader ä¼ç®¡çæ´ä¸ªéç¾¤ç´å°ä»»æç»æã\n * å¦æéä¸¾å¤±è´¥ï¼é£ä¹è¿ä¸ªä»»æå°±ä¼å ä¸ºæ²¡æ Leader èç»æã\n\nä¸åæå¡å¨èç¹è§å¯å°çä»»æè½¬æ¢ç¶æå¯è½ä¸ä¸æ ·ï¼\n\n * æå¡å¨èç¹å¯è½è§å¯å°å¤æ¬¡çä»»æè½¬æ¢ã\n * æå¡å¨èç¹ä¹å¯è½è§å¯ä¸å°ä»»ä½ä¸æ¬¡ä»»æè½¬æ¢ã\n\nä»»æå¨ Raft ç®æ³ä¸­åå½é»è¾æ¶éçä½ç¨ï¼ä½¿å¾æå¡å¨èç¹å¯ä»¥æ¥æä¸äºè¿æçä¿¡æ¯ï¼æ¯å¦è¿æç Leaderï¼ãæ¯ä¸ªæå¡å¨èç¹é½ä¼å­å¨ä¸ä¸ªå½åä»»æå·ï¼è¿ä¸ç¼å·å¨æ´ä¸ªæ¶æååè°çå¢é¿ãå½æå¡å¨ä¹é´éä¿¡çæ¶åä¼äº¤æ¢å½åä»»æå·ã\n\n * å¦æä¸ä¸ªæå¡å¨çå½åä»»æå·æ¯å¶ä»äººå°ï¼é£ä¹ä»ä¼æ´æ°èªå·±çç¼å·å°è¾å¤§çç¼å·å¼ã\n * å¦æä¸ä¸ª Candidate æè Leader åç°èªå·±çä»»æå·è¿æäºï¼é£ä¹ä»ä¼ç«å³æ¢å¤æè·éèç¶æã\n * å¦æä¸ä¸ªèç¹æ¥æ¶å°ä¸ä¸ªåå«è¿æçä»»æå·çè¯·æ±ï¼é£ä¹ä»ä¼ç´æ¥æç»è¿ä¸ªè¯·æ±ã\n\n\n# 2.3. RPC\n\nRaft ç®æ³ä¸­æå¡å¨èç¹ä¹é´çéä¿¡ä½¿ç¨ è¿ç¨è¿ç¨è°ç¨ï¼RPCï¼ã\n\nåºæ¬çä¸è´æ§ç®æ³åªéè¦ä¸¤ç§ RPCï¼\n\n * RequestVote RPC - è¯·æ±æç¥¨ RPCï¼ç± Candidate å¨éä¸¾æé´åèµ·ã\n * AppendEntries RPC - éå æ¡ç® RPCï¼ç± Leader åèµ·ï¼ç¨æ¥å¤å¶æ¥å¿åæä¾ä¸ç§å¿è·³æºå¶ã\n\n\n# 3. éä¸¾ Leader\n\n\n# 3.1. éä¸¾è§å\n\nRaft ä½¿ç¨ä¸ç§å¿è·³æºå¶æ¥è§¦å Leader éä¸¾ã\n\nLeader éè¦å¨ææ§çåææ Follower åéå¿è·³æ¶æ¯ï¼ä»¥æ­¤ç»´æèªå·±çæå¨å¹¶é»æ­¢æ° Leader çäº§çã\n\næ¯ä¸ª Follower é½è®¾ç½®äºä¸ä¸ªéæºçç«éè¶æ¶æ¶é´ï¼ä¸è¬ä¸º 150ms ~ 300msï¼å¦æå¨ç«éè¶æ¶æ¶é´åæ²¡ææ¶å° Leader çå¿è·³æ¶æ¯ï¼å°±ä¼è®¤ä¸ºå½å Term æ²¡æå¯ç¨ç Leaderï¼å¹¶åèµ·éä¸¾æ¥éåºæ°ç Leaderãå¼å§ä¸æ¬¡éä¸¾è¿ç¨ï¼Follower åè¦å¢å èªå·±çå½å Term å·ï¼å¹¶è½¬æ¢ä¸º Candidateã\n\nCandidate ä¼å¹¶è¡çåéç¾¤ä¸­çæææå¡å¨èç¹åéæç¥¨è¯·æ±ï¼RequestVote RPCï¼ï¼å®ä¼ä¿æå½åç¶æç´å°ä»¥ä¸ä¸ä»¶äºæä¹ä¸åçï¼\n\n * èªå·±æä¸º Leader\n * å¶ä»çæå¡å¨æä¸º Leader\n * æ²¡æä»»ä½æå¡å¨æä¸º Leader\n\n# èªå·±æä¸º Leader\n\n * å½ä¸ä¸ª Candidate ä»æ´ä¸ªéç¾¤åæ°ä»¥ä¸çæå¡å¨èç¹è·å¾äºéå¯¹åä¸ä¸ª Term çéç¥¨ï¼é£ä¹å®å°±èµ¢å¾äºè¿æ¬¡éä¸¾å¹¶æä¸º Leaderãæ¯ä¸ªæå¡å¨æå¤ä¼å¯¹ä¸ä¸ª Term æåºä¸å¼ éç¥¨ï¼æç§åæ¥åæå¡ï¼FIFOï¼çååãè¦æ±åæ°ä»¥ä¸éç¥¨çè§åç¡®ä¿äºæå¤åªä¼æä¸ä¸ª Candidate èµ¢å¾æ­¤æ¬¡éä¸¾ã\n * ä¸æ¦ Candidate èµ¢å¾éä¸¾ï¼å°±ç«å³æä¸º Leaderãç¶åå®ä¼åå¶ä»çæå¡å¨åéå¿è·³æ¶æ¯æ¥å»ºç«èªå·±çæå¨å¹¶ä¸é»æ­¢æ°çé¢å¯¼äººçäº§çã\n\n# å¶ä»çæå¡å¨æä¸º Leader\n\nç­å¾æç¥¨æé´ï¼Candidate å¯è½ä¼ä»å¶ä»çæå¡å¨æ¥æ¶å°å£°æå®æ¯ Leader ç AppendEntries RPCã\n\n * å¦æè¿ä¸ª Leader ç Term å·ï¼åå«å¨æ­¤æ¬¡ç RPC ä¸­ï¼ä¸å°äº Candidate å½åç Termï¼é£ä¹ Candidate ä¼æ¿è®¤ Leader åæ³å¹¶åå° Follower ç¶æã\n * å¦ææ­¤æ¬¡ RPC ä¸­ç Term å·æ¯èªå·±å°ï¼é£ä¹ Candidate å°±ä¼æç»è¿ä¸ªæ¶æ¯å¹¶ç»§ç»­ä¿æ Candidate ç¶æã\n\n# æ²¡æä»»ä½æå¡å¨æä¸º Leader\n\nå¦ææå¤ä¸ª Follower åæ¶æä¸º Candidateï¼é£ä¹éç¥¨å¯è½ä¼è¢«çåä»¥è³äºæ²¡æ Candidate å¯ä»¥èµ¢å¾åæ°ä»¥ä¸çæç¥¨ãå½è¿ç§æåµåççæ¶åï¼æ¯ä¸ä¸ª Candidate é½ä¼ç«éè¶æ¶ï¼ç¶åéè¿å¢å å½å Term å·æ¥å¼å§ä¸è½®æ°çéä¸¾ãç¶èï¼æ²¡æå¶ä»æºå¶çè¯ï¼éç¥¨å¯è½ä¼è¢«æ éçéå¤çåã\n\nRaft ç®æ³ä½¿ç¨éæºéä¸¾è¶æ¶æ¶é´çæ¹æ³æ¥ç¡®ä¿å¾å°ä¼åçéç¥¨çåçæåµï¼å°±ç®åçä¹è½å¾å¿«çè§£å³ãä¸ºäºé»æ­¢éç¥¨èµ·åå°±è¢«çåï¼ç«éè¶æ¶æ¶é´æ¯ä¸ä¸ªéæºçæ¶é´ï¼å¨ä¸ä¸ªåºå®çåºé´ï¼ä¾å¦ 150-300 æ¯«ç§ï¼éæºéæ©ï¼è¿æ ·å¯ä»¥æéä¸¾é½åæ£å¼ã\n\n * ä»¥è³äºå¨å¤§å¤æ°æåµä¸ï¼åªæä¸ä¸ªæå¡å¨ä¼è¶æ¶ï¼ç¶åå®èµ¢å¾éä¸¾ï¼æä¸º Leaderï¼å¹¶å¨å¶ä»æå¡å¨è¶æ¶ä¹ååéå¿è·³åã\n * åæ ·çæºå¶ä¹è¢«ç¨å¨éç¥¨çåçæåµä¸ï¼æ¯ä¸ä¸ª Candidate å¨å¼å§ä¸æ¬¡éä¸¾çæ¶åä¼éç½®ä¸ä¸ªéæºçéä¸¾è¶æ¶æ¶é´ï¼ç¶åå¨è¶æ¶æ¶é´åç­å¾æç¥¨çç»æï¼è¿æ ·åå°äºå¨æ°çéä¸¾ä¸­å¦å¤çéç¥¨çåçå¯è½æ§ã\n\n----------------------------------------\n\nçè§£äºä¸é¢çéä¸¾è§ååï¼æä»¬éè¿å¨å¾æ¥å æ·±è®¤è¯ã\n\n\n# 3.2. å Candidate éä¸¾\n\nï¼1ï¼ä¸å¾è¡¨ç¤ºä¸ä¸ªåå¸å¼ç³»ç»çæåé¶æ®µï¼æ­¤æ¶åªæ Followerï¼æ²¡æ LeaderãFollower A ç­å¾ä¸ä¸ªéæºçéä¸¾è¶æ¶æ¶é´ä¹åï¼æ²¡æ¶å° Leader åæ¥çå¿è·³æ¶æ¯ãå æ­¤ï¼å° Term ç± 0 å¢å ä¸º 1ï¼è½¬æ¢ä¸º Candidateï¼è¿å¥éä¸¾ç¶æã\n\n\n\nï¼2ï¼æ­¤æ¶ï¼A åææå¶ä»èç¹åéæç¥¨è¯·æ±ã\n\n\n\nï¼3ï¼å¶å®èç¹ä¼å¯¹æç¥¨è¯·æ±è¿è¡åå¤ï¼å¦æè¶è¿åæ°ä»¥ä¸çèç¹æç¥¨äºï¼é£ä¹è¯¥ Candidate å°±ä¼ç«å³åæ Term ä¸º 1 ç Leaderã\n\n\n\nï¼4ï¼Leader ä¼å¨ææ§å°åéå¿è·³æ¶æ¯ç»ææ Followerï¼Follower æ¥æ¶å°å¿è·³åï¼ä¼éæ°å¼å§è®¡æ¶ã\n\n\n\n\n# 3.3. å¤ Candidate éä¸¾\n\nï¼1ï¼å¦ææå¤ä¸ª Follower æä¸º Candidateï¼å¹¶ä¸æè·å¾ç¥¨æ°ç¸åï¼é£ä¹å°±éè¦éæ°å¼å§æç¥¨ãä¾å¦ä¸å¾ä¸­ Candidate B å Candidate D é½åèµ· Term ä¸º 4 çéä¸¾ï¼ä¸é½è·å¾ä¸¤ç¥¨ï¼å æ­¤éè¦éæ°å¼å§æç¥¨ã\n\n\n\nï¼2ï¼å½éæ°å¼å§æç¥¨æ¶ï¼ç±äºæ¯ä¸ªèç¹è®¾ç½®çéæºç«éè¶æ¶æ¶é´ä¸åï¼å æ­¤è½ä¸ä¸æ¬¡åæ¬¡åºç°å¤ä¸ª Candidate å¹¶è·å¾åæ ·ç¥¨æ°çæ¦çå¾ä½ã\n\n\n\n\n# 4. æ¥å¿å¤å¶\n\n\n# 4.1. æ¥å¿æ ¼å¼\n\næ¥å¿ç±å«æ¥å¿ç´¢å¼ï¼log indexï¼çæ¥å¿æ¡ç®ï¼log entryï¼ç»æãæ¯ä¸ªæ¥å¿æ¡ç®åå«å®è¢«åå»ºæ¶ç Term å·ï¼ä¸å¾ä¸­æ¹æ¡ä¸­çæ°å­ï¼ï¼åä¸ä¸ªå¤å¶ç¶ææºéè¦æ§è¡çæä»¤ãå¦æä¸ä¸ªæ¥å¿æ¡ç®è¢«å¤å¶å°åæ°ä»¥ä¸çæå¡å¨ä¸ï¼å°±è¢«è®¤ä¸ºå¯ä»¥æäº¤ï¼Commitï¼äºã\n\n * æ¥å¿æ¡ç®ä¸­ç Term å·è¢«ç¨æ¥æ£æ¥æ¯å¦åºç°ä¸ä¸è´çæåµã\n * æ¥å¿æ¡ç®ä¸­çæ¥å¿ç´¢å¼ï¼ä¸ä¸ªæ´æ°å¼ï¼ç¨æ¥è¡¨æå®å¨æ¥å¿ä¸­çä½ç½®ã\n\n\n\nRaft æ¥å¿åæ­¥ä¿è¯å¦ä¸ä¸¤ç¹ï¼\n\n * å¦æä¸åæ¥å¿ä¸­çä¸¤ä¸ªæ¥å¿æ¡ç®æçç¸åçæ¥å¿ç´¢å¼å Termï¼åå®ä»¬æå­å¨çå½ä»¤æ¯ç¸åçã\n   * è¿ä¸ªç¹æ§åºäºè¿æ¡ååï¼Leader æå¤å¨ä¸ä¸ª Term åãå¨æå®çä¸ä¸ªæ¥å¿ç´¢å¼ä¸åå»ºä¸æ¡æ¥å¿æ¡ç®ï¼åæ¶æ¥å¿æ¡ç®å¨æ¥å¿ä¸­çä½ç½®ä¹ä»æ¥ä¸ä¼æ¹åã\n * å¦æä¸åæ¥å¿ä¸­çä¸¤ä¸ªæ¥å¿æ¡ç®æçç¸åçæ¥å¿ç´¢å¼å Termï¼åå®ä»¬ä¹åçæææ¡ç®é½æ¯å®å¨ä¸æ ·çã\n   * è¿ä¸ªç¹æ§ç± AppendEntries RPC çä¸ä¸ªç®åçä¸è´æ§æ£æ¥æä¿è¯ãå¨åé AppendEntries RPC æ¶ï¼Leader ä¼ææ°æ¥å¿æ¡ç®ä¹åçæ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å Term å·ä¸èµ·åéãå¦æ Follower å¨å®çæ¥å¿ä¸­æ¾ä¸å°åå«ç¸åæ¥å¿ç´¢å¼å Term å·çæ¥å¿æ¡ç®ï¼å®å°±ä¼æç»æ¥æ¶æ°çæ¥å¿æ¡ç®ã\n\n\n# 4.2. æ¥å¿å¤å¶æµç¨\n\n\n\n 1. Leader è´è´£å¤çææå®¢æ·ç«¯çè¯·æ±ã\n 2. Leader æè¯·æ±ä½ä¸ºæ¥å¿æ¡ç®å å¥å°å®çæ¥å¿ä¸­ï¼ç¶åå¹¶è¡çåå¶ä»æå¡å¨åé AppendEntries RPC è¯·æ±ï¼è¦æ± Follower å¤å¶æ¥å¿æ¡ç®ã\n 3. Follower å¤å¶æååï¼è¿åç¡®è®¤æ¶æ¯ã\n 4. å½è¿ä¸ªæ¥å¿æ¡ç®è¢«åæ°ä»¥ä¸çæå¡å¨å¤å¶åï¼Leader æäº¤è¿ä¸ªæ¥å¿æ¡ç®å°å®çå¤å¶ç¶ææºï¼å¹¶åå®¢æ·ç«¯è¿åæ§è¡ç»æã\n\n> æ³¨æï¼å¦æ Follower å´©æºæèè¿è¡ç¼æ¢ï¼åæèç½ç»ä¸¢åï¼Leader ä¼ä¸æ­çéå¤å°è¯åé AppendEntries RPC è¯·æ± ï¼å°½ç®¡å·²ç»åå¤äºå®¢æ·ç«¯ï¼ï¼ç´å°ææçè·éèé½æç»å¤å¶äºææçæ¥å¿æ¡ç®ã\n\nä¸é¢ï¼éè¿ä¸ç»å¨å¾æ¥å æ·±è®¤è¯ï¼\n\nï¼1ï¼æ¥èªå®¢æ·ç«¯çä¿®æ¹é½ä¼è¢«ä¼ å¥ Leaderãæ³¨æè¯¥ä¿®æ¹è¿æªè¢«æäº¤ï¼åªæ¯åå¥æ¥å¿ä¸­ã\n\n\n\nï¼2ï¼Leader ä¼æä¿®æ¹å¤å¶å°ææ Followerã\n\n\n\nï¼3ï¼Leader ä¼ç­å¾å¤§å¤æ°ç Follower ä¹è¿è¡äºä¿®æ¹ï¼ç¶åæå°ä¿®æ¹æäº¤ã\n\n\n\nï¼4ï¼æ­¤æ¶ Leader ä¼éç¥çææ Follower è®©å®ä»¬ä¹æäº¤ä¿®æ¹ï¼æ­¤æ¶ææèç¹çå¼è¾¾æä¸è´ã\n\n\n\n\n# 4.3. æ¥å¿ä¸è´æ§\n\nä¸è¬æåµä¸ï¼Leader å Followers çæ¥å¿ä¿æä¸è´ï¼å æ­¤æ¥å¿æ¡ç®ä¸è´æ§æ£æ¥éå¸¸ä¸ä¼å¤±è´¥ãç¶èï¼Leader å´©æºå¯è½ä¼å¯¼è´æ¥å¿ä¸ä¸è´ï¼æ§ç Leader å¯è½æ²¡æå®å¨å¤å¶å®æ¥å¿ä¸­çæææ¡ç®ã\n\n# Leader å Follower æ¥å¿ä¸ä¸è´çå¯è½\n\nLeader å Follower å¯è½å­å¨å¤ç§æ¥å¿ä¸ä¸è´çå¯è½ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n> ä¸å¾éè¿°äº Leader å Follower å¯è½å­å¨å¤ç§æ¥å¿ä¸ä¸è´çå¯è½ï¼æ¯ä¸ä¸ªæ¹æ¡è¡¨ç¤ºä¸ä¸ªæ¥å¿æ¡ç®ï¼éé¢çæ°å­è¡¨ç¤ºä»»æå· ã\n> \n> å½ä¸ä¸ª Leader æåå½éæ¶ï¼Follower å¯è½åºç°ä»¥ä¸æåµï¼a-fï¼ï¼\n> \n>  * å­å¨æªæ´æ°æ¥å¿æ¡ç®ï¼å¦ï¼aãbï¼ã\n>  * å­å¨æªæäº¤æ¥å¿æ¡ç®ï¼å¦ï¼cãdï¼ã\n>  * æä¸¤ç§æåµé½å­å¨ï¼å¦ï¼eãfï¼ã\n> \n> ä¾å¦ï¼åºæ¯ f å¯è½ä¼è¿æ ·åçï¼ææå¡å¨å¨ Term2 çæ¶åæ¯ Leaderï¼å·²éå äºä¸äºæ¥å¿æ¡ç®å°èªå·±çæ¥å¿ä¸­ï¼ä½å¨æäº¤ä¹åå°±å´©æºäºï¼å¾å¿«è¿ä¸ªæºå¨å°±è¢«éå¯äºï¼å¨ Term3 éæ°è¢«éä¸º Leaderï¼å¹¶ä¸åå¢å äºä¸äºæ¥å¿æ¡ç®å°èªå·±çæ¥å¿ä¸­ï¼å¨ Term 2 å Term 3 çæ¥å¿è¢«æäº¤ä¹åï¼è¿ä¸ªæå¡å¨åå®æºäºï¼å¹¶ä¸å¨æ¥ä¸æ¥çå ä¸ªä»»æéä¸ç´å¤äºå®æºç¶æã\n\n# Leader å Follower æ¥å¿ä¸è´çä¿è¯\n\nLeader éè¿å¼ºå¶ Followers å¤å¶å®çæ¥å¿æ¥å¤çæ¥å¿çä¸ä¸è´ï¼Followers ä¸çä¸ä¸è´çæ¥å¿ä¼è¢« Leader çæ¥å¿è¦çã\n\n * Leader ä¸ºäºä½¿ Followers çæ¥å¿åèªå·±çä¸è´ï¼Leader éè¦æ¾å° Followers åå®çæ¥å¿ä¸è´çå°æ¹ï¼ç¶åè¦ç Followers å¨è¯¥ä½ç½®ä¹åçæ¡ç®ã\n * Leader ä¼ä»åå¾åè¯ï¼æ¯æ¬¡æ¥å¿æ¡ç®å¤±è´¥åå°è¯åä¸ä¸ªæ¥å¿æ¡ç®ï¼ç´å°æåæ¾å°æ¯ä¸ª Follower çæ¥å¿ä¸è´ä½ç¹ï¼ç¶åååéæ¡è¦ç Followers å¨è¯¥ä½ç½®ä¹åçæ¡ç®ã\n\n\n# 5. å®å¨æ§\n\nåé¢æè¿°äº Raft ç®æ³æ¯å¦ä½éä¸¾ Leader åå¤å¶æ¥å¿çã\n\nRaft è¿å¢å äºä¸äºéå¶æ¥å®å Raft ç®æ³ï¼ä»¥ä¿è¯å®å¨æ§ï¼ä¿è¯äºä»»æ Leader å¯¹äºç»å®ç Termï¼é½æ¥æäºä¹å Term çææè¢«æäº¤çæ¥å¿æ¡ç®ã\n\n\n# 5.1. éä¸¾éå¶\n\næ¥æææ°çå·²æäº¤çæ¥å¿æ¡ç®ç Follower ææèµæ ¼æä¸º Leaderã\n\nRaft ä½¿ç¨æç¥¨çæ¹å¼æ¥é»æ­¢ä¸ä¸ª Candidate èµ¢å¾éä¸¾é¤éè¿ä¸ª Candidate åå«äºææå·²ç»æäº¤çæ¥å¿æ¡ç®ã Candidate ä¸ºäºèµ¢å¾éä¸¾å¿é¡»èç³»éç¾¤ä¸­çå¤§é¨åèç¹ï¼è¿æå³çæ¯ä¸ä¸ªå·²ç»æäº¤çæ¥å¿æ¡ç®å¨è¿äºæå¡å¨èç¹ä¸­è¯å®å­å¨äºè³å°ä¸ä¸ªèç¹ä¸ãå¦æ Candidate çæ¥å¿è³å°åå¤§å¤æ°çæå¡å¨èç¹ä¸æ ·æ°ï¼è¿ä¸ªæ°çå®ä¹ä¼å¨ä¸é¢è®¨è®ºï¼ï¼é£ä¹ä»ä¸å®ææäºææå·²ç»æäº¤çæ¥å¿æ¡ç®ã\n\nRequestVote RPC å®ç°äºè¿æ ·çéå¶ï¼RequestVote RPC ä¸­åå«äº Candidate çæ¥å¿ä¿¡æ¯ï¼ Follower ä¼æç»æé£äºæ¥å¿æ²¡æèªå·±æ°çæç¥¨è¯·æ±ã\n\nå¦ä½å¤æ­åªä¸ªæ¥å¿æ¡ç®æ¯è¾æ°ï¼\n\nRaft éè¿æ¯è¾ä¸¤ä»½æ¥å¿ä¸­æåä¸æ¡æ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å Term æ¥å¤æ­åªä¸ªæ¥å¿æ¯è¾æ°ã\n\n * åå¤æ­ Termï¼åªä¸ªæ°å¼å¤§å³ä»£è¡¨åªä¸ªæ¥å¿æ¯è¾æ°ã\n * å¦æ Term ç¸åï¼åæ¯è¾ æ¥å¿ç´¢å¼ï¼åªä¸ªæ°å¼å¤§å³ä»£è¡¨åªä¸ªæ¥å¿æ¯è¾æ°ã\n\n\n# 5.2. æäº¤æ§ä»»æçæ¥å¿æ¡ç®\n\nä¸ä¸ªå½å Term çæ¥å¿æ¡ç®è¢«å¤å¶å°äºåæ°ä»¥ä¸çæå¡å¨ä¸ï¼Leader å°±è®¤ä¸ºå®æ¯å¯ä»¥è¢«æäº¤çãå¦æè¿ä¸ª Leader å¨æäº¤æ¥å¿æ¡ç®åå°±ä¸çº¿äºï¼åç»­ç Leader å¯è½ä¼è¦çæè¿ä¸ªæ¥å¿æ¡ç®ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n> ä¸å¾è§£éäºä¸ºä»ä¹ Leader æ æ³å¯¹æ§ Term çæ¥å¿æ¡ç®è¿è¡æäº¤ã\n> \n>  * é¶æ®µ (a) ï¼S1 æ¯ Leaderï¼ä¸ S1 åå¥æ¥å¿æ¡ç®ä¸º (Term 2ï¼æ¥å¿ç´¢å¼ 2ï¼ï¼åªæ S2 å¤å¶äºè¿ä¸ªæ¥å¿æ¡ç®ã\n>  * é¶æ®µ (b)ï¼S1 ä¸çº¿ï¼S5 è¢«éä¸¾ä¸º Term3 ç LeaderãS5 åå¥æ¥å¿æ¡ç®ä¸º (Term 3ï¼æ¥å¿ç´¢å¼ 2ï¼ã\n>  * é¶æ®µ (c)ï¼S5 ä¸çº¿ï¼S1 éæ°ä¸çº¿ï¼å¹¶è¢«éä¸¾ä¸º Term4 ç Leaderãæ­¤æ¶ï¼Term 2 çé£æ¡æ¥å¿æ¡ç®å·²ç»è¢«å¤å¶å°äºéç¾¤ä¸­çå¤§å¤æ°èç¹ä¸ï¼ä½æ¯è¿æ²¡æè¢«æäº¤ã\n>  * é¶æ®µ (d)ï¼S1 åæ¬¡ä¸çº¿ï¼S5 éæ°ä¸çº¿ï¼å¹¶è¢«éæ°éä¸¾ä¸º Term3 ç Leaderãç¶å S5 è¦çäºæ¥å¿ç´¢å¼ 2 å¤çæ¥å¿ã\n>  * é¶æ®µ (e)ï¼å¦æé¶æ®µ (d) è¿æªåçï¼å³ S1 åæ¬¡ä¸çº¿ä¹åï¼S1 æèªå·±ä¸»å¯¼çæ¥å¿æ¡ç®å¤å¶å°äºå¤§å¤æ°èç¹ä¸ï¼é£ä¹å¨åç»­ Term éé¢è¿äºæ°æ¥å¿æ¡ç®å°±ä¼è¢«æäº¤ãè¿æ ·å¨åä¸æ¶å»å°±åæ¶ä¿è¯äºï¼ä¹åçæææ§æ¥å¿æ¡ç®å°±ä¼è¢«æäº¤ã\n\nRaft æ°¸è¿ä¸ä¼éè¿è®¡ç®å¯æ¬æ°ç®çæ¹å¼å»æäº¤ä¸ä¸ªä¹å Term åçæ¥å¿æ¡ç®ãåªæ Leader å½å Term éçæ¥å¿æ¡ç®éè¿è®¡ç®å¯æ¬æ°ç®å¯ä»¥è¢«æäº¤ï¼ä¸æ¦å½å Term çæ¥å¿æ¡ç®ä»¥è¿ç§æ¹å¼è¢«æäº¤ï¼é£ä¹ç±äºæ¥å¿å¹éç¹æ§ï¼ä¹åçæ¥å¿æ¡ç®ä¹é½ä¼è¢«é´æ¥çæäº¤ã\n\nå½ Leader å¤å¶ä¹åä»»æéçæ¥å¿æ¶ï¼Raft ä¼ä¸ºæææ¥å¿ä¿çåå§ç Termï¼è¿å¨æäº¤è§åä¸äº§çäºé¢å¤çå¤ææ§ãå¨å¶ä»çä¸è´æ§ç®æ³ä¸­ï¼å¦æä¸ä¸ªæ°çé¢å¯¼äººè¦éæ°å¤å¶ä¹åçä»»æéçæ¥å¿æ¶ï¼å®å¿é¡»ä½¿ç¨å½åæ°çä»»æå·ãRaft ä½¿ç¨çæ¹æ³æ´å å®¹æè¾¨å«åºæ¥å¿ï¼å ä¸ºå®å¯ä»¥éçæ¶é´åæ¥å¿çååå¯¹æ¥å¿ç»´æ¤çåä¸ä¸ªä»»æç¼å·ãå¦å¤ï¼åå¶ä»çç®æ³ç¸æ¯ï¼Raft ä¸­çæ°é¢å¯¼äººåªéè¦åéæ´å°æ¥å¿æ¡ç®ï¼å¶ä»ç®æ³ä¸­å¿é¡»å¨ä»ä»¬è¢«æäº¤ä¹ååéæ´å¤çåä½æ¥å¿æ¡ç®æ¥ä¸ºä»ä»¬éæ°ç¼å·ï¼ã\n\n\n# 6. æ¥å¿åç¼©\n\nå¨å®éçç³»ç»ä¸­ï¼ä¸è½è®©æ¥å¿æ éè¨èï¼å¦åç³»ç»éå¯æ¶éè¦è±å¾é¿çæ¶é´è¿è¡æ¢å¤ï¼ä»èå½±åå¯ç¨æ§ãRaft éç¨å¯¹æ´ä¸ªç³»ç»è¿è¡å¿«ç§æ¥è§£å³ï¼å¿«ç§ä¹åçæ¥å¿é½å¯ä»¥ä¸¢å¼ã\n\næ¯ä¸ªå¯æ¬ç¬ç«çå¯¹èªå·±çç³»ç»ç¶æçæå¿«ç§ï¼å¹¶ä¸åªè½å¯¹å·²ç»æäº¤çæ¥å¿æ¡ç®çæå¿«ç§ã\n\nå¿«ç§åå«ä»¥ä¸åå®¹ï¼\n\n * æ¥å¿åæ°æ®ãæåä¸æ¡å·²æäº¤çæ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å Termãè¿ä¸¤ä¸ªå¼å¨å¿«ç§ä¹åçç¬¬ä¸æ¡æ¥å¿æ¡ç®ç AppendEntries RPC çå®æ´æ§æ£æ¥çæ¶åä¼è¢«ç¨ä¸ã\n * ç³»ç»å½åç¶æã\n\nå½ Leader è¦åéæä¸ªæ¥å¿æ¡ç®ï¼è½åå¤ªå¤ç Follower çæ¥å¿æ¡ç®ä¼è¢«ä¸¢å¼ï¼Leader ä¼å°å¿«ç§åç» Followerãæèæ°ä¸çº¿ä¸å°æºå¨æ¶ï¼ä¹ä¼åéå¿«ç§ç»å®ã\n\n\n\nçæå¿«ç§çé¢çè¦éä¸­ï¼é¢çè¿é«ä¼æ¶èå¤§é I/O å¸¦å®½ï¼é¢çè¿ä½ï¼ä¸æ¦éè¦æ§è¡æ¢å¤æä½ï¼ä¼ä¸¢å¤±å¤§éæ°æ®ï¼å½±åå¯ç¨æ§ãæ¨èå½æ¥å¿è¾¾å°æä¸ªåºå®çå¤§å°æ¶çæå¿«ç§ã\n\nçæä¸æ¬¡å¿«ç§å¯è½èæ¶è¿é¿ï¼å½±åæ­£å¸¸æ¥å¿åæ­¥ãå¯ä»¥éè¿ä½¿ç¨ copy-on-write ææ¯é¿åå¿«ç§è¿ç¨å½±åæ­£å¸¸æ¥å¿åæ­¥ã\n\n> è¯´æï¼æ¬æä»éè¿° Raft ç®æ³çæ ¸å¿åå®¹ï¼ä¸åæ¬ç®æ³è®ºè¯ãè¯ä¼°ç­\n\n\n# 7. åèèµæ\n\n * Raft ä¸è´æ§ç®æ³è®ºæåæ\n * Raft ä¸è´æ§ç®æ³è®ºæè¯æ\n * Raft ä½èè®²è§£è§é¢\n * Raft ä½èè®²è§£è§é¢å¯¹åºç PPT\n * åå¸å¼ç³»ç»ç Raft ç®æ³\n * Raft: Understandable Distributed Consensus - ä¸ä¸ªå¨ç»æç¨\n * The Raft Consensus Algorithm - ä¸ä¸ªäº¤äºå¼å¨ç»æç¨\n * sofa-jraft - èèéæç Raft ç®æ³å®ç°åºï¼Java çï¼",normalizedContent:"# æ·±å¥åæå±è¯æ§ç®æ³ raft\n\n\n\n\n# 1. raft ç®ä»\n\nraft æ¯ä¸ç§ä¸ºäºç®¡çæ¥å¿å¤å¶çåå¸å¼ä¸è´æ§ç®æ³ã\n\nraft åºç°ä¹åï¼paxos ä¸ç´æ¯åå¸å¼ä¸è´æ§ç®æ³çæ åãpaxos é¾ä»¥çè§£ï¼æ´é¾ä»¥å®ç°ãraft çè®¾è®¡ç®æ æ¯ç®å paxosï¼ä½¿å¾ç®æ³æ¢å®¹æçè§£ï¼ä¹å®¹æå®ç°ã\n\npaxos å raft é½æ¯åå¸å¼ä¸è´æ§ç®æ³ï¼è¿ä¸ªè¿ç¨å¦åæç¥¨éä¸¾é¢è¢ï¼leaderï¼ï¼åéèï¼candidateï¼éè¦è¯´æå¤§å¤æ°æç¥¨èï¼followerï¼æç¥¨ç»ä»ï¼ä¸æ¦éä¸¾åºé¢è¢ï¼å°±ç±é¢è¢åå·æ½ä»¤ãpaxos å raft çåºå«å¨äºéä¸¾çå·ä½è¿ç¨ä¸åã\n\nraft å¯ä»¥è§£å³åå¸å¼ cap çè®ºä¸­ç cpï¼å³ ä¸è´æ§ï¼cï¼consistencyï¼ å ååºå®¹å¿æ§ï¼pï¼partition toleranceï¼ï¼å¹¶ä¸è½è§£å³ å¯ç¨æ§ï¼aï¼availabilityï¼ çé®é¢ã\n\n\n# 1.1. åå¸å¼ä¸è´æ§\n\nåå¸å¼ä¸è´æ§ (distributed consensus) æ¯åå¸å¼ç³»ç»ä¸­æåºæ¬çé®é¢ï¼ç¨æ¥ä¿è¯ä¸ä¸ªåå¸å¼ç³»ç»çå¯é æ§ä»¥åå®¹éè½åãç®åæ¥è¯´ï¼åå¸å¼ä¸è´æ§æ¯æå¤ä¸ªæå¡å¨çä¿æç¶æä¸è´ã\n\nå¨åå¸å¼ç³»ç»ä¸­ï¼å¯è½åºç°åç§æå¤ï¼æ­çµãç½ç»æ¥å¡ãcpu/åå­èå°½ç­ç­ï¼ï¼ä½¿å¾æå¡å¨å®æºææ æ³è®¿é®ï¼æç»å¯¼è´æ æ³åå¶ä»æå¡å¨ä¿æç¶æä¸è´ãä¸ºäºåºå¯¹è¿ç§æåµï¼å°±éè¦æä¸ç§ä¸è´æ§åè®®æ¥è¿è¡å®¹éï¼ä½¿å¾åå¸å¼ç³»ç»ä¸­å³ä½¿æé¨åæå¡å¨å®æºææ æ³è®¿é®ï¼æ´ä½ä¾ç¶å¯ä»¥å¯¹å¤æä¾æå¡ã\n\nä»¥å®¹éæ¹å¼è¾¾æä¸è´ï¼èªç¶ä¸è½è¦æ±æææå¡å¨é½è¾¾æä¸è´ç¶æï¼åªè¦è¶è¿åæ°ä»¥ä¸çæå¡å¨è¾¾æä¸è´å°±å¯ä»¥äºãåè®¾æ n å°æå¡å¨ï¼ å¤§äºç­äº n/2 + 1 å°æå¡å¨å°±ç®æ¯åæ°ä»¥ä¸äº ã\n\n\n# 1.2. å¤å¶ç¶ææº\n\nå¤å¶ç¶ææºï¼replicated state machinesï¼ æ¯æä¸ç»æå¡å¨ä¸çç¶ææºäº§çç¸åç¶æçå¯æ¬ï¼å¹¶ä¸å¨ä¸äºæºå¨å®æçæåµä¸ä¹å¯ä»¥ç»§ç»­è¿è¡ãä¸è´æ§ç®æ³ç®¡ççæ¥èªå®¢æ·ç«¯æä»¤çå¤å¶æ¥å¿ãç¶ææºä»æ¥å¿ä¸­å¤çç¸åé¡ºåºçç¸åæä»¤ï¼æä»¥äº§ççç»æä¹æ¯ç¸åçã\n\n\n\nå¤å¶ç¶ææºéå¸¸é½æ¯åºäºå¤å¶æ¥å¿å®ç°çï¼å¦ä¸å¾ãæ¯ä¸ä¸ªæå¡å¨å­å¨ä¸ä¸ªåå«ä¸ç³»åæä»¤çæ¥å¿ï¼å¹¶ä¸æç§æ¥å¿çé¡ºåºè¿è¡æ§è¡ãæ¯ä¸ä¸ªæ¥å¿é½æç§ç¸åçé¡ºåºåå«ç¸åçæä»¤ï¼æä»¥æ¯ä¸ä¸ªæå¡å¨é½æ§è¡ç¸åçæä»¤åºåãå ä¸ºæ¯ä¸ªç¶ææºé½æ¯ç¡®å®çï¼æ¯ä¸æ¬¡æ§è¡æä½é½äº§çç¸åçç¶æååæ ·çåºåã\n\nä¿è¯å¤å¶æ¥å¿ç¸åå°±æ¯ä¸è´æ§ç®æ³çå·¥ä½äºãå¨ä¸å°æå¡å¨ä¸ï¼ä¸è´æ§æ¨¡åæ¥æ¶å®¢æ·ç«¯åéæ¥çæä»¤ç¶åå¢å å°èªå·±çæ¥å¿ä¸­å»ãå®åå¶ä»æå¡å¨ä¸çä¸è´æ§æ¨¡åè¿è¡éä¿¡æ¥ä¿è¯æ¯ä¸ä¸ªæå¡å¨ä¸çæ¥å¿æç»é½ä»¥ç¸åçé¡ºåºåå«ç¸åçè¯·æ±ï¼å°½ç®¡æäºæå¡å¨ä¼å®æºãä¸æ¦æä»¤è¢«æ­£ç¡®çå¤å¶ï¼æ¯ä¸ä¸ªæå¡å¨çç¶ææºæç§æ¥å¿é¡ºåºå¤çä»ä»¬ï¼ç¶åè¾åºç»æè¢«è¿åç»å®¢æ·ç«¯ãå æ­¤ï¼æå¡å¨éç¾¤çèµ·æ¥å½¢æä¸ä¸ªé«å¯é çç¶ææºã\n\nå®éç³»ç»ä¸­ä½¿ç¨çä¸è´æ§ç®æ³éå¸¸å«æä»¥ä¸ç¹æ§ï¼\n\n * å®å¨æ§ä¿è¯ï¼ç»å¯¹ä¸ä¼è¿åä¸ä¸ªéè¯¯çç»æï¼ï¼å¨éæå åº­éè¯¯æåµä¸ï¼åæ¬ç½ç»å»¶è¿ãååºãä¸¢åãåä½åä¹±åºç­éè¯¯é½å¯ä»¥ä¿è¯æ­£ç¡®ã\n * å¯ç¨æ§ï¼éç¾¤ä¸­åªè¦æå¤§å¤æ°çæºå¨å¯è¿è¡å¹¶ä¸è½å¤ç¸äºéä¿¡ãåå®¢æ·ç«¯éä¿¡ï¼å°±å¯ä»¥ä¿è¯å¯ç¨ãå æ­¤ï¼ä¸ä¸ªå¸åçåå« 5 ä¸ªèç¹çéç¾¤å¯ä»¥å®¹å¿ä¸¤ä¸ªèç¹çå¤±è´¥ãæå¡å¨è¢«åæ­¢å°±è®¤ä¸ºæ¯å¤±è´¥ãä»ä»¬å½æç¨³å®çå­å¨çæ¶åå¯ä»¥ä»ç¶æä¸­æ¢å¤åæ¥å¹¶éæ°å å¥éç¾¤ã\n * ä¸ä¾èµæ¶åºæ¥ä¿è¯ä¸è´æ§ï¼ç©çæ¶ééè¯¯æèæç«¯çæ¶æ¯å»¶è¿åªæå¨æåæåµä¸æä¼å¯¼è´å¯ç¨æ§é®é¢ã\n * éå¸¸æåµä¸ï¼ä¸æ¡æä»¤å¯ä»¥å°½å¯è½å¿«çå¨éç¾¤ä¸­å¤§å¤æ°èç¹ååºä¸è½®è¿ç¨è¿ç¨è°ç¨æ¶å®æãå°é¨åæ¯è¾æ¢çèç¹ä¸ä¼å½±åç³»ç»æ´ä½çæ§è½ã\n\n\n# 1.3. raft åºç¨\n\nraft å¯ä»¥åä»ä¹ï¼\n\néè¿ raft æä¾çå¤å¶ç¶ææºï¼å¯ä»¥è§£å³åå¸å¼ç³»ç»çå¤å¶ãä¿®å¤ãèç¹ç®¡çç­é®é¢ãraft æå¤§çç®åå½ååå¸å¼ç³»ç»çè®¾è®¡ä¸å®ç°ï¼è®©å¼åèåªå³æ³¨äºä¸å¡é»è¾ï¼å°å¶æ½è±¡å®ç°æå¯¹åºçç¶ææºå³å¯ãåºäºè¿å¥æ¡æ¶ï¼å¯ä»¥æå»ºå¾å¤åå¸å¼åºç¨ï¼\n\n * åå¸å¼éæå¡ï¼æ¯å¦ zookeeper\n * åå¸å¼å­å¨ç³»ç»ï¼æ¯å¦åå¸å¼æ¶æ¯éåãåå¸å¼åç³»ç»ãåå¸å¼æä»¶ç³»ç»ãåå¸å¼è¡¨æ ¼ç³»ç»ç­\n * é«å¯é åä¿¡æ¯ç®¡çï¼æ¯å¦åç±» master æ¨¡åç ha\n\n\n# 2. raft åºç¡\n\nraft å°ä¸è´æ§é®é¢åè§£æäºä¸ä¸ªå­é®é¢ï¼\n\n * éä¸¾ leader\n * æ¥å¿å¤å¶\n * å®å¨æ§\n\nå¨åç»­ç« èï¼ä¼è¯¦ç»è®²è§£è¿ä¸ªå­é®é¢ãç°å¨ï¼åäºè§£ä¸ä¸ raft çä¸äºæ ¸å¿æ¦å¿µã\n\n\n# 2.1. æå¡å¨è§è²\n\nå¨ raft ä¸­ï¼ä»»ä½æ¶å»ï¼æ¯ä¸ªæå¡å¨é½å¤äºè¿ä¸ä¸ªè§è²ä¹ä¸ ï¼\n\n * leader - é¢å¯¼èï¼éå¸¸ä¸ä¸ªç³»ç»ä¸­æ¯ä¸ä¸»ï¼leaderï¼å¤ä»ï¼followerï¼ãleader è´è´£å¤çææçå®¢æ·ç«¯è¯·æ±ã\n * follower - è·éèï¼ä¸ä¼åéä»»ä½è¯·æ±ï¼åªæ¯ç®åç ååºæ¥èª leader æè candidate çè¯·æ±ã\n * candidate - åéèï¼éä¸¾æ° leader æ¶çä¸´æ¶è§è²ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n>  * follower åªååºæ¥èªå¶ä»æå¡å¨çè¯·æ±ãå¨ä¸å®æ¶éåï¼å¦æ follower æ¥æ¶ä¸å°æ¶æ¯ï¼å°±ä¼è½¬åæ candidateï¼å¹¶åèµ·éä¸¾ã\n>  * candidate å follower åèµ·æç¥¨è¯·æ±ï¼å¦æè·å¾éç¾¤ä¸­åæ°ä»¥ä¸çéç¥¨ï¼å°±ä¼è½¬åä¸º leaderã\n>  * å¨ä¸ä¸ª term åï¼leader å§ç»ä¿æä¸åï¼ç´å°ä¸çº¿äºãleader éè¦å¨ææ§åææ follower åéå¿è·³æ¶æ¯ï¼ä»¥é»æ­¢ follower è½¬åä¸º candidateã\n\n\n# 2.2. ä»»æ\n\n\n\nraft ææ¶é´åå²æä»»æé¿åº¦ç ä»»æï¼termï¼ï¼ä»»æç¨è¿ç»­çæ´æ°æ è®°ãæ¯ä¸æ®µä»»æä»ä¸æ¬¡éä¸¾å¼å§ãraft ä¿è¯äºå¨ä¸ä¸ªç»å®çä»»æåï¼æå¤åªæä¸ä¸ªé¢å¯¼èã\n\n * å¦æéä¸¾æåï¼leader ä¼ç®¡çæ´ä¸ªéç¾¤ç´å°ä»»æç»æã\n * å¦æéä¸¾å¤±è´¥ï¼é£ä¹è¿ä¸ªä»»æå°±ä¼å ä¸ºæ²¡æ leader èç»æã\n\nä¸åæå¡å¨èç¹è§å¯å°çä»»æè½¬æ¢ç¶æå¯è½ä¸ä¸æ ·ï¼\n\n * æå¡å¨èç¹å¯è½è§å¯å°å¤æ¬¡çä»»æè½¬æ¢ã\n * æå¡å¨èç¹ä¹å¯è½è§å¯ä¸å°ä»»ä½ä¸æ¬¡ä»»æè½¬æ¢ã\n\nä»»æå¨ raft ç®æ³ä¸­åå½é»è¾æ¶éçä½ç¨ï¼ä½¿å¾æå¡å¨èç¹å¯ä»¥æ¥æä¸äºè¿æçä¿¡æ¯ï¼æ¯å¦è¿æç leaderï¼ãæ¯ä¸ªæå¡å¨èç¹é½ä¼å­å¨ä¸ä¸ªå½åä»»æå·ï¼è¿ä¸ç¼å·å¨æ´ä¸ªæ¶æååè°çå¢é¿ãå½æå¡å¨ä¹é´éä¿¡çæ¶åä¼äº¤æ¢å½åä»»æå·ã\n\n * å¦æä¸ä¸ªæå¡å¨çå½åä»»æå·æ¯å¶ä»äººå°ï¼é£ä¹ä»ä¼æ´æ°èªå·±çç¼å·å°è¾å¤§çç¼å·å¼ã\n * å¦æä¸ä¸ª candidate æè leader åç°èªå·±çä»»æå·è¿æäºï¼é£ä¹ä»ä¼ç«å³æ¢å¤æè·éèç¶æã\n * å¦æä¸ä¸ªèç¹æ¥æ¶å°ä¸ä¸ªåå«è¿æçä»»æå·çè¯·æ±ï¼é£ä¹ä»ä¼ç´æ¥æç»è¿ä¸ªè¯·æ±ã\n\n\n# 2.3. rpc\n\nraft ç®æ³ä¸­æå¡å¨èç¹ä¹é´çéä¿¡ä½¿ç¨ è¿ç¨è¿ç¨è°ç¨ï¼rpcï¼ã\n\nåºæ¬çä¸è´æ§ç®æ³åªéè¦ä¸¤ç§ rpcï¼\n\n * requestvote rpc - è¯·æ±æç¥¨ rpcï¼ç± candidate å¨éä¸¾æé´åèµ·ã\n * appendentries rpc - éå æ¡ç® rpcï¼ç± leader åèµ·ï¼ç¨æ¥å¤å¶æ¥å¿åæä¾ä¸ç§å¿è·³æºå¶ã\n\n\n# 3. éä¸¾ leader\n\n\n# 3.1. éä¸¾è§å\n\nraft ä½¿ç¨ä¸ç§å¿è·³æºå¶æ¥è§¦å leader éä¸¾ã\n\nleader éè¦å¨ææ§çåææ follower åéå¿è·³æ¶æ¯ï¼ä»¥æ­¤ç»´æèªå·±çæå¨å¹¶é»æ­¢æ° leader çäº§çã\n\næ¯ä¸ª follower é½è®¾ç½®äºä¸ä¸ªéæºçç«éè¶æ¶æ¶é´ï¼ä¸è¬ä¸º 150ms ~ 300msï¼å¦æå¨ç«éè¶æ¶æ¶é´åæ²¡ææ¶å° leader çå¿è·³æ¶æ¯ï¼å°±ä¼è®¤ä¸ºå½å term æ²¡æå¯ç¨ç leaderï¼å¹¶åèµ·éä¸¾æ¥éåºæ°ç leaderãå¼å§ä¸æ¬¡éä¸¾è¿ç¨ï¼follower åè¦å¢å èªå·±çå½å term å·ï¼å¹¶è½¬æ¢ä¸º candidateã\n\ncandidate ä¼å¹¶è¡çåéç¾¤ä¸­çæææå¡å¨èç¹åéæç¥¨è¯·æ±ï¼requestvote rpcï¼ï¼å®ä¼ä¿æå½åç¶æç´å°ä»¥ä¸ä¸ä»¶äºæä¹ä¸åçï¼\n\n * èªå·±æä¸º leader\n * å¶ä»çæå¡å¨æä¸º leader\n * æ²¡æä»»ä½æå¡å¨æä¸º leader\n\n# èªå·±æä¸º leader\n\n * å½ä¸ä¸ª candidate ä»æ´ä¸ªéç¾¤åæ°ä»¥ä¸çæå¡å¨èç¹è·å¾äºéå¯¹åä¸ä¸ª term çéç¥¨ï¼é£ä¹å®å°±èµ¢å¾äºè¿æ¬¡éä¸¾å¹¶æä¸º leaderãæ¯ä¸ªæå¡å¨æå¤ä¼å¯¹ä¸ä¸ª term æåºä¸å¼ éç¥¨ï¼æç§åæ¥åæå¡ï¼fifoï¼çååãè¦æ±åæ°ä»¥ä¸éç¥¨çè§åç¡®ä¿äºæå¤åªä¼æä¸ä¸ª candidate èµ¢å¾æ­¤æ¬¡éä¸¾ã\n * ä¸æ¦ candidate èµ¢å¾éä¸¾ï¼å°±ç«å³æä¸º leaderãç¶åå®ä¼åå¶ä»çæå¡å¨åéå¿è·³æ¶æ¯æ¥å»ºç«èªå·±çæå¨å¹¶ä¸é»æ­¢æ°çé¢å¯¼äººçäº§çã\n\n# å¶ä»çæå¡å¨æä¸º leader\n\nç­å¾æç¥¨æé´ï¼candidate å¯è½ä¼ä»å¶ä»çæå¡å¨æ¥æ¶å°å£°æå®æ¯ leader ç appendentries rpcã\n\n * å¦æè¿ä¸ª leader ç term å·ï¼åå«å¨æ­¤æ¬¡ç rpc ä¸­ï¼ä¸å°äº candidate å½åç termï¼é£ä¹ candidate ä¼æ¿è®¤ leader åæ³å¹¶åå° follower ç¶æã\n * å¦ææ­¤æ¬¡ rpc ä¸­ç term å·æ¯èªå·±å°ï¼é£ä¹ candidate å°±ä¼æç»è¿ä¸ªæ¶æ¯å¹¶ç»§ç»­ä¿æ candidate ç¶æã\n\n# æ²¡æä»»ä½æå¡å¨æä¸º leader\n\nå¦ææå¤ä¸ª follower åæ¶æä¸º candidateï¼é£ä¹éç¥¨å¯è½ä¼è¢«çåä»¥è³äºæ²¡æ candidate å¯ä»¥èµ¢å¾åæ°ä»¥ä¸çæç¥¨ãå½è¿ç§æåµåççæ¶åï¼æ¯ä¸ä¸ª candidate é½ä¼ç«éè¶æ¶ï¼ç¶åéè¿å¢å å½å term å·æ¥å¼å§ä¸è½®æ°çéä¸¾ãç¶èï¼æ²¡æå¶ä»æºå¶çè¯ï¼éç¥¨å¯è½ä¼è¢«æ éçéå¤çåã\n\nraft ç®æ³ä½¿ç¨éæºéä¸¾è¶æ¶æ¶é´çæ¹æ³æ¥ç¡®ä¿å¾å°ä¼åçéç¥¨çåçæåµï¼å°±ç®åçä¹è½å¾å¿«çè§£å³ãä¸ºäºé»æ­¢éç¥¨èµ·åå°±è¢«çåï¼ç«éè¶æ¶æ¶é´æ¯ä¸ä¸ªéæºçæ¶é´ï¼å¨ä¸ä¸ªåºå®çåºé´ï¼ä¾å¦ 150-300 æ¯«ç§ï¼éæºéæ©ï¼è¿æ ·å¯ä»¥æéä¸¾é½åæ£å¼ã\n\n * ä»¥è³äºå¨å¤§å¤æ°æåµä¸ï¼åªæä¸ä¸ªæå¡å¨ä¼è¶æ¶ï¼ç¶åå®èµ¢å¾éä¸¾ï¼æä¸º leaderï¼å¹¶å¨å¶ä»æå¡å¨è¶æ¶ä¹ååéå¿è·³åã\n * åæ ·çæºå¶ä¹è¢«ç¨å¨éç¥¨çåçæåµä¸ï¼æ¯ä¸ä¸ª candidate å¨å¼å§ä¸æ¬¡éä¸¾çæ¶åä¼éç½®ä¸ä¸ªéæºçéä¸¾è¶æ¶æ¶é´ï¼ç¶åå¨è¶æ¶æ¶é´åç­å¾æç¥¨çç»æï¼è¿æ ·åå°äºå¨æ°çéä¸¾ä¸­å¦å¤çéç¥¨çåçå¯è½æ§ã\n\n----------------------------------------\n\nçè§£äºä¸é¢çéä¸¾è§ååï¼æä»¬éè¿å¨å¾æ¥å æ·±è®¤è¯ã\n\n\n# 3.2. å candidate éä¸¾\n\nï¼1ï¼ä¸å¾è¡¨ç¤ºä¸ä¸ªåå¸å¼ç³»ç»çæåé¶æ®µï¼æ­¤æ¶åªæ followerï¼æ²¡æ leaderãfollower a ç­å¾ä¸ä¸ªéæºçéä¸¾è¶æ¶æ¶é´ä¹åï¼æ²¡æ¶å° leader åæ¥çå¿è·³æ¶æ¯ãå æ­¤ï¼å° term ç± 0 å¢å ä¸º 1ï¼è½¬æ¢ä¸º candidateï¼è¿å¥éä¸¾ç¶æã\n\n\n\nï¼2ï¼æ­¤æ¶ï¼a åææå¶ä»èç¹åéæç¥¨è¯·æ±ã\n\n\n\nï¼3ï¼å¶å®èç¹ä¼å¯¹æç¥¨è¯·æ±è¿è¡åå¤ï¼å¦æè¶è¿åæ°ä»¥ä¸çèç¹æç¥¨äºï¼é£ä¹è¯¥ candidate å°±ä¼ç«å³åæ term ä¸º 1 ç leaderã\n\n\n\nï¼4ï¼leader ä¼å¨ææ§å°åéå¿è·³æ¶æ¯ç»ææ followerï¼follower æ¥æ¶å°å¿è·³åï¼ä¼éæ°å¼å§è®¡æ¶ã\n\n\n\n\n# 3.3. å¤ candidate éä¸¾\n\nï¼1ï¼å¦ææå¤ä¸ª follower æä¸º candidateï¼å¹¶ä¸æè·å¾ç¥¨æ°ç¸åï¼é£ä¹å°±éè¦éæ°å¼å§æç¥¨ãä¾å¦ä¸å¾ä¸­ candidate b å candidate d é½åèµ· term ä¸º 4 çéä¸¾ï¼ä¸é½è·å¾ä¸¤ç¥¨ï¼å æ­¤éè¦éæ°å¼å§æç¥¨ã\n\n\n\nï¼2ï¼å½éæ°å¼å§æç¥¨æ¶ï¼ç±äºæ¯ä¸ªèç¹è®¾ç½®çéæºç«éè¶æ¶æ¶é´ä¸åï¼å æ­¤è½ä¸ä¸æ¬¡åæ¬¡åºç°å¤ä¸ª candidate å¹¶è·å¾åæ ·ç¥¨æ°çæ¦çå¾ä½ã\n\n\n\n\n# 4. æ¥å¿å¤å¶\n\n\n# 4.1. æ¥å¿æ ¼å¼\n\næ¥å¿ç±å«æ¥å¿ç´¢å¼ï¼log indexï¼çæ¥å¿æ¡ç®ï¼log entryï¼ç»æãæ¯ä¸ªæ¥å¿æ¡ç®åå«å®è¢«åå»ºæ¶ç term å·ï¼ä¸å¾ä¸­æ¹æ¡ä¸­çæ°å­ï¼ï¼åä¸ä¸ªå¤å¶ç¶ææºéè¦æ§è¡çæä»¤ãå¦æä¸ä¸ªæ¥å¿æ¡ç®è¢«å¤å¶å°åæ°ä»¥ä¸çæå¡å¨ä¸ï¼å°±è¢«è®¤ä¸ºå¯ä»¥æäº¤ï¼commitï¼äºã\n\n * æ¥å¿æ¡ç®ä¸­ç term å·è¢«ç¨æ¥æ£æ¥æ¯å¦åºç°ä¸ä¸è´çæåµã\n * æ¥å¿æ¡ç®ä¸­çæ¥å¿ç´¢å¼ï¼ä¸ä¸ªæ´æ°å¼ï¼ç¨æ¥è¡¨æå®å¨æ¥å¿ä¸­çä½ç½®ã\n\n\n\nraft æ¥å¿åæ­¥ä¿è¯å¦ä¸ä¸¤ç¹ï¼\n\n * å¦æä¸åæ¥å¿ä¸­çä¸¤ä¸ªæ¥å¿æ¡ç®æçç¸åçæ¥å¿ç´¢å¼å termï¼åå®ä»¬æå­å¨çå½ä»¤æ¯ç¸åçã\n   * è¿ä¸ªç¹æ§åºäºè¿æ¡ååï¼leader æå¤å¨ä¸ä¸ª term åãå¨æå®çä¸ä¸ªæ¥å¿ç´¢å¼ä¸åå»ºä¸æ¡æ¥å¿æ¡ç®ï¼åæ¶æ¥å¿æ¡ç®å¨æ¥å¿ä¸­çä½ç½®ä¹ä»æ¥ä¸ä¼æ¹åã\n * å¦æä¸åæ¥å¿ä¸­çä¸¤ä¸ªæ¥å¿æ¡ç®æçç¸åçæ¥å¿ç´¢å¼å termï¼åå®ä»¬ä¹åçæææ¡ç®é½æ¯å®å¨ä¸æ ·çã\n   * è¿ä¸ªç¹æ§ç± appendentries rpc çä¸ä¸ªç®åçä¸è´æ§æ£æ¥æä¿è¯ãå¨åé appendentries rpc æ¶ï¼leader ä¼ææ°æ¥å¿æ¡ç®ä¹åçæ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å term å·ä¸èµ·åéãå¦æ follower å¨å®çæ¥å¿ä¸­æ¾ä¸å°åå«ç¸åæ¥å¿ç´¢å¼å term å·çæ¥å¿æ¡ç®ï¼å®å°±ä¼æç»æ¥æ¶æ°çæ¥å¿æ¡ç®ã\n\n\n# 4.2. æ¥å¿å¤å¶æµç¨\n\n\n\n 1. leader è´è´£å¤çææå®¢æ·ç«¯çè¯·æ±ã\n 2. leader æè¯·æ±ä½ä¸ºæ¥å¿æ¡ç®å å¥å°å®çæ¥å¿ä¸­ï¼ç¶åå¹¶è¡çåå¶ä»æå¡å¨åé appendentries rpc è¯·æ±ï¼è¦æ± follower å¤å¶æ¥å¿æ¡ç®ã\n 3. follower å¤å¶æååï¼è¿åç¡®è®¤æ¶æ¯ã\n 4. å½è¿ä¸ªæ¥å¿æ¡ç®è¢«åæ°ä»¥ä¸çæå¡å¨å¤å¶åï¼leader æäº¤è¿ä¸ªæ¥å¿æ¡ç®å°å®çå¤å¶ç¶ææºï¼å¹¶åå®¢æ·ç«¯è¿åæ§è¡ç»æã\n\n> æ³¨æï¼å¦æ follower å´©æºæèè¿è¡ç¼æ¢ï¼åæèç½ç»ä¸¢åï¼leader ä¼ä¸æ­çéå¤å°è¯åé appendentries rpc è¯·æ± ï¼å°½ç®¡å·²ç»åå¤äºå®¢æ·ç«¯ï¼ï¼ç´å°ææçè·éèé½æç»å¤å¶äºææçæ¥å¿æ¡ç®ã\n\nä¸é¢ï¼éè¿ä¸ç»å¨å¾æ¥å æ·±è®¤è¯ï¼\n\nï¼1ï¼æ¥èªå®¢æ·ç«¯çä¿®æ¹é½ä¼è¢«ä¼ å¥ leaderãæ³¨æè¯¥ä¿®æ¹è¿æªè¢«æäº¤ï¼åªæ¯åå¥æ¥å¿ä¸­ã\n\n\n\nï¼2ï¼leader ä¼æä¿®æ¹å¤å¶å°ææ followerã\n\n\n\nï¼3ï¼leader ä¼ç­å¾å¤§å¤æ°ç follower ä¹è¿è¡äºä¿®æ¹ï¼ç¶åæå°ä¿®æ¹æäº¤ã\n\n\n\nï¼4ï¼æ­¤æ¶ leader ä¼éç¥çææ follower è®©å®ä»¬ä¹æäº¤ä¿®æ¹ï¼æ­¤æ¶ææèç¹çå¼è¾¾æä¸è´ã\n\n\n\n\n# 4.3. æ¥å¿ä¸è´æ§\n\nä¸è¬æåµä¸ï¼leader å followers çæ¥å¿ä¿æä¸è´ï¼å æ­¤æ¥å¿æ¡ç®ä¸è´æ§æ£æ¥éå¸¸ä¸ä¼å¤±è´¥ãç¶èï¼leader å´©æºå¯è½ä¼å¯¼è´æ¥å¿ä¸ä¸è´ï¼æ§ç leader å¯è½æ²¡æå®å¨å¤å¶å®æ¥å¿ä¸­çæææ¡ç®ã\n\n# leader å follower æ¥å¿ä¸ä¸è´çå¯è½\n\nleader å follower å¯è½å­å¨å¤ç§æ¥å¿ä¸ä¸è´çå¯è½ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n> ä¸å¾éè¿°äº leader å follower å¯è½å­å¨å¤ç§æ¥å¿ä¸ä¸è´çå¯è½ï¼æ¯ä¸ä¸ªæ¹æ¡è¡¨ç¤ºä¸ä¸ªæ¥å¿æ¡ç®ï¼éé¢çæ°å­è¡¨ç¤ºä»»æå· ã\n> \n> å½ä¸ä¸ª leader æåå½éæ¶ï¼follower å¯è½åºç°ä»¥ä¸æåµï¼a-fï¼ï¼\n> \n>  * å­å¨æªæ´æ°æ¥å¿æ¡ç®ï¼å¦ï¼aãbï¼ã\n>  * å­å¨æªæäº¤æ¥å¿æ¡ç®ï¼å¦ï¼cãdï¼ã\n>  * æä¸¤ç§æåµé½å­å¨ï¼å¦ï¼eãfï¼ã\n> \n> ä¾å¦ï¼åºæ¯ f å¯è½ä¼è¿æ ·åçï¼ææå¡å¨å¨ term2 çæ¶åæ¯ leaderï¼å·²éå äºä¸äºæ¥å¿æ¡ç®å°èªå·±çæ¥å¿ä¸­ï¼ä½å¨æäº¤ä¹åå°±å´©æºäºï¼å¾å¿«è¿ä¸ªæºå¨å°±è¢«éå¯äºï¼å¨ term3 éæ°è¢«éä¸º leaderï¼å¹¶ä¸åå¢å äºä¸äºæ¥å¿æ¡ç®å°èªå·±çæ¥å¿ä¸­ï¼å¨ term 2 å term 3 çæ¥å¿è¢«æäº¤ä¹åï¼è¿ä¸ªæå¡å¨åå®æºäºï¼å¹¶ä¸å¨æ¥ä¸æ¥çå ä¸ªä»»æéä¸ç´å¤äºå®æºç¶æã\n\n# leader å follower æ¥å¿ä¸è´çä¿è¯\n\nleader éè¿å¼ºå¶ followers å¤å¶å®çæ¥å¿æ¥å¤çæ¥å¿çä¸ä¸è´ï¼followers ä¸çä¸ä¸è´çæ¥å¿ä¼è¢« leader çæ¥å¿è¦çã\n\n * leader ä¸ºäºä½¿ followers çæ¥å¿åèªå·±çä¸è´ï¼leader éè¦æ¾å° followers åå®çæ¥å¿ä¸è´çå°æ¹ï¼ç¶åè¦ç followers å¨è¯¥ä½ç½®ä¹åçæ¡ç®ã\n * leader ä¼ä»åå¾åè¯ï¼æ¯æ¬¡æ¥å¿æ¡ç®å¤±è´¥åå°è¯åä¸ä¸ªæ¥å¿æ¡ç®ï¼ç´å°æåæ¾å°æ¯ä¸ª follower çæ¥å¿ä¸è´ä½ç¹ï¼ç¶åååéæ¡è¦ç followers å¨è¯¥ä½ç½®ä¹åçæ¡ç®ã\n\n\n# 5. å®å¨æ§\n\nåé¢æè¿°äº raft ç®æ³æ¯å¦ä½éä¸¾ leader åå¤å¶æ¥å¿çã\n\nraft è¿å¢å äºä¸äºéå¶æ¥å®å raft ç®æ³ï¼ä»¥ä¿è¯å®å¨æ§ï¼ä¿è¯äºä»»æ leader å¯¹äºç»å®ç termï¼é½æ¥æäºä¹å term çææè¢«æäº¤çæ¥å¿æ¡ç®ã\n\n\n# 5.1. éä¸¾éå¶\n\næ¥æææ°çå·²æäº¤çæ¥å¿æ¡ç®ç follower ææèµæ ¼æä¸º leaderã\n\nraft ä½¿ç¨æç¥¨çæ¹å¼æ¥é»æ­¢ä¸ä¸ª candidate èµ¢å¾éä¸¾é¤éè¿ä¸ª candidate åå«äºææå·²ç»æäº¤çæ¥å¿æ¡ç®ã candidate ä¸ºäºèµ¢å¾éä¸¾å¿é¡»èç³»éç¾¤ä¸­çå¤§é¨åèç¹ï¼è¿æå³çæ¯ä¸ä¸ªå·²ç»æäº¤çæ¥å¿æ¡ç®å¨è¿äºæå¡å¨èç¹ä¸­è¯å®å­å¨äºè³å°ä¸ä¸ªèç¹ä¸ãå¦æ candidate çæ¥å¿è³å°åå¤§å¤æ°çæå¡å¨èç¹ä¸æ ·æ°ï¼è¿ä¸ªæ°çå®ä¹ä¼å¨ä¸é¢è®¨è®ºï¼ï¼é£ä¹ä»ä¸å®ææäºææå·²ç»æäº¤çæ¥å¿æ¡ç®ã\n\nrequestvote rpc å®ç°äºè¿æ ·çéå¶ï¼requestvote rpc ä¸­åå«äº candidate çæ¥å¿ä¿¡æ¯ï¼ follower ä¼æç»æé£äºæ¥å¿æ²¡æèªå·±æ°çæç¥¨è¯·æ±ã\n\nå¦ä½å¤æ­åªä¸ªæ¥å¿æ¡ç®æ¯è¾æ°ï¼\n\nraft éè¿æ¯è¾ä¸¤ä»½æ¥å¿ä¸­æåä¸æ¡æ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å term æ¥å¤æ­åªä¸ªæ¥å¿æ¯è¾æ°ã\n\n * åå¤æ­ termï¼åªä¸ªæ°å¼å¤§å³ä»£è¡¨åªä¸ªæ¥å¿æ¯è¾æ°ã\n * å¦æ term ç¸åï¼åæ¯è¾ æ¥å¿ç´¢å¼ï¼åªä¸ªæ°å¼å¤§å³ä»£è¡¨åªä¸ªæ¥å¿æ¯è¾æ°ã\n\n\n# 5.2. æäº¤æ§ä»»æçæ¥å¿æ¡ç®\n\nä¸ä¸ªå½å term çæ¥å¿æ¡ç®è¢«å¤å¶å°äºåæ°ä»¥ä¸çæå¡å¨ä¸ï¼leader å°±è®¤ä¸ºå®æ¯å¯ä»¥è¢«æäº¤çãå¦æè¿ä¸ª leader å¨æäº¤æ¥å¿æ¡ç®åå°±ä¸çº¿äºï¼åç»­ç leader å¯è½ä¼è¦çæè¿ä¸ªæ¥å¿æ¡ç®ã\n\n\n\n> ð¡ å¾ç¤ºè¯´æï¼\n> \n> ä¸å¾è§£éäºä¸ºä»ä¹ leader æ æ³å¯¹æ§ term çæ¥å¿æ¡ç®è¿è¡æäº¤ã\n> \n>  * é¶æ®µ (a) ï¼s1 æ¯ leaderï¼ä¸ s1 åå¥æ¥å¿æ¡ç®ä¸º (term 2ï¼æ¥å¿ç´¢å¼ 2ï¼ï¼åªæ s2 å¤å¶äºè¿ä¸ªæ¥å¿æ¡ç®ã\n>  * é¶æ®µ (b)ï¼s1 ä¸çº¿ï¼s5 è¢«éä¸¾ä¸º term3 ç leaderãs5 åå¥æ¥å¿æ¡ç®ä¸º (term 3ï¼æ¥å¿ç´¢å¼ 2ï¼ã\n>  * é¶æ®µ (c)ï¼s5 ä¸çº¿ï¼s1 éæ°ä¸çº¿ï¼å¹¶è¢«éä¸¾ä¸º term4 ç leaderãæ­¤æ¶ï¼term 2 çé£æ¡æ¥å¿æ¡ç®å·²ç»è¢«å¤å¶å°äºéç¾¤ä¸­çå¤§å¤æ°èç¹ä¸ï¼ä½æ¯è¿æ²¡æè¢«æäº¤ã\n>  * é¶æ®µ (d)ï¼s1 åæ¬¡ä¸çº¿ï¼s5 éæ°ä¸çº¿ï¼å¹¶è¢«éæ°éä¸¾ä¸º term3 ç leaderãç¶å s5 è¦çäºæ¥å¿ç´¢å¼ 2 å¤çæ¥å¿ã\n>  * é¶æ®µ (e)ï¼å¦æé¶æ®µ (d) è¿æªåçï¼å³ s1 åæ¬¡ä¸çº¿ä¹åï¼s1 æèªå·±ä¸»å¯¼çæ¥å¿æ¡ç®å¤å¶å°äºå¤§å¤æ°èç¹ä¸ï¼é£ä¹å¨åç»­ term éé¢è¿äºæ°æ¥å¿æ¡ç®å°±ä¼è¢«æäº¤ãè¿æ ·å¨åä¸æ¶å»å°±åæ¶ä¿è¯äºï¼ä¹åçæææ§æ¥å¿æ¡ç®å°±ä¼è¢«æäº¤ã\n\nraft æ°¸è¿ä¸ä¼éè¿è®¡ç®å¯æ¬æ°ç®çæ¹å¼å»æäº¤ä¸ä¸ªä¹å term åçæ¥å¿æ¡ç®ãåªæ leader å½å term éçæ¥å¿æ¡ç®éè¿è®¡ç®å¯æ¬æ°ç®å¯ä»¥è¢«æäº¤ï¼ä¸æ¦å½å term çæ¥å¿æ¡ç®ä»¥è¿ç§æ¹å¼è¢«æäº¤ï¼é£ä¹ç±äºæ¥å¿å¹éç¹æ§ï¼ä¹åçæ¥å¿æ¡ç®ä¹é½ä¼è¢«é´æ¥çæäº¤ã\n\nå½ leader å¤å¶ä¹åä»»æéçæ¥å¿æ¶ï¼raft ä¼ä¸ºæææ¥å¿ä¿çåå§ç termï¼è¿å¨æäº¤è§åä¸äº§çäºé¢å¤çå¤ææ§ãå¨å¶ä»çä¸è´æ§ç®æ³ä¸­ï¼å¦æä¸ä¸ªæ°çé¢å¯¼äººè¦éæ°å¤å¶ä¹åçä»»æéçæ¥å¿æ¶ï¼å®å¿é¡»ä½¿ç¨å½åæ°çä»»æå·ãraft ä½¿ç¨çæ¹æ³æ´å å®¹æè¾¨å«åºæ¥å¿ï¼å ä¸ºå®å¯ä»¥éçæ¶é´åæ¥å¿çååå¯¹æ¥å¿ç»´æ¤çåä¸ä¸ªä»»æç¼å·ãå¦å¤ï¼åå¶ä»çç®æ³ç¸æ¯ï¼raft ä¸­çæ°é¢å¯¼äººåªéè¦åéæ´å°æ¥å¿æ¡ç®ï¼å¶ä»ç®æ³ä¸­å¿é¡»å¨ä»ä»¬è¢«æäº¤ä¹ååéæ´å¤çåä½æ¥å¿æ¡ç®æ¥ä¸ºä»ä»¬éæ°ç¼å·ï¼ã\n\n\n# 6. æ¥å¿åç¼©\n\nå¨å®éçç³»ç»ä¸­ï¼ä¸è½è®©æ¥å¿æ éè¨èï¼å¦åç³»ç»éå¯æ¶éè¦è±å¾é¿çæ¶é´è¿è¡æ¢å¤ï¼ä»èå½±åå¯ç¨æ§ãraft éç¨å¯¹æ´ä¸ªç³»ç»è¿è¡å¿«ç§æ¥è§£å³ï¼å¿«ç§ä¹åçæ¥å¿é½å¯ä»¥ä¸¢å¼ã\n\næ¯ä¸ªå¯æ¬ç¬ç«çå¯¹èªå·±çç³»ç»ç¶æçæå¿«ç§ï¼å¹¶ä¸åªè½å¯¹å·²ç»æäº¤çæ¥å¿æ¡ç®çæå¿«ç§ã\n\nå¿«ç§åå«ä»¥ä¸åå®¹ï¼\n\n * æ¥å¿åæ°æ®ãæåä¸æ¡å·²æäº¤çæ¥å¿æ¡ç®çæ¥å¿ç´¢å¼å termãè¿ä¸¤ä¸ªå¼å¨å¿«ç§ä¹åçç¬¬ä¸æ¡æ¥å¿æ¡ç®ç appendentries rpc çå®æ´æ§æ£æ¥çæ¶åä¼è¢«ç¨ä¸ã\n * ç³»ç»å½åç¶æã\n\nå½ leader è¦åéæä¸ªæ¥å¿æ¡ç®ï¼è½åå¤ªå¤ç follower çæ¥å¿æ¡ç®ä¼è¢«ä¸¢å¼ï¼leader ä¼å°å¿«ç§åç» followerãæèæ°ä¸çº¿ä¸å°æºå¨æ¶ï¼ä¹ä¼åéå¿«ç§ç»å®ã\n\n\n\nçæå¿«ç§çé¢çè¦éä¸­ï¼é¢çè¿é«ä¼æ¶èå¤§é i/o å¸¦å®½ï¼é¢çè¿ä½ï¼ä¸æ¦éè¦æ§è¡æ¢å¤æä½ï¼ä¼ä¸¢å¤±å¤§éæ°æ®ï¼å½±åå¯ç¨æ§ãæ¨èå½æ¥å¿è¾¾å°æä¸ªåºå®çå¤§å°æ¶çæå¿«ç§ã\n\nçæä¸æ¬¡å¿«ç§å¯è½èæ¶è¿é¿ï¼å½±åæ­£å¸¸æ¥å¿åæ­¥ãå¯ä»¥éè¿ä½¿ç¨ copy-on-write ææ¯é¿åå¿«ç§è¿ç¨å½±åæ­£å¸¸æ¥å¿åæ­¥ã\n\n> è¯´æï¼æ¬æä»éè¿° raft ç®æ³çæ ¸å¿åå®¹ï¼ä¸åæ¬ç®æ³è®ºè¯ãè¯ä¼°ç­\n\n\n# 7. åèèµæ\n\n * raft ä¸è´æ§ç®æ³è®ºæåæ\n * raft ä¸è´æ§ç®æ³è®ºæè¯æ\n * raft ä½èè®²è§£è§é¢\n * raft ä½èè®²è§£è§é¢å¯¹åºç ppt\n * åå¸å¼ç³»ç»ç raft ç®æ³\n * raft: understandable distributed consensus - ä¸ä¸ªå¨ç»æç¨\n * the raft consensus algorithm - ä¸ä¸ªäº¤äºå¼å¨ç»æç¨\n * sofa-jraft - èèéæç raft ç®æ³å®ç°åºï¼java çï¼",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼ç®æ³ Gossip",frontmatter:{title:"åå¸å¼ç®æ³ Gossip",categories:["åå¸å¼","åå¸å¼çè®º"],tags:["åå¸å¼","åå¸å¼çè®º","å±è¯æ§","Gossip"],abbrlink:"64f7c861",date:"2021-07-13T09:18:41.000Z",permalink:"/pages/d15993/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/02.%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA/04.%E5%88%86%E5%B8%83%E5%BC%8F%E7%AE%97%E6%B3%95Gossip.html",relativePath:"02.åå¸å¼/02.åå¸å¼çè®º/04.åå¸å¼ç®æ³Gossip.md",key:"v-0bf2fe55",path:"/pages/d15993/",headers:[{level:2,title:"1. åºç¨",slug:"_1-åºç¨",normalizedTitle:"1. åºç¨",charIndex:466},{level:2,title:"2. Gossip åè®®çæ§è¡è¿ç¨",slug:"_2-gossip-åè®®çæ§è¡è¿ç¨",normalizedTitle:"2. gossip åè®®çæ§è¡è¿ç¨",charIndex:616},{level:2,title:"3. Gossip çç¹ç¹",slug:"_3-gossip-çç¹ç¹",normalizedTitle:"3. gossip çç¹ç¹",charIndex:1424},{level:3,title:"3.1. Gossip çä¼ç¹",slug:"_3-1-gossip-çä¼ç¹",normalizedTitle:"3.1. gossip çä¼ç¹",charIndex:1442},{level:3,title:"3.2. Gossip çç¼ºé·",slug:"_3-2-gossip-çç¼ºé·",normalizedTitle:"3.2. gossip çç¼ºé·",charIndex:1782},{level:2,title:"4. Gossip ç±»å",slug:"_4-gossip-ç±»å",normalizedTitle:"4. gossip ç±»å",charIndex:2119},{level:2,title:"5. åèèµæ",slug:"_5-åèèµæ",normalizedTitle:"5. åèèµæ",charIndex:3195}],headersStr:"1. åºç¨ 2. Gossip åè®®çæ§è¡è¿ç¨ 3. Gossip çç¹ç¹ 3.1. Gossip çä¼ç¹ 3.2. Gossip çç¼ºé· 4. Gossip ç±»å 5. åèèµæ",content:"# åå¸å¼ç®æ³ Gossip\n\nGossip ä¹å« Epidemic Protocol ï¼æµè¡çåè®®ï¼ï¼è¿ä¸ªåè®®åºäºæç»ä¸è´æ§ä»¥åå»ä¸­å¿åè®¾è®¡ææ³ãä¸»è¦ç¨äºåå¸å¼èç¹ä¹é´è¿è¡ä¿¡æ¯äº¤æ¢åæ°æ®åæ­¥ï¼è¿ç§åºæ¯çä¸ä¸ªæå¤§ç¹ç¹å°±æ¯ç»æçç½ç»çèç¹é½æ¯å¯¹ç­èç¹ï¼æ¯éç»æåç½ç»ï¼å»ä¸­å¿åï¼ã\n\nGossip åè®®ææ©æ¯å¨ 1987 å¹´åè¡¨å¨ ACM ä¸çè®ºæ ãEpidemic Algorithms for Replicated Database Maintenanceãä¸­è¢«æåºï¼å¶çè®ºåºç¡æ¥æºäºæµè¡çå­¦çæ°å­¦æ¨¡åï¼è¿ç§åºæ¯çä¸ä¸ªæå¤§ç¹ç¹å°±æ¯ç»æçç½ç»çèç¹é½æ¯å»ä¸­å¿åçå¯¹ç­èç¹ï¼å¨ä¿¡æ¯åæ­¥è¿ç¨ä¸­ä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å®ç°æç»ä¸è´æ§åè®®ã\n\nGossip åè®®æ¯éç¾¤ä¸­èç¹ç¸äºéä¿¡çåé¨éä¿¡ææ¯ã Gossip æ¯ä¸ç§é«æãè½»éçº§ãå¯é çèç¹é´å¹¿æ­åè®®ï¼ç¨äºä¼ æ­æ°æ®ãå®æ¯å»ä¸­å¿åçãâæµè¡çâçãå®¹éçåç¹å¯¹ç¹éä¿¡åè®®ã Cassandra ä½¿ç¨å«å¦è¿è¡å¯¹ç­åç°ååæ°æ®ä¼ æ­ã\n\n\n# 1. åºç¨\n\nå¨ CASSANDRA ä¸­ï¼èç¹é´ä½¿ç¨ Gossip åè®®äº¤æ¢ä¿¡æ¯ï¼å æ­¤ææèç¹é½å¯ä»¥å¿«éäºè§£éç¾¤ä¸­çææå¶ä»èç¹ã\n\nConsul ä½¿ç¨åä¸º SERF ç Gossip åè®®æä¸¤ä¸ªä½ç¨ï¼\n\n * åç°æ°èç¹åå®æºçèç¹\n * å¯é ä¸å¿«éçäºä»¶å¹¿æ­ï¼ç¨äºéä¸¾ Leader ç­\n\n\n# 2. Gossip åè®®çæ§è¡è¿ç¨\n\nGossip åè®®å¨æ¦å¿µä¸éå¸¸ç®åï¼ä»£ç ä¹éå¸¸ç®åãå®ä»¬èåçåºæ¬ææ³æ¯ï¼ä¸ä¸ªèç¹æ³è¦ä¸ç½ç»ä¸­çå¶ä»èç¹å±äº«ä¸äºä¿¡æ¯ãç¶åå¨ææ§å°ä»èç¹éä¸­éæºéæ©ä¸ä¸ªèç¹å¹¶äº¤æ¢ä¿¡æ¯ãæ¥æ¶ä¿¡æ¯çèç¹ååæ ·çäºæãä¿¡æ¯å®æåéå° N ä¸ªç®æ ï¼N ç§°ä¸ºæåºï¼Fanoutï¼ã\n\nå¾ªç¯ï¼ä¼ æ­ä¿¡æ¯çååæ° æåºï¼ä¸ä¸ªèç¹å¨æ¯ä¸ªå¾ªç¯ä¸­é²èçèç¹æ°ãå½ä¸ä¸ªèç¹æ³è¦å¹¿æ­ä¸æ¡æ¶æ¯æ¶ï¼å®ä»ç³»ç»ä¸­éæºéæ© t ä¸ªèç¹å¹¶å°æ¶æ¯åéç»å®ä»¬ã\n\nGossip åè®®çæ§è¡è¿ç¨ï¼\n\nGossip è¿ç¨æ¯ç±ç§å­èç¹åèµ·ï¼å½ä¸ä¸ªç§å­èç¹æç¶æéè¦æ´æ°å°ç½ç»ä¸­çå¶ä»èç¹æ¶ï¼å®ä¼éæºçéæ©å¨å´å ä¸ªèç¹æ£æ­æ¶æ¯ï¼æ¶å°æ¶æ¯çèç¹ä¹ä¼éå¤è¯¥è¿ç¨ï¼ç´è³æç»ç½ç»ä¸­ææçèç¹é½æ¶å°äºæ¶æ¯ãè¿ä¸ªè¿ç¨å¯è½éè¦ä¸å®çæ¶é´ï¼ç±äºä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å æ­¤å®æ¯ä¸ä¸ªæç»ä¸è´æ§åè®®ã\n\nä¸ºäºè¡¨è¿°æ¸æ¥ï¼æä»¬ååä¸äºåæè®¾å®\n\n * ç§å­èç¹å¨ææ§çæ£æ­æ¶æ¯ï¼æå¨æéå®ä¸º 1 ç§\n * è¢«ææèç¹éæºéæ© N ä¸ªé»æ¥èç¹ï¼fan-outï¼æ£æ­æ¶æ¯ï¼è¿éæ fan-out è®¾ç½®ä¸º 3ï¼æ¯æ¬¡æå¤å¾ 3 ä¸ªèç¹æ£æ­ã\n * èç¹åªæ¥æ¶æ¶æ¯ä¸åé¦ç»æã\n * æ¯æ¬¡æ£æ­æ¶æ¯é½éæ©å°æªåéè¿çèç¹è¿è¡æ£æ­\n * æ¶å°æ¶æ¯çèç¹ä¸åå¾åéèç¹æ£æ­ï¼æ¯å¦ A -> Bï¼é£ä¹ B è¿è¡æ£æ­çæ¶åï¼ä¸ååç» Aã\n\næ³¨æï¼Gossip è¿ç¨æ¯å¼æ­¥çï¼ä¹å°±æ¯è¯´åæ¶æ¯çèç¹ä¸ä¼å³æ³¨å¯¹æ¹æ¯å¦æ¶å°ï¼å³ä¸ç­å¾ååºï¼ä¸ç®¡å¯¹æ¹ææ²¡ææ¶å°ï¼å®é½ä¼æ¯é 1 ç§åå¨å´èç¹åæ¶æ¯ãå¼æ­¥æ¯å®çä¼ç¹ï¼èæ¶æ¯åä½åæ¯å®çç¼ºç¹ã\n\nGoosip åè®®çä¿¡æ¯ä¼ æ­åæ©æ£éå¸¸éè¦ç±ç§å­èç¹åèµ·ãæ´ä¸ªä¼ æ­è¿ç¨å¯è½éè¦ä¸å®çæ¶é´ï¼ç±äºä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å æ­¤å®æ¯ä¸ä¸ªæç»ä¸è´æ§åè®®ã\n\n\n\n\n# 3. Gossip çç¹ç¹\n\n\n# 3.1. Gossip çä¼ç¹\n\n * æ©å±æ§ï¼ç½ç»å¯ä»¥åè®¸èç¹çä»»æå¢å ååå°ï¼æ°å¢å çèç¹çç¶ææç»ä¼ä¸å¶ä»èç¹ä¸è´ã\n * å®¹éï¼ç½ç»ä¸­ä»»ä½èç¹çå®æºåéå¯é½ä¸ä¼å½±å Gossip æ¶æ¯çä¼ æ­ï¼Gossip åè®®å·æå¤©ç¶çåå¸å¼ç³»ç»å®¹éç¹æ§ã\n * å»ä¸­å¿åï¼Gossip åè®®ä¸è¦æ±ä»»ä½ä¸­å¿èç¹ï¼ææèç¹é½å¯ä»¥æ¯å¯¹ç­çï¼ä»»ä½ä¸ä¸ªèç¹æ éç¥éæ´ä¸ªç½ç»ç¶åµï¼åªè¦ç½ç»æ¯è¿éçï¼ä»»æä¸ä¸ªèç¹å°±å¯ä»¥ææ¶æ¯æ£æ­å°å¨ç½ã\n * ä¸è´æ§æ¶æï¼Gossip åè®®ä¸­çæ¶æ¯ä¼ä»¥ä¸ä¼ åãåä¼ ç¾ä¸æ ·çææ°çº§éåº¦å¨ç½ç»ä¸­å¿«éä¼ æ­ï¼å æ­¤ç³»ç»ç¶æçä¸ä¸è´å¯ä»¥å¨å¾å¿«çæ¶é´åæ¶æå°ä¸è´ãæ¶æ¯ä¼ æ­éåº¦è¾¾å°äº logNã\n * ç®åï¼Gossip åè®®çè¿ç¨æå¶ç®åï¼å®ç°èµ·æ¥å ä¹æ²¡æå¤ªå¤å¤ææ§ã\n\n\n# 3.2. Gossip çç¼ºé·\n\nåå¸å¼ç½ç»ä¸­ï¼æ²¡æä¸ç§å®ç¾çè§£å³æ¹æ¡ï¼Gossip åè®®è·å¶ä»åè®®ä¸æ ·ï¼ä¹æä¸äºä¸å¯é¿åçç¼ºé·ï¼ä¸»è¦æ¯ä¸¤ä¸ªï¼\n\n * æ¶æ¯çå»¶è¿ï¼ç±äº Gossip åè®®ä¸­ï¼èç¹åªä¼éæºåå°æ°å ä¸ªèç¹åéæ¶æ¯ï¼æ¶æ¯æç»æ¯éè¿å¤ä¸ªè½®æ¬¡çæ£æ­èå°è¾¾å¨ç½çï¼å æ­¤ä½¿ç¨ Gossip åè®®ä¼é æä¸å¯é¿åçæ¶æ¯å»¶è¿ãä¸éåç¨å¨å¯¹å®æ¶æ§è¦æ±è¾é«çåºæ¯ä¸ã\n * æ¶æ¯åä½ï¼Gossip åè®®è§å®ï¼èç¹ä¼å®æéæºéæ©å¨å´èç¹åéæ¶æ¯ï¼èæ¶å°æ¶æ¯çèç¹ä¹ä¼éå¤è¯¥æ­¥éª¤ï¼å æ­¤å°±ä¸å¯é¿åçå­å¨æ¶æ¯éå¤åéç»åä¸èç¹çæåµï¼é æäºæ¶æ¯çåä½ï¼åæ¶ä¹å¢å äºæ¶å°æ¶æ¯çèç¹çå¤çååãèä¸ï¼ç±äºæ¯å®æåéï¼å æ­¤ï¼å³ä½¿æ¶å°äºæ¶æ¯çèç¹è¿ä¼åå¤æ¶å°éå¤æ¶æ¯ï¼å éäºæ¶æ¯çåä½ã\n\n\n# 4. Gossip ç±»å\n\nGossip æä¸¤ç§ç±»åï¼\n\n * Anti-Entropy(åçµ)ï¼ä»¥åºå®çæ¦çä¼ æ­ææçæ°æ®ãAnti-Entropy æ¯ SI modelï¼èç¹åªæä¸¤ç§ç¶æï¼Suspective å Infectiveï¼å«å simple epidemicsã\n * Rumor-Mongering(è°£è¨ä¼ æ­)ï¼ä»ä¼ æ­æ°å°è¾¾çæ°æ®ãRumor-Mongering æ¯ SIR modelï¼èç¹æä¸ç§ç¶æï¼Suspectiveï¼Infective å Removedï¼å«å complex epidemicsã\n\nçµæ¯ç©çå­¦ä¸çä¸ä¸ªæ¦å¿µï¼ä»£è¡¨æä¹±æ ç« ï¼èåçµå°±æ¯å¨æä¹±æ ç« ä¸­å¯»æ±ä¸è´ã\n\nå¨ SI model ä¸ï¼ä¸ä¸ªèç¹ä¼æææçæ°æ®é½è·å¶ä»èç¹å±äº«ï¼ä»¥ä¾¿æ¶é¤èç¹ä¹é´æ°æ®çä»»ä½ä¸ä¸è´ï¼å®å¯ä»¥ä¿è¯æç»ãå®å¨çä¸è´ã\n\nç±äºå¨ SI model ä¸æ¶æ¯ä¼ä¸æ­åå¤çäº¤æ¢ï¼å æ­¤æ¶æ¯æ°éæ¯éå¸¸åºå¤§çï¼æ éå¶çï¼unboundedï¼ï¼è¿å¯¹ä¸ä¸ªç³»ç»æ¥è¯´æ¯ä¸ä¸ªå·¨å¤§çå¼éã\n\nä½æ¯å¨ Rumor Mongeringï¼SIR Modelï¼ æ¨¡åä¸ï¼æ¶æ¯å¯ä»¥åéå¾æ´é¢ç¹ï¼å ä¸ºæ¶æ¯åªåå«ææ° updateï¼ä½ç§¯æ´å°ãèä¸ï¼ä¸ä¸ª Rumor æ¶æ¯å¨æä¸ªæ¶é´ç¹ä¹åä¼è¢«æ è®°ä¸º removedï¼å¹¶ä¸ä¸åè¢«ä¼ æ­ï¼å æ­¤ï¼SIR model ä¸ï¼ç³»ç»æä¸å®çæ¦çä¼ä¸ä¸è´ã\n\nèç±äºï¼SIR Model ä¸æä¸ªæ¶é´ç¹ä¹åæ¶æ¯ä¸åä¼ æ­ï¼å æ­¤æ¶æ¯æ¯æéçï¼ç³»ç»å¼éå°ã\n\nä¸è¬æ¥è¯´ï¼ä¸ºäºå¨éä¿¡ä»£ä»·åå¯é æ§ä¹é´åå¾æä¸­ï¼éè¦å°è¿ä¸¤ç§æ¹æ³ç»åä½¿ç¨ã\n\nGossip ä¸­çéä¿¡æ¨¡å¼\n\nå¨ Gossip åè®®ä¸ï¼ç½ç»ä¸­ä¸¤ä¸ªèç¹ä¹é´æä¸ç§éä¿¡æ¹å¼:\n\n * Push: èç¹ A å°æ°æ® (key,value,version) åå¯¹åºççæ¬å·æ¨éç» B èç¹ï¼B èç¹æ´æ° A ä¸­æ¯èªå·±æ°çæ°æ®\n * Pullï¼A ä»å°æ°æ® key, version æ¨éç» Bï¼B å°æ¬å°æ¯ A æ°çæ°æ®ï¼Key, value, versionï¼æ¨éç» Aï¼A æ´æ°æ¬å°\n * Push/Pullï¼ä¸ Pull ç±»ä¼¼ï¼åªæ¯å¤äºä¸æ­¥ï¼A åå°æ¬å°æ¯ B æ°çæ°æ®æ¨éç» Bï¼B åæ´æ°æ¬å°\n\nå¦ææä¸¤ä¸ªèç¹æ°æ®åæ­¥ä¸æ¬¡å®ä¹ä¸ºä¸ä¸ªå¨æï¼åå¨ä¸ä¸ªå¨æåï¼Push ééä¿¡ 1 æ¬¡ï¼Pull é 2 æ¬¡ï¼Push/Pull åé 3 æ¬¡ãè½ç¶æ¶æ¯æ°å¢å äºï¼ä½ä»ææä¸æ¥è®²ï¼Push/Pull æå¥½ï¼çè®ºä¸ä¸ä¸ªå¨æåå¯ä»¥ä½¿ä¸¤ä¸ªèç¹å®å¨ä¸è´ãç´è§ä¸ï¼Push/Pull çæ¶æéåº¦ä¹æ¯æå¿«çã\n\n\n# 5. åèèµæ\n\n * Epidemic Algorithms for Replicated Database Maintenance\n * P2P ç½ç»æ ¸å¿ææ¯ï¼Gossip åè®®\n * INTRODUCTION TO GOSSIP\n * Goosip åè®®ä»¿çå¨ç»",normalizedContent:"# åå¸å¼ç®æ³ gossip\n\ngossip ä¹å« epidemic protocol ï¼æµè¡çåè®®ï¼ï¼è¿ä¸ªåè®®åºäºæç»ä¸è´æ§ä»¥åå»ä¸­å¿åè®¾è®¡ææ³ãä¸»è¦ç¨äºåå¸å¼èç¹ä¹é´è¿è¡ä¿¡æ¯äº¤æ¢åæ°æ®åæ­¥ï¼è¿ç§åºæ¯çä¸ä¸ªæå¤§ç¹ç¹å°±æ¯ç»æçç½ç»çèç¹é½æ¯å¯¹ç­èç¹ï¼æ¯éç»æåç½ç»ï¼å»ä¸­å¿åï¼ã\n\ngossip åè®®ææ©æ¯å¨ 1987 å¹´åè¡¨å¨ acm ä¸çè®ºæ ãepidemic algorithms for replicated database maintenanceãä¸­è¢«æåºï¼å¶çè®ºåºç¡æ¥æºäºæµè¡çå­¦çæ°å­¦æ¨¡åï¼è¿ç§åºæ¯çä¸ä¸ªæå¤§ç¹ç¹å°±æ¯ç»æçç½ç»çèç¹é½æ¯å»ä¸­å¿åçå¯¹ç­èç¹ï¼å¨ä¿¡æ¯åæ­¥è¿ç¨ä¸­ä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å®ç°æç»ä¸è´æ§åè®®ã\n\ngossip åè®®æ¯éç¾¤ä¸­èç¹ç¸äºéä¿¡çåé¨éä¿¡ææ¯ã gossip æ¯ä¸ç§é«æãè½»éçº§ãå¯é çèç¹é´å¹¿æ­åè®®ï¼ç¨äºä¼ æ­æ°æ®ãå®æ¯å»ä¸­å¿åçãâæµè¡çâçãå®¹éçåç¹å¯¹ç¹éä¿¡åè®®ã cassandra ä½¿ç¨å«å¦è¿è¡å¯¹ç­åç°ååæ°æ®ä¼ æ­ã\n\n\n# 1. åºç¨\n\nå¨ cassandra ä¸­ï¼èç¹é´ä½¿ç¨ gossip åè®®äº¤æ¢ä¿¡æ¯ï¼å æ­¤ææèç¹é½å¯ä»¥å¿«éäºè§£éç¾¤ä¸­çææå¶ä»èç¹ã\n\nconsul ä½¿ç¨åä¸º serf ç gossip åè®®æä¸¤ä¸ªä½ç¨ï¼\n\n * åç°æ°èç¹åå®æºçèç¹\n * å¯é ä¸å¿«éçäºä»¶å¹¿æ­ï¼ç¨äºéä¸¾ leader ç­\n\n\n# 2. gossip åè®®çæ§è¡è¿ç¨\n\ngossip åè®®å¨æ¦å¿µä¸éå¸¸ç®åï¼ä»£ç ä¹éå¸¸ç®åãå®ä»¬èåçåºæ¬ææ³æ¯ï¼ä¸ä¸ªèç¹æ³è¦ä¸ç½ç»ä¸­çå¶ä»èç¹å±äº«ä¸äºä¿¡æ¯ãç¶åå¨ææ§å°ä»èç¹éä¸­éæºéæ©ä¸ä¸ªèç¹å¹¶äº¤æ¢ä¿¡æ¯ãæ¥æ¶ä¿¡æ¯çèç¹ååæ ·çäºæãä¿¡æ¯å®æåéå° n ä¸ªç®æ ï¼n ç§°ä¸ºæåºï¼fanoutï¼ã\n\nå¾ªç¯ï¼ä¼ æ­ä¿¡æ¯çååæ° æåºï¼ä¸ä¸ªèç¹å¨æ¯ä¸ªå¾ªç¯ä¸­é²èçèç¹æ°ãå½ä¸ä¸ªèç¹æ³è¦å¹¿æ­ä¸æ¡æ¶æ¯æ¶ï¼å®ä»ç³»ç»ä¸­éæºéæ© t ä¸ªèç¹å¹¶å°æ¶æ¯åéç»å®ä»¬ã\n\ngossip åè®®çæ§è¡è¿ç¨ï¼\n\ngossip è¿ç¨æ¯ç±ç§å­èç¹åèµ·ï¼å½ä¸ä¸ªç§å­èç¹æç¶æéè¦æ´æ°å°ç½ç»ä¸­çå¶ä»èç¹æ¶ï¼å®ä¼éæºçéæ©å¨å´å ä¸ªèç¹æ£æ­æ¶æ¯ï¼æ¶å°æ¶æ¯çèç¹ä¹ä¼éå¤è¯¥è¿ç¨ï¼ç´è³æç»ç½ç»ä¸­ææçèç¹é½æ¶å°äºæ¶æ¯ãè¿ä¸ªè¿ç¨å¯è½éè¦ä¸å®çæ¶é´ï¼ç±äºä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å æ­¤å®æ¯ä¸ä¸ªæç»ä¸è´æ§åè®®ã\n\nä¸ºäºè¡¨è¿°æ¸æ¥ï¼æä»¬ååä¸äºåæè®¾å®\n\n * ç§å­èç¹å¨ææ§çæ£æ­æ¶æ¯ï¼æå¨æéå®ä¸º 1 ç§\n * è¢«ææèç¹éæºéæ© n ä¸ªé»æ¥èç¹ï¼fan-outï¼æ£æ­æ¶æ¯ï¼è¿éæ fan-out è®¾ç½®ä¸º 3ï¼æ¯æ¬¡æå¤å¾ 3 ä¸ªèç¹æ£æ­ã\n * èç¹åªæ¥æ¶æ¶æ¯ä¸åé¦ç»æã\n * æ¯æ¬¡æ£æ­æ¶æ¯é½éæ©å°æªåéè¿çèç¹è¿è¡æ£æ­\n * æ¶å°æ¶æ¯çèç¹ä¸åå¾åéèç¹æ£æ­ï¼æ¯å¦ a -> bï¼é£ä¹ b è¿è¡æ£æ­çæ¶åï¼ä¸ååç» aã\n\næ³¨æï¼gossip è¿ç¨æ¯å¼æ­¥çï¼ä¹å°±æ¯è¯´åæ¶æ¯çèç¹ä¸ä¼å³æ³¨å¯¹æ¹æ¯å¦æ¶å°ï¼å³ä¸ç­å¾ååºï¼ä¸ç®¡å¯¹æ¹ææ²¡ææ¶å°ï¼å®é½ä¼æ¯é 1 ç§åå¨å´èç¹åæ¶æ¯ãå¼æ­¥æ¯å®çä¼ç¹ï¼èæ¶æ¯åä½åæ¯å®çç¼ºç¹ã\n\ngoosip åè®®çä¿¡æ¯ä¼ æ­åæ©æ£éå¸¸éè¦ç±ç§å­èç¹åèµ·ãæ´ä¸ªä¼ æ­è¿ç¨å¯è½éè¦ä¸å®çæ¶é´ï¼ç±äºä¸è½ä¿è¯æä¸ªæ¶å»ææèç¹é½æ¶å°æ¶æ¯ï¼ä½æ¯çè®ºä¸æç»ææèç¹é½ä¼æ¶å°æ¶æ¯ï¼å æ­¤å®æ¯ä¸ä¸ªæç»ä¸è´æ§åè®®ã\n\n\n\n\n# 3. gossip çç¹ç¹\n\n\n# 3.1. gossip çä¼ç¹\n\n * æ©å±æ§ï¼ç½ç»å¯ä»¥åè®¸èç¹çä»»æå¢å ååå°ï¼æ°å¢å çèç¹çç¶ææç»ä¼ä¸å¶ä»èç¹ä¸è´ã\n * å®¹éï¼ç½ç»ä¸­ä»»ä½èç¹çå®æºåéå¯é½ä¸ä¼å½±å gossip æ¶æ¯çä¼ æ­ï¼gossip åè®®å·æå¤©ç¶çåå¸å¼ç³»ç»å®¹éç¹æ§ã\n * å»ä¸­å¿åï¼gossip åè®®ä¸è¦æ±ä»»ä½ä¸­å¿èç¹ï¼ææèç¹é½å¯ä»¥æ¯å¯¹ç­çï¼ä»»ä½ä¸ä¸ªèç¹æ éç¥éæ´ä¸ªç½ç»ç¶åµï¼åªè¦ç½ç»æ¯è¿éçï¼ä»»æä¸ä¸ªèç¹å°±å¯ä»¥ææ¶æ¯æ£æ­å°å¨ç½ã\n * ä¸è´æ§æ¶æï¼gossip åè®®ä¸­çæ¶æ¯ä¼ä»¥ä¸ä¼ åãåä¼ ç¾ä¸æ ·çææ°çº§éåº¦å¨ç½ç»ä¸­å¿«éä¼ æ­ï¼å æ­¤ç³»ç»ç¶æçä¸ä¸è´å¯ä»¥å¨å¾å¿«çæ¶é´åæ¶æå°ä¸è´ãæ¶æ¯ä¼ æ­éåº¦è¾¾å°äº lognã\n * ç®åï¼gossip åè®®çè¿ç¨æå¶ç®åï¼å®ç°èµ·æ¥å ä¹æ²¡æå¤ªå¤å¤ææ§ã\n\n\n# 3.2. gossip çç¼ºé·\n\nåå¸å¼ç½ç»ä¸­ï¼æ²¡æä¸ç§å®ç¾çè§£å³æ¹æ¡ï¼gossip åè®®è·å¶ä»åè®®ä¸æ ·ï¼ä¹æä¸äºä¸å¯é¿åçç¼ºé·ï¼ä¸»è¦æ¯ä¸¤ä¸ªï¼\n\n * æ¶æ¯çå»¶è¿ï¼ç±äº gossip åè®®ä¸­ï¼èç¹åªä¼éæºåå°æ°å ä¸ªèç¹åéæ¶æ¯ï¼æ¶æ¯æç»æ¯éè¿å¤ä¸ªè½®æ¬¡çæ£æ­èå°è¾¾å¨ç½çï¼å æ­¤ä½¿ç¨ gossip åè®®ä¼é æä¸å¯é¿åçæ¶æ¯å»¶è¿ãä¸éåç¨å¨å¯¹å®æ¶æ§è¦æ±è¾é«çåºæ¯ä¸ã\n * æ¶æ¯åä½ï¼gossip åè®®è§å®ï¼èç¹ä¼å®æéæºéæ©å¨å´èç¹åéæ¶æ¯ï¼èæ¶å°æ¶æ¯çèç¹ä¹ä¼éå¤è¯¥æ­¥éª¤ï¼å æ­¤å°±ä¸å¯é¿åçå­å¨æ¶æ¯éå¤åéç»åä¸èç¹çæåµï¼é æäºæ¶æ¯çåä½ï¼åæ¶ä¹å¢å äºæ¶å°æ¶æ¯çèç¹çå¤çååãèä¸ï¼ç±äºæ¯å®æåéï¼å æ­¤ï¼å³ä½¿æ¶å°äºæ¶æ¯çèç¹è¿ä¼åå¤æ¶å°éå¤æ¶æ¯ï¼å éäºæ¶æ¯çåä½ã\n\n\n# 4. gossip ç±»å\n\ngossip æä¸¤ç§ç±»åï¼\n\n * anti-entropy(åçµ)ï¼ä»¥åºå®çæ¦çä¼ æ­ææçæ°æ®ãanti-entropy æ¯ si modelï¼èç¹åªæä¸¤ç§ç¶æï¼suspective å infectiveï¼å«å simple epidemicsã\n * rumor-mongering(è°£è¨ä¼ æ­)ï¼ä»ä¼ æ­æ°å°è¾¾çæ°æ®ãrumor-mongering æ¯ sir modelï¼èç¹æä¸ç§ç¶æï¼suspectiveï¼infective å removedï¼å«å complex epidemicsã\n\nçµæ¯ç©çå­¦ä¸çä¸ä¸ªæ¦å¿µï¼ä»£è¡¨æä¹±æ ç« ï¼èåçµå°±æ¯å¨æä¹±æ ç« ä¸­å¯»æ±ä¸è´ã\n\nå¨ si model ä¸ï¼ä¸ä¸ªèç¹ä¼æææçæ°æ®é½è·å¶ä»èç¹å±äº«ï¼ä»¥ä¾¿æ¶é¤èç¹ä¹é´æ°æ®çä»»ä½ä¸ä¸è´ï¼å®å¯ä»¥ä¿è¯æç»ãå®å¨çä¸è´ã\n\nç±äºå¨ si model ä¸æ¶æ¯ä¼ä¸æ­åå¤çäº¤æ¢ï¼å æ­¤æ¶æ¯æ°éæ¯éå¸¸åºå¤§çï¼æ éå¶çï¼unboundedï¼ï¼è¿å¯¹ä¸ä¸ªç³»ç»æ¥è¯´æ¯ä¸ä¸ªå·¨å¤§çå¼éã\n\nä½æ¯å¨ rumor mongeringï¼sir modelï¼ æ¨¡åä¸ï¼æ¶æ¯å¯ä»¥åéå¾æ´é¢ç¹ï¼å ä¸ºæ¶æ¯åªåå«ææ° updateï¼ä½ç§¯æ´å°ãèä¸ï¼ä¸ä¸ª rumor æ¶æ¯å¨æä¸ªæ¶é´ç¹ä¹åä¼è¢«æ è®°ä¸º removedï¼å¹¶ä¸ä¸åè¢«ä¼ æ­ï¼å æ­¤ï¼sir model ä¸ï¼ç³»ç»æä¸å®çæ¦çä¼ä¸ä¸è´ã\n\nèç±äºï¼sir model ä¸æä¸ªæ¶é´ç¹ä¹åæ¶æ¯ä¸åä¼ æ­ï¼å æ­¤æ¶æ¯æ¯æéçï¼ç³»ç»å¼éå°ã\n\nä¸è¬æ¥è¯´ï¼ä¸ºäºå¨éä¿¡ä»£ä»·åå¯é æ§ä¹é´åå¾æä¸­ï¼éè¦å°è¿ä¸¤ç§æ¹æ³ç»åä½¿ç¨ã\n\ngossip ä¸­çéä¿¡æ¨¡å¼\n\nå¨ gossip åè®®ä¸ï¼ç½ç»ä¸­ä¸¤ä¸ªèç¹ä¹é´æä¸ç§éä¿¡æ¹å¼:\n\n * push: èç¹ a å°æ°æ® (key,value,version) åå¯¹åºççæ¬å·æ¨éç» b èç¹ï¼b èç¹æ´æ° a ä¸­æ¯èªå·±æ°çæ°æ®\n * pullï¼a ä»å°æ°æ® key, version æ¨éç» bï¼b å°æ¬å°æ¯ a æ°çæ°æ®ï¼key, value, versionï¼æ¨éç» aï¼a æ´æ°æ¬å°\n * push/pullï¼ä¸ pull ç±»ä¼¼ï¼åªæ¯å¤äºä¸æ­¥ï¼a åå°æ¬å°æ¯ b æ°çæ°æ®æ¨éç» bï¼b åæ´æ°æ¬å°\n\nå¦ææä¸¤ä¸ªèç¹æ°æ®åæ­¥ä¸æ¬¡å®ä¹ä¸ºä¸ä¸ªå¨æï¼åå¨ä¸ä¸ªå¨æåï¼push ééä¿¡ 1 æ¬¡ï¼pull é 2 æ¬¡ï¼push/pull åé 3 æ¬¡ãè½ç¶æ¶æ¯æ°å¢å äºï¼ä½ä»ææä¸æ¥è®²ï¼push/pull æå¥½ï¼çè®ºä¸ä¸ä¸ªå¨æåå¯ä»¥ä½¿ä¸¤ä¸ªèç¹å®å¨ä¸è´ãç´è§ä¸ï¼push/pull çæ¶æéåº¦ä¹æ¯æå¿«çã\n\n\n# 5. åèèµæ\n\n * epidemic algorithms for replicated database maintenance\n * p2p ç½ç»æ ¸å¿ææ¯ï¼gossip åè®®\n * introduction to gossip\n * goosip åè®®ä»¿çå¨ç»",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æµéæ§å¶",frontmatter:{title:"æµéæ§å¶",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æµéè°åº¦"],tags:["åå¸å¼","æµéè°åº¦","æµéæ§å¶","éæµ","çæ­","éçº§"],abbrlink:"2a553090",date:"2020-01-20T11:06:00.000Z",permalink:"/pages/282676/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/01.%E6%B5%81%E9%87%8F%E8%B0%83%E5%BA%A6/01.%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/01.æµéæ§å¶.md",key:"v-1cd4c4a0",path:"/pages/282676/",headers:[{level:2,title:"1. éæµç®ä»",slug:"_1-éæµç®ä»",normalizedTitle:"1. éæµç®ä»",charIndex:76},{level:2,title:"2. éæµç®æ³",slug:"_2-éæµç®æ³",normalizedTitle:"2. éæµç®æ³",charIndex:277},{level:3,title:"2.1. è®¡æ°å¨æ³",slug:"_2-1-è®¡æ°å¨æ³",normalizedTitle:"2.1. è®¡æ°å¨æ³",charIndex:289},{level:3,title:"2.2. æ»å¨çªå£æ³",slug:"_2-2-æ»å¨çªå£æ³",normalizedTitle:"2.2. æ»å¨çªå£æ³",charIndex:1873},{level:3,title:"2.3. æ¼æ¡¶æ³",slug:"_2-3-æ¼æ¡¶æ³",normalizedTitle:"2.3. æ¼æ¡¶æ³",charIndex:5061},{level:3,title:"2.4. ä»¤çæ¡¶æ³",slug:"_2-4-ä»¤çæ¡¶æ³",normalizedTitle:"2.4. ä»¤çæ¡¶æ³",charIndex:5939},{level:2,title:"3. éæµå·¥å·",slug:"_3-éæµå·¥å·",normalizedTitle:"3. éæµå·¥å·",charIndex:8224},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:8445}],headersStr:"1. éæµç®ä» 2. éæµç®æ³ 2.1. è®¡æ°å¨æ³ 2.2. æ»å¨çªå£æ³ 2.3. æ¼æ¡¶æ³ 2.4. ä»¤çæ¡¶æ³ 3. éæµå·¥å· 4. åèèµæ",content:'# æµéæ§å¶\n\n> å¨é«å¹¶ååºæ¯ä¸ï¼ä¸ºäºåºå¯¹ç¬æ¶æµ·éè¯·æ±çååï¼ä¿éç³»ç»çå¹³ç¨³è¿è¡ï¼å¿é¡»é¢ä¼°ç³»ç»çæµééå¼ï¼éè¿éæµè§åé»æ­å¤çä¸è¿æ¥çè¯·æ±ã\n\n\n# 1. éæµç®ä»\n\néæµå¯ä»¥è®¤ä¸ºæ¯æå¡éçº§çä¸ç§ãéæµå°±æ¯éå¶ç³»ç»çè¾å¥åè¾åºæµéå·²è¾¾å°ä¿æ¤ç³»ç»çç®çãä¸è¬æ¥è¯´ç³»ç»çååéæ¯å¯ä»¥è¢«æµç®çï¼ä¸ºäºä¿è¯ç³»ç»çç¨³å®è¿è¡ï¼ä¸æ¦è¾¾å°çéè¦éå¶çéå¼ï¼å°±éè¦éå¶æµéå¹¶éåä¸äºæªæ½ä»¥å®æéå¶æµéçç®çãæ¯å¦ï¼å»¶è¿å¤çï¼æç»å¤çï¼æèé¨åæç»å¤çç­ç­ã\n\néæµè§ååå«ä¸ä¸ªé¨åï¼æ¶é´ç²åº¦ï¼æ¥å£ç²åº¦ï¼æå¤§éæµå¼ãéæµè§åè®¾ç½®æ¯å¦åçç´æ¥å½±åå°éæµæ¯å¦åçææã\n\n\n# 2. éæµç®æ³\n\n\n# 2.1. è®¡æ°å¨æ³\n\n\n\nè®¡æ°å¨æ³çåçæ¯ï¼è®¾ç½®ä¸ä¸ªè®¡æ°å¨ï¼ç¨äºç»è®¡æå®æ¶é´æ®µåçè¯·æ±æ°éï¼å¹¶å¨æå®æ¶é´æ®µä¹åéç½®è®¡æ°å¨ãå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æè¯·æ±éè¶è¿éå®çéå¼ï¼åæç»è¯·æ±ã\n\nè¿ç§ç®æ³çç¼ºé·æ¯ï¼è¿ç§ç®æ³æ¯éå¯¹ä¸ä¸ªæ¶é´æ®µè¿è¡ç»è®¡ï¼å¦æè¯·æ±åå¸ä¸ååï¼æç«¯æåµä¸ï¼ææè¯·æ±é½å¨æä¸å»æ¶å°ï¼è¿æ¯å¯è½åå®ç³»ç»ãä¾å¦ï¼åè®¾æä»¬éæµè§åä¸ºæ¯ç§éä¸è¶è¿ 100 æ¬¡æ¥å£è¯·æ±ï¼ç¬¬ä¸ä¸ª 1s æ¶é´çªå£åï¼100 æ¬¡æ¥å£è¯·æ±é½éä¸­å¨æåç 10ms åï¼å¨ç¬¬äºä¸ª 1s çæ¶é´çªå£åï¼100 æ¬¡æ¥å£è¯·æ±é½éä¸­å¨æå¼å§ç 10ms åï¼è½ç¶ä¸¤ä¸ªæ¶é´çªå£åæµéé½ç¬¦åéæµè¦æ±ï¼ä½æ¯å¨è¿ä¸¤ä¸ªæ¶é´çªå£ä¸´çç 20ms åä¼éä¸­æ 200 æ¬¡æ¥å£è¯·æ±ï¼å¦æä¸åéæµï¼éä¸­å¨è¿ 20ms åç 200 æ¬¡è¯·æ±å°±æå¯è½åå®ç³»ç»ã\n\nãç¤ºä¾ãä½¿ç¨ AtomicInteger å®ç°è®¡æ°å¨æ³\n\npublic class Counter {\n    /**\n     * æå¤§è®¿é®æ°é\n     */\n    private final int limit = 10;\n    /**\n     * è®¿é®æ¶é´å·®\n     */\n    private final long timeout = 1000;\n    /**\n     * è¯·æ±æ¶é´\n     */\n    private long time;\n    /**\n     * å½åè®¡æ°å¨\n     */\n    private AtomicInteger reqCount = new AtomicInteger(0);\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n        if (now < time + timeout) {\n            // åä½æ¶é´å\n            reqCount.addAndGet(1);\n            return reqCount.get() <= limit;\n        } else {\n            // è¶åºåä½æ¶é´\n            time = now;\n            reqCount = new AtomicInteger(0);\n            return true;\n        }\n    }\n}\n\n\nãç¤ºä¾ãåºäº Redis Lua è®¡æ°éæµç®æ³çå®ç°\n\n-- å®ç°åç\n-- æ¯æ¬¡è¯·æ±é½å°å½åæ¶é´ï¼ç²¾ç¡®å°ç§ä½ä¸º key æ¾å¥ Redis ä¸­ï¼è¶æ¶æ¶é´è®¾ç½®ä¸º 2sï¼ Redis å°è¯¥ key çå¼è¿è¡èªå¢\n-- å½è¾¾å°éå¼æ¶è¿åéè¯¯ï¼è¡¨ç¤ºè¯·æ±è¢«éæµ\n-- åå¥ Redis çæä½ç¨ Lua èæ¬æ¥å®æï¼å©ç¨ Redis çåçº¿ç¨æºå¶å¯ä»¥ä¿è¯æ¯ä¸ª Redis è¯·æ±çåå­æ§\n\n-- èµæºå¯ä¸æ å¿ä½\nlocal key = KEYS[1]\n-- éæµå¤§å°\nlocal limit = tonumber(ARGV[1])\n\n-- è·åå½åæµéå¤§å°\nlocal currentLimit = tonumber(redis.call(\'get\', key) or "0")\n\nif currentLimit + 1 > limit then\n    -- è¾¾å°éæµå¤§å° è¿å\n    return 0;\nelse\n    -- æ²¡æè¾¾å°éå¼ value + 1\n    redis.call("INCRBY", key, 1)\n    -- è®¾ç½®è¿ææ¶é´\n    redis.call("EXPIRE", key, 2)\n    return currentLimit + 1\nend\n\n\n\n# 2.2. æ»å¨çªå£æ³\n\n\n\næ»å¨çªå£æ³çåçï¼\n\næ»å¨çªå£æ³æ¯è®¡æ°å¨ç®æ³çä¸ç§æ¹è¿ï¼å¢å ä¸ä¸ªæ¶é´ç²åº¦çåº¦éåä½ï¼å°åæ¥çä¸ä¸ªæ¶é´çªå£ååæå¤ä¸ªæ¶é´çªå£ï¼å¹¶ä¸ä¸æ­åå³æ»å¨è¯¥çªå£ãæµéç»è¿æ»å¨æ¶é´çªå£ç®æ³æ´å½¢ä¹åï¼å¯ä»¥ä¿è¯ä»»ææ¶é´çªå£åï¼é½ä¸ä¼è¶è¿æå¤§åè®¸çéæµå¼ï¼ä»æµéæ²çº¿ä¸æ¥çä¼æ´å å¹³æ»ï¼å¯ä»¥é¨åè§£å³ä¸é¢æå°çä¸´ççªåæµéé®é¢ã\n\nå¯¹æ¯åºå®æ¶é´çªå£éæµç®æ³ï¼æ»å¨æ¶é´çªå£éæµç®æ³çæ¶é´çªå£æ¯æç»­æ»å¨çï¼å¹¶ä¸é¤äºéè¦ä¸ä¸ªè®¡æ°å¨æ¥è®°å½æ¶é´çªå£åæ¥å£è¯·æ±æ¬¡æ°ä¹å¤ï¼è¿éè¦è®°å½å¨æ¶é´çªå£åæ¯ä¸ªæ¥å£è¯·æ±å°è¾¾çæ¶é´ç¹ï¼å¯¹åå­çå ç¨ä¼æ¯è¾å¤ã å¨ä¸´çä½ç½®ççªåè¯·æ±é½ä¼è¢«ç®å°æ¶é´çªå£åï¼å æ­¤å¯ä»¥è§£å³è®¡æ°å¨ç®æ³çä¸´çé®é¢ï¼\n\næ¯å¦å¨ä¸æçä¾å­ä¸­ï¼éè¿æ»å¨çªå£ç®æ³æ´ååï¼ç¬¬ä¸ä¸ª 1s çæ¶é´çªå£ç 100 æ¬¡è¯·æ±é½ä¼éè¿ï¼ç¬¬äºä¸ªæ¶é´çªå£æå¼å§ç 10ms åç 100 ä¸ªè¯·æ±é½ä¼è¢«éæµçæ­ã\n\næ»å¨çªå£æ³çç¼ºé·ï¼åºäºæ¶é´çªå£çéæµç®æ³ï¼åªè½å¨éå®çæ¶é´ç²åº¦ä¸éæµï¼å¯¹éå®æ¶é´ç²åº¦åçæ´å ç»ç²åº¦çè®¿é®é¢çä¸åéå¶ã\n\nimport java.util.Iterator;\nimport java.util.Random;\nimport java.util.concurrent.ConcurrentLinkedQueue;\nimport java.util.stream.IntStream;\n\npublic class TimeWindow {\n    private ConcurrentLinkedQueue<Long> queue = new ConcurrentLinkedQueue<Long>();\n\n    /**\n     * é´éç§æ°\n     */\n    private int seconds;\n\n    /**\n     * æå¤§éæµ\n     */\n    private int max;\n\n    public TimeWindow(int max, int seconds) {\n        this.seconds = seconds;\n        this.max = max;\n\n        /**\n         * æ°¸ç»­çº¿ç¨æ§è¡æ¸çqueue ä»»å¡\n         */\n        new Thread(() -> {\n            while (true) {\n                try {\n                    // ç­å¾ é´éç§æ°-1 æ§è¡æ¸çæä½\n                    Thread.sleep((seconds - 1) * 1000L);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                clean();\n            }\n        }).start();\n\n    }\n\n    public static void main(String[] args) throws Exception {\n\n        final TimeWindow timeWindow = new TimeWindow(10, 1);\n\n        // æµè¯3ä¸ªçº¿ç¨\n        IntStream.range(0, 3).forEach((i) -> {\n            new Thread(() -> {\n\n                while (true) {\n\n                    try {\n                        Thread.sleep(new Random().nextInt(20) * 100);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    timeWindow.take();\n                }\n\n            }).start();\n\n        });\n\n    }\n\n    /**\n     * è·åä»¤çï¼å¹¶ä¸æ·»å æ¶é´\n     */\n    public void take() {\n\n\n        long start = System.currentTimeMillis();\n        try {\n\n\n            int size = sizeOfValid();\n            if (size > max) {\n                System.err.println("è¶é");\n\n            }\n            synchronized (queue) {\n                if (sizeOfValid() > max) {\n                    System.err.println("è¶é");\n                    System.err.println("queueä¸­æ " + queue.size() + " æå¤§æ°é " + max);\n                }\n                this.queue.offer(System.currentTimeMillis());\n            }\n            System.out.println("queueä¸­æ " + queue.size() + " æå¤§æ°é " + max);\n\n        }\n\n    }\n\n\n    public int sizeOfValid() {\n        Iterator<Long> it = queue.iterator();\n        Long ms = System.currentTimeMillis() - seconds * 1000;\n        int count = 0;\n        while (it.hasNext()) {\n            long t = it.next();\n            if (t > ms) {\n                // å¨å½åçç»è®¡æ¶é´èå´å\n                count++;\n            }\n        }\n\n        return count;\n    }\n\n\n    /**\n     * æ¸çè¿æçæ¶é´\n     */\n    public void clean() {\n        Long c = System.currentTimeMillis() - seconds * 1000;\n\n        Long tl = null;\n        while ((tl = queue.peek()) != null && tl < c) {\n            System.out.println("æ¸çæ°æ®");\n            queue.poll();\n        }\n    }\n\n}\n\n\n\n# 2.3. æ¼æ¡¶æ³\n\n\n\næ¼æ¡¶ç®æ³åé¨æä¸ä¸ªå®¹å¨ï¼å½è¯·æ±è¿æ¥æ¶ï¼ç¸å½äºæ°´åå¥æ¼æï¼ç¶åä»ä¸ç«¯å°å£æ¢æ¢åéçæµåºãä¸ç®¡ä¸é¢æµéå¤å¤§ï¼ä¸é¢æµåºçéåº¦å§ç»ä¿æä¸åã\n\næ¼æ¡¶ç®æ³çæ¬è´¨æ¯ï¼ä¸ç®¡çè¯·æ±éæå¤å¤§ï¼å¤çè¯·æ±çéåº¦å§ç»æ¯åºå®çãè¿ç§æ¨¡å¼ç±»ä¼¼çæ´»ä¸­çæ¼æï¼ä¸å®½ä¸çªãè¯·æ±è¿æ¥çéåº¦æ¯æªç¥çï¼å¯è½çªç¶è¿æ¥å¾å¤è¯·æ±ï¼æ²¡æ¥å¾åå¤ççè¯·æ±å°±åæ¾å¨æ¼æéãæ¼ææ¬èº«ä¹æå®¹éä¸éï¼å¦ææ¡¶æ»¡äºï¼é£ä¹æ°è¿æ¥çè¯·æ±å°±ä¸¢å¼ã\n\næ¼æ¡¶ç®æ³çä¼ç¹æ¯ï¼è¿ç§ç­ç¥çå¥½å¤æ¯ï¼åå°äºæµéæ´å½¢ï¼å³æ è®ºæµéå¤å¤§ï¼å³ä¾¿æ¯çªåçå¤§æµéï¼è¾åºä¾æ§æ¯ä¸ä¸ªç¨³å®çæµéã\n\næ¼æ¡¶ç®æ³çç¼ºç¹æ¯ï¼æ æ³åºå¯¹ç­æ¶é´ççªåºæµéã\n\næ¼æ¡¶ç­ç¥éç¨äºé´éæ§çªåæµéä¸æµéä¸ç¨å³æ¶å¤ççåºæ¯ã\n\nãç¤ºä¾ãæ¼æ¡¶æ³å®ç°\n\npublic class LeakBucket {\n    /**\n     * æ¶é´\n     */\n    private long time;\n    /**\n     * æ»é\n     */\n    private Double total;\n    /**\n     * æ°´æµåºå»çéåº¦\n     */\n    private Double rate;\n    /**\n     * å½åæ»é\n     */\n    private Double nowSize;\n\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n        nowSize = Math.max(0, (nowSize - (now - time) * rate));\n        time = now;\n        if ((nowSize + 1) < total) {\n            nowSize++;\n            return true;\n        } else {\n            return false;\n        }\n\n    }\n}\n\n\n\n# 2.4. ä»¤çæ¡¶æ³\n\n\n\nä»¤çæ¡¶ç®æ³çåçï¼\n\n 1. æ¥å£éå¶ T ç§åæå¤§è®¿é®æ¬¡æ°ä¸º Nï¼åæ¯é T/N ç§ä¼æ¾ä¸ä¸ª token å°æ¡¶ä¸­\n 2. æ¡¶åæå¤å­æ¾ M ä¸ª tokenï¼å¦æ token å°è¾¾æ¶ä»¤çæ¡¶å·²ç»æ»¡äºï¼é£ä¹è¿ä¸ª token å°±ä¼è¢«ä¸¢å¼\n 3. æ¥å£è¯·æ±ä¼åä»ä»¤çæ¡¶ä¸­å tokenï¼æ¿å° token åå¤çæ¥å£è¯·æ±ï¼æ¿ä¸å° token åè¿è¡éæµå¤ç\n\nå ä¸ºä»¤çæ¡¶å­æ¾äºå¾å¤ä»¤çï¼é£ä¹å¤§éççªåè¯·æ±ä¼è¢«æ§è¡ï¼ä½æ¯å®ä¸ä¼åºç°ä¸´çé®é¢ï¼å¨ä»¤çç¨å®ä¹åï¼ä»¤çæ¯ä»¥ä¸ä¸ªæå®çéçæ·»å å°ä»¤çæ¡¶ä¸­çï¼å æ­¤ä¸è½åæ¬¡åéå¤§éçªåè¯·æ±ã\n\nè§å®åºå®å®¹éçæ¡¶ï¼token ä»¥åºå®éåº¦å¾æ¡¶åå¡«åï¼å½æ¡¶æ»¡æ¶ token ä¸ä¼è¢«ç»§ç»­æ¾å¥ï¼æ¯è¿æ¥ä¸ä¸ªè¯·æ±æ token ä»æ¡¶ä¸­ç§»é¤,å¦ææ¡¶ä¸­æ²¡æ token ä¸è½è¯·æ±ã\n\nä»¤çæ¡¶ç®æ³éç¨äºæçªåç¹æ§çæµéï¼ä¸æµééè¦å³æ¶å¤ççåºæ¯ã\n\nãç¤ºä¾ãJava å®ç°ä»¤çæ¡¶ç®æ³\n\npublic class TokenBucket {\n    /**\n     * æ¶é´\n     */\n    private long time;\n    /**\n     * æ»é\n     */\n    private Double total;\n    /**\n     * token æ¾å¥éåº¦\n     */\n    private Double rate;\n    /**\n     * å½åæ»é\n     */\n    private Double nowSize;\n\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n        nowSize = Math.min(total, nowSize + (now - time) * rate);\n        time = now;\n        if (nowSize < 1) {\n            // æ¡¶éæ²¡ætoken\n            return false;\n        } else {\n            // å­å¨token\n            nowSize -= 1;\n            return true;\n        }\n    }\n}\n\n\nãç¤ºä¾ãåºäº Redis Lua ä»¤çæ¡¶éæµç®æ³å®ç°\n\n-- ä»¤çæ¡¶éæµ\n\n-- ä»¤ççå¯ä¸æ è¯\nlocal bucketKey = KEYS[1]\n-- ä¸æ¬¡è¯·æ±çæ¶é´\nlocal last_mill_request_key = KEYS[2]\n-- ä»¤çæ¡¶çå®¹é\nlocal limit = tonumber(ARGV[1])\n-- è¯·æ±ä»¤ççæ°é\nlocal permits = tonumber(ARGV[2])\n-- ä»¤çæµå¥çéç\nlocal rate = tonumber(ARGV[3])\n-- å½åæ¶é´\nlocal curr_mill_time = tonumber(ARGV[4])\n\n-- æ·»å ä»¤ç\n\n-- è·åå½åä»¤ççæ°é\nlocal current_limit = tonumber(redis.call(\'get\', bucketKey) or "0")\n-- è·åä¸æ¬¡è¯·æ±çæ¶é´\nlocal last_mill_request_time = tonumber(redis.call(\'get\', last_mill_request_key) or "0")\n-- è®¡ç®åæ¡¶éæ·»å ä»¤ççæ°é\nif last_mill_request_time == 0 then\n\t-- ä»¤çæ¡¶åå§å\n\t-- æ´æ°ä¸æ¬¡è¯·æ±æ¶é´\n\tredis.call("HSET", last_mill_request_key, curr_mill_time)\n\treturn 0\nelse\n\tlocal add_token_num = math.floor((curr_mill_time - last_mill_request_time) * rate)\nend\n\n-- æ´æ°ä»¤ççæ°é\nif current_limit + add_token_num > limit then\n    current_limit = limit\nelse\n\tcurrent_limit = current_limit + add_token_num\nend\n\tredis.pcall("HSET",bucketKey, current_limit)\n-- è®¾ç½®è¿ææ¶é´\nredis.call("EXPIRE", bucketKey, 2)\n\n-- éæµå¤æ­\n\nif current_limit - permits < 1 then\n    -- è¾¾å°éæµå¤§å°\n    return 0\nelse\n    -- æ²¡æè¾¾å°éæµå¤§å°\n\tcurrent_limit = current_limit - permits\n\tredis.pcall("HSET", bucketKey, current_limit)\n    -- è®¾ç½®è¿ææ¶é´\n    redis.call("EXPIRE", bucketKey, 2)\n\t-- æ´æ°ä¸æ¬¡è¯·æ±çæ¶é´\n\tredis.call("HSET", last_mill_request_key, curr_mill_time)\nend\n\n\n\n# 3. éæµå·¥å·\n\nåé¢ä»ç»äºéæµç®æ³çåºæ¬åçåä¸äºç®åçå®ç°ãä½å¨çäº§ç¯å¢ï¼æä»¬ä¸è¬åºè¯¥ä½¿ç¨æ´æççéæµå·¥å·ã\n\n * Guava ç RateLimiterï¼RateLimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³ãå·ä½ç¨æ³å¯ä»¥åèï¼RateLimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³\n * Hystrixï¼ç»å¸çéæµãçæ­å·¥å·ï¼å¾å¼å¾åé´å­¦ä¹ ãæ³¨ï¼å®æ¹å·²åæ­¢åå¸çæ¬ã\n * Sentinelï¼é¿éçéæµãçæ­å·¥å·ã\n\n\n# 4. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * è°è°éæµç®æ³çå ç§å®ç°\n * å¦ä½éæµï¼å¨å·¥ä½ä¸­æ¯æä¹åçï¼è¯´ä¸ä¸å·ä½çå®ç°ï¼\n * æµæéæµç®æ³\n * RateLimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³',normalizedContent:'# æµéæ§å¶\n\n> å¨é«å¹¶ååºæ¯ä¸ï¼ä¸ºäºåºå¯¹ç¬æ¶æµ·éè¯·æ±çååï¼ä¿éç³»ç»çå¹³ç¨³è¿è¡ï¼å¿é¡»é¢ä¼°ç³»ç»çæµééå¼ï¼éè¿éæµè§åé»æ­å¤çä¸è¿æ¥çè¯·æ±ã\n\n\n# 1. éæµç®ä»\n\néæµå¯ä»¥è®¤ä¸ºæ¯æå¡éçº§çä¸ç§ãéæµå°±æ¯éå¶ç³»ç»çè¾å¥åè¾åºæµéå·²è¾¾å°ä¿æ¤ç³»ç»çç®çãä¸è¬æ¥è¯´ç³»ç»çååéæ¯å¯ä»¥è¢«æµç®çï¼ä¸ºäºä¿è¯ç³»ç»çç¨³å®è¿è¡ï¼ä¸æ¦è¾¾å°çéè¦éå¶çéå¼ï¼å°±éè¦éå¶æµéå¹¶éåä¸äºæªæ½ä»¥å®æéå¶æµéçç®çãæ¯å¦ï¼å»¶è¿å¤çï¼æç»å¤çï¼æèé¨åæç»å¤çç­ç­ã\n\néæµè§ååå«ä¸ä¸ªé¨åï¼æ¶é´ç²åº¦ï¼æ¥å£ç²åº¦ï¼æå¤§éæµå¼ãéæµè§åè®¾ç½®æ¯å¦åçç´æ¥å½±åå°éæµæ¯å¦åçææã\n\n\n# 2. éæµç®æ³\n\n\n# 2.1. è®¡æ°å¨æ³\n\n\n\nè®¡æ°å¨æ³çåçæ¯ï¼è®¾ç½®ä¸ä¸ªè®¡æ°å¨ï¼ç¨äºç»è®¡æå®æ¶é´æ®µåçè¯·æ±æ°éï¼å¹¶å¨æå®æ¶é´æ®µä¹åéç½®è®¡æ°å¨ãå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æè¯·æ±éè¶è¿éå®çéå¼ï¼åæç»è¯·æ±ã\n\nè¿ç§ç®æ³çç¼ºé·æ¯ï¼è¿ç§ç®æ³æ¯éå¯¹ä¸ä¸ªæ¶é´æ®µè¿è¡ç»è®¡ï¼å¦æè¯·æ±åå¸ä¸ååï¼æç«¯æåµä¸ï¼ææè¯·æ±é½å¨æä¸å»æ¶å°ï¼è¿æ¯å¯è½åå®ç³»ç»ãä¾å¦ï¼åè®¾æä»¬éæµè§åä¸ºæ¯ç§éä¸è¶è¿ 100 æ¬¡æ¥å£è¯·æ±ï¼ç¬¬ä¸ä¸ª 1s æ¶é´çªå£åï¼100 æ¬¡æ¥å£è¯·æ±é½éä¸­å¨æåç 10ms åï¼å¨ç¬¬äºä¸ª 1s çæ¶é´çªå£åï¼100 æ¬¡æ¥å£è¯·æ±é½éä¸­å¨æå¼å§ç 10ms åï¼è½ç¶ä¸¤ä¸ªæ¶é´çªå£åæµéé½ç¬¦åéæµè¦æ±ï¼ä½æ¯å¨è¿ä¸¤ä¸ªæ¶é´çªå£ä¸´çç 20ms åä¼éä¸­æ 200 æ¬¡æ¥å£è¯·æ±ï¼å¦æä¸åéæµï¼éä¸­å¨è¿ 20ms åç 200 æ¬¡è¯·æ±å°±æå¯è½åå®ç³»ç»ã\n\nãç¤ºä¾ãä½¿ç¨ atomicinteger å®ç°è®¡æ°å¨æ³\n\npublic class counter {\n    /**\n     * æå¤§è®¿é®æ°é\n     */\n    private final int limit = 10;\n    /**\n     * è®¿é®æ¶é´å·®\n     */\n    private final long timeout = 1000;\n    /**\n     * è¯·æ±æ¶é´\n     */\n    private long time;\n    /**\n     * å½åè®¡æ°å¨\n     */\n    private atomicinteger reqcount = new atomicinteger(0);\n\n    public boolean limit() {\n        long now = system.currenttimemillis();\n        if (now < time + timeout) {\n            // åä½æ¶é´å\n            reqcount.addandget(1);\n            return reqcount.get() <= limit;\n        } else {\n            // è¶åºåä½æ¶é´\n            time = now;\n            reqcount = new atomicinteger(0);\n            return true;\n        }\n    }\n}\n\n\nãç¤ºä¾ãåºäº redis lua è®¡æ°éæµç®æ³çå®ç°\n\n-- å®ç°åç\n-- æ¯æ¬¡è¯·æ±é½å°å½åæ¶é´ï¼ç²¾ç¡®å°ç§ä½ä¸º key æ¾å¥ redis ä¸­ï¼è¶æ¶æ¶é´è®¾ç½®ä¸º 2sï¼ redis å°è¯¥ key çå¼è¿è¡èªå¢\n-- å½è¾¾å°éå¼æ¶è¿åéè¯¯ï¼è¡¨ç¤ºè¯·æ±è¢«éæµ\n-- åå¥ redis çæä½ç¨ lua èæ¬æ¥å®æï¼å©ç¨ redis çåçº¿ç¨æºå¶å¯ä»¥ä¿è¯æ¯ä¸ª redis è¯·æ±çåå­æ§\n\n-- èµæºå¯ä¸æ å¿ä½\nlocal key = keys[1]\n-- éæµå¤§å°\nlocal limit = tonumber(argv[1])\n\n-- è·åå½åæµéå¤§å°\nlocal currentlimit = tonumber(redis.call(\'get\', key) or "0")\n\nif currentlimit + 1 > limit then\n    -- è¾¾å°éæµå¤§å° è¿å\n    return 0;\nelse\n    -- æ²¡æè¾¾å°éå¼ value + 1\n    redis.call("incrby", key, 1)\n    -- è®¾ç½®è¿ææ¶é´\n    redis.call("expire", key, 2)\n    return currentlimit + 1\nend\n\n\n\n# 2.2. æ»å¨çªå£æ³\n\n\n\næ»å¨çªå£æ³çåçï¼\n\næ»å¨çªå£æ³æ¯è®¡æ°å¨ç®æ³çä¸ç§æ¹è¿ï¼å¢å ä¸ä¸ªæ¶é´ç²åº¦çåº¦éåä½ï¼å°åæ¥çä¸ä¸ªæ¶é´çªå£ååæå¤ä¸ªæ¶é´çªå£ï¼å¹¶ä¸ä¸æ­åå³æ»å¨è¯¥çªå£ãæµéç»è¿æ»å¨æ¶é´çªå£ç®æ³æ´å½¢ä¹åï¼å¯ä»¥ä¿è¯ä»»ææ¶é´çªå£åï¼é½ä¸ä¼è¶è¿æå¤§åè®¸çéæµå¼ï¼ä»æµéæ²çº¿ä¸æ¥çä¼æ´å å¹³æ»ï¼å¯ä»¥é¨åè§£å³ä¸é¢æå°çä¸´ççªåæµéé®é¢ã\n\nå¯¹æ¯åºå®æ¶é´çªå£éæµç®æ³ï¼æ»å¨æ¶é´çªå£éæµç®æ³çæ¶é´çªå£æ¯æç»­æ»å¨çï¼å¹¶ä¸é¤äºéè¦ä¸ä¸ªè®¡æ°å¨æ¥è®°å½æ¶é´çªå£åæ¥å£è¯·æ±æ¬¡æ°ä¹å¤ï¼è¿éè¦è®°å½å¨æ¶é´çªå£åæ¯ä¸ªæ¥å£è¯·æ±å°è¾¾çæ¶é´ç¹ï¼å¯¹åå­çå ç¨ä¼æ¯è¾å¤ã å¨ä¸´çä½ç½®ççªåè¯·æ±é½ä¼è¢«ç®å°æ¶é´çªå£åï¼å æ­¤å¯ä»¥è§£å³è®¡æ°å¨ç®æ³çä¸´çé®é¢ï¼\n\næ¯å¦å¨ä¸æçä¾å­ä¸­ï¼éè¿æ»å¨çªå£ç®æ³æ´ååï¼ç¬¬ä¸ä¸ª 1s çæ¶é´çªå£ç 100 æ¬¡è¯·æ±é½ä¼éè¿ï¼ç¬¬äºä¸ªæ¶é´çªå£æå¼å§ç 10ms åç 100 ä¸ªè¯·æ±é½ä¼è¢«éæµçæ­ã\n\næ»å¨çªå£æ³çç¼ºé·ï¼åºäºæ¶é´çªå£çéæµç®æ³ï¼åªè½å¨éå®çæ¶é´ç²åº¦ä¸éæµï¼å¯¹éå®æ¶é´ç²åº¦åçæ´å ç»ç²åº¦çè®¿é®é¢çä¸åéå¶ã\n\nimport java.util.iterator;\nimport java.util.random;\nimport java.util.concurrent.concurrentlinkedqueue;\nimport java.util.stream.intstream;\n\npublic class timewindow {\n    private concurrentlinkedqueue<long> queue = new concurrentlinkedqueue<long>();\n\n    /**\n     * é´éç§æ°\n     */\n    private int seconds;\n\n    /**\n     * æå¤§éæµ\n     */\n    private int max;\n\n    public timewindow(int max, int seconds) {\n        this.seconds = seconds;\n        this.max = max;\n\n        /**\n         * æ°¸ç»­çº¿ç¨æ§è¡æ¸çqueue ä»»å¡\n         */\n        new thread(() -> {\n            while (true) {\n                try {\n                    // ç­å¾ é´éç§æ°-1 æ§è¡æ¸çæä½\n                    thread.sleep((seconds - 1) * 1000l);\n                } catch (interruptedexception e) {\n                    e.printstacktrace();\n                }\n                clean();\n            }\n        }).start();\n\n    }\n\n    public static void main(string[] args) throws exception {\n\n        final timewindow timewindow = new timewindow(10, 1);\n\n        // æµè¯3ä¸ªçº¿ç¨\n        intstream.range(0, 3).foreach((i) -> {\n            new thread(() -> {\n\n                while (true) {\n\n                    try {\n                        thread.sleep(new random().nextint(20) * 100);\n                    } catch (interruptedexception e) {\n                        e.printstacktrace();\n                    }\n                    timewindow.take();\n                }\n\n            }).start();\n\n        });\n\n    }\n\n    /**\n     * è·åä»¤çï¼å¹¶ä¸æ·»å æ¶é´\n     */\n    public void take() {\n\n\n        long start = system.currenttimemillis();\n        try {\n\n\n            int size = sizeofvalid();\n            if (size > max) {\n                system.err.println("è¶é");\n\n            }\n            synchronized (queue) {\n                if (sizeofvalid() > max) {\n                    system.err.println("è¶é");\n                    system.err.println("queueä¸­æ " + queue.size() + " æå¤§æ°é " + max);\n                }\n                this.queue.offer(system.currenttimemillis());\n            }\n            system.out.println("queueä¸­æ " + queue.size() + " æå¤§æ°é " + max);\n\n        }\n\n    }\n\n\n    public int sizeofvalid() {\n        iterator<long> it = queue.iterator();\n        long ms = system.currenttimemillis() - seconds * 1000;\n        int count = 0;\n        while (it.hasnext()) {\n            long t = it.next();\n            if (t > ms) {\n                // å¨å½åçç»è®¡æ¶é´èå´å\n                count++;\n            }\n        }\n\n        return count;\n    }\n\n\n    /**\n     * æ¸çè¿æçæ¶é´\n     */\n    public void clean() {\n        long c = system.currenttimemillis() - seconds * 1000;\n\n        long tl = null;\n        while ((tl = queue.peek()) != null && tl < c) {\n            system.out.println("æ¸çæ°æ®");\n            queue.poll();\n        }\n    }\n\n}\n\n\n\n# 2.3. æ¼æ¡¶æ³\n\n\n\næ¼æ¡¶ç®æ³åé¨æä¸ä¸ªå®¹å¨ï¼å½è¯·æ±è¿æ¥æ¶ï¼ç¸å½äºæ°´åå¥æ¼æï¼ç¶åä»ä¸ç«¯å°å£æ¢æ¢åéçæµåºãä¸ç®¡ä¸é¢æµéå¤å¤§ï¼ä¸é¢æµåºçéåº¦å§ç»ä¿æä¸åã\n\næ¼æ¡¶ç®æ³çæ¬è´¨æ¯ï¼ä¸ç®¡çè¯·æ±éæå¤å¤§ï¼å¤çè¯·æ±çéåº¦å§ç»æ¯åºå®çãè¿ç§æ¨¡å¼ç±»ä¼¼çæ´»ä¸­çæ¼æï¼ä¸å®½ä¸çªãè¯·æ±è¿æ¥çéåº¦æ¯æªç¥çï¼å¯è½çªç¶è¿æ¥å¾å¤è¯·æ±ï¼æ²¡æ¥å¾åå¤ççè¯·æ±å°±åæ¾å¨æ¼æéãæ¼ææ¬èº«ä¹æå®¹éä¸éï¼å¦ææ¡¶æ»¡äºï¼é£ä¹æ°è¿æ¥çè¯·æ±å°±ä¸¢å¼ã\n\næ¼æ¡¶ç®æ³çä¼ç¹æ¯ï¼è¿ç§ç­ç¥çå¥½å¤æ¯ï¼åå°äºæµéæ´å½¢ï¼å³æ è®ºæµéå¤å¤§ï¼å³ä¾¿æ¯çªåçå¤§æµéï¼è¾åºä¾æ§æ¯ä¸ä¸ªç¨³å®çæµéã\n\næ¼æ¡¶ç®æ³çç¼ºç¹æ¯ï¼æ æ³åºå¯¹ç­æ¶é´ççªåºæµéã\n\næ¼æ¡¶ç­ç¥éç¨äºé´éæ§çªåæµéä¸æµéä¸ç¨å³æ¶å¤ççåºæ¯ã\n\nãç¤ºä¾ãæ¼æ¡¶æ³å®ç°\n\npublic class leakbucket {\n    /**\n     * æ¶é´\n     */\n    private long time;\n    /**\n     * æ»é\n     */\n    private double total;\n    /**\n     * æ°´æµåºå»çéåº¦\n     */\n    private double rate;\n    /**\n     * å½åæ»é\n     */\n    private double nowsize;\n\n\n    public boolean limit() {\n        long now = system.currenttimemillis();\n        nowsize = math.max(0, (nowsize - (now - time) * rate));\n        time = now;\n        if ((nowsize + 1) < total) {\n            nowsize++;\n            return true;\n        } else {\n            return false;\n        }\n\n    }\n}\n\n\n\n# 2.4. ä»¤çæ¡¶æ³\n\n\n\nä»¤çæ¡¶ç®æ³çåçï¼\n\n 1. æ¥å£éå¶ t ç§åæå¤§è®¿é®æ¬¡æ°ä¸º nï¼åæ¯é t/n ç§ä¼æ¾ä¸ä¸ª token å°æ¡¶ä¸­\n 2. æ¡¶åæå¤å­æ¾ m ä¸ª tokenï¼å¦æ token å°è¾¾æ¶ä»¤çæ¡¶å·²ç»æ»¡äºï¼é£ä¹è¿ä¸ª token å°±ä¼è¢«ä¸¢å¼\n 3. æ¥å£è¯·æ±ä¼åä»ä»¤çæ¡¶ä¸­å tokenï¼æ¿å° token åå¤çæ¥å£è¯·æ±ï¼æ¿ä¸å° token åè¿è¡éæµå¤ç\n\nå ä¸ºä»¤çæ¡¶å­æ¾äºå¾å¤ä»¤çï¼é£ä¹å¤§éççªåè¯·æ±ä¼è¢«æ§è¡ï¼ä½æ¯å®ä¸ä¼åºç°ä¸´çé®é¢ï¼å¨ä»¤çç¨å®ä¹åï¼ä»¤çæ¯ä»¥ä¸ä¸ªæå®çéçæ·»å å°ä»¤çæ¡¶ä¸­çï¼å æ­¤ä¸è½åæ¬¡åéå¤§éçªåè¯·æ±ã\n\nè§å®åºå®å®¹éçæ¡¶ï¼token ä»¥åºå®éåº¦å¾æ¡¶åå¡«åï¼å½æ¡¶æ»¡æ¶ token ä¸ä¼è¢«ç»§ç»­æ¾å¥ï¼æ¯è¿æ¥ä¸ä¸ªè¯·æ±æ token ä»æ¡¶ä¸­ç§»é¤,å¦ææ¡¶ä¸­æ²¡æ token ä¸è½è¯·æ±ã\n\nä»¤çæ¡¶ç®æ³éç¨äºæçªåç¹æ§çæµéï¼ä¸æµééè¦å³æ¶å¤ççåºæ¯ã\n\nãç¤ºä¾ãjava å®ç°ä»¤çæ¡¶ç®æ³\n\npublic class tokenbucket {\n    /**\n     * æ¶é´\n     */\n    private long time;\n    /**\n     * æ»é\n     */\n    private double total;\n    /**\n     * token æ¾å¥éåº¦\n     */\n    private double rate;\n    /**\n     * å½åæ»é\n     */\n    private double nowsize;\n\n\n    public boolean limit() {\n        long now = system.currenttimemillis();\n        nowsize = math.min(total, nowsize + (now - time) * rate);\n        time = now;\n        if (nowsize < 1) {\n            // æ¡¶éæ²¡ætoken\n            return false;\n        } else {\n            // å­å¨token\n            nowsize -= 1;\n            return true;\n        }\n    }\n}\n\n\nãç¤ºä¾ãåºäº redis lua ä»¤çæ¡¶éæµç®æ³å®ç°\n\n-- ä»¤çæ¡¶éæµ\n\n-- ä»¤ççå¯ä¸æ è¯\nlocal bucketkey = keys[1]\n-- ä¸æ¬¡è¯·æ±çæ¶é´\nlocal last_mill_request_key = keys[2]\n-- ä»¤çæ¡¶çå®¹é\nlocal limit = tonumber(argv[1])\n-- è¯·æ±ä»¤ççæ°é\nlocal permits = tonumber(argv[2])\n-- ä»¤çæµå¥çéç\nlocal rate = tonumber(argv[3])\n-- å½åæ¶é´\nlocal curr_mill_time = tonumber(argv[4])\n\n-- æ·»å ä»¤ç\n\n-- è·åå½åä»¤ççæ°é\nlocal current_limit = tonumber(redis.call(\'get\', bucketkey) or "0")\n-- è·åä¸æ¬¡è¯·æ±çæ¶é´\nlocal last_mill_request_time = tonumber(redis.call(\'get\', last_mill_request_key) or "0")\n-- è®¡ç®åæ¡¶éæ·»å ä»¤ççæ°é\nif last_mill_request_time == 0 then\n\t-- ä»¤çæ¡¶åå§å\n\t-- æ´æ°ä¸æ¬¡è¯·æ±æ¶é´\n\tredis.call("hset", last_mill_request_key, curr_mill_time)\n\treturn 0\nelse\n\tlocal add_token_num = math.floor((curr_mill_time - last_mill_request_time) * rate)\nend\n\n-- æ´æ°ä»¤ççæ°é\nif current_limit + add_token_num > limit then\n    current_limit = limit\nelse\n\tcurrent_limit = current_limit + add_token_num\nend\n\tredis.pcall("hset",bucketkey, current_limit)\n-- è®¾ç½®è¿ææ¶é´\nredis.call("expire", bucketkey, 2)\n\n-- éæµå¤æ­\n\nif current_limit - permits < 1 then\n    -- è¾¾å°éæµå¤§å°\n    return 0\nelse\n    -- æ²¡æè¾¾å°éæµå¤§å°\n\tcurrent_limit = current_limit - permits\n\tredis.pcall("hset", bucketkey, current_limit)\n    -- è®¾ç½®è¿ææ¶é´\n    redis.call("expire", bucketkey, 2)\n\t-- æ´æ°ä¸æ¬¡è¯·æ±çæ¶é´\n\tredis.call("hset", last_mill_request_key, curr_mill_time)\nend\n\n\n\n# 3. éæµå·¥å·\n\nåé¢ä»ç»äºéæµç®æ³çåºæ¬åçåä¸äºç®åçå®ç°ãä½å¨çäº§ç¯å¢ï¼æä»¬ä¸è¬åºè¯¥ä½¿ç¨æ´æççéæµå·¥å·ã\n\n * guava ç ratelimiterï¼ratelimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³ãå·ä½ç¨æ³å¯ä»¥åèï¼ratelimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³\n * hystrixï¼ç»å¸çéæµãçæ­å·¥å·ï¼å¾å¼å¾åé´å­¦ä¹ ãæ³¨ï¼å®æ¹å·²åæ­¢åå¸çæ¬ã\n * sentinelï¼é¿éçéæµãçæ­å·¥å·ã\n\n\n# 4. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * è°è°éæµç®æ³çå ç§å®ç°\n * å¦ä½éæµï¼å¨å·¥ä½ä¸­æ¯æä¹åçï¼è¯´ä¸ä¸å·ä½çå®ç°ï¼\n * æµæéæµç®æ³\n * ratelimiter åºäºæ¼æ¡¶ç®æ³ï¼ä½å®åèäºä»¤çæ¡¶ç®æ³',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ·±å¥æµåºè´è½½åè¡¡",frontmatter:{title:"æ·±å¥æµåºè´è½½åè¡¡",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æµéè°åº¦"],tags:["åå¸å¼","æµéè°åº¦","è´è½½åè¡¡"],abbrlink:"7f98a6d0",date:"2018-07-05T15:50:00.000Z",permalink:"/pages/b7ca44/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/01.%E6%B5%81%E9%87%8F%E8%B0%83%E5%BA%A6/02.%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/02.è´è½½åè¡¡.md",key:"v-af744166",path:"/pages/b7ca44/",headers:[{level:2,title:"1. è´è½½åè¡¡ç®ä»",slug:"_1-è´è½½åè¡¡ç®ä»",normalizedTitle:"1. è´è½½åè¡¡ç®ä»",charIndex:17},{level:3,title:"1.1. å¤§åç½ç«é¢ä¸´çææ",slug:"_1-1-å¤§åç½ç«é¢ä¸´çææ",normalizedTitle:"1.1. å¤§åç½ç«é¢ä¸´çææ",charIndex:31},{level:3,title:"1.2. ä»ä¹æ¯è´è½½åè¡¡",slug:"_1-2-ä»ä¹æ¯è´è½½åè¡¡",normalizedTitle:"1.2. ä»ä¹æ¯è´è½½åè¡¡",charIndex:438},{level:2,title:"2. è´è½½åè¡¡çåç±»",slug:"_2-è´è½½åè¡¡çåç±»",normalizedTitle:"2. è´è½½åè¡¡çåç±»",charIndex:783},{level:3,title:"2.1. è½½ä½ç»´åº¦åç±»",slug:"_2-1-è½½ä½ç»´åº¦åç±»",normalizedTitle:"2.1. è½½ä½ç»´åº¦åç±»",charIndex:828},{level:4,title:"ç¡¬ä»¶è´è½½åè¡¡",slug:"ç¡¬ä»¶è´è½½åè¡¡",normalizedTitle:"ç¡¬ä»¶è´è½½åè¡¡",charIndex:871},{level:4,title:"è½¯ä»¶è´è½½åè¡¡",slug:"è½¯ä»¶è´è½½åè¡¡",normalizedTitle:"è½¯ä»¶è´è½½åè¡¡",charIndex:881},{level:3,title:"2.2. ç½ç»éä¿¡åç±»",slug:"_2-2-ç½ç»éä¿¡åç±»",normalizedTitle:"2.2. ç½ç»éä¿¡åç±»",charIndex:1536},{level:4,title:"DNS è´è½½åè¡¡",slug:"dns-è´è½½åè¡¡",normalizedTitle:"dns è´è½½åè¡¡",charIndex:1729},{level:4,title:"HTTP è´è½½åè¡¡",slug:"http-è´è½½åè¡¡",normalizedTitle:"http è´è½½åè¡¡",charIndex:2482},{level:4,title:"ååä»£çè´è½½åè¡¡",slug:"ååä»£çè´è½½åè¡¡",normalizedTitle:"ååä»£çè´è½½åè¡¡",charIndex:2776},{level:4,title:"IP è´è½½åè¡¡",slug:"ip-è´è½½åè¡¡",normalizedTitle:"ip è´è½½åè¡¡",charIndex:3611},{level:4,title:"æ°æ®é¾è·¯å±è´è½½åè¡¡",slug:"æ°æ®é¾è·¯å±è´è½½åè¡¡",normalizedTitle:"æ°æ®é¾è·¯å±è´è½½åè¡¡",charIndex:3932},{level:2,title:"3. è´è½½åè¡¡ç®æ³",slug:"_3-è´è½½åè¡¡ç®æ³",normalizedTitle:"3. è´è½½åè¡¡ç®æ³",charIndex:4618},{level:3,title:"3.1. éæº",slug:"_3-1-éæº",normalizedTitle:"3.1. éæº",charIndex:5061},{level:4,title:"éæºç®æ³",slug:"éæºç®æ³",normalizedTitle:"éæºç®æ³",charIndex:5072},{level:4,title:"å æéæºç®æ³",slug:"å æéæºç®æ³",normalizedTitle:"å æéæºç®æ³",charIndex:6264},{level:3,title:"3.2. è½®è¯¢",slug:"_3-2-è½®è¯¢",normalizedTitle:"3.2. è½®è¯¢",charIndex:7247},{level:4,title:"è½®è¯¢ç®æ³",slug:"è½®è¯¢ç®æ³",normalizedTitle:"è½®è¯¢ç®æ³",charIndex:7258},{level:4,title:"å æè½®è¯¢ç®æ³",slug:"å æè½®è¯¢ç®æ³",normalizedTitle:"å æè½®è¯¢ç®æ³",charIndex:7943},{level:3,title:"3.3. æå°æ´»è·æ°",slug:"_3-3-æå°æ´»è·æ°",normalizedTitle:"3.3. æå°æ´»è·æ°",charIndex:12853},{level:3,title:"3.4. åå¸",slug:"_3-4-åå¸",normalizedTitle:"3.4. åå¸",charIndex:16332},{level:3,title:"3.5. ä¸è´æ§åå¸",slug:"_3-5-ä¸è´æ§åå¸",normalizedTitle:"3.5. ä¸è´æ§åå¸",charIndex:16991},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:21807}],headersStr:"1. è´è½½åè¡¡ç®ä» 1.1. å¤§åç½ç«é¢ä¸´çææ 1.2. ä»ä¹æ¯è´è½½åè¡¡ 2. è´è½½åè¡¡çåç±» 2.1. è½½ä½ç»´åº¦åç±» ç¡¬ä»¶è´è½½åè¡¡ è½¯ä»¶è´è½½åè¡¡ 2.2. ç½ç»éä¿¡åç±» DNS è´è½½åè¡¡ HTTP è´è½½åè¡¡ ååä»£çè´è½½åè¡¡ IP è´è½½åè¡¡ æ°æ®é¾è·¯å±è´è½½åè¡¡ 3. è´è½½åè¡¡ç®æ³ 3.1. éæº éæºç®æ³ å æéæºç®æ³ 3.2. è½®è¯¢ è½®è¯¢ç®æ³ å æè½®è¯¢ç®æ³ 3.3. æå°æ´»è·æ° 3.4. åå¸ 3.5. ä¸è´æ§åå¸ 4. åèèµæ",content:'# æ·±å¥æµåºè´è½½åè¡¡\n\n\n\n\n# 1. è´è½½åè¡¡ç®ä»\n\n\n# 1.1. å¤§åç½ç«é¢ä¸´çææ\n\nå¤§åç½ç«é½è¦é¢å¯¹åºå¤§çç¨æ·éï¼é«å¹¶åï¼æµ·éæ°æ®ç­ææã\n\nä¸ºäºæåç³»ç»æ´ä½çæ§è½ï¼å¯ä»¥éç¨åç´æ©å±åæ°´å¹³æ©å±ä¸¤ç§æ¹å¼ã\n\n * åç´æ©å±ï¼å¨ç½ç«åå±æ©æï¼å¯ä»¥ä»åæºçè§åº¦éè¿å¢å ç¡¬ä»¶å¤çè½åï¼æ¯å¦ CPU å¤çè½åï¼åå­å®¹éï¼ç£çç­æ¹é¢ï¼å®ç°æå¡å¨å¤çè½åçæåãä½æ¯ï¼åæºæ¯ææ§è½ç¶é¢çï¼ä¸æ¦è§¦åç¶é¢ï¼åæ³æåï¼ä»åºçææ¬åä»£ä»·ä¼æé«ãè¿æ¾ç¶ä¸è½æ»¡è¶³å¤§ååå¸å¼ç³»ç»ï¼ç½ç«ï¼ææåºå¯¹çå¤§æµéï¼é«å¹¶åï¼æµ·éæ°æ®ç­ææã\n * æ°´å¹³æ©å±ï¼éè¿éç¾¤æ¥åæå¤§åç½ç«çæµéãéç¾¤ä¸­çåºç¨æå¡å¨ï¼èç¹ï¼éå¸¸è¢«è®¾è®¡ææ ç¶æï¼ç¨æ·å¯ä»¥è¯·æ±ä»»ä½ä¸ä¸ªèç¹ï¼è¿äºèç¹å±ååæè®¿é®ååãæ°´å¹³æ©å±æä¸¤ä¸ªè¦ç¹ï¼\n   * åºç¨éç¾¤ï¼å°åä¸åºç¨é¨ç½²å°å¤å°æºå¨ä¸ï¼ç»æå¤çéç¾¤ï¼æ¥æ¶è´è½½åè¡¡è®¾å¤ååçè¯·æ±ï¼è¿è¡å¤çï¼å¹¶è¿åç¸åºæ°æ®ã\n   * è´è½½åè¡¡ï¼å°ç¨æ·è®¿é®è¯·æ±ï¼éè¿æç§ç®æ³ï¼ååå°éç¾¤ä¸­çèç¹ã\n\n\n# 1.2. ä»ä¹æ¯è´è½½åè¡¡\n\nè´è½½åè¡¡ï¼Load Balanceï¼ç®ç§° LBï¼æ¯é«å¹¶åãé«å¯ç¨ç³»ç»å¿ä¸å¯å°çå³é®ç»ä»¶ï¼ç®æ æ¯ å°½åå°ç½ç»æµéå¹³åååå°å¤ä¸ªæå¡å¨ä¸ï¼ä»¥æé«ç³»ç»æ´ä½çååºéåº¦åå¯ç¨æ§ã\n\nè´è½½åè¡¡çä¸»è¦ä½ç¨å¦ä¸ï¼\n\n * é«å¹¶åï¼è´è½½åè¡¡éè¿ç®æ³è°æ´è´è½½ï¼å°½åååçåéåºç¨éç¾¤ä¸­åèç¹çå·¥ä½éï¼ä»¥æ­¤æé«åºç¨éç¾¤çå¹¶åå¤çè½åï¼ååéï¼ã\n * ä¼¸ç¼©æ§ï¼æ·»å æåå°æå¡å¨æ°éï¼ç¶åç±è´è½½åè¡¡è¿è¡ååæ§å¶ãè¿ä½¿å¾åºç¨éç¾¤å·å¤ä¼¸ç¼©æ§ã\n * é«å¯ç¨ï¼è´è½½åè¡¡å¨å¯ä»¥çæ§åéæå¡å¨ï¼å½æå¡å¨ä¸å¯ç¨æ¶ï¼èªå¨è·³è¿ï¼å°è¯·æ±ååç»å¯ç¨çæå¡å¨ãè¿ä½¿å¾åºç¨éç¾¤å·å¤é«å¯ç¨çç¹æ§ã\n * å®å¨é²æ¤ï¼æäºè´è½½åè¡¡è½¯ä»¶æç¡¬ä»¶æä¾äºå®å¨æ§åè½ï¼å¦ï¼é»ç½ååå¤çãé²ç«å¢ï¼é² DDos æ»å»ç­ã\n\n\n# 2. è´è½½åè¡¡çåç±»\n\næ¯æè´è½½åè¡¡çææ¯å¾å¤ï¼æä»¬å¯ä»¥éè¿ä¸åç»´åº¦å»è¿è¡åç±»ã\n\n\n# 2.1. è½½ä½ç»´åº¦åç±»\n\nä»æ¯æè´è½½åè¡¡çè½½ä½æ¥çï¼å¯ä»¥å°è´è½½åè¡¡åä¸ºä¸¤ç±»ï¼\n\n * ç¡¬ä»¶è´è½½åè¡¡\n * è½¯ä»¶è´è½½åè¡¡\n\n# ç¡¬ä»¶è´è½½åè¡¡\n\nç¡¬ä»¶è´è½½åè¡¡ï¼ä¸è¬æ¯å¨å®å¶å¤çå¨ä¸è¿è¡çç¬ç«è´è½½åè¡¡æå¡å¨ï¼ä»·æ ¼æè´µï¼åè±ªä¸å±ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ä¸»æµäº§å æï¼F5 å A10ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ä¼ç¹ï¼\n\n * åè½å¼ºå¤§ï¼æ¯æå¨å±è´è½½åè¡¡å¹¶æä¾è¾å¨é¢çãå¤æçè´è½½åè¡¡ç®æ³ã\n * æ§è½å¼ºæï¼ç¡¬ä»¶è´è½½åè¡¡ç±äºæ¯å¨ä¸ç¨å¤çå¨ä¸è¿è¡ï¼å æ­¤ååéå¤§ï¼å¯æ¯æåæºç¾ä¸ä»¥ä¸çå¹¶åã\n * å®å¨æ§é«ï¼å¾å¾å·å¤é²ç«å¢ï¼é² DDos æ»å»ç­å®å¨åè½ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ç¼ºç¹ï¼\n\n * ææ¬æè´µï¼è´­ä¹°åç»´æ¤ç¡¬ä»¶è´è½½åè¡¡çææ¬é½å¾é«ã\n * æ©å±æ§å·®ï¼å½è®¿é®éçªå¢æ¶ï¼è¶è¿éåº¦ä¸è½å¨ææ©å®¹ã\n\n# è½¯ä»¶è´è½½åè¡¡\n\nè½¯ä»¶è´è½½åè¡¡ï¼åºç¨æå¹¿æ³ï¼æ è®ºå¤§å¬å¸è¿æ¯å°å¬å¸é½ä¼ä½¿ç¨ã\n\nè½¯ä»¶è´è½½åè¡¡ä»è½¯ä»¶å±é¢å®ç°è´è½½åè¡¡ï¼ä¸è¬å¯ä»¥å¨ä»»ä½æ åç©çè®¾å¤ä¸è¿è¡ã\n\nè½¯ä»¶è´è½½åè¡¡ç ä¸»æµäº§å æï¼NginxãHAProxyãLVSã\n\n * LVS å¯ä»¥ä½ä¸ºåå±è´è½½åè¡¡å¨ãå¶è´è½½åè¡¡çæ§è½è¦ä¼äº Nginxã\n * HAProxy å¯ä»¥ä½ä¸º HTTP å TCP è´è½½åè¡¡å¨ã\n * NginxãHAProxy å¯ä»¥ä½ä¸ºåå±æä¸å±è´è½½åè¡¡å¨ã\n\nè½¯ä»¶è´è½½åè¡¡ç ä¼ç¹ï¼\n\n * æ©å±æ§å¥½ï¼éåºå¨æååï¼å¯ä»¥éè¿æ·»å è½¯ä»¶è´è½½åè¡¡å®ä¾ï¼å¨ææ©å±å°è¶åºåå§å®¹éçè½åã\n * ææ¬ä½å»ï¼è½¯ä»¶è´è½½åè¡¡å¯ä»¥å¨ä»»ä½æ åç©çè®¾å¤ä¸è¿è¡ï¼éä½äºè´­ä¹°åè¿ç»´çææ¬ã\n\nè½¯ä»¶è´è½½åè¡¡ç ç¼ºç¹ï¼\n\n * æ§è½ç¥å·®ï¼ç¸æ¯äºç¡¬ä»¶è´è½½åè¡¡ï¼è½¯ä»¶è´è½½åè¡¡çæ§è½è¦ç¥ä½ä¸äºã\n\n\n# 2.2. ç½ç»éä¿¡åç±»\n\nè½¯ä»¶è´è½½åè¡¡ä»éä¿¡å±é¢æ¥çï¼åå¯ä»¥åä¸ºåå±åä¸å±è´è½½åè¡¡ã\n\n * ä¸å±è´è½½åè¡¡ï¼å°±æ¯å¯ä»¥æ ¹æ®è®¿é®ç¨æ·ç HTTP è¯·æ±å¤´ãURL ä¿¡æ¯å°è¯·æ±è½¬åå°ç¹å®çä¸»æºã\n   * DNS éå®å\n   * HTTP éå®å\n   * ååä»£ç\n * åå±è´è½½åè¡¡ï¼åºäº IP å°ååç«¯å£è¿è¡è¯·æ±çè½¬åã\n   * ä¿®æ¹ IP å°å\n   * ä¿®æ¹ MAC å°å\n\n# DNS è´è½½åè¡¡\n\nDNS è´è½½åè¡¡ä¸è¬ç¨äºäºèç½å¬å¸ï¼å¤æçä¸å¡ç³»ç»ä¸éåä½¿ç¨ãå¤§åç½ç«ä¸è¬ä½¿ç¨ DNS è´è½½åè¡¡ä½ä¸º ç¬¬ä¸çº§è´è½½åè¡¡ææ®µï¼ç¶åå¨åé¨ä½¿ç¨å¶å®æ¹å¼åç¬¬äºçº§è´è½½åè¡¡ãDNS è´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\nDNS å³ ååè§£ææå¡ï¼æ¯ OSI ç¬¬ä¸å±ç½ç»åè®®ãDNS è¢«è®¾è®¡ä¸ºä¸ä¸ªæ å½¢ç»æçåå¸å¼åºç¨ï¼èªä¸èä¸ä¾æ¬¡ä¸ºï¼æ ¹ååæå¡å¨ï¼ä¸çº§ååæå¡å¨ï¼äºçº§ååæå¡å¨ï¼... ï¼æ¬å°ååæå¡å¨ãæ¾ç¶ï¼å¦ææææ°æ®é½å­å¨å¨æ ¹ååæå¡å¨ï¼é£ä¹ DNS æ¥è¯¢çè´è½½åå¼éä¼éå¸¸åºå¤§ã\n\nå æ­¤ï¼DNS æ¥è¯¢ç¸å¯¹äº DNS å±çº§ç»æï¼æ¯ä¸ä¸ªéåçéå½æµç¨ï¼DNS å®¢æ·ç«¯ä¾æ¬¡è¯·æ±æ¬å° DNS æå¡å¨ï¼ä¸ä¸çº§ DNS æå¡å¨ï¼ä¸ä¸ä¸çº§ DNS æå¡å¨ï¼... ï¼æ ¹ DNS æå¡å¨ï¼åå«æå¨ DNS æå¡å¨ï¼ï¼ä¸æ¦å½ä¸­ï¼ç«å³è¿åãä¸ºäºåå°æ¥è¯¢æ¬¡æ°ï¼æ¯ä¸çº§ DNS æå¡å¨é½ä¼è®¾ç½® DNS æ¥è¯¢ç¼å­ã\n\nDNS è´è½½åè¡¡çå·¥ä½åçå°±æ¯ï¼åºäº DNS æ¥è¯¢ç¼å­ï¼æç§è´è½½æåµè¿åä¸åæå¡å¨ç IP å°åã\n\n\n\nDNS éå®åç ä¼ç¹ï¼\n\n * ä½¿ç¨ç®åï¼è´è½½åè¡¡å·¥ä½ï¼äº¤ç» DNS æå¡å¨å¤çï¼çæäºè´è½½åè¡¡æå¡å¨ç»´æ¤çéº»ç¦\n * æé«æ§è½ï¼å¯ä»¥æ¯æåºäºå°åçååè§£æï¼è§£ææè·ç¦»ç¨æ·æè¿çæå¡å¨å°åï¼ç±»ä¼¼ CDN çåçï¼ï¼å¯ä»¥å å¿«è®¿é®éåº¦ï¼æ¹åæ§è½ï¼\n\nDNS éå®åç ç¼ºç¹ï¼\n\n * å¯ç¨æ§å·®ï¼DNS è§£ææ¯å¤çº§è§£æï¼æ°å¢/ä¿®æ¹ DNS åï¼è§£ææ¶é´è¾é¿ï¼è§£æè¿ç¨ä¸­ï¼ç¨æ·è®¿é®ç½ç«å°å¤±è´¥ï¼\n * æ©å±æ§ä½ï¼DNS è´è½½åè¡¡çæ§å¶æå¨åååé£éï¼æ æ³å¯¹å¶åæ´å¤çæ¹ååæ©å±ï¼\n * ç»´æ¤æ§å·®ï¼ä¹ä¸è½åæ æå¡å¨çå½åè¿è¡ç¶æï¼æ¯æçç®æ³å°ï¼ä¸è½åºåæå¡å¨çå·®å¼ï¼ä¸è½æ ¹æ®ç³»ç»ä¸æå¡çç¶ææ¥å¤æ­è´è½½ï¼\n\n# HTTP è´è½½åè¡¡\n\nHTTP è´è½½åè¡¡æ¯åºäº HTTP éå®åå®ç°çãHTTP è´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\nHTTP éå®ååçæ¯ï¼æ ¹æ®ç¨æ·ç HTTP è¯·æ±è®¡ç®åºä¸ä¸ªçå®çæå¡å¨å°åï¼å°è¯¥æå¡å¨å°ååå¥ HTTP éå®åååºä¸­ï¼è¿åç»æµè§å¨ï¼ç±æµè§å¨éæ°è¿è¡è®¿é®ã\n\n\n\nHTTP éå®åç ä¼ç¹ï¼æ¹æ¡ç®åã\n\nHTTP éå®åç ç¼ºç¹ï¼\n\n * æ§è½è¾å·®ï¼æ¯æ¬¡è®¿é®éè¦ä¸¤æ¬¡è¯·æ±æå¡å¨ï¼å¢å äºè®¿é®çå»¶è¿ã\n * éä½æç´¢æåï¼ä½¿ç¨éå®ååï¼æç´¢å¼æä¼è§ä¸º SEO ä½å¼ã\n * å¦æè´è½½åè¡¡å¨å®æºï¼å°±æ æ³è®¿é®è¯¥ç«ç¹ã\n\nç±äºå¶ç¼ºç¹æ¯è¾ææ¾ï¼æä»¥è¿ç§è´è½½åè¡¡ç­ç¥å®éåºç¨è¾å°ã\n\n# ååä»£çè´è½½åè¡¡\n\nååä»£çï¼Reverse Proxyï¼æ¹å¼æ¯æä»¥ ä»£çæå¡å¨ æ¥æ¥åç½ç»è¯·æ±ï¼ç¶å å°è¯·æ±è½¬åç»åç½ä¸­çæå¡å¨ï¼å¹¶å°ä»åç½ä¸­çæå¡å¨ä¸å¾å°çç»æè¿åç»ç½ç»è¯·æ±çå®¢æ·ç«¯ãååä»£çè´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\nååä»£çæå¡çä¸»æµäº§åï¼NginxãApacheã\n\næ­£åä»£çä¸ååä»£çæä»ä¹åºå«ï¼\n\n * æ­£åä»£çï¼åçå¨ å®¢æ·ç«¯ï¼æ¯ç±ç¨æ·ä¸»å¨åèµ·çãç¿»å¢è½¯ä»¶å°±æ¯å¸åçæ­£åä»£çï¼å®¢æ·ç«¯éè¿ä¸»å¨è®¿é®ä»£çæå¡å¨ï¼è®©ä»£çæå¡å¨è·å¾éè¦çå¤ç½æ°æ®ï¼ç¶åè½¬ååå®¢æ·ç«¯ã\n * ååä»£çï¼åçå¨ æå¡ç«¯ï¼ç¨æ·ä¸ç¥éä»£ççå­å¨ã\n\n\n\nååä»£çæ¯å¦ä½å®ç°è´è½½åè¡¡çå¢ï¼ä»¥ Nginx ä¸ºä¾ï¼å¦ä¸æç¤ºï¼\n\n\n\né¦åï¼å¨ä»£çæå¡å¨ä¸è®¾å®å¥½è´è½½åè¡¡è§åãç¶åï¼å½æ¶å°å®¢æ·ç«¯è¯·æ±ï¼ååä»£çæå¡å¨æ¦æªæå®çååæ IP è¯·æ±ï¼æ ¹æ®è´è½½åè¡¡ç®æ³ï¼å°è¯·æ±ååå°åéæå¡å¨ä¸ãå¶æ¬¡ï¼å¦ææå°åéæå¡å¨å®æºï¼ååä»£çæå¡å¨ä¼æå®¹éå¤çï¼æ¯å¦ååè¯·æ±å¤±è´¥ 3 æ¬¡ä»¥ä¸ï¼å°è¯·æ±ååå°å¶ä»åéæå¡å¨ä¸ã\n\nååä»£çç ä¼ç¹ï¼\n\n * å¤ç§è´è½½åè¡¡ç®æ³ï¼æ¯æå¤ç§è´è½½åè¡¡ç®æ³ï¼ä»¥åºå¯¹ä¸åçåºæ¯éæ±ã\n * å¯ä»¥çæ§æå¡å¨ï¼åºäº HTTP åè®®ï¼å¯ä»¥çæ§è½¬åæå¡å¨çç¶æï¼å¦ï¼ç³»ç»è´è½½ãååºæ¶é´ãæ¯å¦å¯ç¨ãè¿æ¥æ°ãæµéç­ï¼ä»èæ ¹æ®è¿äºæ°æ®è°æ´è´è½½åè¡¡çç­ç¥ã\n\nååä»£çç ç¼ºç¹ï¼\n\n * é¢å¤çè½¬åå¼éï¼ååä»£ççè½¬åæä½æ¬èº«æ¯ææ§è½å¼éçï¼å¯è½ä¼åæ¬åå»ºè¿æ¥ï¼ç­å¾è¿æ¥ååºï¼åæååºç»æç­æä½ã\n\n * å¢å ç³»ç»å¤æåº¦ï¼ååä»£çå¸¸ç¨äºååå¸å¼åºç¨çæ°´å¹³æ©å±ï¼ä½ååä»£çæå¡å­å¨ä»¥ä¸é®é¢ï¼ä¸ºäºè§£å³ä»¥ä¸é®é¢ä¼ç»ç³»ç»æ´ä½å¢å é¢å¤çå¤æåº¦åè¿ç»´ææ¬ï¼\n   \n   * ååä»£çæå¡å¦æèªèº«å®æºï¼å°±æ æ³è®¿é®ç«ç¹ï¼æä»¥éè¦æ é«å¯ç¨ æ¹æ¡ï¼å¸¸è§çæ¹æ¡æï¼ä¸»å¤æ¨¡å¼ï¼ä¸ä¸»ä¸å¤ï¼ãåä¸»æ¨¡å¼ï¼äºä¸ºä¸»å¤ï¼ã\n   * ååä»£çæå¡èªèº«ä¹å­å¨æ§è½ç¶é¢ï¼éçéè¦è½¬åçè¯·æ±éä¸æ­æåï¼éè¦æ å¯æ©å± æ¹æ¡ã\n\n# IP è´è½½åè¡¡\n\nIP è´è½½åè¡¡æ¯å¨ç½ç»å±éè¿ä¿®æ¹è¯·æ±ç®çå°åè¿è¡è´è½½åè¡¡ã\n\n\n\nå¦ä¸å¾æç¤ºï¼IP åè¡¡å¤çæµç¨å¤§è´ä¸ºï¼\n\n 1. å®¢æ·ç«¯è¯·æ± 192.168.137.10ï¼ç±è´è½½åè¡¡æå¡å¨æ¥æ¶å°æ¥æã\n 2. è´è½½åè¡¡æå¡å¨æ ¹æ®ç®æ³éåºä¸ä¸ªæå¡èç¹ 192.168.0.1ï¼ç¶åå°æ¥æè¯·æ±å°åæ¹ä¸ºè¯¥èç¹ç IPã\n 3. çå®æå¡èç¹æ¶å°è¯·æ±æ¥æï¼å¤çåï¼è¿åååºæ°æ®å°è´è½½åè¡¡æå¡å¨ã\n 4. è´è½½åè¡¡æå¡å¨å°ååºæ°æ®çæºå°åæ¹è´è½½åè¡¡æå¡å¨å°åï¼è¿åç»å®¢æ·ç«¯ã\n\nIP è´è½½åè¡¡å¨åæ ¸è¿ç¨å®ææ°æ®ååï¼è¾ååä»£çè´è½½åè¡¡ææ´å¥½çä»å¤çæ§è½ãä½æ¯ï¼ç±äºææè¯·æ±ååºé½è¦ç»è¿è´è½½åè¡¡æå¡å¨ï¼éç¾¤çååéåå¶äºè´è½½åè¡¡æå¡å¨çå¸¦å®½ã\n\n# æ°æ®é¾è·¯å±è´è½½åè¡¡\n\næ°æ®é¾è·¯å±è´è½½åè¡¡æ¯æå¨éä¿¡åè®®çæ°æ®é¾è·¯å±ä¿®æ¹ mac å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nå¨ Linux å¹³å°ä¸æå¥½çé¾è·¯å±è´è½½åè¡¡å¼æºäº§åæ¯ LVS (Linux Virtual Server)ã\n\nLVS æ¯åºäº Linux åæ ¸ä¸­ netfilter æ¡æ¶å®ç°çè´è½½åè¡¡ç³»ç»ãnetfilter æ¯åæ ¸æç Linux é²ç«å¢æºå¶ï¼å¯ä»¥å¨æ°æ®åæµç»è¿ç¨ä¸­ï¼æ ¹æ®è§åè®¾ç½®è¥å¹²ä¸ªå³å¡ï¼hook å½æ°ï¼æ¥æ§è¡ç¸å³çæä½ã\n\nLVS çå·¥ä½æµç¨å¤§è´å¦ä¸ï¼\n\n * å½ç¨æ·è®¿é® www.sina.com.cn æ¶ï¼ç¨æ·æ°æ®éè¿å±å±ç½ç»ï¼æåéè¿äº¤æ¢æºè¿å¥ LVS æå¡å¨ç½å¡ï¼å¹¶è¿å¥åæ ¸ç½ç»å±ã\n * è¿å¥ PREROUTING åç»è¿è·¯ç±æ¥æ¾ï¼ç¡®å®è®¿é®çç®ç VIP æ¯æ¬æº IP å°åï¼æä»¥æ°æ®åè¿å¥å° INPUT é¾ä¸\n * IPVS æ¯å·¥ä½å¨ INPUT é¾ä¸ï¼ä¼æ ¹æ®è®¿é®ç vip+port å¤æ­è¯·æ±æ¯å¦ IPVS æå¡ï¼å¦ææ¯åè°ç¨æ³¨åç IPVS HOOK å½æ°ï¼è¿è¡ IPVS ç¸å³ä¸»æµç¨ï¼å¼ºè¡ä¿®æ¹æ°æ®åçç¸å³æ°æ®ï¼å¹¶å°æ°æ®ååå¾ POSTROUTING é¾ä¸ã\n * POSTROUTING ä¸æ¶å°æ°æ®ååï¼æ ¹æ®ç®æ  IP å°åï¼åç«¯æå¡å¨ï¼ï¼éè¿è·¯ç±éè·¯ï¼å°æ°æ®åæç»åå¾åç«¯çæå¡å¨ä¸ã\n\nå¼æº LVS çæ¬æ 3 ç§å·¥ä½æ¨¡å¼ï¼æ¯ç§æ¨¡å¼å·¥ä½åçæªç¶ä¸åï¼è¯´åç§æ¨¡å¼é½æèªå·±çä¼ç¼ºç¹ï¼åå«éåä¸åçåºç¨åºæ¯ï¼ä¸è¿æç»æ¬è´¨çåè½é½æ¯è½å®ç°åè¡¡çæµéè°åº¦åè¯å¥½çæ©å±æ§ãä¸»è¦åæ¬ä¸ç§æ¨¡å¼ï¼DR æ¨¡å¼ãNAT æ¨¡å¼ãTunnel æ¨¡å¼ã\n\n\n# 3. è´è½½åè¡¡ç®æ³\n\nè´è½½åè¡¡å¨çå®ç°å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\n * æ ¹æ®è´è½½åè¡¡ç®æ³å¨åéæå¡å¨åè¡¨éåºä¸ä¸ªæå¡å¨ï¼\n * å°è¯·æ±æ°æ®åéå°è¯¥æå¡å¨ä¸ã\n\nè´è½½åè¡¡ç®æ³æ¯è´è½½åè¡¡æå¡æ ¸å¿ä¸­çæ ¸å¿ãè´è½½åè¡¡äº§åå¤ç§å¤æ ·ï¼ä½æ¯åç§è´è½½åè¡¡ç®æ³åçæ¯å±æ§çã\n\nè´è½½åè¡¡ç®æ³æå¾å¤ç§ï¼åå«éç¨äºä¸åçåºç¨åºæ¯ï¼æ¬æä»ä»ç»æä¸ºå¸¸è§çè´è½½åè¡¡ç®æ³çç¹æ§ååçï¼è½®è¯¢ãéæºãæå°æ´»è·æ°ãæºå°ååå¸ãä¸è´æ§åå¸ã\n\n> æ³¨ï¼è´è½½åè¡¡ç®æ³çå®ç°ï¼æ¨èéè¯» Dubbo å®æ¹è´è½½åè¡¡ç®æ³è¯´æ ï¼æºç è®²è§£éå¸¸è¯¦ç»ï¼éå¸¸å¼å¾åé´ã\n> \n> ä¸æä¸­çåç§ç®æ³çå¯æ§è¡ç¤ºä¾å·²å½æ¡£å¨ Github ä»åºï¼https://github.com/dunwu/java-tutorial/tree/master/codes/java-distributed/java-load-balanceï¼å¯ä»¥éè¿æ§è¡ io.github.dunwu.javatech.LoadBalanceDemo æ¥çåç®æ³æ§è¡ææã\n\n\n# 3.1. éæº\n\n# éæºç®æ³\n\néæºï¼Randomï¼ ç®æ³ å°è¯·æ±éæºååå°åéæå¡å¨ã\n\néæºç®æ³ éåæå¡å¨ç¡¬ä»¶ç¸åçåºæ¯ãå­¦ä¹ è¿æ¦çè®ºçé½ç¥éï¼è°ç¨éè¾å°çæ¶åï¼å¯è½è´è½½å¹¶ä¸ååï¼è°ç¨éè¶å¤§ï¼è´è½½è¶åè¡¡ã\n\n\n\nãç¤ºä¾ãéæºç®æ³å®ç°ç¤ºä¾\n\nè´è½½åè¡¡æ¥å£\n\npublic interface LoadBalance<N extends Node> {\n\n    N select(List<N> nodes, String ip);\n\n}\n\n\nè´è½½åè¡¡æ½è±¡ç±»\n\npublic abstract class BaseLoadBalance<N extends Node> implements LoadBalance<N> {\n\n    @Override\n    public N select(List<N> nodes, String ip) {\n        if (CollectionUtil.isEmpty(nodes)) {\n            return null;\n        }\n\n        // å¦æ nodes åè¡¨ä¸­ä»æä¸ä¸ª nodeï¼ç´æ¥è¿åå³å¯ï¼æ éè¿è¡è´è½½åè¡¡\n        if (nodes.size() == 1) {\n            return nodes.get(0);\n        }\n\n        return doSelect(nodes, ip);\n    }\n\n    protected abstract N doSelect(List<N> nodes, String ip);\n\n}\n\n\næå¡å¨èç¹ç±»\n\npublic class Node implements Comparable<Node> {\n\n    protected String url;\n\n    protected Integer weight;\n\n    protected Integer active;\n\n    // ...\n}\n\n\néæºç®æ³å®ç°\n\npublic class RandomLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    private final Random random = new Random();\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n        // å¨åè¡¨ä¸­éæºéåä¸ä¸ªèç¹\n        int index = random.nextInt(nodes.size());\n        return nodes.get(index);\n    }\n\n}\n\n\n# å æéæºç®æ³\n\nå æéæºï¼Weighted Randomï¼ ç®æ³å¨éæºç®æ³çåºç¡ä¸ï¼æç§æ¦çè°æ´æéï¼è¿è¡è´è½½åéã\n\nãç¤ºä¾ãå æéæºç®æ³å®ç°ç¤ºä¾\n\npublic class WeightRandomLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    private final Random random = ThreadLocalRandom.current();\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n\n        int length = nodes.size();\n        AtomicInteger totalWeight = new AtomicInteger(0);\n        for (N node : nodes) {\n            Integer weight = node.getWeight();\n            totalWeight.getAndAdd(weight);\n        }\n\n        if (totalWeight.get() > 0) {\n            int offset = random.nextInt(totalWeight.get());\n            for (N node : nodes) {\n                // è®©éæºå¼ offset åå»æéå¼\n                offset -= node.getWeight();\n                if (offset < 0) {\n                    // è¿åç¸åºç Node\n                    return node;\n                }\n            }\n        }\n\n        // ç´æ¥éæºè¿åä¸ä¸ª\n        return nodes.get(random.nextInt(length));\n    }\n\n}\n\n\n\n# 3.2. è½®è¯¢\n\n# è½®è¯¢ç®æ³\n\nè½®è¯¢ï¼Round Robinï¼ ç®æ³çç­ç¥æ¯ï¼å°è¯·æ±ä¾æ¬¡ååå°åéæå¡å¨ã\n\nå¦ä¸å¾æç¤ºï¼è´è½½åè¡¡å¨æ¶å°æ¥èªå®¢æ·ç«¯ç 6 ä¸ªè¯·æ±ï¼(1, 3, 5) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(2, 4, 6) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\nè¯¥ç®æ³éååºæ¯ï¼åæå¡å¨å¤çè½åç¸è¿ï¼ä¸æ¯ä¸ªäºå¡å·¥ä½éå·®å¼ä¸å¤§ãå¦æå­å¨è¾å¤§å·®å¼ï¼é£ä¹å¤çè¾æ¢çæå¡å¨å°±å¯è½ä¼ç§¯åè¯·æ±ï¼æç»æ æ³æ¿æè¿å¤§çè´è½½ã\n\n\n\nãç¤ºä¾ãè½®è¯¢ç®æ³ç¤ºä¾\n\nè½®è¯¢è´è½½åè¡¡ç®æ³å®ç°\n\npublic class RoundRobinLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    private final AtomicInteger position = new AtomicInteger(0);\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n        int length = nodes.size();\n        // å¦æä½ç½®å¼å·²ç»ç­äºèç¹æ°ï¼éç½®ä¸º 0\n        position.compareAndSet(length, 0);\n        N node = nodes.get(position.get());\n        position.getAndIncrement();\n        return node;\n    }\n\n}\n\n\n# å æè½®è¯¢ç®æ³\n\nå æè½®è¯¢ï¼Weighted Round Robbinï¼ ç®æ³å¨è½®è¯¢ç®æ³çåºç¡ä¸ï¼å¢å äºæéå±æ§æ¥è°èè½¬åæå¡å¨çè¯·æ±æ°ç®ãæ§è½é«ãå¤çéåº¦å¿«çèç¹åºè¯¥è®¾ç½®æ´é«çæéï¼ä½¿å¾ååæ¶ä¼åå°è¯·æ±ååå°æéè¾é«çèç¹ä¸ã\n\nå¦ä¸å¾æç¤ºï¼æå¡å¨ A è®¾ç½®æéä¸º 5ï¼æå¡å¨ B è®¾ç½®æéä¸º 1ï¼è´è½½åè¡¡å¨æ¶å°æ¥èªå®¢æ·ç«¯ç 6 ä¸ªè¯·æ±ï¼é£ä¹ (1, 2, 3, 4, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ Aï¼(6) è¯·æ±ä¼è¢«åéå°æå¡å¨ Bã\n\n\n\nãç¤ºä¾ãå æè½®è¯¢ç®æ³å®ç°ç¤ºä¾\n\nä»¥ä¸å®ç°åºäº Dubbo å æè½®è¯¢ç®æ³åäºä¸äºç®åã\n\npublic class WeightRoundRobinLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    /**\n     * 60ç§\n     */\n    private static final int RECYCLE_PERIOD = 60000;\n\n    /**\n     * Node hashcode å° WeightedRoundRobin çæ å°å³ç³»\n     */\n    private ConcurrentMap<Integer, WeightedRoundRobin> weightMap = new ConcurrentHashMap<>();\n\n    /**\n     * åå­æ´æ°é\n     */\n    private AtomicBoolean updateLock = new AtomicBoolean();\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n\n        int totalWeight = 0;\n        long maxCurrent = Long.MIN_VALUE;\n\n        // è·åå½åæ¶é´\n        long now = System.currentTimeMillis();\n        N selectedNode = null;\n        WeightedRoundRobin selectedWRR = null;\n\n        // ä¸é¢è¿ä¸ªå¾ªç¯ä¸»è¦åäºè¿æ ·å ä»¶äºæï¼\n        //   1. éå Node åè¡¨ï¼æ£æµå½å Node æ¯å¦æç¸åºç WeightedRoundRobinï¼æ²¡æååå»º\n        //   2. æ£æµ Node æéæ¯å¦åçäºååï¼è¥ååäºï¼åæ´æ° WeightedRoundRobin ç weight å­æ®µ\n        //   3. è®© current å­æ®µå ä¸èªèº«æéï¼ç­ä»·äº current += weight\n        //   4. è®¾ç½® lastUpdate å­æ®µï¼å³ lastUpdate = now\n        //   5. å¯»æ¾å·ææå¤§ current ç Nodeï¼ä»¥å Node å¯¹åºç WeightedRoundRobinï¼\n        //      æå­èµ·æ¥ï¼çä½åç¨\n        //   6. è®¡ç®æéæ»å\n        for (N node : nodes) {\n            int hashCode = node.hashCode();\n            WeightedRoundRobin weightedRoundRobin = weightMap.get(hashCode);\n            int weight = node.getWeight();\n            if (weight < 0) {\n                weight = 0;\n            }\n\n            // æ£æµå½å Node æ¯å¦æå¯¹åºç WeightedRoundRobinï¼æ²¡æååå»º\n            if (weightedRoundRobin == null) {\n                weightedRoundRobin = new WeightedRoundRobin();\n                // è®¾ç½® Node æé\n                weightedRoundRobin.setWeight(weight);\n                // å­å¨ url å¯ä¸æ è¯ identifyString å° weightedRoundRobin çæ å°å³ç³»\n                weightMap.putIfAbsent(hashCode, weightedRoundRobin);\n                weightedRoundRobin = weightMap.get(hashCode);\n            }\n            // Node æéä¸ç­äº WeightedRoundRobin ä¸­ä¿å­çæéï¼è¯´ææéååäºï¼æ­¤æ¶è¿è¡æ´æ°\n            if (weight != weightedRoundRobin.getWeight()) {\n                weightedRoundRobin.setWeight(weight);\n            }\n\n            // è®© current å ä¸èªèº«æéï¼ç­ä»·äº current += weight\n            long current = weightedRoundRobin.increaseCurrent();\n            // è®¾ç½® lastUpdateï¼è¡¨ç¤ºè¿ææ´æ°è¿\n            weightedRoundRobin.setLastUpdate(now);\n            // æ¾åºæå¤§ç current\n            if (current > maxCurrent) {\n                maxCurrent = current;\n                // å°å·ææå¤§ current æéç Node èµå¼ç» selectedNode\n                selectedNode = node;\n                // å° Node å¯¹åºç weightedRoundRobin èµå¼ç» selectedWRRï¼çä½åç¨\n                selectedWRR = weightedRoundRobin;\n            }\n\n            // è®¡ç®æéæ»å\n            totalWeight += weight;\n        }\n\n        // å¯¹ weightMap è¿è¡æ£æ¥ï¼è¿æ»¤æé¿æ¶é´æªè¢«æ´æ°çèç¹ã\n        // è¯¥èç¹å¯è½æäºï¼nodes ä¸­ä¸åå«è¯¥èç¹ï¼æä»¥è¯¥èç¹ç lastUpdate é¿æ¶é´æ æ³è¢«æ´æ°ã\n        // è¥æªæ´æ°æ¶é¿è¶è¿éå¼åï¼å°±ä¼è¢«ç§»é¤æï¼é»è®¤éå¼ä¸º60ç§ã\n        if (!updateLock.get() && nodes.size() != weightMap.size()) {\n            if (updateLock.compareAndSet(false, true)) {\n                try {\n                    // éåä¿®æ¹ï¼å³ç§»é¤è¿æè®°å½\n                    weightMap.entrySet().removeIf(item -> now - item.getValue().getLastUpdate() > RECYCLE_PERIOD);\n                } finally {\n                    updateLock.set(false);\n                }\n            }\n        }\n\n        if (selectedNode != null) {\n            // è®© current åå»æéæ»åï¼ç­ä»·äº current -= totalWeight\n            selectedWRR.decreaseCurrent(totalWeight);\n            // è¿åå·ææå¤§ current ç Node\n            return selectedNode;\n        }\n\n        // should not happen here\n        return nodes.get(0);\n    }\n\n    protected static class WeightedRoundRobin {\n\n        // æå¡æä¾èæé\n        private int weight;\n        // å½åæé\n        private AtomicLong current = new AtomicLong(0);\n        // æåä¸æ¬¡æ´æ°æ¶é´\n        private long lastUpdate;\n\n        public long increaseCurrent() {\n            // current = current + weightï¼\n            return current.addAndGet(weight);\n        }\n\n        public long decreaseCurrent(int total) {\n            // current = current - total;\n            return current.addAndGet(-1 * total);\n        }\n\n        public int getWeight() {\n            return weight;\n        }\n\n        public void setWeight(int weight) {\n            this.weight = weight;\n            // åå§æåµä¸ï¼current = 0\n            current.set(0);\n        }\n\n        public AtomicLong getCurrent() {\n            return current;\n        }\n\n        public void setCurrent(AtomicLong current) {\n            this.current = current;\n        }\n\n        public long getLastUpdate() {\n            return lastUpdate;\n        }\n\n        public void setLastUpdate(long lastUpdate) {\n            this.lastUpdate = lastUpdate;\n        }\n\n    }\n\n}\n\n\n\n# 3.3. æå°æ´»è·æ°\n\næå°æ´»è·æ°ï¼Least Activeï¼ ç®æ³ å°è¯·æ±ååå°è¿æ¥æ°/è¯·æ±æ°æå°çåéæå¡å¨ï¼ç®åå¤çè¯·æ±æå°çæå¡å¨ï¼ã\n\n * ç¹ç¹ï¼æ ¹æ®åéæå¡å¨å½åçè¯·æ±è¿æ¥æ°ï¼å¨æåéã\n * åºæ¯ï¼éç¨äºå¯¹ç³»ç»è´è½½è¾ä¸ºæææè¯·æ±è¿æ¥æ¶é¿ç¸å·®è¾å¤§çåºæ¯ã\n\nç±äºæ¯ä¸ªè¯·æ±çè¿æ¥æ¶é¿ä¸ä¸æ ·ï¼å¦æéç¨ç®åçè½®å¾ªæéæºç®æ³ï¼é½å¯è½åºç°æäºæå¡å¨å½åè¿æ¥æ°è¿å¤§ï¼èå¦ä¸äºæå¡å¨çè¿æ¥è¿å°çæåµï¼è¿å°±é æäºè´è½½å¹¶éçæ­£åè¡¡ãè½ç¶ï¼è½®è¯¢æç®æ³é½å¯ä»¥éè¿å æéå±æ§çæ¹å¼è¿è¡è´è½½è°æ´ï¼ä½å ææ¹å¼é¾ä»¥åºå¯¹å¨æååã\n\n\n\næå°æ´»è·æ°ç®æ³ä¼è®°å½å½åæ¶å»ï¼æ¯ä¸ªåéèç¹æ­£å¨å¤ççè¿æ¥æ°ï¼ç¶åéæ©è¿æ¥æ°æå°çèç¹ãè¯¥ç­ç¥è½å¤å¨æãå®æ¶å°ååºæå¡å¨çå½åç¶åµï¼è¾ä¸ºåçå°å°è´è´£åéååï¼éç¨äºå¯¹å½åç³»ç»è´è½½è¾ä¸ºææçåºæ¯ã\n\nä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 å½åè¿æ¥æ°æå°ï¼é£ä¹æ°å°æ¥çè¯·æ± 6 å°±ä¼è¢«åéå°æå¡å¨ 1 ä¸ã\n\n\n\nå ææå°æ´»è·æ°ï¼Weighted Least Connectionï¼å¨æå°æ´»è·æ°çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½ä¸ºæ¯å°æå¡å¨åéæéï¼åæ ¹æ®æéè®¡ç®åºæ¯å°æå¡å¨è½å¤ççè¿æ¥æ°ã\n\næå°æ´»è·æ°ç®æ³å®ç°è¦ç¹ï¼æ´»è·è°ç¨æ°è¶å°ï¼è¡¨æè¯¥æå¡èç¹å¤çè½åè¶é«ï¼åä½æ¶é´åå¯å¤çæ´å¤çè¯·æ±ï¼åºä¼åå°è¯·æ±ååç»è¯¥æå¡ãå¨å·ä½å®ç°ä¸­ï¼æ¯ä¸ªæå¡èç¹å¯¹åºä¸ä¸ªæ´»è·æ° activeãåå§æåµä¸ï¼æææå¡æä¾èæ´»è·æ°åä¸º 0ãæ¯æ¶å°ä¸ä¸ªè¯·æ±ï¼æ´»è·æ°å  1ï¼å®æè¯·æ±ååå°æ´»è·æ°å 1ãå¨æå¡è¿è¡ä¸æ®µæ¶é´åï¼æ§è½å¥½çæå¡æä¾èå¤çè¯·æ±çéåº¦æ´å¿«ï¼å æ­¤æ´»è·æ°ä¸éçä¹è¶å¿«ï¼æ­¤æ¶è¿æ ·çæå¡æä¾èè½å¤ä¼åè·åå°æ°çæå¡è¯·æ±ãè¿å°±æ¯æå°æ´»è·æ°è´è½½åè¡¡ç®æ³çåºæ¬ææ³ã\n\nãç¤ºä¾ãæå°æ´»è·æ°ç®æ³å®ç°\n\nä»¥ä¸å®ç°åºäº Dubbo æå°æ´»è·æ°è´è½½åè¡¡ç®æ³åäºäºè®¸æ¹å¨ã\n\npublic class LeastActiveLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    private final Random random = new Random();\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n        int length = nodes.size();\n        // æå°çæ´»è·æ°\n        int leastActive = -1;\n        // å·æç¸åâæå°æ´»è·æ°âçæå¡èæä¾èï¼ä»¥ä¸ç¨ Node ä»£ç§°ï¼æ°é\n        int leastCount = 0;\n        // leastIndexs ç¨äºè®°å½å·æç¸åâæå°æ´»è·æ°âç Node å¨ nodes åè¡¨ä¸­çä¸æ ä¿¡æ¯\n        int[] leastIndexs = new int[length];\n        int totalWeight = 0;\n        // ç¬¬ä¸ä¸ªæå°æ´»è·æ°ç Node æéå¼ï¼ç¨äºä¸å¶ä»å·æç¸åæå°æ´»è·æ°ç Node çæéè¿è¡å¯¹æ¯ï¼\n        // ä»¥æ£æµæ¯å¦âææå·æç¸åæå°æ´»è·æ°ç Node çæéâåç¸ç­\n        int firstWeight = 0;\n        boolean sameWeight = true;\n\n        // éå nodes åè¡¨\n        for (int i = 0; i < length; i++) {\n            N node = nodes.get(i);\n            // åç°æ´å°çæ´»è·æ°ï¼éæ°å¼å§\n            if (leastActive == -1 || node.getActive() < leastActive) {\n                // ä½¿ç¨å½åæ´»è·æ°æ´æ°æå°æ´»è·æ° leastActive\n                leastActive = node.getActive();\n                // æ´æ° leastCount ä¸º 1\n                leastCount = 1;\n                // è®°å½å½åä¸æ å¼å° leastIndexs ä¸­\n                leastIndexs[0] = i;\n                totalWeight = node.getWeight();\n                firstWeight = node.getWeight();\n                sameWeight = true;\n\n                // å½å Node çæ´»è·æ° node.getActive() ä¸æå°æ´»è·æ° leastActive ç¸å\n            } else if (node.getActive() == leastActive) {\n                // å¨ leastIndexs ä¸­è®°å½ä¸å½å Node å¨ nodes éåä¸­çä¸æ \n                leastIndexs[leastCount++] = i;\n                // ç´¯å æé\n                totalWeight += node.getWeight();\n                // æ£æµå½å Node çæéä¸ firstWeight æ¯å¦ç¸ç­ï¼\n                // ä¸ç¸ç­åå° sameWeight ç½®ä¸º false\n                if (sameWeight && i > 0\n                    && node.getWeight() != firstWeight) {\n                    sameWeight = false;\n                }\n            }\n        }\n\n        // å½åªæä¸ä¸ª Node å·ææå°æ´»è·æ°ï¼æ­¤æ¶ç´æ¥è¿åè¯¥ Node å³å¯\n        if (leastCount == 1) {\n            return nodes.get(leastIndexs[0]);\n        }\n\n        // æå¤ä¸ª Node å·æç¸åçæå°æ´»è·æ°ï¼ä½å®ä»¬ä¹é´çæéä¸å\n        if (!sameWeight && totalWeight > 0) {\n            // éæºçæä¸ä¸ª [0, totalWeight) ä¹é´çæ°å­\n            int offsetWeight = random.nextInt(totalWeight);\n            // å¾ªç¯è®©éæºæ°åå»å·ææå°æ´»è·æ°ç Node çæéå¼ï¼\n            // å½ offset å°äºç­äº0æ¶ï¼è¿åç¸åºç Node\n            for (int i = 0; i < leastCount; i++) {\n                int leastIndex = leastIndexs[i];\n                // è·åæéå¼ï¼å¹¶è®©éæºæ°åå»æéå¼\n                offsetWeight -= nodes.get(leastIndex).getWeight();\n                if (offsetWeight <= 0) {\n                    return nodes.get(leastIndex);\n                }\n            }\n        }\n        // å¦ææéç¸åææéä¸º0æ¶ï¼éæºè¿åä¸ä¸ª Node\n        return nodes.get(leastIndexs[random.nextInt(leastCount)]);\n    }\n\n}\n\n\n\n# 3.4. åå¸\n\nåå¸ï¼IP Hashï¼ ç®æ³æ ¹æ®ä¸ä¸ª key ï¼å¯ä»¥æ¯å¯ä¸ IDãIP ç­ï¼ï¼éè¿åå¸è®¡ç®å¾å°ä¸ä¸ªæ°å¼ï¼ç¨è¯¥æ°å¼å¨åéæå¡å¨åè¡¨çè¿è¡åæ¨¡è¿ç®ï¼å¾å°çç»æä¾¿æ¯éä¸­çæå¡å¨ã\n\n\n\nå¯ä»¥ä¿è¯åä¸ IP çå®¢æ·ç«¯çè¯·æ±ä¼è½¬åå°åä¸å°æå¡å¨ä¸ï¼ç¨æ¥å®ç°ä¼è¯ç²æ»ï¼Sticky Sessionï¼ã\n\n * ç¹ç¹ï¼ä¿è¯ç¹å®ç¨æ·æ»æ¯è¯·æ±å°ç¸åçæå¡å¨ï¼è¥æå¡å¨å®æºï¼ä¼è¯ä¼ä¸¢å¤±ã\n\nãç¤ºä¾ãæºå°ååå¸ç®æ³å®ç°ç¤ºä¾\n\npublic class IpHashLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n        if (StrUtil.isBlank(ip)) {\n            ip = "127.0.0.1";\n        }\n\n        int length = nodes.size();\n        int index = hash(ip) % length;\n        return nodes.get(index);\n    }\n\n    public int hash(String text) {\n        return HashUtil.fnvHash(text);\n    }\n\n}\n\n\n\n# 3.5. ä¸è´æ§åå¸\n\nä¸è´æ§åå¸ï¼Consistent Hashï¼ç®æ³çç®æ æ¯ï¼ç¸åçè¯·æ±å°½å¯è½è½å°åä¸ä¸ªæå¡å¨ä¸ã\n\nä¸è´æ§åå¸ å¯ä»¥å¾å¥½çè§£å³ ç¨³å®æ§é®é¢ï¼å¯ä»¥å°ææç å­å¨èç¹ æåå¨ é¦å°¾ç¸æ¥ ç Hash ç¯ä¸ï¼æ¯ä¸ª key å¨è®¡ç® Hash åä¼ é¡ºæ¶é æ¾å° ä¸´æ¥ ç å­å¨èç¹ å­æ¾ãèå½æèç¹ å å¥ æ éåº æ¶ï¼ä»å½±åè¯¥èç¹å¨ Hash ç¯ä¸ é¡ºæ¶éç¸é» ç åç»­èç¹ã\n\n\n\n * ç¸åçè¯·æ±æ¯æï¼ä¸è¬å¨ä½¿ç¨ä¸è´æ§åå¸æ¶ï¼éè¦æå®ä¸ä¸ª key ç¨äº hash è®¡ç®ï¼å¯è½æ¯ï¼\n   * ç¨æ· ID\n   * è¯·æ±æ¹ IP\n   * è¯·æ±æå¡åç§°ï¼åæ°åè¡¨ææçä¸²\n * å°½å¯è½æ¯æï¼æå¡å¨å¯è½åçä¸ä¸çº¿ï¼å°æ°æå¡å¨çååä¸åºè¯¥å½±åå¤§å¤æ°çè¯·æ±ã\n\nå½æå°åéæå¡å¨å®æºæ¶ï¼åæ¬åå¾è¯¥æå¡å¨çè¯·æ±ï¼ä¼åºäºèæèç¹ï¼å¹³æå°å¶å®åéæå¡å¨ï¼ä¸ä¼å¼èµ·å§çåå¨ã\n\n * ä¼ç¹\n\nå å¥ å å é¤ èç¹åªå½±å åå¸ç¯ ä¸­ é¡ºæ¶éæ¹å ç ç¸é»çèç¹ï¼å¯¹å¶ä»èç¹æ å½±åã\n\n * ç¼ºç¹\n\nå åèç¹ ä¼é æ åå¸ç¯ ä¸­é¨åæ°æ® æ æ³å½ä¸­ãå½ä½¿ç¨ å°éèç¹ æ¶ï¼èç¹åå å°å¤§èå´å½±å åå¸ç¯ ä¸­ æ°æ®æ å°ï¼ä¸éå å°éæ°æ®èç¹ çåå¸å¼æ¹æ¡ãæ®é ç ä¸è´æ§åå¸ååº å¨å¢åèç¹æ¶éè¦ å¢å ä¸å æ åå»ä¸å èç¹æè½ä¿è¯ æ°æ® å è´è½½çåè¡¡ã\n\n> æ³¨æï¼å ä¸º ä¸è´æ§åå¸ååº çè¿äºç¼ºç¹ï¼ä¸äºåå¸å¼ç³»ç»éç¨ èææ§½ å¯¹ ä¸è´æ§åå¸ è¿è¡æ¹è¿ï¼æ¯å¦ Dynamo ç³»ç»ã\n\nãç¤ºä¾ãä¸è´æ§åå¸ç®æ³ç¤ºä¾\n\nä»¥ä¸ç¤ºä¾åºäº Dubbo çä¸è´æ§åå¸è´è½½åè¡¡ç®æ³åäºä¸äºç®åã\n\npublic class ConsistentHashLoadBalance<N extends Node> extends BaseLoadBalance<N> implements LoadBalance<N> {\n\n    private final ConcurrentMap<String, ConsistentHashSelector<?>> selectors = new ConcurrentHashMap<>();\n\n    @SuppressWarnings("unchecked")\n    @Override\n    protected N doSelect(List<N> nodes, String ip) {\n        // åçæ°ï¼è¿éè®¾ä¸ºèç¹æ°ç 4 å\n        Integer replicaNum = nodes.size() * 4;\n        // è·å nodes åå§ç hashcode\n        int identityHashCode = System.identityHashCode(nodes);\n\n        // å¦æ nodes æ¯ä¸ä¸ªæ°ç List å¯¹è±¡ï¼æå³çèç¹æ°éåçäºåå\n        // æ­¤æ¶ selector.identityHashCode != identityHashCode æ¡ä»¶æç«\n        ConsistentHashSelector<N> selector = (ConsistentHashSelector<N>) selectors.get(ip);\n        if (selector == null || selector.identityHashCode != identityHashCode) {\n            // åå»ºæ°ç ConsistentHashSelector\n            selectors.put(ip, new ConsistentHashSelector<>(nodes, identityHashCode, replicaNum));\n            selector = (ConsistentHashSelector<N>) selectors.get(ip);\n        }\n        // è°ç¨ ConsistentHashSelector ç select æ¹æ³éæ© Node\n        return selector.select(ip);\n    }\n\n    /**\n     * ä¸è´æ§åå¸éæ©å¨\n     */\n    private static final class ConsistentHashSelector<N extends Node> {\n\n        /**\n         * å­å¨èæèç¹\n         */\n        private final TreeMap<Long, N> virtualNodes;\n\n        private final int identityHashCode;\n\n        /**\n         * æé å¨\n         *\n         * @param nodes            èç¹åè¡¨\n         * @param identityHashCode hashcode\n         * @param replicaNum       åçæ°\n         */\n        ConsistentHashSelector(List<N> nodes, int identityHashCode, Integer replicaNum) {\n            this.virtualNodes = new TreeMap<>();\n            this.identityHashCode = identityHashCode;\n            // è·åèæèç¹æ°ï¼é»è®¤ä¸º 100\n            if (replicaNum == null) {\n                replicaNum = 100;\n            }\n            for (N node : nodes) {\n                for (int i = 0; i < replicaNum / 4; i++) {\n                    // å¯¹ url è¿è¡ md5 è¿ç®ï¼å¾å°ä¸ä¸ªé¿åº¦ä¸º16çå­èæ°ç»\n                    byte[] digest = md5(node.getUrl());\n                    // å¯¹ digest é¨åå­èè¿è¡ 4 æ¬¡ hash è¿ç®ï¼å¾å°åä¸ªä¸åç long åæ­£æ´æ°\n                    for (int j = 0; j < 4; j++) {\n                        // h = 0 æ¶ï¼å digest ä¸­ä¸æ ä¸º 0 ~ 3 ç4ä¸ªå­èè¿è¡ä½è¿ç®\n                        // h = 1 æ¶ï¼å digest ä¸­ä¸æ ä¸º 4 ~ 7 ç4ä¸ªå­èè¿è¡ä½è¿ç®\n                        // h = 2, h = 3 æ¶è¿ç¨åä¸\n                        long m = hash(digest, j);\n                        // å° hash å° node çæ å°å³ç³»å­å¨å° virtualNodes ä¸­ï¼\n                        // virtualNodes éè¦æä¾é«æçæ¥è¯¢æä½ï¼å æ­¤éç¨ TreeMap ä½ä¸ºå­å¨ç»æ\n                        virtualNodes.put(m, node);\n                    }\n                }\n            }\n        }\n\n        public N select(String key) {\n            // å¯¹åæ° key è¿è¡ md5 è¿ç®\n            byte[] digest = md5(key);\n            // å digest æ°ç»çååä¸ªå­èè¿è¡ hash è¿ç®ï¼åå° hash å¼ä¼ ç» selectForKey æ¹æ³ï¼\n            // å¯»æ¾åéç Node\n            return selectForKey(hash(digest, 0));\n        }\n\n        private N selectForKey(long hash) {\n            // æ¥æ¾ç¬¬ä¸ä¸ªå¤§äºæç­äºå½å hash çèç¹\n            Map.Entry<Long, N> entry = virtualNodes.ceilingEntry(hash);\n            // å¦æ hash å¤§äº Node å¨åå¸ç¯ä¸æå¤§çä½ç½®ï¼æ­¤æ¶ entry = nullï¼\n            // éè¦å° TreeMap çå¤´èç¹èµå¼ç» entry\n            if (entry == null) {\n                entry = virtualNodes.firstEntry();\n            }\n            // è¿å Node\n            return entry.getValue();\n        }\n\n    }\n\n    /**\n     * è®¡ç® hash å¼\n     */\n    public static long hash(byte[] digest, int number) {\n        return (((long) (digest[3 + number * 4] & 0xFF) << 24)\n            | ((long) (digest[2 + number * 4] & 0xFF) << 16)\n            | ((long) (digest[1 + number * 4] & 0xFF) << 8)\n            | (digest[number * 4] & 0xFF))\n            & 0xFFFFFFFFL;\n    }\n\n    /**\n     * è®¡ç® MD5 å¼\n     */\n    public static byte[] md5(String value) {\n        MessageDigest md5;\n        try {\n            md5 = MessageDigest.getInstance("MD5");\n        } catch (NoSuchAlgorithmException e) {\n            throw new IllegalStateException(e.getMessage(), e);\n        }\n        md5.reset();\n        byte[] bytes = value.getBytes(StandardCharsets.UTF_8);\n        md5.update(bytes);\n        return md5.digest();\n    }\n\n}\n\n\n\n# 4. åèèµæ\n\n * Comparing Load Balancing Algorithms\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * å¤§åç½ç«æ¶æç³»åï¼è´è½½åè¡¡è¯¦è§£ï¼1ï¼\n * ä»ä¹æ¯è´è½½åè¡¡\n * What Is Load Balancing\n * Dubbo å®æ¹è´è½½åè¡¡ç®æ³è¯´æ\n * è´è½½åè¡¡ç®æ³åææ®µ\n * å©ç¨ dns è§£ææ¥å®ç°ç½ç«çè´è½½åè¡¡',normalizedContent:'# æ·±å¥æµåºè´è½½åè¡¡\n\n\n\n\n# 1. è´è½½åè¡¡ç®ä»\n\n\n# 1.1. å¤§åç½ç«é¢ä¸´çææ\n\nå¤§åç½ç«é½è¦é¢å¯¹åºå¤§çç¨æ·éï¼é«å¹¶åï¼æµ·éæ°æ®ç­ææã\n\nä¸ºäºæåç³»ç»æ´ä½çæ§è½ï¼å¯ä»¥éç¨åç´æ©å±åæ°´å¹³æ©å±ä¸¤ç§æ¹å¼ã\n\n * åç´æ©å±ï¼å¨ç½ç«åå±æ©æï¼å¯ä»¥ä»åæºçè§åº¦éè¿å¢å ç¡¬ä»¶å¤çè½åï¼æ¯å¦ cpu å¤çè½åï¼åå­å®¹éï¼ç£çç­æ¹é¢ï¼å®ç°æå¡å¨å¤çè½åçæåãä½æ¯ï¼åæºæ¯ææ§è½ç¶é¢çï¼ä¸æ¦è§¦åç¶é¢ï¼åæ³æåï¼ä»åºçææ¬åä»£ä»·ä¼æé«ãè¿æ¾ç¶ä¸è½æ»¡è¶³å¤§ååå¸å¼ç³»ç»ï¼ç½ç«ï¼ææåºå¯¹çå¤§æµéï¼é«å¹¶åï¼æµ·éæ°æ®ç­ææã\n * æ°´å¹³æ©å±ï¼éè¿éç¾¤æ¥åæå¤§åç½ç«çæµéãéç¾¤ä¸­çåºç¨æå¡å¨ï¼èç¹ï¼éå¸¸è¢«è®¾è®¡ææ ç¶æï¼ç¨æ·å¯ä»¥è¯·æ±ä»»ä½ä¸ä¸ªèç¹ï¼è¿äºèç¹å±ååæè®¿é®ååãæ°´å¹³æ©å±æä¸¤ä¸ªè¦ç¹ï¼\n   * åºç¨éç¾¤ï¼å°åä¸åºç¨é¨ç½²å°å¤å°æºå¨ä¸ï¼ç»æå¤çéç¾¤ï¼æ¥æ¶è´è½½åè¡¡è®¾å¤ååçè¯·æ±ï¼è¿è¡å¤çï¼å¹¶è¿åç¸åºæ°æ®ã\n   * è´è½½åè¡¡ï¼å°ç¨æ·è®¿é®è¯·æ±ï¼éè¿æç§ç®æ³ï¼ååå°éç¾¤ä¸­çèç¹ã\n\n\n# 1.2. ä»ä¹æ¯è´è½½åè¡¡\n\nè´è½½åè¡¡ï¼load balanceï¼ç®ç§° lbï¼æ¯é«å¹¶åãé«å¯ç¨ç³»ç»å¿ä¸å¯å°çå³é®ç»ä»¶ï¼ç®æ æ¯ å°½åå°ç½ç»æµéå¹³åååå°å¤ä¸ªæå¡å¨ä¸ï¼ä»¥æé«ç³»ç»æ´ä½çååºéåº¦åå¯ç¨æ§ã\n\nè´è½½åè¡¡çä¸»è¦ä½ç¨å¦ä¸ï¼\n\n * é«å¹¶åï¼è´è½½åè¡¡éè¿ç®æ³è°æ´è´è½½ï¼å°½åååçåéåºç¨éç¾¤ä¸­åèç¹çå·¥ä½éï¼ä»¥æ­¤æé«åºç¨éç¾¤çå¹¶åå¤çè½åï¼ååéï¼ã\n * ä¼¸ç¼©æ§ï¼æ·»å æåå°æå¡å¨æ°éï¼ç¶åç±è´è½½åè¡¡è¿è¡ååæ§å¶ãè¿ä½¿å¾åºç¨éç¾¤å·å¤ä¼¸ç¼©æ§ã\n * é«å¯ç¨ï¼è´è½½åè¡¡å¨å¯ä»¥çæ§åéæå¡å¨ï¼å½æå¡å¨ä¸å¯ç¨æ¶ï¼èªå¨è·³è¿ï¼å°è¯·æ±ååç»å¯ç¨çæå¡å¨ãè¿ä½¿å¾åºç¨éç¾¤å·å¤é«å¯ç¨çç¹æ§ã\n * å®å¨é²æ¤ï¼æäºè´è½½åè¡¡è½¯ä»¶æç¡¬ä»¶æä¾äºå®å¨æ§åè½ï¼å¦ï¼é»ç½ååå¤çãé²ç«å¢ï¼é² ddos æ»å»ç­ã\n\n\n# 2. è´è½½åè¡¡çåç±»\n\næ¯æè´è½½åè¡¡çææ¯å¾å¤ï¼æä»¬å¯ä»¥éè¿ä¸åç»´åº¦å»è¿è¡åç±»ã\n\n\n# 2.1. è½½ä½ç»´åº¦åç±»\n\nä»æ¯æè´è½½åè¡¡çè½½ä½æ¥çï¼å¯ä»¥å°è´è½½åè¡¡åä¸ºä¸¤ç±»ï¼\n\n * ç¡¬ä»¶è´è½½åè¡¡\n * è½¯ä»¶è´è½½åè¡¡\n\n# ç¡¬ä»¶è´è½½åè¡¡\n\nç¡¬ä»¶è´è½½åè¡¡ï¼ä¸è¬æ¯å¨å®å¶å¤çå¨ä¸è¿è¡çç¬ç«è´è½½åè¡¡æå¡å¨ï¼ä»·æ ¼æè´µï¼åè±ªä¸å±ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ä¸»æµäº§å æï¼f5 å a10ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ä¼ç¹ï¼\n\n * åè½å¼ºå¤§ï¼æ¯æå¨å±è´è½½åè¡¡å¹¶æä¾è¾å¨é¢çãå¤æçè´è½½åè¡¡ç®æ³ã\n * æ§è½å¼ºæï¼ç¡¬ä»¶è´è½½åè¡¡ç±äºæ¯å¨ä¸ç¨å¤çå¨ä¸è¿è¡ï¼å æ­¤ååéå¤§ï¼å¯æ¯æåæºç¾ä¸ä»¥ä¸çå¹¶åã\n * å®å¨æ§é«ï¼å¾å¾å·å¤é²ç«å¢ï¼é² ddos æ»å»ç­å®å¨åè½ã\n\nç¡¬ä»¶è´è½½åè¡¡ç ç¼ºç¹ï¼\n\n * ææ¬æè´µï¼è´­ä¹°åç»´æ¤ç¡¬ä»¶è´è½½åè¡¡çææ¬é½å¾é«ã\n * æ©å±æ§å·®ï¼å½è®¿é®éçªå¢æ¶ï¼è¶è¿éåº¦ä¸è½å¨ææ©å®¹ã\n\n# è½¯ä»¶è´è½½åè¡¡\n\nè½¯ä»¶è´è½½åè¡¡ï¼åºç¨æå¹¿æ³ï¼æ è®ºå¤§å¬å¸è¿æ¯å°å¬å¸é½ä¼ä½¿ç¨ã\n\nè½¯ä»¶è´è½½åè¡¡ä»è½¯ä»¶å±é¢å®ç°è´è½½åè¡¡ï¼ä¸è¬å¯ä»¥å¨ä»»ä½æ åç©çè®¾å¤ä¸è¿è¡ã\n\nè½¯ä»¶è´è½½åè¡¡ç ä¸»æµäº§å æï¼nginxãhaproxyãlvsã\n\n * lvs å¯ä»¥ä½ä¸ºåå±è´è½½åè¡¡å¨ãå¶è´è½½åè¡¡çæ§è½è¦ä¼äº nginxã\n * haproxy å¯ä»¥ä½ä¸º http å tcp è´è½½åè¡¡å¨ã\n * nginxãhaproxy å¯ä»¥ä½ä¸ºåå±æä¸å±è´è½½åè¡¡å¨ã\n\nè½¯ä»¶è´è½½åè¡¡ç ä¼ç¹ï¼\n\n * æ©å±æ§å¥½ï¼éåºå¨æååï¼å¯ä»¥éè¿æ·»å è½¯ä»¶è´è½½åè¡¡å®ä¾ï¼å¨ææ©å±å°è¶åºåå§å®¹éçè½åã\n * ææ¬ä½å»ï¼è½¯ä»¶è´è½½åè¡¡å¯ä»¥å¨ä»»ä½æ åç©çè®¾å¤ä¸è¿è¡ï¼éä½äºè´­ä¹°åè¿ç»´çææ¬ã\n\nè½¯ä»¶è´è½½åè¡¡ç ç¼ºç¹ï¼\n\n * æ§è½ç¥å·®ï¼ç¸æ¯äºç¡¬ä»¶è´è½½åè¡¡ï¼è½¯ä»¶è´è½½åè¡¡çæ§è½è¦ç¥ä½ä¸äºã\n\n\n# 2.2. ç½ç»éä¿¡åç±»\n\nè½¯ä»¶è´è½½åè¡¡ä»éä¿¡å±é¢æ¥çï¼åå¯ä»¥åä¸ºåå±åä¸å±è´è½½åè¡¡ã\n\n * ä¸å±è´è½½åè¡¡ï¼å°±æ¯å¯ä»¥æ ¹æ®è®¿é®ç¨æ·ç http è¯·æ±å¤´ãurl ä¿¡æ¯å°è¯·æ±è½¬åå°ç¹å®çä¸»æºã\n   * dns éå®å\n   * http éå®å\n   * ååä»£ç\n * åå±è´è½½åè¡¡ï¼åºäº ip å°ååç«¯å£è¿è¡è¯·æ±çè½¬åã\n   * ä¿®æ¹ ip å°å\n   * ä¿®æ¹ mac å°å\n\n# dns è´è½½åè¡¡\n\ndns è´è½½åè¡¡ä¸è¬ç¨äºäºèç½å¬å¸ï¼å¤æçä¸å¡ç³»ç»ä¸éåä½¿ç¨ãå¤§åç½ç«ä¸è¬ä½¿ç¨ dns è´è½½åè¡¡ä½ä¸º ç¬¬ä¸çº§è´è½½åè¡¡ææ®µï¼ç¶åå¨åé¨ä½¿ç¨å¶å®æ¹å¼åç¬¬äºçº§è´è½½åè¡¡ãdns è´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\ndns å³ ååè§£ææå¡ï¼æ¯ osi ç¬¬ä¸å±ç½ç»åè®®ãdns è¢«è®¾è®¡ä¸ºä¸ä¸ªæ å½¢ç»æçåå¸å¼åºç¨ï¼èªä¸èä¸ä¾æ¬¡ä¸ºï¼æ ¹ååæå¡å¨ï¼ä¸çº§ååæå¡å¨ï¼äºçº§ååæå¡å¨ï¼... ï¼æ¬å°ååæå¡å¨ãæ¾ç¶ï¼å¦ææææ°æ®é½å­å¨å¨æ ¹ååæå¡å¨ï¼é£ä¹ dns æ¥è¯¢çè´è½½åå¼éä¼éå¸¸åºå¤§ã\n\nå æ­¤ï¼dns æ¥è¯¢ç¸å¯¹äº dns å±çº§ç»æï¼æ¯ä¸ä¸ªéåçéå½æµç¨ï¼dns å®¢æ·ç«¯ä¾æ¬¡è¯·æ±æ¬å° dns æå¡å¨ï¼ä¸ä¸çº§ dns æå¡å¨ï¼ä¸ä¸ä¸çº§ dns æå¡å¨ï¼... ï¼æ ¹ dns æå¡å¨ï¼åå«æå¨ dns æå¡å¨ï¼ï¼ä¸æ¦å½ä¸­ï¼ç«å³è¿åãä¸ºäºåå°æ¥è¯¢æ¬¡æ°ï¼æ¯ä¸çº§ dns æå¡å¨é½ä¼è®¾ç½® dns æ¥è¯¢ç¼å­ã\n\ndns è´è½½åè¡¡çå·¥ä½åçå°±æ¯ï¼åºäº dns æ¥è¯¢ç¼å­ï¼æç§è´è½½æåµè¿åä¸åæå¡å¨ç ip å°åã\n\n\n\ndns éå®åç ä¼ç¹ï¼\n\n * ä½¿ç¨ç®åï¼è´è½½åè¡¡å·¥ä½ï¼äº¤ç» dns æå¡å¨å¤çï¼çæäºè´è½½åè¡¡æå¡å¨ç»´æ¤çéº»ç¦\n * æé«æ§è½ï¼å¯ä»¥æ¯æåºäºå°åçååè§£æï¼è§£ææè·ç¦»ç¨æ·æè¿çæå¡å¨å°åï¼ç±»ä¼¼ cdn çåçï¼ï¼å¯ä»¥å å¿«è®¿é®éåº¦ï¼æ¹åæ§è½ï¼\n\ndns éå®åç ç¼ºç¹ï¼\n\n * å¯ç¨æ§å·®ï¼dns è§£ææ¯å¤çº§è§£æï¼æ°å¢/ä¿®æ¹ dns åï¼è§£ææ¶é´è¾é¿ï¼è§£æè¿ç¨ä¸­ï¼ç¨æ·è®¿é®ç½ç«å°å¤±è´¥ï¼\n * æ©å±æ§ä½ï¼dns è´è½½åè¡¡çæ§å¶æå¨åååé£éï¼æ æ³å¯¹å¶åæ´å¤çæ¹ååæ©å±ï¼\n * ç»´æ¤æ§å·®ï¼ä¹ä¸è½åæ æå¡å¨çå½åè¿è¡ç¶æï¼æ¯æçç®æ³å°ï¼ä¸è½åºåæå¡å¨çå·®å¼ï¼ä¸è½æ ¹æ®ç³»ç»ä¸æå¡çç¶ææ¥å¤æ­è´è½½ï¼\n\n# http è´è½½åè¡¡\n\nhttp è´è½½åè¡¡æ¯åºäº http éå®åå®ç°çãhttp è´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\nhttp éå®ååçæ¯ï¼æ ¹æ®ç¨æ·ç http è¯·æ±è®¡ç®åºä¸ä¸ªçå®çæå¡å¨å°åï¼å°è¯¥æå¡å¨å°ååå¥ http éå®åååºä¸­ï¼è¿åç»æµè§å¨ï¼ç±æµè§å¨éæ°è¿è¡è®¿é®ã\n\n\n\nhttp éå®åç ä¼ç¹ï¼æ¹æ¡ç®åã\n\nhttp éå®åç ç¼ºç¹ï¼\n\n * æ§è½è¾å·®ï¼æ¯æ¬¡è®¿é®éè¦ä¸¤æ¬¡è¯·æ±æå¡å¨ï¼å¢å äºè®¿é®çå»¶è¿ã\n * éä½æç´¢æåï¼ä½¿ç¨éå®ååï¼æç´¢å¼æä¼è§ä¸º seo ä½å¼ã\n * å¦æè´è½½åè¡¡å¨å®æºï¼å°±æ æ³è®¿é®è¯¥ç«ç¹ã\n\nç±äºå¶ç¼ºç¹æ¯è¾ææ¾ï¼æä»¥è¿ç§è´è½½åè¡¡ç­ç¥å®éåºç¨è¾å°ã\n\n# ååä»£çè´è½½åè¡¡\n\nååä»£çï¼reverse proxyï¼æ¹å¼æ¯æä»¥ ä»£çæå¡å¨ æ¥æ¥åç½ç»è¯·æ±ï¼ç¶å å°è¯·æ±è½¬åç»åç½ä¸­çæå¡å¨ï¼å¹¶å°ä»åç½ä¸­çæå¡å¨ä¸å¾å°çç»æè¿åç»ç½ç»è¯·æ±çå®¢æ·ç«¯ãååä»£çè´è½½åè¡¡å±äºä¸å±è´è½½åè¡¡ã\n\nååä»£çæå¡çä¸»æµäº§åï¼nginxãapacheã\n\næ­£åä»£çä¸ååä»£çæä»ä¹åºå«ï¼\n\n * æ­£åä»£çï¼åçå¨ å®¢æ·ç«¯ï¼æ¯ç±ç¨æ·ä¸»å¨åèµ·çãç¿»å¢è½¯ä»¶å°±æ¯å¸åçæ­£åä»£çï¼å®¢æ·ç«¯éè¿ä¸»å¨è®¿é®ä»£çæå¡å¨ï¼è®©ä»£çæå¡å¨è·å¾éè¦çå¤ç½æ°æ®ï¼ç¶åè½¬ååå®¢æ·ç«¯ã\n * ååä»£çï¼åçå¨ æå¡ç«¯ï¼ç¨æ·ä¸ç¥éä»£ççå­å¨ã\n\n\n\nååä»£çæ¯å¦ä½å®ç°è´è½½åè¡¡çå¢ï¼ä»¥ nginx ä¸ºä¾ï¼å¦ä¸æç¤ºï¼\n\n\n\né¦åï¼å¨ä»£çæå¡å¨ä¸è®¾å®å¥½è´è½½åè¡¡è§åãç¶åï¼å½æ¶å°å®¢æ·ç«¯è¯·æ±ï¼ååä»£çæå¡å¨æ¦æªæå®çååæ ip è¯·æ±ï¼æ ¹æ®è´è½½åè¡¡ç®æ³ï¼å°è¯·æ±ååå°åéæå¡å¨ä¸ãå¶æ¬¡ï¼å¦ææå°åéæå¡å¨å®æºï¼ååä»£çæå¡å¨ä¼æå®¹éå¤çï¼æ¯å¦ååè¯·æ±å¤±è´¥ 3 æ¬¡ä»¥ä¸ï¼å°è¯·æ±ååå°å¶ä»åéæå¡å¨ä¸ã\n\nååä»£çç ä¼ç¹ï¼\n\n * å¤ç§è´è½½åè¡¡ç®æ³ï¼æ¯æå¤ç§è´è½½åè¡¡ç®æ³ï¼ä»¥åºå¯¹ä¸åçåºæ¯éæ±ã\n * å¯ä»¥çæ§æå¡å¨ï¼åºäº http åè®®ï¼å¯ä»¥çæ§è½¬åæå¡å¨çç¶æï¼å¦ï¼ç³»ç»è´è½½ãååºæ¶é´ãæ¯å¦å¯ç¨ãè¿æ¥æ°ãæµéç­ï¼ä»èæ ¹æ®è¿äºæ°æ®è°æ´è´è½½åè¡¡çç­ç¥ã\n\nååä»£çç ç¼ºç¹ï¼\n\n * é¢å¤çè½¬åå¼éï¼ååä»£ççè½¬åæä½æ¬èº«æ¯ææ§è½å¼éçï¼å¯è½ä¼åæ¬åå»ºè¿æ¥ï¼ç­å¾è¿æ¥ååºï¼åæååºç»æç­æä½ã\n\n * å¢å ç³»ç»å¤æåº¦ï¼ååä»£çå¸¸ç¨äºååå¸å¼åºç¨çæ°´å¹³æ©å±ï¼ä½ååä»£çæå¡å­å¨ä»¥ä¸é®é¢ï¼ä¸ºäºè§£å³ä»¥ä¸é®é¢ä¼ç»ç³»ç»æ´ä½å¢å é¢å¤çå¤æåº¦åè¿ç»´ææ¬ï¼\n   \n   * ååä»£çæå¡å¦æèªèº«å®æºï¼å°±æ æ³è®¿é®ç«ç¹ï¼æä»¥éè¦æ é«å¯ç¨ æ¹æ¡ï¼å¸¸è§çæ¹æ¡æï¼ä¸»å¤æ¨¡å¼ï¼ä¸ä¸»ä¸å¤ï¼ãåä¸»æ¨¡å¼ï¼äºä¸ºä¸»å¤ï¼ã\n   * ååä»£çæå¡èªèº«ä¹å­å¨æ§è½ç¶é¢ï¼éçéè¦è½¬åçè¯·æ±éä¸æ­æåï¼éè¦æ å¯æ©å± æ¹æ¡ã\n\n# ip è´è½½åè¡¡\n\nip è´è½½åè¡¡æ¯å¨ç½ç»å±éè¿ä¿®æ¹è¯·æ±ç®çå°åè¿è¡è´è½½åè¡¡ã\n\n\n\nå¦ä¸å¾æç¤ºï¼ip åè¡¡å¤çæµç¨å¤§è´ä¸ºï¼\n\n 1. å®¢æ·ç«¯è¯·æ± 192.168.137.10ï¼ç±è´è½½åè¡¡æå¡å¨æ¥æ¶å°æ¥æã\n 2. è´è½½åè¡¡æå¡å¨æ ¹æ®ç®æ³éåºä¸ä¸ªæå¡èç¹ 192.168.0.1ï¼ç¶åå°æ¥æè¯·æ±å°åæ¹ä¸ºè¯¥èç¹ç ipã\n 3. çå®æå¡èç¹æ¶å°è¯·æ±æ¥æï¼å¤çåï¼è¿åååºæ°æ®å°è´è½½åè¡¡æå¡å¨ã\n 4. è´è½½åè¡¡æå¡å¨å°ååºæ°æ®çæºå°åæ¹è´è½½åè¡¡æå¡å¨å°åï¼è¿åç»å®¢æ·ç«¯ã\n\nip è´è½½åè¡¡å¨åæ ¸è¿ç¨å®ææ°æ®ååï¼è¾ååä»£çè´è½½åè¡¡ææ´å¥½çä»å¤çæ§è½ãä½æ¯ï¼ç±äºææè¯·æ±ååºé½è¦ç»è¿è´è½½åè¡¡æå¡å¨ï¼éç¾¤çååéåå¶äºè´è½½åè¡¡æå¡å¨çå¸¦å®½ã\n\n# æ°æ®é¾è·¯å±è´è½½åè¡¡\n\næ°æ®é¾è·¯å±è´è½½åè¡¡æ¯æå¨éä¿¡åè®®çæ°æ®é¾è·¯å±ä¿®æ¹ mac å°åè¿è¡è´è½½åè¡¡ã\n\n\n\nå¨ linux å¹³å°ä¸æå¥½çé¾è·¯å±è´è½½åè¡¡å¼æºäº§åæ¯ lvs (linux virtual server)ã\n\nlvs æ¯åºäº linux åæ ¸ä¸­ netfilter æ¡æ¶å®ç°çè´è½½åè¡¡ç³»ç»ãnetfilter æ¯åæ ¸æç linux é²ç«å¢æºå¶ï¼å¯ä»¥å¨æ°æ®åæµç»è¿ç¨ä¸­ï¼æ ¹æ®è§åè®¾ç½®è¥å¹²ä¸ªå³å¡ï¼hook å½æ°ï¼æ¥æ§è¡ç¸å³çæä½ã\n\nlvs çå·¥ä½æµç¨å¤§è´å¦ä¸ï¼\n\n * å½ç¨æ·è®¿é® www.sina.com.cn æ¶ï¼ç¨æ·æ°æ®éè¿å±å±ç½ç»ï¼æåéè¿äº¤æ¢æºè¿å¥ lvs æå¡å¨ç½å¡ï¼å¹¶è¿å¥åæ ¸ç½ç»å±ã\n * è¿å¥ prerouting åç»è¿è·¯ç±æ¥æ¾ï¼ç¡®å®è®¿é®çç®ç vip æ¯æ¬æº ip å°åï¼æä»¥æ°æ®åè¿å¥å° input é¾ä¸\n * ipvs æ¯å·¥ä½å¨ input é¾ä¸ï¼ä¼æ ¹æ®è®¿é®ç vip+port å¤æ­è¯·æ±æ¯å¦ ipvs æå¡ï¼å¦ææ¯åè°ç¨æ³¨åç ipvs hook å½æ°ï¼è¿è¡ ipvs ç¸å³ä¸»æµç¨ï¼å¼ºè¡ä¿®æ¹æ°æ®åçç¸å³æ°æ®ï¼å¹¶å°æ°æ®ååå¾ postrouting é¾ä¸ã\n * postrouting ä¸æ¶å°æ°æ®ååï¼æ ¹æ®ç®æ  ip å°åï¼åç«¯æå¡å¨ï¼ï¼éè¿è·¯ç±éè·¯ï¼å°æ°æ®åæç»åå¾åç«¯çæå¡å¨ä¸ã\n\nå¼æº lvs çæ¬æ 3 ç§å·¥ä½æ¨¡å¼ï¼æ¯ç§æ¨¡å¼å·¥ä½åçæªç¶ä¸åï¼è¯´åç§æ¨¡å¼é½æèªå·±çä¼ç¼ºç¹ï¼åå«éåä¸åçåºç¨åºæ¯ï¼ä¸è¿æç»æ¬è´¨çåè½é½æ¯è½å®ç°åè¡¡çæµéè°åº¦åè¯å¥½çæ©å±æ§ãä¸»è¦åæ¬ä¸ç§æ¨¡å¼ï¼dr æ¨¡å¼ãnat æ¨¡å¼ãtunnel æ¨¡å¼ã\n\n\n# 3. è´è½½åè¡¡ç®æ³\n\nè´è½½åè¡¡å¨çå®ç°å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\n * æ ¹æ®è´è½½åè¡¡ç®æ³å¨åéæå¡å¨åè¡¨éåºä¸ä¸ªæå¡å¨ï¼\n * å°è¯·æ±æ°æ®åéå°è¯¥æå¡å¨ä¸ã\n\nè´è½½åè¡¡ç®æ³æ¯è´è½½åè¡¡æå¡æ ¸å¿ä¸­çæ ¸å¿ãè´è½½åè¡¡äº§åå¤ç§å¤æ ·ï¼ä½æ¯åç§è´è½½åè¡¡ç®æ³åçæ¯å±æ§çã\n\nè´è½½åè¡¡ç®æ³æå¾å¤ç§ï¼åå«éç¨äºä¸åçåºç¨åºæ¯ï¼æ¬æä»ä»ç»æä¸ºå¸¸è§çè´è½½åè¡¡ç®æ³çç¹æ§ååçï¼è½®è¯¢ãéæºãæå°æ´»è·æ°ãæºå°ååå¸ãä¸è´æ§åå¸ã\n\n> æ³¨ï¼è´è½½åè¡¡ç®æ³çå®ç°ï¼æ¨èéè¯» dubbo å®æ¹è´è½½åè¡¡ç®æ³è¯´æ ï¼æºç è®²è§£éå¸¸è¯¦ç»ï¼éå¸¸å¼å¾åé´ã\n> \n> ä¸æä¸­çåç§ç®æ³çå¯æ§è¡ç¤ºä¾å·²å½æ¡£å¨ github ä»åºï¼https://github.com/dunwu/java-tutorial/tree/master/codes/java-distributed/java-load-balanceï¼å¯ä»¥éè¿æ§è¡ io.github.dunwu.javatech.loadbalancedemo æ¥çåç®æ³æ§è¡ææã\n\n\n# 3.1. éæº\n\n# éæºç®æ³\n\néæºï¼randomï¼ ç®æ³ å°è¯·æ±éæºååå°åéæå¡å¨ã\n\néæºç®æ³ éåæå¡å¨ç¡¬ä»¶ç¸åçåºæ¯ãå­¦ä¹ è¿æ¦çè®ºçé½ç¥éï¼è°ç¨éè¾å°çæ¶åï¼å¯è½è´è½½å¹¶ä¸ååï¼è°ç¨éè¶å¤§ï¼è´è½½è¶åè¡¡ã\n\n\n\nãç¤ºä¾ãéæºç®æ³å®ç°ç¤ºä¾\n\nè´è½½åè¡¡æ¥å£\n\npublic interface loadbalance<n extends node> {\n\n    n select(list<n> nodes, string ip);\n\n}\n\n\nè´è½½åè¡¡æ½è±¡ç±»\n\npublic abstract class baseloadbalance<n extends node> implements loadbalance<n> {\n\n    @override\n    public n select(list<n> nodes, string ip) {\n        if (collectionutil.isempty(nodes)) {\n            return null;\n        }\n\n        // å¦æ nodes åè¡¨ä¸­ä»æä¸ä¸ª nodeï¼ç´æ¥è¿åå³å¯ï¼æ éè¿è¡è´è½½åè¡¡\n        if (nodes.size() == 1) {\n            return nodes.get(0);\n        }\n\n        return doselect(nodes, ip);\n    }\n\n    protected abstract n doselect(list<n> nodes, string ip);\n\n}\n\n\næå¡å¨èç¹ç±»\n\npublic class node implements comparable<node> {\n\n    protected string url;\n\n    protected integer weight;\n\n    protected integer active;\n\n    // ...\n}\n\n\néæºç®æ³å®ç°\n\npublic class randomloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    private final random random = new random();\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n        // å¨åè¡¨ä¸­éæºéåä¸ä¸ªèç¹\n        int index = random.nextint(nodes.size());\n        return nodes.get(index);\n    }\n\n}\n\n\n# å æéæºç®æ³\n\nå æéæºï¼weighted randomï¼ ç®æ³å¨éæºç®æ³çåºç¡ä¸ï¼æç§æ¦çè°æ´æéï¼è¿è¡è´è½½åéã\n\nãç¤ºä¾ãå æéæºç®æ³å®ç°ç¤ºä¾\n\npublic class weightrandomloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    private final random random = threadlocalrandom.current();\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n\n        int length = nodes.size();\n        atomicinteger totalweight = new atomicinteger(0);\n        for (n node : nodes) {\n            integer weight = node.getweight();\n            totalweight.getandadd(weight);\n        }\n\n        if (totalweight.get() > 0) {\n            int offset = random.nextint(totalweight.get());\n            for (n node : nodes) {\n                // è®©éæºå¼ offset åå»æéå¼\n                offset -= node.getweight();\n                if (offset < 0) {\n                    // è¿åç¸åºç node\n                    return node;\n                }\n            }\n        }\n\n        // ç´æ¥éæºè¿åä¸ä¸ª\n        return nodes.get(random.nextint(length));\n    }\n\n}\n\n\n\n# 3.2. è½®è¯¢\n\n# è½®è¯¢ç®æ³\n\nè½®è¯¢ï¼round robinï¼ ç®æ³çç­ç¥æ¯ï¼å°è¯·æ±ä¾æ¬¡ååå°åéæå¡å¨ã\n\nå¦ä¸å¾æç¤ºï¼è´è½½åè¡¡å¨æ¶å°æ¥èªå®¢æ·ç«¯ç 6 ä¸ªè¯·æ±ï¼(1, 3, 5) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 1ï¼(2, 4, 6) çè¯·æ±ä¼è¢«åéå°æå¡å¨ 2ã\n\n\n\nè¯¥ç®æ³éååºæ¯ï¼åæå¡å¨å¤çè½åç¸è¿ï¼ä¸æ¯ä¸ªäºå¡å·¥ä½éå·®å¼ä¸å¤§ãå¦æå­å¨è¾å¤§å·®å¼ï¼é£ä¹å¤çè¾æ¢çæå¡å¨å°±å¯è½ä¼ç§¯åè¯·æ±ï¼æç»æ æ³æ¿æè¿å¤§çè´è½½ã\n\n\n\nãç¤ºä¾ãè½®è¯¢ç®æ³ç¤ºä¾\n\nè½®è¯¢è´è½½åè¡¡ç®æ³å®ç°\n\npublic class roundrobinloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    private final atomicinteger position = new atomicinteger(0);\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n        int length = nodes.size();\n        // å¦æä½ç½®å¼å·²ç»ç­äºèç¹æ°ï¼éç½®ä¸º 0\n        position.compareandset(length, 0);\n        n node = nodes.get(position.get());\n        position.getandincrement();\n        return node;\n    }\n\n}\n\n\n# å æè½®è¯¢ç®æ³\n\nå æè½®è¯¢ï¼weighted round robbinï¼ ç®æ³å¨è½®è¯¢ç®æ³çåºç¡ä¸ï¼å¢å äºæéå±æ§æ¥è°èè½¬åæå¡å¨çè¯·æ±æ°ç®ãæ§è½é«ãå¤çéåº¦å¿«çèç¹åºè¯¥è®¾ç½®æ´é«çæéï¼ä½¿å¾ååæ¶ä¼åå°è¯·æ±ååå°æéè¾é«çèç¹ä¸ã\n\nå¦ä¸å¾æç¤ºï¼æå¡å¨ a è®¾ç½®æéä¸º 5ï¼æå¡å¨ b è®¾ç½®æéä¸º 1ï¼è´è½½åè¡¡å¨æ¶å°æ¥èªå®¢æ·ç«¯ç 6 ä¸ªè¯·æ±ï¼é£ä¹ (1, 2, 3, 4, 5) è¯·æ±ä¼è¢«åéå°æå¡å¨ aï¼(6) è¯·æ±ä¼è¢«åéå°æå¡å¨ bã\n\n\n\nãç¤ºä¾ãå æè½®è¯¢ç®æ³å®ç°ç¤ºä¾\n\nä»¥ä¸å®ç°åºäº dubbo å æè½®è¯¢ç®æ³åäºä¸äºç®åã\n\npublic class weightroundrobinloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    /**\n     * 60ç§\n     */\n    private static final int recycle_period = 60000;\n\n    /**\n     * node hashcode å° weightedroundrobin çæ å°å³ç³»\n     */\n    private concurrentmap<integer, weightedroundrobin> weightmap = new concurrenthashmap<>();\n\n    /**\n     * åå­æ´æ°é\n     */\n    private atomicboolean updatelock = new atomicboolean();\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n\n        int totalweight = 0;\n        long maxcurrent = long.min_value;\n\n        // è·åå½åæ¶é´\n        long now = system.currenttimemillis();\n        n selectednode = null;\n        weightedroundrobin selectedwrr = null;\n\n        // ä¸é¢è¿ä¸ªå¾ªç¯ä¸»è¦åäºè¿æ ·å ä»¶äºæï¼\n        //   1. éå node åè¡¨ï¼æ£æµå½å node æ¯å¦æç¸åºç weightedroundrobinï¼æ²¡æååå»º\n        //   2. æ£æµ node æéæ¯å¦åçäºååï¼è¥ååäºï¼åæ´æ° weightedroundrobin ç weight å­æ®µ\n        //   3. è®© current å­æ®µå ä¸èªèº«æéï¼ç­ä»·äº current += weight\n        //   4. è®¾ç½® lastupdate å­æ®µï¼å³ lastupdate = now\n        //   5. å¯»æ¾å·ææå¤§ current ç nodeï¼ä»¥å node å¯¹åºç weightedroundrobinï¼\n        //      æå­èµ·æ¥ï¼çä½åç¨\n        //   6. è®¡ç®æéæ»å\n        for (n node : nodes) {\n            int hashcode = node.hashcode();\n            weightedroundrobin weightedroundrobin = weightmap.get(hashcode);\n            int weight = node.getweight();\n            if (weight < 0) {\n                weight = 0;\n            }\n\n            // æ£æµå½å node æ¯å¦æå¯¹åºç weightedroundrobinï¼æ²¡æååå»º\n            if (weightedroundrobin == null) {\n                weightedroundrobin = new weightedroundrobin();\n                // è®¾ç½® node æé\n                weightedroundrobin.setweight(weight);\n                // å­å¨ url å¯ä¸æ è¯ identifystring å° weightedroundrobin çæ å°å³ç³»\n                weightmap.putifabsent(hashcode, weightedroundrobin);\n                weightedroundrobin = weightmap.get(hashcode);\n            }\n            // node æéä¸ç­äº weightedroundrobin ä¸­ä¿å­çæéï¼è¯´ææéååäºï¼æ­¤æ¶è¿è¡æ´æ°\n            if (weight != weightedroundrobin.getweight()) {\n                weightedroundrobin.setweight(weight);\n            }\n\n            // è®© current å ä¸èªèº«æéï¼ç­ä»·äº current += weight\n            long current = weightedroundrobin.increasecurrent();\n            // è®¾ç½® lastupdateï¼è¡¨ç¤ºè¿ææ´æ°è¿\n            weightedroundrobin.setlastupdate(now);\n            // æ¾åºæå¤§ç current\n            if (current > maxcurrent) {\n                maxcurrent = current;\n                // å°å·ææå¤§ current æéç node èµå¼ç» selectednode\n                selectednode = node;\n                // å° node å¯¹åºç weightedroundrobin èµå¼ç» selectedwrrï¼çä½åç¨\n                selectedwrr = weightedroundrobin;\n            }\n\n            // è®¡ç®æéæ»å\n            totalweight += weight;\n        }\n\n        // å¯¹ weightmap è¿è¡æ£æ¥ï¼è¿æ»¤æé¿æ¶é´æªè¢«æ´æ°çèç¹ã\n        // è¯¥èç¹å¯è½æäºï¼nodes ä¸­ä¸åå«è¯¥èç¹ï¼æä»¥è¯¥èç¹ç lastupdate é¿æ¶é´æ æ³è¢«æ´æ°ã\n        // è¥æªæ´æ°æ¶é¿è¶è¿éå¼åï¼å°±ä¼è¢«ç§»é¤æï¼é»è®¤éå¼ä¸º60ç§ã\n        if (!updatelock.get() && nodes.size() != weightmap.size()) {\n            if (updatelock.compareandset(false, true)) {\n                try {\n                    // éåä¿®æ¹ï¼å³ç§»é¤è¿æè®°å½\n                    weightmap.entryset().removeif(item -> now - item.getvalue().getlastupdate() > recycle_period);\n                } finally {\n                    updatelock.set(false);\n                }\n            }\n        }\n\n        if (selectednode != null) {\n            // è®© current åå»æéæ»åï¼ç­ä»·äº current -= totalweight\n            selectedwrr.decreasecurrent(totalweight);\n            // è¿åå·ææå¤§ current ç node\n            return selectednode;\n        }\n\n        // should not happen here\n        return nodes.get(0);\n    }\n\n    protected static class weightedroundrobin {\n\n        // æå¡æä¾èæé\n        private int weight;\n        // å½åæé\n        private atomiclong current = new atomiclong(0);\n        // æåä¸æ¬¡æ´æ°æ¶é´\n        private long lastupdate;\n\n        public long increasecurrent() {\n            // current = current + weightï¼\n            return current.addandget(weight);\n        }\n\n        public long decreasecurrent(int total) {\n            // current = current - total;\n            return current.addandget(-1 * total);\n        }\n\n        public int getweight() {\n            return weight;\n        }\n\n        public void setweight(int weight) {\n            this.weight = weight;\n            // åå§æåµä¸ï¼current = 0\n            current.set(0);\n        }\n\n        public atomiclong getcurrent() {\n            return current;\n        }\n\n        public void setcurrent(atomiclong current) {\n            this.current = current;\n        }\n\n        public long getlastupdate() {\n            return lastupdate;\n        }\n\n        public void setlastupdate(long lastupdate) {\n            this.lastupdate = lastupdate;\n        }\n\n    }\n\n}\n\n\n\n# 3.3. æå°æ´»è·æ°\n\næå°æ´»è·æ°ï¼least activeï¼ ç®æ³ å°è¯·æ±ååå°è¿æ¥æ°/è¯·æ±æ°æå°çåéæå¡å¨ï¼ç®åå¤çè¯·æ±æå°çæå¡å¨ï¼ã\n\n * ç¹ç¹ï¼æ ¹æ®åéæå¡å¨å½åçè¯·æ±è¿æ¥æ°ï¼å¨æåéã\n * åºæ¯ï¼éç¨äºå¯¹ç³»ç»è´è½½è¾ä¸ºæææè¯·æ±è¿æ¥æ¶é¿ç¸å·®è¾å¤§çåºæ¯ã\n\nç±äºæ¯ä¸ªè¯·æ±çè¿æ¥æ¶é¿ä¸ä¸æ ·ï¼å¦æéç¨ç®åçè½®å¾ªæéæºç®æ³ï¼é½å¯è½åºç°æäºæå¡å¨å½åè¿æ¥æ°è¿å¤§ï¼èå¦ä¸äºæå¡å¨çè¿æ¥è¿å°çæåµï¼è¿å°±é æäºè´è½½å¹¶éçæ­£åè¡¡ãè½ç¶ï¼è½®è¯¢æç®æ³é½å¯ä»¥éè¿å æéå±æ§çæ¹å¼è¿è¡è´è½½è°æ´ï¼ä½å ææ¹å¼é¾ä»¥åºå¯¹å¨æååã\n\n\n\næå°æ´»è·æ°ç®æ³ä¼è®°å½å½åæ¶å»ï¼æ¯ä¸ªåéèç¹æ­£å¨å¤ççè¿æ¥æ°ï¼ç¶åéæ©è¿æ¥æ°æå°çèç¹ãè¯¥ç­ç¥è½å¤å¨æãå®æ¶å°ååºæå¡å¨çå½åç¶åµï¼è¾ä¸ºåçå°å°è´è´£åéååï¼éç¨äºå¯¹å½åç³»ç»è´è½½è¾ä¸ºææçåºæ¯ã\n\nä¾å¦ä¸å¾ä¸­ï¼æå¡å¨ 1 å½åè¿æ¥æ°æå°ï¼é£ä¹æ°å°æ¥çè¯·æ± 6 å°±ä¼è¢«åéå°æå¡å¨ 1 ä¸ã\n\n\n\nå ææå°æ´»è·æ°ï¼weighted least connectionï¼å¨æå°æ´»è·æ°çåºç¡ä¸ï¼æ ¹æ®æå¡å¨çæ§è½ä¸ºæ¯å°æå¡å¨åéæéï¼åæ ¹æ®æéè®¡ç®åºæ¯å°æå¡å¨è½å¤ççè¿æ¥æ°ã\n\næå°æ´»è·æ°ç®æ³å®ç°è¦ç¹ï¼æ´»è·è°ç¨æ°è¶å°ï¼è¡¨æè¯¥æå¡èç¹å¤çè½åè¶é«ï¼åä½æ¶é´åå¯å¤çæ´å¤çè¯·æ±ï¼åºä¼åå°è¯·æ±ååç»è¯¥æå¡ãå¨å·ä½å®ç°ä¸­ï¼æ¯ä¸ªæå¡èç¹å¯¹åºä¸ä¸ªæ´»è·æ° activeãåå§æåµä¸ï¼æææå¡æä¾èæ´»è·æ°åä¸º 0ãæ¯æ¶å°ä¸ä¸ªè¯·æ±ï¼æ´»è·æ°å  1ï¼å®æè¯·æ±ååå°æ´»è·æ°å 1ãå¨æå¡è¿è¡ä¸æ®µæ¶é´åï¼æ§è½å¥½çæå¡æä¾èå¤çè¯·æ±çéåº¦æ´å¿«ï¼å æ­¤æ´»è·æ°ä¸éçä¹è¶å¿«ï¼æ­¤æ¶è¿æ ·çæå¡æä¾èè½å¤ä¼åè·åå°æ°çæå¡è¯·æ±ãè¿å°±æ¯æå°æ´»è·æ°è´è½½åè¡¡ç®æ³çåºæ¬ææ³ã\n\nãç¤ºä¾ãæå°æ´»è·æ°ç®æ³å®ç°\n\nä»¥ä¸å®ç°åºäº dubbo æå°æ´»è·æ°è´è½½åè¡¡ç®æ³åäºäºè®¸æ¹å¨ã\n\npublic class leastactiveloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    private final random random = new random();\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n        int length = nodes.size();\n        // æå°çæ´»è·æ°\n        int leastactive = -1;\n        // å·æç¸åâæå°æ´»è·æ°âçæå¡èæä¾èï¼ä»¥ä¸ç¨ node ä»£ç§°ï¼æ°é\n        int leastcount = 0;\n        // leastindexs ç¨äºè®°å½å·æç¸åâæå°æ´»è·æ°âç node å¨ nodes åè¡¨ä¸­çä¸æ ä¿¡æ¯\n        int[] leastindexs = new int[length];\n        int totalweight = 0;\n        // ç¬¬ä¸ä¸ªæå°æ´»è·æ°ç node æéå¼ï¼ç¨äºä¸å¶ä»å·æç¸åæå°æ´»è·æ°ç node çæéè¿è¡å¯¹æ¯ï¼\n        // ä»¥æ£æµæ¯å¦âææå·æç¸åæå°æ´»è·æ°ç node çæéâåç¸ç­\n        int firstweight = 0;\n        boolean sameweight = true;\n\n        // éå nodes åè¡¨\n        for (int i = 0; i < length; i++) {\n            n node = nodes.get(i);\n            // åç°æ´å°çæ´»è·æ°ï¼éæ°å¼å§\n            if (leastactive == -1 || node.getactive() < leastactive) {\n                // ä½¿ç¨å½åæ´»è·æ°æ´æ°æå°æ´»è·æ° leastactive\n                leastactive = node.getactive();\n                // æ´æ° leastcount ä¸º 1\n                leastcount = 1;\n                // è®°å½å½åä¸æ å¼å° leastindexs ä¸­\n                leastindexs[0] = i;\n                totalweight = node.getweight();\n                firstweight = node.getweight();\n                sameweight = true;\n\n                // å½å node çæ´»è·æ° node.getactive() ä¸æå°æ´»è·æ° leastactive ç¸å\n            } else if (node.getactive() == leastactive) {\n                // å¨ leastindexs ä¸­è®°å½ä¸å½å node å¨ nodes éåä¸­çä¸æ \n                leastindexs[leastcount++] = i;\n                // ç´¯å æé\n                totalweight += node.getweight();\n                // æ£æµå½å node çæéä¸ firstweight æ¯å¦ç¸ç­ï¼\n                // ä¸ç¸ç­åå° sameweight ç½®ä¸º false\n                if (sameweight && i > 0\n                    && node.getweight() != firstweight) {\n                    sameweight = false;\n                }\n            }\n        }\n\n        // å½åªæä¸ä¸ª node å·ææå°æ´»è·æ°ï¼æ­¤æ¶ç´æ¥è¿åè¯¥ node å³å¯\n        if (leastcount == 1) {\n            return nodes.get(leastindexs[0]);\n        }\n\n        // æå¤ä¸ª node å·æç¸åçæå°æ´»è·æ°ï¼ä½å®ä»¬ä¹é´çæéä¸å\n        if (!sameweight && totalweight > 0) {\n            // éæºçæä¸ä¸ª [0, totalweight) ä¹é´çæ°å­\n            int offsetweight = random.nextint(totalweight);\n            // å¾ªç¯è®©éæºæ°åå»å·ææå°æ´»è·æ°ç node çæéå¼ï¼\n            // å½ offset å°äºç­äº0æ¶ï¼è¿åç¸åºç node\n            for (int i = 0; i < leastcount; i++) {\n                int leastindex = leastindexs[i];\n                // è·åæéå¼ï¼å¹¶è®©éæºæ°åå»æéå¼\n                offsetweight -= nodes.get(leastindex).getweight();\n                if (offsetweight <= 0) {\n                    return nodes.get(leastindex);\n                }\n            }\n        }\n        // å¦ææéç¸åææéä¸º0æ¶ï¼éæºè¿åä¸ä¸ª node\n        return nodes.get(leastindexs[random.nextint(leastcount)]);\n    }\n\n}\n\n\n\n# 3.4. åå¸\n\nåå¸ï¼ip hashï¼ ç®æ³æ ¹æ®ä¸ä¸ª key ï¼å¯ä»¥æ¯å¯ä¸ idãip ç­ï¼ï¼éè¿åå¸è®¡ç®å¾å°ä¸ä¸ªæ°å¼ï¼ç¨è¯¥æ°å¼å¨åéæå¡å¨åè¡¨çè¿è¡åæ¨¡è¿ç®ï¼å¾å°çç»æä¾¿æ¯éä¸­çæå¡å¨ã\n\n\n\nå¯ä»¥ä¿è¯åä¸ ip çå®¢æ·ç«¯çè¯·æ±ä¼è½¬åå°åä¸å°æå¡å¨ä¸ï¼ç¨æ¥å®ç°ä¼è¯ç²æ»ï¼sticky sessionï¼ã\n\n * ç¹ç¹ï¼ä¿è¯ç¹å®ç¨æ·æ»æ¯è¯·æ±å°ç¸åçæå¡å¨ï¼è¥æå¡å¨å®æºï¼ä¼è¯ä¼ä¸¢å¤±ã\n\nãç¤ºä¾ãæºå°ååå¸ç®æ³å®ç°ç¤ºä¾\n\npublic class iphashloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n        if (strutil.isblank(ip)) {\n            ip = "127.0.0.1";\n        }\n\n        int length = nodes.size();\n        int index = hash(ip) % length;\n        return nodes.get(index);\n    }\n\n    public int hash(string text) {\n        return hashutil.fnvhash(text);\n    }\n\n}\n\n\n\n# 3.5. ä¸è´æ§åå¸\n\nä¸è´æ§åå¸ï¼consistent hashï¼ç®æ³çç®æ æ¯ï¼ç¸åçè¯·æ±å°½å¯è½è½å°åä¸ä¸ªæå¡å¨ä¸ã\n\nä¸è´æ§åå¸ å¯ä»¥å¾å¥½çè§£å³ ç¨³å®æ§é®é¢ï¼å¯ä»¥å°ææç å­å¨èç¹ æåå¨ é¦å°¾ç¸æ¥ ç hash ç¯ä¸ï¼æ¯ä¸ª key å¨è®¡ç® hash åä¼ é¡ºæ¶é æ¾å° ä¸´æ¥ ç å­å¨èç¹ å­æ¾ãèå½æèç¹ å å¥ æ éåº æ¶ï¼ä»å½±åè¯¥èç¹å¨ hash ç¯ä¸ é¡ºæ¶éç¸é» ç åç»­èç¹ã\n\n\n\n * ç¸åçè¯·æ±æ¯æï¼ä¸è¬å¨ä½¿ç¨ä¸è´æ§åå¸æ¶ï¼éè¦æå®ä¸ä¸ª key ç¨äº hash è®¡ç®ï¼å¯è½æ¯ï¼\n   * ç¨æ· id\n   * è¯·æ±æ¹ ip\n   * è¯·æ±æå¡åç§°ï¼åæ°åè¡¨ææçä¸²\n * å°½å¯è½æ¯æï¼æå¡å¨å¯è½åçä¸ä¸çº¿ï¼å°æ°æå¡å¨çååä¸åºè¯¥å½±åå¤§å¤æ°çè¯·æ±ã\n\nå½æå°åéæå¡å¨å®æºæ¶ï¼åæ¬åå¾è¯¥æå¡å¨çè¯·æ±ï¼ä¼åºäºèæèç¹ï¼å¹³æå°å¶å®åéæå¡å¨ï¼ä¸ä¼å¼èµ·å§çåå¨ã\n\n * ä¼ç¹\n\nå å¥ å å é¤ èç¹åªå½±å åå¸ç¯ ä¸­ é¡ºæ¶éæ¹å ç ç¸é»çèç¹ï¼å¯¹å¶ä»èç¹æ å½±åã\n\n * ç¼ºç¹\n\nå åèç¹ ä¼é æ åå¸ç¯ ä¸­é¨åæ°æ® æ æ³å½ä¸­ãå½ä½¿ç¨ å°éèç¹ æ¶ï¼èç¹åå å°å¤§èå´å½±å åå¸ç¯ ä¸­ æ°æ®æ å°ï¼ä¸éå å°éæ°æ®èç¹ çåå¸å¼æ¹æ¡ãæ®é ç ä¸è´æ§åå¸ååº å¨å¢åèç¹æ¶éè¦ å¢å ä¸å æ åå»ä¸å èç¹æè½ä¿è¯ æ°æ® å è´è½½çåè¡¡ã\n\n> æ³¨æï¼å ä¸º ä¸è´æ§åå¸ååº çè¿äºç¼ºç¹ï¼ä¸äºåå¸å¼ç³»ç»éç¨ èææ§½ å¯¹ ä¸è´æ§åå¸ è¿è¡æ¹è¿ï¼æ¯å¦ dynamo ç³»ç»ã\n\nãç¤ºä¾ãä¸è´æ§åå¸ç®æ³ç¤ºä¾\n\nä»¥ä¸ç¤ºä¾åºäº dubbo çä¸è´æ§åå¸è´è½½åè¡¡ç®æ³åäºä¸äºç®åã\n\npublic class consistenthashloadbalance<n extends node> extends baseloadbalance<n> implements loadbalance<n> {\n\n    private final concurrentmap<string, consistenthashselector<?>> selectors = new concurrenthashmap<>();\n\n    @suppresswarnings("unchecked")\n    @override\n    protected n doselect(list<n> nodes, string ip) {\n        // åçæ°ï¼è¿éè®¾ä¸ºèç¹æ°ç 4 å\n        integer replicanum = nodes.size() * 4;\n        // è·å nodes åå§ç hashcode\n        int identityhashcode = system.identityhashcode(nodes);\n\n        // å¦æ nodes æ¯ä¸ä¸ªæ°ç list å¯¹è±¡ï¼æå³çèç¹æ°éåçäºåå\n        // æ­¤æ¶ selector.identityhashcode != identityhashcode æ¡ä»¶æç«\n        consistenthashselector<n> selector = (consistenthashselector<n>) selectors.get(ip);\n        if (selector == null || selector.identityhashcode != identityhashcode) {\n            // åå»ºæ°ç consistenthashselector\n            selectors.put(ip, new consistenthashselector<>(nodes, identityhashcode, replicanum));\n            selector = (consistenthashselector<n>) selectors.get(ip);\n        }\n        // è°ç¨ consistenthashselector ç select æ¹æ³éæ© node\n        return selector.select(ip);\n    }\n\n    /**\n     * ä¸è´æ§åå¸éæ©å¨\n     */\n    private static final class consistenthashselector<n extends node> {\n\n        /**\n         * å­å¨èæèç¹\n         */\n        private final treemap<long, n> virtualnodes;\n\n        private final int identityhashcode;\n\n        /**\n         * æé å¨\n         *\n         * @param nodes            èç¹åè¡¨\n         * @param identityhashcode hashcode\n         * @param replicanum       åçæ°\n         */\n        consistenthashselector(list<n> nodes, int identityhashcode, integer replicanum) {\n            this.virtualnodes = new treemap<>();\n            this.identityhashcode = identityhashcode;\n            // è·åèæèç¹æ°ï¼é»è®¤ä¸º 100\n            if (replicanum == null) {\n                replicanum = 100;\n            }\n            for (n node : nodes) {\n                for (int i = 0; i < replicanum / 4; i++) {\n                    // å¯¹ url è¿è¡ md5 è¿ç®ï¼å¾å°ä¸ä¸ªé¿åº¦ä¸º16çå­èæ°ç»\n                    byte[] digest = md5(node.geturl());\n                    // å¯¹ digest é¨åå­èè¿è¡ 4 æ¬¡ hash è¿ç®ï¼å¾å°åä¸ªä¸åç long åæ­£æ´æ°\n                    for (int j = 0; j < 4; j++) {\n                        // h = 0 æ¶ï¼å digest ä¸­ä¸æ ä¸º 0 ~ 3 ç4ä¸ªå­èè¿è¡ä½è¿ç®\n                        // h = 1 æ¶ï¼å digest ä¸­ä¸æ ä¸º 4 ~ 7 ç4ä¸ªå­èè¿è¡ä½è¿ç®\n                        // h = 2, h = 3 æ¶è¿ç¨åä¸\n                        long m = hash(digest, j);\n                        // å° hash å° node çæ å°å³ç³»å­å¨å° virtualnodes ä¸­ï¼\n                        // virtualnodes éè¦æä¾é«æçæ¥è¯¢æä½ï¼å æ­¤éç¨ treemap ä½ä¸ºå­å¨ç»æ\n                        virtualnodes.put(m, node);\n                    }\n                }\n            }\n        }\n\n        public n select(string key) {\n            // å¯¹åæ° key è¿è¡ md5 è¿ç®\n            byte[] digest = md5(key);\n            // å digest æ°ç»çååä¸ªå­èè¿è¡ hash è¿ç®ï¼åå° hash å¼ä¼ ç» selectforkey æ¹æ³ï¼\n            // å¯»æ¾åéç node\n            return selectforkey(hash(digest, 0));\n        }\n\n        private n selectforkey(long hash) {\n            // æ¥æ¾ç¬¬ä¸ä¸ªå¤§äºæç­äºå½å hash çèç¹\n            map.entry<long, n> entry = virtualnodes.ceilingentry(hash);\n            // å¦æ hash å¤§äº node å¨åå¸ç¯ä¸æå¤§çä½ç½®ï¼æ­¤æ¶ entry = nullï¼\n            // éè¦å° treemap çå¤´èç¹èµå¼ç» entry\n            if (entry == null) {\n                entry = virtualnodes.firstentry();\n            }\n            // è¿å node\n            return entry.getvalue();\n        }\n\n    }\n\n    /**\n     * è®¡ç® hash å¼\n     */\n    public static long hash(byte[] digest, int number) {\n        return (((long) (digest[3 + number * 4] & 0xff) << 24)\n            | ((long) (digest[2 + number * 4] & 0xff) << 16)\n            | ((long) (digest[1 + number * 4] & 0xff) << 8)\n            | (digest[number * 4] & 0xff))\n            & 0xffffffffl;\n    }\n\n    /**\n     * è®¡ç® md5 å¼\n     */\n    public static byte[] md5(string value) {\n        messagedigest md5;\n        try {\n            md5 = messagedigest.getinstance("md5");\n        } catch (nosuchalgorithmexception e) {\n            throw new illegalstateexception(e.getmessage(), e);\n        }\n        md5.reset();\n        byte[] bytes = value.getbytes(standardcharsets.utf_8);\n        md5.update(bytes);\n        return md5.digest();\n    }\n\n}\n\n\n\n# 4. åèèµæ\n\n * comparing load balancing algorithms\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * å¤§åç½ç«æ¶æç³»åï¼è´è½½åè¡¡è¯¦è§£ï¼1ï¼\n * ä»ä¹æ¯è´è½½åè¡¡\n * what is load balancing\n * dubbo å®æ¹è´è½½åè¡¡ç®æ³è¯´æ\n * è´è½½åè¡¡ç®æ³åææ®µ\n * å©ç¨ dns è§£ææ¥å®ç°ç½ç«çè´è½½åè¡¡',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æå¡è·¯ç±",frontmatter:{title:"æå¡è·¯ç±",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æå¡æ²»ç"],tags:["åå¸å¼","æå¡æ²»ç","æµéè°åº¦","è·¯ç±"],abbrlink:"6492e9b5",date:"2022-04-19T15:54:25.000Z",permalink:"/pages/d04ece/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/01.%E6%B5%81%E9%87%8F%E8%B0%83%E5%BA%A6/03.%E6%9C%8D%E5%8A%A1%E8%B7%AF%E7%94%B1.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/03.æå¡è·¯ç±.md",key:"v-5a6ba150",path:"/pages/d04ece/",headers:[{level:2,title:"1. æå¡è·¯ç±ç®ä»",slug:"_1-æå¡è·¯ç±ç®ä»",normalizedTitle:"1. æå¡è·¯ç±ç®ä»",charIndex:11},{level:3,title:"1.1. ä»ä¹æ¯æå¡è·¯ç±",slug:"_1-1-ä»ä¹æ¯æå¡è·¯ç±",normalizedTitle:"1.1. ä»ä¹æ¯æå¡è·¯ç±",charIndex:25},{level:3,title:"1.2. ä¸ºä»ä¹éè¦æå¡è·¯ç±",slug:"_1-2-ä¸ºä»ä¹éè¦æå¡è·¯ç±",normalizedTitle:"1.2. ä¸ºä»ä¹éè¦æå¡è·¯ç±",charIndex:100},{level:2,title:"2. æå¡è·¯ç±çè§å",slug:"_2-æå¡è·¯ç±çè§å",normalizedTitle:"2. æå¡è·¯ç±çè§å",charIndex:1128},{level:3,title:"2.1. æ¡ä»¶è·¯ç±",slug:"_2-1-æ¡ä»¶è·¯ç±",normalizedTitle:"2.1. æ¡ä»¶è·¯ç±",charIndex:1173},{level:3,title:"2.2. èæ¬è·¯ç±",slug:"_2-2-èæ¬è·¯ç±",normalizedTitle:"2.2. èæ¬è·¯ç±",charIndex:3204},{level:3,title:"2.3. æ ç­¾è·¯ç±",slug:"_2-3-æ ç­¾è·¯ç±",normalizedTitle:"2.3. æ ç­¾è·¯ç±",charIndex:3820},{level:3,title:"2.4. è·¯ç±è§åè·åæ¹å¼",slug:"_2-4-è·¯ç±è§åè·åæ¹å¼",normalizedTitle:"2.4. è·¯ç±è§åè·åæ¹å¼",charIndex:4766},{level:2,title:"3. åèèµæ",slug:"_3-åèèµæ",normalizedTitle:"3. åèèµæ",charIndex:5386}],headersStr:"1. æå¡è·¯ç±ç®ä» 1.1. ä»ä¹æ¯æå¡è·¯ç± 1.2. ä¸ºä»ä¹éè¦æå¡è·¯ç± 2. æå¡è·¯ç±çè§å 2.1. æ¡ä»¶è·¯ç± 2.2. èæ¬è·¯ç± 2.3. æ ç­¾è·¯ç± 2.4. è·¯ç±è§åè·åæ¹å¼ 3. åèèµæ",content:'# æå¡è·¯ç±\n\n\n# 1. æå¡è·¯ç±ç®ä»\n\n\n# 1.1. ä»ä¹æ¯æå¡è·¯ç±\n\næå¡æ¶è´¹èå¨åèµ·æå¡è°ç¨æ¶ï¼å¦æé¢å¯¹å¤ä¸ªæå¡æä¾èï¼éè¦éè¿ä¸å®çè§åæ¥éæ©è°ç¨åªä¸ªæå¡æä¾èï¼è¿å°±æ¯æå¡è·¯ç±ã\n\n\n# 1.2. ä¸ºä»ä¹éè¦æå¡è·¯ç±\n\nè´è½½åè¡¡çä½ç¨åæå¡è·¯ç±çåè½çä¸å»å¾è¿ä¼¼ï¼äºèæä»ä¹åºå«å¢ï¼\n\nè´è½½åè¡¡çç®æ æ¯æä¾æå¡ååèä¸æ¯è§£å³è·¯ç±é®é¢ï¼å¸¸è§çéæãå¨æè´è½½åè¡¡ç®æ³ä¹æ æ³å®ç°ç²¾ç»åçè·¯ç±ç®¡çï¼ä½æ¯è´è½½åè¡¡ä¹å¯ä»¥ç®åçåæ¯è·¯ç±æ¹æ¡çä¸ç§ã\n\næå¡è·¯ç±éå¸¸ç¨äºä»¥ä¸åºæ¯ï¼ç®çå¨äºå®ç°æµééç¦»ï¼\n\n * åç»è°ç¨ï¼ä¸è¬æ¥è®²ï¼ä¸ºäºä¿è¯æå¡çé«å¯ç¨æ§ï¼å®ç°å¼å°å¤æ´»çéæ±ï¼ä¸ä¸ªæå¡å¾å¾ä¸æ­¢é¨ç½²å¨ä¸ä¸ªæ°æ®ä¸­å¿ï¼èä¸åºäºèçææ¬ç­èèï¼æäºä¸å¡å¯è½ä¸ä»å¨ç§ææºæ¿é¨ç½²ï¼è¿ä¼éç¨å¬æäºé¨ç½²ï¼çè³éç¨å¤å®¶å¬æäºé¨ç½²ãæå¡èç¹ä¹ä¼æç§ä¸åçæ°æ®ä¸­å¿åæä¸åçåç»ï¼è¿æ¶å¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼éæ©åªä¸ä¸ªåç»è°ç¨ï¼å°±å¿é¡»æç¸åºçè·¯ç±è§åã\n * èç»¿åå¸ï¼èç»¿åå¸åºæ¯ä¸­ï¼ä¸å±æä¸¤å¥æå¡ç¾¤ç»ï¼ä¸å¥æ¯æä¾æ§çåè½çæå¡ç¾¤ç»ï¼æ è®°ä¸ºç»¿è²ï¼å¦ä¸å¥æ¯æä¾æ°çåè½çæå¡ç¾¤ç»ï¼æ è®°ä¸ºèè²ãä¸¤å¥æå¡ç¾¤ç»é½æ¯åè½å®åçï¼å¹¶ä¸æ­£å¨è¿è¡çç³»ç»ï¼åªæ¯æå¡çæ¬åè®¿é®æµéä¸åãæ°çç¾¤ç»ï¼èè²ï¼éå¸¸æ¯ä¸ºäºååé¨æµè¯ãéªæ¶ï¼ä¸å¯¹å¤é¨ç¨æ·æ´é²ã\n   * å¦ææ°çç¾¤ç»ï¼èè²ï¼è¿è¡ç¨³å®ï¼å¹¶æµè¯ãéªæ¶éè¿åï¼åéè¿æå¡è·¯ç±ãè´è½½åè¡¡ç­ææ®µéæ­¥å°å¤é¨ç¨æ·æµéå¯¼åæ°çç¾¤ç»ï¼èè²ï¼ã\n   * å¦ææ°çç¾¤ç»ï¼èè²ï¼è¿è¡ä¸ç¨³å®ï¼ææµè¯ãéªæ¶ä¸éè¿ï¼åææ¥ãè§£å³é®é¢åï¼åç»§ç»­æµè¯ãéªæ¶ã\n * ç°åº¦åå¸ï¼ç°åº¦åå¸ï¼ååéä¸éåå¸ï¼æ¯æå¨é»ä¸ç½ä¹é´ï¼è½å¤å¹³æ»è¿æ¸¡çä¸ç§åå¸æ¹å¼ãå¨å¶ä¸å¯ä»¥è¿è¡ A/B æµè¯ï¼å³è®©ä¸é¨åç¨æ·ä½¿ç¨ç¹æ§ Aï¼ä¸é¨åç¨æ·ä½¿ç¨ç¹æ§ Bï¼å¦æç¨æ·å¯¹ B æ²¡æä»ä¹åå¯¹æè§ï¼é£ä¹éæ­¥æ©å¤§åå¸èå´ï¼ç´å°æææç¨æ·é½è¿ç§»å° B ä¸é¢æ¥ãç°åº¦åå¸å¯ä»¥ä¿è¯æ´ä½ç³»ç»çç¨³å®ï¼å¨åå§ç°åº¦çæ¶åå°±å¯ä»¥åç°ãè°æ´é®é¢ï¼ä»¥ä¿è¯å¶å½±ååº¦ãè¦æ¯æç°åº¦åå¸ï¼å°±è¦æ±æå¡è½å¤æ ¹æ®ä¸å®çè§åï¼å°æµééç¦»ã\n * æµéåæ¢ï¼å¨ä¸å¡çº¿ä¸è¿è¡è¿ç¨ä¸­ï¼ç»å¸¸ä¼éå°ä¸äºä¸å¯æåå ç´ å¯¼è´ä¸å¡æéï¼æ¯å¦æä¸ªæºæ¿çåç¼è¢«ææ­ï¼æèåççç«ç­äºæå¯¼è´æ´ä¸ªæºæ¿çæå¡é½ä¸å¯ç¨ãè¿ä¸ªæ¶åå°±éè¦æç§æä¸ªæä»¤ï¼è½å¤æåæ¥è°ç¨è¿ä¸ªæºæ¿æå¡çæµéåæ¢å°å¶ä»æ­£å¸¸çæºæ¿ã\n * çº¿ä¸æµè¯èè°ï¼çº¿ä¸æµè¯æ¶ï¼å¯è½ä¼ç¼ºå°ç¸åºç¯å¢ãå¯ä»¥å°æµè¯åºç¨æ³¨åå°çº¿ä¸ï¼ç¶åå¼å¯è·¯ç±è§åï¼å¨æ¬å°è¿è¡æµè¯ã\n * è¯»ååç¦»ãå¯¹äºå¤§å¤æ°äºèç½ä¸å¡æ¥è¯´é½æ¯è¯»å¤åå°ï¼æä»¥å¨è¿è¡æå¡é¨ç½²çæ¶åï¼å¯ä»¥æè¯»ååå¼é¨ç½²ï¼ææåæ¥å£å¯ä»¥é¨ç½²å¨ä¸èµ·ï¼èè¯»æ¥å£é¨ç½²å¨å¦å¤çèç¹ä¸ã\n\n\n# 2. æå¡è·¯ç±çè§å\n\næå¡è·¯ç±ä¸»è¦æä¸¤ç§è§åï¼ä¸ç§æ¯æ¡ä»¶è·¯ç±ï¼ä¸ç§æ¯èæ¬è·¯ç±ã\n\n\n# 2.1. æ¡ä»¶è·¯ç±\n\næ¡ä»¶è·¯ç±æ¯åºäºæ¡ä»¶è¡¨è¾¾å¼çè·¯ç±è§åãåä¸ª RPC æ¡æ¶çæ¡ä»¶è·¯ç±è¡¨è¾¾å¼åä¸ç¸åã\n\næä»¬ä¸å¦¨åèä¸ä¸ Dubbo çæ¡ä»¶è·¯ç±ãDubbo çæ¡ä»¶è·¯ç±æä¸¤ç§éç½®ç²åº¦ï¼å¦ä¸ï¼\n\n * åºç¨ç²åº¦\n   \n   # app1çæ¶è´¹èåªè½æ¶è´¹ææç«¯å£ä¸º20880çæå¡å®ä¾\n   # app2çæ¶è´¹èåªè½æ¶è´¹ææç«¯å£ä¸º20881çæå¡å®ä¾\n   ---\n   scope: application\n   force: true\n   runtime: true\n   enabled: true\n   key: governance-conditionrouter-consumer\n   conditions:\n     - application=app1 => address=*:20880\n     - application=app2 => address=*:20881\n   \n\n * æå¡ç²åº¦\n   \n   # DemoServiceçsayHelloæ¹æ³åªè½æ¶è´¹ææç«¯å£ä¸º20880çæå¡å®ä¾\n   # DemoServiceçsayHiæ¹æ³åªè½æ¶è´¹ææç«¯å£ä¸º20881çæå¡å®ä¾\n   ---\n   scope: service\n   force: true\n   runtime: true\n   enabled: true\n   key: org.apache.dubbo.samples.governance.api.DemoService\n   conditions:\n     - method=sayHello => address=*:20880\n     - method=sayHi => address=*:20881\n   \n\n> å¶ä¸­ï¼conditions å®ä¹å·ä½çè·¯ç±è§ååå®¹ãconditions é¨åæ¯è§åçä¸»ä½ï¼ç± 1 å°ä»»æå¤æ¡è§åç»æãè¯¦è§ï¼Dubbo è·¯ç±è§å\n\nDubbo çæ¡ä»¶è·¯ç±è§åç±ä¸¤ä¸ªæ¡ä»¶ç»æï¼åå«ç¨äºå¯¹æå¡æ¶è´¹èåæä¾èè¿è¡å¹éãæ¡ä»¶è·¯ç±è§åçæ ¼å¼å¦ä¸ï¼\n\n[æå¡æ¶è´¹èå¹éæ¡ä»¶] => [æå¡æä¾èå¹éæ¡ä»¶]\n\n\n * æå¡æ¶è´¹èå¹éæ¡ä»¶ï¼ææåæ°åæ¶è´¹èç URL è¿è¡å¯¹æ¯ï¼å½æ¶è´¹èæ»¡è¶³å¹éæ¡ä»¶æ¶ï¼å¯¹è¯¥æ¶è´¹èæ§è¡åé¢çè¿æ»¤è§åã\n * æå¡æä¾èå¹éæ¡ä»¶ï¼ææåæ°åæä¾èç URL è¿è¡å¯¹æ¯ï¼æ¶è´¹èæç»åªæ¿å°è¿æ»¤åçå°ååè¡¨ã\n\ncondition:// ä»£è¡¨äºè¿æ¯ä¸æ®µç¨æ¡ä»¶è¡¨è¾¾å¼ç¼åçè·¯ç±è§åï¼ä¸é¢æ¯ä¸ä¸ªæ¡ä»¶è·¯ç±è§åç¤ºä¾ï¼\n\nhost = 10.20.153.10 => host = 10.20.153.11\n\n\nè¯¥æ¡è§åè¡¨ç¤º IP ä¸º 10.20.153.10 çæå¡æ¶è´¹èåªå¯è°ç¨ IP ä¸º 10.20.153.11 æºå¨ä¸çæå¡ï¼ä¸å¯è°ç¨å¶ä»æºå¨ä¸çæå¡ã\n\nä¸é¢åä¸¾ä¸äº Dubbo æ¡ä»¶è·¯ç±çå¸ååºç¨åºæ¯ï¼\n\n * å¦ææå¡æ¶è´¹èçå¹éæ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºææçæå¡æ¶è´¹èé½å¯ä»¥è®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\n=> host != 10.20.153.11\n\n\n * å¦ææå¡æä¾èçè¿æ»¤æ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºç¦æ­¢ææçæå¡æ¶è´¹èè®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\nhost = 10.20.153.10 =>\n\n\n * æé¤æä¸ªæå¡èç¹\n\n=> host != 172.22.3.91\n\n\n * ç½åå\n\nregister.ip != 10.20.153.10,10.20.153.11 =>\n\n\n * é»åå\n\nregister.ip = 10.20.153.10,10.20.153.11 =>\n\n\n * åªæ´é²é¨åæºå¨èç¹\n\n=> host = 172.22.3.1*,172.22.3.2*\n\n\n * ä¸ºéè¦åºç¨æä¾é¢å¤çæºå¨èç¹\n\napplication != kylin => host != 172.22.3.95,172.22.3.96\n\n\n * è¯»ååç¦»\n\nmethod = find*,list*,get*,is* => host = 172.22.3.94,172.22.3.95,172.22.3.96\nmethod != find*,list*,get*,is* => host = 172.22.3.97,172.22.3.98\n\n\n * ååå°åç¦»\n\napplication = bops => host = 172.22.3.91,172.22.3.92,172.22.3.93\napplication != bops => host = 172.22.3.94,172.22.3.95,172.22.3.96\n\n\n * éç¦»ä¸åæºæ¿ç½æ®µ\n\nhost != 172.22.3.* => host != 172.22.3.*\n\n\n * æä¾èä¸æ¶è´¹èé¨ç½²å¨åéç¾¤åï¼æ¬æºåªè®¿é®æ¬æºçæå¡\n\n=> host = $host\n\n\n\n# 2.2. èæ¬è·¯ç±\n\nèæ¬è·¯ç±æ¯åºäºèæ¬è¯­è¨çè·¯ç±è§åï¼å¸¸ç¨çèæ¬è¯­è¨æ¯å¦ JavaScriptãGroovyãJRuby ç­ã\n\n"script://0.0.0.0/com.foo.BarService?category=routers&dynamic=false&rule=" + URL.encode("ï¼function route(invokers) { ... } (invokers)ï¼")\n\n\nè¿éé¢ script:// å°±ä»£è¡¨äºè¿æ¯ä¸æ®µèæ¬è¯­è¨ç¼åçè·¯ç±è§åï¼å·ä½è§åå®ä¹å¨èæ¬è¯­è¨ç route æ¹æ³å®ç°éï¼æ¯å¦ä¸é¢è¿æ®µç¨ JavaScript ç¼åç route() æ¹æ³è¡¨è¾¾çæææ¯ï¼åªæ IP ä¸º 10.20.153.10 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ã\n\nfunction route(invokers){\n  var result = new java.util.ArrayList(invokers.size());\n  for(i =0; i < invokers.size(); i ++){\n    if("10.20.153.10".equals(invokers.get(i).getUrl().getHost())){\n       result.add(invokers.get(i));\n    }\n  }\n  return result;\n } (invokers)ï¼;\n\n\n\n# 2.3. æ ç­¾è·¯ç±\n\næ ç­¾è·¯ç±éè¿å°æä¸ä¸ªæå¤ä¸ªæå¡çæä¾èååå°åä¸ä¸ªåç»ï¼çº¦ææµéåªå¨æå®åç»ä¸­æµè½¬ï¼ä»èå®ç°æµééç¦»çç®çï¼å¯ä»¥ä½ä¸ºèç»¿åå¸ãç°åº¦åå¸ç­åºæ¯çè½ååºç¡ã\n\næ ç­¾ä¸»è¦æ¯æå¯¹æå¡æä¾èçåç»ï¼ç®åæä¸¤ç§æ¹å¼å¯ä»¥å®æå®ä¾åç»ï¼åå«æ¯å¨æè§åææ åéæè§åææ ãä¸è¬ï¼å¨æè§åä¼åçº§æ¯éæè§åæ´é«ï¼å½ä¸¤ç§è§ååæ¶å­å¨ä¸åºç°å²çªæ¶ï¼å°ä»¥å¨æè§åä¸ºåã\n\nä»¥ Dubbo çæ ç­¾è·¯ç±ç¨æ³ä¸ºä¾\n\nï¼1ï¼å¨æè§åææ ï¼å¯éæ¶å¨æå¡æ²»çæ§å¶å°ä¸åæ ç­¾å½ç»è§å\n\n# governance-tagrouter-provideråºç¨å¢å äºä¸¤ä¸ªæ ç­¾åç»tag1åtag2\n# tag1åå«ä¸ä¸ªå®ä¾ 127.0.0.1:20880\n# tag2åå«ä¸ä¸ªå®ä¾ 127.0.0.1:20881\n---\n  force: false\n  runtime: true\n  enabled: true\n  key: governance-tagrouter-provider\n  tags:\n    - name: tag1\n      addresses: ["127.0.0.1:20880"]\n    - name: tag2\n      addresses: ["127.0.0.1:20881"]\n ...\n\n\nï¼2ï¼éæè§åææ \n\n<dubbo:provider tag="tag1"/>\n\n\nor\n\n<dubbo:service tag="tag1"/>\n\n\nor\n\njava -jar xxx-provider.jar -Ddubbo.provider.tag={the tag you want, may come from OS ENV}\n\n\nï¼3ï¼æå¡æ¶è´¹èæå®æ ç­¾è·¯ç±\n\nRpcContext.getContext().setAttachment(Constants.REQUEST_TAG_KEY,"tag1");\n\n\nè¯·æ±æ ç­¾çä½ç¨åä¸ºæ¯ä¸æ¬¡ invocationï¼ä½¿ç¨ attachment æ¥ä¼ éè¯·æ±æ ç­¾ï¼æ³¨æä¿å­å¨ attachment ä¸­çå¼å°ä¼å¨ä¸æ¬¡å®æ´çè¿ç¨è°ç¨ä¸­æç»­ä¼ éï¼å¾çäºè¿æ ·çç¹æ§ï¼æä»¬åªéè¦å¨èµ·å§è°ç¨æ¶ï¼éè¿ä¸è¡ä»£ç çè®¾ç½®ï¼è¾¾å°æ ç­¾çæç»­ä¼ éã\n\n\n# 2.4. è·¯ç±è§åè·åæ¹å¼\n\nè·¯ç±è§åçè·åæ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * æ¬å°éæéç½®ï¼é¡¾åæä¹å°±æ¯è·¯ç±è§åå­å¨å¨æå¡æ¶è´¹èæ¬å°ä¸ãæå¡æ¶è´¹èåèµ·è°ç¨æ¶ï¼ä»æ¬å°åºå®ä½ç½®è¯»åè·¯ç±è§åï¼ç¶åæç§è·¯ç±è§åéåä¸ä¸ªæå¡èç¹åèµ·è°ç¨ã\n * éç½®ä¸­å¿ç®¡çï¼è¿ç§æ¹å¼ä¸ï¼ææçæå¡æ¶è´¹èé½ä»éç½®ä¸­å¿è·åè·¯ç±è§åï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çã\n * æ³¨åä¸­å¿å¨æä¸åï¼è¿ç§æ¹å¼ä¸ï¼ä¸è¬æ¯è¿ç»´äººåæèå¼åäººåï¼éè¿æå¡æ²»çå¹³å°ä¿®æ¹è·¯ç±è§åï¼æå¡æ²»çå¹³å°è°ç¨éç½®ä¸­å¿æ¥å£ï¼æä¿®æ¹åçè·¯ç±è§åæä¹åå°éç½®ä¸­å¿ãå ä¸ºæå¡æ¶è´¹èè®¢éäºè·¯ç±è§åçåæ´ï¼äºæ¯å°±ä¼ä»éç½®ä¸­å¿è·åææ°çè·¯ç±è§åï¼æç§ææ°çè·¯ç±è§åæ¥æ§è¡ã\n\nä¸è¬æ¥è®²ï¼æå¡è·¯ç±æå¥½æ¯å­å¨å¨éç½®ä¸­å¿ï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çãè¿æ ·çè¯ï¼ææçæå¡æ¶è´¹èå°±ä¸éè¦å¨æ¬å°ç®¡çæå¡è·¯ç±ï¼å ä¸ºå¤§é¨åçæå¡æ¶è´¹èå¹¶ä¸å³å¿æå¡è·¯ç±çé®é¢ï¼æèè¯´ä¹ä¸éè¦å»äºè§£å¶ä¸­çç»èãéè¿éç½®ä¸­å¿ï¼ç»ä¸ç»åä¸ªæå¡æ¶è´¹èä¸åç»ä¸çæå¡è·¯ç±ï¼èçäºæ²éåç®¡çææ¬ã\n\nä½ä¹ä¸æé¤æäºæå¡æ¶è´¹èæç¹å®çéæ±ï¼éè¦å®å¶èªå·±çè·¯ç±è§åï¼è¿ä¸ªæ¶åå°±éåéè¿æ¬å°éç½®æ¥å®å¶ã\n\nèå¨æä¸åå¯ä»¥çè§£ä¸ºä¸ç§é«çº§åè½ï¼å®è½å¤å¨æå°ä¿®æ¹è·¯ç±è§åï¼å¨æäºä¸å¡åºæ¯ä¸ååæç¨ãæ¯å¦æä¸ªæ°æ®ä¸­å¿å­å¨é®é¢ï¼éè¦æè°ç¨è¿ä¸ªæ°æ®ä¸­å¿çæå¡æ¶è´¹èé½åæ¢å°å¶ä»æ°æ®ä¸­å¿ï¼è¿æ¶å°±å¯ä»¥éè¿å¨æä¸åçæ¹å¼ï¼åéç½®ä¸­å¿ä¸åä¸æ¡è·¯ç±è§åï¼å°ææè°ç¨è¿ä¸ªæ°æ®ä¸­å¿çè¯·æ±é½è¿ç§»å°å«çå°æ¹ã\n\n\n# 3. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * RPC å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²',normalizedContent:'# æå¡è·¯ç±\n\n\n# 1. æå¡è·¯ç±ç®ä»\n\n\n# 1.1. ä»ä¹æ¯æå¡è·¯ç±\n\næå¡æ¶è´¹èå¨åèµ·æå¡è°ç¨æ¶ï¼å¦æé¢å¯¹å¤ä¸ªæå¡æä¾èï¼éè¦éè¿ä¸å®çè§åæ¥éæ©è°ç¨åªä¸ªæå¡æä¾èï¼è¿å°±æ¯æå¡è·¯ç±ã\n\n\n# 1.2. ä¸ºä»ä¹éè¦æå¡è·¯ç±\n\nè´è½½åè¡¡çä½ç¨åæå¡è·¯ç±çåè½çä¸å»å¾è¿ä¼¼ï¼äºèæä»ä¹åºå«å¢ï¼\n\nè´è½½åè¡¡çç®æ æ¯æä¾æå¡ååèä¸æ¯è§£å³è·¯ç±é®é¢ï¼å¸¸è§çéæãå¨æè´è½½åè¡¡ç®æ³ä¹æ æ³å®ç°ç²¾ç»åçè·¯ç±ç®¡çï¼ä½æ¯è´è½½åè¡¡ä¹å¯ä»¥ç®åçåæ¯è·¯ç±æ¹æ¡çä¸ç§ã\n\næå¡è·¯ç±éå¸¸ç¨äºä»¥ä¸åºæ¯ï¼ç®çå¨äºå®ç°æµééç¦»ï¼\n\n * åç»è°ç¨ï¼ä¸è¬æ¥è®²ï¼ä¸ºäºä¿è¯æå¡çé«å¯ç¨æ§ï¼å®ç°å¼å°å¤æ´»çéæ±ï¼ä¸ä¸ªæå¡å¾å¾ä¸æ­¢é¨ç½²å¨ä¸ä¸ªæ°æ®ä¸­å¿ï¼èä¸åºäºèçææ¬ç­èèï¼æäºä¸å¡å¯è½ä¸ä»å¨ç§ææºæ¿é¨ç½²ï¼è¿ä¼éç¨å¬æäºé¨ç½²ï¼çè³éç¨å¤å®¶å¬æäºé¨ç½²ãæå¡èç¹ä¹ä¼æç§ä¸åçæ°æ®ä¸­å¿åæä¸åçåç»ï¼è¿æ¶å¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼éæ©åªä¸ä¸ªåç»è°ç¨ï¼å°±å¿é¡»æç¸åºçè·¯ç±è§åã\n * èç»¿åå¸ï¼èç»¿åå¸åºæ¯ä¸­ï¼ä¸å±æä¸¤å¥æå¡ç¾¤ç»ï¼ä¸å¥æ¯æä¾æ§çåè½çæå¡ç¾¤ç»ï¼æ è®°ä¸ºç»¿è²ï¼å¦ä¸å¥æ¯æä¾æ°çåè½çæå¡ç¾¤ç»ï¼æ è®°ä¸ºèè²ãä¸¤å¥æå¡ç¾¤ç»é½æ¯åè½å®åçï¼å¹¶ä¸æ­£å¨è¿è¡çç³»ç»ï¼åªæ¯æå¡çæ¬åè®¿é®æµéä¸åãæ°çç¾¤ç»ï¼èè²ï¼éå¸¸æ¯ä¸ºäºååé¨æµè¯ãéªæ¶ï¼ä¸å¯¹å¤é¨ç¨æ·æ´é²ã\n   * å¦ææ°çç¾¤ç»ï¼èè²ï¼è¿è¡ç¨³å®ï¼å¹¶æµè¯ãéªæ¶éè¿åï¼åéè¿æå¡è·¯ç±ãè´è½½åè¡¡ç­ææ®µéæ­¥å°å¤é¨ç¨æ·æµéå¯¼åæ°çç¾¤ç»ï¼èè²ï¼ã\n   * å¦ææ°çç¾¤ç»ï¼èè²ï¼è¿è¡ä¸ç¨³å®ï¼ææµè¯ãéªæ¶ä¸éè¿ï¼åææ¥ãè§£å³é®é¢åï¼åç»§ç»­æµè¯ãéªæ¶ã\n * ç°åº¦åå¸ï¼ç°åº¦åå¸ï¼ååéä¸éåå¸ï¼æ¯æå¨é»ä¸ç½ä¹é´ï¼è½å¤å¹³æ»è¿æ¸¡çä¸ç§åå¸æ¹å¼ãå¨å¶ä¸å¯ä»¥è¿è¡ a/b æµè¯ï¼å³è®©ä¸é¨åç¨æ·ä½¿ç¨ç¹æ§ aï¼ä¸é¨åç¨æ·ä½¿ç¨ç¹æ§ bï¼å¦æç¨æ·å¯¹ b æ²¡æä»ä¹åå¯¹æè§ï¼é£ä¹éæ­¥æ©å¤§åå¸èå´ï¼ç´å°æææç¨æ·é½è¿ç§»å° b ä¸é¢æ¥ãç°åº¦åå¸å¯ä»¥ä¿è¯æ´ä½ç³»ç»çç¨³å®ï¼å¨åå§ç°åº¦çæ¶åå°±å¯ä»¥åç°ãè°æ´é®é¢ï¼ä»¥ä¿è¯å¶å½±ååº¦ãè¦æ¯æç°åº¦åå¸ï¼å°±è¦æ±æå¡è½å¤æ ¹æ®ä¸å®çè§åï¼å°æµééç¦»ã\n * æµéåæ¢ï¼å¨ä¸å¡çº¿ä¸è¿è¡è¿ç¨ä¸­ï¼ç»å¸¸ä¼éå°ä¸äºä¸å¯æåå ç´ å¯¼è´ä¸å¡æéï¼æ¯å¦æä¸ªæºæ¿çåç¼è¢«ææ­ï¼æèåççç«ç­äºæå¯¼è´æ´ä¸ªæºæ¿çæå¡é½ä¸å¯ç¨ãè¿ä¸ªæ¶åå°±éè¦æç§æä¸ªæä»¤ï¼è½å¤æåæ¥è°ç¨è¿ä¸ªæºæ¿æå¡çæµéåæ¢å°å¶ä»æ­£å¸¸çæºæ¿ã\n * çº¿ä¸æµè¯èè°ï¼çº¿ä¸æµè¯æ¶ï¼å¯è½ä¼ç¼ºå°ç¸åºç¯å¢ãå¯ä»¥å°æµè¯åºç¨æ³¨åå°çº¿ä¸ï¼ç¶åå¼å¯è·¯ç±è§åï¼å¨æ¬å°è¿è¡æµè¯ã\n * è¯»ååç¦»ãå¯¹äºå¤§å¤æ°äºèç½ä¸å¡æ¥è¯´é½æ¯è¯»å¤åå°ï¼æä»¥å¨è¿è¡æå¡é¨ç½²çæ¶åï¼å¯ä»¥æè¯»ååå¼é¨ç½²ï¼ææåæ¥å£å¯ä»¥é¨ç½²å¨ä¸èµ·ï¼èè¯»æ¥å£é¨ç½²å¨å¦å¤çèç¹ä¸ã\n\n\n# 2. æå¡è·¯ç±çè§å\n\næå¡è·¯ç±ä¸»è¦æä¸¤ç§è§åï¼ä¸ç§æ¯æ¡ä»¶è·¯ç±ï¼ä¸ç§æ¯èæ¬è·¯ç±ã\n\n\n# 2.1. æ¡ä»¶è·¯ç±\n\næ¡ä»¶è·¯ç±æ¯åºäºæ¡ä»¶è¡¨è¾¾å¼çè·¯ç±è§åãåä¸ª rpc æ¡æ¶çæ¡ä»¶è·¯ç±è¡¨è¾¾å¼åä¸ç¸åã\n\næä»¬ä¸å¦¨åèä¸ä¸ dubbo çæ¡ä»¶è·¯ç±ãdubbo çæ¡ä»¶è·¯ç±æä¸¤ç§éç½®ç²åº¦ï¼å¦ä¸ï¼\n\n * åºç¨ç²åº¦\n   \n   # app1çæ¶è´¹èåªè½æ¶è´¹ææç«¯å£ä¸º20880çæå¡å®ä¾\n   # app2çæ¶è´¹èåªè½æ¶è´¹ææç«¯å£ä¸º20881çæå¡å®ä¾\n   ---\n   scope: application\n   force: true\n   runtime: true\n   enabled: true\n   key: governance-conditionrouter-consumer\n   conditions:\n     - application=app1 => address=*:20880\n     - application=app2 => address=*:20881\n   \n\n * æå¡ç²åº¦\n   \n   # demoserviceçsayhelloæ¹æ³åªè½æ¶è´¹ææç«¯å£ä¸º20880çæå¡å®ä¾\n   # demoserviceçsayhiæ¹æ³åªè½æ¶è´¹ææç«¯å£ä¸º20881çæå¡å®ä¾\n   ---\n   scope: service\n   force: true\n   runtime: true\n   enabled: true\n   key: org.apache.dubbo.samples.governance.api.demoservice\n   conditions:\n     - method=sayhello => address=*:20880\n     - method=sayhi => address=*:20881\n   \n\n> å¶ä¸­ï¼conditions å®ä¹å·ä½çè·¯ç±è§ååå®¹ãconditions é¨åæ¯è§åçä¸»ä½ï¼ç± 1 å°ä»»æå¤æ¡è§åç»æãè¯¦è§ï¼dubbo è·¯ç±è§å\n\ndubbo çæ¡ä»¶è·¯ç±è§åç±ä¸¤ä¸ªæ¡ä»¶ç»æï¼åå«ç¨äºå¯¹æå¡æ¶è´¹èåæä¾èè¿è¡å¹éãæ¡ä»¶è·¯ç±è§åçæ ¼å¼å¦ä¸ï¼\n\n[æå¡æ¶è´¹èå¹éæ¡ä»¶] => [æå¡æä¾èå¹éæ¡ä»¶]\n\n\n * æå¡æ¶è´¹èå¹éæ¡ä»¶ï¼ææåæ°åæ¶è´¹èç url è¿è¡å¯¹æ¯ï¼å½æ¶è´¹èæ»¡è¶³å¹éæ¡ä»¶æ¶ï¼å¯¹è¯¥æ¶è´¹èæ§è¡åé¢çè¿æ»¤è§åã\n * æå¡æä¾èå¹éæ¡ä»¶ï¼ææåæ°åæä¾èç url è¿è¡å¯¹æ¯ï¼æ¶è´¹èæç»åªæ¿å°è¿æ»¤åçå°ååè¡¨ã\n\ncondition:// ä»£è¡¨äºè¿æ¯ä¸æ®µç¨æ¡ä»¶è¡¨è¾¾å¼ç¼åçè·¯ç±è§åï¼ä¸é¢æ¯ä¸ä¸ªæ¡ä»¶è·¯ç±è§åç¤ºä¾ï¼\n\nhost = 10.20.153.10 => host = 10.20.153.11\n\n\nè¯¥æ¡è§åè¡¨ç¤º ip ä¸º 10.20.153.10 çæå¡æ¶è´¹èåªå¯è°ç¨ ip ä¸º 10.20.153.11 æºå¨ä¸çæå¡ï¼ä¸å¯è°ç¨å¶ä»æºå¨ä¸çæå¡ã\n\nä¸é¢åä¸¾ä¸äº dubbo æ¡ä»¶è·¯ç±çå¸ååºç¨åºæ¯ï¼\n\n * å¦ææå¡æ¶è´¹èçå¹éæ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºææçæå¡æ¶è´¹èé½å¯ä»¥è®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\n=> host != 10.20.153.11\n\n\n * å¦ææå¡æä¾èçè¿æ»¤æ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºç¦æ­¢ææçæå¡æ¶è´¹èè®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\nhost = 10.20.153.10 =>\n\n\n * æé¤æä¸ªæå¡èç¹\n\n=> host != 172.22.3.91\n\n\n * ç½åå\n\nregister.ip != 10.20.153.10,10.20.153.11 =>\n\n\n * é»åå\n\nregister.ip = 10.20.153.10,10.20.153.11 =>\n\n\n * åªæ´é²é¨åæºå¨èç¹\n\n=> host = 172.22.3.1*,172.22.3.2*\n\n\n * ä¸ºéè¦åºç¨æä¾é¢å¤çæºå¨èç¹\n\napplication != kylin => host != 172.22.3.95,172.22.3.96\n\n\n * è¯»ååç¦»\n\nmethod = find*,list*,get*,is* => host = 172.22.3.94,172.22.3.95,172.22.3.96\nmethod != find*,list*,get*,is* => host = 172.22.3.97,172.22.3.98\n\n\n * ååå°åç¦»\n\napplication = bops => host = 172.22.3.91,172.22.3.92,172.22.3.93\napplication != bops => host = 172.22.3.94,172.22.3.95,172.22.3.96\n\n\n * éç¦»ä¸åæºæ¿ç½æ®µ\n\nhost != 172.22.3.* => host != 172.22.3.*\n\n\n * æä¾èä¸æ¶è´¹èé¨ç½²å¨åéç¾¤åï¼æ¬æºåªè®¿é®æ¬æºçæå¡\n\n=> host = $host\n\n\n\n# 2.2. èæ¬è·¯ç±\n\nèæ¬è·¯ç±æ¯åºäºèæ¬è¯­è¨çè·¯ç±è§åï¼å¸¸ç¨çèæ¬è¯­è¨æ¯å¦ javascriptãgroovyãjruby ç­ã\n\n"script://0.0.0.0/com.foo.barservice?category=routers&dynamic=false&rule=" + url.encode("ï¼function route(invokers) { ... } (invokers)ï¼")\n\n\nè¿éé¢ script:// å°±ä»£è¡¨äºè¿æ¯ä¸æ®µèæ¬è¯­è¨ç¼åçè·¯ç±è§åï¼å·ä½è§åå®ä¹å¨èæ¬è¯­è¨ç route æ¹æ³å®ç°éï¼æ¯å¦ä¸é¢è¿æ®µç¨ javascript ç¼åç route() æ¹æ³è¡¨è¾¾çæææ¯ï¼åªæ ip ä¸º 10.20.153.10 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ã\n\nfunction route(invokers){\n  var result = new java.util.arraylist(invokers.size());\n  for(i =0; i < invokers.size(); i ++){\n    if("10.20.153.10".equals(invokers.get(i).geturl().gethost())){\n       result.add(invokers.get(i));\n    }\n  }\n  return result;\n } (invokers)ï¼;\n\n\n\n# 2.3. æ ç­¾è·¯ç±\n\næ ç­¾è·¯ç±éè¿å°æä¸ä¸ªæå¤ä¸ªæå¡çæä¾èååå°åä¸ä¸ªåç»ï¼çº¦ææµéåªå¨æå®åç»ä¸­æµè½¬ï¼ä»èå®ç°æµééç¦»çç®çï¼å¯ä»¥ä½ä¸ºèç»¿åå¸ãç°åº¦åå¸ç­åºæ¯çè½ååºç¡ã\n\næ ç­¾ä¸»è¦æ¯æå¯¹æå¡æä¾èçåç»ï¼ç®åæä¸¤ç§æ¹å¼å¯ä»¥å®æå®ä¾åç»ï¼åå«æ¯å¨æè§åææ åéæè§åææ ãä¸è¬ï¼å¨æè§åä¼åçº§æ¯éæè§åæ´é«ï¼å½ä¸¤ç§è§ååæ¶å­å¨ä¸åºç°å²çªæ¶ï¼å°ä»¥å¨æè§åä¸ºåã\n\nä»¥ dubbo çæ ç­¾è·¯ç±ç¨æ³ä¸ºä¾\n\nï¼1ï¼å¨æè§åææ ï¼å¯éæ¶å¨æå¡æ²»çæ§å¶å°ä¸åæ ç­¾å½ç»è§å\n\n# governance-tagrouter-provideråºç¨å¢å äºä¸¤ä¸ªæ ç­¾åç»tag1åtag2\n# tag1åå«ä¸ä¸ªå®ä¾ 127.0.0.1:20880\n# tag2åå«ä¸ä¸ªå®ä¾ 127.0.0.1:20881\n---\n  force: false\n  runtime: true\n  enabled: true\n  key: governance-tagrouter-provider\n  tags:\n    - name: tag1\n      addresses: ["127.0.0.1:20880"]\n    - name: tag2\n      addresses: ["127.0.0.1:20881"]\n ...\n\n\nï¼2ï¼éæè§åææ \n\n<dubbo:provider tag="tag1"/>\n\n\nor\n\n<dubbo:service tag="tag1"/>\n\n\nor\n\njava -jar xxx-provider.jar -ddubbo.provider.tag={the tag you want, may come from os env}\n\n\nï¼3ï¼æå¡æ¶è´¹èæå®æ ç­¾è·¯ç±\n\nrpccontext.getcontext().setattachment(constants.request_tag_key,"tag1");\n\n\nè¯·æ±æ ç­¾çä½ç¨åä¸ºæ¯ä¸æ¬¡ invocationï¼ä½¿ç¨ attachment æ¥ä¼ éè¯·æ±æ ç­¾ï¼æ³¨æä¿å­å¨ attachment ä¸­çå¼å°ä¼å¨ä¸æ¬¡å®æ´çè¿ç¨è°ç¨ä¸­æç»­ä¼ éï¼å¾çäºè¿æ ·çç¹æ§ï¼æä»¬åªéè¦å¨èµ·å§è°ç¨æ¶ï¼éè¿ä¸è¡ä»£ç çè®¾ç½®ï¼è¾¾å°æ ç­¾çæç»­ä¼ éã\n\n\n# 2.4. è·¯ç±è§åè·åæ¹å¼\n\nè·¯ç±è§åçè·åæ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * æ¬å°éæéç½®ï¼é¡¾åæä¹å°±æ¯è·¯ç±è§åå­å¨å¨æå¡æ¶è´¹èæ¬å°ä¸ãæå¡æ¶è´¹èåèµ·è°ç¨æ¶ï¼ä»æ¬å°åºå®ä½ç½®è¯»åè·¯ç±è§åï¼ç¶åæç§è·¯ç±è§åéåä¸ä¸ªæå¡èç¹åèµ·è°ç¨ã\n * éç½®ä¸­å¿ç®¡çï¼è¿ç§æ¹å¼ä¸ï¼ææçæå¡æ¶è´¹èé½ä»éç½®ä¸­å¿è·åè·¯ç±è§åï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çã\n * æ³¨åä¸­å¿å¨æä¸åï¼è¿ç§æ¹å¼ä¸ï¼ä¸è¬æ¯è¿ç»´äººåæèå¼åäººåï¼éè¿æå¡æ²»çå¹³å°ä¿®æ¹è·¯ç±è§åï¼æå¡æ²»çå¹³å°è°ç¨éç½®ä¸­å¿æ¥å£ï¼æä¿®æ¹åçè·¯ç±è§åæä¹åå°éç½®ä¸­å¿ãå ä¸ºæå¡æ¶è´¹èè®¢éäºè·¯ç±è§åçåæ´ï¼äºæ¯å°±ä¼ä»éç½®ä¸­å¿è·åææ°çè·¯ç±è§åï¼æç§ææ°çè·¯ç±è§åæ¥æ§è¡ã\n\nä¸è¬æ¥è®²ï¼æå¡è·¯ç±æå¥½æ¯å­å¨å¨éç½®ä¸­å¿ï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çãè¿æ ·çè¯ï¼ææçæå¡æ¶è´¹èå°±ä¸éè¦å¨æ¬å°ç®¡çæå¡è·¯ç±ï¼å ä¸ºå¤§é¨åçæå¡æ¶è´¹èå¹¶ä¸å³å¿æå¡è·¯ç±çé®é¢ï¼æèè¯´ä¹ä¸éè¦å»äºè§£å¶ä¸­çç»èãéè¿éç½®ä¸­å¿ï¼ç»ä¸ç»åä¸ªæå¡æ¶è´¹èä¸åç»ä¸çæå¡è·¯ç±ï¼èçäºæ²éåç®¡çææ¬ã\n\nä½ä¹ä¸æé¤æäºæå¡æ¶è´¹èæç¹å®çéæ±ï¼éè¦å®å¶èªå·±çè·¯ç±è§åï¼è¿ä¸ªæ¶åå°±éåéè¿æ¬å°éç½®æ¥å®å¶ã\n\nèå¨æä¸åå¯ä»¥çè§£ä¸ºä¸ç§é«çº§åè½ï¼å®è½å¤å¨æå°ä¿®æ¹è·¯ç±è§åï¼å¨æäºä¸å¡åºæ¯ä¸ååæç¨ãæ¯å¦æä¸ªæ°æ®ä¸­å¿å­å¨é®é¢ï¼éè¦æè°ç¨è¿ä¸ªæ°æ®ä¸­å¿çæå¡æ¶è´¹èé½åæ¢å°å¶ä»æ°æ®ä¸­å¿ï¼è¿æ¶å°±å¯ä»¥éè¿å¨æä¸åçæ¹å¼ï¼åéç½®ä¸­å¿ä¸åä¸æ¡è·¯ç±è§åï¼å°ææè°ç¨è¿ä¸ªæ°æ®ä¸­å¿çè¯·æ±é½è¿ç§»å°å«çå°æ¹ã\n\n\n# 3. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * rpc å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼ä¼è¯åºæ¬åç",frontmatter:{title:"åå¸å¼ä¼è¯åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æµéè°åº¦"],tags:["åå¸å¼","æµéè°åº¦","ä¼è¯"],abbrlink:"4418249f",date:"2019-06-04T23:42:00.000Z",permalink:"/pages/3e66c2/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/01.%E6%B5%81%E9%87%8F%E8%B0%83%E5%BA%A6/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/10.åå¸å¼ä¼è¯.md",key:"v-278d74e8",path:"/pages/3e66c2/",headers:[{level:2,title:"1. Cookie",slug:"_1-cookie",normalizedTitle:"1. cookie",charIndex:122},{level:3,title:"1.1. ä»ä¹æ¯ Cookie",slug:"_1-1-ä»ä¹æ¯-cookie",normalizedTitle:"1.1. ä»ä¹æ¯ cookie",charIndex:278},{level:3,title:"1.2. Cookie çå·¥ä½æ­¥éª¤",slug:"_1-2-cookie-çå·¥ä½æ­¥éª¤",normalizedTitle:"1.2. cookie çå·¥ä½æ­¥éª¤",charIndex:526},{level:3,title:"1.3. Cookie çä½ç¨",slug:"_1-3-cookie-çä½ç¨",normalizedTitle:"1.3. cookie çä½ç¨",charIndex:701},{level:3,title:"1.4. Cookie çéè¦å±æ§",slug:"_1-4-cookie-çéè¦å±æ§",normalizedTitle:"1.4. cookie çéè¦å±æ§",charIndex:892},{level:2,title:"2. Session",slug:"_2-session",normalizedTitle:"2. session",charIndex:1796},{level:3,title:"2.1. ä»ä¹æ¯ Session",slug:"_2-1-ä»ä¹æ¯-session",normalizedTitle:"2.1. ä»ä¹æ¯ session",charIndex:1811},{level:3,title:"2.2. Session çå·¥ä½æ­¥éª¤",slug:"_2-2-session-çå·¥ä½æ­¥éª¤",normalizedTitle:"2.2. session çå·¥ä½æ­¥éª¤",charIndex:2090},{level:2,title:"3. Cookie å Session çåºå«",slug:"_3-cookie-å-session-çåºå«",normalizedTitle:"3. cookie å session çåºå«",charIndex:2538},{level:2,title:"4. å¦æç¦ç¨ Cookie æä¹å",slug:"_4-å¦æç¦ç¨-cookie-æä¹å",normalizedTitle:"4. å¦æç¦ç¨ cookie æä¹å",charIndex:2986},{level:2,title:"5. åå¸å¼ Session",slug:"_5-åå¸å¼-session",normalizedTitle:"5. åå¸å¼ session",charIndex:3395},{level:3,title:"5.1. ç²æ§ Session",slug:"_5-1-ç²æ§-session",normalizedTitle:"5.1. ç²æ§ session",charIndex:3625},{level:3,title:"5.2. Session å¤å¶å±äº«",slug:"_5-2-session-å¤å¶å±äº«",normalizedTitle:"5.2. session å¤å¶å±äº«",charIndex:3782},{level:3,title:"5.3. åºäºç¼å­ç session å±äº«",slug:"_5-3-åºäºç¼å­ç-session-å±äº«",normalizedTitle:"5.3. åºäºç¼å­ç session å±äº«",charIndex:3924},{level:2,title:"6. å·ä½å®ç°",slug:"_6-å·ä½å®ç°",normalizedTitle:"6. å·ä½å®ç°",charIndex:4061},{level:3,title:"6.1. JWT Token",slug:"_6-1-jwt-token",normalizedTitle:"6.1. jwt token",charIndex:4073},{level:3,title:"6.2. tomcat + redis",slug:"_6-2-tomcat-redis",normalizedTitle:"6.2. tomcat + redis",charIndex:4158},{level:3,title:"6.3. spring session + redis",slug:"_6-3-spring-session-redis",normalizedTitle:"6.3. spring session + redis",charIndex:5047},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:7598}],headersStr:"1. Cookie 1.1. ä»ä¹æ¯ Cookie 1.2. Cookie çå·¥ä½æ­¥éª¤ 1.3. Cookie çä½ç¨ 1.4. Cookie çéè¦å±æ§ 2. Session 2.1. ä»ä¹æ¯ Session 2.2. Session çå·¥ä½æ­¥éª¤ 3. Cookie å Session çåºå« 4. å¦æç¦ç¨ Cookie æä¹å 5. åå¸å¼ Session 5.1. ç²æ§ Session 5.2. Session å¤å¶å±äº« 5.3. åºäºç¼å­ç session å±äº« 6. å·ä½å®ç° 6.1. JWT Token 6.2. tomcat + redis 6.3. spring session + redis 7. åèèµæ",content:'# åå¸å¼ä¼è¯åºæ¬åç\n\n> ç±äº Http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨ååä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n> \n> ä¼è¯è·è¸ªæ¯ Web ç¨åºä¸­å¸¸ç¨çææ¯ï¼ç¨æ¥è·è¸ªç¨æ·çæ´ä¸ªä¼è¯ãå¸¸ç¨ä¼è¯è·è¸ªææ¯æ¯ Cookie ä¸ Sessionã\n\n\n# 1. Cookie\n\nç±äº Http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨åä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n\næä»¥æå¡å¨ä¸æµè§å¨ä¸ºäºè¿è¡ä¼è¯è·è¸ªï¼ç¥éæ¯è°å¨è®¿é®æï¼ï¼å°±å¿é¡»ä¸»å¨çå»ç»´æ¤ä¸ä¸ªç¶æï¼è¿ä¸ªç¶æç¨äºåç¥æå¡ç«¯ååä¸¤ä¸ªè¯·æ±æ¯å¦æ¥èªåä¸æµè§å¨ãèè¿ä¸ªç¶æéè¦éè¿ cookie æè session å»å®ç°ã\n\n\n# 1.1. ä»ä¹æ¯ Cookie\n\nCookie å®éä¸æ¯å­å¨å¨ç¨æ·æµè§å¨ä¸çææ¬ä¿¡æ¯ï¼å¹¶ä¿çäºåç§è·è¸ªçä¿¡æ¯ã\n\nä¸ä¸ªç®åç cookie è®¾ç½®å¦ä¸ï¼\n\nSet-Cookie: <cookie-name>=<cookie-value>\n\n\nHTTP/2.0 200 OK\nContent-Type: text/html\nSet-Cookie: yummy_cookie=choco\nSet-Cookie: tasty_cookie=strawberry\n\n[page content]\n\n\n\n# 1.2. Cookie çå·¥ä½æ­¥éª¤\n\n 1. æµè§å¨è¯·æ±æå¡å¨ï¼å¦ææå¡å¨éè¦è®°å½è¯¥ç¨æ·çç¶æï¼å°±æ¯ç¨ response åæµè§å¨é¢åä¸ä¸ª Cookieã\n 2. æµè§å¨ä¼æ Cookie ä¿å­ä¸æ¥ã\n 3. å½æµè§å¨åè¯·æ±è¯¥ç½ç«æ¶ï¼æµè§å¨æè¯¥è¯·æ±çç½åè¿å Cookie ä¸åæäº¤ç»æå¡å¨ãæå¡å¨æ£æ¥è¯¥ Cookieï¼ä»¥æ­¤æ¥è¾¨è®¤ç¨æ·ç¶æã\n\n\n# 1.3. Cookie çä½ç¨\n\nCookie ä¸»è¦ç¨äºä»¥ä¸ä¸ä¸ªæ¹é¢ï¼\n\n * ä¼è¯ç¶æç®¡çï¼å¦ç¨æ·ç»å½ç¶æãè´­ç©è½¦ãæ¸¸æåæ°æå¶å®éè¦è®°å½çä¿¡æ¯ï¼\n * ä¸ªæ§åè®¾ç½®ï¼å¦ç¨æ·èªå®ä¹è®¾ç½®ãä¸»é¢ç­ï¼\n * æµè§å¨è¡ä¸ºè·è¸ªï¼å¦è·è¸ªåæç¨æ·è¡ä¸ºç­ï¼\n\næ³¨ï¼Cookie åè½éè¦æµè§å¨çæ¯æï¼å¦ææµè§å¨ä¸æ¯æ Cookie æè Cookie ç¦ç¨äºï¼Cookie åè½å°±ä¼å¤±æã\n\n\n# 1.4. Cookie çéè¦å±æ§\n\nå±æ§           è¯´æ\nname=value   é®å¼å¯¹ï¼è®¾ç½® Cookie çåç§°åç¸å¯¹åºçå¼ï¼é½å¿é¡»æ¯å­ç¬¦ä¸²ç±»å - å¦æå¼ä¸º Unicode å­ç¬¦ï¼éè¦ä¸ºå­ç¬¦ç¼ç ã\n             - å¦æå¼ä¸ºäºè¿å¶æ°æ®ï¼åéè¦ä½¿ç¨ BASE64 ç¼ç ã\ndomain       æå® cookie æå±ååï¼é»è®¤æ¯å½ååå\npath         æå® cookie å¨åªä¸ªè·¯å¾ï¼è·¯ç±ï¼ä¸çæï¼é»è®¤æ¯ \'/\'ã å¦æè®¾ç½®ä¸º /abcï¼ååªæ /abc\n             ä¸çè·¯ç±å¯ä»¥è®¿é®å°è¯¥ cookieï¼å¦ï¼/abc/readã\nmaxAge       cookie å¤±æçæ¶é´ï¼åä½ç§ãå¦æä¸ºæ´æ°ï¼åè¯¥ cookie å¨ maxAge ç§åå¤±æãå¦æä¸ºè´æ°ï¼è¯¥\n             cookie ä¸ºä¸´æ¶ cookie ï¼å³é­æµè§å¨å³å¤±æï¼æµè§å¨ä¹ä¸ä¼ä»¥ä»»ä½å½¢å¼ä¿å­è¯¥ cookie ãå¦æä¸º\n             0ï¼è¡¨ç¤ºå é¤è¯¥ cookie ãé»è®¤ä¸º -1ã - æ¯ expires å¥½ç¨ã\nexpires      è¿ææ¶é´ï¼å¨è®¾ç½®çæä¸ªæ¶é´ç¹åè¯¥ cookie å°±ä¼å¤±æã ä¸è¬æµè§å¨ç cookie\n             é½æ¯é»è®¤å¨å­çï¼å½å³é­æµè§å¨ç»æè¿ä¸ªä¼è¯çæ¶åï¼è¿ä¸ª cookie ä¹å°±ä¼è¢«å é¤\nsecure       è¯¥ cookie æ¯å¦ä»è¢«ä½¿ç¨å®å¨åè®®ä¼ è¾ãå®å¨åè®®æ HTTPSï¼SSL ç­ï¼å¨ç½ç»ä¸ä¼ è¾æ°æ®ä¹ååå°æ°æ®å å¯ãé»è®¤ä¸º\n             falseã å½ secure å¼ä¸º true æ¶ï¼cookie å¨ HTTP ä¸­æ¯æ æï¼å¨ HTTPS ä¸­æææã\nhttpOnly     å¦æç»æä¸ª cookie è®¾ç½®äº httpOnly å±æ§ï¼åæ æ³éè¿ JS èæ¬ è¯»åå°è¯¥ cookie\n             çä¿¡æ¯ï¼ä½è¿æ¯è½éè¿ Application ä¸­æå¨ä¿®æ¹ cookieï¼æä»¥åªæ¯å¨ä¸å®ç¨åº¦ä¸å¯ä»¥é²æ­¢ XSS\n             æ»å»ï¼ä¸æ¯ç»å¯¹çå®å¨\n\n\n# 2. Session\n\n\n# 2.1. ä»ä¹æ¯ Session\n\nSession ä»£è¡¨çæå¡å¨åå®¢æ·ç«¯ä¸æ¬¡ä¼è¯çè¿ç¨ãSession å¯¹è±¡å­å¨ç¹å®ç¨æ·ä¼è¯æéçå±æ§åéç½®ä¿¡æ¯ãè¿æ ·ï¼å½ç¨æ·å¨åºç¨ç¨åºç Web é¡µä¹é´è·³è½¬æ¶ï¼å­å¨å¨ Session å¯¹è±¡ä¸­çåéå°ä¸ä¼ä¸¢å¤±ï¼èæ¯å¨æ´ä¸ªç¨æ·ä¼è¯ä¸­ä¸ç´å­å¨ä¸å»ãå½å®¢æ·ç«¯å³é­ä¼è¯ï¼æè Session è¶æ¶å¤±ææ¶ä¼è¯ç»æã\n\n * session æ¯å¦ä¸ç§è®°å½æå¡å¨åå®¢æ·ç«¯ä¼è¯ç¶æçæºå¶\n * session æ¯åºäº cookie å®ç°çï¼session å­å¨å¨æå¡å¨ç«¯ï¼sessionId ä¼è¢«å­å¨å°å®¢æ·ç«¯ç cookie ä¸­\n\n\n\n\n# 2.2. Session çå·¥ä½æ­¥éª¤\n\n 1. ç¨æ·ç¬¬ä¸æ¬¡è¯·æ±æå¡å¨çæ¶åï¼æå¡å¨æ ¹æ®ç¨æ·æäº¤çç¸å³ä¿¡æ¯ï¼åå»ºå¯¹åºç Sessionã\n 2. è¯·æ±è¿åæ¶å°æ­¤ Session çå¯ä¸æ è¯ä¿¡æ¯ SessionID è¿åç»æµè§å¨ã\n 3. æµè§å¨æ¥æ¶å°æå¡å¨è¿åç SessionID ä¿¡æ¯åï¼ä¼å°æ­¤ä¿¡æ¯å­å¥å° Cookie ä¸­ï¼åæ¶ Cookie è®°å½æ­¤ SessionID å±äºåªä¸ªååã\n 4. å½ç¨æ·ç¬¬äºæ¬¡è®¿é®æå¡å¨çæ¶åï¼è¯·æ±ä¼èªå¨å¤æ­æ­¤ååä¸æ¯å¦å­å¨ Cookie ä¿¡æ¯ï¼å¦æå­å¨èªå¨å° Cookie ä¿¡æ¯ä¹åéç»æå¡ç«¯ï¼æå¡ç«¯ä¼ä» Cookie ä¸­è·å SessionIDï¼åæ ¹æ® SessionID æ¥æ¾å¯¹åºç Session ä¿¡æ¯ï¼å¦ææ²¡ææ¾å°è¯´æç¨æ·æ²¡æç»å½æèç»å½å¤±æï¼å¦ææ¾å° Session è¯æç¨æ·å·²ç»ç»å½å¯æ§è¡åé¢æä½ã\n\næ ¹æ®ä»¥ä¸æµç¨å¯ç¥ï¼SessionID æ¯è¿æ¥ Cookie å Session çä¸éæ¡¥æ¢ï¼å¤§é¨åç³»ç»ä¹æ¯æ ¹æ®æ­¤åçæ¥éªè¯ç¨æ·ç»å½ç¶æã\n\n\n# 3. Cookie å Session çåºå«\n\nCookie å Session çä¸»è¦åºå«å¯ä»¥åèä»¥ä¸è¡¨æ ¼ï¼\n\n       COOKIE                 SESSION\nä½ç¨èå´   ä¿å­å¨å®¢æ·ç«¯ï¼æµè§å¨ï¼            ä¿å­å¨æå¡å¨ç«¯\néç§ç­ç¥   å­å¨å¨å®¢æ·ç«¯ï¼æ¯è¾å®¹æé­å°éæ³è·å      å­å¨å¨æå¡ç«¯ï¼å®å¨æ§ç¸å¯¹ Cookie è¦å¥½ä¸äº\nå­å¨æ¹å¼   åªè½ä¿å­ ASCII             å¯ä»¥ä¿å­ä»»ææ°æ®ç±»åã\n                              ä¸è¬æåµä¸æä»¬å¯ä»¥å¨ Session ä¸­ä¿æä¸äºå¸¸ç¨åéä¿¡æ¯ï¼æ¯å¦è¯´ UserId ç­ã\nå­å¨å¤§å°   ä¸è½è¶è¿ 4K                å­å¨å¤§å°è¿é«äº Cookie\nçå½å¨æ   å¯è®¾ç½®ä¸ºæ°¸ä¹ä¿å­               ä¸è¬å¤±ææ¶é´è¾ç­\n       æ¯å¦æä»¬ç»å¸¸ä½¿ç¨çé»è®¤ç»å½ï¼è®°ä½æï¼åè½   å®¢æ·ç«¯å³é­æè Session è¶æ¶é½ä¼å¤±æã\n\n\n# 4. å¦æç¦ç¨ Cookie æä¹å\n\næ¢ç¶æå¡ç«¯æ¯æ ¹æ® Cookie ä¸­çä¿¡æ¯å¤æ­ç¨æ·æ¯å¦ç»å½ï¼é£ä¹å¦ææµè§å¨ä¸­ç¦æ­¢äº Cookieï¼å¦ä½ä¿éæ´ä¸ªæºå¶çæ­£å¸¸è¿è½¬ã\n\nç¬¬ä¸ç§æ¹æ¡ï¼æ¯æ¬¡è¯·æ±ä¸­é½æºå¸¦ä¸ä¸ª SessionID çåæ°ï¼ä¹å¯ä»¥ Post çæ¹å¼æäº¤ï¼ä¹å¯ä»¥å¨è¯·æ±çå°ååé¢æ¼æ¥ xxx?SessionID=123456...ã\n\nç¬¬äºç§æ¹æ¡ï¼Token æºå¶ãToken æºå¶å¤ç¨äº App å®¢æ·ç«¯åæå¡å¨äº¤äºçæ¨¡å¼ï¼ä¹å¯ä»¥ç¨äº Web ç«¯åç¨æ·ç¶æç®¡çã\n\nToken çæææ¯âä»¤çâï¼æ¯æå¡ç«¯çæçä¸ä¸²å­ç¬¦ä¸²ï¼ä½ä¸ºå®¢æ·ç«¯è¿è¡è¯·æ±çä¸ä¸ªæ è¯ãToken æºå¶å Cookie å Session çä½¿ç¨æºå¶æ¯è¾ç±»ä¼¼ã\n\nå½ç¨æ·ç¬¬ä¸æ¬¡ç»å½åï¼æå¡å¨æ ¹æ®æäº¤çç¨æ·ä¿¡æ¯çæä¸ä¸ª Tokenï¼ååºæ¶å° Token è¿åç»å®¢æ·ç«¯ï¼ä»¥åå®¢æ·ç«¯åªéå¸¦ä¸è¿ä¸ª Token åæ¥è¯·æ±æ°æ®å³å¯ï¼æ éåæ¬¡ç»å½éªè¯ã\n\n\n# 5. åå¸å¼ Session\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç Session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç Sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nåå¸å¼ Session çå ç§å®ç°ç­ç¥ï¼\n\n 1. ç²æ§ session\n 2. åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n 3. åºäºç¼å­ç session å±äº« â\n\n> æ¨èï¼åºäºç¼å­ç session å±äº«\n\n\n# 5.1. ç²æ§ Session\n\n> ç²æ§ Sessionï¼Sticky Sessionsï¼éè¦éç½®è´è½½åè¡¡å¨ï¼ä½¿å¾ä¸ä¸ªç¨æ·çææè¯·æ±é½è·¯ç±å°ä¸ä¸ªæå¡å¨èç¹ä¸ï¼è¿æ ·å°±å¯ä»¥æç¨æ·ç Session å­æ¾å¨è¯¥æå¡å¨èç¹ä¸­ã\n> \n> ç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ Sessionã\n\n\n\n\n# 5.2. Session å¤å¶å±äº«\n\n> Session å¤å¶å±äº«ï¼Session Replicationï¼å¨æå¡å¨èç¹ä¹é´è¿è¡ Session åæ­¥æä½ï¼è¿æ ·çè¯ç¨æ·å¯ä»¥è®¿é®ä»»ä½ä¸ä¸ªæå¡å¨èç¹ã\n> \n> ç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n\n\n\n\n# 5.3. åºäºç¼å­ç session å±äº«\n\n> ä½¿ç¨ä¸ä¸ªåç¬çå­å¨æå¡å¨å­å¨ Session æ°æ®ï¼å¯ä»¥å­å¨ MySQL æ°æ®åºä¸ï¼ä¹å¯ä»¥å­å¨ Redis æè Memcached è¿ç§åå­åæ°æ®åºã\n> \n> ç¼ºç¹ï¼éè¦å»å®ç°å­å Session çä»£ç ã\n\n\n\n\n# 6. å·ä½å®ç°\n\n\n# 6.1. JWT Token\n\nä½¿ç¨ JWT Token å¨å­ç¨æ·èº«ä»½ï¼ç¶ååä»æ°æ®åºæè cache ä¸­è·åå¶ä»çä¿¡æ¯ãè¿æ ·æ è®ºè¯·æ±åéå°åªä¸ªæå¡å¨é½æ æè°ã\n\n\n# 6.2. tomcat + redis\n\nè¿ä¸ªå¶å®è¿æºæ¹ä¾¿çï¼å°±æ¯ä½¿ç¨ session çä»£ç ï¼è·ä»¥åä¸æ ·ï¼è¿æ¯åºäº tomcat åçç session æ¯æå³å¯ï¼ç¶åå°±æ¯ç¨ä¸ä¸ªå«å Tomcat RedisSessionManager çä¸è¥¿ï¼è®©æææä»¬é¨ç½²ç tomcat é½å° session æ°æ®å­å¨å° redis å³å¯ã\n\nå¨ tomcat çéç½®æä»¶ä¸­éç½®ï¼\n\n<Valve className="com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve" />\n\n<Manager className="com.orangefunction.tomcat.redissessions.RedisSessionManager"\n         host="{redis.host}"\n         port="{redis.port}"\n         database="{redis.dbnum}"\n         maxInactiveInterval="60"/>\n\n\nç¶åæå® redis ç host å port å°± ok äºã\n\n<Valve className="com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve" />\n<Manager className="com.orangefunction.tomcat.redissessions.RedisSessionManager"\n\t sentinelMaster="mymaster"\n\t sentinels="<sentinel1-ip>:26379,<sentinel2-ip>:26379,<sentinel3-ip>:26379"\n\t maxInactiveInterval="60"/>\n\n\nè¿å¯ä»¥ç¨ä¸é¢è¿ç§æ¹å¼åºäº redis å¨åµæ¯æç redis é«å¯ç¨éç¾¤æ¥ä¿å­ session æ°æ®ï¼é½æ¯ ok çã\n\n\n# 6.3. spring session + redis\n\nä¸é¢é£ç§ tomcat + redis çæ¹å¼å¥½ç¨ï¼ä½æ¯ä¼ä¸¥éä¾èµäº web å®¹å¨ï¼ä¸å¥½å°ä»£ç ç§»æ¤å°å¶ä» web å®¹å¨ä¸å»ï¼å°¤å¶æ¯ä½ è¦æ¯æ¢äºææ¯æ åæ´ï¼æ¯å¦æ¢æäº spring cloud æèæ¯ spring boot ä¹ç±»çå¢ï¼\n\næä»¥ç°å¨æ¯è¾å¥½çè¿æ¯åºäº Java ä¸ç«å¼è§£å³æ¹æ¡ï¼ä¹å°±æ¯ springãäººå®¶ spring åºæ¬ä¸æ¿åäºå¤§é¨åæä»¬éè¦ä½¿ç¨çæ¡æ¶ï¼spirng cloud åå¾®æå¡ï¼spring boot åèææ¶ï¼æä»¥ç¨ sping session æ¯ä¸ä¸ªå¾å¥½çéæ©ã\n\nå¨ pom.xml ä¸­éç½®ï¼\n\n<dependency>\n  <groupId>org.springframework.session</groupId>\n  <artifactId>spring-session-data-redis</artifactId>\n  <version>1.2.1.RELEASE</version>\n</dependency>\n<dependency>\n  <groupId>redis.clients</groupId>\n  <artifactId>jedis</artifactId>\n  <version>2.8.1</version>\n</dependency>\n\n\nå¨ spring éç½®æä»¶ä¸­éç½®ï¼\n\n<bean id="redisHttpSessionConfiguration"\n     class="org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration">\n    <property name="maxInactiveIntervalInSeconds" value="600"/>\n</bean>\n\n<bean id="jedisPoolConfig" class="redis.clients.jedis.JedisPoolConfig">\n    <property name="maxTotal" value="100" />\n    <property name="maxIdle" value="10" />\n</bean>\n\n<bean id="jedisConnectionFactory"\n      class="org.springframework.data.redis.connection.jedis.JedisConnectionFactory" destroy-method="destroy">\n    <property name="hostName" value="${redis_hostname}"/>\n    <property name="port" value="${redis_port}"/>\n    <property name="password" value="${redis_pwd}" />\n    <property name="timeout" value="3000"/>\n    <property name="usePool" value="true"/>\n    <property name="poolConfig" ref="jedisPoolConfig"/>\n</bean>\n\n\nå¨ web.xml ä¸­éç½®ï¼\n\n<filter>\n    <filter-name>springSessionRepositoryFilter</filter-name>\n    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n</filter>\n<filter-mapping>\n    <filter-name>springSessionRepositoryFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n\nç¤ºä¾ä»£ç ï¼\n\n@RestController\n@RequestMapping("/test")\npublic class TestController {\n\n    @RequestMapping("/putIntoSession")\n    public String putIntoSession(HttpServletRequest request, String username) {\n        request.getSession().setAttribute("name",  "leo");\n        return "ok";\n    }\n\n    @RequestMapping("/getFromSession")\n    public String getFromSession(HttpServletRequest request, Model model){\n        String name = request.getSession().getAttribute("name");\n        return name;\n    }\n}\n\n\nä¸é¢çä»£ç å°±æ¯ ok çï¼ç» sping session éç½®åºäº redis æ¥å­å¨ session æ°æ®ï¼ç¶åéç½®äºä¸ä¸ª spring session çè¿æ»¤å¨ï¼è¿æ ·çè¯ï¼session ç¸å³æä½é½ä¼äº¤ç» spring session æ¥ç®¡äºãæ¥çå¨ä»£ç ä¸­ï¼å°±ç¨åçç session æä½ï¼å°±æ¯ç´æ¥åºäº spring sesion ä» redis ä¸­è·åæ°æ®äºã\n\nå®ç°åå¸å¼çä¼è¯æå¾å¤ç§æ¹å¼ï¼æè¯´çåªä¸è¿æ¯æ¯è¾å¸¸è§çå ç§æ¹å¼ï¼tomcat + redis æ©ææ¯è¾å¸¸ç¨ï¼ä½æ¯ä¼éè¦åå° tomcat ä¸­ï¼è¿äºå¹´ï¼éè¿ spring session æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * éç¾¤/åå¸å¼ç¯å¢ Session çå ç§ç­ç¥\n * ä½ ççäºè§£ Cookie å Session å\n * èä¸è session å cookie\n * YouTube è§é¢ - What is a cookie?\n * YouTube è§é¢ - How cookies can track you (Simply Explained)\n * MDN HTTP cookies',normalizedContent:'# åå¸å¼ä¼è¯åºæ¬åç\n\n> ç±äº http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨ååä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n> \n> ä¼è¯è·è¸ªæ¯ web ç¨åºä¸­å¸¸ç¨çææ¯ï¼ç¨æ¥è·è¸ªç¨æ·çæ´ä¸ªä¼è¯ãå¸¸ç¨ä¼è¯è·è¸ªææ¯æ¯ cookie ä¸ sessionã\n\n\n# 1. cookie\n\nç±äº http æ¯ä¸ç§æ ç¶æçåè®®ï¼æå¡å¨åä»ç½ç»è¿æ¥ä¸æ ä»ç¥éå®¢æ·èº«ä»½ã\n\næä»¥æå¡å¨ä¸æµè§å¨ä¸ºäºè¿è¡ä¼è¯è·è¸ªï¼ç¥éæ¯è°å¨è®¿é®æï¼ï¼å°±å¿é¡»ä¸»å¨çå»ç»´æ¤ä¸ä¸ªç¶æï¼è¿ä¸ªç¶æç¨äºåç¥æå¡ç«¯ååä¸¤ä¸ªè¯·æ±æ¯å¦æ¥èªåä¸æµè§å¨ãèè¿ä¸ªç¶æéè¦éè¿ cookie æè session å»å®ç°ã\n\n\n# 1.1. ä»ä¹æ¯ cookie\n\ncookie å®éä¸æ¯å­å¨å¨ç¨æ·æµè§å¨ä¸çææ¬ä¿¡æ¯ï¼å¹¶ä¿çäºåç§è·è¸ªçä¿¡æ¯ã\n\nä¸ä¸ªç®åç cookie è®¾ç½®å¦ä¸ï¼\n\nset-cookie: <cookie-name>=<cookie-value>\n\n\nhttp/2.0 200 ok\ncontent-type: text/html\nset-cookie: yummy_cookie=choco\nset-cookie: tasty_cookie=strawberry\n\n[page content]\n\n\n\n# 1.2. cookie çå·¥ä½æ­¥éª¤\n\n 1. æµè§å¨è¯·æ±æå¡å¨ï¼å¦ææå¡å¨éè¦è®°å½è¯¥ç¨æ·çç¶æï¼å°±æ¯ç¨ response åæµè§å¨é¢åä¸ä¸ª cookieã\n 2. æµè§å¨ä¼æ cookie ä¿å­ä¸æ¥ã\n 3. å½æµè§å¨åè¯·æ±è¯¥ç½ç«æ¶ï¼æµè§å¨æè¯¥è¯·æ±çç½åè¿å cookie ä¸åæäº¤ç»æå¡å¨ãæå¡å¨æ£æ¥è¯¥ cookieï¼ä»¥æ­¤æ¥è¾¨è®¤ç¨æ·ç¶æã\n\n\n# 1.3. cookie çä½ç¨\n\ncookie ä¸»è¦ç¨äºä»¥ä¸ä¸ä¸ªæ¹é¢ï¼\n\n * ä¼è¯ç¶æç®¡çï¼å¦ç¨æ·ç»å½ç¶æãè´­ç©è½¦ãæ¸¸æåæ°æå¶å®éè¦è®°å½çä¿¡æ¯ï¼\n * ä¸ªæ§åè®¾ç½®ï¼å¦ç¨æ·èªå®ä¹è®¾ç½®ãä¸»é¢ç­ï¼\n * æµè§å¨è¡ä¸ºè·è¸ªï¼å¦è·è¸ªåæç¨æ·è¡ä¸ºç­ï¼\n\næ³¨ï¼cookie åè½éè¦æµè§å¨çæ¯æï¼å¦ææµè§å¨ä¸æ¯æ cookie æè cookie ç¦ç¨äºï¼cookie åè½å°±ä¼å¤±æã\n\n\n# 1.4. cookie çéè¦å±æ§\n\nå±æ§           è¯´æ\nname=value   é®å¼å¯¹ï¼è®¾ç½® cookie çåç§°åç¸å¯¹åºçå¼ï¼é½å¿é¡»æ¯å­ç¬¦ä¸²ç±»å - å¦æå¼ä¸º unicode å­ç¬¦ï¼éè¦ä¸ºå­ç¬¦ç¼ç ã\n             - å¦æå¼ä¸ºäºè¿å¶æ°æ®ï¼åéè¦ä½¿ç¨ base64 ç¼ç ã\ndomain       æå® cookie æå±ååï¼é»è®¤æ¯å½ååå\npath         æå® cookie å¨åªä¸ªè·¯å¾ï¼è·¯ç±ï¼ä¸çæï¼é»è®¤æ¯ \'/\'ã å¦æè®¾ç½®ä¸º /abcï¼ååªæ /abc\n             ä¸çè·¯ç±å¯ä»¥è®¿é®å°è¯¥ cookieï¼å¦ï¼/abc/readã\nmaxage       cookie å¤±æçæ¶é´ï¼åä½ç§ãå¦æä¸ºæ´æ°ï¼åè¯¥ cookie å¨ maxage ç§åå¤±æãå¦æä¸ºè´æ°ï¼è¯¥\n             cookie ä¸ºä¸´æ¶ cookie ï¼å³é­æµè§å¨å³å¤±æï¼æµè§å¨ä¹ä¸ä¼ä»¥ä»»ä½å½¢å¼ä¿å­è¯¥ cookie ãå¦æä¸º\n             0ï¼è¡¨ç¤ºå é¤è¯¥ cookie ãé»è®¤ä¸º -1ã - æ¯ expires å¥½ç¨ã\nexpires      è¿ææ¶é´ï¼å¨è®¾ç½®çæä¸ªæ¶é´ç¹åè¯¥ cookie å°±ä¼å¤±æã ä¸è¬æµè§å¨ç cookie\n             é½æ¯é»è®¤å¨å­çï¼å½å³é­æµè§å¨ç»æè¿ä¸ªä¼è¯çæ¶åï¼è¿ä¸ª cookie ä¹å°±ä¼è¢«å é¤\nsecure       è¯¥ cookie æ¯å¦ä»è¢«ä½¿ç¨å®å¨åè®®ä¼ è¾ãå®å¨åè®®æ httpsï¼ssl ç­ï¼å¨ç½ç»ä¸ä¼ è¾æ°æ®ä¹ååå°æ°æ®å å¯ãé»è®¤ä¸º\n             falseã å½ secure å¼ä¸º true æ¶ï¼cookie å¨ http ä¸­æ¯æ æï¼å¨ https ä¸­æææã\nhttponly     å¦æç»æä¸ª cookie è®¾ç½®äº httponly å±æ§ï¼åæ æ³éè¿ js èæ¬ è¯»åå°è¯¥ cookie\n             çä¿¡æ¯ï¼ä½è¿æ¯è½éè¿ application ä¸­æå¨ä¿®æ¹ cookieï¼æä»¥åªæ¯å¨ä¸å®ç¨åº¦ä¸å¯ä»¥é²æ­¢ xss\n             æ»å»ï¼ä¸æ¯ç»å¯¹çå®å¨\n\n\n# 2. session\n\n\n# 2.1. ä»ä¹æ¯ session\n\nsession ä»£è¡¨çæå¡å¨åå®¢æ·ç«¯ä¸æ¬¡ä¼è¯çè¿ç¨ãsession å¯¹è±¡å­å¨ç¹å®ç¨æ·ä¼è¯æéçå±æ§åéç½®ä¿¡æ¯ãè¿æ ·ï¼å½ç¨æ·å¨åºç¨ç¨åºç web é¡µä¹é´è·³è½¬æ¶ï¼å­å¨å¨ session å¯¹è±¡ä¸­çåéå°ä¸ä¼ä¸¢å¤±ï¼èæ¯å¨æ´ä¸ªç¨æ·ä¼è¯ä¸­ä¸ç´å­å¨ä¸å»ãå½å®¢æ·ç«¯å³é­ä¼è¯ï¼æè session è¶æ¶å¤±ææ¶ä¼è¯ç»æã\n\n * session æ¯å¦ä¸ç§è®°å½æå¡å¨åå®¢æ·ç«¯ä¼è¯ç¶æçæºå¶\n * session æ¯åºäº cookie å®ç°çï¼session å­å¨å¨æå¡å¨ç«¯ï¼sessionid ä¼è¢«å­å¨å°å®¢æ·ç«¯ç cookie ä¸­\n\n\n\n\n# 2.2. session çå·¥ä½æ­¥éª¤\n\n 1. ç¨æ·ç¬¬ä¸æ¬¡è¯·æ±æå¡å¨çæ¶åï¼æå¡å¨æ ¹æ®ç¨æ·æäº¤çç¸å³ä¿¡æ¯ï¼åå»ºå¯¹åºç sessionã\n 2. è¯·æ±è¿åæ¶å°æ­¤ session çå¯ä¸æ è¯ä¿¡æ¯ sessionid è¿åç»æµè§å¨ã\n 3. æµè§å¨æ¥æ¶å°æå¡å¨è¿åç sessionid ä¿¡æ¯åï¼ä¼å°æ­¤ä¿¡æ¯å­å¥å° cookie ä¸­ï¼åæ¶ cookie è®°å½æ­¤ sessionid å±äºåªä¸ªååã\n 4. å½ç¨æ·ç¬¬äºæ¬¡è®¿é®æå¡å¨çæ¶åï¼è¯·æ±ä¼èªå¨å¤æ­æ­¤ååä¸æ¯å¦å­å¨ cookie ä¿¡æ¯ï¼å¦æå­å¨èªå¨å° cookie ä¿¡æ¯ä¹åéç»æå¡ç«¯ï¼æå¡ç«¯ä¼ä» cookie ä¸­è·å sessionidï¼åæ ¹æ® sessionid æ¥æ¾å¯¹åºç session ä¿¡æ¯ï¼å¦ææ²¡ææ¾å°è¯´æç¨æ·æ²¡æç»å½æèç»å½å¤±æï¼å¦ææ¾å° session è¯æç¨æ·å·²ç»ç»å½å¯æ§è¡åé¢æä½ã\n\næ ¹æ®ä»¥ä¸æµç¨å¯ç¥ï¼sessionid æ¯è¿æ¥ cookie å session çä¸éæ¡¥æ¢ï¼å¤§é¨åç³»ç»ä¹æ¯æ ¹æ®æ­¤åçæ¥éªè¯ç¨æ·ç»å½ç¶æã\n\n\n# 3. cookie å session çåºå«\n\ncookie å session çä¸»è¦åºå«å¯ä»¥åèä»¥ä¸è¡¨æ ¼ï¼\n\n       cookie                 session\nä½ç¨èå´   ä¿å­å¨å®¢æ·ç«¯ï¼æµè§å¨ï¼            ä¿å­å¨æå¡å¨ç«¯\néç§ç­ç¥   å­å¨å¨å®¢æ·ç«¯ï¼æ¯è¾å®¹æé­å°éæ³è·å      å­å¨å¨æå¡ç«¯ï¼å®å¨æ§ç¸å¯¹ cookie è¦å¥½ä¸äº\nå­å¨æ¹å¼   åªè½ä¿å­ ascii             å¯ä»¥ä¿å­ä»»ææ°æ®ç±»åã\n                              ä¸è¬æåµä¸æä»¬å¯ä»¥å¨ session ä¸­ä¿æä¸äºå¸¸ç¨åéä¿¡æ¯ï¼æ¯å¦è¯´ userid ç­ã\nå­å¨å¤§å°   ä¸è½è¶è¿ 4k                å­å¨å¤§å°è¿é«äº cookie\nçå½å¨æ   å¯è®¾ç½®ä¸ºæ°¸ä¹ä¿å­               ä¸è¬å¤±ææ¶é´è¾ç­\n       æ¯å¦æä»¬ç»å¸¸ä½¿ç¨çé»è®¤ç»å½ï¼è®°ä½æï¼åè½   å®¢æ·ç«¯å³é­æè session è¶æ¶é½ä¼å¤±æã\n\n\n# 4. å¦æç¦ç¨ cookie æä¹å\n\næ¢ç¶æå¡ç«¯æ¯æ ¹æ® cookie ä¸­çä¿¡æ¯å¤æ­ç¨æ·æ¯å¦ç»å½ï¼é£ä¹å¦ææµè§å¨ä¸­ç¦æ­¢äº cookieï¼å¦ä½ä¿éæ´ä¸ªæºå¶çæ­£å¸¸è¿è½¬ã\n\nç¬¬ä¸ç§æ¹æ¡ï¼æ¯æ¬¡è¯·æ±ä¸­é½æºå¸¦ä¸ä¸ª sessionid çåæ°ï¼ä¹å¯ä»¥ post çæ¹å¼æäº¤ï¼ä¹å¯ä»¥å¨è¯·æ±çå°ååé¢æ¼æ¥ xxx?sessionid=123456...ã\n\nç¬¬äºç§æ¹æ¡ï¼token æºå¶ãtoken æºå¶å¤ç¨äº app å®¢æ·ç«¯åæå¡å¨äº¤äºçæ¨¡å¼ï¼ä¹å¯ä»¥ç¨äº web ç«¯åç¨æ·ç¶æç®¡çã\n\ntoken çæææ¯âä»¤çâï¼æ¯æå¡ç«¯çæçä¸ä¸²å­ç¬¦ä¸²ï¼ä½ä¸ºå®¢æ·ç«¯è¿è¡è¯·æ±çä¸ä¸ªæ è¯ãtoken æºå¶å cookie å session çä½¿ç¨æºå¶æ¯è¾ç±»ä¼¼ã\n\nå½ç¨æ·ç¬¬ä¸æ¬¡ç»å½åï¼æå¡å¨æ ¹æ®æäº¤çç¨æ·ä¿¡æ¯çæä¸ä¸ª tokenï¼ååºæ¶å° token è¿åç»å®¢æ·ç«¯ï¼ä»¥åå®¢æ·ç«¯åªéå¸¦ä¸è¿ä¸ª token åæ¥è¯·æ±æ°æ®å³å¯ï¼æ éåæ¬¡ç»å½éªè¯ã\n\n\n# 5. åå¸å¼ session\n\nå¨åå¸å¼åºæ¯ä¸ï¼ä¸ä¸ªç¨æ·ç session å¦æåªå­å¨å¨ä¸ä¸ªæå¡å¨ä¸ï¼é£ä¹å½è´è½½åè¡¡å¨æç¨æ·çä¸ä¸ä¸ªè¯·æ±è½¬åå°å¦ä¸ä¸ªæå¡å¨ä¸ï¼è¯¥æå¡å¨æ²¡æç¨æ·ç sessionï¼å°±å¯è½å¯¼è´ç¨æ·éè¦éæ°è¿è¡ç»å½ç­æä½ã\n\nåå¸å¼ session çå ç§å®ç°ç­ç¥ï¼\n\n 1. ç²æ§ session\n 2. åºç¨æå¡å¨é´ç session å¤å¶å±äº«\n 3. åºäºç¼å­ç session å±äº« â\n\n> æ¨èï¼åºäºç¼å­ç session å±äº«\n\n\n# 5.1. ç²æ§ session\n\n> ç²æ§ sessionï¼sticky sessionsï¼éè¦éç½®è´è½½åè¡¡å¨ï¼ä½¿å¾ä¸ä¸ªç¨æ·çææè¯·æ±é½è·¯ç±å°ä¸ä¸ªæå¡å¨èç¹ä¸ï¼è¿æ ·å°±å¯ä»¥æç¨æ·ç session å­æ¾å¨è¯¥æå¡å¨èç¹ä¸­ã\n> \n> ç¼ºç¹ï¼å½æå¡å¨èç¹å®æºæ¶ï¼å°ä¸¢å¤±è¯¥æå¡å¨èç¹ä¸çææ sessionã\n\n\n\n\n# 5.2. session å¤å¶å±äº«\n\n> session å¤å¶å±äº«ï¼session replicationï¼å¨æå¡å¨èç¹ä¹é´è¿è¡ session åæ­¥æä½ï¼è¿æ ·çè¯ç¨æ·å¯ä»¥è®¿é®ä»»ä½ä¸ä¸ªæå¡å¨èç¹ã\n> \n> ç¼ºç¹ï¼å ç¨è¿å¤åå­ï¼åæ­¥è¿ç¨å ç¨ç½ç»å¸¦å®½ä»¥åæå¡å¨å¤çå¨æ¶é´ã\n\n\n\n\n# 5.3. åºäºç¼å­ç session å±äº«\n\n> ä½¿ç¨ä¸ä¸ªåç¬çå­å¨æå¡å¨å­å¨ session æ°æ®ï¼å¯ä»¥å­å¨ mysql æ°æ®åºä¸ï¼ä¹å¯ä»¥å­å¨ redis æè memcached è¿ç§åå­åæ°æ®åºã\n> \n> ç¼ºç¹ï¼éè¦å»å®ç°å­å session çä»£ç ã\n\n\n\n\n# 6. å·ä½å®ç°\n\n\n# 6.1. jwt token\n\nä½¿ç¨ jwt token å¨å­ç¨æ·èº«ä»½ï¼ç¶ååä»æ°æ®åºæè cache ä¸­è·åå¶ä»çä¿¡æ¯ãè¿æ ·æ è®ºè¯·æ±åéå°åªä¸ªæå¡å¨é½æ æè°ã\n\n\n# 6.2. tomcat + redis\n\nè¿ä¸ªå¶å®è¿æºæ¹ä¾¿çï¼å°±æ¯ä½¿ç¨ session çä»£ç ï¼è·ä»¥åä¸æ ·ï¼è¿æ¯åºäº tomcat åçç session æ¯æå³å¯ï¼ç¶åå°±æ¯ç¨ä¸ä¸ªå«å tomcat redissessionmanager çä¸è¥¿ï¼è®©æææä»¬é¨ç½²ç tomcat é½å° session æ°æ®å­å¨å° redis å³å¯ã\n\nå¨ tomcat çéç½®æä»¶ä¸­éç½®ï¼\n\n<valve classname="com.orangefunction.tomcat.redissessions.redissessionhandlervalve" />\n\n<manager classname="com.orangefunction.tomcat.redissessions.redissessionmanager"\n         host="{redis.host}"\n         port="{redis.port}"\n         database="{redis.dbnum}"\n         maxinactiveinterval="60"/>\n\n\nç¶åæå® redis ç host å port å°± ok äºã\n\n<valve classname="com.orangefunction.tomcat.redissessions.redissessionhandlervalve" />\n<manager classname="com.orangefunction.tomcat.redissessions.redissessionmanager"\n\t sentinelmaster="mymaster"\n\t sentinels="<sentinel1-ip>:26379,<sentinel2-ip>:26379,<sentinel3-ip>:26379"\n\t maxinactiveinterval="60"/>\n\n\nè¿å¯ä»¥ç¨ä¸é¢è¿ç§æ¹å¼åºäº redis å¨åµæ¯æç redis é«å¯ç¨éç¾¤æ¥ä¿å­ session æ°æ®ï¼é½æ¯ ok çã\n\n\n# 6.3. spring session + redis\n\nä¸é¢é£ç§ tomcat + redis çæ¹å¼å¥½ç¨ï¼ä½æ¯ä¼ä¸¥éä¾èµäº web å®¹å¨ï¼ä¸å¥½å°ä»£ç ç§»æ¤å°å¶ä» web å®¹å¨ä¸å»ï¼å°¤å¶æ¯ä½ è¦æ¯æ¢äºææ¯æ åæ´ï¼æ¯å¦æ¢æäº spring cloud æèæ¯ spring boot ä¹ç±»çå¢ï¼\n\næä»¥ç°å¨æ¯è¾å¥½çè¿æ¯åºäº java ä¸ç«å¼è§£å³æ¹æ¡ï¼ä¹å°±æ¯ springãäººå®¶ spring åºæ¬ä¸æ¿åäºå¤§é¨åæä»¬éè¦ä½¿ç¨çæ¡æ¶ï¼spirng cloud åå¾®æå¡ï¼spring boot åèææ¶ï¼æä»¥ç¨ sping session æ¯ä¸ä¸ªå¾å¥½çéæ©ã\n\nå¨ pom.xml ä¸­éç½®ï¼\n\n<dependency>\n  <groupid>org.springframework.session</groupid>\n  <artifactid>spring-session-data-redis</artifactid>\n  <version>1.2.1.release</version>\n</dependency>\n<dependency>\n  <groupid>redis.clients</groupid>\n  <artifactid>jedis</artifactid>\n  <version>2.8.1</version>\n</dependency>\n\n\nå¨ spring éç½®æä»¶ä¸­éç½®ï¼\n\n<bean id="redishttpsessionconfiguration"\n     class="org.springframework.session.data.redis.config.annotation.web.http.redishttpsessionconfiguration">\n    <property name="maxinactiveintervalinseconds" value="600"/>\n</bean>\n\n<bean id="jedispoolconfig" class="redis.clients.jedis.jedispoolconfig">\n    <property name="maxtotal" value="100" />\n    <property name="maxidle" value="10" />\n</bean>\n\n<bean id="jedisconnectionfactory"\n      class="org.springframework.data.redis.connection.jedis.jedisconnectionfactory" destroy-method="destroy">\n    <property name="hostname" value="${redis_hostname}"/>\n    <property name="port" value="${redis_port}"/>\n    <property name="password" value="${redis_pwd}" />\n    <property name="timeout" value="3000"/>\n    <property name="usepool" value="true"/>\n    <property name="poolconfig" ref="jedispoolconfig"/>\n</bean>\n\n\nå¨ web.xml ä¸­éç½®ï¼\n\n<filter>\n    <filter-name>springsessionrepositoryfilter</filter-name>\n    <filter-class>org.springframework.web.filter.delegatingfilterproxy</filter-class>\n</filter>\n<filter-mapping>\n    <filter-name>springsessionrepositoryfilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n\nç¤ºä¾ä»£ç ï¼\n\n@restcontroller\n@requestmapping("/test")\npublic class testcontroller {\n\n    @requestmapping("/putintosession")\n    public string putintosession(httpservletrequest request, string username) {\n        request.getsession().setattribute("name",  "leo");\n        return "ok";\n    }\n\n    @requestmapping("/getfromsession")\n    public string getfromsession(httpservletrequest request, model model){\n        string name = request.getsession().getattribute("name");\n        return name;\n    }\n}\n\n\nä¸é¢çä»£ç å°±æ¯ ok çï¼ç» sping session éç½®åºäº redis æ¥å­å¨ session æ°æ®ï¼ç¶åéç½®äºä¸ä¸ª spring session çè¿æ»¤å¨ï¼è¿æ ·çè¯ï¼session ç¸å³æä½é½ä¼äº¤ç» spring session æ¥ç®¡äºãæ¥çå¨ä»£ç ä¸­ï¼å°±ç¨åçç session æä½ï¼å°±æ¯ç´æ¥åºäº spring sesion ä» redis ä¸­è·åæ°æ®äºã\n\nå®ç°åå¸å¼çä¼è¯æå¾å¤ç§æ¹å¼ï¼æè¯´çåªä¸è¿æ¯æ¯è¾å¸¸è§çå ç§æ¹å¼ï¼tomcat + redis æ©ææ¯è¾å¸¸ç¨ï¼ä½æ¯ä¼éè¦åå° tomcat ä¸­ï¼è¿äºå¹´ï¼éè¿ spring session æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * éç¾¤/åå¸å¼ç¯å¢ session çå ç§ç­ç¥\n * ä½ ççäºè§£ cookie å session å\n * èä¸è session å cookie\n * youtube è§é¢ - what is a cookie?\n * youtube è§é¢ - how cookies can track you (simply explained)\n * mdn http cookies',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç¼å­åºæ¬åç",frontmatter:{title:"ç¼å­åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","ç¼å­"],abbrlink:"412ad09",date:"2019-06-27T15:36:00.000Z",permalink:"/pages/471208/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/01.%E6%95%B0%E6%8D%AE%E7%BC%93%E5%AD%98.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/01.æ°æ®ç¼å­.md",key:"v-6091d31b",path:"/pages/471208/",headers:[{level:2,title:"1. ç¼å­ç®ä»",slug:"_1-ç¼å­ç®ä»",normalizedTitle:"1. ç¼å­ç®ä»",charIndex:44},{level:3,title:"1.1. ä¸ºä»ä¹éè¦ç¼å­",slug:"_1-1-ä¸ºä»ä¹éè¦ç¼å­",normalizedTitle:"1.1. ä¸ºä»ä¹éè¦ç¼å­",charIndex:56},{level:3,title:"1.2. ä»ä¹æ¯ç¼å­",slug:"_1-2-ä»ä¹æ¯ç¼å­",normalizedTitle:"1.2. ä»ä¹æ¯ç¼å­",charIndex:426},{level:3,title:"1.3. ä½æ¶éè¦ç¼å­",slug:"_1-3-ä½æ¶éè¦ç¼å­",normalizedTitle:"1.3. ä½æ¶éè¦ç¼å­",charIndex:765},{level:3,title:"1.4. ç¼å­çåºæ¬åç",slug:"_1-4-ç¼å­çåºæ¬åç",normalizedTitle:"1.4. ç¼å­çåºæ¬åç",charIndex:1062},{level:3,title:"1.5. ç¼å­æ·æ±°ç­ç¥",slug:"_1-5-ç¼å­æ·æ±°ç­ç¥",normalizedTitle:"1.5. ç¼å­æ·æ±°ç­ç¥",charIndex:1230},{level:2,title:"2. ç¼å­çåç±»",slug:"_2-ç¼å­çåç±»",normalizedTitle:"2. ç¼å­çåç±»",charIndex:1961},{level:3,title:"2.1. HTTP ç¼å­",slug:"_2-1-http-ç¼å­",normalizedTitle:"2.1. http ç¼å­",charIndex:2396},{level:3,title:"2.2. CDN ç¼å­",slug:"_2-2-cdn-ç¼å­",normalizedTitle:"2.2. cdn ç¼å­",charIndex:2679},{level:4,title:"2.2.1. CDN åç",slug:"_2-2-1-cdn-åç",normalizedTitle:"2.2.1. cdn åç",charIndex:2870},{level:4,title:"2.2.2. CDN ç¹ç¹",slug:"_2-2-2-cdn-ç¹ç¹",normalizedTitle:"2.2.2. cdn ç¹ç¹",charIndex:3305},{level:3,title:"2.3. ååä»£çç¼å­",slug:"_2-3-ååä»£çç¼å­",normalizedTitle:"2.3. ååä»£çç¼å­",charIndex:3851},{level:4,title:"2.3.1. ååä»£çç¼å­åç",slug:"_2-3-1-ååä»£çç¼å­åç",normalizedTitle:"2.3.1. ååä»£çç¼å­åç",charIndex:3997},{level:4,title:"2.3.2. ååä»£çç¼å­æ¯è¾",slug:"_2-3-2-ååä»£çç¼å­æ¯è¾",normalizedTitle:"2.3.2. ååä»£çç¼å­æ¯è¾",charIndex:4262},{level:2,title:"3. è¿ç¨åç¼å­",slug:"_3-è¿ç¨åç¼å­",normalizedTitle:"3. è¿ç¨åç¼å­",charIndex:4627},{level:3,title:"3.1. ConcurrentHashMap",slug:"_3-1-concurrenthashmap",normalizedTitle:"3.1. concurrenthashmap",charIndex:4904},{level:3,title:"3.2. LRUHashMap",slug:"_3-2-lruhashmap",normalizedTitle:"3.2. lruhashmap",charIndex:5028},{level:3,title:"3.3. Guava Cache",slug:"_3-3-guava-cache",normalizedTitle:"3.3. guava cache",charIndex:5177},{level:3,title:"3.4. Caffeine",slug:"_3-4-caffeine",normalizedTitle:"3.4. caffeine",charIndex:5396},{level:3,title:"3.5. Ehcache",slug:"_3-5-ehcache",normalizedTitle:"3.5. ehcache",charIndex:5510},{level:3,title:"3.6. è¿ç¨åç¼å­å¯¹æ¯",slug:"_3-6-è¿ç¨åç¼å­å¯¹æ¯",normalizedTitle:"3.6. è¿ç¨åç¼å­å¯¹æ¯",charIndex:5876},{level:2,title:"4. åå¸å¼ç¼å­",slug:"_4-åå¸å¼ç¼å­",normalizedTitle:"4. åå¸å¼ç¼å­",charIndex:7334},{level:3,title:"4.1. Memcached",slug:"_4-1-memcached",normalizedTitle:"4.1. memcached",charIndex:7519},{level:4,title:"4.1.1. Memcached ç¹æ§",slug:"_4-1-1-memcached-ç¹æ§",normalizedTitle:"4.1.1. memcached ç¹æ§",charIndex:7674},{level:4,title:"4.1.2. Memcached å·¥ä½åç",slug:"_4-1-2-memcached-å·¥ä½åç",normalizedTitle:"4.1.2. memcached å·¥ä½åç",charIndex:8536},{level:3,title:"4.2. Redis",slug:"_4-2-redis",normalizedTitle:"4.2. redis",charIndex:9492},{level:4,title:"4.2.1. Redis ç¹æ§",slug:"_4-2-1-redis-ç¹æ§",normalizedTitle:"4.2.1. redis ç¹æ§",charIndex:9764},{level:4,title:"4.2.2. Redis åç",slug:"_4-2-2-redis-åç",normalizedTitle:"4.2.2. redis åç",charIndex:10147},{level:3,title:"4.3. åå¸å¼ç¼å­å¯¹æ¯",slug:"_4-3-åå¸å¼ç¼å­å¯¹æ¯",normalizedTitle:"4.3. åå¸å¼ç¼å­å¯¹æ¯",charIndex:10916},{level:2,title:"5. å¤çº§ç¼å­",slug:"_5-å¤çº§ç¼å­",normalizedTitle:"5. å¤çº§ç¼å­",charIndex:11759},{level:3,title:"5.1. æ´ä½ç¼å­æ¡æ¶",slug:"_5-1-æ´ä½ç¼å­æ¡æ¶",normalizedTitle:"5.1. æ´ä½ç¼å­æ¡æ¶",charIndex:11771},{level:3,title:"5.2. ä½¿ç¨è¿ç¨åç¼å­",slug:"_5-2-ä½¿ç¨è¿ç¨åç¼å­",normalizedTitle:"5.2. ä½¿ç¨è¿ç¨åç¼å­",charIndex:12077},{level:3,title:"5.3. ä½¿ç¨åå¸å¼ç¼å­",slug:"_5-3-ä½¿ç¨åå¸å¼ç¼å­",normalizedTitle:"5.3. ä½¿ç¨åå¸å¼ç¼å­",charIndex:12350},{level:3,title:"5.4. ä½¿ç¨å¤çº§ç¼å­",slug:"_5-4-ä½¿ç¨å¤çº§ç¼å­",normalizedTitle:"5.4. ä½¿ç¨å¤çº§ç¼å­",charIndex:12565},{level:4,title:"5.4.1. å¤çº§ç¼å­æ¥è¯¢",slug:"_5-4-1-å¤çº§ç¼å­æ¥è¯¢",normalizedTitle:"5.4.1. å¤çº§ç¼å­æ¥è¯¢",charIndex:12922},{level:4,title:"5.4.2. å¤çº§ç¼å­æ´æ°",slug:"_5-4-2-å¤çº§ç¼å­æ´æ°",normalizedTitle:"5.4.2. å¤çº§ç¼å­æ´æ°",charIndex:13089},{level:2,title:"6. ç¼å­é®é¢",slug:"_6-ç¼å­é®é¢",normalizedTitle:"6. ç¼å­é®é¢",charIndex:13397},{level:3,title:"6.1. ç¼å­éªå´©",slug:"_6-1-ç¼å­éªå´©",normalizedTitle:"6.1. ç¼å­éªå´©",charIndex:13409},{level:3,title:"6.2. ç¼å­ç©¿é",slug:"_6-2-ç¼å­ç©¿é",normalizedTitle:"6.2. ç¼å­ç©¿é",charIndex:14149},{level:3,title:"6.3. ç¼å­å»ç©¿",slug:"_6-3-ç¼å­å»ç©¿",normalizedTitle:"6.3. ç¼å­å»ç©¿",charIndex:14708},{level:3,title:"6.4. å°ç»",slug:"_6-4-å°ç»",normalizedTitle:"6.4. å°ç»",charIndex:14964},{level:2,title:"7. ç¼å­ç­ç¥",slug:"_7-ç¼å­ç­ç¥",normalizedTitle:"7. ç¼å­ç­ç¥",charIndex:15320},{level:3,title:"7.1. ç¼å­é¢ç­",slug:"_7-1-ç¼å­é¢ç­",normalizedTitle:"7.1. ç¼å­é¢ç­",charIndex:15332},{level:3,title:"7.2. å¦ä½ç¼å­",slug:"_7-2-å¦ä½ç¼å­",normalizedTitle:"7.2. å¦ä½ç¼å­",charIndex:15493},{level:4,title:"7.2.1. ä¸è¿æç¼å­",slug:"_7-2-1-ä¸è¿æç¼å­",normalizedTitle:"7.2.1. ä¸è¿æç¼å­",charIndex:15506},{level:4,title:"7.2.2. è¿æç¼å­",slug:"_7-2-2-è¿æç¼å­",normalizedTitle:"7.2.2. è¿æç¼å­",charIndex:15714},{level:3,title:"7.3. ç¼å­æ´æ°",slug:"_7-3-ç¼å­æ´æ°",normalizedTitle:"7.3. ç¼å­æ´æ°",charIndex:15765},{level:4,title:"7.3.1. Cache Aside",slug:"_7-3-1-cache-aside",normalizedTitle:"7.3.1. cache aside",charIndex:16037},{level:5,title:"7.3.1.1. ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åºï¼åæ´æ°ç¼å­ï¼",slug:"_7-3-1-1-ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åº-åæ´æ°ç¼å­",normalizedTitle:"7.3.1.1. ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åºï¼åæ´æ°ç¼å­ï¼",charIndex:16205},{level:5,title:"7.3.1.2. ä¸ºä»ä¹ä¸è½åå ç¼å­ï¼åæ´æ°æ°æ®åºï¼",slug:"_7-3-1-2-ä¸ºä»ä¹ä¸è½åå ç¼å­-åæ´æ°æ°æ®åº",normalizedTitle:"7.3.1.2. ä¸ºä»ä¹ä¸è½åå ç¼å­ï¼åæ´æ°æ°æ®åºï¼",charIndex:16371},{level:5,title:"7.3.1.3. åæ´æ°æ°æ®åºï¼åå é¤ç¼å­å°±æ²¡é®é¢äºå",slug:"_7-3-1-3-åæ´æ°æ°æ®åº-åå é¤ç¼å­å°±æ²¡é®é¢äºå",normalizedTitle:"7.3.1.3. åæ´æ°æ°æ®åºï¼åå é¤ç¼å­å°±æ²¡é®é¢äºå",charIndex:16487},{level:4,title:"7.3.2. Read/Write Through",slug:"_7-3-2-read-write-through",normalizedTitle:"7.3.2. read/write through",charIndex:16747},{level:4,title:"7.3.3. Write behind",slug:"_7-3-3-write-behind",normalizedTitle:"7.3.3. write behind",charIndex:17019},{level:2,title:"8. æ»ç»",slug:"_8-æ»ç»",normalizedTitle:"8. æ»ç»",charIndex:17239},{level:2,title:"9. åèèµæ",slug:"_9-åèèµæ",normalizedTitle:"9. åèèµæ",charIndex:17295}],headersStr:"1. ç¼å­ç®ä» 1.1. ä¸ºä»ä¹éè¦ç¼å­ 1.2. ä»ä¹æ¯ç¼å­ 1.3. ä½æ¶éè¦ç¼å­ 1.4. ç¼å­çåºæ¬åç 1.5. ç¼å­æ·æ±°ç­ç¥ 2. ç¼å­çåç±» 2.1. HTTP ç¼å­ 2.2. CDN ç¼å­ 2.2.1. CDN åç 2.2.2. CDN ç¹ç¹ 2.3. ååä»£çç¼å­ 2.3.1. ååä»£çç¼å­åç 2.3.2. ååä»£çç¼å­æ¯è¾ 3. è¿ç¨åç¼å­ 3.1. ConcurrentHashMap 3.2. LRUHashMap 3.3. Guava Cache 3.4. Caffeine 3.5. Ehcache 3.6. è¿ç¨åç¼å­å¯¹æ¯ 4. åå¸å¼ç¼å­ 4.1. Memcached 4.1.1. Memcached ç¹æ§ 4.1.2. Memcached å·¥ä½åç 4.2. Redis 4.2.1. Redis ç¹æ§ 4.2.2. Redis åç 4.3. åå¸å¼ç¼å­å¯¹æ¯ 5. å¤çº§ç¼å­ 5.1. æ´ä½ç¼å­æ¡æ¶ 5.2. ä½¿ç¨è¿ç¨åç¼å­ 5.3. ä½¿ç¨åå¸å¼ç¼å­ 5.4. ä½¿ç¨å¤çº§ç¼å­ 5.4.1. å¤çº§ç¼å­æ¥è¯¢ 5.4.2. å¤çº§ç¼å­æ´æ° 6. ç¼å­é®é¢ 6.1. ç¼å­éªå´© 6.2. ç¼å­ç©¿é 6.3. ç¼å­å»ç©¿ 6.4. å°ç» 7. ç¼å­ç­ç¥ 7.1. ç¼å­é¢ç­ 7.2. å¦ä½ç¼å­ 7.2.1. ä¸è¿æç¼å­ 7.2.2. è¿æç¼å­ 7.3. ç¼å­æ´æ° 7.3.1. Cache Aside 7.3.1.1. ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åºï¼åæ´æ°ç¼å­ï¼ 7.3.1.2. ä¸ºä»ä¹ä¸è½åå ç¼å­ï¼åæ´æ°æ°æ®åºï¼ 7.3.1.3. åæ´æ°æ°æ®åºï¼åå é¤ç¼å­å°±æ²¡é®é¢äºå 7.3.2. Read/Write Through 7.3.3. Write behind 8. æ»ç» 9. åèèµæ",content:"# ç¼å­åºæ¬åç\n\n> ç¼å­æ¯ä¸ç§å©ç¨ç©ºé´æ¢æ¶é´çè®¾è®¡ï¼å¶ç®æ å°±æ¯æ´å¿«ãæ´è¿ã\n\n\n# 1. ç¼å­ç®ä»\n\n\n# 1.1. ä¸ºä»ä¹éè¦ç¼å­\n\nä¼æå¨ç¥ï¼å½ä»æ¯ä¸ä¸ªäºèç½æ¶ä»£ï¼èäºèç½åºç¨å ä¹éåæä»¬æ¥å¸¸çæ´»çæ¹æ¹é¢é¢ãä¸è¬èè¨ï¼ä¸ä¸ªäºèç½åºç¨çè¯·æ±/ååºæµç¨ä¼æä»¥ä¸å ä¸ªä¸»è¦æµç¨ï¼\n\n * å®¢æ·ç«¯åèµ·è¯·æ±ï¼è¯·æ±ç»è¿ç½ç» I/Oï¼ååå°æå¡å±ã\n * æå¡å±å¯è½æå¤çº§æå¡ï¼è¯·æ±éè¦è¢«å¤ä¸ªæå¡å±å±å¤çã\n * ä¸åæå¡æ ¹æ®è¯·æ±è¿è¡è®¡ç®æ¶ï¼å¯è½ä¾èµäºä¸åæ°æ®åºçæ°æ®ï¼éè¦éè¿ç½ç» I/O è¯»åæ°æ®åºã\n\næ¾ç¶ï¼è¿ä¸å¥æµç¨ä¸æ¥ï¼å¯è½éè¦æ¶èå¤§éçè®¡ç®æºèµæºï¼å¹¶ä¸ååºæ¶é´ä¹å¯è½å¾ä¹ãå¦æå¹¶åè¯·æ±éå¾å¤§çè¯ï¼å¯è½ä¼è¿ä¸æ­¥å å§è¿ç§é®é¢ã\n\n\n\nä¸ºäºè§£å³ä»¥ä¸é®é¢ï¼æç´æ¥çæ¹å¼å°±æ¯å¼å¥ç¼å­ãç¼å­å¯ä»¥ä½ç¨äºè¯·æ±/ååºæµç¨çä»»æç¯èï¼å¹¶ææåå°åç»­ç¯èçæ§è¡æ¬¡æ°ï¼ä»èå¤§å¤§æåæ§è½ã\n\nå®éä¸ï¼ç¼å­ä½ä¸ºæ§è½ä¼åçç¬¬ä¸ææ®µï¼è¢«å¹¿æ³åºç¨äºè®¡ç®æºçç¡¬ä»¶ãè½¯ä»¶é¢åã\n\n\n# 1.2. ä»ä¹æ¯ç¼å­\n\nç¼å­å°±æ¯æ°æ®äº¤æ¢çç¼å²åºï¼ç¨äºå°é¢ç¹è®¿é®çæ°æ®æå­ãç¼å­çæ¬è´¨æ¯ä¸ä¸ªåå­ Hashã\n\nç¼å­çæ¬è´¨æ¯ä¸ç§å©ç¨ç©ºé´æ¢æ¶é´çè®¾è®¡ï¼çºç²ä¸å®çæ°æ®å®æ¶æ§ï¼ä½¿å¾è®¿é®æ´å¿«ãæ´è¿ï¼\n\n * å°æ°æ®å­å¨å°è¯»åéåº¦æ´å¿«çå­å¨ï¼è®¾å¤ï¼ï¼\n * å°æ°æ®å­å¨å°ç¦»åºç¨æè¿çä½ç½®ï¼\n * å°æ°æ®å­å¨å°ç¦»ç¨æ·æè¿çä½ç½®ã\n\nç¼å­æ¯ç¨äºå­å¨æ°æ®çç¡¬ä»¶æè½¯ä»¶çç»æé¨åï¼ä»¥ä½¿å¾åç»­æ´å¿«è®¿é®ç¸åºçæ°æ®ãç¼å­ä¸­çæ°æ®å¯è½æ¯æåè®¡ç®å¥½çç»æãæ°æ®çå¯æ¬ç­ãå¸åçåºç¨åºæ¯ï¼æ cpu cache, ç£ç cache ç­ãæ¬æä¸­æåå°ç¼å­ä¸»è¦æ¯æäºèç½åºç¨ä¸­æä½¿ç¨çç¼å­ç»ä»¶ã\n\nç¼å­å½ä¸­çæ¯ç¼å­çéè¦åº¦éææ ï¼å½ä¸­çè¶é«è¶å¥½ã\n\nç¼å­å½ä¸­ç = ä»ç¼å­ä¸­è¯»åæ¬¡æ° / æ»è¯»åæ¬¡æ°\n\n\n\n# 1.3. ä½æ¶éè¦ç¼å­\n\nå¼å¥ç¼å­ï¼ä¼å¢å ç³»ç»çå¤æåº¦ï¼å¹¶çºç²ä¸å®çæ°æ®å®æ¶æ§ãæä»¥ï¼å¼å¥ç¼å­åï¼éè¦åæè¡¡æ¯å¦å¼å¾ï¼èéç¹å¦ä¸ï¼\n\n * CPU å¼é - å¦æåºç¨æä¸ªè®¡ç®éè¦æ¶èå¤§é CPUï¼å¯ä»¥èèç¼å­å¶è®¡ç®ç»æãå¸ååºæ¯ï¼å¤æçãé¢ç¹è°ç¨çæ­£åè®¡ç®ï¼åå¸å¼è®¡ç®ä¸­é´ç¶æç­ã\n * IO å¼é - å¦ææ°æ®åºè¿æ¥æ± æ¯è¾ç¹å¿ï¼å¯ä»¥èèç¼å­å¶æ¥è¯¢ç»æã\n\nå¨æ°æ®å±å¼å¥ç¼å­ï¼æä»¥ä¸å ä¸ªå¥½å¤ï¼\n\n * æåæ°æ®è¯»åéåº¦ã\n * æåç³»ç»æ©å±è½åï¼éè¿æ©å±ç¼å­ï¼æåç³»ç»æ¿è½½è½åã\n * éä½å­å¨ææ¬ï¼Cache+DB çæ¹å¼å¯ä»¥æ¿æåæéè¦å¤å° DB æè½æ¿æçè¯·æ±éï¼èçæºå¨ææ¬ã\n\n\n# 1.4. ç¼å­çåºæ¬åç\n\næ ¹æ®ä¸å¡åºæ¯ï¼éå¸¸ç¼å­æä»¥ä¸å ç§ä½¿ç¨æ¹å¼ï¼\n\n * ææ±å¼(è¯»æ¶è§¦å)ï¼åæ¥è¯¢ DB éçæ°æ®, ç¶åæç¸å³çæ°æ®åå¥ Cacheã\n * é¥¥é¥¿å¼(åæ¶è§¦å)ï¼åå¥ DB å, ç¶åæç¸å³çæ°æ®ä¹åå¥ Cacheã\n * å®æå·æ°ï¼éåå¨ææ§çè·æ°æ®çä»»å¡ï¼æèåè¡¨åçæ°æ®ï¼èä¸ä¸è¦æ±ç»å¯¹å®æ¶æ§ã\n\n\n# 1.5. ç¼å­æ·æ±°ç­ç¥\n\nç¼å­æ·æ±°çç±»åï¼\n\n * åºäºç©ºé´ - è®¾ç½®ç¼å­ç©ºé´å¤§å°ã\n * åºäºå®¹é - è®¾ç½®ç¼å­å­å¨è®°å½æ°ã\n * åºäºæ¶é´\n   * TTLï¼Time To Liveï¼å³å­æ´»æï¼ç¼å­æ°æ®ä»åå»ºå°è¿æçæ¶é´ã\n   * TTIï¼Time To Idleï¼å³ç©ºé²æï¼ç¼å­æ°æ®å¤ä¹æ²¡è¢«è®¿é®çæ¶é´ã\n\nç¼å­æ·æ±°ç®æ³ï¼\n\n * FIFO (first in first out) - åè¿ååºãå¨è¿ç§æ·æ±°ç®æ³ä¸­ï¼åè¿å¥ç¼å­çä¼åè¢«æ·æ±°ãè¿ç§å¯è°æ¯æç®åçäºï¼ä½æ¯ä¼å¯¼è´æä»¬å½ä¸­çå¾ä½ãè¯æ³ä¸ä¸æä»¬å¦ææä¸ªè®¿é®é¢çå¾é«çæ°æ®æ¯æææ°æ®ç¬¬ä¸ä¸ªè®¿é®çï¼èé£äºä¸æ¯å¾é«çæ¯åé¢åè®¿é®çï¼é£è¿æ ·å°±ä¼ææä»¬çé¦ä¸ªæ°æ®ä½æ¯ä»çè®¿é®é¢çå¾é«ç»æ¤åºã\n * LRU (least recently used) - æè¿æå°ä½¿ç¨ç®æ³ãè¿ç§ç®æ³é¿åäº FIFO å½ä¸­çä¸é«çé®é¢ï¼æ¯æ¬¡è®¿é®æ°æ®é½ä¼å°å¶æ¾å¨æä»¬çéå°¾ï¼å¦æéè¦æ·æ±°æ°æ®ï¼å°±åªéè¦æ·æ±°éé¦å³å¯ãä½æ¯è¿ä¸ªç®æ³ä¾ç¶æç¼ºç¹ï¼åè®¾ï¼ç¼å­åªä¿ç 1 åéä»¥åçç­ç¹æ°æ®ãå¦ææä¸ªæ°æ®å¨ 1 ä¸ªå°æ¶çå 59 åéè®¿é®äº 1 ä¸æ¬¡ï¼å¯è§è¿æ¯ä¸ªç­ç¹æ°æ®ï¼ï¼æåä¸åéæ²¡æä»»ä½è®¿é®ï¼ä½æ¯ï¼å¶ä»çæ°æ®æè¢«è®¿é®ï¼å°±ä¼å¯¼è´è¿ä¸ªç­ç¹æ°æ®è¢«æ·æ±°ã\n * LFU (less frequently used) - æè¿æå°é¢çä½¿ç¨ãå¨è¿ç§ç®æ³ä¸­åå¯¹ä¸é¢è¿è¡äºä¼åï¼å©ç¨é¢å¤çç©ºé´è®°å½æ¯ä¸ªæ°æ®çä½¿ç¨é¢çï¼ç¶åéåºé¢çæä½è¿è¡æ·æ±°ãè¿æ ·å°±é¿åäº LRU ä¸è½å¤çæ¶é´æ®µçé®é¢ã\n\nè¿ä¸ç§ç¼å­æ·æ±°ç®æ³ï¼å®ç°å¤æåº¦ä¸ä¸ªæ¯ä¸ä¸ªé«ï¼åæ ·çå½ä¸­çä¹æ¯ä¸ä¸ªæ¯ä¸ä¸ªå¥½ãèæä»¬ä¸è¬æ¥è¯´éæ©çæ¹æ¡å±ä¸­å³å¯ï¼å³å®ç°ææ¬ä¸æ¯å¤ªé«ï¼èå½ä¸­çä¹è¿è¡ç LRUã\n\n\n# 2. ç¼å­çåç±»\n\nç¼å­ä»é¨ç½²è§åº¦ï¼å¯ä»¥åä¸ºå®¢æ·ç«¯ç¼å­åæå¡ç«¯ç¼å­ã\n\nå®¢æ·ç«¯ç¼å­\n\n * Http ç¼å­ï¼HTTP/1.1 ä¸­ç Cache-ControlãHTTP/1 ä¸­ç Expires\n * æµè§å¨ç¼å­ï¼HTML5 æä¾ç SessionStorage å LocalStorageãCookie\n * APP ç¼å­\n   * Android\n   * IOS\n\næå¡ç«¯ç¼å­\n\n * CDN ç¼å­ - å­æ¾ HTMLãCSSãJS ç­éæèµæºã\n * ååä»£çç¼å­ - å¨éåç¦»ï¼åªç¼å­ç¨æ·è¯·æ±çéæèµæºã\n * æ°æ®åºç¼å­ - æ°æ®åºï¼å¦ Mysqlï¼èªèº«ä¸è¬ä¹æç¼å­ï¼ä½å ä¸ºå½ä¸­çåæ´æ°é¢çé®é¢ï¼ä¸æ¨èä½¿ç¨ã\n * è¿ç¨åç¼å­ - ç¼å­åºç¨å­å¸ç­å¸¸ç¨æ°æ®ã\n * åå¸å¼ç¼å­ - ç¼å­æ°æ®åºä¸­çç­ç¹æ°æ®ã\n\n> å¶ä¸­ï¼CDN ç¼å­ãååä»£çç¼å­ãæ°æ®åºç¼å­ä¸è¬ç±ä¸èäººåç»´æ¤ï¼è¿ç»´ãDBAï¼ã\n> \n> åç«¯å¼åä¸è¬èç¦äºè¿ç¨åç¼å­ãåå¸å¼ç¼å­ã\n\n\n# 2.1. HTTP ç¼å­\n\n 1. æµè§å¨åéè¯·æ±åï¼æ ¹æ®è¯·æ±å¤´ç expires (HTTP/1) å cache-control (HTTP/1.1) å¤æ­æ¯å¦å½ä¸­ï¼åæ¬æ¯å¦è¿æï¼å¼ºç¼å­ç­ç¥ï¼\n    \n    1. å¦æå½ä¸­ï¼ç´æ¥ä»ç¼å­è·åèµæºï¼å¹¶ä¸ä¼åéè¯·æ±ã\n    2. å¦ææ²¡æå½ä¸­ï¼åè¿å¥ä¸ä¸æ­¥ã\n\n 2. æ²¡æå½ä¸­å¼ºç¼å­è§åï¼æµè§å¨ä¼åéè¯·æ±ï¼æ ¹æ®è¯·æ±å¤´ç last-modified å etag å¤æ­æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­ï¼ç´æ¥ä»ç¼å­è·åèµæºãå¦ææ²¡æå½ä¸­ï¼åè¿å¥ä¸ä¸æ­¥ã\n\n 3. å¦æåä¸¤æ­¥é½æ²¡æå½ä¸­ï¼åç´æ¥ä»æå¡ç«¯è·åèµæºã\n\n\n# 2.2. CDN ç¼å­\n\n> CDN å°æ°æ®ç¼å­å°ç¦»ç¨æ·ç©çè·ç¦»æè¿çæå¡å¨ï¼ä½¿å¾ç¨æ·å¯ä»¥å°±è¿è·åè¯·æ±åå®¹ãCDN ä¸è¬ç¼å­éæèµæºæä»¶ï¼é¡µé¢ï¼èæ¬ï¼å¾çï¼è§é¢ï¼æä»¶ç­ï¼ã\n> \n> å½åç½ç»å¼å¸¸å¤æï¼è·¨è¿è¥åçç½ç»è®¿é®ä¼å¾æ¢ãä¸ºäºè§£å³è·¨è¿è¥åæåå°ç¨æ·è®¿é®é®é¢ï¼å¯ä»¥å¨éè¦çåå¸ï¼é¨ç½² CDN åºç¨ãä½¿ç¨æ·å°±è¿è·åæéåå®¹ï¼éä½ç½ç»æ¥å¡ï¼æé«ç¨æ·è®¿é®ååºéåº¦åå½ä¸­çã\n\n\n\n# 2.2.1. CDN åç\n\nCDN çåºæ¬åçæ¯å¹¿æ³éç¨åç§ç¼å­æå¡å¨ï¼å°è¿äºç¼å­æå¡å¨åå¸å°ç¨æ·è®¿é®ç¸å¯¹éä¸­çå°åºæç½ç»ä¸­ï¼å¨ç¨æ·è®¿é®ç½ç«æ¶ï¼å©ç¨å¨å±è´è½½ææ¯å°ç¨æ·çè®¿é®æåè·ç¦»æè¿çå·¥ä½æ­£å¸¸çç¼å­æå¡å¨ä¸ï¼ç±ç¼å­æå¡å¨ç´æ¥ååºç¨æ·è¯·æ±ã\n\nï¼1ï¼æªé¨ç½² CDN åºç¨åçç½ç»è·¯å¾ï¼\n\n * è¯·æ±ï¼æ¬æºç½ç»ï¼å±åç½ï¼=> è¿è¥åç½ç» => åºç¨æå¡å¨æºæ¿\n * ååºï¼åºç¨æå¡å¨æºæ¿ => è¿è¥åç½ç» => æ¬æºç½ç»ï¼å±åç½ï¼\n\nå¨ä¸èèå¤æç½ç»çæåµä¸ï¼ä»è¯·æ±å°ååºéè¦ç»è¿ 3 ä¸ªèç¹ï¼6 ä¸ªæ­¥éª¤å®æä¸æ¬¡ç¨æ·è®¿é®æä½ã\n\nï¼2ï¼é¨ç½² CDN åºç¨åç½ç»è·¯å¾ï¼\n\n * è¯·æ±ï¼æ¬æºç½ç»ï¼å±åç½ï¼ => è¿è¥åç½ç»\n * ååºï¼è¿è¥åç½ç» => æ¬æºç½ç»ï¼å±åç½ï¼\n\nå¨ä¸èèå¤æç½ç»çæåµä¸ï¼ä»è¯·æ±å°ååºéè¦ç»è¿ 2 ä¸ªèç¹ï¼2 ä¸ªæ­¥éª¤å®æä¸æ¬¡ç¨æ·è®¿é®æä½ã\n\nä¸ä¸é¨ç½² CDN æå¡ç¸æ¯ï¼åå°äº 1 ä¸ªèç¹ï¼4 ä¸ªæ­¥éª¤çè®¿é®ãæå¤§çæé«äºç³»ç»çååºéåº¦ã\n\n# 2.2.2. CDN ç¹ç¹\n\nä¼ç¹\n\n * æ¬å° Cache å é - æåè®¿é®éåº¦ï¼å°¤å¶å«æå¤§éå¾çåéæé¡µé¢ç«ç¹ï¼\n * å®ç°è·¨è¿è¥åçç½ç»å é - æ¶é¤äºä¸åè¿è¥åä¹é´äºèçç¶é¢é æçå½±åï¼å®ç°äºè·¨è¿è¥åçç½ç»å éï¼ä¿è¯ä¸åç½ç»ä¸­çç¨æ·é½è½å¾å°è¯å¥½çè®¿é®è´¨éï¼\n * è¿ç¨å é - è¿ç¨è®¿é®ç¨æ·æ ¹æ® DNS è´è½½åè¡¡ææ¯æºè½èªå¨éæ© Cache æå¡å¨ï¼éæ©æå¿«ç Cache æå¡å¨ï¼å å¿«è¿ç¨è®¿é®çéåº¦ï¼\n * å¸¦å®½ä¼å - èªå¨çææå¡å¨çè¿ç¨ Mirrorï¼éåï¼cache æå¡å¨ï¼è¿ç¨ç¨æ·è®¿é®æ¶ä» cache æå¡å¨ä¸è¯»åæ°æ®ï¼åå°è¿ç¨è®¿é®çå¸¦å®½ãåæç½ç»æµéãåè½»åç«ç¹ WEB æå¡å¨è´è½½ç­åè½ã\n * éç¾¤ææ»å» - å¹¿æ³åå¸ç CDN èç¹å ä¸èç¹ä¹é´çæºè½åä½æºå¶ï¼å¯ä»¥ææå°é¢é²é»å®¢å¥ä¾µä»¥åéä½åç§ D.D.o.S æ»å»å¯¹ç½ç«çå½±åï¼åæ¶ä¿è¯è¾å¥½çæå¡è´¨éã\n\nç¼ºç¹\n\n * ä¸éå®ç¼å­å¨æèµæº\n   * è§£å³æ¹æ¡ï¼ä¸»è¦ç¼å­éæèµæºï¼å¨æèµæºå»ºç«å¤çº§ç¼å­æåå®æ¶åæ­¥ï¼\n * å­å¨æ°æ®çä¸è´æ§é®é¢\n   * è§£å³æ¹æ¡ï¼ä¸»è¦æ¯å¨æ§è½åæ°æ®ä¸è´æ§äºèé´å¯»æ¾ä¸ä¸ªå¹³è¡¡ï¼\n   * è®¾ç½®ç¼å­å¤±ææ¶é´ï¼1 ä¸ªå°æ¶ï¼è¿æååæ­¥æ°æ®ï¼ã\n   * éå¯¹èµæºè®¾ç½®çæ¬å·ã\n\n\n# 2.3. ååä»£çç¼å­\n\n> ååä»£çï¼Reverse Proxyï¼æ¹å¼æ¯æä»¥ä»£çæå¡å¨æ¥æ¥å internet ä¸çè¿æ¥è¯·æ±ï¼ç¶åå°è¯·æ±è½¬åç»åé¨ç½ç»ä¸çæå¡å¨ï¼å¹¶å°ä»æå¡å¨ä¸å¾å°çç»æè¿åç» internet ä¸è¯·æ±è¿æ¥çå®¢æ·ç«¯ï¼æ­¤æ¶ä»£çæå¡å¨å¯¹å¤å°±è¡¨ç°ä¸ºä¸ä¸ªååä»£çæå¡å¨ã\n\n\n\n# 2.3.1. ååä»£çç¼å­åç\n\nååä»£çä½äºåºç¨æå¡å¨åä¸ç½ç»ï¼å¤çææå¯¹ WEB æå¡å¨çè¯·æ±ã\n\nååä»£çç¼å­çåçï¼\n\n * å¦æç¨æ·è¯·æ±çé¡µé¢å¨ä»£çæå¡å¨ä¸æç¼å­çè¯ï¼ä»£çæå¡å¨ç´æ¥å°ç¼å­åå®¹åéç»ç¨æ·ã\n * å¦ææ²¡æç¼å­ååå WEB æå¡å¨ååºè¯·æ±ï¼ååæ°æ®ï¼æ¬å°ç¼å­åååéç»ç¨æ·ã\n\nè¿ç§æ¹å¼éè¿éä½å WEB æå¡å¨çè¯·æ±æ°ï¼ä»èéä½äº WEB æå¡å¨çè´è½½ã\n\nååä»£çç¼å­ä¸è¬éå¯¹çæ¯éæèµæºï¼èå°å¨æèµæºè¯·æ±è½¬åå°åºç¨æå¡å¨å¤çãå¸¸ç¨çç¼å­åºç¨æå¡å¨æ Varnishï¼Ngnixï¼Squidã\n\n# 2.3.2. ååä»£çç¼å­æ¯è¾\n\nå¸¸ç¨çä»£çç¼å­æ Varnishï¼Squidï¼Ngnixï¼ç®åæ¯è¾å¦ä¸ï¼\n\n * Varnish å Squid æ¯ä¸ä¸ç cache æå¡ï¼Ngnix éè¦ç¬¬ä¸æ¹æ¨¡åæ¯æï¼\n * Varnish éç¨åå­åç¼å­ï¼é¿åäºé¢ç¹å¨åå­ãç£çä¸­äº¤æ¢æä»¶ï¼æ§è½æ¯ Squid é«ï¼\n * Varnish ç±äºæ¯åå­ cacheï¼æä»¥å¯¹å°æä»¶å¦ cssãjsãå°å¾ççæ¯æå¾æ£ï¼åç«¯çæä¹åç¼å­å¯ä»¥éç¨çæ¯ Squid æ ATSï¼\n * Squid åè½å¨èå¤§ï¼éåäºåç§éæçæä»¶ç¼å­ï¼ä¸è¬ä¼å¨åç«¯æä¸ä¸ª HAProxy æ Ngnix åè´è½½åè¡¡è·å¤ä¸ªå®ä¾ï¼\n * Nginx éç¨ç¬¬ä¸æ¹æ¨¡å ncache åçç¼å²ï¼æ§è½åºæ¬è¾¾å° Varnishï¼ä¸è¬ä½ä¸ºååä»£çä½¿ç¨ï¼å¯ä»¥å®ç°ç®åçç¼å­ã\n\n\n# 3. è¿ç¨åç¼å­\n\n> è¿ç¨åç¼å­æ¯æåºç¨åé¨çç¼å­ï¼æ åçåå¸å¼ç³»ç»ï¼ä¸è¬æå¤çº§ç¼å­ææãæ¬å°ç¼å­æ¯ç¦»åºç¨æè¿çç¼å­ï¼ä¸è¬å¯ä»¥å°æ°æ®ç¼å­å°ç¡¬çæåå­ã\n\n * ç¡¬çç¼å­ - å°æ°æ®ç¼å­å°ç¡¬çä¸­ï¼è¯»åæ¶ä»ç¡¬çè¯»åãåçæ¯ç´æ¥è¯»åæ¬æºæä»¶ï¼åå°äºç½ç»ä¼ è¾æ¶èï¼æ¯éè¿ç½ç»è¯»åæ°æ®åºéåº¦æ´å¿«ãå¯ä»¥åºç¨å¨å¯¹éåº¦è¦æ±ä¸æ¯å¾é«ï¼ä½éè¦å¤§éç¼å­å­å¨çåºæ¯ã\n * åå­ç¼å­ - ç´æ¥å°æ°æ®å­å¨å°æ¬æºåå­ä¸­ï¼éè¿ç¨åºç´æ¥ç»´æ¤ç¼å­å¯¹è±¡ï¼æ¯è®¿é®éåº¦æå¿«çæ¹å¼ã\n\nå¸¸è§çæ¬å°ç¼å­å®ç°æ¹æ¡ï¼HashMapãGuava CacheãCaffeineãEhcacheã\n\n\n# 3.1. ConcurrentHashMap\n\næç®åçè¿ç¨åç¼å­å¯ä»¥éè¿ JDK èªå¸¦ç HashMap æ ConcurrentHashMap å®ç°ã\n\néç¨åºæ¯ï¼ä¸éè¦æ·æ±°çç¼å­æ°æ®ã\n\nç¼ºç¹ï¼æ æ³è¿è¡ç¼å­æ·æ±°ï¼åå­ä¼æ éå¶çå¢é¿ã\n\n\n# 3.2. LRUHashMap\n\nå¯ä»¥éè¿ç»§æ¿ LinkedHashMap æ¥å®ç°ä¸ä¸ªç®åç LRUHashMapãéå removeEldestEntry æ¹æ³ï¼å³å¯å®æä¸ä¸ªç®åçæè¿æå°ä½¿ç¨ç®æ³ã\n\nç¼ºç¹ï¼\n\n * éç«äºä¸¥éï¼æ§è½æ¯è¾ä½ã\n * ä¸æ¯æè¿ææ¶é´\n * ä¸æ¯æèªå¨å·æ°\n\n\n# 3.3. Guava Cache\n\nè§£å³äº LRUHashMap ä¸­çå ä¸ªç¼ºç¹ã\n\nGuava Cache éç¨äºç±»ä¼¼ ConcurrentHashMap çææ³ï¼åæ®µå éï¼åå°éç«äºã\n\nGuava Cache å¯¹äºè¿æç Entry å¹¶æ²¡æé©¬ä¸è¿æ(ä¹å°±æ¯å¹¶æ²¡æåå°çº¿ç¨ä¸ç´å¨æ«)ï¼èæ¯éè¿è¿è¡è¯»åæä½çæ¶åè¿è¡è¿æå¤çï¼è¿æ ·åçå¥½å¤æ¯é¿ååå°çº¿ç¨æ«æçæ¶åè¿è¡å¨å±å éã\n\nç´æ¥éè¿æ¥è¯¢ï¼å¤æ­å¶æ¯å¦æ»¡è¶³å·æ°æ¡ä»¶ï¼è¿è¡å·æ°ã\n\n\n# 3.4. Caffeine\n\nCaffeine å®ç°äº W-TinyLFU(LFU + LRU ç®æ³çåç§)ï¼å¶å½ä¸­çåè¯»åååéå¤§å¤§ä¼äº Guava Cacheã\n\nå¶å®ç°åçè¾å¤æï¼å¯ä»¥åèä½ åºè¯¥ç¥éçç¼å­è¿åå²ã\n\n\n# 3.5. Ehcache\n\nEhCache æ¯ä¸ä¸ªçº¯ Java çè¿ç¨åç¼å­æ¡æ¶ï¼å·æå¿«éãç²¾å¹²ç­ç¹ç¹ï¼æ¯ Hibernate ä¸­é»è®¤ç CacheProviderã\n\nä¼ç¹\n\n * å¿«éãç®å\n * æ¯æå¤ç§ç¼å­ç­ç¥ï¼LRUãLFUãFIFO æ·æ±°ç®æ³\n * ç¼å­æ°æ®æä¸¤çº§ï¼åå­åç£çï¼å æ­¤æ éæå¿å®¹éé®é¢\n * ç¼å­æ°æ®ä¼å¨èææºéå¯çè¿ç¨ä¸­åå¥ç£ç\n * å¯ä»¥éè¿ RMIãå¯æå¥ API ç­æ¹å¼è¿è¡åå¸å¼ç¼å­\n * å·æç¼å­åç¼å­ç®¡çå¨çä¾¦å¬æ¥å£\n * æ¯æå¤ç¼å­ç®¡çå¨å®ä¾ï¼ä»¥åä¸ä¸ªå®ä¾çå¤ä¸ªç¼å­åºå\n * æä¾ Hibernate çç¼å­å®ç°\n\nç¼ºç¹\n\n * ä½¿ç¨ç£ç Cache çæ¶åéå¸¸å ç¨ç£çç©ºé´\n * ä¸ä¿è¯æ°æ®çå®å¨\n * è½ç¶æ¯æåå¸å¼ç¼å­ï¼ä½æçä¸é«ï¼éè¿ç»æ­æ¹å¼ï¼å¨ä¸åèç¹ä¹é´åæ­¥æ°æ®ï¼ã\n\n\n# 3.6. è¿ç¨åç¼å­å¯¹æ¯\n\nå¸¸ç¨è¿ç¨åç¼å­ææ¯å¯¹æ¯ï¼\n\næ¯è¾é¡¹      CONCURRENTHASHMAP   LRUMAP                EHCACHE                 GUAVA CACHE             CAFFEINE\nè¯»åæ§è½     å¾å¥½ï¼åæ®µé              ä¸è¬ï¼å¨å±å é               å¥½                       å¥½ï¼éè¦åæ·æ±°æä½               å¾å¥½\næ·æ±°ç®æ³     æ                    LRUï¼ä¸è¬                æ¯æå¤ç§æ·æ±°ç®æ³,LRU,LFU,FIFO   LRUï¼ä¸è¬                  W-TinyLFU, å¾å¥½\nåè½ä¸°å¯ç¨åº¦   åè½æ¯è¾ç®å              åè½æ¯è¾åä¸                åè½å¾ä¸°å¯                   åè½å¾ä¸°å¯ï¼æ¯æå·æ°åèå¼ç¨ç­         åè½å Guava Cache ç±»ä¼¼\nå·¥å·å¤§å°     jdk èªå¸¦ç±»ï¼å¾å°          åºäº LinkedHashMapï¼è¾å°   å¾å¤§ï¼ææ°çæ¬ 1.4MB           æ¯ Guava å·¥å·ç±»ä¸­çä¸ä¸ªå°é¨åï¼è¾å°   ä¸è¬ï¼ææ°çæ¬ 644KB\næ¯å¦æä¹å    å¦                   å¦                     æ¯                       å¦                       å¦\næ¯å¦æ¯æéç¾¤   å¦                   å¦                     æ¯                       å¦                       å¦\n\n * ConcurrentHashMap - æ¯è¾éåç¼å­æ¯è¾åºå®ä¸åçåç´ ï¼ä¸ç¼å­çæ°éè¾å°çãè½ç¶ä»ä¸é¢è¡¨æ ¼ä¸­æ¯èµ·æ¥æç¹éè²ï¼ä½æ¯å¶ç±äºæ¯ JDK èªå¸¦çç±»ï¼å¨åç§æ¡æ¶ä¸­ä¾ç¶æå¤§éçä½¿ç¨ï¼æ¯å¦æä»¬å¯ä»¥ç¨æ¥ç¼å­æä»¬åå°ç Methodï¼Field ç­ç­ï¼ä¹å¯ä»¥ç¼å­ä¸äºé¾æ¥ï¼é²æ­¢å¶éå¤å»ºç«ãå¨ Caffeine ä¸­ä¹æ¯ä½¿ç¨ç ConcurrentHashMap æ¥å­å¨åç´ ã\n * LRUMap - å¦æä¸æ³å¼å¥ç¬¬ä¸æ¹åï¼åæ³ä½¿ç¨æ·æ±°ç®æ³æ·æ±°æ°æ®ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªã\n * Ehcache - ç±äºå¶ jar åå¾å¤§ï¼è¾ééçº§ãå¯¹äºéè¦æä¹ååéç¾¤çä¸äºåè½çï¼å¯ä»¥éæ© Ehcacheãéè¦æ³¨æçæ¯ï¼è½ç¶ Ehcache ä¹æ¯æåå¸å¼ç¼å­ï¼ä½æ¯ç±äºå¶èç¹é´éä¿¡æ¹å¼ä¸º rmiï¼è¡¨ç°ä¸å¦ Redisï¼æä»¥ä¸è¬ä¸å»ºè®®ç¨å®æ¥ä½ä¸ºåå¸å¼ç¼å­ã\n * Guava Cache - Guava è¿ä¸ª jar åå¨å¾å¤ Java åºç¨ç¨åºä¸­é½æå¤§éçå¼å¥ï¼æä»¥å¾å¤æ¶åå¶å®æ¯ç´æ¥ç¨å°±å¥½äºï¼å¹¶ä¸å¶æ¬èº«æ¯è½»éçº§çèä¸åè½è¾ä¸ºä¸°å¯ï¼å¨ä¸äºè§£ Caffeine çæåµä¸å¯ä»¥éæ© Guava Cacheã\n * Caffeine - å¶å¨å½ä¸­çï¼è¯»åæ§è½ä¸é½æ¯ Guava Cache å¥½å¾å¤ï¼å¹¶ä¸å¶ API å Guava cache åºæ¬ä¸è´ï¼çè³ä¼å¤ä¸ç¹ãå¨çå®ç¯å¢ä¸­ä½¿ç¨ Caffeineï¼åå¾è¿ä¸éçææã\n\næ»ç»ä¸ä¸ï¼å¦æä¸éè¦æ·æ±°ç®æ³åéæ© ConcurrentHashMapï¼å¦æéè¦æ·æ±°ç®æ³åä¸äºä¸°å¯ç APIï¼æ¨èéæ© Caffeineã\n\n\n# 4. åå¸å¼ç¼å­\n\n> åå¸å¼ç¼å­è§£å³äºè¿ç¨åç¼å­æå¤§çé®é¢ï¼å¦æåºç¨æ¯åå¸å¼ç³»ç»ï¼èç¹ä¹é´æ æ³å±äº«å½¼æ­¤çè¿ç¨åç¼å­ã\n> \n> åå¸å¼ç¼å­çåºç¨åºæ¯ï¼\n> \n>  * ç¼å­ç»è¿å¤æè®¡ç®å¾å°çæ°æ®\n>  * ç¼å­ç³»ç»ä¸­é¢ç¹è®¿é®çç­ç¹æ°æ®ï¼åè½»æ°æ®åºåå\n\nä¸ååå¸å¼ç¼å­çå®ç°åçå¾å¾ææ¯è¾å¤§çå·®å¼ãæ¬æä¸»è¦éå¯¹ Memcached å Redis è¿è¡è¯´æã\n\n\n# 4.1. Memcached\n\n> Memcached æ¯ä¸ä¸ªé«æ§è½ï¼åå¸å¼åå­å¯¹è±¡ç¼å­ç³»ç»ï¼éè¿å¨åå­éç»´æ¤ä¸ä¸ªç»ä¸çå·¨å¤§ç hash è¡¨ï¼å®è½å¤ç¨æ¥å­å¨åç§æ ¼å¼çæ°æ®ï¼åæ¬å¾åãè§é¢ãæä»¶ä»¥åæ°æ®åºæ£ç´¢çç»æç­ã\n> \n> ç®åçè¯´å°±æ¯ï¼å°æ°æ®ç¼å­å°åå­ä¸­ï¼ç¶åä»åå­ä¸­è¯»åï¼ä»èå¤§å¤§æé«è¯»åéåº¦ã\n\n# 4.1.1. Memcached ç¹æ§\n\n * ä½¿ç¨ç©çåå­ä½ä¸ºç¼å­åºï¼å¯ç¬ç«è¿è¡å¨æå¡å¨ä¸ãæ¯ä¸ªè¿ç¨æå¤§ 2Gï¼å¦ææ³ç¼å­æ´å¤çæ°æ®ï¼å¯ä»¥å¼è¾æ´å¤ç Memcached è¿ç¨ï¼ä¸åç«¯å£ï¼æèä½¿ç¨åå¸å¼ Memcached è¿è¡ç¼å­ï¼å°æ°æ®ç¼å­å°ä¸åçç©çæºæèèææºä¸ã\n * ä½¿ç¨ key-value çæ¹å¼æ¥å­å¨æ°æ®ãè¿æ¯ä¸ç§åç´¢å¼çç»æåæ°æ®ç»ç»å½¢å¼ï¼å¯ä½¿æ°æ®é¡¹æ¥è¯¢æ¶é´å¤æåº¦ä¸º O(1)ã\n * åè®®ç®åï¼åºäºææ¬è¡çåè®®ãç´æ¥éè¿ telnet å¨ Memcached æå¡å¨ä¸å¯è¿è¡å­åæ°æ®æä½ï¼ç®åï¼æ¹ä¾¿å¤ç§ç¼å­åèæ­¤åè®®ï¼\n * åºäº libevent é«æ§è½éä¿¡ãLibevent æ¯ä¸å¥å©ç¨ C å¼åçç¨åºåºï¼å®å° BSD ç³»ç»ç kqueue,Linux ç³»ç»ç epoll ç­äºä»¶å¤çåè½å°è£æä¸ä¸ªæ¥å£ï¼ä¸ä¼ ç»ç select ç¸æ¯ï¼æé«äºæ§è½ã\n * åå¸å¼è½ååå³äº Memcached å®¢æ·ç«¯ï¼æå¡å¨ä¹é´äºä¸éä¿¡ãåä¸ª Memcached æå¡å¨ä¹é´äºä¸éä¿¡ï¼åèªç¬ç«å­åæ°æ®ï¼ä¸å±äº«ä»»ä½ä¿¡æ¯ãæå¡å¨å¹¶ä¸å·æåå¸å¼åè½ï¼åå¸å¼é¨ç½²åå³äº Memcached å®¢æ·ç«¯ã\n * éç¨ LRU ç¼å­æ·æ±°ç­ç¥ãå¨ Memcached åå­å¨æ°æ®é¡¹æ¶ï¼å¯ä»¥æå®å®å¨ç¼å­çå¤±ææ¶é´ï¼é»è®¤ä¸ºæ°¸ä¹ãå½ Memcached æå¡å¨ç¨å®åéçåæ¶ï¼å¤±æçæ°æ®è¢«é¦åæ¿æ¢ï¼ç¶åä¹æ¯æè¿æªä½¿ç¨çæ°æ®ãå¨ LRU ä¸­ï¼Memcached ä½¿ç¨çæ¯ä¸ç§ Lazy Expiration ç­ç¥ï¼èªå·±ä¸ä¼çæ§å­å¥ç key/vlue å¯¹æ¯å¦è¿æï¼èæ¯å¨è·å key å¼æ¶æ¥çè®°å½çæ¶é´æ³ï¼æ£æ¥ key/value å¯¹ç©ºé´æ¯å¦è¿æï¼è¿æ ·å¯åè½»æå¡å¨çè´è½½ã\n * åç½®äºä¸å¥é«æçåå­ç®¡çç®æ³ãè¿å¥åå­ç®¡çæçå¾é«ï¼èä¸ä¸ä¼é æåå­ç¢çï¼ä½æ¯å®æå¤§çç¼ºç¹å°±æ¯ä¼å¯¼è´ç©ºé´æµªè´¹ãå½åå­æ»¡åï¼éè¿ LRU ç®æ³èªå¨å é¤ä¸ä½¿ç¨çç¼å­ã\n * ä¸æ¯ææä¹åãMemcached æ²¡æèèæ°æ®çå®¹ç¾é®é¢ï¼éå¯æå¡ï¼æææ°æ®ä¼ä¸¢å¤±ã\n\n# 4.1.2. Memcached å·¥ä½åç\n\nï¼1ï¼åå­ç®¡ç\n\nMemcached å©ç¨ slab allocation æºå¶æ¥åéåç®¡çåå­ï¼å®æç§é¢åè§å®çå¤§å°ï¼å°åéçåå­åå²æç¹å®é¿åº¦çåå­åï¼åæå°ºå¯¸ç¸åçåå­ååæç»ï¼æ°æ®å¨å­æ¾æ¶ï¼æ ¹æ®é®å¼ å¤§å°å»å¹é slab å¤§å°ï¼æ¾å°±è¿ç slab å­æ¾ï¼æä»¥å­å¨ç©ºé´æµªè´¹ç°è±¡ã\n\nè¿å¥åå­ç®¡çæçå¾é«ï¼èä¸ä¸ä¼é æåå­ç¢çï¼ä½æ¯å®æå¤§çç¼ºç¹å°±æ¯ä¼å¯¼è´ç©ºé´æµªè´¹ã\n\nï¼2ï¼ç¼å­æ·æ±°ç­ç¥\n\nMemcached çç¼å­æ·æ±°ç­ç¥æ¯ LRU + å°æå¤±æç­ç¥ã\n\nå½ä½ å¨ Memcached åå­å¨æ°æ®é¡¹æ¶ï¼ä½ æå¯è½ä¼æå®å®å¨ç¼å­çå¤±ææ¶é´ï¼é»è®¤ä¸ºæ°¸ä¹ãå½ Memcached æå¡å¨ç¨å®åéçåæ¶ï¼å¤±æçæ°æ®è¢«é¦åæ¿æ¢ï¼ç¶åæ¯æè¿æªä½¿ç¨çæ°æ®ã\n\nå¨ LRU ä¸­ï¼Memcached ä½¿ç¨çæ¯ä¸ç§ Lazy Expiration ç­ç¥ï¼Memcached ä¸ä¼çæ§å­å¥ç key/vlue å¯¹æ¯å¦è¿æï¼èæ¯å¨è·å key å¼æ¶æ¥çè®°å½çæ¶é´æ³ï¼æ£æ¥ key/value å¯¹ç©ºé´æ¯å¦è¿æï¼è¿æ ·å¯åè½»æå¡å¨çè´è½½ã\n\nï¼3ï¼ååº\n\nMemcached æå¡å¨ä¹é´å½¼æ­¤ä¸éä¿¡ï¼å®çåå¸å¼è½åæ¯ä¾èµå®¢æ·ç«¯æ¥å®ç°ã\n\nå·ä½æ¥è¯´ï¼å°±æ¯å¨å®¢æ·ç«¯å®ç°ä¸ç§ç®æ³ï¼æ ¹æ® key æ¥è®¡ç®åºæ°æ®åºè¯¥ååªä¸ªæå¡å¨èç¹è¯»/åã\n\nèè¿ç§éåéç¾¤èç¹çç®æ³å¸¸è§çæä¸ç§ï¼\n\n * åå¸åä½ç®æ³ - ä½¿ç¨å¬å¼ï¼hashï¼keyï¼% N è®¡ç®åº åå¸å¼ æ¥å³å®æ°æ®æ å°å°åªä¸ä¸ªèç¹ã\n * ä¸è´æ§åå¸ç®æ³ - å¯ä»¥å¾å¥½çè§£å³ ç¨³å®æ§é®é¢ï¼å¯ä»¥å°ææç å­å¨èç¹ æåå¨ é¦å°¾ç¸æ¥ ç Hash ç¯ä¸ï¼æ¯ä¸ª key å¨è®¡ç® Hash åä¼ é¡ºæ¶é æ¾å° ä¸´æ¥ ç å­å¨èç¹ å­æ¾ãèå½æèç¹ å å¥ æ éåº æ¶ï¼ä»å½±åè¯¥èç¹å¨ Hash ç¯ä¸ é¡ºæ¶éç¸é» ç åç»­èç¹ã\n * èæ Hash æ§½ç®æ³ - ä½¿ç¨ åæ£åº¦è¯å¥½ ç åå¸å½æ° ææææ°æ® æ å° å°ä¸ä¸ª åºå®èå´ ç æ´æ°éå ä¸­ï¼æ´æ°å®ä¹ä¸º æ§½ï¼slotï¼ï¼è¿ä¸ªèå´ä¸è¬ è¿è¿å¤§äº èç¹æ°ãæ§½ æ¯éç¾¤å æ°æ®ç®¡ç å è¿ç§» ç åºæ¬åä½ãéç¨ å¤§èå´æ§½ çä¸»è¦ç®çæ¯ä¸ºäºæ¹ä¾¿ æ°æ®æå å éç¾¤æ©å±ãæ¯ä¸ªèç¹ä¼è´è´£ ä¸å®æ°éçæ§½ã\n\n\n# 4.2. Redis\n\n> Redis æ¯ä¸ä¸ªå¼æºï¼BSD è®¸å¯ï¼çï¼åºäºåå­çï¼å¤æ°æ®ç»æå­å¨ç³»ç»ãå¯ä»¥ç¨ä½æ°æ®åºãç¼å­åæ¶æ¯ä¸­é´ä»¶ã\n> \n> Redis è¿å¯ä»¥ä½¿ç¨å®¢æ·ç«¯åçæ¥æ©å±åæ§è½ãåç½®äº å¤å¶ï¼replicationï¼ï¼LUA èæ¬ï¼Lua scriptingï¼ï¼LRU é©±å¨äºä»¶ï¼LRU evictionï¼ï¼äºå¡ï¼transactionsï¼ åä¸åçº§å«ç ç£çæä¹åï¼persistenceï¼ï¼ å¹¶éè¿ Redis å¨åµï¼Sentinelï¼åèªå¨ååºï¼Clusterï¼æä¾é«å¯ç¨æ§ï¼high availabilityï¼ã\n\n# 4.2.1. Redis ç¹æ§\n\n * æ¯æå¤ç§æ°æ®ç±»å - stringãhashãlistãsetãsorted setã\n\n * æ¯æå¤ç§æ°æ®æ·æ±°ç­ç¥\n   \n   * volatile-lru - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n   * volatile-ttl - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­æéå°è¦è¿æçæ°æ®æ·æ±°\n   * volatile-random - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­ä»»æéæ©æ°æ®æ·æ±°\n   * allkeys-lru - ä»æææ°æ®éä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n   * allkeys-random - ä»æææ°æ®éä¸­ä»»æéæ©æ°æ®è¿è¡æ·æ±°\n   * noeviction - ç¦æ­¢é©±éæ°æ®\n\n * æä¾ä¸¤ç§æä¹åæ¹å¼ - RDB å AOF\n\n * éè¿ Redis cluster æä¾éç¾¤æ¨¡å¼ã\n\n# 4.2.2. Redis åç\n\n * ç¼å­æ·æ±°\n   * Redis æä¸¤ç§æ°æ®æ·æ±°å®ç°\n     * æ¶ææ¹å¼ - è®¿é® Redis key æ¶ï¼å¦æåç°å®å·²ç»å¤±æï¼åå é¤å®\n     * ç§¯ææ¹å¼ - å¨ææ§ä»è®¾ç½®äºå¤±ææ¶é´ç key ä¸­ï¼æ ¹æ®æ·æ±°ç­ç¥ï¼éæ©ä¸é¨åå¤±æç key è¿è¡å é¤ã\n * ååº\n   * Redis Cluster éç¾¤åå« 16384 ä¸ªèæ Hash æ§½ï¼å®éè¿ä¸ä¸ªé«æçç®æ³æ¥è®¡ç® key å±äºåªä¸ª Hash æ§½ã\n   * Redis Cluster æ¯æè¯·æ±åå - èç¹å¨æ¥å°ä¸ä¸ªå½ä»¤è¯·æ±æ¶ï¼ä¼åæ£æµè¿ä¸ªå½ä»¤è¯·æ±è¦å¤ççé®æå¨çæ§½æ¯å¦ç±èªå·±è´è´£ï¼å¦æä¸æ¯çè¯ï¼èç¹å°åå®¢æ·ç«¯è¿åä¸ä¸ª MOVED éè¯¯ï¼MOVED éè¯¯æºå¸¦çä¿¡æ¯å¯ä»¥æå¼å®¢æ·ç«¯å°è¯·æ±éå®åè³æ­£å¨è´è´£ç¸å³æ§½çèç¹ã\n * ä¸»ä»å¤å¶\n   * Redis 2.8 åæ¯æå¼æ­¥å¤å¶ãå®æä¸¤ç§æ¨¡å¼ï¼\n     * å®æ´éåæ­¥ï¼full resychronizationï¼ - ç¨äºåæ¬¡å¤å¶ãæ§è¡æ­¥éª¤ä¸ SYNC å½ä»¤åºæ¬ä¸è´ã\n     * é¨åéåæ­¥ï¼partial resychronizationï¼ - ç¨äºæ­çº¿åéå¤å¶ãå¦ææ¡ä»¶åè®¸ï¼ä¸»æå¡å¨å¯ä»¥å°ä¸»ä»æå¡å¨è¿æ¥æ­å¼æé´æ§è¡çåå½ä»¤åéç»ä»æå¡å¨ï¼ä»æå¡å¨åªéæ¥æ¶å¹¶æ§è¡è¿äºåå½ä»¤ï¼å³å¯å°ä¸»ä»æå¡å¨çæ°æ®åºç¶æä¿æä¸è´ã\n   * éç¾¤ä¸­æ¯ä¸ªèç¹é½ä¼å®æåéç¾¤ä¸­çå¶ä»èç¹åé PING æ¶æ¯ï¼ä»¥æ­¤æ¥æ£æµå¯¹æ¹æ¯å¦å¨çº¿ã\n   * å¦æä¸ä¸ªä¸»èç¹è¢«è®¤ä¸ºä¸çº¿ï¼åå¨å¶ä»èç¹ä¸­ï¼æ ¹æ® Raft ç®æ³ï¼éä¸¾åºä¸ä¸ªèç¹ï¼åçº§ä¸ºä¸»èç¹ã\n * æ°æ®ä¸è´æ§\n   * Redis ä¸ä¿è¯å¼ºä¸è´æ§ï¼å ä¸ºè¿ä¼ä½¿å¾éç¾¤æ§è½å¤§å¤§éä½ã\n   * Redis æ¯éè¿å¼æ­¥å¤å¶æ¥å®ç°æç»ä¸è´æ§ã\n\n\n# 4.3. åå¸å¼ç¼å­å¯¹æ¯\n\nä¸åçåå¸å¼ç¼å­åè½ç¹æ§åå®ç°åçæ¹é¢æå¾å¤§çå·®å¼ï¼å æ­¤ä»ä»¬æéåºçåºæ¯ä¹ææä¸åã\n\n\n\nè¿ééåä¸ä¸ªæ¯è¾åºåçåå¸å¼ç¼å­ï¼MemCacheï¼Redisï¼Tairï¼æ¥ä½ä¸ºæ¯è¾ï¼\n\næ¯è¾é¡¹    MEMCACHE              REDIS                                TAIR\næ°æ®ç»æ   åªæ¯æç®åç Key-Value ç»æ   String,Hash, List, Set, Sorted Set   String,HashMap, Listï¼Set\næä¹å    ä¸æ¯æ                   æ¯æ                                   æ¯æ\nå®¹éå¤§å°   æ°æ®çº¯åå­ï¼æ°æ®å­å¨ä¸å®è¿å¤        æ°æ®å¨åå­ï¼èµæºææ¬èéä¸å®è¶è¿ 100GB               å¯ä»¥éç½®å¨åå­æåå­+ç£çå¼æï¼æ°æ®å®¹éå¯æ éæ©å\nè¯»åæ§è½   å¾é«                    å¾é«(RT0.5ms å·¦å³)                       String ç±»åæ¯è¾é«(RT1ms å·¦å³)ï¼å¤æç±»åæ¯è¾æ¢(RT5ms å·¦å³)\nè¿æç­ç¥   è¿æåï¼ä¸å é¤ç¼å­             æå­ç§ç­ç¥æ¥å¤çè¿ææ°æ®                         æ¯æ\n\n * MemCache - åªéååºäºåå­çç¼å­æ¡æ¶ï¼ä¸ä¸æ¯ææ°æ®æä¹ååå®¹ç¾ã\n * Redis - æ¯æä¸°å¯çæ°æ®ç»æï¼è¯»åæ§è½å¾é«ï¼ä½æ¯æ°æ®å¨åå­ï¼å¿é¡»è¦èèèµæºææ¬ï¼æ¯ææä¹åã\n * Tair - æ¯æä¸°å¯çæ°æ®ç»æï¼è¯»åæ§è½è¾é«ï¼é¨åç±»åæ¯è¾æ¢ï¼çè®ºä¸å®¹éå¯ä»¥æ éæ©åã\n\næ»ç»ï¼å¦ææå¡å¯¹å»¶è¿æ¯è¾ææï¼Map/Set æ°æ®ä¹æ¯è¾å¤çè¯ï¼æ¯è¾éå Redisãå¦ææå¡éè¦æ¾å¥ç¼å­éçæ°æ®å¾å¤§ï¼å¯¹å»¶è¿åä¸æ¯ç¹å«ææçè¯ï¼é£å°±å¯ä»¥éæ© Memcachedã\n\n\n# 5. å¤çº§ç¼å­\n\n\n# 5.1. æ´ä½ç¼å­æ¡æ¶\n\néå¸¸ï¼ä¸ä¸ªå¤§åè½¯ä»¶ç³»ç»çç¼å­éç¨å¤çº§ç¼å­æ¹æ¡ï¼\n\n\n\nè¯·æ±è¿ç¨ï¼\n\n 1. æµè§å¨åå®¢æ·ç«¯åèµ·è¯·æ±ï¼å¦æ CDN æç¼å­åç´æ¥è¿åï¼\n 2. å¦æ CDN æ ç¼å­ï¼åè®¿é®ååä»£çæå¡å¨ï¼\n 3. å¦æååä»£çæå¡å¨æç¼å­åç´æ¥è¿åï¼\n 4. å¦æååä»£çæå¡å¨æ ç¼å­æå¨æè¯·æ±ï¼åè®¿é®åºç¨æå¡å¨ï¼\n 5. åºç¨æå¡å¨è®¿é®è¿ç¨åç¼å­ï¼å¦ææç¼å­ï¼åè¿åä»£çæå¡å¨ï¼å¹¶ç¼å­æ°æ®ï¼ï¼å¨æè¯·æ±ä¸ç¼å­ï¼\n 6. å¦æè¿ç¨åç¼å­æ æ°æ®ï¼åè¯»ååå¸å¼ç¼å­ï¼å¹¶è¿ååºç¨æå¡å¨ï¼åºç¨æå¡å¨å°æ°æ®ç¼å­å°æ¬å°ç¼å­ï¼é¨åï¼ï¼\n 7. å¦æåå¸å¼ç¼å­æ æ°æ®ï¼ååºç¨ç¨åºè¯»åæ°æ®åºæ°æ®ï¼å¹¶æ¾å¥åå¸å¼ç¼å­ï¼\n\n\n# 5.2. ä½¿ç¨è¿ç¨åç¼å­\n\nå¦æåºç¨æå¡æ¯åç¹åºç¨ï¼é£ä¹è¿ç¨åç¼å­å½ç¶æ¯ç¼å­çé¦éæ¹æ¡ã\n\nå¯¹äºè¿ç¨åç¼å­ï¼å¶æ¬æ¥åéäºåå­çå¤§å°çéå¶ï¼ä»¥åè¿ç¨ç¼å­æ´æ°åå¶ä»ç¼å­æ æ³å¾ç¥ï¼æä»¥ä¸è¬æ¥è¯´è¿ç¨ç¼å­éç¨äº:\n\n * æ°æ®éä¸æ¯å¾å¤§ä¸æ´æ°é¢çè¾ä½çæ°æ®ã\n * å¦ææ´æ°é¢ç¹çæ°æ®ï¼ä¹æ³ä½¿ç¨è¿ç¨åç¼å­ï¼é£ä¹å¯ä»¥å°å¶è¿ææ¶é´è®¾ç½®ä¸ºè¾ç­çæ¶é´ï¼æèè®¾ç½®è¾ç­çèªå¨å·æ°æ¶é´ã\n\nè¿ç§æ¹æ¡å­å¨ä»¥ä¸é®é¢ï¼\n\n * å¦æåºç¨æå¡æ¯åå¸å¼ç³»ç»ï¼åºç¨èç¹ä¹é´æ æ³å±äº«ç¼å­ï¼å­å¨æ°æ®ä¸ä¸è´é®é¢ã\n * ç±äºè¿ç¨åç¼å­åéäºåå­å¤§å°çéå¶ï¼æä»¥ç¼å­ä¸è½æ éæ©å±ã\n\n\n# 5.3. ä½¿ç¨åå¸å¼ç¼å­\n\nå¦æåºç¨æå¡æ¯åå¸å¼ç³»ç»ï¼é£ä¹æç®åçç¼å­æ¹æ¡å°±æ¯ç´æ¥ä½¿ç¨åå¸å¼ç¼å­ã\n\nå¶åºç¨åºæ¯å¦å¾æç¤ºï¼\n\n\n\nRedis ç¨æ¥å­å¨ç­ç¹æ°æ®ï¼å¦æç¼å­ä¸å½ä¸­ï¼åå»æ¥è¯¢æ°æ®åºï¼å¹¶æ´æ°ç¼å­ã\n\nè¿ç§æ¹æ¡å­å¨ä»¥ä¸é®é¢ï¼\n\n 1. ç¼å­æå¡å¦ææäºï¼è¿æ¶åºç¨åªè½è®¿é®æ°æ®åºï¼å®¹æé æç¼å­éªå´©ã\n 2. è®¿é®åå¸å¼ç¼å­æå¡ä¼æä¸å®ç I/O ä»¥ååºååååºååçå¼éï¼è½ç¶æ§è½å¾é«ï¼ä½æ¯å¶ç»ç©¶æ²¡æå¨åå­ä¸­æ¥è¯¢å¿«ã\n\n\n# 5.4. ä½¿ç¨å¤çº§ç¼å­\n\nåçº¯ä½¿ç¨è¿ç¨åç¼å­ååå¸å¼ç¼å­é½å­å¨åèªçä¸è¶³ãå¦æéè¦æ´é«çæ§è½ä»¥åæ´å¥½çå¯ç¨æ§ï¼æä»¬å¯ä»¥å°ç¼å­è®¾è®¡ä¸ºå¤çº§ç»æãå°æç­çæ°æ®ä½¿ç¨è¿ç¨åç¼å­å­å¨å¨åå­ä¸­ï¼è¿ä¸æ­¥æåè®¿é®éåº¦ã\n\nè¿ä¸ªè®¾è®¡æè·¯å¨è®¡ç®æºç³»ç»ä¸­ä¹å­å¨ï¼æ¯å¦ CPU ä½¿ç¨ L1ãL2ãL3 å¤çº§ç¼å­ï¼ç¨æ¥åå°å¯¹åå­çç´æ¥è®¿é®ï¼ä»èå å¿«è®¿é®éåº¦ã\n\nä¸è¬æ¥è¯´ï¼å¤çº§ç¼å­æ¶æä½¿ç¨äºçº§ç¼å­å·²å¯ä»¥æ»¡è¶³å¤§é¨åä¸å¡éæ±ï¼è¿å¤çåçº§ä¼å¢å ç³»ç»çå¤æåº¦ä»¥åç»´æ¤çææ¬ãå æ­¤ï¼å¤çº§ç¼å­ä¸æ¯åçº§è¶å¤è¶å¥½ï¼éè¦æ ¹æ®å®éæåµè¿è¡æè¡¡ã\n\nä¸ä¸ªå¸åçäºçº§ç¼å­æ¶æï¼å¯ä»¥ä½¿ç¨è¿ç¨åç¼å­ï¼å¦ï¼ Caffeine/Google Guava/Ehcache/HashMapï¼ä½ä¸ºä¸çº§ç¼å­ï¼ä½¿ç¨åå¸å¼ç¼å­ï¼å¦ï¼Redis/Memcachedï¼ä½ä¸ºäºçº§ç¼å­ã\n\n# 5.4.1. å¤çº§ç¼å­æ¥è¯¢\n\n\n\nå¤çº§ç¼å­æ¥è¯¢æµç¨å¦ä¸ï¼\n\n 1. é¦åï¼æ¥è¯¢ L1 ç¼å­ï¼å¦æç¼å­å½ä¸­ï¼ç´æ¥è¿åç»æï¼å¦ææ²¡æå½ä¸­ï¼æ§è¡ä¸ä¸æ­¥ã\n 2. æ¥ä¸æ¥ï¼æ¥è¯¢ L2 ç¼å­ï¼å¦æç¼å­å½ä¸­ï¼ç´æ¥è¿åç»æå¹¶åå¡« L1 ç¼å­ï¼å¦ææ²¡æå½ä¸­ï¼æ§è¡ä¸ä¸æ­¥ã\n 3. æåï¼æ¥è¯¢æ°æ®åºï¼è¿åç»æå¹¶ä¾æ¬¡åå¡« L2 ç¼å­ãL1 ç¼å­ã\n\n# 5.4.2. å¤çº§ç¼å­æ´æ°\n\nå¯¹äº L1 ç¼å­ï¼å¦æææ°æ®æ´æ°ï¼åªè½å é¤å¹¶æ´æ°æå¨æºå¨ä¸çç¼å­ï¼å¶ä»æºå¨åªè½éè¿è¶æ¶æºå¶æ¥å·æ°ç¼å­ãè¶æ¶è®¾å®å¯ä»¥æä¸¤ç§ç­ç¥:\n\n * è®¾ç½®æåå¥åå¤å°æ¶é´åè¿æ\n * è®¾ç½®æåå¥åå¤å°æ¶é´å·æ°\n\nå¯¹äº L2 ç¼å­ï¼å¦æææ°æ®æ´æ°ï¼å¶ä»æºå¨ç«é©¬å¯è§ãä½æ¯ï¼ä¹å¿é¡»è¦è®¾ç½®è¶æ¶æ¶é´ï¼å¶æ¶é´åºè¯¥æ¯ L1 ç¼å­çæææ¶é´é¿ã\n\nä¸ºäºè§£å³è¿ç¨åç¼å­ä¸ä¸è´çé®é¢ï¼è®¾è®¡å¯ä»¥è¿ä¸æ­¥ä¼å:\n\n\n\néè¿æ¶æ¯éåçåå¸ãè®¢éæºå¶ï¼å¯ä»¥éç¥å¶ä»åºç¨èç¹å¯¹è¿ç¨åç¼å­è¿è¡æ´æ°ãä½¿ç¨è¿ç§æ¹æ¡ï¼å³ä½¿æ¶æ¯éåæå¡æäºæä¸å¯é ï¼ç±äºåæ§è¡äºæ°æ®åºæ´æ°ï¼ä½è¿ç¨åç¼å­è¿æï¼å·æ°ç¼å­æ¶ï¼ä¹è½ä¿è¯æ°æ®çæç»ä¸è´æ§ã\n\n\n# 6. ç¼å­é®é¢\n\n\n# 6.1. ç¼å­éªå´©\n\nç¼å­éªå´©æ¯æç¼å­ä¸å¯ç¨æèå¤§éç¼å­ç±äºè¶æ¶æ¶é´ç¸åå¨åä¸æ¶é´æ®µå¤±æï¼å¤§éè¯·æ±ç´æ¥è®¿é®æ°æ®åºï¼æ°æ®åºååè¿å¤§å¯¼è´ç³»ç»éªå´©ã\n\nä¸¾ä¾æ¥è¯´ï¼å¯¹äºç³»ç» Aï¼åè®¾æ¯å¤©é«å³°ææ¯ç§ 5000 ä¸ªè¯·æ±ï¼æ¬æ¥ç¼å­å¨é«å³°æå¯ä»¥æä½æ¯ç§ 4000 ä¸ªè¯·æ±ï¼ä½æ¯ç¼å­æºå¨æå¤åçäºå¨çå®æºãç¼å­æäºï¼æ­¤æ¶ 1 ç§ 5000 ä¸ªè¯·æ±å¨é¨è½æ°æ®åºï¼æ°æ®åºå¿ç¶æä¸ä½ï¼å®ä¼æ¥ä¸ä¸è­¦ï¼ç¶åå°±æäºãæ­¤æ¶ï¼å¦ææ²¡æéç¨ä»ä¹ç¹å«çæ¹æ¡æ¥å¤çè¿ä¸ªæéï¼DBA å¾çæ¥ï¼éå¯æ°æ®åºï¼ä½æ¯æ°æ®åºç«é©¬åè¢«æ°çæµéç»ææ­»äºã\n\nè§£å³ç¼å­éªå´©çä¸»è¦ææ®µå¦ä¸ï¼\n\n * å¢å ç¼å­ç³»ç»å¯ç¨æ§ï¼äºåï¼ãä¾å¦ï¼é¨ç½² Redis Clusterï¼ä¸»ä»+å¨åµï¼ï¼ä»¥å®ç° Redis çé«å¯ç¨ï¼é¿åå¨çå´©æºã\n * éç¨å¤çº§ç¼å­æ¹æ¡ï¼äºä¸­ï¼ãä¾å¦ï¼æ¬å°ç¼å­ï¼Ehcache/Caffine/Guava Cacheï¼ + åå¸å¼ç¼å­ï¼Redis/ Memcachedï¼ã\n * éæµãéçº§ãçæ­æ¹æ¡ï¼äºä¸­ï¼ï¼é¿åè¢«æµéææ­»ãå¦ï¼ä½¿ç¨ Hystrix è¿è¡çæ­ãéçº§ã\n * ç¼å­å¦ææ¯ææä¹åï¼å¯ä»¥å¨æ¢å¤å·¥ä½åæ¢å¤æ°æ®ï¼äºåï¼ãå¦ï¼Redis æ¯ææä¹åï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\nä¸é¢çè§£å³æ¹æ¡ç®åæ¥è¯´ï¼å°±æ¯å¤çº§ç¼å­æ¹æ¡ãç³»ç»æ¶å°ä¸ä¸ªæ¥è¯¢è¯·æ±ï¼åæ¥æ¬å°ç¼å­ï¼åæ¥åå¸å¼ç¼å­ï¼æåæ¥æ°æ®åºï¼åªè¦å½ä¸­ï¼ç«å³è¿åã\n\nè§£å³ç¼å­éªå´©çè¾å©ææ®µå¦ä¸ï¼\n\n * çæ§ç¼å­ï¼å¼¹æ§æ©å®¹ã\n * ç¼å­çè¿ææ¶é´å¯ä»¥åä¸ªéæºå¼ãè¿ä¹åæ¯ä¸ºé¿åç¼å­åæ¶å¤±æï¼ä½¿å¾æ°æ®åº IO éª¤åãæ¯å¦ï¼ä»¥åæ¯è®¾ç½® 10 åéçè¶æ¶æ¶é´ï¼é£æ¯ä¸ª Key é½å¯ä»¥éæº 8-13 åéè¿æï¼å°½éè®©ä¸å Key çè¿ææ¶é´ä¸åã\n\n\n# 6.2. ç¼å­ç©¿é\n\n> ç¼å­ç©¿éæ¯æï¼æ¥è¯¢çæ°æ®å¨æ°æ®åºä¸­ä¸å­å¨ï¼é£ä¹ç¼å­ä¸­èªç¶ä¹ä¸å­å¨ãæä»¥ï¼åºç¨å¨ç¼å­ä¸­æ¥ä¸å°ï¼åä¼å»æ¥è¯¢æ°æ®åºãå½è¿æ ·çè¯·æ±å¤äºåï¼æ°æ®åºçååå°±ä¼å¢å¤§ã\n\nè§£å³ç¼å­ç©¿éï¼ä¸è¬æä¸¤ç§æ¹æ³ï¼\n\nï¼ä¸ï¼ç¼å­ç©ºå¼\n\nå¯¹äºè¿åä¸º NULL çä¾ç¶ç¼å­ï¼å¯¹äºæåºå¼å¸¸çè¿åä¸è¿è¡ç¼å­ã\n\n\n\néç¨è¿ç§ææ®µçä¼å¢å æä»¬ç¼å­çç»´æ¤ææ¬ï¼éè¦å¨æå¥ç¼å­çæ¶åå é¤è¿ä¸ªç©ºç¼å­ï¼å½ç¶æä»¬å¯ä»¥éè¿è®¾ç½®è¾ç­çè¶æ¶æ¶é´æ¥è§£å³è¿ä¸ªé®é¢ã\n\nï¼äºï¼è¿æ»¤ä¸å¯è½å­å¨çæ°æ®\n\n\n\nå¶å®ä¸äºè§åè¿æ»¤ä¸äºä¸å¯è½å­å¨çæ°æ®ãå¯ä»¥ä½¿ç¨å¸éè¿æ»¤å¨ï¼éå¯¹äºè¿å¶æä½çæ°æ®ç»æï¼æä»¥æ§è½é«ï¼ï¼æ¯å¦ä½ çè®¢å ID ææ¾æ¯å¨ä¸ä¸ªèå´ 1-1000ï¼å¦æä¸æ¯ 1-1000 ä¹åçæ°æ®é£å¶å®å¯ä»¥ç´æ¥ç»è¿æ»¤æã\n\n> éå¯¹äºä¸äºæ¶ææ»å»ï¼æ»å»å¸¦è¿æ¥çå¤§é key æ¯ä¸å­å¨çï¼é£ä¹æä»¬éç¨ç¬¬ä¸ç§æ¹æ¡å°±ä¼ç¼å­å¤§éä¸å­å¨ key çæ°æ®ã\n> \n> æ­¤æ¶æä»¬éç¨ç¬¬ä¸ç§æ¹æ¡å°±ä¸åéäºï¼æä»¬å®å¨å¯ä»¥åå¯¹ä½¿ç¨ç¬¬äºç§æ¹æ¡è¿è¡è¿æ»¤æè¿äº keyã\n> \n> éå¯¹è¿ç§ key å¼å¸¸å¤ãè¯·æ±éå¤çæ¯è¾ä½çæ°æ®ï¼æä»¬å°±æ²¡æå¿è¦è¿è¡ç¼å­ï¼ä½¿ç¨ç¬¬äºç§æ¹æ¡ç´æ¥è¿æ»¤æã\n> \n> èå¯¹äºç©ºæ°æ®ç key æéçï¼éå¤çæ¯è¾é«çï¼æä»¬åå¯ä»¥éç¨ç¬¬ä¸ç§æ¹å¼è¿è¡ç¼å­ã\n\n\n# 6.3. ç¼å­å»ç©¿\n\nç¼å­å»ç©¿æ¯æï¼ç­ç¹æ°æ®å¤±æç¬é´ï¼å¤§éè¯·æ±ç´æ¥è®¿é®æ°æ®åºãä¾å¦ï¼æäº key æ¯ç­ç¹æ°æ®ï¼è®¿é®éå¸¸é¢ç¹ãå¦ææä¸ª key å¤±æçç¬é´ï¼å¤§éçè¯·æ±è¿æ¥ï¼ç¼å­æªå½ä¸­ï¼ç¶åå»æ°æ®åºè®¿é®ï¼æ­¤æ¶æ°æ®åºè®¿é®éä¼æ¥å§å¢å ã\n\nä¸ºäºé¿åè¿ä¸ªé®é¢ï¼æä»¬å¯ä»¥éåä¸é¢çä¸¤ä¸ªææ®µ:\n\n * åå¸å¼é - éä½ç­ç¹æ°æ®ç keyï¼é¿åå¤§éçº¿ç¨åæ¶è®¿é®åä¸ä¸ª keyã\n * å®æ¶å¼æ­¥å·æ° - å¯ä»¥å¯¹é¨åæ°æ®éåå¤±æåèªå¨å·æ°çç­ç¥ï¼èä¸æ¯å°æèªå¨æ·æ±°ãæ·æ±°å¶å®ä¹æ¯ä¸ºäºæ°æ®çæ¶ææ§ï¼æä»¥éç¨èªå¨å·æ°ä¹å¯ä»¥ã\n\n\n# 6.4. å°ç»\n\nä¸é¢éä¸ä»ç»äºç¼å­ä½¿ç¨ä¸­å¸¸è§çé®é¢ãè¿éï¼ä»åçæ¶é´æ®µçè§åº¦æ´ä½å½çº³ä¸ä¸ç¼å­é®é¢è§£å³æ¹æ¡ã\n\n * äºåï¼Redis é«å¯ç¨æ¹æ¡ï¼Redis Cluster + ä¸»ä» + å¨åµï¼ï¼é¿åç¼å­å¨é¢å´©æºã\n * äºä¸­ï¼ï¼ä¸ï¼éç¨å¤çº§ç¼å­æ¹æ¡ï¼æ¬å°ç¼å­ï¼Ehcache/Caffine/Guava Cacheï¼ + åå¸å¼ç¼å­ï¼Redis/ Memcachedï¼ãï¼äºï¼éæµ + çæ­ + éçº§ï¼Hystrixï¼ï¼é¿åæç«¯æåµä¸ï¼æ°æ®åºè¢«ææ­»ã\n * äºåï¼Redis æä¹åï¼RDB+AOFï¼ï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\n> åå¸å¼ç¼å­ Memcached ï¼ç±äºæ°æ®ç±»åä¸å¦ Redis ä¸°å¯ï¼å¹¶ä¸ä¸æ¯ææä¹åãå®¹ç¾ãæä»¥ï¼ä¸è¬ä¼éæ© Redis ååå¸å¼ç¼å­ã\n\n\n# 7. ç¼å­ç­ç¥\n\n\n# 7.1. ç¼å­é¢ç­\n\nç¼å­é¢ç­æ¯æç³»ç»å¯å¨åï¼ç´æ¥æ¥è¯¢ç­ç¹æ°æ®å¹¶ç¼å­ãè¿æ ·å°±å¯ä»¥é¿åç¨æ·è¯·æ±çæ¶åï¼åæ¥è¯¢æ°æ®åºï¼ç¶ååæ´æ°ç¼å­çé®é¢ã\n\nè§£å³æ¹æ¡ï¼\n\n * æå¨å·æ°ç¼å­ï¼ç´æ¥åä¸ªç¼å­å·æ°é¡µé¢ï¼ä¸çº¿æ¶æå·¥æä½ä¸ã\n * åºç¨å¯å¨æ¶å·æ°ç¼å­ï¼æ°æ®éä¸å¤§ï¼å¯ä»¥å¨é¡¹ç®å¯å¨çæ¶åèªå¨è¿è¡å è½½ã\n * å®æ¶å¼æ­¥å·æ°ç¼å­\n\n\n# 7.2. å¦ä½ç¼å­\n\n# 7.2.1. ä¸è¿æç¼å­\n\nç¼å­æ´æ°æ¨¡å¼ï¼\n\n 1. å¼å¯äºå¡\n 2. å SQL\n 3. æäº¤äºå¡\n 4. åç¼å­\n\nä¸è¦æåç¼å­æä½æ¾å¨äºå¡ä¸­ï¼å°¤å¶æ¯ååå¸å¼ç¼å­ãå ä¸ºç½ç»æå¨å¯è½å¯¼è´åç¼å­ååºæ¶é´å¾æ¢ï¼å¼èµ·æ°æ®åºäºå¡é»å¡ãå¦æå¯¹ç¼å­æ°æ®ä¸è´æ§è¦æ±ä¸æ¯é£ä¹é«ï¼æ°æ®éä¹ä¸æ¯å¾å¤§ï¼å¯ä»¥èèå®æå¨éåæ­¥ç¼å­ã\n\nè¿ç§æ¨¡å¼å­å¨è¿æ ·çæåµï¼å­å¨äºå¡æåï¼ä½ç¼å­åå¤±è´¥çå¯è½ãä½è¿ç§æåµç¸å¯¹äºä¸é¢çé®é¢ï¼å½±åè¾å°ã\n\n# 7.2.2. è¿æç¼å­\n\néç¨æå è½½ãå¯¹äºç­ç¹æ°æ®ï¼å¯ä»¥è®¾ç½®è¾ç­çç¼å­æ¶é´ï¼å¹¶å®æå¼æ­¥å è½½ã\n\n\n# 7.3. ç¼å­æ´æ°\n\nä¸è¬æ¥è¯´ï¼ç³»ç»å¦æä¸æ¯ä¸¥æ ¼è¦æ±ç¼å­åæ°æ®åºä¿æä¸è´æ§çè¯ï¼å°½éä¸è¦å°è¯»è¯·æ±ååè¯·æ±ä¸²è¡åãä¸²è¡åå¯ä»¥ä¿è¯ä¸å®ä¸ä¼åºç°æ°æ®ä¸ä¸è´çæåµï¼ä½æ¯å®ä¼å¯¼è´ç³»ç»çååéå¤§å¹åº¦ä¸éã\n\nç¼å­æ´æ°çç­ç¥æå ç§æ¨¡å¼ï¼\n\n * Cache Aside\n * Read/Write Through\n\néè¦æ³¨æçæ¯ï¼ä»¥ä¸å ç§ç¼å­æ´æ°ç­ç¥ï¼é½æ æ³ä¿è¯æ°æ®å¼ºä¸è´ãå¦æä¸å®è¦ä¿è¯å¼ºä¸è´æ§ï¼å¯ä»¥éè¿ä¸¤é¶æ®µæäº¤ï¼2PCï¼æ Paxos åè®®æ¥å®ç°ãä½æ¯ 2PC å¤ªæ¢ï¼è Paxos å¤ªå¤æï¼æä»¥å¦æä¸æ¯éå¸¸éè¦çæ°æ®ï¼ä¸å»ºè®®ä½¿ç¨å¼ºä¸è´æ§æ¹æ¡ã\n\n# 7.3.1. Cache Aside\n\nCache Aside åºè¯¥æ¯æå¸¸è§çç¼å­æ´æ°ç­ç¥äºã\n\nCache Aside çæè·¯æ¯ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ãå·ä½æ¥è¯´ï¼\n\n * å¤±æï¼å°è¯è¯»ç¼å­ï¼å¦æä¸å½ä¸­ï¼åè¯»æ°æ®åºï¼ç¶åæ´æ°ç¼å­ã\n\n * å½ä¸­ï¼å°è¯è¯»ç¼å­ï¼å½ä¸­åç´æ¥è¿åæ°æ®ã\n\n * æ´æ°ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ã\n\n\n\n# 7.3.1.1. ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åºï¼åæ´æ°ç¼å­ï¼\n\nå¤ä¸ªå¹¶åçåæä½å¯è½å¯¼è´èæ°æ®ï¼å½æå¤ä¸ªå¹¶åçåè¯·æ±æ¶ï¼æ æ³ä¿è¯æ´æ°æ°æ®åºçé¡ºåºåæ´æ°ç¼å­çé¡ºåºä¸è´ï¼ä»èå¯¼è´æ°æ®åºåç¼å­æ°æ®ä¸ä¸è´çé®é¢ã\n\n\n\n> è¯´æï¼å¦ä¸å¾çåºæ¯ä¸­ï¼ä¸¤ä¸ªåçº¿ç¨ç±äºæ§è¡é¡ºåºï¼å¯¼è´æ°æ®åºä¸­ val = 2ï¼èç¼å­ä¸­ val = 1ï¼æ°æ®ä¸ä¸è´ã\n\n# 7.3.1.2. ä¸ºä»ä¹ä¸è½åå ç¼å­ï¼åæ´æ°æ°æ®åºï¼\n\nå­å¨å¹¶åè¯»è¯·æ±ååè¯·æ±æ¶ï¼å¯è½å¯¼è´èæ°æ®ã\n\n\n\n> è¯´æï¼å¦ä¸å¾çåºæ¯ä¸­ï¼è¯»çº¿ç¨ååçº¿ç¨å¹¶è¡æ§è¡ï¼å¯¼è´æ°æ®åºä¸­ val = 2ï¼èç¼å­ä¸­ val = 1ï¼æ°æ®ä¸ä¸è´ã\n\n# 7.3.1.3. åæ´æ°æ°æ®åºï¼åå é¤ç¼å­å°±æ²¡é®é¢äºå\n\nå­å¨å¹¶åè¯»è¯·æ±ååè¯·æ±æ¶ï¼å¯è½å¯¼è´èæ°æ®ã\n\n\n\n> ä¸å¾ä¸­é®é¢åççæ¦çéå¸¸ä½ï¼å ä¸ºéå¸¸æ°æ®åºæ´æ°æä½æ¯åå­æä½èæ¶å¤åºå ä¸ªæ°éçº§ï¼æåä¸æ­¥ååç¼å­éåº¦éå¸¸å¿«ï¼éå¸¸ä¼å¨æ´æ°æ°æ®åºä¹åå®æãæä»¥ Cache Aside æ¨¡å¼éæ©åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ï¼èä¸æ¯åå ç¼å­ï¼åæ´æ°æ°æ®åºã\n> \n> ä¸è¿ï¼å¦æççåºç°äºè¿ç§åºæ¯ï¼ä¸ºäºé¿åç¼å­ä¸­ä¸ç´ä¿ççèæ°æ®ï¼å¯ä»¥ä¸ºç¼å­è®¾ç½®è¿ææ¶é´ï¼è¿æåç¼å­èªå¨å¤±æãéå¸¸ï¼ä¸å¡ç³»ç»ä¸­åè®¸å°éæ°æ®ç­æ¶é´åºç°ä¸ä¸è´çæåµã\n\n# 7.3.2. Read/Write Through\n\n\n\nRead Through çæè·¯æ¯ï¼æ¥è¯¢æ¶æ´æ°ç¼å­ãå½ç¼å­å¤±ææ¶ï¼ç¼å­æå¡èªå·±è¿è¡å è½½ã\n\nWrite Through çæè·¯æ¯ï¼å½æ°æ®æ´æ°æ¶ï¼ç¼å­æå¡è´è´£æ´æ°ç¼å­ã\n\nThrough vs. Cache Aside\n\nRead Through vs. Cache Aside\n\n * Cache Aside æ¨¡å¼ä¸­ï¼åºç¨éè¦ç»´æ¤ä¸¤ä¸ªæ°æ®æºå¤´ï¼ä¸ä¸ªæ¯ç¼å­ï¼ä¸ä¸ªæ¯æ°æ®åºã\n * Read-Through æ¨¡å¼ä¸­ï¼åºç¨æ éç®¡çç¼å­åæ°æ®åºï¼åªéè¦å°æ°æ®åºçåæ­¥å§æç»ç¼å­æå¡å³å¯ã\n\n# 7.3.3. Write behind\n\nWrite Behind åå« Write BackãWrite Behind çæè·¯æ¯ï¼åºç¨æ´æ°æ°æ®æ¶ï¼åªæ´æ°ç¼å­ï¼ ç¼å­æå¡æ¯éä¸æ®µæ¶é´å°ç¼å­æ°æ®æ¹éæ´æ°å°æ°æ®åºä¸­ï¼å³å»¶è¿åå¥ãè¿ä¸ªè®¾è®¡çå¥½å¤å°±æ¯è®©æé« I/O æçï¼å ä¸ºå¼æ­¥ï¼Write Behind è¿å¯ä»¥åå¹¶å¯¹åä¸ä¸ªæ°æ®çå¤æ¬¡æä½ï¼æä»¥æ§è½çæé«æ¯ç¸å½å¯è§çã\n\n> æ´è¯¦ç»çåæå¯ä»¥åèï¼åå¸å¼ä¹æ°æ®åºåç¼å­ååä¸è´æ§æ¹æ¡è§£æ\n\n\n# 8. æ»ç»\n\næåï¼éè¿ä¸å¼ æç»´å¯¼å¾æ¥æ»ç»ä¸ä¸æ¬ææè¿°çç¥è¯ç¹ï¼å¸®å©å¤§å®¶å¯¹ç¼å­æä¸ä¸ªç³»ç»æ§çè®¤è¯ã\n\n\n\n\n# 9. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ä½ åºè¯¥ç¥éçç¼å­è¿åå²\n * å¦ä½ä¼éçè®¾è®¡åä½¿ç¨ç¼å­ï¼\n * çè§£åå¸å¼ç³»ç»ä¸­çç¼å­æ¶æ(ä¸)\n * ç¼å­é£äºäº\n * åå¸å¼ä¹æ°æ®åºåç¼å­ååä¸è´æ§æ¹æ¡è§£æ\n * Cache çåºæ¬åç\n * 5 åéçæç³»åï¼HTTP ç¼å­æºå¶è¯¦è§£\n * æµè§å¨ç¼å­çè¿ä¸ç¯å°±å¤äº",normalizedContent:"# ç¼å­åºæ¬åç\n\n> ç¼å­æ¯ä¸ç§å©ç¨ç©ºé´æ¢æ¶é´çè®¾è®¡ï¼å¶ç®æ å°±æ¯æ´å¿«ãæ´è¿ã\n\n\n# 1. ç¼å­ç®ä»\n\n\n# 1.1. ä¸ºä»ä¹éè¦ç¼å­\n\nä¼æå¨ç¥ï¼å½ä»æ¯ä¸ä¸ªäºèç½æ¶ä»£ï¼èäºèç½åºç¨å ä¹éåæä»¬æ¥å¸¸çæ´»çæ¹æ¹é¢é¢ãä¸è¬èè¨ï¼ä¸ä¸ªäºèç½åºç¨çè¯·æ±/ååºæµç¨ä¼æä»¥ä¸å ä¸ªä¸»è¦æµç¨ï¼\n\n * å®¢æ·ç«¯åèµ·è¯·æ±ï¼è¯·æ±ç»è¿ç½ç» i/oï¼ååå°æå¡å±ã\n * æå¡å±å¯è½æå¤çº§æå¡ï¼è¯·æ±éè¦è¢«å¤ä¸ªæå¡å±å±å¤çã\n * ä¸åæå¡æ ¹æ®è¯·æ±è¿è¡è®¡ç®æ¶ï¼å¯è½ä¾èµäºä¸åæ°æ®åºçæ°æ®ï¼éè¦éè¿ç½ç» i/o è¯»åæ°æ®åºã\n\næ¾ç¶ï¼è¿ä¸å¥æµç¨ä¸æ¥ï¼å¯è½éè¦æ¶èå¤§éçè®¡ç®æºèµæºï¼å¹¶ä¸ååºæ¶é´ä¹å¯è½å¾ä¹ãå¦æå¹¶åè¯·æ±éå¾å¤§çè¯ï¼å¯è½ä¼è¿ä¸æ­¥å å§è¿ç§é®é¢ã\n\n\n\nä¸ºäºè§£å³ä»¥ä¸é®é¢ï¼æç´æ¥çæ¹å¼å°±æ¯å¼å¥ç¼å­ãç¼å­å¯ä»¥ä½ç¨äºè¯·æ±/ååºæµç¨çä»»æç¯èï¼å¹¶ææåå°åç»­ç¯èçæ§è¡æ¬¡æ°ï¼ä»èå¤§å¤§æåæ§è½ã\n\nå®éä¸ï¼ç¼å­ä½ä¸ºæ§è½ä¼åçç¬¬ä¸ææ®µï¼è¢«å¹¿æ³åºç¨äºè®¡ç®æºçç¡¬ä»¶ãè½¯ä»¶é¢åã\n\n\n# 1.2. ä»ä¹æ¯ç¼å­\n\nç¼å­å°±æ¯æ°æ®äº¤æ¢çç¼å²åºï¼ç¨äºå°é¢ç¹è®¿é®çæ°æ®æå­ãç¼å­çæ¬è´¨æ¯ä¸ä¸ªåå­ hashã\n\nç¼å­çæ¬è´¨æ¯ä¸ç§å©ç¨ç©ºé´æ¢æ¶é´çè®¾è®¡ï¼çºç²ä¸å®çæ°æ®å®æ¶æ§ï¼ä½¿å¾è®¿é®æ´å¿«ãæ´è¿ï¼\n\n * å°æ°æ®å­å¨å°è¯»åéåº¦æ´å¿«çå­å¨ï¼è®¾å¤ï¼ï¼\n * å°æ°æ®å­å¨å°ç¦»åºç¨æè¿çä½ç½®ï¼\n * å°æ°æ®å­å¨å°ç¦»ç¨æ·æè¿çä½ç½®ã\n\nç¼å­æ¯ç¨äºå­å¨æ°æ®çç¡¬ä»¶æè½¯ä»¶çç»æé¨åï¼ä»¥ä½¿å¾åç»­æ´å¿«è®¿é®ç¸åºçæ°æ®ãç¼å­ä¸­çæ°æ®å¯è½æ¯æåè®¡ç®å¥½çç»æãæ°æ®çå¯æ¬ç­ãå¸åçåºç¨åºæ¯ï¼æ cpu cache, ç£ç cache ç­ãæ¬æä¸­æåå°ç¼å­ä¸»è¦æ¯æäºèç½åºç¨ä¸­æä½¿ç¨çç¼å­ç»ä»¶ã\n\nç¼å­å½ä¸­çæ¯ç¼å­çéè¦åº¦éææ ï¼å½ä¸­çè¶é«è¶å¥½ã\n\nç¼å­å½ä¸­ç = ä»ç¼å­ä¸­è¯»åæ¬¡æ° / æ»è¯»åæ¬¡æ°\n\n\n\n# 1.3. ä½æ¶éè¦ç¼å­\n\nå¼å¥ç¼å­ï¼ä¼å¢å ç³»ç»çå¤æåº¦ï¼å¹¶çºç²ä¸å®çæ°æ®å®æ¶æ§ãæä»¥ï¼å¼å¥ç¼å­åï¼éè¦åæè¡¡æ¯å¦å¼å¾ï¼èéç¹å¦ä¸ï¼\n\n * cpu å¼é - å¦æåºç¨æä¸ªè®¡ç®éè¦æ¶èå¤§é cpuï¼å¯ä»¥èèç¼å­å¶è®¡ç®ç»æãå¸ååºæ¯ï¼å¤æçãé¢ç¹è°ç¨çæ­£åè®¡ç®ï¼åå¸å¼è®¡ç®ä¸­é´ç¶æç­ã\n * io å¼é - å¦ææ°æ®åºè¿æ¥æ± æ¯è¾ç¹å¿ï¼å¯ä»¥èèç¼å­å¶æ¥è¯¢ç»æã\n\nå¨æ°æ®å±å¼å¥ç¼å­ï¼æä»¥ä¸å ä¸ªå¥½å¤ï¼\n\n * æåæ°æ®è¯»åéåº¦ã\n * æåç³»ç»æ©å±è½åï¼éè¿æ©å±ç¼å­ï¼æåç³»ç»æ¿è½½è½åã\n * éä½å­å¨ææ¬ï¼cache+db çæ¹å¼å¯ä»¥æ¿æåæéè¦å¤å° db æè½æ¿æçè¯·æ±éï¼èçæºå¨ææ¬ã\n\n\n# 1.4. ç¼å­çåºæ¬åç\n\næ ¹æ®ä¸å¡åºæ¯ï¼éå¸¸ç¼å­æä»¥ä¸å ç§ä½¿ç¨æ¹å¼ï¼\n\n * ææ±å¼(è¯»æ¶è§¦å)ï¼åæ¥è¯¢ db éçæ°æ®, ç¶åæç¸å³çæ°æ®åå¥ cacheã\n * é¥¥é¥¿å¼(åæ¶è§¦å)ï¼åå¥ db å, ç¶åæç¸å³çæ°æ®ä¹åå¥ cacheã\n * å®æå·æ°ï¼éåå¨ææ§çè·æ°æ®çä»»å¡ï¼æèåè¡¨åçæ°æ®ï¼èä¸ä¸è¦æ±ç»å¯¹å®æ¶æ§ã\n\n\n# 1.5. ç¼å­æ·æ±°ç­ç¥\n\nç¼å­æ·æ±°çç±»åï¼\n\n * åºäºç©ºé´ - è®¾ç½®ç¼å­ç©ºé´å¤§å°ã\n * åºäºå®¹é - è®¾ç½®ç¼å­å­å¨è®°å½æ°ã\n * åºäºæ¶é´\n   * ttlï¼time to liveï¼å³å­æ´»æï¼ç¼å­æ°æ®ä»åå»ºå°è¿æçæ¶é´ã\n   * ttiï¼time to idleï¼å³ç©ºé²æï¼ç¼å­æ°æ®å¤ä¹æ²¡è¢«è®¿é®çæ¶é´ã\n\nç¼å­æ·æ±°ç®æ³ï¼\n\n * fifo (first in first out) - åè¿ååºãå¨è¿ç§æ·æ±°ç®æ³ä¸­ï¼åè¿å¥ç¼å­çä¼åè¢«æ·æ±°ãè¿ç§å¯è°æ¯æç®åçäºï¼ä½æ¯ä¼å¯¼è´æä»¬å½ä¸­çå¾ä½ãè¯æ³ä¸ä¸æä»¬å¦ææä¸ªè®¿é®é¢çå¾é«çæ°æ®æ¯æææ°æ®ç¬¬ä¸ä¸ªè®¿é®çï¼èé£äºä¸æ¯å¾é«çæ¯åé¢åè®¿é®çï¼é£è¿æ ·å°±ä¼ææä»¬çé¦ä¸ªæ°æ®ä½æ¯ä»çè®¿é®é¢çå¾é«ç»æ¤åºã\n * lru (least recently used) - æè¿æå°ä½¿ç¨ç®æ³ãè¿ç§ç®æ³é¿åäº fifo å½ä¸­çä¸é«çé®é¢ï¼æ¯æ¬¡è®¿é®æ°æ®é½ä¼å°å¶æ¾å¨æä»¬çéå°¾ï¼å¦æéè¦æ·æ±°æ°æ®ï¼å°±åªéè¦æ·æ±°éé¦å³å¯ãä½æ¯è¿ä¸ªç®æ³ä¾ç¶æç¼ºç¹ï¼åè®¾ï¼ç¼å­åªä¿ç 1 åéä»¥åçç­ç¹æ°æ®ãå¦ææä¸ªæ°æ®å¨ 1 ä¸ªå°æ¶çå 59 åéè®¿é®äº 1 ä¸æ¬¡ï¼å¯è§è¿æ¯ä¸ªç­ç¹æ°æ®ï¼ï¼æåä¸åéæ²¡æä»»ä½è®¿é®ï¼ä½æ¯ï¼å¶ä»çæ°æ®æè¢«è®¿é®ï¼å°±ä¼å¯¼è´è¿ä¸ªç­ç¹æ°æ®è¢«æ·æ±°ã\n * lfu (less frequently used) - æè¿æå°é¢çä½¿ç¨ãå¨è¿ç§ç®æ³ä¸­åå¯¹ä¸é¢è¿è¡äºä¼åï¼å©ç¨é¢å¤çç©ºé´è®°å½æ¯ä¸ªæ°æ®çä½¿ç¨é¢çï¼ç¶åéåºé¢çæä½è¿è¡æ·æ±°ãè¿æ ·å°±é¿åäº lru ä¸è½å¤çæ¶é´æ®µçé®é¢ã\n\nè¿ä¸ç§ç¼å­æ·æ±°ç®æ³ï¼å®ç°å¤æåº¦ä¸ä¸ªæ¯ä¸ä¸ªé«ï¼åæ ·çå½ä¸­çä¹æ¯ä¸ä¸ªæ¯ä¸ä¸ªå¥½ãèæä»¬ä¸è¬æ¥è¯´éæ©çæ¹æ¡å±ä¸­å³å¯ï¼å³å®ç°ææ¬ä¸æ¯å¤ªé«ï¼èå½ä¸­çä¹è¿è¡ç lruã\n\n\n# 2. ç¼å­çåç±»\n\nç¼å­ä»é¨ç½²è§åº¦ï¼å¯ä»¥åä¸ºå®¢æ·ç«¯ç¼å­åæå¡ç«¯ç¼å­ã\n\nå®¢æ·ç«¯ç¼å­\n\n * http ç¼å­ï¼http/1.1 ä¸­ç cache-controlãhttp/1 ä¸­ç expires\n * æµè§å¨ç¼å­ï¼html5 æä¾ç sessionstorage å localstorageãcookie\n * app ç¼å­\n   * android\n   * ios\n\næå¡ç«¯ç¼å­\n\n * cdn ç¼å­ - å­æ¾ htmlãcssãjs ç­éæèµæºã\n * ååä»£çç¼å­ - å¨éåç¦»ï¼åªç¼å­ç¨æ·è¯·æ±çéæèµæºã\n * æ°æ®åºç¼å­ - æ°æ®åºï¼å¦ mysqlï¼èªèº«ä¸è¬ä¹æç¼å­ï¼ä½å ä¸ºå½ä¸­çåæ´æ°é¢çé®é¢ï¼ä¸æ¨èä½¿ç¨ã\n * è¿ç¨åç¼å­ - ç¼å­åºç¨å­å¸ç­å¸¸ç¨æ°æ®ã\n * åå¸å¼ç¼å­ - ç¼å­æ°æ®åºä¸­çç­ç¹æ°æ®ã\n\n> å¶ä¸­ï¼cdn ç¼å­ãååä»£çç¼å­ãæ°æ®åºç¼å­ä¸è¬ç±ä¸èäººåç»´æ¤ï¼è¿ç»´ãdbaï¼ã\n> \n> åç«¯å¼åä¸è¬èç¦äºè¿ç¨åç¼å­ãåå¸å¼ç¼å­ã\n\n\n# 2.1. http ç¼å­\n\n 1. æµè§å¨åéè¯·æ±åï¼æ ¹æ®è¯·æ±å¤´ç expires (http/1) å cache-control (http/1.1) å¤æ­æ¯å¦å½ä¸­ï¼åæ¬æ¯å¦è¿æï¼å¼ºç¼å­ç­ç¥ï¼\n    \n    1. å¦æå½ä¸­ï¼ç´æ¥ä»ç¼å­è·åèµæºï¼å¹¶ä¸ä¼åéè¯·æ±ã\n    2. å¦ææ²¡æå½ä¸­ï¼åè¿å¥ä¸ä¸æ­¥ã\n\n 2. æ²¡æå½ä¸­å¼ºç¼å­è§åï¼æµè§å¨ä¼åéè¯·æ±ï¼æ ¹æ®è¯·æ±å¤´ç last-modified å etag å¤æ­æ¯å¦å½ä¸­ååç¼å­ï¼å¦æå½ä¸­ï¼ç´æ¥ä»ç¼å­è·åèµæºãå¦ææ²¡æå½ä¸­ï¼åè¿å¥ä¸ä¸æ­¥ã\n\n 3. å¦æåä¸¤æ­¥é½æ²¡æå½ä¸­ï¼åç´æ¥ä»æå¡ç«¯è·åèµæºã\n\n\n# 2.2. cdn ç¼å­\n\n> cdn å°æ°æ®ç¼å­å°ç¦»ç¨æ·ç©çè·ç¦»æè¿çæå¡å¨ï¼ä½¿å¾ç¨æ·å¯ä»¥å°±è¿è·åè¯·æ±åå®¹ãcdn ä¸è¬ç¼å­éæèµæºæä»¶ï¼é¡µé¢ï¼èæ¬ï¼å¾çï¼è§é¢ï¼æä»¶ç­ï¼ã\n> \n> å½åç½ç»å¼å¸¸å¤æï¼è·¨è¿è¥åçç½ç»è®¿é®ä¼å¾æ¢ãä¸ºäºè§£å³è·¨è¿è¥åæåå°ç¨æ·è®¿é®é®é¢ï¼å¯ä»¥å¨éè¦çåå¸ï¼é¨ç½² cdn åºç¨ãä½¿ç¨æ·å°±è¿è·åæéåå®¹ï¼éä½ç½ç»æ¥å¡ï¼æé«ç¨æ·è®¿é®ååºéåº¦åå½ä¸­çã\n\n\n\n# 2.2.1. cdn åç\n\ncdn çåºæ¬åçæ¯å¹¿æ³éç¨åç§ç¼å­æå¡å¨ï¼å°è¿äºç¼å­æå¡å¨åå¸å°ç¨æ·è®¿é®ç¸å¯¹éä¸­çå°åºæç½ç»ä¸­ï¼å¨ç¨æ·è®¿é®ç½ç«æ¶ï¼å©ç¨å¨å±è´è½½ææ¯å°ç¨æ·çè®¿é®æåè·ç¦»æè¿çå·¥ä½æ­£å¸¸çç¼å­æå¡å¨ä¸ï¼ç±ç¼å­æå¡å¨ç´æ¥ååºç¨æ·è¯·æ±ã\n\nï¼1ï¼æªé¨ç½² cdn åºç¨åçç½ç»è·¯å¾ï¼\n\n * è¯·æ±ï¼æ¬æºç½ç»ï¼å±åç½ï¼=> è¿è¥åç½ç» => åºç¨æå¡å¨æºæ¿\n * ååºï¼åºç¨æå¡å¨æºæ¿ => è¿è¥åç½ç» => æ¬æºç½ç»ï¼å±åç½ï¼\n\nå¨ä¸èèå¤æç½ç»çæåµä¸ï¼ä»è¯·æ±å°ååºéè¦ç»è¿ 3 ä¸ªèç¹ï¼6 ä¸ªæ­¥éª¤å®æä¸æ¬¡ç¨æ·è®¿é®æä½ã\n\nï¼2ï¼é¨ç½² cdn åºç¨åç½ç»è·¯å¾ï¼\n\n * è¯·æ±ï¼æ¬æºç½ç»ï¼å±åç½ï¼ => è¿è¥åç½ç»\n * ååºï¼è¿è¥åç½ç» => æ¬æºç½ç»ï¼å±åç½ï¼\n\nå¨ä¸èèå¤æç½ç»çæåµä¸ï¼ä»è¯·æ±å°ååºéè¦ç»è¿ 2 ä¸ªèç¹ï¼2 ä¸ªæ­¥éª¤å®æä¸æ¬¡ç¨æ·è®¿é®æä½ã\n\nä¸ä¸é¨ç½² cdn æå¡ç¸æ¯ï¼åå°äº 1 ä¸ªèç¹ï¼4 ä¸ªæ­¥éª¤çè®¿é®ãæå¤§çæé«äºç³»ç»çååºéåº¦ã\n\n# 2.2.2. cdn ç¹ç¹\n\nä¼ç¹\n\n * æ¬å° cache å é - æåè®¿é®éåº¦ï¼å°¤å¶å«æå¤§éå¾çåéæé¡µé¢ç«ç¹ï¼\n * å®ç°è·¨è¿è¥åçç½ç»å é - æ¶é¤äºä¸åè¿è¥åä¹é´äºèçç¶é¢é æçå½±åï¼å®ç°äºè·¨è¿è¥åçç½ç»å éï¼ä¿è¯ä¸åç½ç»ä¸­çç¨æ·é½è½å¾å°è¯å¥½çè®¿é®è´¨éï¼\n * è¿ç¨å é - è¿ç¨è®¿é®ç¨æ·æ ¹æ® dns è´è½½åè¡¡ææ¯æºè½èªå¨éæ© cache æå¡å¨ï¼éæ©æå¿«ç cache æå¡å¨ï¼å å¿«è¿ç¨è®¿é®çéåº¦ï¼\n * å¸¦å®½ä¼å - èªå¨çææå¡å¨çè¿ç¨ mirrorï¼éåï¼cache æå¡å¨ï¼è¿ç¨ç¨æ·è®¿é®æ¶ä» cache æå¡å¨ä¸è¯»åæ°æ®ï¼åå°è¿ç¨è®¿é®çå¸¦å®½ãåæç½ç»æµéãåè½»åç«ç¹ web æå¡å¨è´è½½ç­åè½ã\n * éç¾¤ææ»å» - å¹¿æ³åå¸ç cdn èç¹å ä¸èç¹ä¹é´çæºè½åä½æºå¶ï¼å¯ä»¥ææå°é¢é²é»å®¢å¥ä¾µä»¥åéä½åç§ d.d.o.s æ»å»å¯¹ç½ç«çå½±åï¼åæ¶ä¿è¯è¾å¥½çæå¡è´¨éã\n\nç¼ºç¹\n\n * ä¸éå®ç¼å­å¨æèµæº\n   * è§£å³æ¹æ¡ï¼ä¸»è¦ç¼å­éæèµæºï¼å¨æèµæºå»ºç«å¤çº§ç¼å­æåå®æ¶åæ­¥ï¼\n * å­å¨æ°æ®çä¸è´æ§é®é¢\n   * è§£å³æ¹æ¡ï¼ä¸»è¦æ¯å¨æ§è½åæ°æ®ä¸è´æ§äºèé´å¯»æ¾ä¸ä¸ªå¹³è¡¡ï¼\n   * è®¾ç½®ç¼å­å¤±ææ¶é´ï¼1 ä¸ªå°æ¶ï¼è¿æååæ­¥æ°æ®ï¼ã\n   * éå¯¹èµæºè®¾ç½®çæ¬å·ã\n\n\n# 2.3. ååä»£çç¼å­\n\n> ååä»£çï¼reverse proxyï¼æ¹å¼æ¯æä»¥ä»£çæå¡å¨æ¥æ¥å internet ä¸çè¿æ¥è¯·æ±ï¼ç¶åå°è¯·æ±è½¬åç»åé¨ç½ç»ä¸çæå¡å¨ï¼å¹¶å°ä»æå¡å¨ä¸å¾å°çç»æè¿åç» internet ä¸è¯·æ±è¿æ¥çå®¢æ·ç«¯ï¼æ­¤æ¶ä»£çæå¡å¨å¯¹å¤å°±è¡¨ç°ä¸ºä¸ä¸ªååä»£çæå¡å¨ã\n\n\n\n# 2.3.1. ååä»£çç¼å­åç\n\nååä»£çä½äºåºç¨æå¡å¨åä¸ç½ç»ï¼å¤çææå¯¹ web æå¡å¨çè¯·æ±ã\n\nååä»£çç¼å­çåçï¼\n\n * å¦æç¨æ·è¯·æ±çé¡µé¢å¨ä»£çæå¡å¨ä¸æç¼å­çè¯ï¼ä»£çæå¡å¨ç´æ¥å°ç¼å­åå®¹åéç»ç¨æ·ã\n * å¦ææ²¡æç¼å­ååå web æå¡å¨ååºè¯·æ±ï¼ååæ°æ®ï¼æ¬å°ç¼å­åååéç»ç¨æ·ã\n\nè¿ç§æ¹å¼éè¿éä½å web æå¡å¨çè¯·æ±æ°ï¼ä»èéä½äº web æå¡å¨çè´è½½ã\n\nååä»£çç¼å­ä¸è¬éå¯¹çæ¯éæèµæºï¼èå°å¨æèµæºè¯·æ±è½¬åå°åºç¨æå¡å¨å¤çãå¸¸ç¨çç¼å­åºç¨æå¡å¨æ varnishï¼ngnixï¼squidã\n\n# 2.3.2. ååä»£çç¼å­æ¯è¾\n\nå¸¸ç¨çä»£çç¼å­æ varnishï¼squidï¼ngnixï¼ç®åæ¯è¾å¦ä¸ï¼\n\n * varnish å squid æ¯ä¸ä¸ç cache æå¡ï¼ngnix éè¦ç¬¬ä¸æ¹æ¨¡åæ¯æï¼\n * varnish éç¨åå­åç¼å­ï¼é¿åäºé¢ç¹å¨åå­ãç£çä¸­äº¤æ¢æä»¶ï¼æ§è½æ¯ squid é«ï¼\n * varnish ç±äºæ¯åå­ cacheï¼æä»¥å¯¹å°æä»¶å¦ cssãjsãå°å¾ççæ¯æå¾æ£ï¼åç«¯çæä¹åç¼å­å¯ä»¥éç¨çæ¯ squid æ atsï¼\n * squid åè½å¨èå¤§ï¼éåäºåç§éæçæä»¶ç¼å­ï¼ä¸è¬ä¼å¨åç«¯æä¸ä¸ª haproxy æ ngnix åè´è½½åè¡¡è·å¤ä¸ªå®ä¾ï¼\n * nginx éç¨ç¬¬ä¸æ¹æ¨¡å ncache åçç¼å²ï¼æ§è½åºæ¬è¾¾å° varnishï¼ä¸è¬ä½ä¸ºååä»£çä½¿ç¨ï¼å¯ä»¥å®ç°ç®åçç¼å­ã\n\n\n# 3. è¿ç¨åç¼å­\n\n> è¿ç¨åç¼å­æ¯æåºç¨åé¨çç¼å­ï¼æ åçåå¸å¼ç³»ç»ï¼ä¸è¬æå¤çº§ç¼å­ææãæ¬å°ç¼å­æ¯ç¦»åºç¨æè¿çç¼å­ï¼ä¸è¬å¯ä»¥å°æ°æ®ç¼å­å°ç¡¬çæåå­ã\n\n * ç¡¬çç¼å­ - å°æ°æ®ç¼å­å°ç¡¬çä¸­ï¼è¯»åæ¶ä»ç¡¬çè¯»åãåçæ¯ç´æ¥è¯»åæ¬æºæä»¶ï¼åå°äºç½ç»ä¼ è¾æ¶èï¼æ¯éè¿ç½ç»è¯»åæ°æ®åºéåº¦æ´å¿«ãå¯ä»¥åºç¨å¨å¯¹éåº¦è¦æ±ä¸æ¯å¾é«ï¼ä½éè¦å¤§éç¼å­å­å¨çåºæ¯ã\n * åå­ç¼å­ - ç´æ¥å°æ°æ®å­å¨å°æ¬æºåå­ä¸­ï¼éè¿ç¨åºç´æ¥ç»´æ¤ç¼å­å¯¹è±¡ï¼æ¯è®¿é®éåº¦æå¿«çæ¹å¼ã\n\nå¸¸è§çæ¬å°ç¼å­å®ç°æ¹æ¡ï¼hashmapãguava cacheãcaffeineãehcacheã\n\n\n# 3.1. concurrenthashmap\n\næç®åçè¿ç¨åç¼å­å¯ä»¥éè¿ jdk èªå¸¦ç hashmap æ concurrenthashmap å®ç°ã\n\néç¨åºæ¯ï¼ä¸éè¦æ·æ±°çç¼å­æ°æ®ã\n\nç¼ºç¹ï¼æ æ³è¿è¡ç¼å­æ·æ±°ï¼åå­ä¼æ éå¶çå¢é¿ã\n\n\n# 3.2. lruhashmap\n\nå¯ä»¥éè¿ç»§æ¿ linkedhashmap æ¥å®ç°ä¸ä¸ªç®åç lruhashmapãéå removeeldestentry æ¹æ³ï¼å³å¯å®æä¸ä¸ªç®åçæè¿æå°ä½¿ç¨ç®æ³ã\n\nç¼ºç¹ï¼\n\n * éç«äºä¸¥éï¼æ§è½æ¯è¾ä½ã\n * ä¸æ¯æè¿ææ¶é´\n * ä¸æ¯æèªå¨å·æ°\n\n\n# 3.3. guava cache\n\nè§£å³äº lruhashmap ä¸­çå ä¸ªç¼ºç¹ã\n\nguava cache éç¨äºç±»ä¼¼ concurrenthashmap çææ³ï¼åæ®µå éï¼åå°éç«äºã\n\nguava cache å¯¹äºè¿æç entry å¹¶æ²¡æé©¬ä¸è¿æ(ä¹å°±æ¯å¹¶æ²¡æåå°çº¿ç¨ä¸ç´å¨æ«)ï¼èæ¯éè¿è¿è¡è¯»åæä½çæ¶åè¿è¡è¿æå¤çï¼è¿æ ·åçå¥½å¤æ¯é¿ååå°çº¿ç¨æ«æçæ¶åè¿è¡å¨å±å éã\n\nç´æ¥éè¿æ¥è¯¢ï¼å¤æ­å¶æ¯å¦æ»¡è¶³å·æ°æ¡ä»¶ï¼è¿è¡å·æ°ã\n\n\n# 3.4. caffeine\n\ncaffeine å®ç°äº w-tinylfu(lfu + lru ç®æ³çåç§)ï¼å¶å½ä¸­çåè¯»åååéå¤§å¤§ä¼äº guava cacheã\n\nå¶å®ç°åçè¾å¤æï¼å¯ä»¥åèä½ åºè¯¥ç¥éçç¼å­è¿åå²ã\n\n\n# 3.5. ehcache\n\nehcache æ¯ä¸ä¸ªçº¯ java çè¿ç¨åç¼å­æ¡æ¶ï¼å·æå¿«éãç²¾å¹²ç­ç¹ç¹ï¼æ¯ hibernate ä¸­é»è®¤ç cacheproviderã\n\nä¼ç¹\n\n * å¿«éãç®å\n * æ¯æå¤ç§ç¼å­ç­ç¥ï¼lruãlfuãfifo æ·æ±°ç®æ³\n * ç¼å­æ°æ®æä¸¤çº§ï¼åå­åç£çï¼å æ­¤æ éæå¿å®¹éé®é¢\n * ç¼å­æ°æ®ä¼å¨èææºéå¯çè¿ç¨ä¸­åå¥ç£ç\n * å¯ä»¥éè¿ rmiãå¯æå¥ api ç­æ¹å¼è¿è¡åå¸å¼ç¼å­\n * å·æç¼å­åç¼å­ç®¡çå¨çä¾¦å¬æ¥å£\n * æ¯æå¤ç¼å­ç®¡çå¨å®ä¾ï¼ä»¥åä¸ä¸ªå®ä¾çå¤ä¸ªç¼å­åºå\n * æä¾ hibernate çç¼å­å®ç°\n\nç¼ºç¹\n\n * ä½¿ç¨ç£ç cache çæ¶åéå¸¸å ç¨ç£çç©ºé´\n * ä¸ä¿è¯æ°æ®çå®å¨\n * è½ç¶æ¯æåå¸å¼ç¼å­ï¼ä½æçä¸é«ï¼éè¿ç»æ­æ¹å¼ï¼å¨ä¸åèç¹ä¹é´åæ­¥æ°æ®ï¼ã\n\n\n# 3.6. è¿ç¨åç¼å­å¯¹æ¯\n\nå¸¸ç¨è¿ç¨åç¼å­ææ¯å¯¹æ¯ï¼\n\næ¯è¾é¡¹      concurrenthashmap   lrumap                ehcache                 guava cache             caffeine\nè¯»åæ§è½     å¾å¥½ï¼åæ®µé              ä¸è¬ï¼å¨å±å é               å¥½                       å¥½ï¼éè¦åæ·æ±°æä½               å¾å¥½\næ·æ±°ç®æ³     æ                    lruï¼ä¸è¬                æ¯æå¤ç§æ·æ±°ç®æ³,lru,lfu,fifo   lruï¼ä¸è¬                  w-tinylfu, å¾å¥½\nåè½ä¸°å¯ç¨åº¦   åè½æ¯è¾ç®å              åè½æ¯è¾åä¸                åè½å¾ä¸°å¯                   åè½å¾ä¸°å¯ï¼æ¯æå·æ°åèå¼ç¨ç­         åè½å guava cache ç±»ä¼¼\nå·¥å·å¤§å°     jdk èªå¸¦ç±»ï¼å¾å°          åºäº linkedhashmapï¼è¾å°   å¾å¤§ï¼ææ°çæ¬ 1.4mb           æ¯ guava å·¥å·ç±»ä¸­çä¸ä¸ªå°é¨åï¼è¾å°   ä¸è¬ï¼ææ°çæ¬ 644kb\næ¯å¦æä¹å    å¦                   å¦                     æ¯                       å¦                       å¦\næ¯å¦æ¯æéç¾¤   å¦                   å¦                     æ¯                       å¦                       å¦\n\n * concurrenthashmap - æ¯è¾éåç¼å­æ¯è¾åºå®ä¸åçåç´ ï¼ä¸ç¼å­çæ°éè¾å°çãè½ç¶ä»ä¸é¢è¡¨æ ¼ä¸­æ¯èµ·æ¥æç¹éè²ï¼ä½æ¯å¶ç±äºæ¯ jdk èªå¸¦çç±»ï¼å¨åç§æ¡æ¶ä¸­ä¾ç¶æå¤§éçä½¿ç¨ï¼æ¯å¦æä»¬å¯ä»¥ç¨æ¥ç¼å­æä»¬åå°ç methodï¼field ç­ç­ï¼ä¹å¯ä»¥ç¼å­ä¸äºé¾æ¥ï¼é²æ­¢å¶éå¤å»ºç«ãå¨ caffeine ä¸­ä¹æ¯ä½¿ç¨ç concurrenthashmap æ¥å­å¨åç´ ã\n * lrumap - å¦æä¸æ³å¼å¥ç¬¬ä¸æ¹åï¼åæ³ä½¿ç¨æ·æ±°ç®æ³æ·æ±°æ°æ®ï¼å¯ä»¥ä½¿ç¨è¿ä¸ªã\n * ehcache - ç±äºå¶ jar åå¾å¤§ï¼è¾ééçº§ãå¯¹äºéè¦æä¹ååéç¾¤çä¸äºåè½çï¼å¯ä»¥éæ© ehcacheãéè¦æ³¨æçæ¯ï¼è½ç¶ ehcache ä¹æ¯æåå¸å¼ç¼å­ï¼ä½æ¯ç±äºå¶èç¹é´éä¿¡æ¹å¼ä¸º rmiï¼è¡¨ç°ä¸å¦ redisï¼æä»¥ä¸è¬ä¸å»ºè®®ç¨å®æ¥ä½ä¸ºåå¸å¼ç¼å­ã\n * guava cache - guava è¿ä¸ª jar åå¨å¾å¤ java åºç¨ç¨åºä¸­é½æå¤§éçå¼å¥ï¼æä»¥å¾å¤æ¶åå¶å®æ¯ç´æ¥ç¨å°±å¥½äºï¼å¹¶ä¸å¶æ¬èº«æ¯è½»éçº§çèä¸åè½è¾ä¸ºä¸°å¯ï¼å¨ä¸äºè§£ caffeine çæåµä¸å¯ä»¥éæ© guava cacheã\n * caffeine - å¶å¨å½ä¸­çï¼è¯»åæ§è½ä¸é½æ¯ guava cache å¥½å¾å¤ï¼å¹¶ä¸å¶ api å guava cache åºæ¬ä¸è´ï¼çè³ä¼å¤ä¸ç¹ãå¨çå®ç¯å¢ä¸­ä½¿ç¨ caffeineï¼åå¾è¿ä¸éçææã\n\næ»ç»ä¸ä¸ï¼å¦æä¸éè¦æ·æ±°ç®æ³åéæ© concurrenthashmapï¼å¦æéè¦æ·æ±°ç®æ³åä¸äºä¸°å¯ç apiï¼æ¨èéæ© caffeineã\n\n\n# 4. åå¸å¼ç¼å­\n\n> åå¸å¼ç¼å­è§£å³äºè¿ç¨åç¼å­æå¤§çé®é¢ï¼å¦æåºç¨æ¯åå¸å¼ç³»ç»ï¼èç¹ä¹é´æ æ³å±äº«å½¼æ­¤çè¿ç¨åç¼å­ã\n> \n> åå¸å¼ç¼å­çåºç¨åºæ¯ï¼\n> \n>  * ç¼å­ç»è¿å¤æè®¡ç®å¾å°çæ°æ®\n>  * ç¼å­ç³»ç»ä¸­é¢ç¹è®¿é®çç­ç¹æ°æ®ï¼åè½»æ°æ®åºåå\n\nä¸ååå¸å¼ç¼å­çå®ç°åçå¾å¾ææ¯è¾å¤§çå·®å¼ãæ¬æä¸»è¦éå¯¹ memcached å redis è¿è¡è¯´æã\n\n\n# 4.1. memcached\n\n> memcached æ¯ä¸ä¸ªé«æ§è½ï¼åå¸å¼åå­å¯¹è±¡ç¼å­ç³»ç»ï¼éè¿å¨åå­éç»´æ¤ä¸ä¸ªç»ä¸çå·¨å¤§ç hash è¡¨ï¼å®è½å¤ç¨æ¥å­å¨åç§æ ¼å¼çæ°æ®ï¼åæ¬å¾åãè§é¢ãæä»¶ä»¥åæ°æ®åºæ£ç´¢çç»æç­ã\n> \n> ç®åçè¯´å°±æ¯ï¼å°æ°æ®ç¼å­å°åå­ä¸­ï¼ç¶åä»åå­ä¸­è¯»åï¼ä»èå¤§å¤§æé«è¯»åéåº¦ã\n\n# 4.1.1. memcached ç¹æ§\n\n * ä½¿ç¨ç©çåå­ä½ä¸ºç¼å­åºï¼å¯ç¬ç«è¿è¡å¨æå¡å¨ä¸ãæ¯ä¸ªè¿ç¨æå¤§ 2gï¼å¦ææ³ç¼å­æ´å¤çæ°æ®ï¼å¯ä»¥å¼è¾æ´å¤ç memcached è¿ç¨ï¼ä¸åç«¯å£ï¼æèä½¿ç¨åå¸å¼ memcached è¿è¡ç¼å­ï¼å°æ°æ®ç¼å­å°ä¸åçç©çæºæèèææºä¸ã\n * ä½¿ç¨ key-value çæ¹å¼æ¥å­å¨æ°æ®ãè¿æ¯ä¸ç§åç´¢å¼çç»æåæ°æ®ç»ç»å½¢å¼ï¼å¯ä½¿æ°æ®é¡¹æ¥è¯¢æ¶é´å¤æåº¦ä¸º o(1)ã\n * åè®®ç®åï¼åºäºææ¬è¡çåè®®ãç´æ¥éè¿ telnet å¨ memcached æå¡å¨ä¸å¯è¿è¡å­åæ°æ®æä½ï¼ç®åï¼æ¹ä¾¿å¤ç§ç¼å­åèæ­¤åè®®ï¼\n * åºäº libevent é«æ§è½éä¿¡ãlibevent æ¯ä¸å¥å©ç¨ c å¼åçç¨åºåºï¼å®å° bsd ç³»ç»ç kqueue,linux ç³»ç»ç epoll ç­äºä»¶å¤çåè½å°è£æä¸ä¸ªæ¥å£ï¼ä¸ä¼ ç»ç select ç¸æ¯ï¼æé«äºæ§è½ã\n * åå¸å¼è½ååå³äº memcached å®¢æ·ç«¯ï¼æå¡å¨ä¹é´äºä¸éä¿¡ãåä¸ª memcached æå¡å¨ä¹é´äºä¸éä¿¡ï¼åèªç¬ç«å­åæ°æ®ï¼ä¸å±äº«ä»»ä½ä¿¡æ¯ãæå¡å¨å¹¶ä¸å·æåå¸å¼åè½ï¼åå¸å¼é¨ç½²åå³äº memcached å®¢æ·ç«¯ã\n * éç¨ lru ç¼å­æ·æ±°ç­ç¥ãå¨ memcached åå­å¨æ°æ®é¡¹æ¶ï¼å¯ä»¥æå®å®å¨ç¼å­çå¤±ææ¶é´ï¼é»è®¤ä¸ºæ°¸ä¹ãå½ memcached æå¡å¨ç¨å®åéçåæ¶ï¼å¤±æçæ°æ®è¢«é¦åæ¿æ¢ï¼ç¶åä¹æ¯æè¿æªä½¿ç¨çæ°æ®ãå¨ lru ä¸­ï¼memcached ä½¿ç¨çæ¯ä¸ç§ lazy expiration ç­ç¥ï¼èªå·±ä¸ä¼çæ§å­å¥ç key/vlue å¯¹æ¯å¦è¿æï¼èæ¯å¨è·å key å¼æ¶æ¥çè®°å½çæ¶é´æ³ï¼æ£æ¥ key/value å¯¹ç©ºé´æ¯å¦è¿æï¼è¿æ ·å¯åè½»æå¡å¨çè´è½½ã\n * åç½®äºä¸å¥é«æçåå­ç®¡çç®æ³ãè¿å¥åå­ç®¡çæçå¾é«ï¼èä¸ä¸ä¼é æåå­ç¢çï¼ä½æ¯å®æå¤§çç¼ºç¹å°±æ¯ä¼å¯¼è´ç©ºé´æµªè´¹ãå½åå­æ»¡åï¼éè¿ lru ç®æ³èªå¨å é¤ä¸ä½¿ç¨çç¼å­ã\n * ä¸æ¯ææä¹åãmemcached æ²¡æèèæ°æ®çå®¹ç¾é®é¢ï¼éå¯æå¡ï¼æææ°æ®ä¼ä¸¢å¤±ã\n\n# 4.1.2. memcached å·¥ä½åç\n\nï¼1ï¼åå­ç®¡ç\n\nmemcached å©ç¨ slab allocation æºå¶æ¥åéåç®¡çåå­ï¼å®æç§é¢åè§å®çå¤§å°ï¼å°åéçåå­åå²æç¹å®é¿åº¦çåå­åï¼åæå°ºå¯¸ç¸åçåå­ååæç»ï¼æ°æ®å¨å­æ¾æ¶ï¼æ ¹æ®é®å¼ å¤§å°å»å¹é slab å¤§å°ï¼æ¾å°±è¿ç slab å­æ¾ï¼æä»¥å­å¨ç©ºé´æµªè´¹ç°è±¡ã\n\nè¿å¥åå­ç®¡çæçå¾é«ï¼èä¸ä¸ä¼é æåå­ç¢çï¼ä½æ¯å®æå¤§çç¼ºç¹å°±æ¯ä¼å¯¼è´ç©ºé´æµªè´¹ã\n\nï¼2ï¼ç¼å­æ·æ±°ç­ç¥\n\nmemcached çç¼å­æ·æ±°ç­ç¥æ¯ lru + å°æå¤±æç­ç¥ã\n\nå½ä½ å¨ memcached åå­å¨æ°æ®é¡¹æ¶ï¼ä½ æå¯è½ä¼æå®å®å¨ç¼å­çå¤±ææ¶é´ï¼é»è®¤ä¸ºæ°¸ä¹ãå½ memcached æå¡å¨ç¨å®åéçåæ¶ï¼å¤±æçæ°æ®è¢«é¦åæ¿æ¢ï¼ç¶åæ¯æè¿æªä½¿ç¨çæ°æ®ã\n\nå¨ lru ä¸­ï¼memcached ä½¿ç¨çæ¯ä¸ç§ lazy expiration ç­ç¥ï¼memcached ä¸ä¼çæ§å­å¥ç key/vlue å¯¹æ¯å¦è¿æï¼èæ¯å¨è·å key å¼æ¶æ¥çè®°å½çæ¶é´æ³ï¼æ£æ¥ key/value å¯¹ç©ºé´æ¯å¦è¿æï¼è¿æ ·å¯åè½»æå¡å¨çè´è½½ã\n\nï¼3ï¼ååº\n\nmemcached æå¡å¨ä¹é´å½¼æ­¤ä¸éä¿¡ï¼å®çåå¸å¼è½åæ¯ä¾èµå®¢æ·ç«¯æ¥å®ç°ã\n\nå·ä½æ¥è¯´ï¼å°±æ¯å¨å®¢æ·ç«¯å®ç°ä¸ç§ç®æ³ï¼æ ¹æ® key æ¥è®¡ç®åºæ°æ®åºè¯¥ååªä¸ªæå¡å¨èç¹è¯»/åã\n\nèè¿ç§éåéç¾¤èç¹çç®æ³å¸¸è§çæä¸ç§ï¼\n\n * åå¸åä½ç®æ³ - ä½¿ç¨å¬å¼ï¼hashï¼keyï¼% n è®¡ç®åº åå¸å¼ æ¥å³å®æ°æ®æ å°å°åªä¸ä¸ªèç¹ã\n * ä¸è´æ§åå¸ç®æ³ - å¯ä»¥å¾å¥½çè§£å³ ç¨³å®æ§é®é¢ï¼å¯ä»¥å°ææç å­å¨èç¹ æåå¨ é¦å°¾ç¸æ¥ ç hash ç¯ä¸ï¼æ¯ä¸ª key å¨è®¡ç® hash åä¼ é¡ºæ¶é æ¾å° ä¸´æ¥ ç å­å¨èç¹ å­æ¾ãèå½æèç¹ å å¥ æ éåº æ¶ï¼ä»å½±åè¯¥èç¹å¨ hash ç¯ä¸ é¡ºæ¶éç¸é» ç åç»­èç¹ã\n * èæ hash æ§½ç®æ³ - ä½¿ç¨ åæ£åº¦è¯å¥½ ç åå¸å½æ° ææææ°æ® æ å° å°ä¸ä¸ª åºå®èå´ ç æ´æ°éå ä¸­ï¼æ´æ°å®ä¹ä¸º æ§½ï¼slotï¼ï¼è¿ä¸ªèå´ä¸è¬ è¿è¿å¤§äº èç¹æ°ãæ§½ æ¯éç¾¤å æ°æ®ç®¡ç å è¿ç§» ç åºæ¬åä½ãéç¨ å¤§èå´æ§½ çä¸»è¦ç®çæ¯ä¸ºäºæ¹ä¾¿ æ°æ®æå å éç¾¤æ©å±ãæ¯ä¸ªèç¹ä¼è´è´£ ä¸å®æ°éçæ§½ã\n\n\n# 4.2. redis\n\n> redis æ¯ä¸ä¸ªå¼æºï¼bsd è®¸å¯ï¼çï¼åºäºåå­çï¼å¤æ°æ®ç»æå­å¨ç³»ç»ãå¯ä»¥ç¨ä½æ°æ®åºãç¼å­åæ¶æ¯ä¸­é´ä»¶ã\n> \n> redis è¿å¯ä»¥ä½¿ç¨å®¢æ·ç«¯åçæ¥æ©å±åæ§è½ãåç½®äº å¤å¶ï¼replicationï¼ï¼lua èæ¬ï¼lua scriptingï¼ï¼lru é©±å¨äºä»¶ï¼lru evictionï¼ï¼äºå¡ï¼transactionsï¼ åä¸åçº§å«ç ç£çæä¹åï¼persistenceï¼ï¼ å¹¶éè¿ redis å¨åµï¼sentinelï¼åèªå¨ååºï¼clusterï¼æä¾é«å¯ç¨æ§ï¼high availabilityï¼ã\n\n# 4.2.1. redis ç¹æ§\n\n * æ¯æå¤ç§æ°æ®ç±»å - stringãhashãlistãsetãsorted setã\n\n * æ¯æå¤ç§æ°æ®æ·æ±°ç­ç¥\n   \n   * volatile-lru - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n   * volatile-ttl - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­æéå°è¦è¿æçæ°æ®æ·æ±°\n   * volatile-random - ä»å·²è®¾ç½®è¿ææ¶é´çæ°æ®éä¸­ä»»æéæ©æ°æ®æ·æ±°\n   * allkeys-lru - ä»æææ°æ®éä¸­æéæè¿æå°ä½¿ç¨çæ°æ®æ·æ±°\n   * allkeys-random - ä»æææ°æ®éä¸­ä»»æéæ©æ°æ®è¿è¡æ·æ±°\n   * noeviction - ç¦æ­¢é©±éæ°æ®\n\n * æä¾ä¸¤ç§æä¹åæ¹å¼ - rdb å aof\n\n * éè¿ redis cluster æä¾éç¾¤æ¨¡å¼ã\n\n# 4.2.2. redis åç\n\n * ç¼å­æ·æ±°\n   * redis æä¸¤ç§æ°æ®æ·æ±°å®ç°\n     * æ¶ææ¹å¼ - è®¿é® redis key æ¶ï¼å¦æåç°å®å·²ç»å¤±æï¼åå é¤å®\n     * ç§¯ææ¹å¼ - å¨ææ§ä»è®¾ç½®äºå¤±ææ¶é´ç key ä¸­ï¼æ ¹æ®æ·æ±°ç­ç¥ï¼éæ©ä¸é¨åå¤±æç key è¿è¡å é¤ã\n * ååº\n   * redis cluster éç¾¤åå« 16384 ä¸ªèæ hash æ§½ï¼å®éè¿ä¸ä¸ªé«æçç®æ³æ¥è®¡ç® key å±äºåªä¸ª hash æ§½ã\n   * redis cluster æ¯æè¯·æ±åå - èç¹å¨æ¥å°ä¸ä¸ªå½ä»¤è¯·æ±æ¶ï¼ä¼åæ£æµè¿ä¸ªå½ä»¤è¯·æ±è¦å¤ççé®æå¨çæ§½æ¯å¦ç±èªå·±è´è´£ï¼å¦æä¸æ¯çè¯ï¼èç¹å°åå®¢æ·ç«¯è¿åä¸ä¸ª moved éè¯¯ï¼moved éè¯¯æºå¸¦çä¿¡æ¯å¯ä»¥æå¼å®¢æ·ç«¯å°è¯·æ±éå®åè³æ­£å¨è´è´£ç¸å³æ§½çèç¹ã\n * ä¸»ä»å¤å¶\n   * redis 2.8 åæ¯æå¼æ­¥å¤å¶ãå®æä¸¤ç§æ¨¡å¼ï¼\n     * å®æ´éåæ­¥ï¼full resychronizationï¼ - ç¨äºåæ¬¡å¤å¶ãæ§è¡æ­¥éª¤ä¸ sync å½ä»¤åºæ¬ä¸è´ã\n     * é¨åéåæ­¥ï¼partial resychronizationï¼ - ç¨äºæ­çº¿åéå¤å¶ãå¦ææ¡ä»¶åè®¸ï¼ä¸»æå¡å¨å¯ä»¥å°ä¸»ä»æå¡å¨è¿æ¥æ­å¼æé´æ§è¡çåå½ä»¤åéç»ä»æå¡å¨ï¼ä»æå¡å¨åªéæ¥æ¶å¹¶æ§è¡è¿äºåå½ä»¤ï¼å³å¯å°ä¸»ä»æå¡å¨çæ°æ®åºç¶æä¿æä¸è´ã\n   * éç¾¤ä¸­æ¯ä¸ªèç¹é½ä¼å®æåéç¾¤ä¸­çå¶ä»èç¹åé ping æ¶æ¯ï¼ä»¥æ­¤æ¥æ£æµå¯¹æ¹æ¯å¦å¨çº¿ã\n   * å¦æä¸ä¸ªä¸»èç¹è¢«è®¤ä¸ºä¸çº¿ï¼åå¨å¶ä»èç¹ä¸­ï¼æ ¹æ® raft ç®æ³ï¼éä¸¾åºä¸ä¸ªèç¹ï¼åçº§ä¸ºä¸»èç¹ã\n * æ°æ®ä¸è´æ§\n   * redis ä¸ä¿è¯å¼ºä¸è´æ§ï¼å ä¸ºè¿ä¼ä½¿å¾éç¾¤æ§è½å¤§å¤§éä½ã\n   * redis æ¯éè¿å¼æ­¥å¤å¶æ¥å®ç°æç»ä¸è´æ§ã\n\n\n# 4.3. åå¸å¼ç¼å­å¯¹æ¯\n\nä¸åçåå¸å¼ç¼å­åè½ç¹æ§åå®ç°åçæ¹é¢æå¾å¤§çå·®å¼ï¼å æ­¤ä»ä»¬æéåºçåºæ¯ä¹ææä¸åã\n\n\n\nè¿ééåä¸ä¸ªæ¯è¾åºåçåå¸å¼ç¼å­ï¼memcacheï¼redisï¼tairï¼æ¥ä½ä¸ºæ¯è¾ï¼\n\næ¯è¾é¡¹    memcache              redis                                tair\næ°æ®ç»æ   åªæ¯æç®åç key-value ç»æ   string,hash, list, set, sorted set   string,hashmap, listï¼set\næä¹å    ä¸æ¯æ                   æ¯æ                                   æ¯æ\nå®¹éå¤§å°   æ°æ®çº¯åå­ï¼æ°æ®å­å¨ä¸å®è¿å¤        æ°æ®å¨åå­ï¼èµæºææ¬èéä¸å®è¶è¿ 100gb               å¯ä»¥éç½®å¨åå­æåå­+ç£çå¼æï¼æ°æ®å®¹éå¯æ éæ©å\nè¯»åæ§è½   å¾é«                    å¾é«(rt0.5ms å·¦å³)                       string ç±»åæ¯è¾é«(rt1ms å·¦å³)ï¼å¤æç±»åæ¯è¾æ¢(rt5ms å·¦å³)\nè¿æç­ç¥   è¿æåï¼ä¸å é¤ç¼å­             æå­ç§ç­ç¥æ¥å¤çè¿ææ°æ®                         æ¯æ\n\n * memcache - åªéååºäºåå­çç¼å­æ¡æ¶ï¼ä¸ä¸æ¯ææ°æ®æä¹ååå®¹ç¾ã\n * redis - æ¯æä¸°å¯çæ°æ®ç»æï¼è¯»åæ§è½å¾é«ï¼ä½æ¯æ°æ®å¨åå­ï¼å¿é¡»è¦èèèµæºææ¬ï¼æ¯ææä¹åã\n * tair - æ¯æä¸°å¯çæ°æ®ç»æï¼è¯»åæ§è½è¾é«ï¼é¨åç±»åæ¯è¾æ¢ï¼çè®ºä¸å®¹éå¯ä»¥æ éæ©åã\n\næ»ç»ï¼å¦ææå¡å¯¹å»¶è¿æ¯è¾ææï¼map/set æ°æ®ä¹æ¯è¾å¤çè¯ï¼æ¯è¾éå redisãå¦ææå¡éè¦æ¾å¥ç¼å­éçæ°æ®å¾å¤§ï¼å¯¹å»¶è¿åä¸æ¯ç¹å«ææçè¯ï¼é£å°±å¯ä»¥éæ© memcachedã\n\n\n# 5. å¤çº§ç¼å­\n\n\n# 5.1. æ´ä½ç¼å­æ¡æ¶\n\néå¸¸ï¼ä¸ä¸ªå¤§åè½¯ä»¶ç³»ç»çç¼å­éç¨å¤çº§ç¼å­æ¹æ¡ï¼\n\n\n\nè¯·æ±è¿ç¨ï¼\n\n 1. æµè§å¨åå®¢æ·ç«¯åèµ·è¯·æ±ï¼å¦æ cdn æç¼å­åç´æ¥è¿åï¼\n 2. å¦æ cdn æ ç¼å­ï¼åè®¿é®ååä»£çæå¡å¨ï¼\n 3. å¦æååä»£çæå¡å¨æç¼å­åç´æ¥è¿åï¼\n 4. å¦æååä»£çæå¡å¨æ ç¼å­æå¨æè¯·æ±ï¼åè®¿é®åºç¨æå¡å¨ï¼\n 5. åºç¨æå¡å¨è®¿é®è¿ç¨åç¼å­ï¼å¦ææç¼å­ï¼åè¿åä»£çæå¡å¨ï¼å¹¶ç¼å­æ°æ®ï¼ï¼å¨æè¯·æ±ä¸ç¼å­ï¼\n 6. å¦æè¿ç¨åç¼å­æ æ°æ®ï¼åè¯»ååå¸å¼ç¼å­ï¼å¹¶è¿ååºç¨æå¡å¨ï¼åºç¨æå¡å¨å°æ°æ®ç¼å­å°æ¬å°ç¼å­ï¼é¨åï¼ï¼\n 7. å¦æåå¸å¼ç¼å­æ æ°æ®ï¼ååºç¨ç¨åºè¯»åæ°æ®åºæ°æ®ï¼å¹¶æ¾å¥åå¸å¼ç¼å­ï¼\n\n\n# 5.2. ä½¿ç¨è¿ç¨åç¼å­\n\nå¦æåºç¨æå¡æ¯åç¹åºç¨ï¼é£ä¹è¿ç¨åç¼å­å½ç¶æ¯ç¼å­çé¦éæ¹æ¡ã\n\nå¯¹äºè¿ç¨åç¼å­ï¼å¶æ¬æ¥åéäºåå­çå¤§å°çéå¶ï¼ä»¥åè¿ç¨ç¼å­æ´æ°åå¶ä»ç¼å­æ æ³å¾ç¥ï¼æä»¥ä¸è¬æ¥è¯´è¿ç¨ç¼å­éç¨äº:\n\n * æ°æ®éä¸æ¯å¾å¤§ä¸æ´æ°é¢çè¾ä½çæ°æ®ã\n * å¦ææ´æ°é¢ç¹çæ°æ®ï¼ä¹æ³ä½¿ç¨è¿ç¨åç¼å­ï¼é£ä¹å¯ä»¥å°å¶è¿ææ¶é´è®¾ç½®ä¸ºè¾ç­çæ¶é´ï¼æèè®¾ç½®è¾ç­çèªå¨å·æ°æ¶é´ã\n\nè¿ç§æ¹æ¡å­å¨ä»¥ä¸é®é¢ï¼\n\n * å¦æåºç¨æå¡æ¯åå¸å¼ç³»ç»ï¼åºç¨èç¹ä¹é´æ æ³å±äº«ç¼å­ï¼å­å¨æ°æ®ä¸ä¸è´é®é¢ã\n * ç±äºè¿ç¨åç¼å­åéäºåå­å¤§å°çéå¶ï¼æä»¥ç¼å­ä¸è½æ éæ©å±ã\n\n\n# 5.3. ä½¿ç¨åå¸å¼ç¼å­\n\nå¦æåºç¨æå¡æ¯åå¸å¼ç³»ç»ï¼é£ä¹æç®åçç¼å­æ¹æ¡å°±æ¯ç´æ¥ä½¿ç¨åå¸å¼ç¼å­ã\n\nå¶åºç¨åºæ¯å¦å¾æç¤ºï¼\n\n\n\nredis ç¨æ¥å­å¨ç­ç¹æ°æ®ï¼å¦æç¼å­ä¸å½ä¸­ï¼åå»æ¥è¯¢æ°æ®åºï¼å¹¶æ´æ°ç¼å­ã\n\nè¿ç§æ¹æ¡å­å¨ä»¥ä¸é®é¢ï¼\n\n 1. ç¼å­æå¡å¦ææäºï¼è¿æ¶åºç¨åªè½è®¿é®æ°æ®åºï¼å®¹æé æç¼å­éªå´©ã\n 2. è®¿é®åå¸å¼ç¼å­æå¡ä¼æä¸å®ç i/o ä»¥ååºååååºååçå¼éï¼è½ç¶æ§è½å¾é«ï¼ä½æ¯å¶ç»ç©¶æ²¡æå¨åå­ä¸­æ¥è¯¢å¿«ã\n\n\n# 5.4. ä½¿ç¨å¤çº§ç¼å­\n\nåçº¯ä½¿ç¨è¿ç¨åç¼å­ååå¸å¼ç¼å­é½å­å¨åèªçä¸è¶³ãå¦æéè¦æ´é«çæ§è½ä»¥åæ´å¥½çå¯ç¨æ§ï¼æä»¬å¯ä»¥å°ç¼å­è®¾è®¡ä¸ºå¤çº§ç»æãå°æç­çæ°æ®ä½¿ç¨è¿ç¨åç¼å­å­å¨å¨åå­ä¸­ï¼è¿ä¸æ­¥æåè®¿é®éåº¦ã\n\nè¿ä¸ªè®¾è®¡æè·¯å¨è®¡ç®æºç³»ç»ä¸­ä¹å­å¨ï¼æ¯å¦ cpu ä½¿ç¨ l1ãl2ãl3 å¤çº§ç¼å­ï¼ç¨æ¥åå°å¯¹åå­çç´æ¥è®¿é®ï¼ä»èå å¿«è®¿é®éåº¦ã\n\nä¸è¬æ¥è¯´ï¼å¤çº§ç¼å­æ¶æä½¿ç¨äºçº§ç¼å­å·²å¯ä»¥æ»¡è¶³å¤§é¨åä¸å¡éæ±ï¼è¿å¤çåçº§ä¼å¢å ç³»ç»çå¤æåº¦ä»¥åç»´æ¤çææ¬ãå æ­¤ï¼å¤çº§ç¼å­ä¸æ¯åçº§è¶å¤è¶å¥½ï¼éè¦æ ¹æ®å®éæåµè¿è¡æè¡¡ã\n\nä¸ä¸ªå¸åçäºçº§ç¼å­æ¶æï¼å¯ä»¥ä½¿ç¨è¿ç¨åç¼å­ï¼å¦ï¼ caffeine/google guava/ehcache/hashmapï¼ä½ä¸ºä¸çº§ç¼å­ï¼ä½¿ç¨åå¸å¼ç¼å­ï¼å¦ï¼redis/memcachedï¼ä½ä¸ºäºçº§ç¼å­ã\n\n# 5.4.1. å¤çº§ç¼å­æ¥è¯¢\n\n\n\nå¤çº§ç¼å­æ¥è¯¢æµç¨å¦ä¸ï¼\n\n 1. é¦åï¼æ¥è¯¢ l1 ç¼å­ï¼å¦æç¼å­å½ä¸­ï¼ç´æ¥è¿åç»æï¼å¦ææ²¡æå½ä¸­ï¼æ§è¡ä¸ä¸æ­¥ã\n 2. æ¥ä¸æ¥ï¼æ¥è¯¢ l2 ç¼å­ï¼å¦æç¼å­å½ä¸­ï¼ç´æ¥è¿åç»æå¹¶åå¡« l1 ç¼å­ï¼å¦ææ²¡æå½ä¸­ï¼æ§è¡ä¸ä¸æ­¥ã\n 3. æåï¼æ¥è¯¢æ°æ®åºï¼è¿åç»æå¹¶ä¾æ¬¡åå¡« l2 ç¼å­ãl1 ç¼å­ã\n\n# 5.4.2. å¤çº§ç¼å­æ´æ°\n\nå¯¹äº l1 ç¼å­ï¼å¦æææ°æ®æ´æ°ï¼åªè½å é¤å¹¶æ´æ°æå¨æºå¨ä¸çç¼å­ï¼å¶ä»æºå¨åªè½éè¿è¶æ¶æºå¶æ¥å·æ°ç¼å­ãè¶æ¶è®¾å®å¯ä»¥æä¸¤ç§ç­ç¥:\n\n * è®¾ç½®æåå¥åå¤å°æ¶é´åè¿æ\n * è®¾ç½®æåå¥åå¤å°æ¶é´å·æ°\n\nå¯¹äº l2 ç¼å­ï¼å¦æææ°æ®æ´æ°ï¼å¶ä»æºå¨ç«é©¬å¯è§ãä½æ¯ï¼ä¹å¿é¡»è¦è®¾ç½®è¶æ¶æ¶é´ï¼å¶æ¶é´åºè¯¥æ¯ l1 ç¼å­çæææ¶é´é¿ã\n\nä¸ºäºè§£å³è¿ç¨åç¼å­ä¸ä¸è´çé®é¢ï¼è®¾è®¡å¯ä»¥è¿ä¸æ­¥ä¼å:\n\n\n\néè¿æ¶æ¯éåçåå¸ãè®¢éæºå¶ï¼å¯ä»¥éç¥å¶ä»åºç¨èç¹å¯¹è¿ç¨åç¼å­è¿è¡æ´æ°ãä½¿ç¨è¿ç§æ¹æ¡ï¼å³ä½¿æ¶æ¯éåæå¡æäºæä¸å¯é ï¼ç±äºåæ§è¡äºæ°æ®åºæ´æ°ï¼ä½è¿ç¨åç¼å­è¿æï¼å·æ°ç¼å­æ¶ï¼ä¹è½ä¿è¯æ°æ®çæç»ä¸è´æ§ã\n\n\n# 6. ç¼å­é®é¢\n\n\n# 6.1. ç¼å­éªå´©\n\nç¼å­éªå´©æ¯æç¼å­ä¸å¯ç¨æèå¤§éç¼å­ç±äºè¶æ¶æ¶é´ç¸åå¨åä¸æ¶é´æ®µå¤±æï¼å¤§éè¯·æ±ç´æ¥è®¿é®æ°æ®åºï¼æ°æ®åºååè¿å¤§å¯¼è´ç³»ç»éªå´©ã\n\nä¸¾ä¾æ¥è¯´ï¼å¯¹äºç³»ç» aï¼åè®¾æ¯å¤©é«å³°ææ¯ç§ 5000 ä¸ªè¯·æ±ï¼æ¬æ¥ç¼å­å¨é«å³°æå¯ä»¥æä½æ¯ç§ 4000 ä¸ªè¯·æ±ï¼ä½æ¯ç¼å­æºå¨æå¤åçäºå¨çå®æºãç¼å­æäºï¼æ­¤æ¶ 1 ç§ 5000 ä¸ªè¯·æ±å¨é¨è½æ°æ®åºï¼æ°æ®åºå¿ç¶æä¸ä½ï¼å®ä¼æ¥ä¸ä¸è­¦ï¼ç¶åå°±æäºãæ­¤æ¶ï¼å¦ææ²¡æéç¨ä»ä¹ç¹å«çæ¹æ¡æ¥å¤çè¿ä¸ªæéï¼dba å¾çæ¥ï¼éå¯æ°æ®åºï¼ä½æ¯æ°æ®åºç«é©¬åè¢«æ°çæµéç»ææ­»äºã\n\nè§£å³ç¼å­éªå´©çä¸»è¦ææ®µå¦ä¸ï¼\n\n * å¢å ç¼å­ç³»ç»å¯ç¨æ§ï¼äºåï¼ãä¾å¦ï¼é¨ç½² redis clusterï¼ä¸»ä»+å¨åµï¼ï¼ä»¥å®ç° redis çé«å¯ç¨ï¼é¿åå¨çå´©æºã\n * éç¨å¤çº§ç¼å­æ¹æ¡ï¼äºä¸­ï¼ãä¾å¦ï¼æ¬å°ç¼å­ï¼ehcache/caffine/guava cacheï¼ + åå¸å¼ç¼å­ï¼redis/ memcachedï¼ã\n * éæµãéçº§ãçæ­æ¹æ¡ï¼äºä¸­ï¼ï¼é¿åè¢«æµéææ­»ãå¦ï¼ä½¿ç¨ hystrix è¿è¡çæ­ãéçº§ã\n * ç¼å­å¦ææ¯ææä¹åï¼å¯ä»¥å¨æ¢å¤å·¥ä½åæ¢å¤æ°æ®ï¼äºåï¼ãå¦ï¼redis æ¯ææä¹åï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\nä¸é¢çè§£å³æ¹æ¡ç®åæ¥è¯´ï¼å°±æ¯å¤çº§ç¼å­æ¹æ¡ãç³»ç»æ¶å°ä¸ä¸ªæ¥è¯¢è¯·æ±ï¼åæ¥æ¬å°ç¼å­ï¼åæ¥åå¸å¼ç¼å­ï¼æåæ¥æ°æ®åºï¼åªè¦å½ä¸­ï¼ç«å³è¿åã\n\nè§£å³ç¼å­éªå´©çè¾å©ææ®µå¦ä¸ï¼\n\n * çæ§ç¼å­ï¼å¼¹æ§æ©å®¹ã\n * ç¼å­çè¿ææ¶é´å¯ä»¥åä¸ªéæºå¼ãè¿ä¹åæ¯ä¸ºé¿åç¼å­åæ¶å¤±æï¼ä½¿å¾æ°æ®åº io éª¤åãæ¯å¦ï¼ä»¥åæ¯è®¾ç½® 10 åéçè¶æ¶æ¶é´ï¼é£æ¯ä¸ª key é½å¯ä»¥éæº 8-13 åéè¿æï¼å°½éè®©ä¸å key çè¿ææ¶é´ä¸åã\n\n\n# 6.2. ç¼å­ç©¿é\n\n> ç¼å­ç©¿éæ¯æï¼æ¥è¯¢çæ°æ®å¨æ°æ®åºä¸­ä¸å­å¨ï¼é£ä¹ç¼å­ä¸­èªç¶ä¹ä¸å­å¨ãæä»¥ï¼åºç¨å¨ç¼å­ä¸­æ¥ä¸å°ï¼åä¼å»æ¥è¯¢æ°æ®åºãå½è¿æ ·çè¯·æ±å¤äºåï¼æ°æ®åºçååå°±ä¼å¢å¤§ã\n\nè§£å³ç¼å­ç©¿éï¼ä¸è¬æä¸¤ç§æ¹æ³ï¼\n\nï¼ä¸ï¼ç¼å­ç©ºå¼\n\nå¯¹äºè¿åä¸º null çä¾ç¶ç¼å­ï¼å¯¹äºæåºå¼å¸¸çè¿åä¸è¿è¡ç¼å­ã\n\n\n\néç¨è¿ç§ææ®µçä¼å¢å æä»¬ç¼å­çç»´æ¤ææ¬ï¼éè¦å¨æå¥ç¼å­çæ¶åå é¤è¿ä¸ªç©ºç¼å­ï¼å½ç¶æä»¬å¯ä»¥éè¿è®¾ç½®è¾ç­çè¶æ¶æ¶é´æ¥è§£å³è¿ä¸ªé®é¢ã\n\nï¼äºï¼è¿æ»¤ä¸å¯è½å­å¨çæ°æ®\n\n\n\nå¶å®ä¸äºè§åè¿æ»¤ä¸äºä¸å¯è½å­å¨çæ°æ®ãå¯ä»¥ä½¿ç¨å¸éè¿æ»¤å¨ï¼éå¯¹äºè¿å¶æä½çæ°æ®ç»æï¼æä»¥æ§è½é«ï¼ï¼æ¯å¦ä½ çè®¢å id ææ¾æ¯å¨ä¸ä¸ªèå´ 1-1000ï¼å¦æä¸æ¯ 1-1000 ä¹åçæ°æ®é£å¶å®å¯ä»¥ç´æ¥ç»è¿æ»¤æã\n\n> éå¯¹äºä¸äºæ¶ææ»å»ï¼æ»å»å¸¦è¿æ¥çå¤§é key æ¯ä¸å­å¨çï¼é£ä¹æä»¬éç¨ç¬¬ä¸ç§æ¹æ¡å°±ä¼ç¼å­å¤§éä¸å­å¨ key çæ°æ®ã\n> \n> æ­¤æ¶æä»¬éç¨ç¬¬ä¸ç§æ¹æ¡å°±ä¸åéäºï¼æä»¬å®å¨å¯ä»¥åå¯¹ä½¿ç¨ç¬¬äºç§æ¹æ¡è¿è¡è¿æ»¤æè¿äº keyã\n> \n> éå¯¹è¿ç§ key å¼å¸¸å¤ãè¯·æ±éå¤çæ¯è¾ä½çæ°æ®ï¼æä»¬å°±æ²¡æå¿è¦è¿è¡ç¼å­ï¼ä½¿ç¨ç¬¬äºç§æ¹æ¡ç´æ¥è¿æ»¤æã\n> \n> èå¯¹äºç©ºæ°æ®ç key æéçï¼éå¤çæ¯è¾é«çï¼æä»¬åå¯ä»¥éç¨ç¬¬ä¸ç§æ¹å¼è¿è¡ç¼å­ã\n\n\n# 6.3. ç¼å­å»ç©¿\n\nç¼å­å»ç©¿æ¯æï¼ç­ç¹æ°æ®å¤±æç¬é´ï¼å¤§éè¯·æ±ç´æ¥è®¿é®æ°æ®åºãä¾å¦ï¼æäº key æ¯ç­ç¹æ°æ®ï¼è®¿é®éå¸¸é¢ç¹ãå¦ææä¸ª key å¤±æçç¬é´ï¼å¤§éçè¯·æ±è¿æ¥ï¼ç¼å­æªå½ä¸­ï¼ç¶åå»æ°æ®åºè®¿é®ï¼æ­¤æ¶æ°æ®åºè®¿é®éä¼æ¥å§å¢å ã\n\nä¸ºäºé¿åè¿ä¸ªé®é¢ï¼æä»¬å¯ä»¥éåä¸é¢çä¸¤ä¸ªææ®µ:\n\n * åå¸å¼é - éä½ç­ç¹æ°æ®ç keyï¼é¿åå¤§éçº¿ç¨åæ¶è®¿é®åä¸ä¸ª keyã\n * å®æ¶å¼æ­¥å·æ° - å¯ä»¥å¯¹é¨åæ°æ®éåå¤±æåèªå¨å·æ°çç­ç¥ï¼èä¸æ¯å°æèªå¨æ·æ±°ãæ·æ±°å¶å®ä¹æ¯ä¸ºäºæ°æ®çæ¶ææ§ï¼æä»¥éç¨èªå¨å·æ°ä¹å¯ä»¥ã\n\n\n# 6.4. å°ç»\n\nä¸é¢éä¸ä»ç»äºç¼å­ä½¿ç¨ä¸­å¸¸è§çé®é¢ãè¿éï¼ä»åçæ¶é´æ®µçè§åº¦æ´ä½å½çº³ä¸ä¸ç¼å­é®é¢è§£å³æ¹æ¡ã\n\n * äºåï¼redis é«å¯ç¨æ¹æ¡ï¼redis cluster + ä¸»ä» + å¨åµï¼ï¼é¿åç¼å­å¨é¢å´©æºã\n * äºä¸­ï¼ï¼ä¸ï¼éç¨å¤çº§ç¼å­æ¹æ¡ï¼æ¬å°ç¼å­ï¼ehcache/caffine/guava cacheï¼ + åå¸å¼ç¼å­ï¼redis/ memcachedï¼ãï¼äºï¼éæµ + çæ­ + éçº§ï¼hystrixï¼ï¼é¿åæç«¯æåµä¸ï¼æ°æ®åºè¢«ææ­»ã\n * äºåï¼redis æä¹åï¼rdb+aofï¼ï¼ä¸æ¦éå¯ï¼èªå¨ä»ç£çä¸å è½½æ°æ®ï¼å¿«éæ¢å¤ç¼å­æ°æ®ã\n\n> åå¸å¼ç¼å­ memcached ï¼ç±äºæ°æ®ç±»åä¸å¦ redis ä¸°å¯ï¼å¹¶ä¸ä¸æ¯ææä¹åãå®¹ç¾ãæä»¥ï¼ä¸è¬ä¼éæ© redis ååå¸å¼ç¼å­ã\n\n\n# 7. ç¼å­ç­ç¥\n\n\n# 7.1. ç¼å­é¢ç­\n\nç¼å­é¢ç­æ¯æç³»ç»å¯å¨åï¼ç´æ¥æ¥è¯¢ç­ç¹æ°æ®å¹¶ç¼å­ãè¿æ ·å°±å¯ä»¥é¿åç¨æ·è¯·æ±çæ¶åï¼åæ¥è¯¢æ°æ®åºï¼ç¶ååæ´æ°ç¼å­çé®é¢ã\n\nè§£å³æ¹æ¡ï¼\n\n * æå¨å·æ°ç¼å­ï¼ç´æ¥åä¸ªç¼å­å·æ°é¡µé¢ï¼ä¸çº¿æ¶æå·¥æä½ä¸ã\n * åºç¨å¯å¨æ¶å·æ°ç¼å­ï¼æ°æ®éä¸å¤§ï¼å¯ä»¥å¨é¡¹ç®å¯å¨çæ¶åèªå¨è¿è¡å è½½ã\n * å®æ¶å¼æ­¥å·æ°ç¼å­\n\n\n# 7.2. å¦ä½ç¼å­\n\n# 7.2.1. ä¸è¿æç¼å­\n\nç¼å­æ´æ°æ¨¡å¼ï¼\n\n 1. å¼å¯äºå¡\n 2. å sql\n 3. æäº¤äºå¡\n 4. åç¼å­\n\nä¸è¦æåç¼å­æä½æ¾å¨äºå¡ä¸­ï¼å°¤å¶æ¯ååå¸å¼ç¼å­ãå ä¸ºç½ç»æå¨å¯è½å¯¼è´åç¼å­ååºæ¶é´å¾æ¢ï¼å¼èµ·æ°æ®åºäºå¡é»å¡ãå¦æå¯¹ç¼å­æ°æ®ä¸è´æ§è¦æ±ä¸æ¯é£ä¹é«ï¼æ°æ®éä¹ä¸æ¯å¾å¤§ï¼å¯ä»¥èèå®æå¨éåæ­¥ç¼å­ã\n\nè¿ç§æ¨¡å¼å­å¨è¿æ ·çæåµï¼å­å¨äºå¡æåï¼ä½ç¼å­åå¤±è´¥çå¯è½ãä½è¿ç§æåµç¸å¯¹äºä¸é¢çé®é¢ï¼å½±åè¾å°ã\n\n# 7.2.2. è¿æç¼å­\n\néç¨æå è½½ãå¯¹äºç­ç¹æ°æ®ï¼å¯ä»¥è®¾ç½®è¾ç­çç¼å­æ¶é´ï¼å¹¶å®æå¼æ­¥å è½½ã\n\n\n# 7.3. ç¼å­æ´æ°\n\nä¸è¬æ¥è¯´ï¼ç³»ç»å¦æä¸æ¯ä¸¥æ ¼è¦æ±ç¼å­åæ°æ®åºä¿æä¸è´æ§çè¯ï¼å°½éä¸è¦å°è¯»è¯·æ±ååè¯·æ±ä¸²è¡åãä¸²è¡åå¯ä»¥ä¿è¯ä¸å®ä¸ä¼åºç°æ°æ®ä¸ä¸è´çæåµï¼ä½æ¯å®ä¼å¯¼è´ç³»ç»çååéå¤§å¹åº¦ä¸éã\n\nç¼å­æ´æ°çç­ç¥æå ç§æ¨¡å¼ï¼\n\n * cache aside\n * read/write through\n\néè¦æ³¨æçæ¯ï¼ä»¥ä¸å ç§ç¼å­æ´æ°ç­ç¥ï¼é½æ æ³ä¿è¯æ°æ®å¼ºä¸è´ãå¦æä¸å®è¦ä¿è¯å¼ºä¸è´æ§ï¼å¯ä»¥éè¿ä¸¤é¶æ®µæäº¤ï¼2pcï¼æ paxos åè®®æ¥å®ç°ãä½æ¯ 2pc å¤ªæ¢ï¼è paxos å¤ªå¤æï¼æä»¥å¦æä¸æ¯éå¸¸éè¦çæ°æ®ï¼ä¸å»ºè®®ä½¿ç¨å¼ºä¸è´æ§æ¹æ¡ã\n\n# 7.3.1. cache aside\n\ncache aside åºè¯¥æ¯æå¸¸è§çç¼å­æ´æ°ç­ç¥äºã\n\ncache aside çæè·¯æ¯ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ãå·ä½æ¥è¯´ï¼\n\n * å¤±æï¼å°è¯è¯»ç¼å­ï¼å¦æä¸å½ä¸­ï¼åè¯»æ°æ®åºï¼ç¶åæ´æ°ç¼å­ã\n\n * å½ä¸­ï¼å°è¯è¯»ç¼å­ï¼å½ä¸­åç´æ¥è¿åæ°æ®ã\n\n * æ´æ°ï¼åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ã\n\n\n\n# 7.3.1.1. ä¸ºä»ä¹ä¸è½åæ´æ°æ°æ®åºï¼åæ´æ°ç¼å­ï¼\n\nå¤ä¸ªå¹¶åçåæä½å¯è½å¯¼è´èæ°æ®ï¼å½æå¤ä¸ªå¹¶åçåè¯·æ±æ¶ï¼æ æ³ä¿è¯æ´æ°æ°æ®åºçé¡ºåºåæ´æ°ç¼å­çé¡ºåºä¸è´ï¼ä»èå¯¼è´æ°æ®åºåç¼å­æ°æ®ä¸ä¸è´çé®é¢ã\n\n\n\n> è¯´æï¼å¦ä¸å¾çåºæ¯ä¸­ï¼ä¸¤ä¸ªåçº¿ç¨ç±äºæ§è¡é¡ºåºï¼å¯¼è´æ°æ®åºä¸­ val = 2ï¼èç¼å­ä¸­ val = 1ï¼æ°æ®ä¸ä¸è´ã\n\n# 7.3.1.2. ä¸ºä»ä¹ä¸è½åå ç¼å­ï¼åæ´æ°æ°æ®åºï¼\n\nå­å¨å¹¶åè¯»è¯·æ±ååè¯·æ±æ¶ï¼å¯è½å¯¼è´èæ°æ®ã\n\n\n\n> è¯´æï¼å¦ä¸å¾çåºæ¯ä¸­ï¼è¯»çº¿ç¨ååçº¿ç¨å¹¶è¡æ§è¡ï¼å¯¼è´æ°æ®åºä¸­ val = 2ï¼èç¼å­ä¸­ val = 1ï¼æ°æ®ä¸ä¸è´ã\n\n# 7.3.1.3. åæ´æ°æ°æ®åºï¼åå é¤ç¼å­å°±æ²¡é®é¢äºå\n\nå­å¨å¹¶åè¯»è¯·æ±ååè¯·æ±æ¶ï¼å¯è½å¯¼è´èæ°æ®ã\n\n\n\n> ä¸å¾ä¸­é®é¢åççæ¦çéå¸¸ä½ï¼å ä¸ºéå¸¸æ°æ®åºæ´æ°æä½æ¯åå­æä½èæ¶å¤åºå ä¸ªæ°éçº§ï¼æåä¸æ­¥ååç¼å­éåº¦éå¸¸å¿«ï¼éå¸¸ä¼å¨æ´æ°æ°æ®åºä¹åå®æãæä»¥ cache aside æ¨¡å¼éæ©åæ´æ°æ°æ®åºï¼åå é¤ç¼å­ï¼èä¸æ¯åå ç¼å­ï¼åæ´æ°æ°æ®åºã\n> \n> ä¸è¿ï¼å¦æççåºç°äºè¿ç§åºæ¯ï¼ä¸ºäºé¿åç¼å­ä¸­ä¸ç´ä¿ççèæ°æ®ï¼å¯ä»¥ä¸ºç¼å­è®¾ç½®è¿ææ¶é´ï¼è¿æåç¼å­èªå¨å¤±æãéå¸¸ï¼ä¸å¡ç³»ç»ä¸­åè®¸å°éæ°æ®ç­æ¶é´åºç°ä¸ä¸è´çæåµã\n\n# 7.3.2. read/write through\n\n\n\nread through çæè·¯æ¯ï¼æ¥è¯¢æ¶æ´æ°ç¼å­ãå½ç¼å­å¤±ææ¶ï¼ç¼å­æå¡èªå·±è¿è¡å è½½ã\n\nwrite through çæè·¯æ¯ï¼å½æ°æ®æ´æ°æ¶ï¼ç¼å­æå¡è´è´£æ´æ°ç¼å­ã\n\nthrough vs. cache aside\n\nread through vs. cache aside\n\n * cache aside æ¨¡å¼ä¸­ï¼åºç¨éè¦ç»´æ¤ä¸¤ä¸ªæ°æ®æºå¤´ï¼ä¸ä¸ªæ¯ç¼å­ï¼ä¸ä¸ªæ¯æ°æ®åºã\n * read-through æ¨¡å¼ä¸­ï¼åºç¨æ éç®¡çç¼å­åæ°æ®åºï¼åªéè¦å°æ°æ®åºçåæ­¥å§æç»ç¼å­æå¡å³å¯ã\n\n# 7.3.3. write behind\n\nwrite behind åå« write backãwrite behind çæè·¯æ¯ï¼åºç¨æ´æ°æ°æ®æ¶ï¼åªæ´æ°ç¼å­ï¼ ç¼å­æå¡æ¯éä¸æ®µæ¶é´å°ç¼å­æ°æ®æ¹éæ´æ°å°æ°æ®åºä¸­ï¼å³å»¶è¿åå¥ãè¿ä¸ªè®¾è®¡çå¥½å¤å°±æ¯è®©æé« i/o æçï¼å ä¸ºå¼æ­¥ï¼write behind è¿å¯ä»¥åå¹¶å¯¹åä¸ä¸ªæ°æ®çå¤æ¬¡æä½ï¼æä»¥æ§è½çæé«æ¯ç¸å½å¯è§çã\n\n> æ´è¯¦ç»çåæå¯ä»¥åèï¼åå¸å¼ä¹æ°æ®åºåç¼å­ååä¸è´æ§æ¹æ¡è§£æ\n\n\n# 8. æ»ç»\n\næåï¼éè¿ä¸å¼ æç»´å¯¼å¾æ¥æ»ç»ä¸ä¸æ¬ææè¿°çç¥è¯ç¹ï¼å¸®å©å¤§å®¶å¯¹ç¼å­æä¸ä¸ªç³»ç»æ§çè®¤è¯ã\n\n\n\n\n# 9. åèèµæ\n\n * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã\n * ä½ åºè¯¥ç¥éçç¼å­è¿åå²\n * å¦ä½ä¼éçè®¾è®¡åä½¿ç¨ç¼å­ï¼\n * çè§£åå¸å¼ç³»ç»ä¸­çç¼å­æ¶æ(ä¸)\n * ç¼å­é£äºäº\n * åå¸å¼ä¹æ°æ®åºåç¼å­ååä¸è´æ§æ¹æ¡è§£æ\n * cache çåºæ¬åç\n * 5 åéçæç³»åï¼http ç¼å­æºå¶è¯¦è§£\n * æµè§å¨ç¼å­çè¿ä¸ç¯å°±å¤äº",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è¯»ååç¦»åºæ¬åç",frontmatter:{title:"è¯»ååç¦»åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","è¯»ååç¦»"],abbrlink:"4898ead7",date:"2022-04-14T11:36:23.000Z",permalink:"/pages/7da6ca/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/02.%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/02.è¯»ååç¦».md",key:"v-1af69402",path:"/pages/7da6ca/",headers:[{level:2,title:"1. ä¸ºä½è¦è¯»ååç¦»",slug:"_1-ä¸ºä½è¦è¯»ååç¦»",normalizedTitle:"1. ä¸ºä½è¦è¯»ååç¦»",charIndex:67},{level:2,title:"2. è¯»ååç¦»çåç",slug:"_2-è¯»ååç¦»çåç",normalizedTitle:"2. è¯»ååç¦»çåç",charIndex:307},{level:2,title:"3. è¯»ååç¦»çé®é¢",slug:"_3-è¯»ååç¦»çé®é¢",normalizedTitle:"3. è¯»ååç¦»çé®é¢",charIndex:585},{level:3,title:"3.1. æ°æ®ä¸è´æ§",slug:"_3-1-æ°æ®ä¸è´æ§",normalizedTitle:"3.1. æ°æ®ä¸è´æ§",charIndex:624},{level:3,title:"3.2. ååæºå¶",slug:"_3-2-ååæºå¶",normalizedTitle:"3.2. ååæºå¶",charIndex:667},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:996}],headersStr:"1. ä¸ºä½è¦è¯»ååç¦» 2. è¯»ååç¦»çåç 3. è¯»ååç¦»çé®é¢ 3.1. æ°æ®ä¸è´æ§ 3.2. ååæºå¶ 4. åèèµæ",content:"# è¯»ååç¦»åºæ¬åç\n\nè¯»ååç¦»çåºæ¬åçæ¯ï¼ä¸»æå¡å¨ç¨æ¥å¤çåæä½ä»¥åå®æ¶æ§è¦æ±æ¯è¾é«çè¯»æä½ï¼èä»æå¡å¨ç¨æ¥å¤çè¯»æä½ã\n\n\n# 1. ä¸ºä½è¦è¯»ååç¦»\n\n * ææåå°éç«äº - ä¸»æå¡å¨åªè´è´£åï¼ä»æå¡å¨åªè´è´£è¯»ï¼è½å¤ææçé¿åç±æ°æ®æ´æ°å¯¼è´çè¡éç«äºï¼ä½¿å¾æ´ä¸ªç³»ç»çæ¥è¯¢æ§è½å¾å°æå¤§çæ¹åã\n * æé«æ¥è¯¢ååé - éè¿ä¸ä¸»å¤ä»çéç½®æ¹å¼ï¼å¯ä»¥å°æ¥è¯¢è¯·æ±ååçåæ£å°å¤ä¸ªæ°æ®å¯æ¬ï¼è½å¤è¿ä¸æ­¥çæåç³»ç»çå¤çè½åã\n * æåæ°æ®åºå¯ç¨æ§ - ä½¿ç¨å¤ä¸»å¤ä»çæ¹å¼ï¼ä¸ä½è½å¤æåç³»ç»çååéï¼è¿è½å¤æåæ°æ®åºçå¯ç¨æ§ï¼å¯ä»¥è¾¾å°å¨ä»»ä½ä¸ä¸ªæ°æ®åºå®æºï¼çè³ç£çç©çæåçæåµä¸ä»ç¶ä¸å½±åç³»ç»çæ­£å¸¸è¿è¡ã\n\n\n# 2. è¯»ååç¦»çåç\n\nè¯»ååç¦»çå®ç°æ¯æ ¹æ® SQL è¯­ä¹åæï¼å°è¯»æä½ååæä½åå«è·¯ç±è³ä¸»åºä¸ä»åºã\n\n\n\nè¯»ååç¦»çåºæ¬å®ç°æ¯ï¼\n\n\n\n * æ°æ®åºæå¡å¨æ­å»ºä¸»ä»éç¾¤ï¼ä¸ä¸»ä¸ä»ãä¸ä¸»å¤ä»é½å¯ä»¥ã\n * æ°æ®åºä¸»æºè´è´£è¯»åæä½ï¼ä»æºåªè´è´£è¯»æä½ã\n * æ°æ®åºä¸»æºéè¿å¤å¶å°æ°æ®åæ­¥å°ä»æºï¼æ¯å°æ°æ®åºæå¡å¨é½å­å¨äºå¨éæ°æ®ã\n * ä¸å¡æå¡å¨å°åæä½åç»æ°æ®åºä¸»æºï¼å°è¯»æä½åç»æ°æ®åºä»æºã\n * ä¸»æºä¼è®°å½è¯·æ±çäºè¿å¶æ¥å¿ï¼ç¶åæ¨éç»ä»åºï¼ä»åºè§£æå¹¶æ§è¡æ¥å¿ä¸­çè¯·æ±ï¼å®æä¸»ä»å¤å¶ãè¿æå³çï¼å¤å¶è¿ç¨å­å¨æ¶å»¶ï¼è¿æ®µæ¶é´åï¼ä¸»ä»æ°æ®å¯è½ä¸ä¸è´ã\n\n\n# 3. è¯»ååç¦»çé®é¢\n\nè¯»ååç¦»å­å¨ä¸¤ä¸ªé®é¢ï¼æ°æ®ä¸è´æ§åååæºå¶ã\n\n\n# 3.1. æ°æ®ä¸è´æ§\n\nè¯»ååç¦»äº§çäºä¸»åºä¸ä»åºä¹é´çæ°æ®ä¸è´æ§çé®é¢ã\n\n\n\n\n# 3.2. ååæºå¶\n\næ°æ®åºè¯»ååç¦»åï¼ä¸ä¸ª SQL è¯·æ±å·ä½ååå°åªä¸ªæ°æ®åºèç¹ï¼ä¸è¬æä¸¤ç§ååæ¹å¼ï¼å®¢æ·ç«¯åååä¸­é´ä»¶ä»£çååã\n\nå®¢æ·ç«¯ååï¼æ¯åºäºç¨åºä»£ç ï¼èªè¡æ§å¶æ°æ®ååå°åªä¸ªæ°æ®åºèç¹ãæ´ç»ä¸ç¹æ¥è¯´ï¼ä¸è¬ç¨åºä¸­å»ºç«å¤ä¸ªæ°æ®åºçè¿æ¥ï¼æ ¹æ®ä¸å®çç®æ³ï¼éæ©åéçè¿æ¥å»åèµ· SQL è¯·æ±ãè¿ç§æ¹å¼ä¹è¢«ç§°ä¸ºå®¢æ·ç«¯ä¸­é´ä»¶ï¼ä»£è¡¨æï¼jdbc-shardingã\n\nä¸­é´ä»¶ä»£çååï¼æçæ¯ç¬ç«ä¸å¥ç³»ç»åºæ¥ï¼å®ç°è¯»åæä½åç¦»åæ°æ®åºæå¡å¨è¿æ¥çç®¡çãä¸­é´ä»¶å¯¹ä¸å¡æå¡å¨æä¾ SQL å¼å®¹çåè®®ï¼ä¸å¡æå¡å¨æ é¡»èªå·±è¿è¡è¯»ååç¦»ãå¯¹äºä¸å¡æå¡å¨æ¥è¯´ï¼è®¿é®ä¸­é´ä»¶åè®¿é®æ°æ®åºæ²¡æåºå«ï¼äºå®ä¸å¨ä¸å¡æå¡å¨çæ¥ï¼ä¸­é´ä»¶å°±æ¯ä¸ä¸ªæ°æ®åºæå¡å¨ãä»£è¡¨æï¼Mycatã\n\n\n# 4. åèèµæ\n\n * åç«¯å­å¨å®æè¯¾\n * ShardingSphere å®æ¹ææ¡£",normalizedContent:"# è¯»ååç¦»åºæ¬åç\n\nè¯»ååç¦»çåºæ¬åçæ¯ï¼ä¸»æå¡å¨ç¨æ¥å¤çåæä½ä»¥åå®æ¶æ§è¦æ±æ¯è¾é«çè¯»æä½ï¼èä»æå¡å¨ç¨æ¥å¤çè¯»æä½ã\n\n\n# 1. ä¸ºä½è¦è¯»ååç¦»\n\n * ææåå°éç«äº - ä¸»æå¡å¨åªè´è´£åï¼ä»æå¡å¨åªè´è´£è¯»ï¼è½å¤ææçé¿åç±æ°æ®æ´æ°å¯¼è´çè¡éç«äºï¼ä½¿å¾æ´ä¸ªç³»ç»çæ¥è¯¢æ§è½å¾å°æå¤§çæ¹åã\n * æé«æ¥è¯¢ååé - éè¿ä¸ä¸»å¤ä»çéç½®æ¹å¼ï¼å¯ä»¥å°æ¥è¯¢è¯·æ±ååçåæ£å°å¤ä¸ªæ°æ®å¯æ¬ï¼è½å¤è¿ä¸æ­¥çæåç³»ç»çå¤çè½åã\n * æåæ°æ®åºå¯ç¨æ§ - ä½¿ç¨å¤ä¸»å¤ä»çæ¹å¼ï¼ä¸ä½è½å¤æåç³»ç»çååéï¼è¿è½å¤æåæ°æ®åºçå¯ç¨æ§ï¼å¯ä»¥è¾¾å°å¨ä»»ä½ä¸ä¸ªæ°æ®åºå®æºï¼çè³ç£çç©çæåçæåµä¸ä»ç¶ä¸å½±åç³»ç»çæ­£å¸¸è¿è¡ã\n\n\n# 2. è¯»ååç¦»çåç\n\nè¯»ååç¦»çå®ç°æ¯æ ¹æ® sql è¯­ä¹åæï¼å°è¯»æä½ååæä½åå«è·¯ç±è³ä¸»åºä¸ä»åºã\n\n\n\nè¯»ååç¦»çåºæ¬å®ç°æ¯ï¼\n\n\n\n * æ°æ®åºæå¡å¨æ­å»ºä¸»ä»éç¾¤ï¼ä¸ä¸»ä¸ä»ãä¸ä¸»å¤ä»é½å¯ä»¥ã\n * æ°æ®åºä¸»æºè´è´£è¯»åæä½ï¼ä»æºåªè´è´£è¯»æä½ã\n * æ°æ®åºä¸»æºéè¿å¤å¶å°æ°æ®åæ­¥å°ä»æºï¼æ¯å°æ°æ®åºæå¡å¨é½å­å¨äºå¨éæ°æ®ã\n * ä¸å¡æå¡å¨å°åæä½åç»æ°æ®åºä¸»æºï¼å°è¯»æä½åç»æ°æ®åºä»æºã\n * ä¸»æºä¼è®°å½è¯·æ±çäºè¿å¶æ¥å¿ï¼ç¶åæ¨éç»ä»åºï¼ä»åºè§£æå¹¶æ§è¡æ¥å¿ä¸­çè¯·æ±ï¼å®æä¸»ä»å¤å¶ãè¿æå³çï¼å¤å¶è¿ç¨å­å¨æ¶å»¶ï¼è¿æ®µæ¶é´åï¼ä¸»ä»æ°æ®å¯è½ä¸ä¸è´ã\n\n\n# 3. è¯»ååç¦»çé®é¢\n\nè¯»ååç¦»å­å¨ä¸¤ä¸ªé®é¢ï¼æ°æ®ä¸è´æ§åååæºå¶ã\n\n\n# 3.1. æ°æ®ä¸è´æ§\n\nè¯»ååç¦»äº§çäºä¸»åºä¸ä»åºä¹é´çæ°æ®ä¸è´æ§çé®é¢ã\n\n\n\n\n# 3.2. ååæºå¶\n\næ°æ®åºè¯»ååç¦»åï¼ä¸ä¸ª sql è¯·æ±å·ä½ååå°åªä¸ªæ°æ®åºèç¹ï¼ä¸è¬æä¸¤ç§ååæ¹å¼ï¼å®¢æ·ç«¯åååä¸­é´ä»¶ä»£çååã\n\nå®¢æ·ç«¯ååï¼æ¯åºäºç¨åºä»£ç ï¼èªè¡æ§å¶æ°æ®ååå°åªä¸ªæ°æ®åºèç¹ãæ´ç»ä¸ç¹æ¥è¯´ï¼ä¸è¬ç¨åºä¸­å»ºç«å¤ä¸ªæ°æ®åºçè¿æ¥ï¼æ ¹æ®ä¸å®çç®æ³ï¼éæ©åéçè¿æ¥å»åèµ· sql è¯·æ±ãè¿ç§æ¹å¼ä¹è¢«ç§°ä¸ºå®¢æ·ç«¯ä¸­é´ä»¶ï¼ä»£è¡¨æï¼jdbc-shardingã\n\nä¸­é´ä»¶ä»£çååï¼æçæ¯ç¬ç«ä¸å¥ç³»ç»åºæ¥ï¼å®ç°è¯»åæä½åç¦»åæ°æ®åºæå¡å¨è¿æ¥çç®¡çãä¸­é´ä»¶å¯¹ä¸å¡æå¡å¨æä¾ sql å¼å®¹çåè®®ï¼ä¸å¡æå¡å¨æ é¡»èªå·±è¿è¡è¯»ååç¦»ãå¯¹äºä¸å¡æå¡å¨æ¥è¯´ï¼è®¿é®ä¸­é´ä»¶åè®¿é®æ°æ®åºæ²¡æåºå«ï¼äºå®ä¸å¨ä¸å¡æå¡å¨çæ¥ï¼ä¸­é´ä»¶å°±æ¯ä¸ä¸ªæ°æ®åºæå¡å¨ãä»£è¡¨æï¼mycatã\n\n\n# 4. åèèµæ\n\n * åç«¯å­å¨å®æè¯¾\n * shardingsphere å®æ¹ææ¡£",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ååºåè¡¨åºæ¬åç",frontmatter:{title:"ååºåè¡¨åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","ååºåè¡¨"],abbrlink:"b9d9ce9d",date:"2019-10-16T20:54:00.000Z",permalink:"/pages/103382/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/03.%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/03.ååºåè¡¨.md",key:"v-f52afa76",path:"/pages/103382/",headers:[{level:2,title:"1. ä¸ºä½è¦ååºåè¡¨",slug:"_1-ä¸ºä½è¦ååºåè¡¨",normalizedTitle:"1. ä¸ºä½è¦ååºåè¡¨",charIndex:15},{level:2,title:"2. ååºåè¡¨åç",slug:"_2-ååºåè¡¨åç",normalizedTitle:"2. ååºåè¡¨åç",charIndex:397},{level:3,title:"2.1. åç´åç",slug:"_2-1-åç´åç",normalizedTitle:"2.1. åç´åç",charIndex:755},{level:3,title:"2.2. æ°´å¹³åç",slug:"_2-2-æ°´å¹³åç",normalizedTitle:"2.2. æ°´å¹³åç",charIndex:1430},{level:3,title:"2.3. ååºåè¡¨ç­ç¥",slug:"_2-3-ååºåè¡¨ç­ç¥",normalizedTitle:"2.3. ååºåè¡¨ç­ç¥",charIndex:1902},{level:4,title:"2.3.1. æ°å¼èå´è·¯ç±",slug:"_2-3-1-æ°å¼èå´è·¯ç±",normalizedTitle:"2.3.1. æ°å¼èå´è·¯ç±",charIndex:1960},{level:4,title:"2.3.2. Hash è·¯ç±",slug:"_2-3-2-hash-è·¯ç±",normalizedTitle:"2.3.2. hash è·¯ç±",charIndex:2134},{level:4,title:"2.3.3. è·¯ç±è¡¨",slug:"_2-3-3-è·¯ç±è¡¨",normalizedTitle:"2.3.3. è·¯ç±è¡¨",charIndex:2518},{level:2,title:"3. è¿ç§»åæ©å®¹",slug:"_3-è¿ç§»åæ©å®¹",normalizedTitle:"3. è¿ç§»åæ©å®¹",charIndex:2680},{level:3,title:"3.1. åæºè¿ç§»/æ©å®¹ï¼ä¸æ¨èï¼",slug:"_3-1-åæºè¿ç§»-æ©å®¹-ä¸æ¨è",normalizedTitle:"3.1. åæºè¿ç§»/æ©å®¹ï¼ä¸æ¨èï¼",charIndex:2693},{level:4,title:"3.1.1. åæºè¿ç§»/æ©å®¹æµç¨",slug:"_3-1-1-åæºè¿ç§»-æ©å®¹æµç¨",normalizedTitle:"3.1.1. åæºè¿ç§»/æ©å®¹æµç¨",charIndex:2742},{level:4,title:"3.1.2. åæºè¿ç§»/æ©å®¹æ¹æ¡åæ",slug:"_3-1-2-åæºè¿ç§»-æ©å®¹æ¹æ¡åæ",normalizedTitle:"3.1.2. åæºè¿ç§»/æ©å®¹æ¹æ¡åæ",charIndex:2885},{level:3,title:"3.2. ååè¿ç§»",slug:"_3-2-ååè¿ç§»",normalizedTitle:"3.2. ååè¿ç§»",charIndex:3043},{level:4,title:"3.2.1. ååè¿ç§»æµç¨",slug:"_3-2-1-ååè¿ç§»æµç¨",normalizedTitle:"3.2.1. ååè¿ç§»æµç¨",charIndex:3892},{level:3,title:"3.3. ä¸»ä»åçº§",slug:"_3-3-ä¸»ä»åçº§",normalizedTitle:"3.3. ä¸»ä»åçº§",charIndex:4178},{level:4,title:"3.3.1. åçº§ä»åºçæµç¨",slug:"_3-3-1-åçº§ä»åºçæµç¨",normalizedTitle:"3.3.1. åçº§ä»åºçæµç¨",charIndex:4292},{level:4,title:"3.3.2. åçº§ä»åºæ¹æ¡åæ",slug:"_3-3-2-åçº§ä»åºæ¹æ¡åæ",normalizedTitle:"3.3.2. åçº§ä»åºæ¹æ¡åæ",charIndex:4501},{level:2,title:"4. ååºåè¡¨çé®é¢",slug:"_4-ååºåè¡¨çé®é¢",normalizedTitle:"4. ååºåè¡¨çé®é¢",charIndex:4539},{level:3,title:"4.1. åå¸å¼ ID é®é¢",slug:"_4-1-åå¸å¼-id-é®é¢",normalizedTitle:"4.1. åå¸å¼ id é®é¢",charIndex:4554},{level:3,title:"4.2. åå¸å¼äºå¡é®é¢",slug:"_4-2-åå¸å¼äºå¡é®é¢",normalizedTitle:"4.2. åå¸å¼äºå¡é®é¢",charIndex:4707},{level:3,title:"4.3. è·¨èç¹ Join åèå",slug:"_4-3-è·¨èç¹-join-åèå",normalizedTitle:"4.3. è·¨èç¹ join åèå",charIndex:4931},{level:3,title:"4.4. è·¨åççæåºåé¡µ",slug:"_4-4-è·¨åççæåºåé¡µ",normalizedTitle:"4.4. è·¨åççæåºåé¡µ",charIndex:5063},{level:2,title:"5. ä¸­é´ä»¶",slug:"_5-ä¸­é´ä»¶",normalizedTitle:"5. ä¸­é´ä»¶",charIndex:5714},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:7013}],headersStr:"1. ä¸ºä½è¦ååºåè¡¨ 2. ååºåè¡¨åç 2.1. åç´åç 2.2. æ°´å¹³åç 2.3. ååºåè¡¨ç­ç¥ 2.3.1. æ°å¼èå´è·¯ç± 2.3.2. Hash è·¯ç± 2.3.3. è·¯ç±è¡¨ 3. è¿ç§»åæ©å®¹ 3.1. åæºè¿ç§»/æ©å®¹ï¼ä¸æ¨èï¼ 3.1.1. åæºè¿ç§»/æ©å®¹æµç¨ 3.1.2. åæºè¿ç§»/æ©å®¹æ¹æ¡åæ 3.2. ååè¿ç§» 3.2.1. ååè¿ç§»æµç¨ 3.3. ä¸»ä»åçº§ 3.3.1. åçº§ä»åºçæµç¨ 3.3.2. åçº§ä»åºæ¹æ¡åæ 4. ååºåè¡¨çé®é¢ 4.1. åå¸å¼ ID é®é¢ 4.2. åå¸å¼äºå¡é®é¢ 4.3. è·¨èç¹ Join åèå 4.4. è·¨åççæåºåé¡µ 5. ä¸­é´ä»¶ 6. åèèµæ",content:'# ååºåè¡¨åºæ¬åç\n\n\n# 1. ä¸ºä½è¦ååºåè¡¨\n\nååºåè¡¨ä¸»è¦åºäºä»¥ä¸çç±ï¼\n\n * å¹¶åè¿æ¥ - ååºè¶è¿æ¯ç§ 2000 ä¸ªå¹¶åæ¶ï¼èä¸ä¸ªå¥åº·çååºæå¥½ä¿æå¨æ¯ç§ 1000 ä¸ªå¹¶åå·¦å³ï¼ä¸è¦å¤ªå¤§ã\n * ç£çå®¹é - ç£çå®¹éå æ»¡ï¼ä¼å¯¼è´æå¡å¨ä¸å¯ç¨ã\n * SQL æ§è½ - åè¡¨æ°æ®éè¿å¤§ï¼ä¼å¯¼è´ SQL æ§è¡æçä½ä¸ãä¸è¬ï¼åè¡¨è¶è¿ 1000 ä¸æ¡æ°æ®ï¼å°±å¯ä»¥èèåè¡¨äºã\n\n#          ååºåè¡¨å               ååºåè¡¨å\nå¹¶åæ¯ææåµ     MySQL åæºé¨ç½²ï¼æä¸ä½é«å¹¶å   MySQL ä»åæºå°å¤æºï¼è½æ¿åçå¹¶åå¢å äºå¤å\nç£çä½¿ç¨æåµ     MySQL åæºç£çå®¹éå ä¹ææ»¡    æåä¸ºå¤ä¸ªåºï¼æ°æ®åºæå¡å¨ç£çä½¿ç¨çå¤§å¤§éä½\nSQL æ§è¡æ§è½   åè¡¨æ°æ®éå¤ªå¤§ï¼SQL è¶è·è¶æ¢    åè¡¨æ°æ®éåå°ï¼SQL æ§è¡æçææ¾æå\n\n\n# 2. ååºåè¡¨åç\n\næ°æ®åçææç§æä¸ªç»´åº¦å°å­æ¾å¨åä¸æ°æ®åºä¸­çæ°æ®åæ£å°å­æ¾è³å¤ä¸ªæ°æ®åºæè¡¨ä¸­ä»¥è¾¾å°æåæ§è½ç¶é¢ä»¥åå¯ç¨æ§çææã æ°æ®åççææææ®µæ¯å¯¹å³ç³»åæ°æ®åºè¿è¡ååºååè¡¨ãååºååè¡¨åå¯ä»¥ææçé¿åç±æ°æ®éè¶è¿å¯æ¿åéå¼èäº§ççæ¥è¯¢ç¶é¢ã é¤æ­¤ä¹å¤ï¼ååºè¿è½å¤ç¨äºææçåæ£å¯¹æ°æ®åºåç¹çè®¿é®éï¼åè¡¨è½ç¶æ æ³ç¼è§£æ°æ®åºååï¼ä½å´è½å¤æä¾å°½éå°åå¸å¼äºå¡è½¬åä¸ºæ¬å°äºå¡çå¯è½ï¼ä¸æ¦æ¶åå°è·¨åºçæ´æ°æä½ï¼åå¸å¼äºå¡å¾å¾ä¼ä½¿é®é¢åå¾å¤æã ä½¿ç¨å¤ä¸»å¤ä»çåçæ¹å¼ï¼å¯ä»¥ææçé¿åæ°æ®åç¹ï¼ä»èæåæ°æ®æ¶æçå¯ç¨æ§ã\n\néè¿ååºååè¡¨è¿è¡æ°æ®çæåæ¥ä½¿å¾åä¸ªè¡¨çæ°æ®éä¿æå¨éå¼ä»¥ä¸ï¼ä»¥åå¯¹æµéè¿è¡çå¯¼åºå¯¹é«è®¿é®éï¼æ¯åºå¯¹é«å¹¶ååæµ·éæ°æ®ç³»ç»çææææ®µã æ°æ®åççæåæ¹å¼ååä¸ºåç´åçåæ°´å¹³åçã\n\n\n# 2.1. åç´åç\n\nåç´åçæä¸¤ç§æåèéï¼ä¸å¡æååè®¿é®é¢çæå\n\nï¼1ï¼ä¸å¡æå\n\n> ä¸å¡æåçæ ¸å¿çå¿µæ¯ä¸åºä¸ç¨ã\n\nå¨æåä¹åï¼ä¸ä¸ªæ°æ®åºç±å¤ä¸ªæ°æ®è¡¨ææï¼æ¯ä¸ªè¡¨å¯¹åºçä¸åçä¸å¡ãèæåä¹åï¼åæ¯æç§ä¸å¡å°è¡¨è¿è¡å½ç±»ï¼åå¸å°ä¸åçæ°æ®åºä¸­ï¼ä»èå°åååæ£è³ä¸åçæ°æ®åºãä¸å¾å±ç¤ºäºæ ¹æ®ä¸å¡éè¦ï¼å°ç¨æ·è¡¨åè®¢åè¡¨åç´åçå°ä¸åçæ°æ®åºçæ¹æ¡ã\n\nåç´åçå¾å¾éè¦å¯¹æ¶æåè®¾è®¡è¿è¡è°æ´ãéå¸¸æ¥è®²ï¼æ¯æ¥ä¸ååºå¯¹äºèç½ä¸å¡éæ±å¿«éååçï¼èä¸ï¼å®ä¹å¹¶æ æ³çæ­£çè§£å³åç¹ç¶é¢ãåç´æåå¯ä»¥ç¼è§£æ°æ®éåè®¿é®éå¸¦æ¥çé®é¢ï¼ä½æ æ³æ ¹æ²»ãå¦æåç´æåä¹åï¼è¡¨ä¸­çæ°æ®éä¾ç¶è¶è¿åèç¹æè½æ¿è½½çéå¼ï¼åéè¦æ°´å¹³åçæ¥è¿ä¸æ­¥å¤çã\n\nï¼2ï¼è®¿é®é¢çæå\n\n> è®¿é®é¢çæåï¼æ¯ æä¸ä¸ªæå¾å¤å­æ®µçè¡¨ç»æåæå¤ä¸ªè¡¨ï¼æèæ¯å¤ä¸ªåºä¸å»ãä¸è¬æ¥è¯´ï¼ä¼ å°è¾å°çãè®¿é®é¢çè¾é«çå­æ®µæ¾å°ä¸ä¸ªè¡¨ä¸­ï¼ç¶å å°è¾å¤çãè®¿é®é¢çè¾ä½çå­æ®µæ¾å°å¦å¤ä¸ä¸ªè¡¨ä¸­ãå ä¸ºæ°æ®åºæ¯æç¼å­çï¼è®¿é®é¢çé«çè¡å­æ®µè¶å°ï¼å°±å¯ä»¥å¨ç¼å­éç¼å­æ´å¤çè¡ï¼æ§è½å°±è¶å¥½ãè¿ä¸ªä¸è¬å¨è¡¨å±é¢åçè¾å¤ä¸äºã\n\n\n\nä¸è¬æ¥è¯´ï¼æ»¡è¶³ä¸é¢çæ¡ä»¶å°±å¯ä»¥èèæ©å®¹äºï¼\n\n * Mysql ååºè¶è¿ 5000 ä¸æ¡è®°å½ï¼Oracle ååºè¶è¿ 1 äº¿æ¡è®°å½ï¼DB ååå°±å¾å¤§ã\n * ååºè¶è¿æ¯ç§ 2000 ä¸ªå¹¶åæ¶ï¼èä¸ä¸ªå¥åº·çååºæå¥½ä¿æå¨æ¯ç§ 1000 ä¸ªå¹¶åå·¦å³ï¼ä¸è¦å¤ªå¤§ã\n\nå¨æ°æ®åºçå±é¢ä½¿ç¨åç´ååå°ææ°æ®åºä¸­è¡¨çå¯éç¨åº¦é¨ç½²å°ä¸åçåºä¸­ï¼ä¾å¦å°åæ¥ççµåæ°æ®åºåç´ååæååæ°æ®åºãç¨æ·æ°æ®åºç­ã\n\n\n# 2.2. æ°´å¹³åç\n\n> æ°´å¹³æå åç§°ä¸º Shardingï¼å®æ¯å°åä¸ä¸ªè¡¨ä¸­çè®°å½æåå°å¤ä¸ªç»æç¸åçè¡¨ä¸­ãå½ åè¡¨æ°æ®éå¤ªå¤§ æ¶ï¼ä¼æå¤§å½±å SQL æ§è¡çæ§è½ ãåè¡¨æ¯å°åæ¥ä¸å¼ è¡¨çæ°æ®åå¸å°æ°æ®åºéç¾¤çä¸åèç¹ä¸ï¼ä»èç¼è§£åç¹çååã\n\nç¸å¯¹äºåç´åçï¼æ°´å¹³åçä¸åå°æ°æ®æ ¹æ®ä¸å¡é»è¾åç±»ï¼èæ¯éè¿æä¸ªå­æ®µï¼ææå ä¸ªå­æ®µï¼ï¼æ ¹æ®æç§è§åå°æ°æ®åæ£è³å¤ä¸ªåºæè¡¨ä¸­ï¼æ¯ä¸ªåçä»åå«æ°æ®çä¸é¨åã ä¾å¦ï¼æ ¹æ®ä¸»é®åçï¼å¶æ°ä¸»é®çè®°å½æ¾å¥ 0 åºï¼æè¡¨ï¼ï¼å¥æ°ä¸»é®çè®°å½æ¾å¥ 1 åºï¼æè¡¨ï¼ã\n\næ°´å¹³åçä»çè®ºä¸çªç ´äºåæºæ°æ®éå¤ççç¶é¢ï¼å¹¶ä¸æ©å±ç¸å¯¹èªç±ï¼æ¯ååºåè¡¨çæ åè§£å³æ¹æ¡ã\n\n\n\nä¸è¬æ¥è¯´ï¼åè¡¨æ 200 ä¸æ¡æ°æ® çæ¶åï¼æ§è½å°±ä¼ç¸å¯¹å·®ä¸äºäºï¼éè¦èèåè¡¨äºãä½æ¯ï¼è¿ä¹è¦è§å·ä½æåµèå®ï¼å¯è½æ¯ 100 ä¸æ¡ï¼ä¹å¯è½æ¯ 500 ä¸æ¡ï¼SQL è¶å¤æï¼å°±æå¥½è®©åè¡¨è¡æ°è¶å°ã\n\nè¯»ååç¦»çæ°æ®èç¹ä¸­çæ°æ®åå®¹æ¯ä¸è´çï¼èæ°´å¹³åççæ¯ä¸ªæ°æ®èç¹çæ°æ®åå®¹å´å¹¶ä¸ç¸åãå°æ°´å¹³åçåè¯»ååç¦»èåä½¿ç¨ï¼è½å¤æ´å ææçæåç³»ç»æ§è½ã\n\n\n# 2.3. ååºåè¡¨ç­ç¥\n\n\n\nååºåè¡¨ç­ç¥ä¸»è¦æä¸¤ç§ï¼\n\n * æ ¹æ®æ°å¼èå´åå\n * æ ¹æ® Hash åå\n\n# 2.3.1. æ°å¼èå´è·¯ç±\n\næ°å¼èå´è·¯ç±ï¼å°±æ¯æ ¹æ® IDãæ¶é´èå´ è¿ç±»å·ææåºæ§çå­æ®µæ¥è¿è¡ååãä¾å¦ï¼ç¨æ· Id ä¸º 1-9999 çè®°å½åå°ç¬¬ä¸ä¸ªåºï¼10000-20000 çåå°ç¬¬äºä¸ªåºï¼ä»¥æ­¤ç±»æ¨ã\n\næè¿ç§ç­ç¥åååºæ¥çæ°æ®ï¼å·ææ°æ®è¿ç»­æ§ã\n\nä¼ç¹ï¼æ°æ®è¿ç§»å¾ç®åã\n\nç¼ºç¹ï¼å®¹æäº§çç­ç¹é®é¢ï¼å¤§éçæµéé½æå¨ææ°çæ°æ®ä¸äºã\n\n# 2.3.2. Hash è·¯ç±\n\nå¸åç Hash è·¯ç±ï¼å¦æ ¹æ®æ°å¼åæ¨¡ï¼å½éè¦æ©å®¹æ¶ï¼ä¸è¬ä»¥ 2 çå¹æ¬¡æ¹è¿è¡æ©å®¹ï¼è¿æ ·ï¼æ©å®¹æ¶è¿ç§»çæ°æ®éä¼å°ä¸äºï¼ãä¾å¦ï¼ç¨æ· Id mod nï¼ä½æ°ä¸º 0 çè®°å½æ¾å°ç¬¬ä¸ä¸ªåºï¼ä½æ°ä¸º 1 çæ¾å°ç¬¬äºä¸ªåºï¼ä»¥æ­¤ç±»æ¨ã\n\nä¸è¬éç¨ é¢ååº çæ¹å¼ï¼æåæ ¹æ® æ°æ®é è§åå¥½ ååºæ°ï¼æ¯å¦ååä¸º 512 æ 1024 å¼ è¡¨ï¼ä¿è¯å¯æ¯ææªæ¥ä¸æ®µæ¶é´ç æ°æ®å®¹éï¼åæ ¹æ® è´è½½æåµ å° è¡¨ è¿ç§»å°å¶ä» æ°æ®åº ä¸­ãæ©å®¹æ¶éå¸¸éç¨ ç¿»åæ©å®¹ï¼é¿å æ°æ®æ å° å¨é¨è¢« æä¹±ï¼å¯¼è´ å¨éè¿ç§» çæåµã\n\nä¼ç¹ï¼æ°æ®ç¦»æ£åå¸ï¼ä¸å­å¨ç­ç¹é®é¢ã\n\nç¼ºç¹ï¼æ°æ®è¿ç§»ãæ©å®¹éº»ç¦ï¼ä¹åçæ°æ®éè¦éæ°è®¡ç® hash å¼éæ°åéå°ä¸åçåºæè¡¨ï¼ãå½ èç¹æ°é ååæ¶ï¼å¦ æ©å®¹ æ æ¶ç¼© èç¹ï¼æ°æ®èç¹ æ å°å³ç³» éè¦éæ°è®¡ç®ï¼ä¼å¯¼è´æ°æ®ç éæ°è¿ç§»ã\n\n# 2.3.3. è·¯ç±è¡¨\n\nè¿ç§ç­ç¥ï¼å°±æ¯ç¨ä¸å¼ ç¬ç«çè¡¨è®°å½è·¯ç±ä¿¡æ¯ã\n\nä¼ç¹ï¼ç®åãçµæ´»ï¼å°¤å¶æ¯å¨æ©å®¹ãè¿ç§»æ¶ï¼åªéè¦è¿ç§»æå®çæ°æ®ï¼ç¶åä¿®æ¹è·¯ç±è¡¨å³å¯ã\n\nç¼ºç¹ï¼æ¯æ¬¡æ¥è¯¢ï¼å¿é¡»åæ¥è·¯ç±è¡¨ï¼å¢å äº IO å¼éãå¹¶ä¸ï¼å¦æè·¯ç±è¡¨æ¬èº«å¤ªå¤§ï¼ä¹ä¼é¢ä¸´æ§è½ç¶é¢ï¼å¦ææ³å¯¹è·¯ç±è¡¨ååååºåè¡¨ï¼å°åºç°æ­»å¾ªç¯å¼çè·¯ç±ç®æ³éæ©é®é¢ã\n\n\n# 3. è¿ç§»åæ©å®¹\n\n\n# 3.1. åæºè¿ç§»/æ©å®¹ï¼ä¸æ¨èï¼\n\nåæºè¿ç§»/æ©å®¹æ¯ææ´åãæç®åçè¿ç§»ãæ©å®¹æ¹æ¡ã\n\n\n\n# 3.1.1. åæºè¿ç§»/æ©å®¹æµç¨\n\nï¼0ï¼é¢ä¼°åææ¶é´ï¼åå¸åæå¬åã\n\nï¼1ï¼åæï¼ä¸åè®¸æ°æ®è®¿é®ã\n\nï¼2ï¼ç¼åä¸´æ¶çæ°æ®å¯¼å¥ç¨åºï¼ä»èæ°æ®åºä¸­è¯»åæ°æ®ã\n\nï¼3ï¼å°æ°æ®åå¥ä¸­é´ä»¶ã\n\nï¼4ï¼ä¸­é´ä»¶æ ¹æ®åçè§åï¼å°æ°æ®ååå°ååºï¼åè¡¨ï¼ä¸­ã\n\nï¼5ï¼åºç¨ç¨åºä¿®æ¹éç½®ï¼éå¯ã\n\n# 3.1.2. åæºè¿ç§»/æ©å®¹æ¹æ¡åæ\n\nä¼ç¹ï¼ç®åãæ²¡ææ°æ®ä¸è´æ§é®é¢ã\n\nç¼ºç¹ï¼å¦æèçæ°æ®åºæ°æ®éå¾å¤§ï¼ååæºå¤çæ¶é´å¯è½å¾ä¹ãæ¯å¦èçæ°æ®åºæ¯å·²ç»ååºåè¡¨çæ°æ®åºç¾¤ï¼æ°æ®éå¯è½è¾¾å°äº¿çº§ï¼å¯¼å¥æ°æ®å¯è½å°±è¦è±è´¹å å°æ¶ãå¦æä¸­é´è¿ç¨ä¸­åºç°é®é¢ï¼å°±å®¹æå¼åéå¤§äºæã\n\nç¹è¯ï¼ç»¼ä¸ï¼è¿ç§æ¹æ¡ä»£ä»·å¤ªé«ï¼ä¸å¯åã\n\n\n# 3.2. ååè¿ç§»\n\nååè¿ç§»çæ¹é æ¹æ¡å¦ä¸ï¼\n\n * æ¯æååæ°æ§ä¸¤ä¸ªåºï¼å¹¶ä¸é¢çç­åæ¢å¼å³ï¼è½éè¿å¼å³æ§å¶ä¸ç§åç¶æï¼åªåæ§åºãåªåæ°åºååæ­¥ååã\n * æ¯æè¯»æ°æ§ä¸¤ä¸ªåºï¼åæ ·é¢çç­åæ¢å¼å³ï¼æ§å¶è¯»æ§åºè¿æ¯æ°åºã\n\nç¶åä¸çº¿æ°çæå¡ï¼è¿ä¸ªæ¶åæå¡ä»ç¶æ¯åªè¯»åæ§åºï¼ä¸è¯»åæ°åºãæ°çæå¡éè¦ç¨³å®è¿è¡è³å°ä¸å°äºå¨çæ¶é´ï¼æé´é¤äºéªè¯æ°çæå¡çç¨³å®æ§ä»¥å¤ï¼è¿è¦éªè¯æ°æ§ä¸¤ä¸ªåºä¸­çæ°æ®æ¯å¦æ¯ä¸è´çãè¿ä¸ªè¿ç¨ä¸­ï¼å¦ææ°çæå¡æé®é¢ï¼å¯ä»¥ç«å³ä¸çº¿æ°çæå¡ï¼åæ»å°æ§çæ¬çæå¡ã\n\nç¨³å®ä¸æ®µæ¶é´ä¹åï¼å°±å¯ä»¥å¼å¯æå¡çååå¼å³äºãå¼å¯ååå¼å³çåæ¶ï¼éè¦åæåæ­¥ç¨åºãè¿éé¢æä¸ä¸ªé®é¢éè¦æ³¨æä¸ä¸ï¼å°±æ¯è¿ä¸ªååçä¸å¡é»è¾ï¼ä¸å®æ¯ååæ§åºï¼ååæ°åºï¼å¹¶ä¸ä»¥åæ§åºçç»æä¸ºåã\n\næ§åºåæåï¼æ°åºåå¤±è´¥ï¼è¿ååæåï¼ä½è¿ä¸ªæ¶åè¦è®°å½æ¥å¿ï¼åç»­æä»¬ä¼ç¨å°è¿ä¸ªæ¥å¿æ¥éªè¯æ°åºæ¯å¦è¿æé®é¢ãæ§åºåå¤±è´¥ï¼ç´æ¥è¿åå¤±è´¥ï¼å°±ä¸åæ°åºäºãè¿ä¹åçåå æ¯ï¼ä¸è½è®©æ°åºå½±åå°ç°æä¸å¡çå¯ç¨æ§åæ°æ®åç¡®æ§ãä¸é¢è¿ä¸ªè¿ç¨å¦æåºç°é®é¢ï¼å¯ä»¥å³é­ååï¼åæ»å°åªè¯»åæ§åºçç¶æã\n\nåæ¢å°ååä¹åï¼æ°åºä¸æ§åºçæ°æ®å¯è½ä¼å­å¨ä¸ä¸è´çæåµï¼åå æä¸¤ä¸ªï¼ä¸ãåæ­¢åæ­¥ç¨åºåå¼å¯ååï¼è¿ä¸¤ä¸ªè¿ç¨å¾é¾åå°æ ç¼è¡æ¥ï¼äºãååçç­ç¥ä¹ä¸ä¿è¯æ°æ§åºå¼ºä¸è´ï¼è¿æ¶åæä»¬éè¦ä¸çº¿ä¸ä¸ªå¯¹æ¯åè¡¥å¿çç¨åºï¼è¿ä¸ªç¨åºå¯¹æ¯æ§åºæè¿çæ°æ®åæ´ï¼ç¶åæ£æ¥æ°åºä¸­çæ°æ®æ¯å¦ä¸è´ï¼å¦æä¸ä¸è´ï¼è¿è¦è¿è¡è¡¥å¿ã\n\nå¼å¯åååï¼è¿éè¦è³å°ç¨³å®è¿è¡è³å°å å¨çæ¶é´ï¼å¹¶ä¸æé´æä»¬è¦ä¸æ­å°æ£æ¥ï¼ç¡®ä¿ä¸è½ææ§åºåæåï¼æ°åºåå¤±è´¥çæåµåºç°ãå¯¹æ¯ç¨åºä¹æ²¡æåç°æ°æ§ä¸¤ä¸ªåºçæ°æ®æä¸ä¸è´çæåµï¼è¿ä¸ªæ¶åï¼æä»¬å°±å¯ä»¥è®¤ä¸ºï¼æ°æ§ä¸¤ä¸ªåºçæ°æ®æ¯ä¸ç´ä¿æåæ­¥çãæ¥ä¸æ¥å°±å¯ä»¥ç¨ç±»ä¼¼ç°åº¦åå¸çæ¹å¼ï¼æè¯»è¯·æ±ä¸ç¹å¿ä¸ç¹å¿å°åå°æ°åºä¸ãåæ ·ï¼æé´å¦æåºé®é¢çè¯ï¼å¯ä»¥åååæ§åºãå¨é¨è¯»è¯·æ±é½åæ¢å°æ°åºä¸ä¹åï¼è¿ä¸ªæ¶åå¶å®è¯»åè¯·æ±å°±å·²ç»é½åæ¢å°æ°åºä¸äºï¼å®éçåæ¢å·²ç»å®æäºï¼ä½è¿æåç»­çæ¶å°¾æ­¥éª¤ã\n\n\n\n# 3.2.1. ååè¿ç§»æµç¨\n\n 1. ä¿®æ¹åºç¨ç¨åºéç½®ï¼å°æ°æ®åæ¶åå¥èæ°æ®åºåä¸­é´ä»¶ãè¿å°±æ¯æè°çååï¼åæ¶åä¿©åºï¼èåºåæ°åºã\n\n 2. ç¼åä¸´æ¶ç¨åºï¼è¯»åèæ°æ®åºã\n\n 3. å°æ°æ®åå¥ä¸­é´ä»¶ãå¦ææ°æ®ä¸å­å¨ï¼ç´æ¥åå¥ï¼å¦ææ°æ®å­å¨ï¼æ¯è¾æ¶é´æ³ï¼åªåè®¸æ°æ°æ®è¦çèæ°æ®ã\n\n 4. å¯¼å¥æ°æ®åï¼æå¯è½æ°æ®è¿æ¯å­å¨ä¸ä¸è´ï¼é£ä¹å°±å¯¹æ°æ®è¿è¡æ ¡éªï¼æ¯å¯¹æ°èåºçæ¯æ¡æ°æ®ãå¦æå­å¨å·®å¼ï¼éå¯¹å·®å¼æ°æ®ï¼æ§è¡ï¼3ï¼ãå¾ªç¯ï¼3ï¼ãï¼4ï¼æ­¥éª¤ï¼ç´è³æ°æ®å®å¨ä¸è´ã\n\n 5. ä¿®æ¹åºç¨ç¨åºéç½®ï¼å°æ°æ®åªåå¥ä¸­é´ä»¶ã\n\n 6. ä¸­é´ä»¶æ ¹æ®åçè§åï¼å°æ°æ®ååå°ååºï¼åè¡¨ï¼ä¸­ã\n\n\n# 3.3. ä¸»ä»åçº§\n\nçäº§ç¯å¢çæ°æ®åºï¼ä¸ºäºä¿è¯é«å¯ç¨ï¼ä¸è¬ä¼éç¨ä¸»å¤æ¶æãä¸»åºæ¯æè¯»åæä½ï¼ä»åºæ¯æè¯»æä½ã\n\n\n\nç±äºä¸»å¤èç¹æ°æ®ä¸è´ï¼æä»¥å°ä»åºåçº§ä¸ºä¸»èç¹ï¼å¹¶ä¿®æ¹åçéç½®ï¼å°ä»èç¹ä½ä¸ºååºä¹ä¸ï¼å°±å®ç°äºæ©å®¹ã\n\n\n\n# 3.3.1. åçº§ä»åºçæµç¨\n\nï¼1ï¼è§£é¤ä¸»ä»å³ç³»ï¼ä»åºåçº§ä¸ºä¸»åºã\n\nï¼2ï¼åºç¨ç¨åºï¼ä¿®æ¹éç½®ï¼è¯»åéè¿ä¸­é´ä»¶ã\n\nï¼3ï¼ååºåè¡¨ä¸­é´ï¼ä¿®æ¹åçéç½®ãå°æ°æ®æç§æ°çè§åååã\n\nï¼4ï¼ç¼åä¸´æ¶ç¨åºï¼æ¸çåä½æ°æ®ãæ¯å¦ï¼åæ¥æ¯ä¸ä¸ªååºï¼æ°æ®éä¸º 400 ä¸ãä»èç¹åçº§ä¸ºååºä¹ä¸åï¼æ¯ä¸ªååºé½æ 400 ä¸æ°æ®ï¼å¶ä¸­ 200 ä¸æ¯åä½æ°æ®ãæ¸çå®åï¼è¿è¡æ°æ®æ ¡éªã\n\nï¼5ï¼ä¸ºæ¯ä¸ªååºæ·»å æ°çä»åºï¼ä¿è¯é«å¯ç¨ã\n\n# 3.3.2. åçº§ä»åºæ¹æ¡åæ\n\nä¼ç¹ï¼ä¸éè¦åæºï¼æ éæ°æ®è¿ç§»ã\n\n\n# 4. ååºåè¡¨çé®é¢\n\n\n# 4.1. åå¸å¼ ID é®é¢\n\nä¸æ¦æ°æ®åºè¢«ååå°å¤ä¸ªç©çç»ç¹ä¸ï¼æä»¬å°ä¸è½åä¾èµæ°æ®åºèªèº«çä¸»é®çææºå¶ãä¸æ¹é¢ï¼æä¸ªååºæ°æ®åºèªçæç ID æ æ³ä¿è¯å¨å¨å±ä¸æ¯å¯ä¸çï¼å¦ä¸æ¹é¢ï¼åºç¨ç¨åºå¨æå¥æ°æ®ä¹åéè¦åè·å¾ IDï¼ä»¥ä¾¿è¿è¡ SQL è·¯ç±ã\n\n> åå¸å¼ ID çè§£å³æ¹æ¡è¯¦è§ï¼åå¸å¼ ID\n\n\n# 4.2. åå¸å¼äºå¡é®é¢\n\nè·¨åºäºå¡ä¹æ¯åå¸å¼çæ°æ®åºéç¾¤è¦é¢å¯¹çæ£æäºæã åçéç¨åè¡¨ï¼å¯ä»¥å¨éä½åè¡¨æ°æ®éçæåµä¸ï¼å°½éä½¿ç¨æ¬å°äºå¡ï¼åäºä½¿ç¨ååºä¸åè¡¨å¯ææé¿ååå¸å¼äºå¡å¸¦æ¥çéº»ç¦ãå¨ä¸è½é¿åè·¨åºäºå¡çåºæ¯ï¼æäºä¸å¡ä»ç¶éè¦ä¿æäºå¡çä¸è´æ§ã èåºäº XA çåå¸å¼äºå¡ç±äºå¨å¹¶ååº¦é«çåºæ¯ä¸­æ§è½æ æ³æ»¡è¶³éè¦ï¼å¹¶æªè¢«äºèç½å·¨å¤´å¤§è§æ¨¡ä½¿ç¨ï¼ä»ä»¬å¤§å¤éç¨æç»ä¸è´æ§çææ§äºå¡ä»£æ¿å¼ºä¸è´äºå¡ã\n\n> åå¸å¼äºå¡çè§£å³æ¹æ¡è¯¦è§ï¼åå¸å¼äºå¡\n\n\n# 4.3. è·¨èç¹ Join åèå\n\nååºåè¡¨åï¼æ æ³ç´æ¥è·¨èç¹ join ãcountãorder byãgroup by ä»¥åèåã\n\néå¯¹è¿ç±»é®é¢ï¼æ®éåæ³æ¯äºæ¬¡æ¥è¯¢ã\n\nå¨ç¬¬ä¸æ¬¡æ¥è¯¢æ¶ï¼è·ååä¸ªèç¹ä¸çç»æã\n\nå¨ç¨åºä¸­å°è¿äºç»æè¿è¡åå¹¶ãç­éã\n\n\n# 4.4. è·¨åççæåºåé¡µ\n\nä¸è¬æ¥è®²ï¼åé¡µæ¶éè¦æç§æå®å­æ®µè¿è¡æåºãå½æåºå­æ®µå°±æ¯åçå­æ®µçæ¶åï¼æä»¬éè¿åçè§åå¯ä»¥æ¯è¾å®¹æå®ä½å°æå®çåçï¼èå½æåºå­æ®µéåçå­æ®µçæ¶åï¼æåµå°±ä¼åå¾æ¯è¾å¤æäºãä¸ºäºæç»ç»æçåç¡®æ§ï¼æä»¬éè¦å¨ä¸åçåçèç¹ä¸­å°æ°æ®è¿è¡æåºå¹¶è¿åï¼å¹¶å°ä¸ååçè¿åçç»æéè¿è¡æ±æ»ååæ¬¡æåºï¼æååè¿åç»ç¨æ·ãå¦ä¸å¾æç¤ºï¼\n\n\n\nä¸é¢å¾ä¸­ææè¿°çåªæ¯æç®åçä¸ç§æåµï¼åç¬¬ä¸é¡µæ°æ®ï¼ï¼çèµ·æ¥å¯¹æ§è½çå½±åå¹¶ä¸å¤§ãä½æ¯ï¼å¦ææ³ååºç¬¬ 10 é¡µæ°æ®ï¼æåµåå°åå¾å¤æå¾å¤ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\næäºè¯»èå¯è½å¹¶ä¸å¤ªçè§£ï¼ä¸ºä»ä¹ä¸è½åè·åç¬¬ä¸é¡µæ°æ®é£æ ·ç®åå¤çï¼æåºååºå 10 æ¡ååå¹¶ãæåºï¼ãå¶å®å¹¶ä¸é¾çè§£ï¼å ä¸ºååçèç¹ä¸­çæ°æ®å¯è½æ¯éæºçï¼ä¸ºäºæåºçåç¡®æ§ï¼å¿é¡»æææåçèç¹çå N é¡µæ°æ®é½æåºå¥½åååå¹¶ï¼æååè¿è¡æ´ä½çæåºãå¾æ¾ç¶ï¼è¿æ ·çæä½æ¯æ¯è¾æ¶èèµæºçï¼ç¨æ·è¶å¾åç¿»é¡µï¼ç³»ç»æ§è½å°ä¼è¶å·®ã\n\né£å¦ä½è§£å³ååºæåµä¸çåé¡µé®é¢å¢ï¼æä»¥ä¸å ç§åæ³ï¼\n\nå¦ææ¯å¨åå°åºç¨æä¾åé¡µï¼åéå®ç¨æ·åªè½çåé¢ n é¡µï¼è¿ä¸ªéå¶å¨ä¸å¡ä¸ä¹æ¯åççï¼ä¸è¬çåé¢çåé¡µæä¹ä¸å¤§ï¼å¦æä¸å®è¦çï¼å¯ä»¥è¦æ±ç¨æ·ç¼©å°èå´éæ°æ¥è¯¢ï¼ã\n\nå¦ææ¯åå°æ¹å¤çä»»å¡è¦æ±åæ¹è·åæ°æ®ï¼åå¯ä»¥å å¤§ page sizeï¼æ¯å¦æ¯æ¬¡è·å 5000 æ¡è®°å½ï¼ææåå°åé¡µæ°ï¼å½ç¶ç¦»çº¿è®¿é®ä¸è¬èµ°å¤åºï¼é¿åå²å»ä¸»åºï¼ã\n\nååºè®¾è®¡æ¶ï¼ä¸è¬è¿æéå¥å¤§æ°æ®å¹³å°æ±æ»ææååºçè®°å½ï¼æäºåé¡µæ¥è¯¢å¯ä»¥èèèµ°å¤§æ°æ®å¹³å°ã\n\n\n# 5. ä¸­é´ä»¶\n\nå½åå¸¸è§ååºåè¡¨ä¸­é´ä»¶ï¼\n\n * Cobar - é¿é b2b å¢éå¼ååå¼æºçï¼å±äº proxy å±æ¹æ¡ï¼å°±æ¯ä»äºåºç¨æå¡å¨åæ°æ®åºæå¡å¨ä¹é´ãåºç¨ç¨åºéè¿ JDBC é©±å¨è®¿é® cobar éç¾¤ï¼cobar æ ¹æ® SQL åååºè§åå¯¹ SQL ååè§£ï¼ç¶åååå° MySQL éç¾¤ä¸åçæ°æ®åºå®ä¾ä¸æ§è¡ãæ©äºå¹´è¿å¯ä»¥ç¨ï¼ä½æ¯æè¿å å¹´é½æ²¡æ´æ°äºï¼åºæ¬æ²¡å¥äººç¨ï¼å·®ä¸å¤ç®æ¯è¢«æå¼çç¶æå§ãèä¸ä¸æ¯æè¯»ååç¦»ãå­å¨è¿ç¨ãè·¨åº join ååé¡µç­æä½ã\n * TDDL - æ·å®å¢éå¼åçï¼å±äº client å±æ¹æ¡ãæ¯æåºæ¬ç crud è¯­æ³åè¯»ååç¦»ï¼ä½ä¸æ¯æ joinãå¤è¡¨æ¥è¯¢ç­è¯­æ³ãç®åä½¿ç¨çä¹ä¸å¤ï¼å ä¸ºè¿ä¾èµæ·å®ç diamond éç½®ç®¡çç³»ç»ã\n * Atlas - 360 å¼æºçï¼å±äº proxy å±æ¹æ¡ï¼ä»¥åæ¯æä¸äºå¬å¸å¨ç¨çï¼ä½æ¯ç¡®å®æä¸ä¸ªå¾å¤§çé®é¢å°±æ¯ç¤¾åºææ°çç»´æ¤é½å¨ 5 å¹´åäºãæä»¥ï¼ç°å¨ç¨çå¬å¸åºæ¬ä¹å¾å°äºã\n * sharding-jdbc - å½å½å¼æºçï¼å±äº client å±æ¹æ¡ãç¡®å®ä¹åç¨çè¿æ¯è¾å¤ä¸äºï¼å ä¸º SQL è¯­æ³æ¯æä¹æ¯è¾å¤ï¼æ²¡æå¤ªå¤éå¶ï¼èä¸ç®åæ¨åºå°äº 2.0 çæ¬ï¼æ¯æååºåè¡¨ãè¯»ååç¦»ãåå¸å¼ id çæãææ§äºå¡ï¼æå¤§åªåéè¾¾åäºå¡ãTCC äºå¡ï¼ãèä¸ç¡®å®ä¹åä½¿ç¨çå¬å¸ä¼æ¯è¾å¤ä¸äºï¼è¿ä¸ªå¨å®ç½æç»è®°ä½¿ç¨çå¬å¸ï¼å¯ä»¥çå°ä» 2017 å¹´ä¸ç´å°ç°å¨ï¼æ¯æä¸å°å¬å¸å¨ç¨çï¼ï¼ç®åç¤¾åºä¹è¿ä¸ç´å¨å¼ååç»´æ¤ï¼è¿ç®æ¯æ¯è¾æ´»è·ï¼ä¸ªäººè®¤ä¸ºç®æ¯ä¸ä¸ªç°å¨ä¹å¯ä»¥éæ©çæ¹æ¡ã\n * Mycat - åºäº cobar æ¹é çï¼å±äº proxy å±æ¹æ¡ï¼æ¯æçåè½éå¸¸å®åï¼èä¸ç®ååºè¯¥æ¯éå¸¸ç«çèä¸ä¸æ­æµè¡çæ°æ®åºä¸­é´ä»¶ï¼ç¤¾åºå¾æ´»è·ï¼ä¹æä¸äºå¬å¸å¼å§å¨ç¨äºãä½æ¯ç¡®å®ç¸æ¯äº sharding jdbc æ¥è¯´ï¼å¹´è½»ä¸äºï¼ç»åçé¤ç¼å°ä¸äºã\n\nææ¯éåå»ºè®®ï¼\n\nå»ºè®®ä½¿ç¨çæ¯ sharding-jdbc å mycatã\n\n * sharding-jdbc è¿ç§ client å±æ¹æ¡çä¼ç¹å¨äºä¸ç¨é¨ç½²ï¼è¿ç»´ææ¬ä½ï¼ä¸éè¦ä»£çå±çäºæ¬¡è½¬åè¯·æ±ï¼æ§è½å¾é«ï¼ä½æ¯å¦æéå°åçº§å¥çéè¦åä¸ªç³»ç»é½éæ°åçº§çæ¬ååå¸ï¼åä¸ªç³»ç»é½éè¦è¦å sharding-jdbc çä¾èµãå¶æ¬è´¨ä¸éè¿éç½®å¤æ°æ®æºï¼ç¶åæ ¹æ®è®¾å®çååºåè¡¨ç­ç¥ï¼è®¡ç®è·¯ç±ï¼å°è¯·æ±åéå°è®¡ç®å¾å°çèç¹ä¸ã\n * Mycat è¿ç§ proxy å±æ¹æ¡çç¼ºç¹å¨äºéè¦é¨ç½²ï¼èªå·±è¿ç»´ä¸å¥ä¸­é´ä»¶ï¼è¿ç»´ææ¬é«ï¼ä½æ¯å¥½å¤å¨äºå¯¹äºåä¸ªé¡¹ç®æ¯éæçï¼å¦æéå°åçº§ä¹ç±»çé½æ¯èªå·±ä¸­é´ä»¶é£éæå°±è¡äºã\n\néå¸¸æ¥è¯´ï¼è¿ä¸¤ä¸ªæ¹æ¡å¶å®é½å¯ä»¥éç¨ï¼ä½æ¯æä¸ªäººå»ºè®®ä¸­å°åå¬å¸éç¨ sharding-jdbcï¼client å±æ¹æ¡è½»ä¾¿ï¼èä¸ç»´æ¤ææ¬ä½ï¼ä¸éè¦é¢å¤å¢æ´¾äººæï¼èä¸ä¸­å°åå¬å¸ç³»ç»å¤æåº¦ä¼ä½ä¸äºï¼é¡¹ç®ä¹æ²¡é£ä¹å¤ï¼ä½æ¯ä¸­å¤§åå¬å¸æå¥½è¿æ¯éç¨ mycat è¿ç±» proxy å±æ¹æ¡ï¼å ä¸ºå¯è½å¤§å¬å¸ç³»ç»åé¡¹ç®éå¸¸å¤ï¼å¢éå¾å¤§ï¼äººååè¶³ï¼é£ä¹æå¥½æ¯ä¸é¨å¼ä¸ªäººæ¥ç ç©¶åç»´æ¤ mycatï¼ç¶åå¤§éé¡¹ç®ç´æ¥éæä½¿ç¨å³å¯ã\n\n\n# 6. åèèµæ\n\n * åç«¯å­å¨å®æè¯¾\n * ShardingSphere å®æ¹ææ¡£\n * âååºåè¡¨" ï¼éååæµç¨è¦æéï¼å¦åä¼å¤±æ§\n * ååºåè¡¨éè¦èèçé®é¢åæ¹æ¡\n * ä¸æ¬¡é¾å¾çååºåè¡¨å®è·µ\n * ååºåè¡¨å¹³æ»æ©å®¹',normalizedContent:'# ååºåè¡¨åºæ¬åç\n\n\n# 1. ä¸ºä½è¦ååºåè¡¨\n\nååºåè¡¨ä¸»è¦åºäºä»¥ä¸çç±ï¼\n\n * å¹¶åè¿æ¥ - ååºè¶è¿æ¯ç§ 2000 ä¸ªå¹¶åæ¶ï¼èä¸ä¸ªå¥åº·çååºæå¥½ä¿æå¨æ¯ç§ 1000 ä¸ªå¹¶åå·¦å³ï¼ä¸è¦å¤ªå¤§ã\n * ç£çå®¹é - ç£çå®¹éå æ»¡ï¼ä¼å¯¼è´æå¡å¨ä¸å¯ç¨ã\n * sql æ§è½ - åè¡¨æ°æ®éè¿å¤§ï¼ä¼å¯¼è´ sql æ§è¡æçä½ä¸ãä¸è¬ï¼åè¡¨è¶è¿ 1000 ä¸æ¡æ°æ®ï¼å°±å¯ä»¥èèåè¡¨äºã\n\n#          ååºåè¡¨å               ååºåè¡¨å\nå¹¶åæ¯ææåµ     mysql åæºé¨ç½²ï¼æä¸ä½é«å¹¶å   mysql ä»åæºå°å¤æºï¼è½æ¿åçå¹¶åå¢å äºå¤å\nç£çä½¿ç¨æåµ     mysql åæºç£çå®¹éå ä¹ææ»¡    æåä¸ºå¤ä¸ªåºï¼æ°æ®åºæå¡å¨ç£çä½¿ç¨çå¤§å¤§éä½\nsql æ§è¡æ§è½   åè¡¨æ°æ®éå¤ªå¤§ï¼sql è¶è·è¶æ¢    åè¡¨æ°æ®éåå°ï¼sql æ§è¡æçææ¾æå\n\n\n# 2. ååºåè¡¨åç\n\næ°æ®åçææç§æä¸ªç»´åº¦å°å­æ¾å¨åä¸æ°æ®åºä¸­çæ°æ®åæ£å°å­æ¾è³å¤ä¸ªæ°æ®åºæè¡¨ä¸­ä»¥è¾¾å°æåæ§è½ç¶é¢ä»¥åå¯ç¨æ§çææã æ°æ®åççææææ®µæ¯å¯¹å³ç³»åæ°æ®åºè¿è¡ååºååè¡¨ãååºååè¡¨åå¯ä»¥ææçé¿åç±æ°æ®éè¶è¿å¯æ¿åéå¼èäº§ççæ¥è¯¢ç¶é¢ã é¤æ­¤ä¹å¤ï¼ååºè¿è½å¤ç¨äºææçåæ£å¯¹æ°æ®åºåç¹çè®¿é®éï¼åè¡¨è½ç¶æ æ³ç¼è§£æ°æ®åºååï¼ä½å´è½å¤æä¾å°½éå°åå¸å¼äºå¡è½¬åä¸ºæ¬å°äºå¡çå¯è½ï¼ä¸æ¦æ¶åå°è·¨åºçæ´æ°æä½ï¼åå¸å¼äºå¡å¾å¾ä¼ä½¿é®é¢åå¾å¤æã ä½¿ç¨å¤ä¸»å¤ä»çåçæ¹å¼ï¼å¯ä»¥ææçé¿åæ°æ®åç¹ï¼ä»èæåæ°æ®æ¶æçå¯ç¨æ§ã\n\néè¿ååºååè¡¨è¿è¡æ°æ®çæåæ¥ä½¿å¾åä¸ªè¡¨çæ°æ®éä¿æå¨éå¼ä»¥ä¸ï¼ä»¥åå¯¹æµéè¿è¡çå¯¼åºå¯¹é«è®¿é®éï¼æ¯åºå¯¹é«å¹¶ååæµ·éæ°æ®ç³»ç»çææææ®µã æ°æ®åççæåæ¹å¼ååä¸ºåç´åçåæ°´å¹³åçã\n\n\n# 2.1. åç´åç\n\nåç´åçæä¸¤ç§æåèéï¼ä¸å¡æååè®¿é®é¢çæå\n\nï¼1ï¼ä¸å¡æå\n\n> ä¸å¡æåçæ ¸å¿çå¿µæ¯ä¸åºä¸ç¨ã\n\nå¨æåä¹åï¼ä¸ä¸ªæ°æ®åºç±å¤ä¸ªæ°æ®è¡¨ææï¼æ¯ä¸ªè¡¨å¯¹åºçä¸åçä¸å¡ãèæåä¹åï¼åæ¯æç§ä¸å¡å°è¡¨è¿è¡å½ç±»ï¼åå¸å°ä¸åçæ°æ®åºä¸­ï¼ä»èå°åååæ£è³ä¸åçæ°æ®åºãä¸å¾å±ç¤ºäºæ ¹æ®ä¸å¡éè¦ï¼å°ç¨æ·è¡¨åè®¢åè¡¨åç´åçå°ä¸åçæ°æ®åºçæ¹æ¡ã\n\nåç´åçå¾å¾éè¦å¯¹æ¶æåè®¾è®¡è¿è¡è°æ´ãéå¸¸æ¥è®²ï¼æ¯æ¥ä¸ååºå¯¹äºèç½ä¸å¡éæ±å¿«éååçï¼èä¸ï¼å®ä¹å¹¶æ æ³çæ­£çè§£å³åç¹ç¶é¢ãåç´æåå¯ä»¥ç¼è§£æ°æ®éåè®¿é®éå¸¦æ¥çé®é¢ï¼ä½æ æ³æ ¹æ²»ãå¦æåç´æåä¹åï¼è¡¨ä¸­çæ°æ®éä¾ç¶è¶è¿åèç¹æè½æ¿è½½çéå¼ï¼åéè¦æ°´å¹³åçæ¥è¿ä¸æ­¥å¤çã\n\nï¼2ï¼è®¿é®é¢çæå\n\n> è®¿é®é¢çæåï¼æ¯ æä¸ä¸ªæå¾å¤å­æ®µçè¡¨ç»æåæå¤ä¸ªè¡¨ï¼æèæ¯å¤ä¸ªåºä¸å»ãä¸è¬æ¥è¯´ï¼ä¼ å°è¾å°çãè®¿é®é¢çè¾é«çå­æ®µæ¾å°ä¸ä¸ªè¡¨ä¸­ï¼ç¶å å°è¾å¤çãè®¿é®é¢çè¾ä½çå­æ®µæ¾å°å¦å¤ä¸ä¸ªè¡¨ä¸­ãå ä¸ºæ°æ®åºæ¯æç¼å­çï¼è®¿é®é¢çé«çè¡å­æ®µè¶å°ï¼å°±å¯ä»¥å¨ç¼å­éç¼å­æ´å¤çè¡ï¼æ§è½å°±è¶å¥½ãè¿ä¸ªä¸è¬å¨è¡¨å±é¢åçè¾å¤ä¸äºã\n\n\n\nä¸è¬æ¥è¯´ï¼æ»¡è¶³ä¸é¢çæ¡ä»¶å°±å¯ä»¥èèæ©å®¹äºï¼\n\n * mysql ååºè¶è¿ 5000 ä¸æ¡è®°å½ï¼oracle ååºè¶è¿ 1 äº¿æ¡è®°å½ï¼db ååå°±å¾å¤§ã\n * ååºè¶è¿æ¯ç§ 2000 ä¸ªå¹¶åæ¶ï¼èä¸ä¸ªå¥åº·çååºæå¥½ä¿æå¨æ¯ç§ 1000 ä¸ªå¹¶åå·¦å³ï¼ä¸è¦å¤ªå¤§ã\n\nå¨æ°æ®åºçå±é¢ä½¿ç¨åç´ååå°ææ°æ®åºä¸­è¡¨çå¯éç¨åº¦é¨ç½²å°ä¸åçåºä¸­ï¼ä¾å¦å°åæ¥ççµåæ°æ®åºåç´ååæååæ°æ®åºãç¨æ·æ°æ®åºç­ã\n\n\n# 2.2. æ°´å¹³åç\n\n> æ°´å¹³æå åç§°ä¸º shardingï¼å®æ¯å°åä¸ä¸ªè¡¨ä¸­çè®°å½æåå°å¤ä¸ªç»æç¸åçè¡¨ä¸­ãå½ åè¡¨æ°æ®éå¤ªå¤§ æ¶ï¼ä¼æå¤§å½±å sql æ§è¡çæ§è½ ãåè¡¨æ¯å°åæ¥ä¸å¼ è¡¨çæ°æ®åå¸å°æ°æ®åºéç¾¤çä¸åèç¹ä¸ï¼ä»èç¼è§£åç¹çååã\n\nç¸å¯¹äºåç´åçï¼æ°´å¹³åçä¸åå°æ°æ®æ ¹æ®ä¸å¡é»è¾åç±»ï¼èæ¯éè¿æä¸ªå­æ®µï¼ææå ä¸ªå­æ®µï¼ï¼æ ¹æ®æç§è§åå°æ°æ®åæ£è³å¤ä¸ªåºæè¡¨ä¸­ï¼æ¯ä¸ªåçä»åå«æ°æ®çä¸é¨åã ä¾å¦ï¼æ ¹æ®ä¸»é®åçï¼å¶æ°ä¸»é®çè®°å½æ¾å¥ 0 åºï¼æè¡¨ï¼ï¼å¥æ°ä¸»é®çè®°å½æ¾å¥ 1 åºï¼æè¡¨ï¼ã\n\næ°´å¹³åçä»çè®ºä¸çªç ´äºåæºæ°æ®éå¤ççç¶é¢ï¼å¹¶ä¸æ©å±ç¸å¯¹èªç±ï¼æ¯ååºåè¡¨çæ åè§£å³æ¹æ¡ã\n\n\n\nä¸è¬æ¥è¯´ï¼åè¡¨æ 200 ä¸æ¡æ°æ® çæ¶åï¼æ§è½å°±ä¼ç¸å¯¹å·®ä¸äºäºï¼éè¦èèåè¡¨äºãä½æ¯ï¼è¿ä¹è¦è§å·ä½æåµèå®ï¼å¯è½æ¯ 100 ä¸æ¡ï¼ä¹å¯è½æ¯ 500 ä¸æ¡ï¼sql è¶å¤æï¼å°±æå¥½è®©åè¡¨è¡æ°è¶å°ã\n\nè¯»ååç¦»çæ°æ®èç¹ä¸­çæ°æ®åå®¹æ¯ä¸è´çï¼èæ°´å¹³åççæ¯ä¸ªæ°æ®èç¹çæ°æ®åå®¹å´å¹¶ä¸ç¸åãå°æ°´å¹³åçåè¯»ååç¦»èåä½¿ç¨ï¼è½å¤æ´å ææçæåç³»ç»æ§è½ã\n\n\n# 2.3. ååºåè¡¨ç­ç¥\n\n\n\nååºåè¡¨ç­ç¥ä¸»è¦æä¸¤ç§ï¼\n\n * æ ¹æ®æ°å¼èå´åå\n * æ ¹æ® hash åå\n\n# 2.3.1. æ°å¼èå´è·¯ç±\n\næ°å¼èå´è·¯ç±ï¼å°±æ¯æ ¹æ® idãæ¶é´èå´ è¿ç±»å·ææåºæ§çå­æ®µæ¥è¿è¡ååãä¾å¦ï¼ç¨æ· id ä¸º 1-9999 çè®°å½åå°ç¬¬ä¸ä¸ªåºï¼10000-20000 çåå°ç¬¬äºä¸ªåºï¼ä»¥æ­¤ç±»æ¨ã\n\næè¿ç§ç­ç¥åååºæ¥çæ°æ®ï¼å·ææ°æ®è¿ç»­æ§ã\n\nä¼ç¹ï¼æ°æ®è¿ç§»å¾ç®åã\n\nç¼ºç¹ï¼å®¹æäº§çç­ç¹é®é¢ï¼å¤§éçæµéé½æå¨ææ°çæ°æ®ä¸äºã\n\n# 2.3.2. hash è·¯ç±\n\nå¸åç hash è·¯ç±ï¼å¦æ ¹æ®æ°å¼åæ¨¡ï¼å½éè¦æ©å®¹æ¶ï¼ä¸è¬ä»¥ 2 çå¹æ¬¡æ¹è¿è¡æ©å®¹ï¼è¿æ ·ï¼æ©å®¹æ¶è¿ç§»çæ°æ®éä¼å°ä¸äºï¼ãä¾å¦ï¼ç¨æ· id mod nï¼ä½æ°ä¸º 0 çè®°å½æ¾å°ç¬¬ä¸ä¸ªåºï¼ä½æ°ä¸º 1 çæ¾å°ç¬¬äºä¸ªåºï¼ä»¥æ­¤ç±»æ¨ã\n\nä¸è¬éç¨ é¢ååº çæ¹å¼ï¼æåæ ¹æ® æ°æ®é è§åå¥½ ååºæ°ï¼æ¯å¦ååä¸º 512 æ 1024 å¼ è¡¨ï¼ä¿è¯å¯æ¯ææªæ¥ä¸æ®µæ¶é´ç æ°æ®å®¹éï¼åæ ¹æ® è´è½½æåµ å° è¡¨ è¿ç§»å°å¶ä» æ°æ®åº ä¸­ãæ©å®¹æ¶éå¸¸éç¨ ç¿»åæ©å®¹ï¼é¿å æ°æ®æ å° å¨é¨è¢« æä¹±ï¼å¯¼è´ å¨éè¿ç§» çæåµã\n\nä¼ç¹ï¼æ°æ®ç¦»æ£åå¸ï¼ä¸å­å¨ç­ç¹é®é¢ã\n\nç¼ºç¹ï¼æ°æ®è¿ç§»ãæ©å®¹éº»ç¦ï¼ä¹åçæ°æ®éè¦éæ°è®¡ç® hash å¼éæ°åéå°ä¸åçåºæè¡¨ï¼ãå½ èç¹æ°é ååæ¶ï¼å¦ æ©å®¹ æ æ¶ç¼© èç¹ï¼æ°æ®èç¹ æ å°å³ç³» éè¦éæ°è®¡ç®ï¼ä¼å¯¼è´æ°æ®ç éæ°è¿ç§»ã\n\n# 2.3.3. è·¯ç±è¡¨\n\nè¿ç§ç­ç¥ï¼å°±æ¯ç¨ä¸å¼ ç¬ç«çè¡¨è®°å½è·¯ç±ä¿¡æ¯ã\n\nä¼ç¹ï¼ç®åãçµæ´»ï¼å°¤å¶æ¯å¨æ©å®¹ãè¿ç§»æ¶ï¼åªéè¦è¿ç§»æå®çæ°æ®ï¼ç¶åä¿®æ¹è·¯ç±è¡¨å³å¯ã\n\nç¼ºç¹ï¼æ¯æ¬¡æ¥è¯¢ï¼å¿é¡»åæ¥è·¯ç±è¡¨ï¼å¢å äº io å¼éãå¹¶ä¸ï¼å¦æè·¯ç±è¡¨æ¬èº«å¤ªå¤§ï¼ä¹ä¼é¢ä¸´æ§è½ç¶é¢ï¼å¦ææ³å¯¹è·¯ç±è¡¨ååååºåè¡¨ï¼å°åºç°æ­»å¾ªç¯å¼çè·¯ç±ç®æ³éæ©é®é¢ã\n\n\n# 3. è¿ç§»åæ©å®¹\n\n\n# 3.1. åæºè¿ç§»/æ©å®¹ï¼ä¸æ¨èï¼\n\nåæºè¿ç§»/æ©å®¹æ¯ææ´åãæç®åçè¿ç§»ãæ©å®¹æ¹æ¡ã\n\n\n\n# 3.1.1. åæºè¿ç§»/æ©å®¹æµç¨\n\nï¼0ï¼é¢ä¼°åææ¶é´ï¼åå¸åæå¬åã\n\nï¼1ï¼åæï¼ä¸åè®¸æ°æ®è®¿é®ã\n\nï¼2ï¼ç¼åä¸´æ¶çæ°æ®å¯¼å¥ç¨åºï¼ä»èæ°æ®åºä¸­è¯»åæ°æ®ã\n\nï¼3ï¼å°æ°æ®åå¥ä¸­é´ä»¶ã\n\nï¼4ï¼ä¸­é´ä»¶æ ¹æ®åçè§åï¼å°æ°æ®ååå°ååºï¼åè¡¨ï¼ä¸­ã\n\nï¼5ï¼åºç¨ç¨åºä¿®æ¹éç½®ï¼éå¯ã\n\n# 3.1.2. åæºè¿ç§»/æ©å®¹æ¹æ¡åæ\n\nä¼ç¹ï¼ç®åãæ²¡ææ°æ®ä¸è´æ§é®é¢ã\n\nç¼ºç¹ï¼å¦æèçæ°æ®åºæ°æ®éå¾å¤§ï¼ååæºå¤çæ¶é´å¯è½å¾ä¹ãæ¯å¦èçæ°æ®åºæ¯å·²ç»ååºåè¡¨çæ°æ®åºç¾¤ï¼æ°æ®éå¯è½è¾¾å°äº¿çº§ï¼å¯¼å¥æ°æ®å¯è½å°±è¦è±è´¹å å°æ¶ãå¦æä¸­é´è¿ç¨ä¸­åºç°é®é¢ï¼å°±å®¹æå¼åéå¤§äºæã\n\nç¹è¯ï¼ç»¼ä¸ï¼è¿ç§æ¹æ¡ä»£ä»·å¤ªé«ï¼ä¸å¯åã\n\n\n# 3.2. ååè¿ç§»\n\nååè¿ç§»çæ¹é æ¹æ¡å¦ä¸ï¼\n\n * æ¯æååæ°æ§ä¸¤ä¸ªåºï¼å¹¶ä¸é¢çç­åæ¢å¼å³ï¼è½éè¿å¼å³æ§å¶ä¸ç§åç¶æï¼åªåæ§åºãåªåæ°åºååæ­¥ååã\n * æ¯æè¯»æ°æ§ä¸¤ä¸ªåºï¼åæ ·é¢çç­åæ¢å¼å³ï¼æ§å¶è¯»æ§åºè¿æ¯æ°åºã\n\nç¶åä¸çº¿æ°çæå¡ï¼è¿ä¸ªæ¶åæå¡ä»ç¶æ¯åªè¯»åæ§åºï¼ä¸è¯»åæ°åºãæ°çæå¡éè¦ç¨³å®è¿è¡è³å°ä¸å°äºå¨çæ¶é´ï¼æé´é¤äºéªè¯æ°çæå¡çç¨³å®æ§ä»¥å¤ï¼è¿è¦éªè¯æ°æ§ä¸¤ä¸ªåºä¸­çæ°æ®æ¯å¦æ¯ä¸è´çãè¿ä¸ªè¿ç¨ä¸­ï¼å¦ææ°çæå¡æé®é¢ï¼å¯ä»¥ç«å³ä¸çº¿æ°çæå¡ï¼åæ»å°æ§çæ¬çæå¡ã\n\nç¨³å®ä¸æ®µæ¶é´ä¹åï¼å°±å¯ä»¥å¼å¯æå¡çååå¼å³äºãå¼å¯ååå¼å³çåæ¶ï¼éè¦åæåæ­¥ç¨åºãè¿éé¢æä¸ä¸ªé®é¢éè¦æ³¨æä¸ä¸ï¼å°±æ¯è¿ä¸ªååçä¸å¡é»è¾ï¼ä¸å®æ¯ååæ§åºï¼ååæ°åºï¼å¹¶ä¸ä»¥åæ§åºçç»æä¸ºåã\n\næ§åºåæåï¼æ°åºåå¤±è´¥ï¼è¿ååæåï¼ä½è¿ä¸ªæ¶åè¦è®°å½æ¥å¿ï¼åç»­æä»¬ä¼ç¨å°è¿ä¸ªæ¥å¿æ¥éªè¯æ°åºæ¯å¦è¿æé®é¢ãæ§åºåå¤±è´¥ï¼ç´æ¥è¿åå¤±è´¥ï¼å°±ä¸åæ°åºäºãè¿ä¹åçåå æ¯ï¼ä¸è½è®©æ°åºå½±åå°ç°æä¸å¡çå¯ç¨æ§åæ°æ®åç¡®æ§ãä¸é¢è¿ä¸ªè¿ç¨å¦æåºç°é®é¢ï¼å¯ä»¥å³é­ååï¼åæ»å°åªè¯»åæ§åºçç¶æã\n\nåæ¢å°ååä¹åï¼æ°åºä¸æ§åºçæ°æ®å¯è½ä¼å­å¨ä¸ä¸è´çæåµï¼åå æä¸¤ä¸ªï¼ä¸ãåæ­¢åæ­¥ç¨åºåå¼å¯ååï¼è¿ä¸¤ä¸ªè¿ç¨å¾é¾åå°æ ç¼è¡æ¥ï¼äºãååçç­ç¥ä¹ä¸ä¿è¯æ°æ§åºå¼ºä¸è´ï¼è¿æ¶åæä»¬éè¦ä¸çº¿ä¸ä¸ªå¯¹æ¯åè¡¥å¿çç¨åºï¼è¿ä¸ªç¨åºå¯¹æ¯æ§åºæè¿çæ°æ®åæ´ï¼ç¶åæ£æ¥æ°åºä¸­çæ°æ®æ¯å¦ä¸è´ï¼å¦æä¸ä¸è´ï¼è¿è¦è¿è¡è¡¥å¿ã\n\nå¼å¯åååï¼è¿éè¦è³å°ç¨³å®è¿è¡è³å°å å¨çæ¶é´ï¼å¹¶ä¸æé´æä»¬è¦ä¸æ­å°æ£æ¥ï¼ç¡®ä¿ä¸è½ææ§åºåæåï¼æ°åºåå¤±è´¥çæåµåºç°ãå¯¹æ¯ç¨åºä¹æ²¡æåç°æ°æ§ä¸¤ä¸ªåºçæ°æ®æä¸ä¸è´çæåµï¼è¿ä¸ªæ¶åï¼æä»¬å°±å¯ä»¥è®¤ä¸ºï¼æ°æ§ä¸¤ä¸ªåºçæ°æ®æ¯ä¸ç´ä¿æåæ­¥çãæ¥ä¸æ¥å°±å¯ä»¥ç¨ç±»ä¼¼ç°åº¦åå¸çæ¹å¼ï¼æè¯»è¯·æ±ä¸ç¹å¿ä¸ç¹å¿å°åå°æ°åºä¸ãåæ ·ï¼æé´å¦æåºé®é¢çè¯ï¼å¯ä»¥åååæ§åºãå¨é¨è¯»è¯·æ±é½åæ¢å°æ°åºä¸ä¹åï¼è¿ä¸ªæ¶åå¶å®è¯»åè¯·æ±å°±å·²ç»é½åæ¢å°æ°åºä¸äºï¼å®éçåæ¢å·²ç»å®æäºï¼ä½è¿æåç»­çæ¶å°¾æ­¥éª¤ã\n\n\n\n# 3.2.1. ååè¿ç§»æµç¨\n\n 1. ä¿®æ¹åºç¨ç¨åºéç½®ï¼å°æ°æ®åæ¶åå¥èæ°æ®åºåä¸­é´ä»¶ãè¿å°±æ¯æè°çååï¼åæ¶åä¿©åºï¼èåºåæ°åºã\n\n 2. ç¼åä¸´æ¶ç¨åºï¼è¯»åèæ°æ®åºã\n\n 3. å°æ°æ®åå¥ä¸­é´ä»¶ãå¦ææ°æ®ä¸å­å¨ï¼ç´æ¥åå¥ï¼å¦ææ°æ®å­å¨ï¼æ¯è¾æ¶é´æ³ï¼åªåè®¸æ°æ°æ®è¦çèæ°æ®ã\n\n 4. å¯¼å¥æ°æ®åï¼æå¯è½æ°æ®è¿æ¯å­å¨ä¸ä¸è´ï¼é£ä¹å°±å¯¹æ°æ®è¿è¡æ ¡éªï¼æ¯å¯¹æ°èåºçæ¯æ¡æ°æ®ãå¦æå­å¨å·®å¼ï¼éå¯¹å·®å¼æ°æ®ï¼æ§è¡ï¼3ï¼ãå¾ªç¯ï¼3ï¼ãï¼4ï¼æ­¥éª¤ï¼ç´è³æ°æ®å®å¨ä¸è´ã\n\n 5. ä¿®æ¹åºç¨ç¨åºéç½®ï¼å°æ°æ®åªåå¥ä¸­é´ä»¶ã\n\n 6. ä¸­é´ä»¶æ ¹æ®åçè§åï¼å°æ°æ®ååå°ååºï¼åè¡¨ï¼ä¸­ã\n\n\n# 3.3. ä¸»ä»åçº§\n\nçäº§ç¯å¢çæ°æ®åºï¼ä¸ºäºä¿è¯é«å¯ç¨ï¼ä¸è¬ä¼éç¨ä¸»å¤æ¶æãä¸»åºæ¯æè¯»åæä½ï¼ä»åºæ¯æè¯»æä½ã\n\n\n\nç±äºä¸»å¤èç¹æ°æ®ä¸è´ï¼æä»¥å°ä»åºåçº§ä¸ºä¸»èç¹ï¼å¹¶ä¿®æ¹åçéç½®ï¼å°ä»èç¹ä½ä¸ºååºä¹ä¸ï¼å°±å®ç°äºæ©å®¹ã\n\n\n\n# 3.3.1. åçº§ä»åºçæµç¨\n\nï¼1ï¼è§£é¤ä¸»ä»å³ç³»ï¼ä»åºåçº§ä¸ºä¸»åºã\n\nï¼2ï¼åºç¨ç¨åºï¼ä¿®æ¹éç½®ï¼è¯»åéè¿ä¸­é´ä»¶ã\n\nï¼3ï¼ååºåè¡¨ä¸­é´ï¼ä¿®æ¹åçéç½®ãå°æ°æ®æç§æ°çè§åååã\n\nï¼4ï¼ç¼åä¸´æ¶ç¨åºï¼æ¸çåä½æ°æ®ãæ¯å¦ï¼åæ¥æ¯ä¸ä¸ªååºï¼æ°æ®éä¸º 400 ä¸ãä»èç¹åçº§ä¸ºååºä¹ä¸åï¼æ¯ä¸ªååºé½æ 400 ä¸æ°æ®ï¼å¶ä¸­ 200 ä¸æ¯åä½æ°æ®ãæ¸çå®åï¼è¿è¡æ°æ®æ ¡éªã\n\nï¼5ï¼ä¸ºæ¯ä¸ªååºæ·»å æ°çä»åºï¼ä¿è¯é«å¯ç¨ã\n\n# 3.3.2. åçº§ä»åºæ¹æ¡åæ\n\nä¼ç¹ï¼ä¸éè¦åæºï¼æ éæ°æ®è¿ç§»ã\n\n\n# 4. ååºåè¡¨çé®é¢\n\n\n# 4.1. åå¸å¼ id é®é¢\n\nä¸æ¦æ°æ®åºè¢«ååå°å¤ä¸ªç©çç»ç¹ä¸ï¼æä»¬å°ä¸è½åä¾èµæ°æ®åºèªèº«çä¸»é®çææºå¶ãä¸æ¹é¢ï¼æä¸ªååºæ°æ®åºèªçæç id æ æ³ä¿è¯å¨å¨å±ä¸æ¯å¯ä¸çï¼å¦ä¸æ¹é¢ï¼åºç¨ç¨åºå¨æå¥æ°æ®ä¹åéè¦åè·å¾ idï¼ä»¥ä¾¿è¿è¡ sql è·¯ç±ã\n\n> åå¸å¼ id çè§£å³æ¹æ¡è¯¦è§ï¼åå¸å¼ id\n\n\n# 4.2. åå¸å¼äºå¡é®é¢\n\nè·¨åºäºå¡ä¹æ¯åå¸å¼çæ°æ®åºéç¾¤è¦é¢å¯¹çæ£æäºæã åçéç¨åè¡¨ï¼å¯ä»¥å¨éä½åè¡¨æ°æ®éçæåµä¸ï¼å°½éä½¿ç¨æ¬å°äºå¡ï¼åäºä½¿ç¨ååºä¸åè¡¨å¯ææé¿ååå¸å¼äºå¡å¸¦æ¥çéº»ç¦ãå¨ä¸è½é¿åè·¨åºäºå¡çåºæ¯ï¼æäºä¸å¡ä»ç¶éè¦ä¿æäºå¡çä¸è´æ§ã èåºäº xa çåå¸å¼äºå¡ç±äºå¨å¹¶ååº¦é«çåºæ¯ä¸­æ§è½æ æ³æ»¡è¶³éè¦ï¼å¹¶æªè¢«äºèç½å·¨å¤´å¤§è§æ¨¡ä½¿ç¨ï¼ä»ä»¬å¤§å¤éç¨æç»ä¸è´æ§çææ§äºå¡ä»£æ¿å¼ºä¸è´äºå¡ã\n\n> åå¸å¼äºå¡çè§£å³æ¹æ¡è¯¦è§ï¼åå¸å¼äºå¡\n\n\n# 4.3. è·¨èç¹ join åèå\n\nååºåè¡¨åï¼æ æ³ç´æ¥è·¨èç¹ join ãcountãorder byãgroup by ä»¥åèåã\n\néå¯¹è¿ç±»é®é¢ï¼æ®éåæ³æ¯äºæ¬¡æ¥è¯¢ã\n\nå¨ç¬¬ä¸æ¬¡æ¥è¯¢æ¶ï¼è·ååä¸ªèç¹ä¸çç»æã\n\nå¨ç¨åºä¸­å°è¿äºç»æè¿è¡åå¹¶ãç­éã\n\n\n# 4.4. è·¨åççæåºåé¡µ\n\nä¸è¬æ¥è®²ï¼åé¡µæ¶éè¦æç§æå®å­æ®µè¿è¡æåºãå½æåºå­æ®µå°±æ¯åçå­æ®µçæ¶åï¼æä»¬éè¿åçè§åå¯ä»¥æ¯è¾å®¹æå®ä½å°æå®çåçï¼èå½æåºå­æ®µéåçå­æ®µçæ¶åï¼æåµå°±ä¼åå¾æ¯è¾å¤æäºãä¸ºäºæç»ç»æçåç¡®æ§ï¼æä»¬éè¦å¨ä¸åçåçèç¹ä¸­å°æ°æ®è¿è¡æåºå¹¶è¿åï¼å¹¶å°ä¸ååçè¿åçç»æéè¿è¡æ±æ»ååæ¬¡æåºï¼æååè¿åç»ç¨æ·ãå¦ä¸å¾æç¤ºï¼\n\n\n\nä¸é¢å¾ä¸­ææè¿°çåªæ¯æç®åçä¸ç§æåµï¼åç¬¬ä¸é¡µæ°æ®ï¼ï¼çèµ·æ¥å¯¹æ§è½çå½±åå¹¶ä¸å¤§ãä½æ¯ï¼å¦ææ³ååºç¬¬ 10 é¡µæ°æ®ï¼æåµåå°åå¾å¤æå¾å¤ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\næäºè¯»èå¯è½å¹¶ä¸å¤ªçè§£ï¼ä¸ºä»ä¹ä¸è½åè·åç¬¬ä¸é¡µæ°æ®é£æ ·ç®åå¤çï¼æåºååºå 10 æ¡ååå¹¶ãæåºï¼ãå¶å®å¹¶ä¸é¾çè§£ï¼å ä¸ºååçèç¹ä¸­çæ°æ®å¯è½æ¯éæºçï¼ä¸ºäºæåºçåç¡®æ§ï¼å¿é¡»æææåçèç¹çå n é¡µæ°æ®é½æåºå¥½åååå¹¶ï¼æååè¿è¡æ´ä½çæåºãå¾æ¾ç¶ï¼è¿æ ·çæä½æ¯æ¯è¾æ¶èèµæºçï¼ç¨æ·è¶å¾åç¿»é¡µï¼ç³»ç»æ§è½å°ä¼è¶å·®ã\n\né£å¦ä½è§£å³ååºæåµä¸çåé¡µé®é¢å¢ï¼æä»¥ä¸å ç§åæ³ï¼\n\nå¦ææ¯å¨åå°åºç¨æä¾åé¡µï¼åéå®ç¨æ·åªè½çåé¢ n é¡µï¼è¿ä¸ªéå¶å¨ä¸å¡ä¸ä¹æ¯åççï¼ä¸è¬çåé¢çåé¡µæä¹ä¸å¤§ï¼å¦æä¸å®è¦çï¼å¯ä»¥è¦æ±ç¨æ·ç¼©å°èå´éæ°æ¥è¯¢ï¼ã\n\nå¦ææ¯åå°æ¹å¤çä»»å¡è¦æ±åæ¹è·åæ°æ®ï¼åå¯ä»¥å å¤§ page sizeï¼æ¯å¦æ¯æ¬¡è·å 5000 æ¡è®°å½ï¼ææåå°åé¡µæ°ï¼å½ç¶ç¦»çº¿è®¿é®ä¸è¬èµ°å¤åºï¼é¿åå²å»ä¸»åºï¼ã\n\nååºè®¾è®¡æ¶ï¼ä¸è¬è¿æéå¥å¤§æ°æ®å¹³å°æ±æ»ææååºçè®°å½ï¼æäºåé¡µæ¥è¯¢å¯ä»¥èèèµ°å¤§æ°æ®å¹³å°ã\n\n\n# 5. ä¸­é´ä»¶\n\nå½åå¸¸è§ååºåè¡¨ä¸­é´ä»¶ï¼\n\n * cobar - é¿é b2b å¢éå¼ååå¼æºçï¼å±äº proxy å±æ¹æ¡ï¼å°±æ¯ä»äºåºç¨æå¡å¨åæ°æ®åºæå¡å¨ä¹é´ãåºç¨ç¨åºéè¿ jdbc é©±å¨è®¿é® cobar éç¾¤ï¼cobar æ ¹æ® sql åååºè§åå¯¹ sql ååè§£ï¼ç¶åååå° mysql éç¾¤ä¸åçæ°æ®åºå®ä¾ä¸æ§è¡ãæ©äºå¹´è¿å¯ä»¥ç¨ï¼ä½æ¯æè¿å å¹´é½æ²¡æ´æ°äºï¼åºæ¬æ²¡å¥äººç¨ï¼å·®ä¸å¤ç®æ¯è¢«æå¼çç¶æå§ãèä¸ä¸æ¯æè¯»ååç¦»ãå­å¨è¿ç¨ãè·¨åº join ååé¡µç­æä½ã\n * tddl - æ·å®å¢éå¼åçï¼å±äº client å±æ¹æ¡ãæ¯æåºæ¬ç crud è¯­æ³åè¯»ååç¦»ï¼ä½ä¸æ¯æ joinãå¤è¡¨æ¥è¯¢ç­è¯­æ³ãç®åä½¿ç¨çä¹ä¸å¤ï¼å ä¸ºè¿ä¾èµæ·å®ç diamond éç½®ç®¡çç³»ç»ã\n * atlas - 360 å¼æºçï¼å±äº proxy å±æ¹æ¡ï¼ä»¥åæ¯æä¸äºå¬å¸å¨ç¨çï¼ä½æ¯ç¡®å®æä¸ä¸ªå¾å¤§çé®é¢å°±æ¯ç¤¾åºææ°çç»´æ¤é½å¨ 5 å¹´åäºãæä»¥ï¼ç°å¨ç¨çå¬å¸åºæ¬ä¹å¾å°äºã\n * sharding-jdbc - å½å½å¼æºçï¼å±äº client å±æ¹æ¡ãç¡®å®ä¹åç¨çè¿æ¯è¾å¤ä¸äºï¼å ä¸º sql è¯­æ³æ¯æä¹æ¯è¾å¤ï¼æ²¡æå¤ªå¤éå¶ï¼èä¸ç®åæ¨åºå°äº 2.0 çæ¬ï¼æ¯æååºåè¡¨ãè¯»ååç¦»ãåå¸å¼ id çæãææ§äºå¡ï¼æå¤§åªåéè¾¾åäºå¡ãtcc äºå¡ï¼ãèä¸ç¡®å®ä¹åä½¿ç¨çå¬å¸ä¼æ¯è¾å¤ä¸äºï¼è¿ä¸ªå¨å®ç½æç»è®°ä½¿ç¨çå¬å¸ï¼å¯ä»¥çå°ä» 2017 å¹´ä¸ç´å°ç°å¨ï¼æ¯æä¸å°å¬å¸å¨ç¨çï¼ï¼ç®åç¤¾åºä¹è¿ä¸ç´å¨å¼ååç»´æ¤ï¼è¿ç®æ¯æ¯è¾æ´»è·ï¼ä¸ªäººè®¤ä¸ºç®æ¯ä¸ä¸ªç°å¨ä¹å¯ä»¥éæ©çæ¹æ¡ã\n * mycat - åºäº cobar æ¹é çï¼å±äº proxy å±æ¹æ¡ï¼æ¯æçåè½éå¸¸å®åï¼èä¸ç®ååºè¯¥æ¯éå¸¸ç«çèä¸ä¸æ­æµè¡çæ°æ®åºä¸­é´ä»¶ï¼ç¤¾åºå¾æ´»è·ï¼ä¹æä¸äºå¬å¸å¼å§å¨ç¨äºãä½æ¯ç¡®å®ç¸æ¯äº sharding jdbc æ¥è¯´ï¼å¹´è½»ä¸äºï¼ç»åçé¤ç¼å°ä¸äºã\n\nææ¯éåå»ºè®®ï¼\n\nå»ºè®®ä½¿ç¨çæ¯ sharding-jdbc å mycatã\n\n * sharding-jdbc è¿ç§ client å±æ¹æ¡çä¼ç¹å¨äºä¸ç¨é¨ç½²ï¼è¿ç»´ææ¬ä½ï¼ä¸éè¦ä»£çå±çäºæ¬¡è½¬åè¯·æ±ï¼æ§è½å¾é«ï¼ä½æ¯å¦æéå°åçº§å¥çéè¦åä¸ªç³»ç»é½éæ°åçº§çæ¬ååå¸ï¼åä¸ªç³»ç»é½éè¦è¦å sharding-jdbc çä¾èµãå¶æ¬è´¨ä¸éè¿éç½®å¤æ°æ®æºï¼ç¶åæ ¹æ®è®¾å®çååºåè¡¨ç­ç¥ï¼è®¡ç®è·¯ç±ï¼å°è¯·æ±åéå°è®¡ç®å¾å°çèç¹ä¸ã\n * mycat è¿ç§ proxy å±æ¹æ¡çç¼ºç¹å¨äºéè¦é¨ç½²ï¼èªå·±è¿ç»´ä¸å¥ä¸­é´ä»¶ï¼è¿ç»´ææ¬é«ï¼ä½æ¯å¥½å¤å¨äºå¯¹äºåä¸ªé¡¹ç®æ¯éæçï¼å¦æéå°åçº§ä¹ç±»çé½æ¯èªå·±ä¸­é´ä»¶é£éæå°±è¡äºã\n\néå¸¸æ¥è¯´ï¼è¿ä¸¤ä¸ªæ¹æ¡å¶å®é½å¯ä»¥éç¨ï¼ä½æ¯æä¸ªäººå»ºè®®ä¸­å°åå¬å¸éç¨ sharding-jdbcï¼client å±æ¹æ¡è½»ä¾¿ï¼èä¸ç»´æ¤ææ¬ä½ï¼ä¸éè¦é¢å¤å¢æ´¾äººæï¼èä¸ä¸­å°åå¬å¸ç³»ç»å¤æåº¦ä¼ä½ä¸äºï¼é¡¹ç®ä¹æ²¡é£ä¹å¤ï¼ä½æ¯ä¸­å¤§åå¬å¸æå¥½è¿æ¯éç¨ mycat è¿ç±» proxy å±æ¹æ¡ï¼å ä¸ºå¯è½å¤§å¬å¸ç³»ç»åé¡¹ç®éå¸¸å¤ï¼å¢éå¾å¤§ï¼äººååè¶³ï¼é£ä¹æå¥½æ¯ä¸é¨å¼ä¸ªäººæ¥ç ç©¶åç»´æ¤ mycatï¼ç¶åå¤§éé¡¹ç®ç´æ¥éæä½¿ç¨å³å¯ã\n\n\n# 6. åèèµæ\n\n * åç«¯å­å¨å®æè¯¾\n * shardingsphere å®æ¹ææ¡£\n * âååºåè¡¨" ï¼éååæµç¨è¦æéï¼å¦åä¼å¤±æ§\n * ååºåè¡¨éè¦èèçé®é¢åæ¹æ¡\n * ä¸æ¬¡é¾å¾çååºåè¡¨å®è·µ\n * ååºåè¡¨å¹³æ»æ©å®¹',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼ ID åºæ¬åç",frontmatter:{title:"åå¸å¼ ID åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","åå¸å¼ID"],abbrlink:"d547ed53",date:"2019-07-24T11:55:00.000Z",permalink:"/pages/0b2e59/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/04.%E5%88%86%E5%B8%83%E5%BC%8FID.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/04.åå¸å¼ID.md",key:"v-255354da",path:"/pages/0b2e59/",headers:[{level:2,title:"1. åå¸å¼ ID ç®ä»",slug:"_1-åå¸å¼-id-ç®ä»",normalizedTitle:"1. åå¸å¼ id ç®ä»",charIndex:268},{level:2,title:"2. UUID",slug:"_2-uuid",normalizedTitle:"2. uuid",charIndex:620},{level:3,title:"2.1. UUID çä¼ç¹",slug:"_2-1-uuid-çä¼ç¹",normalizedTitle:"2.1. uuid çä¼ç¹",charIndex:1641},{level:3,title:"2.2. UUID çç¼ºç¹",slug:"_2-2-uuid-çç¼ºç¹",normalizedTitle:"2.2. uuid çç¼ºç¹",charIndex:1687},{level:3,title:"2.3. éç¨åºæ¯",slug:"_2-3-éç¨åºæ¯",normalizedTitle:"2.3. éç¨åºæ¯",charIndex:1999},{level:2,title:"3. å©ç¨ç¬¬ä¸æ¹å­å¨çæé®",slug:"_3-å©ç¨ç¬¬ä¸æ¹å­å¨çæé®",normalizedTitle:"3. å©ç¨ç¬¬ä¸æ¹å­å¨çæé®",charIndex:2107},{level:3,title:"3.1. ä¼ç¹",slug:"_3-1-ä¼ç¹",normalizedTitle:"3.1. ä¼ç¹",charIndex:2245},{level:3,title:"3.2. ç¼ºç¹",slug:"_3-2-ç¼ºç¹",normalizedTitle:"3.2. ç¼ºç¹",charIndex:2299},{level:2,title:"4. éªè±ç®æ³ï¼Snowflakeï¼",slug:"_4-éªè±ç®æ³-snowflake",normalizedTitle:"4. éªè±ç®æ³ï¼snowflakeï¼",charIndex:2412},{level:3,title:"4.1. åºæ¬åç",slug:"_4-1-åºæ¬åç",normalizedTitle:"4.1. åºæ¬åç",charIndex:2638},{level:4,title:"4.1.1. é®çç»æ",slug:"_4-1-1-é®çç»æ",normalizedTitle:"4.1.1. é®çç»æ",charIndex:2651},{level:4,title:"4.1.2. æ¶éåæ¨",slug:"_4-1-2-æ¶éåæ¨",normalizedTitle:"4.1.2. æ¶éåæ¨",charIndex:3199},{level:4,title:"4.1.3. çµæ´»å®å¶",slug:"_4-1-3-çµæ´»å®å¶",normalizedTitle:"4.1.3. çµæ´»å®å¶",charIndex:3368},{level:3,title:"4.2. ä¼ç¹",slug:"_4-2-ä¼ç¹",normalizedTitle:"4.2. ä¼ç¹",charIndex:3790},{level:3,title:"4.3. ç¼ºç¹",slug:"_4-3-ç¼ºç¹",normalizedTitle:"4.3. ç¼ºç¹",charIndex:3898},{level:3,title:"4.4. éç¨åºæ¯",slug:"_4-4-éç¨åºæ¯",normalizedTitle:"4.4. éç¨åºæ¯",charIndex:3953},{level:3,title:"4.5. é²æ­¢æ¶éåæ¨",slug:"_4-5-é²æ­¢æ¶éåæ¨",normalizedTitle:"4.5. é²æ­¢æ¶éåæ¨",charIndex:4055},{level:2,title:"5. Leaf",slug:"_5-leaf",normalizedTitle:"5. leaf",charIndex:4487},{level:3,title:"5.1. åºæ¬åç",slug:"_5-1-åºæ¬åç",normalizedTitle:"5.1. åºæ¬åç",charIndex:4582},{level:3,title:"5.2. ä¼ç¹",slug:"_5-2-ä¼ç¹",normalizedTitle:"5.2. ä¼ç¹",charIndex:6210},{level:3,title:"5.3. ç¼ºç¹",slug:"_5-3-ç¼ºç¹",normalizedTitle:"5.3. ç¼ºç¹",charIndex:6291},{level:3,title:"5.4. éç¨åºæ¯",slug:"_5-4-éç¨åºæ¯",normalizedTitle:"5.4. éç¨åºæ¯",charIndex:6357},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:6518}],headersStr:"1. åå¸å¼ ID ç®ä» 2. UUID 2.1. UUID çä¼ç¹ 2.2. UUID çç¼ºç¹ 2.3. éç¨åºæ¯ 3. å©ç¨ç¬¬ä¸æ¹å­å¨çæé® 3.1. ä¼ç¹ 3.2. ç¼ºç¹ 4. éªè±ç®æ³ï¼Snowflakeï¼ 4.1. åºæ¬åç 4.1.1. é®çç»æ 4.1.2. æ¶éåæ¨ 4.1.3. çµæ´»å®å¶ 4.2. ä¼ç¹ 4.3. ç¼ºç¹ 4.4. éç¨åºæ¯ 4.5. é²æ­¢æ¶éåæ¨ 5. Leaf 5.1. åºæ¬åç 5.2. ä¼ç¹ 5.3. ç¼ºç¹ 5.4. éç¨åºæ¯ 6. åèèµæ",content:"# åå¸å¼ ID åºæ¬åç\n\n> ä¼ ç»æ°æ®åºè½¯ä»¶å¼åä¸­ï¼ä¸»é®èªå¨çæææ¯æ¯åºæ¬éæ±ãèåä¸ªæ°æ®åºå¯¹äºè¯¥éæ±ä¹æä¾äºç¸åºçæ¯æï¼æ¯å¦ MySQL çèªå¢é®ï¼Oracle çèªå¢åºåç­ã\n> \n> æ°æ®åçåï¼ä¸åæ°æ®èç¹çæå¨å±å¯ä¸ä¸»é®æ¯éå¸¸æ£æçé®é¢ãåä¸ä¸ªé»è¾è¡¨åçä¸åå®éè¡¨ä¹é´çèªå¢é®ç±äºæ æ³äºç¸æç¥èäº§çéå¤ä¸»é®ã è½ç¶å¯éè¿çº¦æèªå¢ä¸»é®åå§å¼åæ­¥é¿çæ¹å¼é¿åç¢°æï¼ä½éå¼å¥é¢å¤çè¿ç»´è§åï¼ä½¿è§£å³æ¹æ¡ç¼ºä¹å®æ´æ§åå¯æ©å±æ§ã\n> \n> ä¸ºæ­¤ï¼éè¦ä½¿ç¨åå¸å¼ ID æ¥è§£å³æ­¤é®é¢ãæ¬ææ»ç»ä¸çå¸¸ç¨çåå¸å¼ ID è§£å³æ¹æ¡ã\n\n\n# 1. åå¸å¼ ID ç®ä»\n\né¦åï¼åå¸å¼ ID åºè¯¥å·å¤åªäºç¹æ§å¢ï¼\n\n 1. å¨å±å¯ä¸æ§ - ä¸è½åºç°éå¤ç ID å·ï¼æ¢ç¶æ¯å¯ä¸æ è¯ï¼è¿æ¯æåºæ¬çè¦æ±ã\n 2. è¶å¿éå¢ - å¨ MySQL InnoDB å¼æä¸­ä½¿ç¨çæ¯èéç´¢å¼ï¼ç±äºå¤æ° RDBMS ä½¿ç¨ B-tree çæ°æ®ç»ææ¥å­å¨ç´¢å¼æ°æ®ï¼å¨ä¸»é®çéæ©ä¸é¢æä»¬åºè¯¥å°½éä½¿ç¨æåºçä¸»é®ä¿è¯åå¥æ§è½ã\n 3. åè°éå¢ - ä¿è¯ä¸ä¸ä¸ª ID ä¸å®å¤§äºä¸ä¸ä¸ª IDï¼ä¾å¦äºå¡çæ¬å·ãIM å¢éæ¶æ¯ãæåºç­ç¹æ®éæ±ã\n 4. ä¿¡æ¯å®å¨ - å¦æ ID æ¯è¿ç»­çï¼æ¶æç¨æ·çæåå·¥ä½å°±éå¸¸å®¹æåäºï¼ç´æ¥æç§é¡ºåºä¸è½½æå® URL å³å¯ï¼å¦ææ¯è®¢åå·å°±æ´å±é©äºï¼ç«å¯¹å¯ä»¥ç´æ¥ç¥éæä»¬ä¸å¤©çåéãæä»¥å¨ä¸äºåºç¨åºæ¯ä¸ï¼ä¼éè¦ ID æ è§åãä¸è§åã\n\n\n# 2. UUID\n\nUUID æ¯æç®åçåå¸å¼ ID æ¹æ¡ã\n\nUUID æ¯éç¨å¯ä¸è¯å«ç ï¼Universally Unique Identifier)çç¼©åï¼å¼æ¾è½¯ä»¶åºéä¼(OSF)è§èå®ä¹äºåæ¬ç½å¡ MAC å°åãæ¶é´æ³ãåå­ç©ºé´ï¼Namespaceï¼ãéæºæä¼ªéæºæ°ãæ¶åºç­åç´ ãå©ç¨è¿äºåç´ æ¥çæ UUIDã\n\nUUID æ¯ç± 128 ä½äºè¿å¶ç»æï¼ä¸è¬è½¬æ¢æåå­è¿å¶ï¼ç¶åç¨ String è¡¨ç¤ºãå¨ java ä¸­æä¸ª UUID ç±»,å¨ä»çæ³¨éä¸­æä»¬çè§è¿éæ 4 ç§ä¸åç UUID ççæç­ç¥:\n\n * random - åºäºéæºæ°çæ UUIDï¼ç±äº Java ä¸­çéæºæ°æ¯ä¼ªéæºæ°ï¼å¶éå¤çæ¦çæ¯å¯ä»¥è¢«è®¡ç®åºæ¥çãè¿ä¸ªä¸è¬æä»¬ç¨ä¸é¢çä»£ç è·ååºäºéæºæ°ç UUID:\n\nString id = UUID.randomUUID().toString();\n\n\n * time-based - åºäºæ¶é´ç UUID,è¿ä¸ªä¸è¬æ¯éè¿å½åæ¶é´ï¼éæºæ°ï¼åæ¬å° Mac å°åæ¥è®¡ç®åºæ¥ï¼èªå¸¦ç JDK åå¹¶æ²¡æè¿ä¸ªç®æ³çæä»¬å¨ä¸äº UUIDUtil ä¸­ï¼æ¯å¦æä»¬ç log4j.core.utilï¼ä¼éæ°å®ä¹ UUID çé«ä½åä½ä½ã\n\n public static UUID getTimeBasedUuid() {\n     long time = System.currentTimeMillis() * 10000L + 122192928000000000L + (long)(COUNT.incrementAndGet() % 10000);\n     long timeLow = (time & 4294967295L) << 32;\n     long timeMid = (time & 281470681743360L) >> 16;\n     long timeHi = (time & 1152640029630136320L) >> 48;\n     long most = timeLow | timeMid | 4096L | timeHi;\n     return new UUID(most, LEAST);\n }\n\n\n * DCE security - DCE å®å¨ç UUIDã\n\n * name-based - åºäºåå­ç UUIDï¼éè¿è®¡ç®åå­ååå­ç©ºé´ç MD5 æ¥è®¡ç® UUIDã\n\n\n# 2.1. UUID çä¼ç¹\n\n * éè¿æ¬å°çæï¼æ²¡æç»è¿ç½ç» I/Oï¼æ§è½è¾å¿«ã\n\n\n# 2.2. UUID çç¼ºç¹\n\n * é¿åº¦è¿é¿ - UUID å¤ªé¿ï¼16 å­è 128 ä½ï¼éå¸¸ä»¥ 36 é¿åº¦çå­ç¬¦ä¸²è¡¨ç¤ºï¼å¾å¤åºæ¯ä¸éç¨ãä¾å¦ï¼Mysql å®æ¹æç¡®å»ºè®®ä¸»é®è¶ç­è¶å¥½ï¼36 ä¸ªå­ç¬¦é¿åº¦ç UUID ä¸ç¬¦åè¦æ±ã\n * ä¿¡æ¯ä¸å®å¨ - åºäº MAC å°åçæ UUID çç®æ³å¯è½ä¼é æ MAC å°åæ³é²ï¼è¿ä¸ªæ¼æ´æ¾è¢«ç¨äºå¯»æ¾æ¢ä¸½èçæ¯çå¶ä½èä½ç½®ã\n * æ åºæ§ - ä¸è½çæéå¢æåºçæ°å­ãè¿å¯¹äºä¸äºç¹å®åºæ¯ä¸å©ãä¾å¦ï¼MySQL InnoDB å­å¨å¼æä½¿ç¨ B+ æ å­å¨ç´¢å¼æ°æ®ï¼èä¸»é®ä¹æ¯ä¸ç§ç´¢å¼ãç´¢å¼æ°æ®å¨ B+ æ ä¸­æ¯æåºæåçãUUID çæ åºæ§å¯è½ä¼å¼èµ·æ°æ®ä½ç½®é¢ç¹åå¨ï¼ä¸¥éå½±åæ§è½ã\n\n\n# 2.3. éç¨åºæ¯\n\nUUID çéç¨åºæ¯å¯ä»¥ä¸ºä¸éè¦æå¿è¿å¤çç©ºé´å ç¨ï¼ä»¥åä¸éè¦çææéå¢è¶å¿çæ°å­ãå¨ Log4j é UuidPatternConverter ä¸­å å¥äº UUID æ¥æ è¯æ¯ä¸æ¡æ¥å¿ã\n\n\n# 3. å©ç¨ç¬¬ä¸æ¹å­å¨çæé®\n\næå°èªå¢é®ï¼æåæ³å°çè¯å®æ¯ç´æ¥ä½¿ç¨æ°æ®åºèªå¢é®ãåæ°æ®åºå¯¹äºè¯¥éæ±ä¹æä¾äºç¸åºçæ¯æï¼æ¯å¦ MySQL çèªå¢é®ï¼Oracle çèªå¢åºåç­ã\n\nå½ç¶ï¼ä¹å¯ä»¥èèæ¯ç¨ Redis è¿æ ·ç Nosqlï¼çè³ ZooKeeper å»çæé®\n\n\n# 3.1. ä¼ç¹\n\n * éå¸¸ç®åï¼å©ç¨ç°æçåè½å®ç°ï¼ææ¬å°\n * æåºéå¢\n * æ¹ä¾¿æåºååé¡µ\n\n\n# 3.2. ç¼ºç¹\n\n * å¼ºä¾èµç¬¬ä¸æ¹å­å¨ï¼å¦æç¬¬ä¸æ¹å­å¨éé«å¯ç¨ç³»ç»ï¼è¥åºç°ä¸¢å¤±æ°æ®çæåµï¼å°±å¯è½åºç°éå¤çæ ID çé®é¢ã\n * çæ ID æ§è½ç¶é¢ä¾èµäºç¬¬ä¸æ¹å­å¨çæ§è½ã\n * å¢å äºå¯¹ç¬¬ä¸æ¹å­å¨è¿ç»´çææ¬ã\n\n\n# 4. éªè±ç®æ³ï¼Snowflakeï¼\n\néªè±ç®æ³ï¼Snowflakeï¼æ¯ç± Twitter å¬å¸çåå¸å¼ä¸»é®çæç®æ³ï¼å®ä¼çæä¸ä¸ª 64 bit çæ´æ°ï¼å¯ä»¥ä¿è¯ä¸åè¿ç¨ä¸»é®çä¸éå¤æ§ï¼ä»¥åç¸åè¿ç¨ä¸»é®çæåºæ§ã\n\nå¨åä¸ä¸ªè¿ç¨ä¸­ï¼å®é¦åæ¯éè¿æ¶é´ä½ä¿è¯ä¸éå¤ï¼å¦ææ¶é´ç¸ååæ¯éè¿åºåä½ä¿è¯ã åæ¶ç±äºæ¶é´ä½æ¯åè°éå¢çï¼ä¸åä¸ªæå¡å¨å¦æå¤§ä½åäºæ¶é´åæ­¥ï¼é£ä¹çæçä¸»é®å¨åå¸å¼ç¯å¢å¯ä»¥è®¤ä¸ºæ¯æ»ä½æåºçï¼è¿å°±ä¿è¯äºå¯¹ç´¢å¼å­æ®µçæå¥çé«ææ§ã\n\n\n# 4.1. åºæ¬åç\n\n# 4.1.1. é®çç»æ\n\nä½¿ç¨éªè±ç®æ³çæçä¸»é®ï¼äºè¿å¶è¡¨ç¤ºå½¢å¼åå« 4 é¨åï¼ä»é«ä½å°ä½ä½åè¡¨ä¸ºï¼1bit ç¬¦å·ä½ã41bit æ¶é´æ³ä½ã10bit å·¥ä½è¿ç¨ä½ä»¥å 12bit åºåå·ä½ã\n\n * ç¬¦å·ä½(1bit)\n\né¢ççç¬¦å·ä½ï¼æä¸ºé¶ã\n\n * æ¶é´æ³ä½(41bit)\n\n41 ä½çæ¶é´æ³å¯ä»¥å®¹çº³çæ¯«ç§æ°æ¯ 2 ç 41 æ¬¡å¹ï¼ä¸å¹´æä½¿ç¨çæ¯«ç§æ°æ¯ï¼365 * 24 * 60 * 60 * 1000ãéè¿è®¡ç®å¯ç¥ï¼\n\nMath.pow(2, 41) / (365 * 24 * 60 * 60 * 1000L);\n\n\nç»æçº¦ç­äº 69.73 å¹´ãShardingSphere çéªè±ç®æ³çæ¶é´çºªåä» 2016 å¹´ 11 æ 1 æ¥é¶ç¹å¼å§ï¼å¯ä»¥ä½¿ç¨å° 2086 å¹´ï¼ç¸ä¿¡è½æ»¡è¶³ç»å¤§é¨åç³»ç»çè¦æ±ã\n\n * å·¥ä½è¿ç¨ä½(10bit)\n\nè¯¥æ å¿å¨ Java è¿ç¨åæ¯å¯ä¸çï¼å¦ææ¯åå¸å¼åºç¨é¨ç½²åºä¿è¯æ¯ä¸ªå·¥ä½è¿ç¨ç id æ¯ä¸åçãè¯¥å¼é»è®¤ä¸º 0ï¼å¯éè¿å±æ§è®¾ç½®ã\n\n * åºåå·ä½(12bit)\n\nè¯¥åºåæ¯ç¨æ¥å¨åä¸ä¸ªæ¯«ç§åçæä¸åç IDãå¦æå¨è¿ä¸ªæ¯«ç§åçæçæ°éè¶è¿ 4096(2 ç 12 æ¬¡å¹)ï¼é£ä¹çæå¨ä¼ç­å¾å°ä¸ä¸ªæ¯«ç§ç»§ç»­çæã\n\néªè±ç®æ³ä¸»é®çè¯¦ç»ç»æè§ä¸å¾ï¼\n\n\n\n# 4.1.2. æ¶éåæ¨\n\næå¡å¨æ¶éåæ¨ä¼å¯¼è´äº§çéå¤åºåï¼å æ­¤é»è®¤åå¸å¼ä¸»é®çæå¨æä¾äºä¸ä¸ªæå¤§å®¹å¿çæ¶éåæ¨æ¯«ç§æ°ã å¦ææ¶éåæ¨çæ¶é´è¶è¿æå¤§å®¹å¿çæ¯«ç§æ°éå¼ï¼åç¨åºæ¥éï¼å¦æå¨å¯å®¹å¿çèå´åï¼é»è®¤åå¸å¼ä¸»é®çæå¨ä¼ç­å¾æ¶éåæ­¥å°æåä¸æ¬¡ä¸»é®çæçæ¶é´ååç»§ç»­å·¥ä½ã æå¤§å®¹å¿çæ¶éåæ¨æ¯«ç§æ°çé»è®¤å¼ä¸º 0ï¼å¯éè¿å±æ§è®¾ç½®ã\n\n# 4.1.3. çµæ´»å®å¶\n\nä¸é¢åªæ¯ä¸ä¸ªå° 64bit ååçæ åï¼å½ç¶ä¹ä¸ä¸å®è¿ä¹åï¼å¯ä»¥æ ¹æ®ä¸åä¸å¡çå·ä½åºæ¯æ¥ååï¼æ¯å¦ä¸é¢ç»åºä¸ä¸ªä¸å¡åºæ¯ï¼\n\n * æå¡ç®å QPS10 ä¸ï¼é¢è®¡å å¹´ä¹åä¼åå±å°ç¾ä¸ã\n * å½åæºå¨ä¸å°é¨ç½²ï¼ä¸æµ·ï¼åäº¬ï¼æ·±å³é½æã\n * å½åæºå¨ 10 å°å·¦å³ï¼é¢è®¡æªæ¥ä¼å¢å è³ç¾å°ã\n\nè¿ä¸ªæ¶åæä»¬æ ¹æ®ä¸é¢çåºæ¯å¯ä»¥åæ¬¡åççåå 62bitï¼QPS å å¹´ä¹åä¼åå±å°ç¾ä¸ï¼é£ä¹æ¯æ¯«ç§å°±æ¯åçº§çè¯·æ±ï¼ç®å 10 å°æºå¨é£ä¹æ¯å°æºå¨æ¿æç¾çº§çè¯·æ±ï¼ä¸ºäºä¿è¯æ©å±ï¼åé¢çå¾ªç¯ä½å¯ä»¥éå¶å° 1024ï¼ä¹å°±æ¯ 2^10ï¼é£ä¹å¾ªç¯ä½ 10 ä½å°±è¶³å¤äºã\n\næºå¨ä¸å°é¨ç½²æä»¬å¯ä»¥ç¨ 3bit æ»å± 8 æ¥è¡¨ç¤ºæºæ¿ä½ç½®ï¼å½åçæºå¨ 10 å°ï¼ä¸ºäºä¿è¯æ©å±å°ç¾å°é£ä¹å¯ä»¥ç¨ 7bit 128 æ¥è¡¨ç¤ºï¼æ¶é´ä½ä¾ç¶æ¯ 41bitï¼é£ä¹è¿å©ä¸ 64-10-3-7-41-1 = 2bitï¼è¿å©ä¸ 2bit å¯ä»¥ç¨æ¥è¿è¡æ©å±ã\n\n\n\n\n# 4.2. ä¼ç¹\n\n * çæç ID é½æ¯è¶å¿éå¢çã\n * ä¸ä¾èµæ°æ®åºç­ç¬¬ä¸æ¹ç³»ç»ï¼ä»¥æå¡çæ¹å¼é¨ç½²ï¼ç¨³å®æ§æ´é«ï¼çæ ID çæ§è½ä¹æ¯éå¸¸é«çã\n * å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹æ§åé bit ä½ï¼éå¸¸çµæ´»ã\n\n\n# 4.3. ç¼ºç¹\n\n * å¼ºä¾èµæºå¨æ¶éï¼å¦ææºå¨ä¸æ¶éåæ¨ï¼ä¼å¯¼è´åå·éå¤æèæå¡ä¼å¤äºä¸å¯ç¨ç¶æã\n\n\n# 4.4. éç¨åºæ¯\n\nå½æä»¬éè¦æ åºä¸è½è¢«çæµç IDï¼å¹¶ä¸éè¦ä¸å®é«æ§è½ï¼ä¸éè¦ long åï¼é£ä¹å°±å¯ä»¥ä½¿ç¨æä»¬éªè±ç®æ³ãæ¯å¦å¸¸è§çè®¢å IDï¼ç¨éªè±ç®æ³å«äººå°±æ æ³çæµä½ æ¯å¤©çè®¢åéæ¯å¤å°ã\n\n\n# 4.5. é²æ­¢æ¶éåæ¨\n\néªè±ç®æ³æ¯å¼ºä¾èµäºæ¶é´çï¼èå¦ææºå¨æ¶é´åçåæ¨ï¼æå¯è½ä¼çæéå¤ç IDã\n\næä»¬å¯ä»¥éå¯¹ç®æ³åä¸äºä¼åï¼æ¥é²æ­¢æ¶éåæ¨çæéå¤ IDã\n\nç¨å½åæ¶é´åä¸ä¸æ¬¡çæ¶é´è¿è¡å¤æ­ï¼å¦æå½åæ¶é´å°äºä¸ä¸æ¬¡çæ¶é´é£ä¹è¯å®æ¯åçäºåæ¨ãæ®éçç®æ³ä¼ç´æ¥æåºå¼å¸¸ï¼è¿éæä»¬å¯ä»¥å¯¹å¶è¿è¡ä¼åï¼ä¸è¬åä¸ºä¸¤ä¸ªæåµ:\n\n * å¦ææ¶é´åæ¨æ¶é´è¾ç­ï¼æ¯å¦éç½® 5ms ä»¥åï¼é£ä¹å¯ä»¥ç´æ¥ç­å¾ä¸å®çæ¶é´ï¼è®©æºå¨çæ¶é´è¿½ä¸æ¥ã\n * å¦ææ¶é´çåæ¨æ¶é´è¾é¿ï¼æä»¬ä¸è½æ¥åè¿ä¹é¿çé»å¡ç­å¾ï¼é£ä¹åæä¸¤ä¸ªç­ç¥:\n   * ç´æ¥æç»ï¼æåºå¼å¸¸ãææ¥å¿ï¼éç¥ RD æ¶éåæ»ã\n   * å©ç¨æ©å±ä½ãä¸é¢æä»¬è®¨è®ºè¿ï¼ä¸åä¸å¡åºæ¯ä½æ°å¯è½ç¨ä¸å°é£ä¹å¤æ¯ç¹ä½ï¼é£ä¹æä»¬å¯ä»¥ææ©å±ä½æ°å©ç¨èµ·æ¥ãæ¯å¦ï¼å½è¿ä¸ªæ¶é´åæ¨æ¯è¾é¿çæ¶åï¼æä»¬å¯ä»¥ä¸éè¦ç­å¾ï¼ç´æ¥å¨æ©å±ä½å  1ãä¸¤ä½çæ©å±ä½åè®¸æä»¬æä¸æ¬¡å¤§çæ¶éåæ¨ï¼ä¸è¬æ¥è¯´å°±å¤äºï¼å¦æå¶è¶è¿ä¸æ¬¡æä»¬è¿æ¯éæ©æåºå¼å¸¸ï¼ææ¥å¿ã\n\n\n# 5. Leaf\n\n> ç¾å¢æä¾äºä¸ç§åå¸å¼ ID è§£å³æ¹æ¡ Leafï¼å¶æ¬è´¨å¯ä»¥è§ä¸ºæ°æ®åºåæ®µ+æå¡ç¼å­ IDã\n> \n> è¯¦æå¯ä»¥åè Leafââç¾å¢ç¹è¯åå¸å¼ ID çæç³»ç»\n\n\n# 5.1. åºæ¬åç\n\nä½¿ç¨æ°æ®åºçæ IDï¼ä½æ¯åäºå¦ä¸æ¹è¿ï¼\n\nåæ¹æ¡æ¯æ¬¡è·å ID é½å¾è¯»åä¸æ¬¡æ°æ®åºï¼é ææ°æ®åºååå¤§ãæ¹ä¸ºå©ç¨ proxy server æ¹éè·åï¼æ¯æ¬¡è·åä¸ä¸ª segment(step å³å®å¤§å°)å·æ®µçå¼ãç¨å®ä¹ååå»æ°æ®åºè·åæ°çå·æ®µï¼å¯ä»¥å¤§å¤§çåè½»æ°æ®åºçååã - åä¸ªä¸å¡ä¸åçåå·éæ±ç¨ biz_tag å­æ®µæ¥åºåï¼æ¯ä¸ª biz-tag ç ID è·åç¸äºéç¦»ï¼äºä¸å½±åãå¦æä»¥åææ§è½éæ±éè¦å¯¹æ°æ®åºæ©å®¹ï¼ä¸éè¦ä¸è¿°æè¿°çå¤æçæ©å®¹æä½ï¼åªéè¦å¯¹ biz_tag ååºåè¡¨å°±è¡ã\n\næ°æ®åºè¡¨è®¾è®¡å¦ä¸ï¼\n\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n| Field       | Type         | Null | Key | Default           | Extra                       |\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n| biz_tag     | varchar(128) | NO   | PRI |                   |                             |\n| max_id      | bigint(20)   | NO   |     | 1                 |                             |\n| step        | int(11)      | NO   |     | NULL              |                             |\n| desc        | varchar(256) | YES  |     | NULL              |                             |\n| update_time | timestamp    | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n\n\néè¦å­æ®µè¯´æï¼\n\n * biz_tag ç¨æ¥åºåä¸å¡\n * max_id è¡¨ç¤ºè¯¥ biz_tag ç®åæè¢«åéç ID å·æ®µçæå¤§å¼\n * step è¡¨ç¤ºæ¯æ¬¡åéçå·æ®µé¿åº¦ãåæ¥è·å ID æ¯æ¬¡é½éè¦åæ°æ®åºï¼ç°å¨åªéè¦æ step è®¾ç½®å¾è¶³å¤å¤§ï¼æ¯å¦ 1000ãé£ä¹åªæå½ 1000 ä¸ªå·è¢«æ¶èå®äºä¹åæä¼å»éæ°è¯»åä¸æ¬¡æ°æ®åºãè¯»åæ°æ®åºçé¢çä» 1 åå°å°äº 1/stepã\n\nå¤§è´æ¶æå¦ä¸å¾æç¤ºï¼\n\n\n\ntest_tag å¨ç¬¬ä¸å° Leaf æºå¨ä¸æ¯ 1~1000 çå·æ®µï¼å½è¿ä¸ªå·æ®µç¨å®æ¶ï¼ä¼å»å è½½å¦ä¸ä¸ªé¿åº¦ä¸º step=1000 çå·æ®µï¼åè®¾å¦å¤ä¸¤å°å·æ®µé½æ²¡ææ´æ°ï¼è¿ä¸ªæ¶åç¬¬ä¸å°æºå¨æ°å è½½çå·æ®µå°±åºè¯¥æ¯ 3001~4000ãåæ¶æ°æ®åºå¯¹åºç biz_tag è¿æ¡æ°æ®ç max_id ä¼ä» 3000 è¢«æ´æ°æ 4000ï¼æ´æ°å·æ®µç SQL è¯­å¥å¦ä¸ï¼\n\nBegin\nUPDATE table SET max_id=max_id+step WHERE biz_tag=xxx\nSELECT tag, max_id, step FROM table WHERE biz_tag=xxx\nCommit\n\n\n\n# 5.2. ä¼ç¹\n\n * æ¯æ°æ®åºèªå¢é®æ§è½é«\n * è½ä¿è¯é®è¶å¿éå¢ã\n * å¦ææ°æ®åºå®æºï¼ç±äº proxServer æç¼å­ï¼ä¾ç¶å¯ä»¥åæä¸æ®µæ¶é´ã\n\n\n# 5.3. ç¼ºç¹\n\n * åä¸»é®éå¢ä¸æ ·ï¼å®¹æè¢«äººçæµã\n * æ°æ®åºå®æºåï¼è½ç¶è½æ¯æä¸æ®µæ¶é´ï¼ä½æ¯ä»ç¶ä¼é æç³»ç»ä¸å¯ç¨ã\n\n\n# 5.4. éç¨åºæ¯\n\néè¦è¶å¿éå¢ï¼å¹¶ä¸ ID å¤§å°å¯æ§å¶çï¼å¯ä»¥ä½¿ç¨è¿å¥æ¹æ¡ã\n\nå½ç¶è¿ä¸ªæ¹æ¡ä¹å¯ä»¥éè¿ä¸äºææ®µé¿åè¢«äººçæµï¼æ ID åææ¯æ åºçï¼æ¯å¦ææä»¬çæçæ°æ®æ¯ä¸ä¸ªéå¢ç long åï¼æè¿ä¸ª Long åæå ä¸ªé¨åï¼æ¯å¦å¯ä»¥åæå ç»ä¸ä½æ°ï¼å ç»åä½æ°ï¼ç¶åå¨å»ºç«ä¸ä¸ªæ å°è¡¨ï¼å°æä»¬çæ°æ®åææ åºã\n\n\n# 6. åèèµæ\n\n * ç¾åº¦åå¸å¼ ID\n * å¦æåæäººé®ä½ åå¸å¼ IDï¼è¿ç¯æç« ä¸¢ç»ä»\n * çè§£åå¸å¼ id çæç®æ³ SnowFlake\n * Leafââç¾å¢ç¹è¯åå¸å¼ ID çæç³»ç»\n * UUID è§è\n * ShardingSphere åå¸å¼ä¸»é®",normalizedContent:"# åå¸å¼ id åºæ¬åç\n\n> ä¼ ç»æ°æ®åºè½¯ä»¶å¼åä¸­ï¼ä¸»é®èªå¨çæææ¯æ¯åºæ¬éæ±ãèåä¸ªæ°æ®åºå¯¹äºè¯¥éæ±ä¹æä¾äºç¸åºçæ¯æï¼æ¯å¦ mysql çèªå¢é®ï¼oracle çèªå¢åºåç­ã\n> \n> æ°æ®åçåï¼ä¸åæ°æ®èç¹çæå¨å±å¯ä¸ä¸»é®æ¯éå¸¸æ£æçé®é¢ãåä¸ä¸ªé»è¾è¡¨åçä¸åå®éè¡¨ä¹é´çèªå¢é®ç±äºæ æ³äºç¸æç¥èäº§çéå¤ä¸»é®ã è½ç¶å¯éè¿çº¦æèªå¢ä¸»é®åå§å¼åæ­¥é¿çæ¹å¼é¿åç¢°æï¼ä½éå¼å¥é¢å¤çè¿ç»´è§åï¼ä½¿è§£å³æ¹æ¡ç¼ºä¹å®æ´æ§åå¯æ©å±æ§ã\n> \n> ä¸ºæ­¤ï¼éè¦ä½¿ç¨åå¸å¼ id æ¥è§£å³æ­¤é®é¢ãæ¬ææ»ç»ä¸çå¸¸ç¨çåå¸å¼ id è§£å³æ¹æ¡ã\n\n\n# 1. åå¸å¼ id ç®ä»\n\né¦åï¼åå¸å¼ id åºè¯¥å·å¤åªäºç¹æ§å¢ï¼\n\n 1. å¨å±å¯ä¸æ§ - ä¸è½åºç°éå¤ç id å·ï¼æ¢ç¶æ¯å¯ä¸æ è¯ï¼è¿æ¯æåºæ¬çè¦æ±ã\n 2. è¶å¿éå¢ - å¨ mysql innodb å¼æä¸­ä½¿ç¨çæ¯èéç´¢å¼ï¼ç±äºå¤æ° rdbms ä½¿ç¨ b-tree çæ°æ®ç»ææ¥å­å¨ç´¢å¼æ°æ®ï¼å¨ä¸»é®çéæ©ä¸é¢æä»¬åºè¯¥å°½éä½¿ç¨æåºçä¸»é®ä¿è¯åå¥æ§è½ã\n 3. åè°éå¢ - ä¿è¯ä¸ä¸ä¸ª id ä¸å®å¤§äºä¸ä¸ä¸ª idï¼ä¾å¦äºå¡çæ¬å·ãim å¢éæ¶æ¯ãæåºç­ç¹æ®éæ±ã\n 4. ä¿¡æ¯å®å¨ - å¦æ id æ¯è¿ç»­çï¼æ¶æç¨æ·çæåå·¥ä½å°±éå¸¸å®¹æåäºï¼ç´æ¥æç§é¡ºåºä¸è½½æå® url å³å¯ï¼å¦ææ¯è®¢åå·å°±æ´å±é©äºï¼ç«å¯¹å¯ä»¥ç´æ¥ç¥éæä»¬ä¸å¤©çåéãæä»¥å¨ä¸äºåºç¨åºæ¯ä¸ï¼ä¼éè¦ id æ è§åãä¸è§åã\n\n\n# 2. uuid\n\nuuid æ¯æç®åçåå¸å¼ id æ¹æ¡ã\n\nuuid æ¯éç¨å¯ä¸è¯å«ç ï¼universally unique identifier)çç¼©åï¼å¼æ¾è½¯ä»¶åºéä¼(osf)è§èå®ä¹äºåæ¬ç½å¡ mac å°åãæ¶é´æ³ãåå­ç©ºé´ï¼namespaceï¼ãéæºæä¼ªéæºæ°ãæ¶åºç­åç´ ãå©ç¨è¿äºåç´ æ¥çæ uuidã\n\nuuid æ¯ç± 128 ä½äºè¿å¶ç»æï¼ä¸è¬è½¬æ¢æåå­è¿å¶ï¼ç¶åç¨ string è¡¨ç¤ºãå¨ java ä¸­æä¸ª uuid ç±»,å¨ä»çæ³¨éä¸­æä»¬çè§è¿éæ 4 ç§ä¸åç uuid ççæç­ç¥:\n\n * random - åºäºéæºæ°çæ uuidï¼ç±äº java ä¸­çéæºæ°æ¯ä¼ªéæºæ°ï¼å¶éå¤çæ¦çæ¯å¯ä»¥è¢«è®¡ç®åºæ¥çãè¿ä¸ªä¸è¬æä»¬ç¨ä¸é¢çä»£ç è·ååºäºéæºæ°ç uuid:\n\nstring id = uuid.randomuuid().tostring();\n\n\n * time-based - åºäºæ¶é´ç uuid,è¿ä¸ªä¸è¬æ¯éè¿å½åæ¶é´ï¼éæºæ°ï¼åæ¬å° mac å°åæ¥è®¡ç®åºæ¥ï¼èªå¸¦ç jdk åå¹¶æ²¡æè¿ä¸ªç®æ³çæä»¬å¨ä¸äº uuidutil ä¸­ï¼æ¯å¦æä»¬ç log4j.core.utilï¼ä¼éæ°å®ä¹ uuid çé«ä½åä½ä½ã\n\n public static uuid gettimebaseduuid() {\n     long time = system.currenttimemillis() * 10000l + 122192928000000000l + (long)(count.incrementandget() % 10000);\n     long timelow = (time & 4294967295l) << 32;\n     long timemid = (time & 281470681743360l) >> 16;\n     long timehi = (time & 1152640029630136320l) >> 48;\n     long most = timelow | timemid | 4096l | timehi;\n     return new uuid(most, least);\n }\n\n\n * dce security - dce å®å¨ç uuidã\n\n * name-based - åºäºåå­ç uuidï¼éè¿è®¡ç®åå­ååå­ç©ºé´ç md5 æ¥è®¡ç® uuidã\n\n\n# 2.1. uuid çä¼ç¹\n\n * éè¿æ¬å°çæï¼æ²¡æç»è¿ç½ç» i/oï¼æ§è½è¾å¿«ã\n\n\n# 2.2. uuid çç¼ºç¹\n\n * é¿åº¦è¿é¿ - uuid å¤ªé¿ï¼16 å­è 128 ä½ï¼éå¸¸ä»¥ 36 é¿åº¦çå­ç¬¦ä¸²è¡¨ç¤ºï¼å¾å¤åºæ¯ä¸éç¨ãä¾å¦ï¼mysql å®æ¹æç¡®å»ºè®®ä¸»é®è¶ç­è¶å¥½ï¼36 ä¸ªå­ç¬¦é¿åº¦ç uuid ä¸ç¬¦åè¦æ±ã\n * ä¿¡æ¯ä¸å®å¨ - åºäº mac å°åçæ uuid çç®æ³å¯è½ä¼é æ mac å°åæ³é²ï¼è¿ä¸ªæ¼æ´æ¾è¢«ç¨äºå¯»æ¾æ¢ä¸½èçæ¯çå¶ä½èä½ç½®ã\n * æ åºæ§ - ä¸è½çæéå¢æåºçæ°å­ãè¿å¯¹äºä¸äºç¹å®åºæ¯ä¸å©ãä¾å¦ï¼mysql innodb å­å¨å¼æä½¿ç¨ b+ æ å­å¨ç´¢å¼æ°æ®ï¼èä¸»é®ä¹æ¯ä¸ç§ç´¢å¼ãç´¢å¼æ°æ®å¨ b+ æ ä¸­æ¯æåºæåçãuuid çæ åºæ§å¯è½ä¼å¼èµ·æ°æ®ä½ç½®é¢ç¹åå¨ï¼ä¸¥éå½±åæ§è½ã\n\n\n# 2.3. éç¨åºæ¯\n\nuuid çéç¨åºæ¯å¯ä»¥ä¸ºä¸éè¦æå¿è¿å¤çç©ºé´å ç¨ï¼ä»¥åä¸éè¦çææéå¢è¶å¿çæ°å­ãå¨ log4j é uuidpatternconverter ä¸­å å¥äº uuid æ¥æ è¯æ¯ä¸æ¡æ¥å¿ã\n\n\n# 3. å©ç¨ç¬¬ä¸æ¹å­å¨çæé®\n\næå°èªå¢é®ï¼æåæ³å°çè¯å®æ¯ç´æ¥ä½¿ç¨æ°æ®åºèªå¢é®ãåæ°æ®åºå¯¹äºè¯¥éæ±ä¹æä¾äºç¸åºçæ¯æï¼æ¯å¦ mysql çèªå¢é®ï¼oracle çèªå¢åºåç­ã\n\nå½ç¶ï¼ä¹å¯ä»¥èèæ¯ç¨ redis è¿æ ·ç nosqlï¼çè³ zookeeper å»çæé®\n\n\n# 3.1. ä¼ç¹\n\n * éå¸¸ç®åï¼å©ç¨ç°æçåè½å®ç°ï¼ææ¬å°\n * æåºéå¢\n * æ¹ä¾¿æåºååé¡µ\n\n\n# 3.2. ç¼ºç¹\n\n * å¼ºä¾èµç¬¬ä¸æ¹å­å¨ï¼å¦æç¬¬ä¸æ¹å­å¨éé«å¯ç¨ç³»ç»ï¼è¥åºç°ä¸¢å¤±æ°æ®çæåµï¼å°±å¯è½åºç°éå¤çæ id çé®é¢ã\n * çæ id æ§è½ç¶é¢ä¾èµäºç¬¬ä¸æ¹å­å¨çæ§è½ã\n * å¢å äºå¯¹ç¬¬ä¸æ¹å­å¨è¿ç»´çææ¬ã\n\n\n# 4. éªè±ç®æ³ï¼snowflakeï¼\n\néªè±ç®æ³ï¼snowflakeï¼æ¯ç± twitter å¬å¸çåå¸å¼ä¸»é®çæç®æ³ï¼å®ä¼çæä¸ä¸ª 64 bit çæ´æ°ï¼å¯ä»¥ä¿è¯ä¸åè¿ç¨ä¸»é®çä¸éå¤æ§ï¼ä»¥åç¸åè¿ç¨ä¸»é®çæåºæ§ã\n\nå¨åä¸ä¸ªè¿ç¨ä¸­ï¼å®é¦åæ¯éè¿æ¶é´ä½ä¿è¯ä¸éå¤ï¼å¦ææ¶é´ç¸ååæ¯éè¿åºåä½ä¿è¯ã åæ¶ç±äºæ¶é´ä½æ¯åè°éå¢çï¼ä¸åä¸ªæå¡å¨å¦æå¤§ä½åäºæ¶é´åæ­¥ï¼é£ä¹çæçä¸»é®å¨åå¸å¼ç¯å¢å¯ä»¥è®¤ä¸ºæ¯æ»ä½æåºçï¼è¿å°±ä¿è¯äºå¯¹ç´¢å¼å­æ®µçæå¥çé«ææ§ã\n\n\n# 4.1. åºæ¬åç\n\n# 4.1.1. é®çç»æ\n\nä½¿ç¨éªè±ç®æ³çæçä¸»é®ï¼äºè¿å¶è¡¨ç¤ºå½¢å¼åå« 4 é¨åï¼ä»é«ä½å°ä½ä½åè¡¨ä¸ºï¼1bit ç¬¦å·ä½ã41bit æ¶é´æ³ä½ã10bit å·¥ä½è¿ç¨ä½ä»¥å 12bit åºåå·ä½ã\n\n * ç¬¦å·ä½(1bit)\n\né¢ççç¬¦å·ä½ï¼æä¸ºé¶ã\n\n * æ¶é´æ³ä½(41bit)\n\n41 ä½çæ¶é´æ³å¯ä»¥å®¹çº³çæ¯«ç§æ°æ¯ 2 ç 41 æ¬¡å¹ï¼ä¸å¹´æä½¿ç¨çæ¯«ç§æ°æ¯ï¼365 * 24 * 60 * 60 * 1000ãéè¿è®¡ç®å¯ç¥ï¼\n\nmath.pow(2, 41) / (365 * 24 * 60 * 60 * 1000l);\n\n\nç»æçº¦ç­äº 69.73 å¹´ãshardingsphere çéªè±ç®æ³çæ¶é´çºªåä» 2016 å¹´ 11 æ 1 æ¥é¶ç¹å¼å§ï¼å¯ä»¥ä½¿ç¨å° 2086 å¹´ï¼ç¸ä¿¡è½æ»¡è¶³ç»å¤§é¨åç³»ç»çè¦æ±ã\n\n * å·¥ä½è¿ç¨ä½(10bit)\n\nè¯¥æ å¿å¨ java è¿ç¨åæ¯å¯ä¸çï¼å¦ææ¯åå¸å¼åºç¨é¨ç½²åºä¿è¯æ¯ä¸ªå·¥ä½è¿ç¨ç id æ¯ä¸åçãè¯¥å¼é»è®¤ä¸º 0ï¼å¯éè¿å±æ§è®¾ç½®ã\n\n * åºåå·ä½(12bit)\n\nè¯¥åºåæ¯ç¨æ¥å¨åä¸ä¸ªæ¯«ç§åçæä¸åç idãå¦æå¨è¿ä¸ªæ¯«ç§åçæçæ°éè¶è¿ 4096(2 ç 12 æ¬¡å¹)ï¼é£ä¹çæå¨ä¼ç­å¾å°ä¸ä¸ªæ¯«ç§ç»§ç»­çæã\n\néªè±ç®æ³ä¸»é®çè¯¦ç»ç»æè§ä¸å¾ï¼\n\n\n\n# 4.1.2. æ¶éåæ¨\n\næå¡å¨æ¶éåæ¨ä¼å¯¼è´äº§çéå¤åºåï¼å æ­¤é»è®¤åå¸å¼ä¸»é®çæå¨æä¾äºä¸ä¸ªæå¤§å®¹å¿çæ¶éåæ¨æ¯«ç§æ°ã å¦ææ¶éåæ¨çæ¶é´è¶è¿æå¤§å®¹å¿çæ¯«ç§æ°éå¼ï¼åç¨åºæ¥éï¼å¦æå¨å¯å®¹å¿çèå´åï¼é»è®¤åå¸å¼ä¸»é®çæå¨ä¼ç­å¾æ¶éåæ­¥å°æåä¸æ¬¡ä¸»é®çæçæ¶é´ååç»§ç»­å·¥ä½ã æå¤§å®¹å¿çæ¶éåæ¨æ¯«ç§æ°çé»è®¤å¼ä¸º 0ï¼å¯éè¿å±æ§è®¾ç½®ã\n\n# 4.1.3. çµæ´»å®å¶\n\nä¸é¢åªæ¯ä¸ä¸ªå° 64bit ååçæ åï¼å½ç¶ä¹ä¸ä¸å®è¿ä¹åï¼å¯ä»¥æ ¹æ®ä¸åä¸å¡çå·ä½åºæ¯æ¥ååï¼æ¯å¦ä¸é¢ç»åºä¸ä¸ªä¸å¡åºæ¯ï¼\n\n * æå¡ç®å qps10 ä¸ï¼é¢è®¡å å¹´ä¹åä¼åå±å°ç¾ä¸ã\n * å½åæºå¨ä¸å°é¨ç½²ï¼ä¸æµ·ï¼åäº¬ï¼æ·±å³é½æã\n * å½åæºå¨ 10 å°å·¦å³ï¼é¢è®¡æªæ¥ä¼å¢å è³ç¾å°ã\n\nè¿ä¸ªæ¶åæä»¬æ ¹æ®ä¸é¢çåºæ¯å¯ä»¥åæ¬¡åççåå 62bitï¼qps å å¹´ä¹åä¼åå±å°ç¾ä¸ï¼é£ä¹æ¯æ¯«ç§å°±æ¯åçº§çè¯·æ±ï¼ç®å 10 å°æºå¨é£ä¹æ¯å°æºå¨æ¿æç¾çº§çè¯·æ±ï¼ä¸ºäºä¿è¯æ©å±ï¼åé¢çå¾ªç¯ä½å¯ä»¥éå¶å° 1024ï¼ä¹å°±æ¯ 2^10ï¼é£ä¹å¾ªç¯ä½ 10 ä½å°±è¶³å¤äºã\n\næºå¨ä¸å°é¨ç½²æä»¬å¯ä»¥ç¨ 3bit æ»å± 8 æ¥è¡¨ç¤ºæºæ¿ä½ç½®ï¼å½åçæºå¨ 10 å°ï¼ä¸ºäºä¿è¯æ©å±å°ç¾å°é£ä¹å¯ä»¥ç¨ 7bit 128 æ¥è¡¨ç¤ºï¼æ¶é´ä½ä¾ç¶æ¯ 41bitï¼é£ä¹è¿å©ä¸ 64-10-3-7-41-1 = 2bitï¼è¿å©ä¸ 2bit å¯ä»¥ç¨æ¥è¿è¡æ©å±ã\n\n\n\n\n# 4.2. ä¼ç¹\n\n * çæç id é½æ¯è¶å¿éå¢çã\n * ä¸ä¾èµæ°æ®åºç­ç¬¬ä¸æ¹ç³»ç»ï¼ä»¥æå¡çæ¹å¼é¨ç½²ï¼ç¨³å®æ§æ´é«ï¼çæ id çæ§è½ä¹æ¯éå¸¸é«çã\n * å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹æ§åé bit ä½ï¼éå¸¸çµæ´»ã\n\n\n# 4.3. ç¼ºç¹\n\n * å¼ºä¾èµæºå¨æ¶éï¼å¦ææºå¨ä¸æ¶éåæ¨ï¼ä¼å¯¼è´åå·éå¤æèæå¡ä¼å¤äºä¸å¯ç¨ç¶æã\n\n\n# 4.4. éç¨åºæ¯\n\nå½æä»¬éè¦æ åºä¸è½è¢«çæµç idï¼å¹¶ä¸éè¦ä¸å®é«æ§è½ï¼ä¸éè¦ long åï¼é£ä¹å°±å¯ä»¥ä½¿ç¨æä»¬éªè±ç®æ³ãæ¯å¦å¸¸è§çè®¢å idï¼ç¨éªè±ç®æ³å«äººå°±æ æ³çæµä½ æ¯å¤©çè®¢åéæ¯å¤å°ã\n\n\n# 4.5. é²æ­¢æ¶éåæ¨\n\néªè±ç®æ³æ¯å¼ºä¾èµäºæ¶é´çï¼èå¦ææºå¨æ¶é´åçåæ¨ï¼æå¯è½ä¼çæéå¤ç idã\n\næä»¬å¯ä»¥éå¯¹ç®æ³åä¸äºä¼åï¼æ¥é²æ­¢æ¶éåæ¨çæéå¤ idã\n\nç¨å½åæ¶é´åä¸ä¸æ¬¡çæ¶é´è¿è¡å¤æ­ï¼å¦æå½åæ¶é´å°äºä¸ä¸æ¬¡çæ¶é´é£ä¹è¯å®æ¯åçäºåæ¨ãæ®éçç®æ³ä¼ç´æ¥æåºå¼å¸¸ï¼è¿éæä»¬å¯ä»¥å¯¹å¶è¿è¡ä¼åï¼ä¸è¬åä¸ºä¸¤ä¸ªæåµ:\n\n * å¦ææ¶é´åæ¨æ¶é´è¾ç­ï¼æ¯å¦éç½® 5ms ä»¥åï¼é£ä¹å¯ä»¥ç´æ¥ç­å¾ä¸å®çæ¶é´ï¼è®©æºå¨çæ¶é´è¿½ä¸æ¥ã\n * å¦ææ¶é´çåæ¨æ¶é´è¾é¿ï¼æä»¬ä¸è½æ¥åè¿ä¹é¿çé»å¡ç­å¾ï¼é£ä¹åæä¸¤ä¸ªç­ç¥:\n   * ç´æ¥æç»ï¼æåºå¼å¸¸ãææ¥å¿ï¼éç¥ rd æ¶éåæ»ã\n   * å©ç¨æ©å±ä½ãä¸é¢æä»¬è®¨è®ºè¿ï¼ä¸åä¸å¡åºæ¯ä½æ°å¯è½ç¨ä¸å°é£ä¹å¤æ¯ç¹ä½ï¼é£ä¹æä»¬å¯ä»¥ææ©å±ä½æ°å©ç¨èµ·æ¥ãæ¯å¦ï¼å½è¿ä¸ªæ¶é´åæ¨æ¯è¾é¿çæ¶åï¼æä»¬å¯ä»¥ä¸éè¦ç­å¾ï¼ç´æ¥å¨æ©å±ä½å  1ãä¸¤ä½çæ©å±ä½åè®¸æä»¬æä¸æ¬¡å¤§çæ¶éåæ¨ï¼ä¸è¬æ¥è¯´å°±å¤äºï¼å¦æå¶è¶è¿ä¸æ¬¡æä»¬è¿æ¯éæ©æåºå¼å¸¸ï¼ææ¥å¿ã\n\n\n# 5. leaf\n\n> ç¾å¢æä¾äºä¸ç§åå¸å¼ id è§£å³æ¹æ¡ leafï¼å¶æ¬è´¨å¯ä»¥è§ä¸ºæ°æ®åºåæ®µ+æå¡ç¼å­ idã\n> \n> è¯¦æå¯ä»¥åè leafââç¾å¢ç¹è¯åå¸å¼ id çæç³»ç»\n\n\n# 5.1. åºæ¬åç\n\nä½¿ç¨æ°æ®åºçæ idï¼ä½æ¯åäºå¦ä¸æ¹è¿ï¼\n\nåæ¹æ¡æ¯æ¬¡è·å id é½å¾è¯»åä¸æ¬¡æ°æ®åºï¼é ææ°æ®åºååå¤§ãæ¹ä¸ºå©ç¨ proxy server æ¹éè·åï¼æ¯æ¬¡è·åä¸ä¸ª segment(step å³å®å¤§å°)å·æ®µçå¼ãç¨å®ä¹ååå»æ°æ®åºè·åæ°çå·æ®µï¼å¯ä»¥å¤§å¤§çåè½»æ°æ®åºçååã - åä¸ªä¸å¡ä¸åçåå·éæ±ç¨ biz_tag å­æ®µæ¥åºåï¼æ¯ä¸ª biz-tag ç id è·åç¸äºéç¦»ï¼äºä¸å½±åãå¦æä»¥åææ§è½éæ±éè¦å¯¹æ°æ®åºæ©å®¹ï¼ä¸éè¦ä¸è¿°æè¿°çå¤æçæ©å®¹æä½ï¼åªéè¦å¯¹ biz_tag ååºåè¡¨å°±è¡ã\n\næ°æ®åºè¡¨è®¾è®¡å¦ä¸ï¼\n\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n| field       | type         | null | key | default           | extra                       |\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n| biz_tag     | varchar(128) | no   | pri |                   |                             |\n| max_id      | bigint(20)   | no   |     | 1                 |                             |\n| step        | int(11)      | no   |     | null              |                             |\n| desc        | varchar(256) | yes  |     | null              |                             |\n| update_time | timestamp    | no   |     | current_timestamp | on update current_timestamp |\n+-------------+--------------+------+-----+-------------------+-----------------------------+\n\n\néè¦å­æ®µè¯´æï¼\n\n * biz_tag ç¨æ¥åºåä¸å¡\n * max_id è¡¨ç¤ºè¯¥ biz_tag ç®åæè¢«åéç id å·æ®µçæå¤§å¼\n * step è¡¨ç¤ºæ¯æ¬¡åéçå·æ®µé¿åº¦ãåæ¥è·å id æ¯æ¬¡é½éè¦åæ°æ®åºï¼ç°å¨åªéè¦æ step è®¾ç½®å¾è¶³å¤å¤§ï¼æ¯å¦ 1000ãé£ä¹åªæå½ 1000 ä¸ªå·è¢«æ¶èå®äºä¹åæä¼å»éæ°è¯»åä¸æ¬¡æ°æ®åºãè¯»åæ°æ®åºçé¢çä» 1 åå°å°äº 1/stepã\n\nå¤§è´æ¶æå¦ä¸å¾æç¤ºï¼\n\n\n\ntest_tag å¨ç¬¬ä¸å° leaf æºå¨ä¸æ¯ 1~1000 çå·æ®µï¼å½è¿ä¸ªå·æ®µç¨å®æ¶ï¼ä¼å»å è½½å¦ä¸ä¸ªé¿åº¦ä¸º step=1000 çå·æ®µï¼åè®¾å¦å¤ä¸¤å°å·æ®µé½æ²¡ææ´æ°ï¼è¿ä¸ªæ¶åç¬¬ä¸å°æºå¨æ°å è½½çå·æ®µå°±åºè¯¥æ¯ 3001~4000ãåæ¶æ°æ®åºå¯¹åºç biz_tag è¿æ¡æ°æ®ç max_id ä¼ä» 3000 è¢«æ´æ°æ 4000ï¼æ´æ°å·æ®µç sql è¯­å¥å¦ä¸ï¼\n\nbegin\nupdate table set max_id=max_id+step where biz_tag=xxx\nselect tag, max_id, step from table where biz_tag=xxx\ncommit\n\n\n\n# 5.2. ä¼ç¹\n\n * æ¯æ°æ®åºèªå¢é®æ§è½é«\n * è½ä¿è¯é®è¶å¿éå¢ã\n * å¦ææ°æ®åºå®æºï¼ç±äº proxserver æç¼å­ï¼ä¾ç¶å¯ä»¥åæä¸æ®µæ¶é´ã\n\n\n# 5.3. ç¼ºç¹\n\n * åä¸»é®éå¢ä¸æ ·ï¼å®¹æè¢«äººçæµã\n * æ°æ®åºå®æºåï¼è½ç¶è½æ¯æä¸æ®µæ¶é´ï¼ä½æ¯ä»ç¶ä¼é æç³»ç»ä¸å¯ç¨ã\n\n\n# 5.4. éç¨åºæ¯\n\néè¦è¶å¿éå¢ï¼å¹¶ä¸ id å¤§å°å¯æ§å¶çï¼å¯ä»¥ä½¿ç¨è¿å¥æ¹æ¡ã\n\nå½ç¶è¿ä¸ªæ¹æ¡ä¹å¯ä»¥éè¿ä¸äºææ®µé¿åè¢«äººçæµï¼æ id åææ¯æ åºçï¼æ¯å¦ææä»¬çæçæ°æ®æ¯ä¸ä¸ªéå¢ç long åï¼æè¿ä¸ª long åæå ä¸ªé¨åï¼æ¯å¦å¯ä»¥åæå ç»ä¸ä½æ°ï¼å ç»åä½æ°ï¼ç¶åå¨å»ºç«ä¸ä¸ªæ å°è¡¨ï¼å°æä»¬çæ°æ®åææ åºã\n\n\n# 6. åèèµæ\n\n * ç¾åº¦åå¸å¼ id\n * å¦æåæäººé®ä½ åå¸å¼ idï¼è¿ç¯æç« ä¸¢ç»ä»\n * çè§£åå¸å¼ id çæç®æ³ snowflake\n * leafââç¾å¢ç¹è¯åå¸å¼ id çæç³»ç»\n * uuid è§è\n * shardingsphere åå¸å¼ä¸»é®",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼äºå¡åºæ¬åç",frontmatter:{title:"åå¸å¼äºå¡åºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","äºå¡"],abbrlink:"83690cf5",date:"2019-06-21T11:30:00.000Z",permalink:"/pages/910bad/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/05.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/05.åå¸å¼äºå¡.md",key:"v-0349074a",path:"/pages/910bad/",headers:[{level:2,title:"1. åå¸å¼äºå¡ç®ä»",slug:"_1-åå¸å¼äºå¡ç®ä»",normalizedTitle:"1. åå¸å¼äºå¡ç®ä»",charIndex:57},{level:3,title:"1.1. æ¬å°äºå¡",slug:"_1-1-æ¬å°äºå¡",normalizedTitle:"1.1. æ¬å°äºå¡",charIndex:72},{level:3,title:"1.2. åå¸å¼äºå¡",slug:"_1-2-åå¸å¼äºå¡",normalizedTitle:"1.2. åå¸å¼äºå¡",charIndex:311},{level:3,title:"1.3. åå¸å¼äºå¡çé¾ç¹",slug:"_1-3-åå¸å¼äºå¡çé¾ç¹",normalizedTitle:"1.3. åå¸å¼äºå¡çé¾ç¹",charIndex:780},{level:3,title:"1.4. CAP å BASE",slug:"_1-4-cap-å-base",normalizedTitle:"1.4. cap å base",charIndex:1091},{level:3,title:"1.5. ææ§äºå¡",slug:"_1-5-ææ§äºå¡",normalizedTitle:"1.5. ææ§äºå¡",charIndex:1427},{level:4,title:"1.5.1. ææ§äºå¡çæ¦å¿µ",slug:"_1-5-1-ææ§äºå¡çæ¦å¿µ",normalizedTitle:"1.5.1. ææ§äºå¡çæ¦å¿µ",charIndex:1440},{level:4,title:"1.5.2. ææ§äºå¡çç¹æ§",slug:"_1-5-2-ææ§äºå¡çç¹æ§",normalizedTitle:"1.5.2. ææ§äºå¡çç¹æ§",charIndex:1716},{level:2,title:"2. ä¸¤é¶æ®µæäº¤ï¼2PCï¼",slug:"_2-ä¸¤é¶æ®µæäº¤-2pc",normalizedTitle:"2. ä¸¤é¶æ®µæäº¤ï¼2pcï¼",charIndex:2244},{level:3,title:"2.1. æ¹æ¡ç®ä»",slug:"_2-1-æ¹æ¡ç®ä»",normalizedTitle:"2.1. æ¹æ¡ç®ä»",charIndex:2262},{level:3,title:"2.2. å¤çæµç¨",slug:"_2-2-å¤çæµç¨",normalizedTitle:"2.2. å¤çæµç¨",charIndex:2650},{level:4,title:"2.2.1. é¶æ®µ 1ï¼åå¤é¶æ®µ",slug:"_2-2-1-é¶æ®µ-1-åå¤é¶æ®µ",normalizedTitle:"2.2.1. é¶æ®µ 1ï¼åå¤é¶æ®µ",charIndex:2719},{level:4,title:"2.2.2. é¶æ®µ 2ï¼æäº¤é¶æ®µ",slug:"_2-2-2-é¶æ®µ-2-æäº¤é¶æ®µ",normalizedTitle:"2.2.2. é¶æ®µ 2ï¼æäº¤é¶æ®µ",charIndex:2884},{level:3,title:"2.3. æ¹æ¡æ»ç»",slug:"_2-3-æ¹æ¡æ»ç»",normalizedTitle:"2.3. æ¹æ¡æ»ç»",charIndex:3411},{level:2,title:"3. ä¸é¶æ®µæäº¤ï¼3PCï¼",slug:"_3-ä¸é¶æ®µæäº¤-3pc",normalizedTitle:"3. ä¸é¶æ®µæäº¤ï¼3pcï¼",charIndex:3641},{level:3,title:"3.1. æ¹æ¡ç®ä»",slug:"_3-1-æ¹æ¡ç®ä»",normalizedTitle:"3.1. æ¹æ¡ç®ä»",charIndex:3659},{level:3,title:"3.2. å¤çæµç¨",slug:"_3-2-å¤çæµç¨",normalizedTitle:"3.2. å¤çæµç¨",charIndex:3885},{level:4,title:"3.2.1. é¶æ®µ 1ï¼canCommit",slug:"_3-2-1-é¶æ®µ-1-cancommit",normalizedTitle:"3.2.1. é¶æ®µ 1ï¼cancommit",charIndex:3898},{level:4,title:"3.2.2. é¶æ®µ 2ï¼preCommit",slug:"_3-2-2-é¶æ®µ-2-precommit",normalizedTitle:"3.2.2. é¶æ®µ 2ï¼precommit",charIndex:4110},{level:4,title:"3.2.3. é¶æ®µ 3ï¼doCommit",slug:"_3-2-3-é¶æ®µ-3-docommit",normalizedTitle:"3.2.3. é¶æ®µ 3ï¼docommit",charIndex:4529},{level:3,title:"3.3. æ¹æ¡æ»ç»",slug:"_3-3-æ¹æ¡æ»ç»",normalizedTitle:"3.3. æ¹æ¡æ»ç»",charIndex:5092},{level:2,title:"4. è¡¥å¿äºå¡ï¼TCCï¼",slug:"_4-è¡¥å¿äºå¡-tcc",normalizedTitle:"4. è¡¥å¿äºå¡ï¼tccï¼",charIndex:5302},{level:3,title:"4.1. æ¹æ¡ç®ä»",slug:"_4-1-æ¹æ¡ç®ä»",normalizedTitle:"4.1. æ¹æ¡ç®ä»",charIndex:5319},{level:3,title:"4.2. å¤çæµç¨",slug:"_4-2-å¤çæµç¨",normalizedTitle:"4.2. å¤çæµç¨",charIndex:5665},{level:4,title:"4.2.1. Try é¶æ®µ",slug:"_4-2-1-try-é¶æ®µ",normalizedTitle:"4.2.1. try é¶æ®µ",charIndex:5752},{level:4,title:"4.2.2. Confirm / Cancel é¶æ®µ",slug:"_4-2-2-confirm-cancel-é¶æ®µ",normalizedTitle:"4.2.2. confirm / cancel é¶æ®µ",charIndex:6102},{level:3,title:"4.3. æ¹æ¡æ»ç»",slug:"_4-3-æ¹æ¡æ»ç»",normalizedTitle:"4.3. æ¹æ¡æ»ç»",charIndex:6539},{level:2,title:"5. æ¬å°æ¶æ¯è¡¨",slug:"_5-æ¬å°æ¶æ¯è¡¨",normalizedTitle:"5. æ¬å°æ¶æ¯è¡¨",charIndex:6845},{level:3,title:"5.1. æ¹æ¡ç®ä»",slug:"_5-1-æ¹æ¡ç®ä»",normalizedTitle:"5.1. æ¹æ¡ç®ä»",charIndex:6858},{level:3,title:"5.2. å¤çæµç¨",slug:"_5-2-å¤çæµç¨",normalizedTitle:"5.2. å¤çæµç¨",charIndex:7083},{level:3,title:"5.3. æ¹æ¡æ»ç»",slug:"_5-3-æ¹æ¡æ»ç»",normalizedTitle:"5.3. æ¹æ¡æ»ç»",charIndex:7924},{level:2,title:"6. MQ äºå¡",slug:"_6-mq-äºå¡",normalizedTitle:"6. mq äºå¡",charIndex:8127},{level:3,title:"6.1. æ¹æ¡ç®ä»",slug:"_6-1-æ¹æ¡ç®ä»",normalizedTitle:"6.1. æ¹æ¡ç®ä»",charIndex:8140},{level:3,title:"6.2. å¤çæµç¨",slug:"_6-2-å¤çæµç¨",normalizedTitle:"6.2. å¤çæµç¨",charIndex:8216},{level:3,title:"6.3. æ¹æ¡æ»ç»",slug:"_6-3-æ¹æ¡æ»ç»",normalizedTitle:"6.3. æ¹æ¡æ»ç»",charIndex:8901},{level:2,title:"7. SAGA",slug:"_7-saga",normalizedTitle:"7. saga",charIndex:9066},{level:3,title:"7.1. æ¹æ¡ç®ä»",slug:"_7-1-æ¹æ¡ç®ä»",normalizedTitle:"7.1. æ¹æ¡ç®ä»",charIndex:9078},{level:3,title:"7.2. å¤çæµç¨",slug:"_7-2-å¤çæµç¨",normalizedTitle:"7.2. å¤çæµç¨",charIndex:9253},{level:4,title:"7.2.1. æ¢å¤ç­ç¥",slug:"_7-2-1-æ¢å¤ç­ç¥",normalizedTitle:"7.2.1. æ¢å¤ç­ç¥",charIndex:9661},{level:4,title:"7.2.2. å½ä»¤åè°",slug:"_7-2-2-å½ä»¤åè°",normalizedTitle:"7.2.2. å½ä»¤åè°",charIndex:10002},{level:4,title:"7.2.3. äºä»¶ç¼æ",slug:"_7-2-3-äºä»¶ç¼æ",normalizedTitle:"7.2.3. äºä»¶ç¼æ",charIndex:10454},{level:3,title:"7.3. æ¹æ¡æ»ç»",slug:"_7-3-æ¹æ¡æ»ç»",normalizedTitle:"7.3. æ¹æ¡æ»ç»",charIndex:10936},{level:2,title:"8. æ»ç»",slug:"_8-æ»ç»",normalizedTitle:"8. æ»ç»",charIndex:11420},{level:3,title:"8.1. åæ¹æ¡ä½¿ç¨åºæ¯",slug:"_8-1-åæ¹æ¡ä½¿ç¨åºæ¯",normalizedTitle:"8.1. åæ¹æ¡ä½¿ç¨åºæ¯",charIndex:11430},{level:3,title:"8.2. åå¸å¼äºå¡æ¹æ¡è®¾è®¡",slug:"_8-2-åå¸å¼äºå¡æ¹æ¡è®¾è®¡",normalizedTitle:"8.2. åå¸å¼äºå¡æ¹æ¡è®¾è®¡",charIndex:11910},{level:2,title:"9. åèèµæ",slug:"_9-åèèµæ",normalizedTitle:"9. åèèµæ",charIndex:12396}],headersStr:"1. åå¸å¼äºå¡ç®ä» 1.1. æ¬å°äºå¡ 1.2. åå¸å¼äºå¡ 1.3. åå¸å¼äºå¡çé¾ç¹ 1.4. CAP å BASE 1.5. ææ§äºå¡ 1.5.1. ææ§äºå¡çæ¦å¿µ 1.5.2. ææ§äºå¡çç¹æ§ 2. ä¸¤é¶æ®µæäº¤ï¼2PCï¼ 2.1. æ¹æ¡ç®ä» 2.2. å¤çæµç¨ 2.2.1. é¶æ®µ 1ï¼åå¤é¶æ®µ 2.2.2. é¶æ®µ 2ï¼æäº¤é¶æ®µ 2.3. æ¹æ¡æ»ç» 3. ä¸é¶æ®µæäº¤ï¼3PCï¼ 3.1. æ¹æ¡ç®ä» 3.2. å¤çæµç¨ 3.2.1. é¶æ®µ 1ï¼canCommit 3.2.2. é¶æ®µ 2ï¼preCommit 3.2.3. é¶æ®µ 3ï¼doCommit 3.3. æ¹æ¡æ»ç» 4. è¡¥å¿äºå¡ï¼TCCï¼ 4.1. æ¹æ¡ç®ä» 4.2. å¤çæµç¨ 4.2.1. Try é¶æ®µ 4.2.2. Confirm / Cancel é¶æ®µ 4.3. æ¹æ¡æ»ç» 5. æ¬å°æ¶æ¯è¡¨ 5.1. æ¹æ¡ç®ä» 5.2. å¤çæµç¨ 5.3. æ¹æ¡æ»ç» 6. MQ äºå¡ 6.1. æ¹æ¡ç®ä» 6.2. å¤çæµç¨ 6.3. æ¹æ¡æ»ç» 7. SAGA 7.1. æ¹æ¡ç®ä» 7.2. å¤çæµç¨ 7.2.1. æ¢å¤ç­ç¥ 7.2.2. å½ä»¤åè° 7.2.3. äºä»¶ç¼æ 7.3. æ¹æ¡æ»ç» 8. æ»ç» 8.1. åæ¹æ¡ä½¿ç¨åºæ¯ 8.2. åå¸å¼äºå¡æ¹æ¡è®¾è®¡ 9. åèèµæ",content:'# åå¸å¼äºå¡åºæ¬åç\n\n> åå¸å¼äºå¡æçæ¯äºå¡æä½è·¨è¶å¤ä¸ªèç¹ï¼å¹¶ä¸è¦æ±æ»¡è¶³äºå¡ç ACID ç¹æ§ã\n\n\n# 1. åå¸å¼äºå¡ç®ä»\n\n\n# 1.1. æ¬å°äºå¡\n\nå­¦ä¹ åå¸å¼ä¹åï¼åäºè§£ä¸ä¸æ¬å°äºå¡çæ¦å¿µã\n\näºå¡ç®åæ¥è¯´ï¼ä¸ä¸ªä¼è¯ä¸­æè¿è¡ææçæä½ï¼è¦ä¹åæ¶æåï¼è¦ä¹åæ¶å¤±è´¥ã\n\n\n\nå·ä½æ¥è¯´ï¼äºå¡æçæ¯æ»¡è¶³ ACID ç¹æ§çä¸ç»æä½ï¼å¯ä»¥éè¿ Commit æäº¤ä¸ä¸ªäºå¡ï¼ä¹å¯ä»¥ä½¿ç¨ Rollback è¿è¡åæ»ã\n\n * åå­æ§ï¼Atomicityï¼\n * ä¸è´æ§ï¼Consistencyï¼\n * éç¦»æ§ï¼Isolationï¼\n * æä¹æ§ï¼Durabilityï¼\n\n> ð¡ æ´è¯¦ç»çåå®¹å¯ä»¥åèï¼äºå¡\n\n\n# 1.2. åå¸å¼äºå¡\n\nåå¸å¼äºå¡æçæ¯äºå¡æä½è·¨è¶å¤ä¸ªèç¹ï¼å¹¶ä¸è¦æ±æ»¡è¶³äºå¡ç ACID ç¹æ§ã\n\néçäºèç½å¿«éåå±ï¼å¾®æå¡ï¼SOA ç­æå¡æ¶ææ¨¡å¼æ­£å¨è¢«å¤§è§æ¨¡çä½¿ç¨ï¼ç°å¨åå¸å¼ç³»ç»ä¸è¬ç±å¤ä¸ªç¬ç«çå­ç³»ç»ç»æï¼å¤ä¸ªå­ç³»ç»éè¿ç½ç»éä¿¡äºç¸åä½éåå®æåä¸ªåè½ã\n\næå¾å¤ç¨ä¾ä¼è·¨å¤ä¸ªå­ç³»ç»æè½å®æï¼æ¯è¾å¸åçæ¯çµå­åå¡ç½ç«çä¸åæ¯ä»æµç¨ï¼è³å°ä¼æ¶åäº¤æç³»ç»åæ¯ä»ç³»ç»ï¼èä¸è¿ä¸ªè¿ç¨ä¸­ä¼æ¶åå°äºå¡çæ¦å¿µï¼å³ä¿è¯äº¤æç³»ç»åæ¯ä»ç³»ç»çæ°æ®ä¸è´æ§ï¼æ­¤å¤æä»¬ç§°è¿ç§è·¨ç³»ç»çäºå¡ä¸ºåå¸å¼äºå¡ï¼å·ä½ä¸ç¹èè¨ï¼åå¸å¼äºå¡æ¯æäºå¡çåä¸èãæ¯æäºå¡çæå¡å¨ãèµæºæå¡å¨ä»¥åäºå¡ç®¡çå¨åå«ä½äºä¸åçåå¸å¼ç³»ç»çä¸åèç¹ä¹ä¸ã\n\nä¸¾ä¸ªäºèç½å¸¸ç¨çäº¤æä¸å¡ä¸ºä¾ï¼\n\n\n\nä¸å¾ä¸­åå«äºåºå­åè®¢åä¸¤ä¸ªç¬ç«çå¾®æå¡ï¼æ¯ä¸ªå¾®æå¡ç»´æ¤äºèªå·±çæ°æ®åºãå¨äº¤æç³»ç»çä¸å¡é»è¾ä¸­ï¼ä¸ä¸ªååå¨ä¸åä¹åéè¦åè°ç¨åºå­æå¡ï¼è¿è¡æ£é¤åºå­ï¼åè°ç¨è®¢åæå¡ï¼åå»ºè®¢åè®°å½ã\n\n\n\nå¯ä»¥çå°ï¼å¦æå¤ä¸ªæ°æ®åºä¹é´çæ°æ®æ´æ°æ²¡æä¿è¯äºå¡ï¼å°ä¼å¯¼è´åºç°å­ç³»ç»æ°æ®ä¸ä¸è´ï¼ä¸å¡åºç°é®é¢ã\n\n\n# 1.3. åå¸å¼äºå¡çé¾ç¹\n\n * äºå¡çåå­æ§ äºå¡æä½è·¨ä¸åèç¹ï¼å½å¤ä¸ªèç¹æä¸èç¹æä½å¤±è´¥æ¶ï¼éè¦ä¿è¯å¤èç¹æä½ç**é½åæé½ä¸åï¼All or Nothingï¼**çåå­æ§ã\n * äºå¡çä¸è´æ§ å½åçç½ç»ä¼ è¾æéæèèç¹æéï¼èç¹é´æ°æ®å¤å¶ééä¸­æ­ï¼å¨è¿è¡äºå¡æä½æ¶éè¦ä¿è¯æ°æ®ä¸è´æ§ï¼ä¿è¯äºå¡çä»»ä½æä½é½ä¸ä¼ä½¿å¾æ°æ®è¿åæ°æ®åºå®ä¹ççº¦æãè§¦åå¨ç­è§åã\n * äºå¡çéç¦»æ§ äºå¡éç¦»æ§çæ¬è´¨å°±æ¯å¦ä½æ­£ç¡®å¤ä¸ªå¹¶åäºå¡çå¤ççè¯»åå²çªåååå²çªï¼å ä¸ºå¨åå¸å¼äºå¡æ§å¶ä¸­ï¼å¯è½ä¼åºç°æäº¤ä¸åæ­¥çç°è±¡ï¼è¿ä¸ªæ¶åå°±æå¯è½åºç°âé¨åå·²ç»æäº¤âçäºå¡ãæ­¤æ¶å¹¶ååºç¨è®¿é®æ°æ®å¦ææ²¡æå ä»¥æ§å¶ï¼æå¯è½åºç°âèè¯»âé®é¢ã\n\n\n# 1.4. CAP å BASE\n\nCAP å®çåç§°ä¸º CAP ååï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ ä¸è´æ§ï¼Cï¼Consistencyï¼ãå¯ç¨æ§ï¼Aï¼Availabilityï¼ å ååºå®¹å¿æ§ï¼Pï¼Partition Toleranceï¼ï¼æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\nBASE æ¯ åºæ¬å¯ç¨ï¼Basically Availableï¼ãè½¯ç¶æï¼Soft Stateï¼ å æç»ä¸è´æ§ï¼Eventually Consistentï¼ ä¸ä¸ªç­è¯­çç¼©åãBASE çè®ºæ¯å¯¹ CAP ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æï¼å®ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n> ð¡ æ´è¯¦ç»çåå®¹å¯ä»¥åèï¼åå¸å¼çè®º\n\n\n# 1.5. ææ§äºå¡\n\n# 1.5.1. ææ§äºå¡çæ¦å¿µ\n\nå¨çµåç­äºèç½åºæ¯ä¸ï¼ä¼ ç»çäºå¡å¨æ°æ®åºæ§è½åå¤çè½åä¸é½æ´é²åºäºç¶é¢ãå¨åå¸å¼é¢ååºäº CAP çè®ºä»¥å BASE çè®ºï¼æäººå°±æåºäºææ§äºå¡çæ¦å¿µã\n\nåºäº BASE çè®ºçè®¾è®¡ææ³ï¼ææ§äºå¡ä¸ï¼å¨ä¸å½±åç³»ç»æ´ä½å¯ç¨æ§çæåµä¸(Basically Available åºæ¬å¯ç¨)ï¼åè®¸ç³»ç»å­å¨æ°æ®ä¸ä¸è´çä¸­é´ç¶æ(Soft State è½¯ç¶æ)ï¼å¨ç»è¿æ°æ®åæ­¥çå»¶æ¶ä¹åï¼æç»æ°æ®è½å¤è¾¾å°ä¸è´ãå¹¶ä¸æ¯å®å¨æ¾å¼äº ACIDï¼èæ¯éè¿æ¾å®½ä¸è´æ§è¦æ±ï¼åå©æ¬å°äºå¡æ¥å®ç°æç»åå¸å¼äºå¡ä¸è´æ§çåæ¶ä¹ä¿è¯ç³»ç»çååã\n\n# 1.5.2. ææ§äºå¡çç¹æ§\n\nä¸é¢ä»ç»çæ¯å®ç°ææ§äºå¡çä¸äºå¸¸è§ç¹æ§ï¼è¿äºç¹æ§å¨å·ä½çæ¹æ¡ä¸­ä¸ä¸å®é½è¦æ»¡è¶³ï¼å ä¸ºä¸åçæ¹æ¡è¦æ±ä¸ä¸æ ·ã\n\nå¯è§æ§(å¯¹å¤å¯æ¥è¯¢) å¨åå¸å¼äºå¡æ§è¡è¿ç¨ä¸­ï¼å¦ææä¸ä¸ªæ­¥éª¤æ§è¡åºéï¼å°±éè¦æç¡®çç¥éå¶ä»å ä¸ªæä½çå¤çæåµï¼è¿å°±éè¦å¶ä»çæå¡é½è½å¤æä¾æ¥è¯¢æ¥å£ï¼ä¿è¯å¯ä»¥éè¿æ¥è¯¢æ¥å¤æ­æä½çå¤çæåµã\n\nä¸ºäºä¿è¯æä½çå¯æ¥è¯¢ï¼éè¦å¯¹äºæ¯ä¸ä¸ªæå¡çæ¯ä¸æ¬¡è°ç¨é½æä¸ä¸ªå¨å±å¯ä¸çæ è¯ï¼å¯ä»¥æ¯ä¸å¡åæ®å·ï¼å¦è®¢åå·ï¼ãä¹å¯ä»¥æ¯ç³»ç»åéçæä½æµæ°´å·ï¼å¦æ¯ä»è®°å½æµæ°´å·ï¼ãé¤æ­¤ä¹å¤ï¼æä½çæ¶é´ä¿¡æ¯ä¹è¦æå®æ´çè®°å½ã\n\næä½å¹ç­æ§ å¹ç­æ§ï¼å¶å®æ¯ä¸ä¸ªæ°å­¦æ¦å¿µãå¹ç­å½æ°ï¼æå¹ç­æ¹æ³ï¼æ¯æå¯ä»¥ä½¿ç¨ç¸ååæ°éå¤æ§è¡ï¼å¹¶è½è·å¾ç¸åç»æçå½æ°ãå¹ç­æä½çç¹ç¹æ¯å¶ä»»æå¤æ¬¡æ§è¡æäº§ççå½±ååä¸ä¸æ¬¡æ§è¡çå½±åç¸åãä¹å°±æ¯è¯´ï¼åä¸ä¸ªæ¹æ³ï¼ä½¿ç¨åæ ·çåæ°ï¼è°ç¨å¤æ¬¡äº§ççä¸å¡ç»æä¸è°ç¨ä¸æ¬¡äº§ççä¸å¡ç»æç¸åã\n\nä¹æä»¥éè¦æä½å¹ç­æ§ï¼æ¯å ä¸ºä¸ºäºä¿è¯æ°æ®çæç»ä¸è´æ§ï¼å¾å¤äºå¡åè®®é½ä¼æå¾å¤éè¯çæä½ï¼å¦æä¸ä¸ªæ¹æ³ä¸ä¿è¯å¹ç­ï¼é£ä¹å°æ æ³è¢«éè¯ãå¹ç­æä½çå®ç°æ¹å¼æå¤ç§ï¼å¦å¨ç³»ç»ä¸­ç¼å­ææçè¯·æ±ä¸å¤çç»æãæ£æµå°éå¤æä½åï¼ç´æ¥è¿åä¸ä¸æ¬¡çå¤çç»æç­ã\n\n\n# 2. ä¸¤é¶æ®µæäº¤ï¼2PCï¼\n\n\n# 2.1. æ¹æ¡ç®ä»\n\näºé¶æ®µæäº¤åè®®ï¼Two-phase Commitï¼å³ 2PCï¼æ¯å¸¸ç¨çåå¸å¼äºå¡è§£å³æ¹æ¡ï¼å³å°äºå¡çæäº¤è¿ç¨åä¸ºä¸¤ä¸ªé¶æ®µæ¥è¿è¡å¤çï¼åå¤é¶æ®µåæäº¤é¶æ®µãäºå¡çåèµ·èç§°åè°èï¼äºå¡çæ§è¡èç§°åä¸èã\n\nå¨åå¸å¼ç³»ç»éï¼æ¯ä¸ªèç¹é½å¯ä»¥ç¥æèªå·±æä½çæåæèå¤±è´¥ï¼å´æ æ³ç¥éå¶ä»èç¹æä½çæåæå¤±è´¥ãå½ä¸ä¸ªäºå¡è·¨å¤ä¸ªèç¹æ¶ï¼ä¸ºäºä¿æäºå¡çåå­æ§ä¸ä¸è´æ§ï¼èå¼å¥ä¸ä¸ªåè°èæ¥ç»ä¸ææ§ææåä¸èçæä½ç»æï¼å¹¶æç¤ºå®ä»¬æ¯å¦è¦ææä½ç»æè¿è¡çæ­£çæäº¤æèåæ»ï¼rollbackï¼ã\n\näºé¶æ®µæäº¤çæè·¯å¯ä»¥æ¦æ¬ä¸ºï¼åä¸èå°æä½æè´¥éç¥åè°èï¼åç±åè°èæ ¹æ®ææåä¸èçåé¦ææ¥å³å®ååä¸èæ¯å¦è¦æäº¤æä½è¿æ¯ä¸­æ­¢æä½ã\n\næ ¸å¿ææ³å°±æ¯å¯¹æ¯ä¸ä¸ªäºå¡é½éç¨åå°è¯åæäº¤çå¤çæ¹å¼ï¼å¤çåææçè¯»æä½é½è¦è½è·å¾ææ°çæ°æ®ï¼å æ­¤ä¹å¯ä»¥å°äºé¶æ®µæäº¤çä½æ¯ä¸ä¸ªå¼ºä¸è´æ§ç®æ³ã\n\n\n# 2.2. å¤çæµç¨\n\nç®åä¸ç¹çè§£ï¼å¯ä»¥æåè°èèç¹æ¯å»ä¸ºå¸¦å¤´å¤§å¥ï¼åä¸èçè§£æ¯å»ä¸ºè·ç­å°å¼ï¼å¸¦å¤´å¤§å¥ç»ä¸åè°è·ç­å°å¼çä»»å¡æ§è¡ã\n\n# 2.2.1. é¶æ®µ 1ï¼åå¤é¶æ®µ\n\n 1. åè°èåææåä¸èåéäºå¡åå®¹ï¼è¯¢é®æ¯å¦å¯ä»¥æäº¤äºå¡ï¼å¹¶ç­å¾ææåä¸èç­å¤ã\n 2. ååä¸èæ§è¡äºå¡æä½ï¼å° undo å redo ä¿¡æ¯è®°å¥äºå¡æ¥å¿ä¸­ï¼ä½ä¸æäº¤äºå¡ï¼ã\n 3. å¦åä¸èæ§è¡æåï¼ç»åè°èåé¦ yesï¼å³å¯ä»¥æäº¤ï¼å¦æ§è¡å¤±è´¥ï¼ç»åè°èåé¦ noï¼å³ä¸å¯æäº¤ã\n\n# 2.2.2. é¶æ®µ 2ï¼æäº¤é¶æ®µ\n\nå¦æåè°èæ¶å°äºåä¸èçå¤±è´¥æ¶æ¯æèè¶æ¶ï¼ç´æ¥ç»æ¯ä¸ªåä¸èåéåæ»(rollback)æ¶æ¯ï¼å¦åï¼åéæäº¤(commit)æ¶æ¯ï¼åä¸èæ ¹æ®åè°èçæä»¤æ§è¡æäº¤æèåæ»æä½ï¼éæ¾ææäºå¡å¤çè¿ç¨ä¸­ä½¿ç¨çéèµæºã(æ³¨æ:å¿é¡»å¨æåé¶æ®µéæ¾éèµæº) æ¥ä¸æ¥åä¸¤ç§æåµåå«è®¨è®ºæäº¤é¶æ®µçè¿ç¨ã\n\næåµ 1ï¼å½ææåä¸èååé¦ yesï¼æäº¤äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååºæ­£å¼æäº¤äºå¡çè¯·æ±ï¼å³ commit è¯·æ±ï¼ã\n>  2. åä¸èæ§è¡ commit è¯·æ±ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack(åºç­)å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡æäº¤ã\n\næåµ 2ï¼å½ä»»ä½é¶æ®µ 1 ä¸ä¸ªåä¸èåé¦ noï¼ä¸­æ­äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååºåæ»è¯·æ±ï¼å³ rollback è¯·æ±ï¼ã\n>  2. åä¸èä½¿ç¨é¶æ®µ 1 ä¸­ç undo ä¿¡æ¯æ§è¡åæ»æä½ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡ä¸­æ­ã\n\n\n# 2.3. æ¹æ¡æ»ç»\n\n2PC æ¹æ¡å®ç°èµ·æ¥ç®åï¼å®éé¡¹ç®ä¸­ä½¿ç¨æ¯è¾å°ï¼ä¸»è¦å ä¸ºä»¥ä¸é®é¢ï¼\n\n * æ§è½é®é¢ - ææåä¸èå¨äºå¡æäº¤é¶æ®µå¤äºåæ­¥é»å¡ç¶æï¼å ç¨ç³»ç»èµæºï¼å®¹æå¯¼è´æ§è½ç¶é¢ã\n * å¯é æ§é®é¢ - å¦æåè°èå­å¨åç¹æéé®é¢ï¼å¦æåè°èåºç°æéï¼åä¸èå°ä¸ç´å¤äºéå®ç¶æã\n * æ°æ®ä¸è´æ§é®é¢ - å¨é¶æ®µ 2 ä¸­ï¼å¦æåçå±é¨ç½ç»é®é¢ï¼ä¸é¨åäºå¡åä¸èæ¶å°äºæäº¤æ¶æ¯ï¼å¦ä¸é¨åäºå¡åä¸èæ²¡æ¶å°æäº¤æ¶æ¯ï¼é£ä¹å°±å¯¼è´äºèç¹ä¹é´æ°æ®çä¸ä¸è´ã\n\n\n# 3. ä¸é¶æ®µæäº¤ï¼3PCï¼\n\n\n# 3.1. æ¹æ¡ç®ä»\n\nä¸é¶æ®µæäº¤åè®®ï¼Three-phase Commitï¼3PCï¼ï¼æ¯äºé¶æ®µæäº¤åè®®çæ¹è¿çæ¬ï¼ä¸äºé¶æ®µæäº¤ä¸åçæ¯ï¼å¼å¥è¶æ¶æºå¶ãåæ¶å¨åè°èååä¸èä¸­é½å¼å¥è¶æ¶æºå¶ã\n\nä¸é¶æ®µæäº¤å°äºé¶æ®µçåå¤é¶æ®µæåä¸º 2 ä¸ªé¶æ®µï¼æå¥äºä¸ä¸ª preCommit é¶æ®µï¼ä½¿å¾ååå¨äºé¶æ®µæäº¤ä¸­ï¼åä¸èå¨åå¤ä¹åï¼ç±äºåè°èåçå´©æºæéè¯¯ï¼èå¯¼è´åä¸èå¤äºæ æ³ç¥ææ¯å¦æäº¤æèä¸­æ­¢çâä¸ç¡®å®ç¶æâæäº§ççå¯è½ç¸å½é¿çå»¶æ¶çé®é¢å¾ä»¥è§£å³ã\n\n\n# 3.2. å¤çæµç¨\n\n# 3.2.1. é¶æ®µ 1ï¼canCommit\n\nåè°èååä¸èåé commit è¯·æ±ï¼åä¸èå¦æå¯ä»¥æäº¤å°±è¿å yes ååº(åä¸èä¸æ§è¡äºå¡æä½)ï¼å¦åè¿å no ååºï¼\n\n 1. åè°èåææåä¸èååºåå«äºå¡åå®¹ç canCommit è¯·æ±ï¼è¯¢é®æ¯å¦å¯ä»¥æäº¤äºå¡ï¼å¹¶ç­å¾ææåä¸èç­å¤ã\n 2. åä¸èæ¶å° canCommit è¯·æ±åï¼å¦æè®¤ä¸ºå¯ä»¥æ§è¡äºå¡æä½ï¼ååé¦ yes å¹¶è¿å¥é¢å¤ç¶æï¼å¦ååé¦ noã\n\n# 3.2.2. é¶æ®µ 2ï¼preCommit\n\nåè°èæ ¹æ®é¶æ®µ 1 canCommit åä¸èçååºæåµæ¥å³å®æ¯å¦å¯ä»¥åºäºäºå¡ç preCommit æä½ãæ ¹æ®ååºæåµï¼æä»¥ä¸ä¸¤ç§å¯è½ã\n\næåµ 1ï¼é¶æ®µ 1 ææåä¸èååé¦ yesï¼åä¸èé¢æ§è¡äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååº preCommit è¯·æ±ï¼è¿å¥åå¤é¶æ®µã\n>  2. åä¸èæ¶å° preCommit è¯·æ±åï¼æ§è¡äºå¡æä½ï¼å° undo å redo ä¿¡æ¯è®°å¥äºå¡æ¥å¿ä¸­ï¼ä½ä¸æäº¤äºå¡ï¼ã\n>  3. ååä¸èååè°èåé¦ ack ååºæ no ååºï¼å¹¶ç­å¾æç»æä»¤ã\n\næåµ 2ï¼é¶æ®µ 1 ä»»ä½ä¸ä¸ªåä¸èåé¦ noï¼æèç­å¾è¶æ¶ååè°èå°æ æ³æ¶å°ææåä¸èçåé¦ï¼å³ä¸­æ­äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååº abort è¯·æ±ã\n>  2. æ è®ºæ¶å°åè°èååºç abort è¯·æ±ï¼æèå¨ç­å¾åè°èè¯·æ±è¿ç¨ä¸­åºç°è¶æ¶ï¼åä¸èåä¼ä¸­æ­äºå¡ã\n\n# 3.2.3. é¶æ®µ 3ï¼doCommit\n\nè¯¥é¶æ®µè¿è¡çæ­£çäºå¡æäº¤ï¼ä¹å¯ä»¥åä¸ºä»¥ä¸ä¸¤ç§æåµï¼\n\næåµ 1ï¼é¶æ®µ 2 ææåä¸èååé¦ ack ååºï¼æ§è¡çæ­£çäºå¡æäº¤ã\n\n\n\n>  1. å¦æåè°èå¤äºå·¥ä½ç¶æï¼ååææåä¸èååº do Commit è¯·æ±ã\n>  2. åä¸èæ¶å° do Commit è¯·æ±åï¼ä¼æ­£å¼æ§è¡äºå¡æäº¤ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡æäº¤ã\n\næåµ 2ï¼ä»»ä½ä¸ä¸ªåä¸èåé¦ noï¼æèç­å¾è¶æ¶ååè°èå°æ æ³æ¶å°ææåä¸èçåé¦ï¼å³ä¸­æ­äºå¡ã\n\n\n\n>  1. å¦æåè°èå¤äºå·¥ä½ç¶æï¼åææåä¸èååº abort è¯·æ±ã\n>  2. åä¸èä½¿ç¨é¶æ®µ 1 ä¸­ç undo ä¿¡æ¯æ§è¡åæ»æä½ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡ä¸­æ­ã\n\næ³¨æï¼è¿å¥é¶æ®µ 3 åï¼æ è®ºåè°èåºç°é®é¢ï¼æèåè°èä¸åä¸èç½ç»åºç°é®é¢ï¼é½ä¼å¯¼è´åä¸èæ æ³æ¥æ¶å°åè°èååºç do Commit è¯·æ±æ abort è¯·æ±ãæ­¤æ¶ï¼åä¸èé½ä¼å¨ç­å¾è¶æ¶ä¹åï¼ç»§ç»­æ§è¡äºå¡æäº¤ã\n\n\n# 3.3. æ¹æ¡æ»ç»\n\nä¼ç¹ï¼\n\n * ç¸æ¯äºé¶æ®µæäº¤ï¼ä¸é¶æ®µéä½äºé»å¡èå´ï¼å¨ç­å¾è¶æ¶ååè°èæåä¸èä¼ä¸­æ­äºå¡ãé¿åäºåè°èåç¹é®é¢ï¼é¶æ®µ 3 ä¸­åè°èåºç°é®é¢æ¶ï¼åä¸èä¼ç»§ç»­æäº¤äºå¡ã\n\nç¼ºç¹ï¼\n\n * æ°æ®ä¸ä¸è´é®é¢ä¾ç¶å­å¨ï¼å½å¨åä¸èæ¶å° preCommit è¯·æ±åç­å¾ do commite æä»¤æ¶ï¼æ­¤æ¶å¦æåè°èè¯·æ±ä¸­æ­äºå¡ï¼èåè°èæ æ³ä¸åä¸èæ­£å¸¸éä¿¡ï¼ä¼å¯¼è´åä¸èç»§ç»­æäº¤äºå¡ï¼é ææ°æ®ä¸ä¸è´ã\n\n\n# 4. è¡¥å¿äºå¡ï¼TCCï¼\n\n\n# 4.1. æ¹æ¡ç®ä»\n\nTCCï¼Try-Confirm-Cancelï¼çæ¦å¿µï¼ææ©æ¯ç± Pat Helland äº 2007 å¹´åè¡¨çä¸ç¯åä¸ºãLife beyond Distributed Transactions:an Apostateâs Opinionãçè®ºææåºã\n\nTCC æ¯æå¡åçäºé¶æ®µç¼ç¨æ¨¡åï¼å¶ TryãConfirmãCancel 3 ä¸ªæ¹æ³åç±ä¸å¡ç¼ç å®ç°ï¼\n\n * Try - æä½ä½ä¸ºä¸é¶æ®µï¼è´è´£èµæºçæ£æ¥åé¢çã\n * Confirm - æä½ä½ä¸ºäºé¶æ®µæäº¤æä½ï¼æ§è¡çæ­£çä¸å¡ã\n * Cancel - æ¯é¢çèµæºçåæ¶ã\n\nTCC äºå¡ç TryãConfirmãCancel å¯ä»¥çè§£ä¸º SQL äºå¡ä¸­ç LockãCommitãRollbackã\n\n\n# 4.2. å¤çæµç¨\n\nä¸ºäºæ¹ä¾¿çè§£ï¼ä¸é¢ä»¥çµåä¸åä¸ºä¾è¿è¡æ¹æ¡è§£æï¼è¿éææ´ä¸ªè¿ç¨ç®ååä¸ºæ£ååºå­ï¼è®¢ååå»º 2 ä¸ªæ­¥éª¤ï¼åºå­æå¡åè®¢åæå¡åå«å¨ä¸åçæå¡å¨èç¹ä¸ã\n\n# 4.2.1. Try é¶æ®µ\n\nä»æ§è¡é¶æ®µæ¥çï¼ä¸ä¼ ç»äºå¡æºå¶ä¸­ä¸å¡é»è¾ç¸åãä½ä»ä¸å¡è§åº¦æ¥çï¼å´ä¸ä¸æ ·ãTCC æºå¶ä¸­ç Try ä»æ¯ä¸ä¸ªåæ­¥æä½ï¼å®ååç»­çç¡®è®¤ä¸èµ·æè½çæ­£ææä¸ä¸ªå®æ´çä¸å¡é»è¾ï¼è¿ä¸ªé¶æ®µä¸»è¦å®æï¼\n\n * å®æææä¸å¡æ£æ¥( ä¸è´æ§ )\n * é¢çå¿é¡»ä¸å¡èµæº( åéç¦»æ§ )\n * Try å°è¯æ§è¡ä¸å¡ TCC äºå¡æºå¶ä»¥åæ­¥æä½ï¼Tryï¼ä¸ºä¸­å¿çï¼ç¡®è®¤æä½ï¼Confirmï¼ååæ¶æä½ï¼Cancelï¼é½æ¯å´ç»åæ­¥æä½ï¼Tryï¼èå±å¼ãå æ­¤ï¼Try é¶æ®µä¸­çæä½ï¼å¶ä¿éæ§æ¯æå¥½çï¼å³ä½¿å¤±è´¥ï¼ä»ç¶æåæ¶æä½ï¼Cancelï¼å¯ä»¥å°å¶æ§è¡ç»ææ¤éã\n\nåè®¾åååºå­ä¸º 100ï¼è´­ä¹°æ°éä¸º 2ï¼è¿éæ£æ¥åæ´æ°åºå­çåæ¶ï¼å»ç»ç¨æ·è´­ä¹°æ°éçåºå­ï¼åæ¶åå»ºè®¢åï¼è®¢åç¶æä¸ºå¾ç¡®è®¤ã\n\n# 4.2.2. Confirm / Cancel é¶æ®µ\n\næ ¹æ® Try é¶æ®µæå¡æ¯å¦å¨é¨æ­£å¸¸æ§è¡ï¼ç»§ç»­æ§è¡ç¡®è®¤æä½ï¼Confirmï¼æåæ¶æä½ï¼Cancelï¼ã Confirm å Cancel æä½æ»¡è¶³å¹ç­æ§ï¼å¦æ Confirm æ Cancel æä½æ§è¡å¤±è´¥ï¼å°ä¼ä¸æ­éè¯ç´å°æ§è¡å®æã\n\nConfirmï¼å½ Try é¶æ®µæå¡å¨é¨æ­£å¸¸æ§è¡ï¼ æ§è¡ç¡®è®¤ä¸å¡é»è¾æä½\n\n\n\nè¿éä½¿ç¨çèµæºä¸å®æ¯ Try é¶æ®µé¢ççä¸å¡èµæºãå¨ TCC äºå¡æºå¶ä¸­è®¤ä¸ºï¼å¦æå¨ Try é¶æ®µè½æ­£å¸¸çé¢çèµæºï¼é£ Confirm ä¸å®è½å®æ´æ­£ç¡®çæäº¤ãConfirm é¶æ®µä¹å¯ä»¥çææ¯å¯¹ Try é¶æ®µçä¸ä¸ªè¡¥åï¼Try+Confirm ä¸èµ·ç»æäºä¸ä¸ªå®æ´çä¸å¡é»è¾ã\n\nCancelï¼å½ Try é¶æ®µå­å¨æå¡æ§è¡å¤±è´¥ï¼ è¿å¥ Cancel é¶æ®µ\n\n\n\nCancel åæ¶æ§è¡ï¼éæ¾ Try é¶æ®µé¢ççä¸å¡èµæºï¼ä¸é¢çä¾å­ä¸­ï¼Cancel æä½ä¼æå»ç»çåºå­éæ¾ï¼å¹¶æ´æ°è®¢åç¶æä¸ºåæ¶ã\n\n\n# 4.3. æ¹æ¡æ»ç»\n\nTCC äºå¡æºå¶ç¸å¯¹äºä¼ ç»äºå¡æºå¶ï¼X/Open XAï¼ï¼TCC äºå¡æºå¶ç¸æ¯äºä¸é¢ä»ç»ç XA äºå¡æºå¶ï¼æä»¥ä¸ä¼ç¹:\n\n * æ§è½æå - å·ä½ä¸å¡æ¥å®ç°æ§å¶èµæºéçç²åº¦åå°ï¼ä¸ä¼éå®æ´ä¸ªèµæºã\n * æ°æ®æç»ä¸è´æ§ - åºäº Confirm å Cancel çå¹ç­æ§ï¼ä¿è¯äºå¡æç»å®æç¡®è®¤æèåæ¶ï¼ä¿è¯æ°æ®çä¸è´æ§ã\n * å¯é æ§ - è§£å³äº XA åè®®çåè°èåç¹æéé®é¢ï¼ç±ä¸»ä¸å¡æ¹åèµ·å¹¶æ§å¶æ´ä¸ªä¸å¡æ´»å¨ï¼ä¸å¡æ´»å¨ç®¡çå¨ä¹åæå¤ç¹ï¼å¼å¥éç¾¤ã\n\nç¼ºç¹ï¼ TCC ç TryãConfirm å Cancel æä½åè½è¦æå·ä½ä¸å¡æ¥å®ç°ï¼ä¸å¡è¦ååº¦è¾é«ï¼æé«äºå¼åææ¬ã\n\n\n# 5. æ¬å°æ¶æ¯è¡¨\n\n\n# 5.1. æ¹æ¡ç®ä»\n\næ¬å°æ¶æ¯è¡¨çæ¹æ¡æåæ¯ç± ebay æåºï¼æ ¸å¿æè·¯æ¯å°åå¸å¼äºå¡æåææ¬å°äºå¡è¿è¡å¤çã\n\næ¹æ¡éè¿å¨äºå¡ä¸»å¨åèµ·æ¹é¢å¤æ°å»ºäºå¡æ¶æ¯è¡¨ï¼äºå¡åèµ·æ¹å¤çä¸å¡åè®°å½äºå¡æ¶æ¯å¨æ¬å°äºå¡ä¸­å®æï¼è½®è¯¢äºå¡æ¶æ¯è¡¨çæ°æ®åéäºå¡æ¶æ¯ï¼äºå¡è¢«å¨æ¹åºäºæ¶æ¯ä¸­é´ä»¶æ¶è´¹äºå¡æ¶æ¯è¡¨ä¸­çäºå¡ã\n\nè¿æ ·è®¾è®¡å¯ä»¥é¿åâä¸å¡å¤çæå + äºå¡æ¶æ¯åéå¤±è´¥"ï¼æ"ä¸å¡å¤çå¤±è´¥ + äºå¡æ¶æ¯åéæå"çæ£ææåµåºç°ï¼ä¿è¯ 2 ä¸ªç³»ç»äºå¡çæ°æ®ä¸è´æ§ã\n\n\n# 5.2. å¤çæµç¨\n\nä¸é¢æåå¸å¼äºå¡æåå¼å§å¤ççäºå¡æ¹æä¸ºäºå¡ä¸»å¨æ¹ï¼å¨äºå¡ä¸»å¨æ¹ä¹åå¤ççä¸å¡åçå¶ä»äºå¡æä¸ºäºå¡è¢«å¨æ¹ã\n\nä¸ºäºæ¹ä¾¿çè§£ï¼ä¸é¢ç»§ç»­ä»¥çµåä¸åä¸ºä¾è¿è¡æ¹æ¡è§£æï¼è¿éææ´ä¸ªè¿ç¨ç®ååä¸ºæ£ååºå­ï¼è®¢ååå»º 2 ä¸ªæ­¥éª¤ï¼åºå­æå¡åè®¢åæå¡åå«å¨ä¸åçæå¡å¨èç¹ä¸ï¼å¶ä¸­åºå­æå¡æ¯äºå¡ä¸»å¨æ¹ï¼è®¢åæå¡æ¯äºå¡è¢«å¨æ¹ã\n\näºå¡çä¸»å¨æ¹éè¦é¢å¤æ°å»ºäºå¡æ¶æ¯è¡¨ï¼ç¨äºè®°å½åå¸å¼äºå¡çæ¶æ¯çåçãå¤çç¶æã\n\næ´ä¸ªä¸å¡å¤çæµç¨å¦ä¸ï¼\n\n\n\n>  1. æ­¥éª¤ 1 äºå¡ä¸»å¨æ¹å¤çæ¬å°äºå¡ã äºå¡ä¸»å¨åå¨æ¬å°äºå¡ä¸­å¤çä¸å¡æ´æ°æä½ååæ¶æ¯è¡¨æä½ã ä¸é¢ä¾å­ä¸­åºå­æå¡é¶æ®µåæ¬å°äºå¡ä¸­å®ææ£ååºå­ååæ¶æ¯è¡¨(å¾ä¸­ 1ã2)ã\n>  2. æ­¥éª¤ 2 äºå¡ä¸»å¨æ¹éè¿ MQ éç¥äºå¡è¢«å¨æ¹å¤çäºå¡ã æ¶æ¯ä¸­é´ä»¶å¯ä»¥åºäº KafkaãRocketMQ æ¶æ¯éåï¼äºå¡ä¸»å¨æ¹æ³ä¸»å¨åæ¶æ¯å°æ¶æ¯éåï¼äºå¡æ¶è´¹æ¹æ¶è´¹å¹¶å¤çæ¶æ¯éåä¸­çæ¶æ¯ã ä¸é¢ä¾å­ä¸­ï¼åºå­æå¡æäºå¡å¾å¤çæ¶æ¯åå°æ¶æ¯ä¸­é´ä»¶ï¼è®¢åæå¡æ¶è´¹æ¶æ¯ä¸­é´ä»¶çæ¶æ¯ï¼å®ææ°å¢è®¢åï¼å¾ä¸­ 3 - 5ï¼ã\n>  3. æ­¥éª¤ 3 äºå¡è¢«å¨æ¹éè¿ MQ åä¼å¤çç»æã ä¸é¢ä¾å­ä¸­ï¼è®¢åæå¡æäºå¡å·²å¤çæ¶æ¯åå°æ¶æ¯ä¸­é´ä»¶ï¼åºå­æå¡æ¶è´¹ä¸­é´ä»¶çæ¶æ¯ï¼å¹¶å°äºå¡æ¶æ¯çç¶ææ´æ°ä¸ºå·²å®æ(å¾ä¸­ 6 - 8)\n\nä¸ºäºæ°æ®çä¸è´æ§ï¼å½å¤çéè¯¯éè¦éè¯ï¼äºå¡åéæ¹åäºå¡æ¥æ¶æ¹ç¸å³ä¸å¡å¤çéè¦æ¯æå¹ç­ãå·ä½ä¿å­ä¸è´æ§çå®¹éå¤çå¦ä¸ï¼\n\n>  * å½æ­¥éª¤ 1 å¤çåºéï¼äºå¡åæ»ï¼ç¸å½äºä»ä¹é½æ²¡åçã\n>  * å½æ­¥éª¤ 2ãæ­¥éª¤ 3 å¤çåºéï¼ç±äºæªå¤ççäºå¡æ¶æ¯è¿æ¯ä¿å­å¨äºå¡åéæ¹ï¼äºå¡åéæ¹å¯ä»¥å®æ¶è½®è¯¢ä¸ºè¶æ¶æ¶æ¯æ°æ®ï¼åæ¬¡åéçæ¶æ¯ä¸­é´ä»¶è¿è¡å¤çãäºå¡è¢«å¨æ¹æ¶è´¹äºå¡æ¶æ¯éè¯å¤çã\n>  * å¦ææ¯ä¸å¡ä¸çå¤±è´¥ï¼äºå¡è¢«å¨æ¹å¯ä»¥åæ¶æ¯ç»äºå¡ä¸»å¨æ¹è¿è¡åæ»ã\n>  * å¦æå¤ä¸ªäºå¡è¢«å¨æ¹å·²ç»æ¶è´¹æ¶æ¯ï¼äºå¡ä¸»å¨æ¹éè¦åæ»äºå¡æ¶éè¦éç¥äºå¡è¢«å¨æ¹åæ»ã\n\n\n# 5.3. æ¹æ¡æ»ç»\n\næ¹æ¡çä¼ç¹å¦ä¸ï¼\n\n * ä»åºç¨è®¾è®¡å¼åçè§åº¦å®ç°äºæ¶æ¯æ°æ®çå¯é æ§ï¼æ¶æ¯æ°æ®çå¯é æ§ä¸ä¾èµäºæ¶æ¯ä¸­é´ä»¶ï¼å¼±åäºå¯¹ MQ ä¸­é´ä»¶ç¹æ§çä¾èµã\n * æ¹æ¡è½»éï¼å®¹æå®ç°ã\n\nç¼ºç¹å¦ä¸ï¼\n\n * ä¸å·ä½çä¸å¡åºæ¯ç»å®ï¼è¦åæ§å¼ºï¼ä¸å¯å¤ç¨ã\n * æ¶æ¯æ°æ®ä¸ä¸å¡æ°æ®ååºï¼å ç¨ä¸å¡ç³»ç»èµæºã\n * ä¸å¡ç³»ç»å¨ä½¿ç¨å³ç³»åæ°æ®åºçæåµä¸ï¼æ¶æ¯æå¡æ§è½ä¼åå°å³ç³»åæ°æ®åºå¹¶åæ§è½çå±éã\n\n\n# 6. MQ äºå¡\n\n\n# 6.1. æ¹æ¡ç®ä»\n\nåºäº MQ çåå¸å¼äºå¡æ¹æ¡å¶å®æ¯å¯¹æ¬å°æ¶æ¯è¡¨çå°è£ï¼å°æ¬å°æ¶æ¯è¡¨åºäº MQ åé¨ï¼å¶ä»æ¹é¢çåè®®åºæ¬ä¸æ¬å°æ¶æ¯è¡¨ä¸è´ã\n\n\n# 6.2. å¤çæµç¨\n\nä¸é¢ä¸»è¦åºäº RocketMQ4.3 ä¹åççæ¬ä»ç» MQ çåå¸å¼äºå¡æ¹æ¡ã\n\nå¨æ¬å°æ¶æ¯è¡¨æ¹æ¡ä¸­ï¼ä¿è¯äºå¡ä¸»å¨æ¹ååä¸å¡è¡¨æ°æ®ååæ¶æ¯è¡¨æ°æ®çä¸è´æ§æ¯åºäºæ°æ®åºäºå¡ï¼RocketMQ çäºå¡æ¶æ¯ç¸å¯¹äºæ®é MQï¼ç¸å¯¹äºæä¾äº 2PC çæäº¤æ¥å£ï¼æ¹æ¡å¦ä¸ï¼\n\næ­£å¸¸æåµââäºå¡ä¸»å¨æ¹åæ¶æ¯ è¿ç§æåµä¸ï¼äºå¡ä¸»å¨æ¹æå¡æ­£å¸¸ï¼æ²¡æåçæéï¼åæ¶æ¯æµç¨å¦ä¸ï¼\n\n\n\n>  1. åéæ¹å MQ æå¡ç«¯(MQ Server)åé half æ¶æ¯ã\n>  2. MQ Server å°æ¶æ¯æä¹åæåä¹åï¼ååéæ¹ ACK ç¡®è®¤æ¶æ¯å·²ç»åéæåã\n>  3. åéæ¹å¼å§æ§è¡æ¬å°äºå¡é»è¾ã\n>  4. åéæ¹æ ¹æ®æ¬å°äºå¡æ§è¡ç»æå MQ Server æäº¤äºæ¬¡ç¡®è®¤ï¼commit ææ¯ rollbackï¼ã\n>  5. MQ Server æ¶å° commit ç¶æåå°åæ¶æ¯æ è®°ä¸ºå¯æéï¼è®¢éæ¹æç»å°æ¶å°è¯¥æ¶æ¯ï¼MQ Server æ¶å° rollback ç¶æåå é¤åæ¶æ¯ï¼è®¢éæ¹å°ä¸ä¼æ¥åè¯¥æ¶æ¯ã\n\nå¼å¸¸æåµââäºå¡ä¸»å¨æ¹æ¶æ¯æ¢å¤ å¨æ­ç½æèåºç¨éå¯ç­å¼å¸¸æåµä¸ï¼å¾ä¸­ 4 æäº¤çäºæ¬¡ç¡®è®¤è¶æ¶æªå°è¾¾ MQ Serverï¼æ­¤æ¶å¤çé»è¾å¦ä¸ï¼\n\n\n\n>  5. MQ Server å¯¹è¯¥æ¶æ¯åèµ·æ¶æ¯åæ¥ã\n>  6. åéæ¹æ¶å°æ¶æ¯åæ¥åï¼éè¦æ£æ¥å¯¹åºæ¶æ¯çæ¬å°äºå¡æ§è¡çæç»ç»æã\n>  7. åéæ¹æ ¹æ®æ£æ¥å¾å°çæ¬å°äºå¡çæç»ç¶æåæ¬¡æäº¤äºæ¬¡ç¡®è®¤\n>  8. MQ Server åºäº commit / rollback å¯¹æ¶æ¯è¿è¡æéæèå é¤\n\n\n# 6.3. æ¹æ¡æ»ç»\n\nç¸æ¯æ¬å°æ¶æ¯è¡¨æ¹æ¡ï¼MQ äºå¡æ¹æ¡ä¼ç¹æ¯ï¼\n\n * æ¶æ¯æ°æ®ç¬ç«å­å¨ ï¼éä½ä¸å¡ç³»ç»ä¸æ¶æ¯ç³»ç»ä¹é´çè¦åã\n * ååéä¼äºä½¿ç¨æ¬å°æ¶æ¯è¡¨æ¹æ¡ã\n\nç¼ºç¹æ¯ï¼\n\n * ä¸æ¬¡æ¶æ¯åééè¦ä¸¤æ¬¡ç½ç»è¯·æ±(half æ¶æ¯ + commit/rollback æ¶æ¯)\n * ä¸å¡å¤çæå¡éè¦å®ç°æ¶æ¯ç¶æåæ¥æ¥å£\n\n\n# 7. SAGA\n\n\n# 7.1. æ¹æ¡ç®ä»\n\nSaga äºå¡æºäº 1987 å¹´æ®ææ¯é¡¿å¤§å­¦ç Hecto å Kenneth åè¡¨çå¦ä½å¤ç long lived transactionï¼é¿æ´»äºå¡ï¼è®ºæï¼Saga äºå¡æ ¸å¿ææ³æ¯å°é¿äºå¡æåä¸ºå¤ä¸ªæ¬å°ç­äºå¡ï¼ç± Saga äºå¡åè°å¨åè°ï¼å¦ææ­£å¸¸ç»æé£å°±æ­£å¸¸å®æï¼å¦ææä¸ªæ­¥éª¤å¤±è´¥ï¼åæ ¹æ®ç¸åé¡ºåºä¸æ¬¡è°ç¨è¡¥å¿æä½ã\n\n\n# 7.2. å¤çæµç¨\n\nSaga äºå¡åºæ¬åè®®å¦ä¸ï¼\n\n * æ¯ä¸ª Saga äºå¡ç±ä¸ç³»åå¹ç­çæåºå­äºå¡(sub-transaction) Ti ç»æã\n * æ¯ä¸ª Ti é½æå¯¹åºçå¹ç­è¡¥å¿å¨ä½ Ciï¼è¡¥å¿å¨ä½ç¨äºæ¤é Ti é æçç»æã\n\nå¯ä»¥çå°ï¼å TCC ç¸æ¯ï¼Saga æ²¡æâé¢çâå¨ä½ï¼å®ç Ti å°±æ¯ç´æ¥æäº¤å°åºã\n\nä¸é¢ä»¥ä¸åæµç¨ä¸ºä¾ï¼æ´ä¸ªæä½åæ¬ï¼åå»ºè®¢åãæ£ååºå­ãæ¯ä»ãå¢å ç§¯å Saga çæ§è¡é¡ºåºæä¸¤ç§ï¼\n\n\n\n * äºå¡æ­£å¸¸æ§è¡å®æ T1, T2, T3, ..., Tnï¼ä¾å¦ï¼æ£ååºå­(T1)ï¼åå»ºè®¢å(T2)ï¼æ¯ä»(T3)ï¼ä¾æ¬¡æåºå®ææ´ä¸ªäºå¡ã\n * äºå¡åæ» T1, T2, ..., Tj, Cj,..., C2, C1ï¼å¶ä¸­ 0 < j < nï¼ä¾å¦ï¼æ£ååºå­(T1)ï¼åå»ºè®¢å(T2)ï¼æ¯ä»(T3ï¼æ¯ä»å¤±è´¥)ï¼æ¯ä»åæ»(C3)ï¼è®¢ååæ»(C2)ï¼æ¢å¤åºå­(C1)ã\n\n# 7.2.1. æ¢å¤ç­ç¥\n\nSaga å®ä¹äºä¸¤ç§æ¢å¤ç­ç¥ï¼\n\n * ååæ¢å¤(forward recovery)\n\n\n\nå¯¹åºäºä¸é¢ç¬¬ä¸ç§æ§è¡é¡ºåºï¼éç¨äºå¿é¡»è¦æåçåºæ¯ï¼åçå¤±è´¥è¿è¡éè¯ï¼æ§è¡é¡ºåºæ¯ç±»ä¼¼äºè¿æ ·çï¼T1, T2, ..., Tj(å¤±è´¥), Tj(éè¯),..., Tnï¼å¶ä¸­ j æ¯åçéè¯¯çå­äºå¡(sub-transaction)ãè¯¥æåµä¸ä¸éè¦ Ciã\n\n * ååæ¢å¤(backward recovery)\n\n\n\nå¯¹åºäºä¸é¢æå°çç¬¬äºç§æ§è¡é¡ºåºï¼å¶ä¸­ j æ¯åçéè¯¯çå­äºå¡(sub-transaction)ï¼è¿ç§åæ³çæææ¯æ¤éæä¹åæææåçå­äºå¡ï¼ä½¿å¾æ´ä¸ª Saga çæ§è¡ç»ææ¤éã\n\nSaga äºå¡å¸¸è§çæä¸¤ç§ä¸åçå®ç°æ¹å¼ï¼å½ä»¤åè°åäºä»¶ç¼æã\n\n# 7.2.2. å½ä»¤åè°\n\n * å½ä»¤åè°(Order Orchestrator)ï¼ä¸­å¤®åè°å¨è´è´£éä¸­å¤çäºä»¶çå³ç­åä¸å¡é»è¾æåºã\n\nä¸­å¤®åè°å¨ï¼Orchestratorï¼ç®ç§° OSOï¼ä»¥å½ä»¤/åå¤çæ¹å¼ä¸æ¯é¡¹æå¡è¿è¡éä¿¡ï¼å¨æè´è´£åè¯æ¯ä¸ªåä¸èè¯¥åä»ä¹ä»¥åä»ä¹æ¶åè¯¥åä»ä¹ã\n\n\n\nä»¥çµåè®¢åçä¾å­ä¸ºä¾ï¼\n\n>  1. äºå¡åèµ·æ¹çä¸»ä¸å¡é»è¾è¯·æ± OSO æå¡å¼å¯è®¢åäºå¡ã\n>  2. OSO ååºå­æå¡è¯·æ±æ£ååºå­ï¼åºå­æå¡åå¤å¤çç»æã\n>  3. OSO åè®¢åæå¡è¯·æ±åå»ºè®¢åï¼è®¢åæå¡åå¤åå»ºç»æã\n>  4. OSO åæ¯ä»æå¡è¯·æ±æ¯ä»ï¼æ¯ä»æå¡åå¤å¤çç»æã\n>  5. ä¸»ä¸å¡é»è¾æ¥æ¶å¹¶å¤ç OSO äºå¡å¤çç»æåå¤ã\n\nä¸­å¤®åè°å¨å¿é¡»äºåç¥éæ§è¡æ´ä¸ªè®¢åäºå¡æéçæµç¨(ä¾å¦éè¿è¯»åéç½®)ãå¦ææä»»ä½å¤±è´¥ï¼å®è¿è´è´£éè¿åæ¯ä¸ªåä¸èåéå½ä»¤æ¥æ¤éä¹åçæä½æ¥åè°åå¸å¼çåæ»ãåºäºä¸­å¤®åè°å¨åè°ä¸åæ¶ï¼åæ»è¦å®¹æå¾å¤ï¼å ä¸ºåè°å¨é»è®¤æ¯æ§è¡æ­£åæµç¨ï¼åæ»æ¶åªè¦æ§è¡ååæµç¨å³å¯ã\n\n# 7.2.3. äºä»¶ç¼æ\n\n * äºä»¶ç¼æ (Event Choreography0ï¼æ²¡æä¸­å¤®åè°å¨ï¼æ²¡æåç¹é£é©ï¼æ¶ï¼æ¯ä¸ªæå¡äº§çå¹¶è§å¯å¶ä»æå¡çäºä»¶ï¼å¹¶å³å®æ¯å¦åºéåè¡å¨ã\n\nå¨äºä»¶ç¼ææ¹æ³ä¸­ï¼ç¬¬ä¸ä¸ªæå¡æ§è¡ä¸ä¸ªäºå¡ï¼ç¶ååå¸ä¸ä¸ªäºä»¶ãè¯¥äºä»¶è¢«ä¸ä¸ªæå¤ä¸ªæå¡è¿è¡çå¬ï¼è¿äºæå¡åæ§è¡æ¬å°äºå¡å¹¶åå¸ï¼æä¸åå¸ï¼æ°çäºä»¶ã\n\nå½æåä¸ä¸ªæå¡æ§è¡æ¬å°äºå¡å¹¶ä¸ä¸åå¸ä»»ä½äºä»¶æ¶ï¼æå³çåå¸å¼äºå¡ç»æï¼æèå®åå¸çäºä»¶æ²¡æè¢«ä»»ä½ Saga åä¸èå¬å°é½æå³çäºå¡ç»æã\n\nä»¥çµåè®¢åçä¾å­ä¸ºä¾ï¼\n\n\n\n>  1. äºå¡åèµ·æ¹çä¸»ä¸å¡é»è¾åå¸å¼å§è®¢åäºä»¶\n>  2. åºå­æå¡çå¬å¼å§è®¢åäºä»¶ï¼æ£ååºå­ï¼å¹¶åå¸åºå­å·²æ£åäºä»¶\n>  3. è®¢åæå¡çå¬åºå­å·²æ£åäºä»¶ï¼åå»ºè®¢åï¼å¹¶åå¸è®¢åå·²åå»ºäºä»¶\n>  4. æ¯ä»æå¡çå¬è®¢åå·²åå»ºäºä»¶ï¼è¿è¡æ¯ä»ï¼å¹¶åå¸è®¢åå·²æ¯ä»äºä»¶\n>  5. ä¸»ä¸å¡é»è¾çå¬è®¢åå·²æ¯ä»äºä»¶å¹¶å¤çã\n\näºä»¶/ç¼ææ¯å®ç° Saga æ¨¡å¼çèªç¶æ¹å¼ï¼å®å¾ç®åï¼å®¹æçè§£ï¼ä¸éè¦å¤ªå¤çä»£ç æ¥æå»ºãå¦æäºå¡æ¶å 2 è³ 4 ä¸ªæ­¥éª¤ï¼åå¯è½æ¯éå¸¸åéçã\n\n\n# 7.3. æ¹æ¡æ»ç»\n\nå½ä»¤åè°è®¾è®¡çä¼ç¹åç¼ºç¹ï¼\n\nä¼ç¹å¦ä¸ï¼\n\n * æå¡ä¹é´å³ç³»ç®åï¼é¿åæå¡ä¹é´çå¾ªç¯ä¾èµå³ç³»ï¼å ä¸º Saga åè°å¨ä¼è°ç¨ Saga åä¸èï¼ä½åä¸èä¸ä¼è°ç¨åè°å¨\n * ç¨åºå¼åç®åï¼åªéè¦æ§è¡å½ä»¤/åå¤(å¶å®åå¤æ¶æ¯ä¹æ¯ä¸ç§äºä»¶æ¶æ¯)ï¼éä½åä¸èçå¤ææ§ã\n * æç»´æ¤æ©å±ï¼å¨æ·»å æ°æ­¥éª¤æ¶ï¼äºå¡å¤ææ§ä¿æçº¿æ§ï¼åæ»æ´å®¹æç®¡çï¼æ´å®¹æå®æ½åæµè¯\n\nç¼ºç¹å¦ä¸ï¼\n\n * ä¸­å¤®åè°å¨å®¹æå¤çé»è¾å®¹æè¿äºå¤æï¼å¯¼è´é¾ä»¥ç»´æ¤ã\n * å­å¨åè°å¨åç¹æéé£é©ã\n\näºä»¶/ç¼æè®¾è®¡çä¼ç¹åç¼ºç¹\n\nä¼ç¹å¦ä¸ï¼\n\n * é¿åä¸­å¤®åè°å¨åç¹æéé£é©ã\n * å½æ¶åçæ­¥éª¤è¾å°æå¡å¼åç®åï¼å®¹æå®ç°ã\n\nç¼ºç¹å¦ä¸ï¼\n\n * æå¡ä¹é´å­å¨å¾ªç¯ä¾èµçé£é©ã\n * å½æ¶åçæ­¥éª¤è¾å¤ï¼æå¡é´å³ç³»æ··ä¹±ï¼é¾ä»¥è¿½è¸ªè°æµã\n\nå¼å¾è¡¥åçæ¯ï¼ç±äº Saga æ¨¡åä¸­æ²¡æ Prepare é¶æ®µï¼å æ­¤äºå¡é´ä¸è½ä¿è¯éç¦»æ§ï¼å½å¤ä¸ª Saga äºå¡æä½åä¸èµæºæ¶ï¼å°±ä¼äº§çæ´æ°ä¸¢å¤±ãèæ°æ®è¯»åç­é®é¢ï¼è¿æ¶éè¦å¨ä¸å¡å±æ§å¶å¹¶åï¼ä¾å¦ï¼å¨åºç¨å±é¢å éï¼æèåºç¨å±é¢é¢åå»ç»èµæºã\n\n\n# 8. æ»ç»\n\n\n# 8.1. åæ¹æ¡ä½¿ç¨åºæ¯\n\nä»ç»å®åå¸å¼äºå¡ç¸å³çè®ºåå¸¸è§è§£å³æ¹æ¡åï¼æç»çç®çå¨å®éé¡¹ç®ä¸­è¿ç¨ï¼å æ­¤ï¼æ»ç»ä¸ä¸åä¸ªæ¹æ¡çå¸¸è§çä½¿ç¨åºæ¯ã\n\n\n\n * 2PC/3PC ä¾èµäºæ°æ®åºï¼è½å¤å¾å¥½çæä¾å¼ºä¸è´æ§åå¼ºäºå¡æ§ï¼ä½ç¸å¯¹æ¥è¯´å»¶è¿æ¯è¾é«ï¼æ¯è¾éåä¼ ç»çåä½åºç¨ï¼å¨åä¸ä¸ªæ¹æ³ä¸­å­å¨è·¨åºæä½çæåµï¼ä¸éåé«å¹¶ååé«æ§è½è¦æ±çåºæ¯ã\n * TCC éç¨äºæ§è¡æ¶é´ç¡®å®ä¸è¾ç­ï¼å®æ¶æ§è¦æ±é«ï¼å¯¹æ°æ®ä¸è´æ§è¦æ±é«ï¼æ¯å¦äºèç½éèä¼ä¸ææ ¸å¿çä¸ä¸ªæå¡ï¼äº¤æãæ¯ä»ãè´¦å¡ã\n * æ¬å°æ¶æ¯è¡¨/MQ äºå¡ é½éç¨äºäºå¡ä¸­åä¸æ¹æ¯ææä½å¹ç­ï¼å¯¹ä¸è´æ§è¦æ±ä¸é«ï¼ä¸å¡ä¸è½å®¹å¿æ°æ®ä¸ä¸è´å°ä¸ä¸ªäººå·¥æ£æ¥å¨æï¼äºå¡æ¶åçåä¸æ¹ãåä¸ç¯èè¾å°ï¼ä¸å¡ä¸æå¯¹è´¦/æ ¡éªç³»ç»ååºã\n * Saga äºå¡ ç±äº Saga äºå¡ä¸è½ä¿è¯éç¦»æ§ï¼éè¦å¨ä¸å¡å±æ§å¶å¹¶åï¼éåäºä¸å¡åºæ¯äºå¡å¹¶åæä½åä¸èµæºè¾å°çæåµã Saga ç¸æ¯ç¼ºå°é¢æäº¤å¨ä½ï¼å¯¼è´è¡¥å¿å¨ä½çå®ç°æ¯è¾éº»ç¦ï¼ä¾å¦ä¸å¡æ¯åéç­ä¿¡ï¼è¡¥å¿å¨ä½åå¾ååéä¸æ¬¡ç­ä¿¡è¯´ææ¤éï¼ç¨æ·ä½éªæ¯è¾å·®ãSaga äºå¡è¾éç¨äºè¡¥å¿å¨ä½å®¹æå¤ççåºæ¯ã\n\n\n# 8.2. åå¸å¼äºå¡æ¹æ¡è®¾è®¡\n\næ¬æä»ç»çååäºåçï¼ä¸çå·²ç»æä¸å°å¼æºçæèæ¶è´¹çè§£å³æ¹æ¡ï¼ç¯å¹æéï¼å°±ä¸åå±å¼ä»ç»ã\n\nå®éè¿ç¨çè®ºæ¶è¿è¡æ¶æè®¾è®¡æ¶ï¼è®¸å¤äººå®¹æç¯âæéæäºé¤å­ï¼çä»ä¹é½è§å¾åéå­âçéè¯¯ï¼è®¾è®¡æ¹æ¡æ¶èèçé®é¢åºæ¯è¿å¤ï¼åç§éè¯ï¼åç§è¡¥å¿æºå¶å¼å¥ç³»ç»ï¼å¯¼è´è®¾è®¡åºæ¥çç³»ç»è¿äºå¤æï¼è½å°é¥é¥æ æã\n\n> ä¸çä¸è§£å³ä¸ä¸ªè®¡ç®æºé®é¢æç®åçæ¹æ³ï¼âæ°å¥½âä¸éè¦è§£å³å®ï¼ââ é¿éä¸­é´ä»¶ææ¯ä¸å®¶æ²è¯¢\n\næäºé®é¢ï¼çèµ·æ¥å¾éè¦ï¼ä½å®éä¸æä»¬å¯ä»¥éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ãè®¾è®¡åå¸å¼äºå¡ç³»ç»ä¹ä¸æ¯éè¦èèææå¼å¸¸æåµï¼ä¸å¿è¿åº¦è®¾è®¡åç§åæ»ï¼è¡¥å¿æºå¶ãå¦æç¡¬è¦ææ¶é´è±å¨è§£å³é®é¢æ¬èº«ï¼å®éä¸ä¸ä»æçä½ä¸ï¼èä¸ä¹æ¯ä¸ç§æµªè´¹ã\n\nå¦æç³»ç»è¦å®ç°åæ»æµç¨çè¯ï¼æå¯è½ç³»ç»å¤æåº¦å°å¤§å¤§æåï¼ä¸å¾å®¹æåºç° Bugï¼ä¼°è®¡åºç° Bug çæ¦çä¼æ¯éè¦äºå¡åæ»çæ¦çå¤§å¾å¤ãå¨è®¾è®¡ç³»ç»æ¶ï¼æä»¬éè¦è¡¡éæ¯å¦å¼å¾è±è¿ä¹å¤§çä»£ä»·æ¥è§£å³è¿æ ·ä¸ä¸ªåºç°æ¦çéå¸¸å°çé®é¢ï¼å¯ä»¥èèå½åºç°è¿ä¸ªæ¦çå¾å°çé®é¢ï¼è½å¦éç¨äººå·¥è§£å³çæ¹å¼ï¼è¿ä¹æ¯å¤§å®¶å¨è§£å³çé¾é®é¢æ¶éè¦å¤å¤æèçå°æ¹ã\n\n\n# 9. åèèµæ\n\n * èèåå¸å¼äºå¡ï¼åè¯´è¯´è§£å³æ¹æ¡\n * çè§£åå¸å¼äºå¡',normalizedContent:'# åå¸å¼äºå¡åºæ¬åç\n\n> åå¸å¼äºå¡æçæ¯äºå¡æä½è·¨è¶å¤ä¸ªèç¹ï¼å¹¶ä¸è¦æ±æ»¡è¶³äºå¡ç acid ç¹æ§ã\n\n\n# 1. åå¸å¼äºå¡ç®ä»\n\n\n# 1.1. æ¬å°äºå¡\n\nå­¦ä¹ åå¸å¼ä¹åï¼åäºè§£ä¸ä¸æ¬å°äºå¡çæ¦å¿µã\n\näºå¡ç®åæ¥è¯´ï¼ä¸ä¸ªä¼è¯ä¸­æè¿è¡ææçæä½ï¼è¦ä¹åæ¶æåï¼è¦ä¹åæ¶å¤±è´¥ã\n\n\n\nå·ä½æ¥è¯´ï¼äºå¡æçæ¯æ»¡è¶³ acid ç¹æ§çä¸ç»æä½ï¼å¯ä»¥éè¿ commit æäº¤ä¸ä¸ªäºå¡ï¼ä¹å¯ä»¥ä½¿ç¨ rollback è¿è¡åæ»ã\n\n * åå­æ§ï¼atomicityï¼\n * ä¸è´æ§ï¼consistencyï¼\n * éç¦»æ§ï¼isolationï¼\n * æä¹æ§ï¼durabilityï¼\n\n> ð¡ æ´è¯¦ç»çåå®¹å¯ä»¥åèï¼äºå¡\n\n\n# 1.2. åå¸å¼äºå¡\n\nåå¸å¼äºå¡æçæ¯äºå¡æä½è·¨è¶å¤ä¸ªèç¹ï¼å¹¶ä¸è¦æ±æ»¡è¶³äºå¡ç acid ç¹æ§ã\n\néçäºèç½å¿«éåå±ï¼å¾®æå¡ï¼soa ç­æå¡æ¶ææ¨¡å¼æ­£å¨è¢«å¤§è§æ¨¡çä½¿ç¨ï¼ç°å¨åå¸å¼ç³»ç»ä¸è¬ç±å¤ä¸ªç¬ç«çå­ç³»ç»ç»æï¼å¤ä¸ªå­ç³»ç»éè¿ç½ç»éä¿¡äºç¸åä½éåå®æåä¸ªåè½ã\n\næå¾å¤ç¨ä¾ä¼è·¨å¤ä¸ªå­ç³»ç»æè½å®æï¼æ¯è¾å¸åçæ¯çµå­åå¡ç½ç«çä¸åæ¯ä»æµç¨ï¼è³å°ä¼æ¶åäº¤æç³»ç»åæ¯ä»ç³»ç»ï¼èä¸è¿ä¸ªè¿ç¨ä¸­ä¼æ¶åå°äºå¡çæ¦å¿µï¼å³ä¿è¯äº¤æç³»ç»åæ¯ä»ç³»ç»çæ°æ®ä¸è´æ§ï¼æ­¤å¤æä»¬ç§°è¿ç§è·¨ç³»ç»çäºå¡ä¸ºåå¸å¼äºå¡ï¼å·ä½ä¸ç¹èè¨ï¼åå¸å¼äºå¡æ¯æäºå¡çåä¸èãæ¯æäºå¡çæå¡å¨ãèµæºæå¡å¨ä»¥åäºå¡ç®¡çå¨åå«ä½äºä¸åçåå¸å¼ç³»ç»çä¸åèç¹ä¹ä¸ã\n\nä¸¾ä¸ªäºèç½å¸¸ç¨çäº¤æä¸å¡ä¸ºä¾ï¼\n\n\n\nä¸å¾ä¸­åå«äºåºå­åè®¢åä¸¤ä¸ªç¬ç«çå¾®æå¡ï¼æ¯ä¸ªå¾®æå¡ç»´æ¤äºèªå·±çæ°æ®åºãå¨äº¤æç³»ç»çä¸å¡é»è¾ä¸­ï¼ä¸ä¸ªååå¨ä¸åä¹åéè¦åè°ç¨åºå­æå¡ï¼è¿è¡æ£é¤åºå­ï¼åè°ç¨è®¢åæå¡ï¼åå»ºè®¢åè®°å½ã\n\n\n\nå¯ä»¥çå°ï¼å¦æå¤ä¸ªæ°æ®åºä¹é´çæ°æ®æ´æ°æ²¡æä¿è¯äºå¡ï¼å°ä¼å¯¼è´åºç°å­ç³»ç»æ°æ®ä¸ä¸è´ï¼ä¸å¡åºç°é®é¢ã\n\n\n# 1.3. åå¸å¼äºå¡çé¾ç¹\n\n * äºå¡çåå­æ§ äºå¡æä½è·¨ä¸åèç¹ï¼å½å¤ä¸ªèç¹æä¸èç¹æä½å¤±è´¥æ¶ï¼éè¦ä¿è¯å¤èç¹æä½ç**é½åæé½ä¸åï¼all or nothingï¼**çåå­æ§ã\n * äºå¡çä¸è´æ§ å½åçç½ç»ä¼ è¾æéæèèç¹æéï¼èç¹é´æ°æ®å¤å¶ééä¸­æ­ï¼å¨è¿è¡äºå¡æä½æ¶éè¦ä¿è¯æ°æ®ä¸è´æ§ï¼ä¿è¯äºå¡çä»»ä½æä½é½ä¸ä¼ä½¿å¾æ°æ®è¿åæ°æ®åºå®ä¹ççº¦æãè§¦åå¨ç­è§åã\n * äºå¡çéç¦»æ§ äºå¡éç¦»æ§çæ¬è´¨å°±æ¯å¦ä½æ­£ç¡®å¤ä¸ªå¹¶åäºå¡çå¤ççè¯»åå²çªåååå²çªï¼å ä¸ºå¨åå¸å¼äºå¡æ§å¶ä¸­ï¼å¯è½ä¼åºç°æäº¤ä¸åæ­¥çç°è±¡ï¼è¿ä¸ªæ¶åå°±æå¯è½åºç°âé¨åå·²ç»æäº¤âçäºå¡ãæ­¤æ¶å¹¶ååºç¨è®¿é®æ°æ®å¦ææ²¡æå ä»¥æ§å¶ï¼æå¯è½åºç°âèè¯»âé®é¢ã\n\n\n# 1.4. cap å base\n\ncap å®çåç§°ä¸º cap ååï¼æçæ¯ï¼å¨ä¸ä¸ªåå¸å¼ç³»ç»ä¸­ï¼ ä¸è´æ§ï¼cï¼consistencyï¼ãå¯ç¨æ§ï¼aï¼availabilityï¼ å ååºå®¹å¿æ§ï¼pï¼partition toleranceï¼ï¼æå¤åªè½åæ¶æ»¡è¶³å¶ä¸­ä¸¤é¡¹ã\n\nbase æ¯ åºæ¬å¯ç¨ï¼basically availableï¼ãè½¯ç¶æï¼soft stateï¼ å æç»ä¸è´æ§ï¼eventually consistentï¼ ä¸ä¸ªç­è¯­çç¼©åãbase çè®ºæ¯å¯¹ cap ä¸­ä¸è´æ§åå¯ç¨æ§æè¡¡çç»æï¼å®ççè®ºçæ ¸å¿ææ³æ¯ï¼å³ä½¿æ æ³åå°å¼ºä¸è´æ§ï¼ä½æ¯ä¸ªåºç¨é½å¯ä»¥æ ¹æ®èªèº«ä¸å¡ç¹ç¹ï¼éç¨éå½çæ¹å¼æ¥ä½¿ç³»ç»è¾¾å°æç»ä¸è´æ§ã\n\n> ð¡ æ´è¯¦ç»çåå®¹å¯ä»¥åèï¼åå¸å¼çè®º\n\n\n# 1.5. ææ§äºå¡\n\n# 1.5.1. ææ§äºå¡çæ¦å¿µ\n\nå¨çµåç­äºèç½åºæ¯ä¸ï¼ä¼ ç»çäºå¡å¨æ°æ®åºæ§è½åå¤çè½åä¸é½æ´é²åºäºç¶é¢ãå¨åå¸å¼é¢ååºäº cap çè®ºä»¥å base çè®ºï¼æäººå°±æåºäºææ§äºå¡çæ¦å¿µã\n\nåºäº base çè®ºçè®¾è®¡ææ³ï¼ææ§äºå¡ä¸ï¼å¨ä¸å½±åç³»ç»æ´ä½å¯ç¨æ§çæåµä¸(basically available åºæ¬å¯ç¨)ï¼åè®¸ç³»ç»å­å¨æ°æ®ä¸ä¸è´çä¸­é´ç¶æ(soft state è½¯ç¶æ)ï¼å¨ç»è¿æ°æ®åæ­¥çå»¶æ¶ä¹åï¼æç»æ°æ®è½å¤è¾¾å°ä¸è´ãå¹¶ä¸æ¯å®å¨æ¾å¼äº acidï¼èæ¯éè¿æ¾å®½ä¸è´æ§è¦æ±ï¼åå©æ¬å°äºå¡æ¥å®ç°æç»åå¸å¼äºå¡ä¸è´æ§çåæ¶ä¹ä¿è¯ç³»ç»çååã\n\n# 1.5.2. ææ§äºå¡çç¹æ§\n\nä¸é¢ä»ç»çæ¯å®ç°ææ§äºå¡çä¸äºå¸¸è§ç¹æ§ï¼è¿äºç¹æ§å¨å·ä½çæ¹æ¡ä¸­ä¸ä¸å®é½è¦æ»¡è¶³ï¼å ä¸ºä¸åçæ¹æ¡è¦æ±ä¸ä¸æ ·ã\n\nå¯è§æ§(å¯¹å¤å¯æ¥è¯¢) å¨åå¸å¼äºå¡æ§è¡è¿ç¨ä¸­ï¼å¦ææä¸ä¸ªæ­¥éª¤æ§è¡åºéï¼å°±éè¦æç¡®çç¥éå¶ä»å ä¸ªæä½çå¤çæåµï¼è¿å°±éè¦å¶ä»çæå¡é½è½å¤æä¾æ¥è¯¢æ¥å£ï¼ä¿è¯å¯ä»¥éè¿æ¥è¯¢æ¥å¤æ­æä½çå¤çæåµã\n\nä¸ºäºä¿è¯æä½çå¯æ¥è¯¢ï¼éè¦å¯¹äºæ¯ä¸ä¸ªæå¡çæ¯ä¸æ¬¡è°ç¨é½æä¸ä¸ªå¨å±å¯ä¸çæ è¯ï¼å¯ä»¥æ¯ä¸å¡åæ®å·ï¼å¦è®¢åå·ï¼ãä¹å¯ä»¥æ¯ç³»ç»åéçæä½æµæ°´å·ï¼å¦æ¯ä»è®°å½æµæ°´å·ï¼ãé¤æ­¤ä¹å¤ï¼æä½çæ¶é´ä¿¡æ¯ä¹è¦æå®æ´çè®°å½ã\n\næä½å¹ç­æ§ å¹ç­æ§ï¼å¶å®æ¯ä¸ä¸ªæ°å­¦æ¦å¿µãå¹ç­å½æ°ï¼æå¹ç­æ¹æ³ï¼æ¯æå¯ä»¥ä½¿ç¨ç¸ååæ°éå¤æ§è¡ï¼å¹¶è½è·å¾ç¸åç»æçå½æ°ãå¹ç­æä½çç¹ç¹æ¯å¶ä»»æå¤æ¬¡æ§è¡æäº§ççå½±ååä¸ä¸æ¬¡æ§è¡çå½±åç¸åãä¹å°±æ¯è¯´ï¼åä¸ä¸ªæ¹æ³ï¼ä½¿ç¨åæ ·çåæ°ï¼è°ç¨å¤æ¬¡äº§ççä¸å¡ç»æä¸è°ç¨ä¸æ¬¡äº§ççä¸å¡ç»æç¸åã\n\nä¹æä»¥éè¦æä½å¹ç­æ§ï¼æ¯å ä¸ºä¸ºäºä¿è¯æ°æ®çæç»ä¸è´æ§ï¼å¾å¤äºå¡åè®®é½ä¼æå¾å¤éè¯çæä½ï¼å¦æä¸ä¸ªæ¹æ³ä¸ä¿è¯å¹ç­ï¼é£ä¹å°æ æ³è¢«éè¯ãå¹ç­æä½çå®ç°æ¹å¼æå¤ç§ï¼å¦å¨ç³»ç»ä¸­ç¼å­ææçè¯·æ±ä¸å¤çç»æãæ£æµå°éå¤æä½åï¼ç´æ¥è¿åä¸ä¸æ¬¡çå¤çç»æç­ã\n\n\n# 2. ä¸¤é¶æ®µæäº¤ï¼2pcï¼\n\n\n# 2.1. æ¹æ¡ç®ä»\n\näºé¶æ®µæäº¤åè®®ï¼two-phase commitï¼å³ 2pcï¼æ¯å¸¸ç¨çåå¸å¼äºå¡è§£å³æ¹æ¡ï¼å³å°äºå¡çæäº¤è¿ç¨åä¸ºä¸¤ä¸ªé¶æ®µæ¥è¿è¡å¤çï¼åå¤é¶æ®µåæäº¤é¶æ®µãäºå¡çåèµ·èç§°åè°èï¼äºå¡çæ§è¡èç§°åä¸èã\n\nå¨åå¸å¼ç³»ç»éï¼æ¯ä¸ªèç¹é½å¯ä»¥ç¥æèªå·±æä½çæåæèå¤±è´¥ï¼å´æ æ³ç¥éå¶ä»èç¹æä½çæåæå¤±è´¥ãå½ä¸ä¸ªäºå¡è·¨å¤ä¸ªèç¹æ¶ï¼ä¸ºäºä¿æäºå¡çåå­æ§ä¸ä¸è´æ§ï¼èå¼å¥ä¸ä¸ªåè°èæ¥ç»ä¸ææ§ææåä¸èçæä½ç»æï¼å¹¶æç¤ºå®ä»¬æ¯å¦è¦ææä½ç»æè¿è¡çæ­£çæäº¤æèåæ»ï¼rollbackï¼ã\n\näºé¶æ®µæäº¤çæè·¯å¯ä»¥æ¦æ¬ä¸ºï¼åä¸èå°æä½æè´¥éç¥åè°èï¼åç±åè°èæ ¹æ®ææåä¸èçåé¦ææ¥å³å®ååä¸èæ¯å¦è¦æäº¤æä½è¿æ¯ä¸­æ­¢æä½ã\n\næ ¸å¿ææ³å°±æ¯å¯¹æ¯ä¸ä¸ªäºå¡é½éç¨åå°è¯åæäº¤çå¤çæ¹å¼ï¼å¤çåææçè¯»æä½é½è¦è½è·å¾ææ°çæ°æ®ï¼å æ­¤ä¹å¯ä»¥å°äºé¶æ®µæäº¤çä½æ¯ä¸ä¸ªå¼ºä¸è´æ§ç®æ³ã\n\n\n# 2.2. å¤çæµç¨\n\nç®åä¸ç¹çè§£ï¼å¯ä»¥æåè°èèç¹æ¯å»ä¸ºå¸¦å¤´å¤§å¥ï¼åä¸èçè§£æ¯å»ä¸ºè·ç­å°å¼ï¼å¸¦å¤´å¤§å¥ç»ä¸åè°è·ç­å°å¼çä»»å¡æ§è¡ã\n\n# 2.2.1. é¶æ®µ 1ï¼åå¤é¶æ®µ\n\n 1. åè°èåææåä¸èåéäºå¡åå®¹ï¼è¯¢é®æ¯å¦å¯ä»¥æäº¤äºå¡ï¼å¹¶ç­å¾ææåä¸èç­å¤ã\n 2. ååä¸èæ§è¡äºå¡æä½ï¼å° undo å redo ä¿¡æ¯è®°å¥äºå¡æ¥å¿ä¸­ï¼ä½ä¸æäº¤äºå¡ï¼ã\n 3. å¦åä¸èæ§è¡æåï¼ç»åè°èåé¦ yesï¼å³å¯ä»¥æäº¤ï¼å¦æ§è¡å¤±è´¥ï¼ç»åè°èåé¦ noï¼å³ä¸å¯æäº¤ã\n\n# 2.2.2. é¶æ®µ 2ï¼æäº¤é¶æ®µ\n\nå¦æåè°èæ¶å°äºåä¸èçå¤±è´¥æ¶æ¯æèè¶æ¶ï¼ç´æ¥ç»æ¯ä¸ªåä¸èåéåæ»(rollback)æ¶æ¯ï¼å¦åï¼åéæäº¤(commit)æ¶æ¯ï¼åä¸èæ ¹æ®åè°èçæä»¤æ§è¡æäº¤æèåæ»æä½ï¼éæ¾ææäºå¡å¤çè¿ç¨ä¸­ä½¿ç¨çéèµæºã(æ³¨æ:å¿é¡»å¨æåé¶æ®µéæ¾éèµæº) æ¥ä¸æ¥åä¸¤ç§æåµåå«è®¨è®ºæäº¤é¶æ®µçè¿ç¨ã\n\næåµ 1ï¼å½ææåä¸èååé¦ yesï¼æäº¤äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååºæ­£å¼æäº¤äºå¡çè¯·æ±ï¼å³ commit è¯·æ±ï¼ã\n>  2. åä¸èæ§è¡ commit è¯·æ±ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack(åºç­)å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡æäº¤ã\n\næåµ 2ï¼å½ä»»ä½é¶æ®µ 1 ä¸ä¸ªåä¸èåé¦ noï¼ä¸­æ­äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååºåæ»è¯·æ±ï¼å³ rollback è¯·æ±ï¼ã\n>  2. åä¸èä½¿ç¨é¶æ®µ 1 ä¸­ç undo ä¿¡æ¯æ§è¡åæ»æä½ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡ä¸­æ­ã\n\n\n# 2.3. æ¹æ¡æ»ç»\n\n2pc æ¹æ¡å®ç°èµ·æ¥ç®åï¼å®éé¡¹ç®ä¸­ä½¿ç¨æ¯è¾å°ï¼ä¸»è¦å ä¸ºä»¥ä¸é®é¢ï¼\n\n * æ§è½é®é¢ - ææåä¸èå¨äºå¡æäº¤é¶æ®µå¤äºåæ­¥é»å¡ç¶æï¼å ç¨ç³»ç»èµæºï¼å®¹æå¯¼è´æ§è½ç¶é¢ã\n * å¯é æ§é®é¢ - å¦æåè°èå­å¨åç¹æéé®é¢ï¼å¦æåè°èåºç°æéï¼åä¸èå°ä¸ç´å¤äºéå®ç¶æã\n * æ°æ®ä¸è´æ§é®é¢ - å¨é¶æ®µ 2 ä¸­ï¼å¦æåçå±é¨ç½ç»é®é¢ï¼ä¸é¨åäºå¡åä¸èæ¶å°äºæäº¤æ¶æ¯ï¼å¦ä¸é¨åäºå¡åä¸èæ²¡æ¶å°æäº¤æ¶æ¯ï¼é£ä¹å°±å¯¼è´äºèç¹ä¹é´æ°æ®çä¸ä¸è´ã\n\n\n# 3. ä¸é¶æ®µæäº¤ï¼3pcï¼\n\n\n# 3.1. æ¹æ¡ç®ä»\n\nä¸é¶æ®µæäº¤åè®®ï¼three-phase commitï¼3pcï¼ï¼æ¯äºé¶æ®µæäº¤åè®®çæ¹è¿çæ¬ï¼ä¸äºé¶æ®µæäº¤ä¸åçæ¯ï¼å¼å¥è¶æ¶æºå¶ãåæ¶å¨åè°èååä¸èä¸­é½å¼å¥è¶æ¶æºå¶ã\n\nä¸é¶æ®µæäº¤å°äºé¶æ®µçåå¤é¶æ®µæåä¸º 2 ä¸ªé¶æ®µï¼æå¥äºä¸ä¸ª precommit é¶æ®µï¼ä½¿å¾ååå¨äºé¶æ®µæäº¤ä¸­ï¼åä¸èå¨åå¤ä¹åï¼ç±äºåè°èåçå´©æºæéè¯¯ï¼èå¯¼è´åä¸èå¤äºæ æ³ç¥ææ¯å¦æäº¤æèä¸­æ­¢çâä¸ç¡®å®ç¶æâæäº§ççå¯è½ç¸å½é¿çå»¶æ¶çé®é¢å¾ä»¥è§£å³ã\n\n\n# 3.2. å¤çæµç¨\n\n# 3.2.1. é¶æ®µ 1ï¼cancommit\n\nåè°èååä¸èåé commit è¯·æ±ï¼åä¸èå¦æå¯ä»¥æäº¤å°±è¿å yes ååº(åä¸èä¸æ§è¡äºå¡æä½)ï¼å¦åè¿å no ååºï¼\n\n 1. åè°èåææåä¸èååºåå«äºå¡åå®¹ç cancommit è¯·æ±ï¼è¯¢é®æ¯å¦å¯ä»¥æäº¤äºå¡ï¼å¹¶ç­å¾ææåä¸èç­å¤ã\n 2. åä¸èæ¶å° cancommit è¯·æ±åï¼å¦æè®¤ä¸ºå¯ä»¥æ§è¡äºå¡æä½ï¼ååé¦ yes å¹¶è¿å¥é¢å¤ç¶æï¼å¦ååé¦ noã\n\n# 3.2.2. é¶æ®µ 2ï¼precommit\n\nåè°èæ ¹æ®é¶æ®µ 1 cancommit åä¸èçååºæåµæ¥å³å®æ¯å¦å¯ä»¥åºäºäºå¡ç precommit æä½ãæ ¹æ®ååºæåµï¼æä»¥ä¸ä¸¤ç§å¯è½ã\n\næåµ 1ï¼é¶æ®µ 1 ææåä¸èååé¦ yesï¼åä¸èé¢æ§è¡äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååº precommit è¯·æ±ï¼è¿å¥åå¤é¶æ®µã\n>  2. åä¸èæ¶å° precommit è¯·æ±åï¼æ§è¡äºå¡æä½ï¼å° undo å redo ä¿¡æ¯è®°å¥äºå¡æ¥å¿ä¸­ï¼ä½ä¸æäº¤äºå¡ï¼ã\n>  3. ååä¸èååè°èåé¦ ack ååºæ no ååºï¼å¹¶ç­å¾æç»æä»¤ã\n\næåµ 2ï¼é¶æ®µ 1 ä»»ä½ä¸ä¸ªåä¸èåé¦ noï¼æèç­å¾è¶æ¶ååè°èå°æ æ³æ¶å°ææåä¸èçåé¦ï¼å³ä¸­æ­äºå¡ã\n\n\n\n>  1. åè°èåææåä¸èååº abort è¯·æ±ã\n>  2. æ è®ºæ¶å°åè°èååºç abort è¯·æ±ï¼æèå¨ç­å¾åè°èè¯·æ±è¿ç¨ä¸­åºç°è¶æ¶ï¼åä¸èåä¼ä¸­æ­äºå¡ã\n\n# 3.2.3. é¶æ®µ 3ï¼docommit\n\nè¯¥é¶æ®µè¿è¡çæ­£çäºå¡æäº¤ï¼ä¹å¯ä»¥åä¸ºä»¥ä¸ä¸¤ç§æåµï¼\n\næåµ 1ï¼é¶æ®µ 2 ææåä¸èååé¦ ack ååºï¼æ§è¡çæ­£çäºå¡æäº¤ã\n\n\n\n>  1. å¦æåè°èå¤äºå·¥ä½ç¶æï¼ååææåä¸èååº do commit è¯·æ±ã\n>  2. åä¸èæ¶å° do commit è¯·æ±åï¼ä¼æ­£å¼æ§è¡äºå¡æäº¤ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡æäº¤ã\n\næåµ 2ï¼ä»»ä½ä¸ä¸ªåä¸èåé¦ noï¼æèç­å¾è¶æ¶ååè°èå°æ æ³æ¶å°ææåä¸èçåé¦ï¼å³ä¸­æ­äºå¡ã\n\n\n\n>  1. å¦æåè°èå¤äºå·¥ä½ç¶æï¼åææåä¸èååº abort è¯·æ±ã\n>  2. åä¸èä½¿ç¨é¶æ®µ 1 ä¸­ç undo ä¿¡æ¯æ§è¡åæ»æä½ï¼å¹¶éæ¾æ´ä¸ªäºå¡æé´å ç¨çèµæºã\n>  3. ååä¸èååè°èåé¦ ack å®æçæ¶æ¯ã\n>  4. åè°èæ¶å°ææåä¸èåé¦ç ack æ¶æ¯åï¼å³å®æäºå¡ä¸­æ­ã\n\næ³¨æï¼è¿å¥é¶æ®µ 3 åï¼æ è®ºåè°èåºç°é®é¢ï¼æèåè°èä¸åä¸èç½ç»åºç°é®é¢ï¼é½ä¼å¯¼è´åä¸èæ æ³æ¥æ¶å°åè°èååºç do commit è¯·æ±æ abort è¯·æ±ãæ­¤æ¶ï¼åä¸èé½ä¼å¨ç­å¾è¶æ¶ä¹åï¼ç»§ç»­æ§è¡äºå¡æäº¤ã\n\n\n# 3.3. æ¹æ¡æ»ç»\n\nä¼ç¹ï¼\n\n * ç¸æ¯äºé¶æ®µæäº¤ï¼ä¸é¶æ®µéä½äºé»å¡èå´ï¼å¨ç­å¾è¶æ¶ååè°èæåä¸èä¼ä¸­æ­äºå¡ãé¿åäºåè°èåç¹é®é¢ï¼é¶æ®µ 3 ä¸­åè°èåºç°é®é¢æ¶ï¼åä¸èä¼ç»§ç»­æäº¤äºå¡ã\n\nç¼ºç¹ï¼\n\n * æ°æ®ä¸ä¸è´é®é¢ä¾ç¶å­å¨ï¼å½å¨åä¸èæ¶å° precommit è¯·æ±åç­å¾ do commite æä»¤æ¶ï¼æ­¤æ¶å¦æåè°èè¯·æ±ä¸­æ­äºå¡ï¼èåè°èæ æ³ä¸åä¸èæ­£å¸¸éä¿¡ï¼ä¼å¯¼è´åä¸èç»§ç»­æäº¤äºå¡ï¼é ææ°æ®ä¸ä¸è´ã\n\n\n# 4. è¡¥å¿äºå¡ï¼tccï¼\n\n\n# 4.1. æ¹æ¡ç®ä»\n\ntccï¼try-confirm-cancelï¼çæ¦å¿µï¼ææ©æ¯ç± pat helland äº 2007 å¹´åè¡¨çä¸ç¯åä¸ºãlife beyond distributed transactions:an apostateâs opinionãçè®ºææåºã\n\ntcc æ¯æå¡åçäºé¶æ®µç¼ç¨æ¨¡åï¼å¶ tryãconfirmãcancel 3 ä¸ªæ¹æ³åç±ä¸å¡ç¼ç å®ç°ï¼\n\n * try - æä½ä½ä¸ºä¸é¶æ®µï¼è´è´£èµæºçæ£æ¥åé¢çã\n * confirm - æä½ä½ä¸ºäºé¶æ®µæäº¤æä½ï¼æ§è¡çæ­£çä¸å¡ã\n * cancel - æ¯é¢çèµæºçåæ¶ã\n\ntcc äºå¡ç tryãconfirmãcancel å¯ä»¥çè§£ä¸º sql äºå¡ä¸­ç lockãcommitãrollbackã\n\n\n# 4.2. å¤çæµç¨\n\nä¸ºäºæ¹ä¾¿çè§£ï¼ä¸é¢ä»¥çµåä¸åä¸ºä¾è¿è¡æ¹æ¡è§£æï¼è¿éææ´ä¸ªè¿ç¨ç®ååä¸ºæ£ååºå­ï¼è®¢ååå»º 2 ä¸ªæ­¥éª¤ï¼åºå­æå¡åè®¢åæå¡åå«å¨ä¸åçæå¡å¨èç¹ä¸ã\n\n# 4.2.1. try é¶æ®µ\n\nä»æ§è¡é¶æ®µæ¥çï¼ä¸ä¼ ç»äºå¡æºå¶ä¸­ä¸å¡é»è¾ç¸åãä½ä»ä¸å¡è§åº¦æ¥çï¼å´ä¸ä¸æ ·ãtcc æºå¶ä¸­ç try ä»æ¯ä¸ä¸ªåæ­¥æä½ï¼å®ååç»­çç¡®è®¤ä¸èµ·æè½çæ­£ææä¸ä¸ªå®æ´çä¸å¡é»è¾ï¼è¿ä¸ªé¶æ®µä¸»è¦å®æï¼\n\n * å®æææä¸å¡æ£æ¥( ä¸è´æ§ )\n * é¢çå¿é¡»ä¸å¡èµæº( åéç¦»æ§ )\n * try å°è¯æ§è¡ä¸å¡ tcc äºå¡æºå¶ä»¥åæ­¥æä½ï¼tryï¼ä¸ºä¸­å¿çï¼ç¡®è®¤æä½ï¼confirmï¼ååæ¶æä½ï¼cancelï¼é½æ¯å´ç»åæ­¥æä½ï¼tryï¼èå±å¼ãå æ­¤ï¼try é¶æ®µä¸­çæä½ï¼å¶ä¿éæ§æ¯æå¥½çï¼å³ä½¿å¤±è´¥ï¼ä»ç¶æåæ¶æä½ï¼cancelï¼å¯ä»¥å°å¶æ§è¡ç»ææ¤éã\n\nåè®¾åååºå­ä¸º 100ï¼è´­ä¹°æ°éä¸º 2ï¼è¿éæ£æ¥åæ´æ°åºå­çåæ¶ï¼å»ç»ç¨æ·è´­ä¹°æ°éçåºå­ï¼åæ¶åå»ºè®¢åï¼è®¢åç¶æä¸ºå¾ç¡®è®¤ã\n\n# 4.2.2. confirm / cancel é¶æ®µ\n\næ ¹æ® try é¶æ®µæå¡æ¯å¦å¨é¨æ­£å¸¸æ§è¡ï¼ç»§ç»­æ§è¡ç¡®è®¤æä½ï¼confirmï¼æåæ¶æä½ï¼cancelï¼ã confirm å cancel æä½æ»¡è¶³å¹ç­æ§ï¼å¦æ confirm æ cancel æä½æ§è¡å¤±è´¥ï¼å°ä¼ä¸æ­éè¯ç´å°æ§è¡å®æã\n\nconfirmï¼å½ try é¶æ®µæå¡å¨é¨æ­£å¸¸æ§è¡ï¼ æ§è¡ç¡®è®¤ä¸å¡é»è¾æä½\n\n\n\nè¿éä½¿ç¨çèµæºä¸å®æ¯ try é¶æ®µé¢ççä¸å¡èµæºãå¨ tcc äºå¡æºå¶ä¸­è®¤ä¸ºï¼å¦æå¨ try é¶æ®µè½æ­£å¸¸çé¢çèµæºï¼é£ confirm ä¸å®è½å®æ´æ­£ç¡®çæäº¤ãconfirm é¶æ®µä¹å¯ä»¥çææ¯å¯¹ try é¶æ®µçä¸ä¸ªè¡¥åï¼try+confirm ä¸èµ·ç»æäºä¸ä¸ªå®æ´çä¸å¡é»è¾ã\n\ncancelï¼å½ try é¶æ®µå­å¨æå¡æ§è¡å¤±è´¥ï¼ è¿å¥ cancel é¶æ®µ\n\n\n\ncancel åæ¶æ§è¡ï¼éæ¾ try é¶æ®µé¢ççä¸å¡èµæºï¼ä¸é¢çä¾å­ä¸­ï¼cancel æä½ä¼æå»ç»çåºå­éæ¾ï¼å¹¶æ´æ°è®¢åç¶æä¸ºåæ¶ã\n\n\n# 4.3. æ¹æ¡æ»ç»\n\ntcc äºå¡æºå¶ç¸å¯¹äºä¼ ç»äºå¡æºå¶ï¼x/open xaï¼ï¼tcc äºå¡æºå¶ç¸æ¯äºä¸é¢ä»ç»ç xa äºå¡æºå¶ï¼æä»¥ä¸ä¼ç¹:\n\n * æ§è½æå - å·ä½ä¸å¡æ¥å®ç°æ§å¶èµæºéçç²åº¦åå°ï¼ä¸ä¼éå®æ´ä¸ªèµæºã\n * æ°æ®æç»ä¸è´æ§ - åºäº confirm å cancel çå¹ç­æ§ï¼ä¿è¯äºå¡æç»å®æç¡®è®¤æèåæ¶ï¼ä¿è¯æ°æ®çä¸è´æ§ã\n * å¯é æ§ - è§£å³äº xa åè®®çåè°èåç¹æéé®é¢ï¼ç±ä¸»ä¸å¡æ¹åèµ·å¹¶æ§å¶æ´ä¸ªä¸å¡æ´»å¨ï¼ä¸å¡æ´»å¨ç®¡çå¨ä¹åæå¤ç¹ï¼å¼å¥éç¾¤ã\n\nç¼ºç¹ï¼ tcc ç tryãconfirm å cancel æä½åè½è¦æå·ä½ä¸å¡æ¥å®ç°ï¼ä¸å¡è¦ååº¦è¾é«ï¼æé«äºå¼åææ¬ã\n\n\n# 5. æ¬å°æ¶æ¯è¡¨\n\n\n# 5.1. æ¹æ¡ç®ä»\n\næ¬å°æ¶æ¯è¡¨çæ¹æ¡æåæ¯ç± ebay æåºï¼æ ¸å¿æè·¯æ¯å°åå¸å¼äºå¡æåææ¬å°äºå¡è¿è¡å¤çã\n\næ¹æ¡éè¿å¨äºå¡ä¸»å¨åèµ·æ¹é¢å¤æ°å»ºäºå¡æ¶æ¯è¡¨ï¼äºå¡åèµ·æ¹å¤çä¸å¡åè®°å½äºå¡æ¶æ¯å¨æ¬å°äºå¡ä¸­å®æï¼è½®è¯¢äºå¡æ¶æ¯è¡¨çæ°æ®åéäºå¡æ¶æ¯ï¼äºå¡è¢«å¨æ¹åºäºæ¶æ¯ä¸­é´ä»¶æ¶è´¹äºå¡æ¶æ¯è¡¨ä¸­çäºå¡ã\n\nè¿æ ·è®¾è®¡å¯ä»¥é¿åâä¸å¡å¤çæå + äºå¡æ¶æ¯åéå¤±è´¥"ï¼æ"ä¸å¡å¤çå¤±è´¥ + äºå¡æ¶æ¯åéæå"çæ£ææåµåºç°ï¼ä¿è¯ 2 ä¸ªç³»ç»äºå¡çæ°æ®ä¸è´æ§ã\n\n\n# 5.2. å¤çæµç¨\n\nä¸é¢æåå¸å¼äºå¡æåå¼å§å¤ççäºå¡æ¹æä¸ºäºå¡ä¸»å¨æ¹ï¼å¨äºå¡ä¸»å¨æ¹ä¹åå¤ççä¸å¡åçå¶ä»äºå¡æä¸ºäºå¡è¢«å¨æ¹ã\n\nä¸ºäºæ¹ä¾¿çè§£ï¼ä¸é¢ç»§ç»­ä»¥çµåä¸åä¸ºä¾è¿è¡æ¹æ¡è§£æï¼è¿éææ´ä¸ªè¿ç¨ç®ååä¸ºæ£ååºå­ï¼è®¢ååå»º 2 ä¸ªæ­¥éª¤ï¼åºå­æå¡åè®¢åæå¡åå«å¨ä¸åçæå¡å¨èç¹ä¸ï¼å¶ä¸­åºå­æå¡æ¯äºå¡ä¸»å¨æ¹ï¼è®¢åæå¡æ¯äºå¡è¢«å¨æ¹ã\n\näºå¡çä¸»å¨æ¹éè¦é¢å¤æ°å»ºäºå¡æ¶æ¯è¡¨ï¼ç¨äºè®°å½åå¸å¼äºå¡çæ¶æ¯çåçãå¤çç¶æã\n\næ´ä¸ªä¸å¡å¤çæµç¨å¦ä¸ï¼\n\n\n\n>  1. æ­¥éª¤ 1 äºå¡ä¸»å¨æ¹å¤çæ¬å°äºå¡ã äºå¡ä¸»å¨åå¨æ¬å°äºå¡ä¸­å¤çä¸å¡æ´æ°æä½ååæ¶æ¯è¡¨æä½ã ä¸é¢ä¾å­ä¸­åºå­æå¡é¶æ®µåæ¬å°äºå¡ä¸­å®ææ£ååºå­ååæ¶æ¯è¡¨(å¾ä¸­ 1ã2)ã\n>  2. æ­¥éª¤ 2 äºå¡ä¸»å¨æ¹éè¿ mq éç¥äºå¡è¢«å¨æ¹å¤çäºå¡ã æ¶æ¯ä¸­é´ä»¶å¯ä»¥åºäº kafkaãrocketmq æ¶æ¯éåï¼äºå¡ä¸»å¨æ¹æ³ä¸»å¨åæ¶æ¯å°æ¶æ¯éåï¼äºå¡æ¶è´¹æ¹æ¶è´¹å¹¶å¤çæ¶æ¯éåä¸­çæ¶æ¯ã ä¸é¢ä¾å­ä¸­ï¼åºå­æå¡æäºå¡å¾å¤çæ¶æ¯åå°æ¶æ¯ä¸­é´ä»¶ï¼è®¢åæå¡æ¶è´¹æ¶æ¯ä¸­é´ä»¶çæ¶æ¯ï¼å®ææ°å¢è®¢åï¼å¾ä¸­ 3 - 5ï¼ã\n>  3. æ­¥éª¤ 3 äºå¡è¢«å¨æ¹éè¿ mq åä¼å¤çç»æã ä¸é¢ä¾å­ä¸­ï¼è®¢åæå¡æäºå¡å·²å¤çæ¶æ¯åå°æ¶æ¯ä¸­é´ä»¶ï¼åºå­æå¡æ¶è´¹ä¸­é´ä»¶çæ¶æ¯ï¼å¹¶å°äºå¡æ¶æ¯çç¶ææ´æ°ä¸ºå·²å®æ(å¾ä¸­ 6 - 8)\n\nä¸ºäºæ°æ®çä¸è´æ§ï¼å½å¤çéè¯¯éè¦éè¯ï¼äºå¡åéæ¹åäºå¡æ¥æ¶æ¹ç¸å³ä¸å¡å¤çéè¦æ¯æå¹ç­ãå·ä½ä¿å­ä¸è´æ§çå®¹éå¤çå¦ä¸ï¼\n\n>  * å½æ­¥éª¤ 1 å¤çåºéï¼äºå¡åæ»ï¼ç¸å½äºä»ä¹é½æ²¡åçã\n>  * å½æ­¥éª¤ 2ãæ­¥éª¤ 3 å¤çåºéï¼ç±äºæªå¤ççäºå¡æ¶æ¯è¿æ¯ä¿å­å¨äºå¡åéæ¹ï¼äºå¡åéæ¹å¯ä»¥å®æ¶è½®è¯¢ä¸ºè¶æ¶æ¶æ¯æ°æ®ï¼åæ¬¡åéçæ¶æ¯ä¸­é´ä»¶è¿è¡å¤çãäºå¡è¢«å¨æ¹æ¶è´¹äºå¡æ¶æ¯éè¯å¤çã\n>  * å¦ææ¯ä¸å¡ä¸çå¤±è´¥ï¼äºå¡è¢«å¨æ¹å¯ä»¥åæ¶æ¯ç»äºå¡ä¸»å¨æ¹è¿è¡åæ»ã\n>  * å¦æå¤ä¸ªäºå¡è¢«å¨æ¹å·²ç»æ¶è´¹æ¶æ¯ï¼äºå¡ä¸»å¨æ¹éè¦åæ»äºå¡æ¶éè¦éç¥äºå¡è¢«å¨æ¹åæ»ã\n\n\n# 5.3. æ¹æ¡æ»ç»\n\næ¹æ¡çä¼ç¹å¦ä¸ï¼\n\n * ä»åºç¨è®¾è®¡å¼åçè§åº¦å®ç°äºæ¶æ¯æ°æ®çå¯é æ§ï¼æ¶æ¯æ°æ®çå¯é æ§ä¸ä¾èµäºæ¶æ¯ä¸­é´ä»¶ï¼å¼±åäºå¯¹ mq ä¸­é´ä»¶ç¹æ§çä¾èµã\n * æ¹æ¡è½»éï¼å®¹æå®ç°ã\n\nç¼ºç¹å¦ä¸ï¼\n\n * ä¸å·ä½çä¸å¡åºæ¯ç»å®ï¼è¦åæ§å¼ºï¼ä¸å¯å¤ç¨ã\n * æ¶æ¯æ°æ®ä¸ä¸å¡æ°æ®ååºï¼å ç¨ä¸å¡ç³»ç»èµæºã\n * ä¸å¡ç³»ç»å¨ä½¿ç¨å³ç³»åæ°æ®åºçæåµä¸ï¼æ¶æ¯æå¡æ§è½ä¼åå°å³ç³»åæ°æ®åºå¹¶åæ§è½çå±éã\n\n\n# 6. mq äºå¡\n\n\n# 6.1. æ¹æ¡ç®ä»\n\nåºäº mq çåå¸å¼äºå¡æ¹æ¡å¶å®æ¯å¯¹æ¬å°æ¶æ¯è¡¨çå°è£ï¼å°æ¬å°æ¶æ¯è¡¨åºäº mq åé¨ï¼å¶ä»æ¹é¢çåè®®åºæ¬ä¸æ¬å°æ¶æ¯è¡¨ä¸è´ã\n\n\n# 6.2. å¤çæµç¨\n\nä¸é¢ä¸»è¦åºäº rocketmq4.3 ä¹åççæ¬ä»ç» mq çåå¸å¼äºå¡æ¹æ¡ã\n\nå¨æ¬å°æ¶æ¯è¡¨æ¹æ¡ä¸­ï¼ä¿è¯äºå¡ä¸»å¨æ¹ååä¸å¡è¡¨æ°æ®ååæ¶æ¯è¡¨æ°æ®çä¸è´æ§æ¯åºäºæ°æ®åºäºå¡ï¼rocketmq çäºå¡æ¶æ¯ç¸å¯¹äºæ®é mqï¼ç¸å¯¹äºæä¾äº 2pc çæäº¤æ¥å£ï¼æ¹æ¡å¦ä¸ï¼\n\næ­£å¸¸æåµââäºå¡ä¸»å¨æ¹åæ¶æ¯ è¿ç§æåµä¸ï¼äºå¡ä¸»å¨æ¹æå¡æ­£å¸¸ï¼æ²¡æåçæéï¼åæ¶æ¯æµç¨å¦ä¸ï¼\n\n\n\n>  1. åéæ¹å mq æå¡ç«¯(mq server)åé half æ¶æ¯ã\n>  2. mq server å°æ¶æ¯æä¹åæåä¹åï¼ååéæ¹ ack ç¡®è®¤æ¶æ¯å·²ç»åéæåã\n>  3. åéæ¹å¼å§æ§è¡æ¬å°äºå¡é»è¾ã\n>  4. åéæ¹æ ¹æ®æ¬å°äºå¡æ§è¡ç»æå mq server æäº¤äºæ¬¡ç¡®è®¤ï¼commit ææ¯ rollbackï¼ã\n>  5. mq server æ¶å° commit ç¶æåå°åæ¶æ¯æ è®°ä¸ºå¯æéï¼è®¢éæ¹æç»å°æ¶å°è¯¥æ¶æ¯ï¼mq server æ¶å° rollback ç¶æåå é¤åæ¶æ¯ï¼è®¢éæ¹å°ä¸ä¼æ¥åè¯¥æ¶æ¯ã\n\nå¼å¸¸æåµââäºå¡ä¸»å¨æ¹æ¶æ¯æ¢å¤ å¨æ­ç½æèåºç¨éå¯ç­å¼å¸¸æåµä¸ï¼å¾ä¸­ 4 æäº¤çäºæ¬¡ç¡®è®¤è¶æ¶æªå°è¾¾ mq serverï¼æ­¤æ¶å¤çé»è¾å¦ä¸ï¼\n\n\n\n>  5. mq server å¯¹è¯¥æ¶æ¯åèµ·æ¶æ¯åæ¥ã\n>  6. åéæ¹æ¶å°æ¶æ¯åæ¥åï¼éè¦æ£æ¥å¯¹åºæ¶æ¯çæ¬å°äºå¡æ§è¡çæç»ç»æã\n>  7. åéæ¹æ ¹æ®æ£æ¥å¾å°çæ¬å°äºå¡çæç»ç¶æåæ¬¡æäº¤äºæ¬¡ç¡®è®¤\n>  8. mq server åºäº commit / rollback å¯¹æ¶æ¯è¿è¡æéæèå é¤\n\n\n# 6.3. æ¹æ¡æ»ç»\n\nç¸æ¯æ¬å°æ¶æ¯è¡¨æ¹æ¡ï¼mq äºå¡æ¹æ¡ä¼ç¹æ¯ï¼\n\n * æ¶æ¯æ°æ®ç¬ç«å­å¨ ï¼éä½ä¸å¡ç³»ç»ä¸æ¶æ¯ç³»ç»ä¹é´çè¦åã\n * ååéä¼äºä½¿ç¨æ¬å°æ¶æ¯è¡¨æ¹æ¡ã\n\nç¼ºç¹æ¯ï¼\n\n * ä¸æ¬¡æ¶æ¯åééè¦ä¸¤æ¬¡ç½ç»è¯·æ±(half æ¶æ¯ + commit/rollback æ¶æ¯)\n * ä¸å¡å¤çæå¡éè¦å®ç°æ¶æ¯ç¶æåæ¥æ¥å£\n\n\n# 7. saga\n\n\n# 7.1. æ¹æ¡ç®ä»\n\nsaga äºå¡æºäº 1987 å¹´æ®ææ¯é¡¿å¤§å­¦ç hecto å kenneth åè¡¨çå¦ä½å¤ç long lived transactionï¼é¿æ´»äºå¡ï¼è®ºæï¼saga äºå¡æ ¸å¿ææ³æ¯å°é¿äºå¡æåä¸ºå¤ä¸ªæ¬å°ç­äºå¡ï¼ç± saga äºå¡åè°å¨åè°ï¼å¦ææ­£å¸¸ç»æé£å°±æ­£å¸¸å®æï¼å¦ææä¸ªæ­¥éª¤å¤±è´¥ï¼åæ ¹æ®ç¸åé¡ºåºä¸æ¬¡è°ç¨è¡¥å¿æä½ã\n\n\n# 7.2. å¤çæµç¨\n\nsaga äºå¡åºæ¬åè®®å¦ä¸ï¼\n\n * æ¯ä¸ª saga äºå¡ç±ä¸ç³»åå¹ç­çæåºå­äºå¡(sub-transaction) ti ç»æã\n * æ¯ä¸ª ti é½æå¯¹åºçå¹ç­è¡¥å¿å¨ä½ ciï¼è¡¥å¿å¨ä½ç¨äºæ¤é ti é æçç»æã\n\nå¯ä»¥çå°ï¼å tcc ç¸æ¯ï¼saga æ²¡æâé¢çâå¨ä½ï¼å®ç ti å°±æ¯ç´æ¥æäº¤å°åºã\n\nä¸é¢ä»¥ä¸åæµç¨ä¸ºä¾ï¼æ´ä¸ªæä½åæ¬ï¼åå»ºè®¢åãæ£ååºå­ãæ¯ä»ãå¢å ç§¯å saga çæ§è¡é¡ºåºæä¸¤ç§ï¼\n\n\n\n * äºå¡æ­£å¸¸æ§è¡å®æ t1, t2, t3, ..., tnï¼ä¾å¦ï¼æ£ååºå­(t1)ï¼åå»ºè®¢å(t2)ï¼æ¯ä»(t3)ï¼ä¾æ¬¡æåºå®ææ´ä¸ªäºå¡ã\n * äºå¡åæ» t1, t2, ..., tj, cj,..., c2, c1ï¼å¶ä¸­ 0 < j < nï¼ä¾å¦ï¼æ£ååºå­(t1)ï¼åå»ºè®¢å(t2)ï¼æ¯ä»(t3ï¼æ¯ä»å¤±è´¥)ï¼æ¯ä»åæ»(c3)ï¼è®¢ååæ»(c2)ï¼æ¢å¤åºå­(c1)ã\n\n# 7.2.1. æ¢å¤ç­ç¥\n\nsaga å®ä¹äºä¸¤ç§æ¢å¤ç­ç¥ï¼\n\n * ååæ¢å¤(forward recovery)\n\n\n\nå¯¹åºäºä¸é¢ç¬¬ä¸ç§æ§è¡é¡ºåºï¼éç¨äºå¿é¡»è¦æåçåºæ¯ï¼åçå¤±è´¥è¿è¡éè¯ï¼æ§è¡é¡ºåºæ¯ç±»ä¼¼äºè¿æ ·çï¼t1, t2, ..., tj(å¤±è´¥), tj(éè¯),..., tnï¼å¶ä¸­ j æ¯åçéè¯¯çå­äºå¡(sub-transaction)ãè¯¥æåµä¸ä¸éè¦ ciã\n\n * ååæ¢å¤(backward recovery)\n\n\n\nå¯¹åºäºä¸é¢æå°çç¬¬äºç§æ§è¡é¡ºåºï¼å¶ä¸­ j æ¯åçéè¯¯çå­äºå¡(sub-transaction)ï¼è¿ç§åæ³çæææ¯æ¤éæä¹åæææåçå­äºå¡ï¼ä½¿å¾æ´ä¸ª saga çæ§è¡ç»ææ¤éã\n\nsaga äºå¡å¸¸è§çæä¸¤ç§ä¸åçå®ç°æ¹å¼ï¼å½ä»¤åè°åäºä»¶ç¼æã\n\n# 7.2.2. å½ä»¤åè°\n\n * å½ä»¤åè°(order orchestrator)ï¼ä¸­å¤®åè°å¨è´è´£éä¸­å¤çäºä»¶çå³ç­åä¸å¡é»è¾æåºã\n\nä¸­å¤®åè°å¨ï¼orchestratorï¼ç®ç§° osoï¼ä»¥å½ä»¤/åå¤çæ¹å¼ä¸æ¯é¡¹æå¡è¿è¡éä¿¡ï¼å¨æè´è´£åè¯æ¯ä¸ªåä¸èè¯¥åä»ä¹ä»¥åä»ä¹æ¶åè¯¥åä»ä¹ã\n\n\n\nä»¥çµåè®¢åçä¾å­ä¸ºä¾ï¼\n\n>  1. äºå¡åèµ·æ¹çä¸»ä¸å¡é»è¾è¯·æ± oso æå¡å¼å¯è®¢åäºå¡ã\n>  2. oso ååºå­æå¡è¯·æ±æ£ååºå­ï¼åºå­æå¡åå¤å¤çç»æã\n>  3. oso åè®¢åæå¡è¯·æ±åå»ºè®¢åï¼è®¢åæå¡åå¤åå»ºç»æã\n>  4. oso åæ¯ä»æå¡è¯·æ±æ¯ä»ï¼æ¯ä»æå¡åå¤å¤çç»æã\n>  5. ä¸»ä¸å¡é»è¾æ¥æ¶å¹¶å¤ç oso äºå¡å¤çç»æåå¤ã\n\nä¸­å¤®åè°å¨å¿é¡»äºåç¥éæ§è¡æ´ä¸ªè®¢åäºå¡æéçæµç¨(ä¾å¦éè¿è¯»åéç½®)ãå¦ææä»»ä½å¤±è´¥ï¼å®è¿è´è´£éè¿åæ¯ä¸ªåä¸èåéå½ä»¤æ¥æ¤éä¹åçæä½æ¥åè°åå¸å¼çåæ»ãåºäºä¸­å¤®åè°å¨åè°ä¸åæ¶ï¼åæ»è¦å®¹æå¾å¤ï¼å ä¸ºåè°å¨é»è®¤æ¯æ§è¡æ­£åæµç¨ï¼åæ»æ¶åªè¦æ§è¡ååæµç¨å³å¯ã\n\n# 7.2.3. äºä»¶ç¼æ\n\n * äºä»¶ç¼æ (event choreography0ï¼æ²¡æä¸­å¤®åè°å¨ï¼æ²¡æåç¹é£é©ï¼æ¶ï¼æ¯ä¸ªæå¡äº§çå¹¶è§å¯å¶ä»æå¡çäºä»¶ï¼å¹¶å³å®æ¯å¦åºéåè¡å¨ã\n\nå¨äºä»¶ç¼ææ¹æ³ä¸­ï¼ç¬¬ä¸ä¸ªæå¡æ§è¡ä¸ä¸ªäºå¡ï¼ç¶ååå¸ä¸ä¸ªäºä»¶ãè¯¥äºä»¶è¢«ä¸ä¸ªæå¤ä¸ªæå¡è¿è¡çå¬ï¼è¿äºæå¡åæ§è¡æ¬å°äºå¡å¹¶åå¸ï¼æä¸åå¸ï¼æ°çäºä»¶ã\n\nå½æåä¸ä¸ªæå¡æ§è¡æ¬å°äºå¡å¹¶ä¸ä¸åå¸ä»»ä½äºä»¶æ¶ï¼æå³çåå¸å¼äºå¡ç»æï¼æèå®åå¸çäºä»¶æ²¡æè¢«ä»»ä½ saga åä¸èå¬å°é½æå³çäºå¡ç»æã\n\nä»¥çµåè®¢åçä¾å­ä¸ºä¾ï¼\n\n\n\n>  1. äºå¡åèµ·æ¹çä¸»ä¸å¡é»è¾åå¸å¼å§è®¢åäºä»¶\n>  2. åºå­æå¡çå¬å¼å§è®¢åäºä»¶ï¼æ£ååºå­ï¼å¹¶åå¸åºå­å·²æ£åäºä»¶\n>  3. è®¢åæå¡çå¬åºå­å·²æ£åäºä»¶ï¼åå»ºè®¢åï¼å¹¶åå¸è®¢åå·²åå»ºäºä»¶\n>  4. æ¯ä»æå¡çå¬è®¢åå·²åå»ºäºä»¶ï¼è¿è¡æ¯ä»ï¼å¹¶åå¸è®¢åå·²æ¯ä»äºä»¶\n>  5. ä¸»ä¸å¡é»è¾çå¬è®¢åå·²æ¯ä»äºä»¶å¹¶å¤çã\n\näºä»¶/ç¼ææ¯å®ç° saga æ¨¡å¼çèªç¶æ¹å¼ï¼å®å¾ç®åï¼å®¹æçè§£ï¼ä¸éè¦å¤ªå¤çä»£ç æ¥æå»ºãå¦æäºå¡æ¶å 2 è³ 4 ä¸ªæ­¥éª¤ï¼åå¯è½æ¯éå¸¸åéçã\n\n\n# 7.3. æ¹æ¡æ»ç»\n\nå½ä»¤åè°è®¾è®¡çä¼ç¹åç¼ºç¹ï¼\n\nä¼ç¹å¦ä¸ï¼\n\n * æå¡ä¹é´å³ç³»ç®åï¼é¿åæå¡ä¹é´çå¾ªç¯ä¾èµå³ç³»ï¼å ä¸º saga åè°å¨ä¼è°ç¨ saga åä¸èï¼ä½åä¸èä¸ä¼è°ç¨åè°å¨\n * ç¨åºå¼åç®åï¼åªéè¦æ§è¡å½ä»¤/åå¤(å¶å®åå¤æ¶æ¯ä¹æ¯ä¸ç§äºä»¶æ¶æ¯)ï¼éä½åä¸èçå¤ææ§ã\n * æç»´æ¤æ©å±ï¼å¨æ·»å æ°æ­¥éª¤æ¶ï¼äºå¡å¤ææ§ä¿æçº¿æ§ï¼åæ»æ´å®¹æç®¡çï¼æ´å®¹æå®æ½åæµè¯\n\nç¼ºç¹å¦ä¸ï¼\n\n * ä¸­å¤®åè°å¨å®¹æå¤çé»è¾å®¹æè¿äºå¤æï¼å¯¼è´é¾ä»¥ç»´æ¤ã\n * å­å¨åè°å¨åç¹æéé£é©ã\n\näºä»¶/ç¼æè®¾è®¡çä¼ç¹åç¼ºç¹\n\nä¼ç¹å¦ä¸ï¼\n\n * é¿åä¸­å¤®åè°å¨åç¹æéé£é©ã\n * å½æ¶åçæ­¥éª¤è¾å°æå¡å¼åç®åï¼å®¹æå®ç°ã\n\nç¼ºç¹å¦ä¸ï¼\n\n * æå¡ä¹é´å­å¨å¾ªç¯ä¾èµçé£é©ã\n * å½æ¶åçæ­¥éª¤è¾å¤ï¼æå¡é´å³ç³»æ··ä¹±ï¼é¾ä»¥è¿½è¸ªè°æµã\n\nå¼å¾è¡¥åçæ¯ï¼ç±äº saga æ¨¡åä¸­æ²¡æ prepare é¶æ®µï¼å æ­¤äºå¡é´ä¸è½ä¿è¯éç¦»æ§ï¼å½å¤ä¸ª saga äºå¡æä½åä¸èµæºæ¶ï¼å°±ä¼äº§çæ´æ°ä¸¢å¤±ãèæ°æ®è¯»åç­é®é¢ï¼è¿æ¶éè¦å¨ä¸å¡å±æ§å¶å¹¶åï¼ä¾å¦ï¼å¨åºç¨å±é¢å éï¼æèåºç¨å±é¢é¢åå»ç»èµæºã\n\n\n# 8. æ»ç»\n\n\n# 8.1. åæ¹æ¡ä½¿ç¨åºæ¯\n\nä»ç»å®åå¸å¼äºå¡ç¸å³çè®ºåå¸¸è§è§£å³æ¹æ¡åï¼æç»çç®çå¨å®éé¡¹ç®ä¸­è¿ç¨ï¼å æ­¤ï¼æ»ç»ä¸ä¸åä¸ªæ¹æ¡çå¸¸è§çä½¿ç¨åºæ¯ã\n\n\n\n * 2pc/3pc ä¾èµäºæ°æ®åºï¼è½å¤å¾å¥½çæä¾å¼ºä¸è´æ§åå¼ºäºå¡æ§ï¼ä½ç¸å¯¹æ¥è¯´å»¶è¿æ¯è¾é«ï¼æ¯è¾éåä¼ ç»çåä½åºç¨ï¼å¨åä¸ä¸ªæ¹æ³ä¸­å­å¨è·¨åºæä½çæåµï¼ä¸éåé«å¹¶ååé«æ§è½è¦æ±çåºæ¯ã\n * tcc éç¨äºæ§è¡æ¶é´ç¡®å®ä¸è¾ç­ï¼å®æ¶æ§è¦æ±é«ï¼å¯¹æ°æ®ä¸è´æ§è¦æ±é«ï¼æ¯å¦äºèç½éèä¼ä¸ææ ¸å¿çä¸ä¸ªæå¡ï¼äº¤æãæ¯ä»ãè´¦å¡ã\n * æ¬å°æ¶æ¯è¡¨/mq äºå¡ é½éç¨äºäºå¡ä¸­åä¸æ¹æ¯ææä½å¹ç­ï¼å¯¹ä¸è´æ§è¦æ±ä¸é«ï¼ä¸å¡ä¸è½å®¹å¿æ°æ®ä¸ä¸è´å°ä¸ä¸ªäººå·¥æ£æ¥å¨æï¼äºå¡æ¶åçåä¸æ¹ãåä¸ç¯èè¾å°ï¼ä¸å¡ä¸æå¯¹è´¦/æ ¡éªç³»ç»ååºã\n * saga äºå¡ ç±äº saga äºå¡ä¸è½ä¿è¯éç¦»æ§ï¼éè¦å¨ä¸å¡å±æ§å¶å¹¶åï¼éåäºä¸å¡åºæ¯äºå¡å¹¶åæä½åä¸èµæºè¾å°çæåµã saga ç¸æ¯ç¼ºå°é¢æäº¤å¨ä½ï¼å¯¼è´è¡¥å¿å¨ä½çå®ç°æ¯è¾éº»ç¦ï¼ä¾å¦ä¸å¡æ¯åéç­ä¿¡ï¼è¡¥å¿å¨ä½åå¾ååéä¸æ¬¡ç­ä¿¡è¯´ææ¤éï¼ç¨æ·ä½éªæ¯è¾å·®ãsaga äºå¡è¾éç¨äºè¡¥å¿å¨ä½å®¹æå¤ççåºæ¯ã\n\n\n# 8.2. åå¸å¼äºå¡æ¹æ¡è®¾è®¡\n\næ¬æä»ç»çååäºåçï¼ä¸çå·²ç»æä¸å°å¼æºçæèæ¶è´¹çè§£å³æ¹æ¡ï¼ç¯å¹æéï¼å°±ä¸åå±å¼ä»ç»ã\n\nå®éè¿ç¨çè®ºæ¶è¿è¡æ¶æè®¾è®¡æ¶ï¼è®¸å¤äººå®¹æç¯âæéæäºé¤å­ï¼çä»ä¹é½è§å¾åéå­âçéè¯¯ï¼è®¾è®¡æ¹æ¡æ¶èèçé®é¢åºæ¯è¿å¤ï¼åç§éè¯ï¼åç§è¡¥å¿æºå¶å¼å¥ç³»ç»ï¼å¯¼è´è®¾è®¡åºæ¥çç³»ç»è¿äºå¤æï¼è½å°é¥é¥æ æã\n\n> ä¸çä¸è§£å³ä¸ä¸ªè®¡ç®æºé®é¢æç®åçæ¹æ³ï¼âæ°å¥½âä¸éè¦è§£å³å®ï¼ââ é¿éä¸­é´ä»¶ææ¯ä¸å®¶æ²è¯¢\n\næäºé®é¢ï¼çèµ·æ¥å¾éè¦ï¼ä½å®éä¸æä»¬å¯ä»¥éè¿åççè®¾è®¡æèå°é®é¢åè§£æ¥è§é¿ãè®¾è®¡åå¸å¼äºå¡ç³»ç»ä¹ä¸æ¯éè¦èèææå¼å¸¸æåµï¼ä¸å¿è¿åº¦è®¾è®¡åç§åæ»ï¼è¡¥å¿æºå¶ãå¦æç¡¬è¦ææ¶é´è±å¨è§£å³é®é¢æ¬èº«ï¼å®éä¸ä¸ä»æçä½ä¸ï¼èä¸ä¹æ¯ä¸ç§æµªè´¹ã\n\nå¦æç³»ç»è¦å®ç°åæ»æµç¨çè¯ï¼æå¯è½ç³»ç»å¤æåº¦å°å¤§å¤§æåï¼ä¸å¾å®¹æåºç° bugï¼ä¼°è®¡åºç° bug çæ¦çä¼æ¯éè¦äºå¡åæ»çæ¦çå¤§å¾å¤ãå¨è®¾è®¡ç³»ç»æ¶ï¼æä»¬éè¦è¡¡éæ¯å¦å¼å¾è±è¿ä¹å¤§çä»£ä»·æ¥è§£å³è¿æ ·ä¸ä¸ªåºç°æ¦çéå¸¸å°çé®é¢ï¼å¯ä»¥èèå½åºç°è¿ä¸ªæ¦çå¾å°çé®é¢ï¼è½å¦éç¨äººå·¥è§£å³çæ¹å¼ï¼è¿ä¹æ¯å¤§å®¶å¨è§£å³çé¾é®é¢æ¶éè¦å¤å¤æèçå°æ¹ã\n\n\n# 9. åèèµæ\n\n * èèåå¸å¼äºå¡ï¼åè¯´è¯´è§£å³æ¹æ¡\n * çè§£åå¸å¼äºå¡',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼éåºæ¬åç",frontmatter:{title:"åå¸å¼éåºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æ°æ®è°åº¦"],tags:["åå¸å¼","æ°æ®è°åº¦","é"],abbrlink:"55b1b1a1",date:"2019-06-04T23:42:00.000Z",permalink:"/pages/69360c/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/02.%E6%95%B0%E6%8D%AE%E8%B0%83%E5%BA%A6/06.%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/06.åå¸å¼é.md",key:"v-65b0509c",path:"/pages/69360c/",headers:[{level:2,title:"1. åå¸å¼éæè·¯",slug:"_1-åå¸å¼éæè·¯",normalizedTitle:"1. åå¸å¼éæè·¯",charIndex:264},{level:2,title:"2. æ°æ®åºåå¸å¼é",slug:"_2-æ°æ®åºåå¸å¼é",normalizedTitle:"2. æ°æ®åºåå¸å¼é",charIndex:951},{level:3,title:"2.1. æ°æ®åºåå¸å¼éåç",slug:"_2-1-æ°æ®åºåå¸å¼éåç",normalizedTitle:"2.1. æ°æ®åºåå¸å¼éåç",charIndex:966},{level:3,title:"2.2. æ°æ®åºåå¸å¼éé®é¢",slug:"_2-2-æ°æ®åºåå¸å¼éé®é¢",normalizedTitle:"2.2. æ°æ®åºåå¸å¼éé®é¢",charIndex:1752},{level:3,title:"2.3. æ°æ®åºåå¸å¼éå°ç»",slug:"_2-3-æ°æ®åºåå¸å¼éå°ç»",normalizedTitle:"2.3. æ°æ®åºåå¸å¼éå°ç»",charIndex:2201},{level:2,title:"3. Redis åå¸å¼é",slug:"_3-redis-åå¸å¼é",normalizedTitle:"3. redis åå¸å¼é",charIndex:2305},{level:3,title:"3.1. Redis åå¸å¼éåç",slug:"_3-1-redis-åå¸å¼éåç",normalizedTitle:"3.1. redis åå¸å¼éåç",charIndex:2410},{level:3,title:"3.2. Redis åå¸å¼éå®ç°",slug:"_3-2-redis-åå¸å¼éå®ç°",normalizedTitle:"3.2. redis åå¸å¼éå®ç°",charIndex:2842},{level:3,title:"3.3. æ°æ®åºåå¸å¼éå°ç»",slug:"_3-3-æ°æ®åºåå¸å¼éå°ç»",normalizedTitle:"3.3. æ°æ®åºåå¸å¼éå°ç»",charIndex:3266},{level:3,title:"3.4. RedLock ç®æ³",slug:"_3-4-redlock-ç®æ³",normalizedTitle:"3.4. redlock ç®æ³",charIndex:3561},{level:2,title:"4. ZooKeeper åå¸å¼é",slug:"_4-zookeeper-åå¸å¼é",normalizedTitle:"4. zookeeper åå¸å¼é",charIndex:3943},{level:3,title:"4.1. ZooKeeper åå¸å¼éåç",slug:"_4-1-zookeeper-åå¸å¼éåç",normalizedTitle:"4.1. zookeeper åå¸å¼éåç",charIndex:3965},{level:3,title:"4.2. ZooKeeper åå¸å¼éå®ç°",slug:"_4-2-zookeeper-åå¸å¼éå®ç°",normalizedTitle:"4.2. zookeeper åå¸å¼éå®ç°",charIndex:4514},{level:3,title:"4.3. ZooKeeper åå¸å¼éå°ç»",slug:"_4-3-zookeeper-åå¸å¼éå°ç»",normalizedTitle:"4.3. zookeeper åå¸å¼éå°ç»",charIndex:11820},{level:2,title:"5. åå¸å¼éæ¹æ¡å¯¹æ¯",slug:"_5-åå¸å¼éæ¹æ¡å¯¹æ¯",normalizedTitle:"5. åå¸å¼éæ¹æ¡å¯¹æ¯",charIndex:12321},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:12613}],headersStr:"1. åå¸å¼éæè·¯ 2. æ°æ®åºåå¸å¼é 2.1. æ°æ®åºåå¸å¼éåç 2.2. æ°æ®åºåå¸å¼éé®é¢ 2.3. æ°æ®åºåå¸å¼éå°ç» 3. Redis åå¸å¼é 3.1. Redis åå¸å¼éåç 3.2. Redis åå¸å¼éå®ç° 3.3. æ°æ®åºåå¸å¼éå°ç» 3.4. RedLock ç®æ³ 4. ZooKeeper åå¸å¼é 4.1. ZooKeeper åå¸å¼éåç 4.2. ZooKeeper åå¸å¼éå®ç° 4.3. ZooKeeper åå¸å¼éå°ç» 5. åå¸å¼éæ¹æ¡å¯¹æ¯ 6. åèèµæ",content:'# åå¸å¼éåºæ¬åç\n\n> å¨å¹¶ååºæ¯ä¸ï¼ä¸ºäºä¿è¯å¹¶åå®å¨ï¼æä»¬å¸¸å¸¸è¦éè¿äºæ¥ï¼å éï¼ææ®µæ¥ä¿è¯æ°æ®åæ­¥å®å¨ã\n> \n> JDK è½ç¶æä¾äºå¤§ééå·¥å·ï¼ä½æ¯åªè½ä½ç¨äºåä¸ Java è¿ç¨ï¼æ æ³åºç¨äºåå¸å¼ç³»ç»ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦ä½¿ç¨åå¸å¼éã\n> \n> åå¸å¼éçè§£å³æ¹æ¡å¤§è´æä»¥ä¸å ç§ï¼\n> \n>  * åºäºæ°æ®åºå®ç°\n>  * åºäºç¼å­ï¼redisï¼memcached ç­ï¼å®ç°\n>  * åºäº Zookeeper å®ç° â\n> \n> æ³¨ï¼æ¨èåºäº ZooKeeper å®ç°åå¸å¼éï¼å·ä½åå çå®æ¬æå³å¯æäºã\n\n\n# 1. åå¸å¼éæè·¯\n\nåå¸å¼éçæ»ä½æè·¯å¤§åå°å¼ï¼ä»å¨å®ç°ç»èä¸ææä¸åã\n\nåå¸å¼éçä¸»è¦æè·¯å¦ä¸ï¼\n\n * äºæ¥ãå¯éå¥ - åå»ºéå¿é¡»æ¯å¯ä¸çï¼è¡¨ç°å½¢å¼ä¸ºåæ°æ®å­å¨æå¡å¨æå®¹å¨æå¥ä¸ä¸ªå¯ä¸ç keyï¼ä¸æ¦æä¸ä¸ªçº¿ç¨æå¥è¿ä¸ª keyï¼å¶ä»çº¿ç¨å°±ä¸è½åæå¥äºã\n   * ä¿è¯ key å¯ä¸æ§çæç®åçæ¹å¼æ¯ä½¿ç¨ UUIDã\n   * å­å¨éçéå¥æ¬¡æ°ï¼ä»¥ååå¸å¼ç¯å¢ä¸å¯ä¸ççº¿ç¨æ è¯ãä¸¾ä¾æ¥è¯´ï¼å¯ä»¥ä½¿ç¨ json å­å¨ç»æåæ°æ®ï¼ä¸ºäºä¿è¯å¯ä¸ï¼å¯ä»¥èèå° mac å°åï¼IP å°åãæºå¨ IDï¼ãJvm è¿ç¨ IDï¼åºç¨ IDãæå¡ IDï¼ãçº¿ç¨ ID æ¼æ¥èµ·æ¥ä½ä¸ºå¯ä¸æ è¯ã\n     \n     {"count":1,"expireAt":147506817232,"jvmPid":22224,"mac":"28-D2-44-0E-0D-9A","threadId":14}\n     \n\n * é¿åæ­»é - æ°æ®åºåå¸å¼éåç¼å­åå¸å¼éï¼Redisï¼çæè·¯é½æ¯å¼å¥è¶æ¶æºå¶ï¼å³æåç³è¯·éåï¼è¶è¿ä¸å®æ¶é´ï¼éå¤±æï¼å é¤ keyï¼ï¼åå å¨äºå®ä»¬æ æ³æç¥ç³è¯·éçå®¢æ·ç«¯èç¹ç¶æãè ZooKeeper ç±äºå¶ znode ä»¥ç®å½ãæä»¶å½¢å¼ç»ç»ï¼å¤©ç¶å°±å­å¨ç©çç©ºé´éç¦»ï¼åªè¦ znode å­å¨ï¼å³è¡¨ç¤ºå®¢æ·ç«¯èç¹è¿å¨å·¥ä½ï¼æä»¥ä¸å­å¨è¿ç§é®é¢ã\n * å®¹é - åªè¦å¤§é¨å Redis èç¹å¯ç¨ï¼å®¢æ·ç«¯å°±è½æ­£å¸¸å éã\n * èªæéè¯ - è·åä¸å°éæ¶ï¼ä¸è¦ç´æ¥è¿åå¤±è´¥ï¼èæ¯æ¯æä¸å®çå¨æèªæéè¯ï¼è®¾ç½®ä¸ä¸ªæ»çè¶æ¶æ¶é´ï¼å½è¿äºè¶æ¶æ¶é´ä»¥åè¿æ²¡æè·åå°éåè¿åå¤±è´¥ã\n\n\n# 2. æ°æ®åºåå¸å¼é\n\n\n# 2.1. æ°æ®åºåå¸å¼éåç\n\nï¼1ï¼åå»ºè¡¨\n\nCREATE TABLE `methodLock` (\n  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT \'ä¸»é®\',\n  `method_name` varchar(64) NOT NULL DEFAULT \'\' COMMENT \'éå®çæ¹æ³å\',\n  `desc` varchar(1024) NOT NULL DEFAULT \'å¤æ³¨ä¿¡æ¯\',\n  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT \'ä¿å­æ°æ®æ¶é´ï¼èªå¨çæ\',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uidx_method_name` (`method_name `) USING BTREE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT=\'éå®ä¸­çæ¹æ³\';\n\n\nï¼2ï¼è·åé\n\næ³è¦éä½æä¸ªæ¹æ³æ¶ï¼æ§è¡ä»¥ä¸ SQLï¼\n\ninsert into methodLock(method_name,desc) values (âmethod_nameâ,âdescâ)\n\n\nå ä¸ºæä»¬å¯¹ method_name åäºå¯ä¸æ§çº¦æï¼è¿éå¦ææå¤ä¸ªè¯·æ±åæ¶æäº¤å°æ°æ®åºçè¯ï¼æ°æ®åºä¼ä¿è¯åªæä¸ä¸ªæä½å¯ä»¥æåï¼é£ä¹æä»¬å°±å¯ä»¥è®¤ä¸ºæä½æåçé£ä¸ªçº¿ç¨è·å¾äºè¯¥æ¹æ³çéï¼å¯ä»¥æ§è¡æ¹æ³ä½åå®¹ã\n\næåæå¥åè·åéã\n\nï¼3ï¼éæ¾é\n\nå½æ¹æ³æ§è¡å®æ¯ä¹åï¼æ³è¦éæ¾éçè¯ï¼éè¦æ§è¡ä»¥ä¸ Sql:\n\ndelete from methodLock where method_name =\'method_name\'\n\n\n\n# 2.2. æ°æ®åºåå¸å¼éé®é¢\n\n * è¿æéå¼ºä¾èµæ°æ®åºçå¯ç¨æ§ãå¦ææ°æ®åºæ¯ä¸ä¸ªåç¹ï¼ä¸æ¦æ°æ®åºææï¼ä¼å¯¼è´ä¸å¡ç³»ç»ä¸å¯ç¨ã\n * è¿æéæ²¡æå¤±ææ¶é´ï¼ä¸æ¦è§£éæä½å¤±è´¥ï¼å°±ä¼å¯¼è´éè®°å½ä¸ç´å¨æ°æ®åºä¸­ï¼å¶ä»çº¿ç¨æ æ³åè·å¾å°éã\n * è¿æéåªè½æ¯éé»å¡çï¼å ä¸ºæ°æ®ç insert æä½ï¼ä¸æ¦æå¥å¤±è´¥å°±ä¼ç´æ¥æ¥éãæ²¡æè·å¾éççº¿ç¨å¹¶ä¸ä¼è¿å¥æééåï¼è¦æ³åæ¬¡è·å¾éå°±è¦åæ¬¡è§¦åè·å¾éæä½ã\n * è¿æéæ¯ééå¥çï¼åä¸ä¸ªçº¿ç¨å¨æ²¡æéæ¾éä¹åæ æ³åæ¬¡è·å¾è¯¥éãå ä¸ºæ°æ®ä¸­æ°æ®å·²ç»å­å¨äºã\n\nè§£å³åæ³ï¼\n\n * åç¹é®é¢å¯ä»¥ç¨å¤æ°æ®åºå®ä¾ï¼åæ¶å¡ N ä¸ªè¡¨ï¼N/2+1 ä¸ªæåå°±ä»»å¡éå®æå\n * åä¸ä¸ªå®æ¶ä»»å¡ï¼éä¸æ®µæ¶é´æ¸é¤ä¸æ¬¡è¿æçæ°æ®ã\n * åä¸ä¸ª while å¾ªç¯ï¼ä¸æ­çéè¯æå¥ï¼ç´å°æåã\n * å¨æ°æ®åºè¡¨ä¸­å ä¸ªå­æ®µï¼è®°å½å½åè·å¾éçæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯ï¼é£ä¹ä¸æ¬¡åè·åéçæ¶ååæ¥è¯¢æ°æ®åºï¼å¦æå½åæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯å¨æ°æ®åºå¯ä»¥æ¥å°çè¯ï¼ç´æ¥æéåéç»ä»å°±å¯ä»¥äºã\n\n\n# 2.3. æ°æ®åºåå¸å¼éå°ç»\n\n * ä¼ç¹: ç´æ¥åå©æ°æ®åºï¼å®¹æçè§£ã\n * ç¼ºç¹: ä¼æåç§åæ ·çé®é¢ï¼å¨è§£å³é®é¢çè¿ç¨ä¸­ä¼ä½¿æ´ä¸ªæ¹æ¡åå¾è¶æ¥è¶å¤æãæä½æ°æ®åºéè¦ä¸å®çå¼éï¼æ§è½é®é¢éè¦èèã\n\n\n# 3. Redis åå¸å¼é\n\nç¸æ¯äºç¨æ°æ®åºæ¥å®ç°åå¸å¼éï¼åºäºç¼å­å®ç°çåå¸å¼éçæ§è½ä¼æ´å¥½ãç®åæå¾å¤æççåå¸å¼äº§åï¼åæ¬ RedisãmemcacheãTair ç­ãè¿éä»¥ Redis ä¸¾ä¾ã\n\n\n# 3.1. Redis åå¸å¼éåç\n\nè¿ä¸ªåå¸å¼éæ 3 ä¸ªéè¦çèéç¹ï¼\n\n 1. äºæ¥ï¼åªè½æä¸ä¸ªå®¢æ·ç«¯è·åéï¼\n 2. ä¸è½æ­»é\n 3. å®¹éï¼åªè¦å¤§é¨å redis èç¹åå»ºäºè¿æéå°±å¯ä»¥ï¼\n\nå¯¹åºç Redis æä»¤å¦ä¸ï¼\n\n * setnx - setnx key valï¼å½ä¸ä»å½ key ä¸å­å¨æ¶ï¼set ä¸ä¸ª key ä¸º val çå­ç¬¦ä¸²ï¼è¿å 1ï¼è¥ key å­å¨ï¼åä»ä¹é½ä¸åï¼è¿å 0ã\n * expire - expire key timeoutï¼ä¸º key è®¾ç½®ä¸ä¸ªè¶æ¶æ¶é´ï¼åä½ä¸º secondï¼è¶è¿è¿ä¸ªæ¶é´éä¼èªå¨éæ¾ï¼é¿åæ­»éã\n * delete - delete keyï¼å é¤ key\n\n> æ³¨æï¼\n> \n> ä¸è¦å° setnx å expire ä½ä¸ºä¸¤ä¸ªå½ä»¤ç»åå®ç°å éï¼è¿æ ·å°±æ æ³ä¿è¯åå­æ§ãå¦æå®¢æ·ç«¯å¨ setnx ä¹åå´©æºï¼é£ä¹å°å¯¼è´éæ æ³éæ¾ãæ­£ç¡®çåæ³åºæ¯å¨ setnx å½ä»¤ä¸­æå® expire æ¶é´ã\n\n\n# 3.2. Redis åå¸å¼éå®ç°\n\nï¼1ï¼ç³è¯·é\n\nSET resource_name my_random_value NX PX 30000\n\n\næ§è¡è¿ä¸ªå½ä»¤å°± okã\n\n * NXï¼è¡¨ç¤ºåªæ key ä¸å­å¨çæ¶åæä¼è®¾ç½®æåãï¼å¦ææ­¤æ¶ redis ä¸­å­å¨è¿ä¸ª keyï¼é£ä¹è®¾ç½®å¤±è´¥ï¼è¿å nilï¼\n * PX 30000ï¼æææ¯ 30s åéèªå¨éæ¾ãå«äººåå»ºçæ¶åå¦æåç°å·²ç»æäºå°±ä¸è½å éäºã\n\nï¼2ï¼éæ¾é\n\néæ¾éå°±æ¯å é¤ key ï¼ä½æ¯ä¸è¬å¯ä»¥ç¨ lua èæ¬å é¤ï¼å¤æ­ value ä¸æ ·æå é¤ï¼\n\n-- å é¤éçæ¶åï¼æ¾å° key å¯¹åºç valueï¼è·èªå·±ä¼ è¿å»ç value åæ¯è¾ï¼å¦ææ¯ä¸æ ·çæå é¤ã\nif redis.call("get",KEYS[1]) == ARGV[1] then\n    return redis.call("del",KEYS[1])\nelse\n    return 0\nend\n\n\n\n# 3.3. æ°æ®åºåå¸å¼éå°ç»\n\nä¸ºå¥è¦ç¨ random_value éæºå¼å¢ï¼å ä¸ºå¦ææä¸ªå®¢æ·ç«¯è·åå°äºéï¼ä½æ¯é»å¡äºå¾é¿æ¶é´ææ§è¡å®ï¼æ¯å¦è¯´è¶è¿äº 30sï¼æ­¤æ¶å¯è½å·²ç»èªå¨éæ¾éäºï¼æ­¤æ¶å¯è½å«çå®¢æ·ç«¯å·²ç»è·åå°äºè¿ä¸ªéï¼è¦æ¯ä½ è¿ä¸ªæ¶åç´æ¥å é¤ key çè¯ä¼æé®é¢ï¼æä»¥å¾ç¨éæºå¼å ä¸é¢ç lua èæ¬æ¥éæ¾éã\n\nä½æ¯è¿æ ·æ¯è¯å®ä¸è¡çãå ä¸ºå¦ææ¯æ®éç redis åå®ä¾ï¼é£å°±æ¯åç¹æéãæèæ¯ redis æ®éä¸»ä»ï¼é£ redis ä¸»ä»å¼æ­¥å¤å¶ï¼å¦æä¸»èç¹æäºï¼key å°±æ²¡æäºï¼ï¼key è¿æ²¡åæ­¥å°ä»èç¹ï¼æ­¤æ¶ä»èç¹åæ¢ä¸ºä¸»èç¹ï¼å«äººå°±å¯ä»¥ set keyï¼ä»èæ¿å°éã\n\n\n# 3.4. RedLock ç®æ³\n\nè¿ä¸ªåºæ¯æ¯åè®¾æä¸ä¸ª redis clusterï¼æ 5 ä¸ª redis master å®ä¾ãç¶åæ§è¡å¦ä¸æ­¥éª¤è·åä¸æéï¼\n\n 1. è·åå½åæ¶é´æ³ï¼åä½æ¯æ¯«ç§ï¼\n 2. è·ä¸é¢ç±»ä¼¼ï¼è½®æµå°è¯å¨æ¯ä¸ª master èç¹ä¸åå»ºéï¼è¿ææ¶é´è¾ç­ï¼ä¸è¬å°±å åæ¯«ç§ï¼\n 3. å°è¯å¨å¤§å¤æ°èç¹ä¸å»ºç«ä¸ä¸ªéï¼æ¯å¦ 5 ä¸ªèç¹å°±è¦æ±æ¯ 3 ä¸ªèç¹ n / 2 + 1ï¼\n 4. å®¢æ·ç«¯è®¡ç®å»ºç«å¥½éçæ¶é´ï¼å¦æå»ºç«éçæ¶é´å°äºè¶æ¶æ¶é´ï¼å°±ç®å»ºç«æåäºï¼\n 5. è¦æ¯éå»ºç«å¤±è´¥äºï¼é£ä¹å°±ä¾æ¬¡ä¹åå»ºç«è¿çéå é¤ï¼\n 6. åªè¦å«äººå»ºç«äºä¸æåå¸å¼éï¼ä½ å°±å¾ä¸æ­è½®è¯¢å»å°è¯è·åéã\n\nRedis å®æ¹ç»åºäºä»¥ä¸ä¸¤ç§åºäº Redis å®ç°åå¸å¼éçæ¹æ³ï¼è¯¦ç»è¯´æå¯ä»¥æ¥çï¼https://redis.io/topics/distlock ã\n\n\n# 4. ZooKeeper åå¸å¼é\n\n\n# 4.1. ZooKeeper åå¸å¼éåç\n\nZooKeeper å®ç°åå¸å¼éåºäº ZooKeeper çä¸¤ä¸ªç¹æ§ï¼\n\n * é¡ºåºä¸´æ¶èç¹ï¼ZooKeeper çå­å¨ç±»ä¼¼äº DNS é£æ ·çå·æå±çº§çå½åç©ºé´ãZooKeeper èç¹ç±»åå¯ä»¥åä¸ºæä¹èç¹ï¼PERSISTENT ï¼ãä¸´æ¶èç¹ï¼EPHEMERALï¼ï¼æ¯ä¸ªèç¹è¿è½è¢«æ è®°ä¸ºæåºæ§ï¼SEQUENTIALï¼ï¼ä¸æ¦èç¹è¢«æ è®°ä¸ºæåºæ§ï¼é£ä¹æ´ä¸ªèç¹å°±å·æé¡ºåºèªå¢çç¹ç¹ã\n * Watch æºå¶ï¼ZooKeeper åè®¸ç¨æ·å¨æå®èç¹ä¸æ³¨åä¸äº Watcherï¼å¹¶ä¸å¨ç¹å®äºä»¶è§¦åçæ¶åï¼ZooKeeper æå¡ç«¯ä¼å°äºä»¶éç¥ç»ç¨æ·ã\n\nè¿ä¹æ¯ ZooKeeper å®¢æ·ç«¯ curator çåå¸å¼éå®ç°ã\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ A æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ B è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ A å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ B çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n\n# 4.2. ZooKeeper åå¸å¼éå®ç°\n\n/**\n * ZooKeeperSession\n *\n * @author bingo\n * @since 2018/11/29\n *\n */\npublic class ZooKeeperSession {\n\n    private static CountDownLatch connectedSemaphore = new CountDownLatch(1);\n\n    private ZooKeeper zookeeper;\n    private CountDownLatch latch;\n\n    public ZooKeeperSession() {\n        try {\n            this.zookeeper = new ZooKeeper("192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181", 50000, new ZooKeeperWatcher());\n            try {\n                connectedSemaphore.await();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n\n            System.out.println("ZooKeeper session established......");\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * è·ååå¸å¼é\n     *\n     * @param productId\n     */\n    public Boolean acquireDistributedLock(Long productId) {\n        String path = "/product-lock-" + productId;\n\n        try {\n            zookeeper.create(path, "".getBytes(), Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);\n            return true;\n        } catch (Exception e) {\n            while (true) {\n                try {\n                    // ç¸å½äºæ¯ç»nodeæ³¨åä¸ä¸ªçå¬å¨ï¼å»ççè¿ä¸ªçå¬å¨æ¯å¦å­å¨\n                    Stat stat = zk.exists(path, true);\n\n                    if (stat != null) {\n                        this.latch = new CountDownLatch(1);\n                        this.latch.await(waitTime, TimeUnit.MILLISECONDS);\n                        this.latch = null;\n                    }\n                    zookeeper.create(path, "".getBytes(), Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);\n                    return true;\n                } catch (Exception ee) {\n                    continue;\n                }\n            }\n\n        }\n        return true;\n    }\n\n    /**\n     * éæ¾æä¸ä¸ªåå¸å¼é\n     *\n     * @param productId\n     */\n    public void releaseDistributedLock(Long productId) {\n        String path = "/product-lock-" + productId;\n        try {\n            zookeeper.delete(path, -1);\n            System.out.println("release the lock for product[id=" + productId + "]......");\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    /**\n     * å»ºç«zk sessionçwatcher\n     *\n     * @author bingo\n     * @since 2018/11/29\n     *\n     */\n    private class ZooKeeperWatcher implements Watcher {\n\n        public void process(WatchedEvent event) {\n            System.out.println("Receive watched event: " + event.getState());\n\n            if (KeeperState.SyncConnected == event.getState()) {\n                connectedSemaphore.countDown();\n            }\n\n            if (this.latch != null) {\n                this.latch.countDown();\n            }\n        }\n\n    }\n\n    /**\n     * å°è£åä¾çéæåé¨ç±»\n     *\n     * @author bingo\n     * @since 2018/11/29\n     *\n     */\n    private static class Singleton {\n\n        private static ZooKeeperSession instance;\n\n        static {\n            instance = new ZooKeeperSession();\n        }\n\n        public static ZooKeeperSession getInstance() {\n            return instance;\n        }\n\n    }\n\n    /**\n     * è·ååä¾\n     *\n     * @return\n     */\n    public static ZooKeeperSession getInstance() {\n        return Singleton.getInstance();\n    }\n\n    /**\n     * åå§ååä¾çä¾¿æ·æ¹æ³\n     */\n    public static void init() {\n        getInstance();\n    }\n\n}\n\n\nä¹å¯ä»¥éç¨å¦ä¸ç§æ¹å¼ï¼åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n\nå¦ææä¸æéï¼è¢«å¤ä¸ªäººç»ç«äºï¼æ­¤æ¶å¤ä¸ªäººä¼æéï¼ç¬¬ä¸ä¸ªæ¿å°éçäººä¼æ§è¡ï¼ç¶åéæ¾éï¼åé¢çæ¯ä¸ªäººé½ä¼å»çå¬æå¨èªå·±åé¢çé£ä¸ªäººåå»ºç node ä¸ï¼ä¸æ¦æä¸ªäººéæ¾äºéï¼æå¨èªå·±åé¢çäººå°±ä¼è¢« zookeeper ç»éç¥ï¼ä¸æ¦è¢«éç¥äºä¹åï¼å°± ok äºï¼èªå·±å°±è·åå°äºéï¼å°±å¯ä»¥æ§è¡ä»£ç äºã\n\npublic class ZooKeeperDistributedLock implements Watcher {\n\n    private ZooKeeper zk;\n    private String locksRoot = "/locks";\n    private String productId;\n    private String waitNode;\n    private String lockNode;\n    private CountDownLatch latch;\n    private CountDownLatch connectedLatch = new CountDownLatch(1);\n    private int sessionTimeout = 30000;\n\n    public ZooKeeperDistributedLock(String productId) {\n        this.productId = productId;\n        try {\n            String address = "192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181";\n            zk = new ZooKeeper(address, sessionTimeout, this);\n            connectedLatch.await();\n        } catch (IOException e) {\n            throw new LockException(e);\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        }\n    }\n\n    public void process(WatchedEvent event) {\n        if (event.getState() == KeeperState.SyncConnected) {\n            connectedLatch.countDown();\n            return;\n        }\n\n        if (this.latch != null) {\n            this.latch.countDown();\n        }\n    }\n\n    public void acquireDistributedLock() {\n        try {\n            if (this.tryLock()) {\n                return;\n            } else {\n                waitForLock(waitNode, sessionTimeout);\n            }\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        }\n    }\n\n    public boolean tryLock() {\n        try {\n \t\t    // ä¼ å¥è¿å»çlocksRoot + â/â + productId\n\t\t    // åè®¾productIdä»£è¡¨äºä¸ä¸ªååidï¼æ¯å¦è¯´1\n\t\t    // locksRoot = locks\n\t\t    // /locks/10000000000ï¼/locks/10000000001ï¼/locks/10000000002\n            lockNode = zk.create(locksRoot + "/" + productId, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);\n\n            // ççååå»ºçèç¹æ¯ä¸æ¯æå°çèç¹\n\t \t    // locksï¼10000000000ï¼10000000001ï¼10000000002\n            List<String> locks = zk.getChildren(locksRoot, false);\n            Collections.sort(locks);\n\n            if(lockNode.equals(locksRoot+"/"+ locks.get(0))){\n                //å¦ææ¯æå°çèç¹,åè¡¨ç¤ºåå¾é\n                return true;\n            }\n\n            //å¦æä¸æ¯æå°çèç¹ï¼æ¾å°æ¯èªå·±å°1çèç¹\n\t  int previousLockIndex = -1;\n            for(int i = 0; i < locks.size(); i++) {\n\t\tif(lockNode.equals(locksRoot + â/â + locks.get(i))) {\n\t         \t    previousLockIndex = i - 1;\n\t\t    break;\n\t\t}\n\t   }\n\n\t   this.waitNode = locks.get(previousLockIndex);\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        }\n        return false;\n    }\n\n    private boolean waitForLock(String waitNode, long waitTime) throws InterruptedException, KeeperException {\n        Stat stat = zk.exists(locksRoot + "/" + waitNode, true);\n        if (stat != null) {\n            this.latch = new CountDownLatch(1);\n            this.latch.await(waitTime, TimeUnit.MILLISECONDS);\n            this.latch = null;\n        }\n        return true;\n    }\n\n    public void unlock() {\n        try {\n            // å é¤/locks/10000000000èç¹\n            // å é¤/locks/10000000001èç¹\n            System.out.println("unlock " + lockNode);\n            zk.delete(lockNode, -1);\n            lockNode = null;\n            zk.close();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } catch (KeeperException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public class LockException extends RuntimeException {\n        private static final long serialVersionUID = 1L;\n\n        public LockException(String e) {\n            super(e);\n        }\n\n        public LockException(Exception e) {\n            super(e);\n        }\n    }\n}\n\n\n\n# 4.3. ZooKeeper åå¸å¼éå°ç»\n\nZooKeeper çæ¬çåå¸å¼éé®é¢ç¸å¯¹æ¯è¾æ¥è¯´å°ã\n\n * éçå ç¨æ¶é´éå¶ï¼redis å°±æå ç¨æ¶é´éå¶ï¼è ZooKeeper åæ²¡æï¼æä¸»è¦çåå æ¯ redis ç®åæ²¡æåæ³ç¥éå·²ç»è·åéçå®¢æ·ç«¯çç¶æï¼æ¯å·²ç»æäºå¢è¿æ¯æ­£å¨æ§è¡èæ¶è¾é¿çä¸å¡é»è¾ãè ZooKeeper éè¿ä¸´æ¶èç¹å°±è½æ¸æ°ç¥éï¼å¦æä¸´æ¶èç¹å­å¨è¯´æè¿å¨æ§è¡ä¸å¡é»è¾ï¼å¦æä¸´æ¶èç¹ä¸å­å¨è¯´æå·²ç»æ§è¡å®æ¯éæ¾éæèæ¯æäºãç±æ­¤çæ¥ redis å¦æè½å ZooKeeper ä¸æ ·æ·»å ä¸äºä¸å®¢æ·ç«¯ç»å®çä¸´æ¶é®ï¼ä¹æ¯ä¸å¤§å¥½äºã\n * æ¯å¦åç¹æéï¼redis æ¬èº«æå¾å¤ä¸­ç©æ³ï¼å¦å®¢æ·ç«¯ä¸è´æ§ hashï¼æå¡å¨ç«¯ sentinel æ¹æ¡æè cluster æ¹æ¡ï¼å¾é¾åå°ä¸ç§åå¸å¼éæ¹å¼è½åºå¯¹ææè¿äºæ¹æ¡ãè ZooKeeper åªæä¸ç§ç©æ³ï¼å¤å°æºå¨çèç¹æ°æ®æ¯ä¸è´çï¼æ²¡æ redis çé£ä¹å¤çéº»ç¦å ç´ è¦èèã\n\næ»ä½ä¸æ¥è¯´ ZooKeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãä½ ZooKeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ Redis æ¹å¼ã\n\n\n# 5. åå¸å¼éæ¹æ¡å¯¹æ¯\n\næ°æ®åºåå¸å¼éï¼é®é¢æ¯è¾å¤ï¼è§£å³èµ·æ¥æ¯è¾éº»ç¦ï¼ä¸æ¨èã\n\næ§è½ï¼\n\n * Redis åå¸å¼éï¼å¶å®éè¦èªå·±ä¸æ­èªæå»å°è¯è·åéï¼æ¯è¾æ¶èæ§è½ã\n * ZooKeeper åå¸å¼éï¼è·åä¸å°éï¼æ³¨åä¸ªçå¬å¨å³å¯ï¼ä¸éè¦ä¸æ­ä¸»å¨å°è¯è·åéï¼æ§è½å¼éè¾å°ã\n\nå¯é æ§ï¼\n\n * å¦ææ¯ redis è·åéçé£ä¸ªå®¢æ·ç«¯åºç° bug æäºï¼é£ä¹åªè½ç­å¾è¶æ¶æ¶é´ä¹åæè½éæ¾éï¼\n * è zk çè¯ï¼å ä¸ºåå»ºçæ¯ä¸´æ¶ znodeï¼åªè¦å®¢æ·ç«¯æäºï¼znode å°±æ²¡äºï¼æ­¤æ¶å°±èªå¨éæ¾éã\n\nç»¼ä¸åæï¼ZooKeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãâ\n\n\n# 6. åèèµæ\n\n * åå¸å¼éå®ç°æ±æ»\n * Redis å®ç°åå¸å¼éï¼ä»¥åå¯éå¥éæè·¯',normalizedContent:'# åå¸å¼éåºæ¬åç\n\n> å¨å¹¶ååºæ¯ä¸ï¼ä¸ºäºä¿è¯å¹¶åå®å¨ï¼æä»¬å¸¸å¸¸è¦éè¿äºæ¥ï¼å éï¼ææ®µæ¥ä¿è¯æ°æ®åæ­¥å®å¨ã\n> \n> jdk è½ç¶æä¾äºå¤§ééå·¥å·ï¼ä½æ¯åªè½ä½ç¨äºåä¸ java è¿ç¨ï¼æ æ³åºç¨äºåå¸å¼ç³»ç»ãä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦ä½¿ç¨åå¸å¼éã\n> \n> åå¸å¼éçè§£å³æ¹æ¡å¤§è´æä»¥ä¸å ç§ï¼\n> \n>  * åºäºæ°æ®åºå®ç°\n>  * åºäºç¼å­ï¼redisï¼memcached ç­ï¼å®ç°\n>  * åºäº zookeeper å®ç° â\n> \n> æ³¨ï¼æ¨èåºäº zookeeper å®ç°åå¸å¼éï¼å·ä½åå çå®æ¬æå³å¯æäºã\n\n\n# 1. åå¸å¼éæè·¯\n\nåå¸å¼éçæ»ä½æè·¯å¤§åå°å¼ï¼ä»å¨å®ç°ç»èä¸ææä¸åã\n\nåå¸å¼éçä¸»è¦æè·¯å¦ä¸ï¼\n\n * äºæ¥ãå¯éå¥ - åå»ºéå¿é¡»æ¯å¯ä¸çï¼è¡¨ç°å½¢å¼ä¸ºåæ°æ®å­å¨æå¡å¨æå®¹å¨æå¥ä¸ä¸ªå¯ä¸ç keyï¼ä¸æ¦æä¸ä¸ªçº¿ç¨æå¥è¿ä¸ª keyï¼å¶ä»çº¿ç¨å°±ä¸è½åæå¥äºã\n   * ä¿è¯ key å¯ä¸æ§çæç®åçæ¹å¼æ¯ä½¿ç¨ uuidã\n   * å­å¨éçéå¥æ¬¡æ°ï¼ä»¥ååå¸å¼ç¯å¢ä¸å¯ä¸ççº¿ç¨æ è¯ãä¸¾ä¾æ¥è¯´ï¼å¯ä»¥ä½¿ç¨ json å­å¨ç»æåæ°æ®ï¼ä¸ºäºä¿è¯å¯ä¸ï¼å¯ä»¥èèå° mac å°åï¼ip å°åãæºå¨ idï¼ãjvm è¿ç¨ idï¼åºç¨ idãæå¡ idï¼ãçº¿ç¨ id æ¼æ¥èµ·æ¥ä½ä¸ºå¯ä¸æ è¯ã\n     \n     {"count":1,"expireat":147506817232,"jvmpid":22224,"mac":"28-d2-44-0e-0d-9a","threadid":14}\n     \n\n * é¿åæ­»é - æ°æ®åºåå¸å¼éåç¼å­åå¸å¼éï¼redisï¼çæè·¯é½æ¯å¼å¥è¶æ¶æºå¶ï¼å³æåç³è¯·éåï¼è¶è¿ä¸å®æ¶é´ï¼éå¤±æï¼å é¤ keyï¼ï¼åå å¨äºå®ä»¬æ æ³æç¥ç³è¯·éçå®¢æ·ç«¯èç¹ç¶æãè zookeeper ç±äºå¶ znode ä»¥ç®å½ãæä»¶å½¢å¼ç»ç»ï¼å¤©ç¶å°±å­å¨ç©çç©ºé´éç¦»ï¼åªè¦ znode å­å¨ï¼å³è¡¨ç¤ºå®¢æ·ç«¯èç¹è¿å¨å·¥ä½ï¼æä»¥ä¸å­å¨è¿ç§é®é¢ã\n * å®¹é - åªè¦å¤§é¨å redis èç¹å¯ç¨ï¼å®¢æ·ç«¯å°±è½æ­£å¸¸å éã\n * èªæéè¯ - è·åä¸å°éæ¶ï¼ä¸è¦ç´æ¥è¿åå¤±è´¥ï¼èæ¯æ¯æä¸å®çå¨æèªæéè¯ï¼è®¾ç½®ä¸ä¸ªæ»çè¶æ¶æ¶é´ï¼å½è¿äºè¶æ¶æ¶é´ä»¥åè¿æ²¡æè·åå°éåè¿åå¤±è´¥ã\n\n\n# 2. æ°æ®åºåå¸å¼é\n\n\n# 2.1. æ°æ®åºåå¸å¼éåç\n\nï¼1ï¼åå»ºè¡¨\n\ncreate table `methodlock` (\n  `id` int(11) not null auto_increment comment \'ä¸»é®\',\n  `method_name` varchar(64) not null default \'\' comment \'éå®çæ¹æ³å\',\n  `desc` varchar(1024) not null default \'å¤æ³¨ä¿¡æ¯\',\n  `update_time` timestamp not null default current_timestamp on update current_timestamp comment \'ä¿å­æ°æ®æ¶é´ï¼èªå¨çæ\',\n  primary key (`id`),\n  unique key `uidx_method_name` (`method_name `) using btree\n) engine=innodb default charset=utf8 comment=\'éå®ä¸­çæ¹æ³\';\n\n\nï¼2ï¼è·åé\n\næ³è¦éä½æä¸ªæ¹æ³æ¶ï¼æ§è¡ä»¥ä¸ sqlï¼\n\ninsert into methodlock(method_name,desc) values (âmethod_nameâ,âdescâ)\n\n\nå ä¸ºæä»¬å¯¹ method_name åäºå¯ä¸æ§çº¦æï¼è¿éå¦ææå¤ä¸ªè¯·æ±åæ¶æäº¤å°æ°æ®åºçè¯ï¼æ°æ®åºä¼ä¿è¯åªæä¸ä¸ªæä½å¯ä»¥æåï¼é£ä¹æä»¬å°±å¯ä»¥è®¤ä¸ºæä½æåçé£ä¸ªçº¿ç¨è·å¾äºè¯¥æ¹æ³çéï¼å¯ä»¥æ§è¡æ¹æ³ä½åå®¹ã\n\næåæå¥åè·åéã\n\nï¼3ï¼éæ¾é\n\nå½æ¹æ³æ§è¡å®æ¯ä¹åï¼æ³è¦éæ¾éçè¯ï¼éè¦æ§è¡ä»¥ä¸ sql:\n\ndelete from methodlock where method_name =\'method_name\'\n\n\n\n# 2.2. æ°æ®åºåå¸å¼éé®é¢\n\n * è¿æéå¼ºä¾èµæ°æ®åºçå¯ç¨æ§ãå¦ææ°æ®åºæ¯ä¸ä¸ªåç¹ï¼ä¸æ¦æ°æ®åºææï¼ä¼å¯¼è´ä¸å¡ç³»ç»ä¸å¯ç¨ã\n * è¿æéæ²¡æå¤±ææ¶é´ï¼ä¸æ¦è§£éæä½å¤±è´¥ï¼å°±ä¼å¯¼è´éè®°å½ä¸ç´å¨æ°æ®åºä¸­ï¼å¶ä»çº¿ç¨æ æ³åè·å¾å°éã\n * è¿æéåªè½æ¯éé»å¡çï¼å ä¸ºæ°æ®ç insert æä½ï¼ä¸æ¦æå¥å¤±è´¥å°±ä¼ç´æ¥æ¥éãæ²¡æè·å¾éççº¿ç¨å¹¶ä¸ä¼è¿å¥æééåï¼è¦æ³åæ¬¡è·å¾éå°±è¦åæ¬¡è§¦åè·å¾éæä½ã\n * è¿æéæ¯ééå¥çï¼åä¸ä¸ªçº¿ç¨å¨æ²¡æéæ¾éä¹åæ æ³åæ¬¡è·å¾è¯¥éãå ä¸ºæ°æ®ä¸­æ°æ®å·²ç»å­å¨äºã\n\nè§£å³åæ³ï¼\n\n * åç¹é®é¢å¯ä»¥ç¨å¤æ°æ®åºå®ä¾ï¼åæ¶å¡ n ä¸ªè¡¨ï¼n/2+1 ä¸ªæåå°±ä»»å¡éå®æå\n * åä¸ä¸ªå®æ¶ä»»å¡ï¼éä¸æ®µæ¶é´æ¸é¤ä¸æ¬¡è¿æçæ°æ®ã\n * åä¸ä¸ª while å¾ªç¯ï¼ä¸æ­çéè¯æå¥ï¼ç´å°æåã\n * å¨æ°æ®åºè¡¨ä¸­å ä¸ªå­æ®µï¼è®°å½å½åè·å¾éçæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯ï¼é£ä¹ä¸æ¬¡åè·åéçæ¶ååæ¥è¯¢æ°æ®åºï¼å¦æå½åæºå¨çä¸»æºä¿¡æ¯åçº¿ç¨ä¿¡æ¯å¨æ°æ®åºå¯ä»¥æ¥å°çè¯ï¼ç´æ¥æéåéç»ä»å°±å¯ä»¥äºã\n\n\n# 2.3. æ°æ®åºåå¸å¼éå°ç»\n\n * ä¼ç¹: ç´æ¥åå©æ°æ®åºï¼å®¹æçè§£ã\n * ç¼ºç¹: ä¼æåç§åæ ·çé®é¢ï¼å¨è§£å³é®é¢çè¿ç¨ä¸­ä¼ä½¿æ´ä¸ªæ¹æ¡åå¾è¶æ¥è¶å¤æãæä½æ°æ®åºéè¦ä¸å®çå¼éï¼æ§è½é®é¢éè¦èèã\n\n\n# 3. redis åå¸å¼é\n\nç¸æ¯äºç¨æ°æ®åºæ¥å®ç°åå¸å¼éï¼åºäºç¼å­å®ç°çåå¸å¼éçæ§è½ä¼æ´å¥½ãç®åæå¾å¤æççåå¸å¼äº§åï¼åæ¬ redisãmemcacheãtair ç­ãè¿éä»¥ redis ä¸¾ä¾ã\n\n\n# 3.1. redis åå¸å¼éåç\n\nè¿ä¸ªåå¸å¼éæ 3 ä¸ªéè¦çèéç¹ï¼\n\n 1. äºæ¥ï¼åªè½æä¸ä¸ªå®¢æ·ç«¯è·åéï¼\n 2. ä¸è½æ­»é\n 3. å®¹éï¼åªè¦å¤§é¨å redis èç¹åå»ºäºè¿æéå°±å¯ä»¥ï¼\n\nå¯¹åºç redis æä»¤å¦ä¸ï¼\n\n * setnx - setnx key valï¼å½ä¸ä»å½ key ä¸å­å¨æ¶ï¼set ä¸ä¸ª key ä¸º val çå­ç¬¦ä¸²ï¼è¿å 1ï¼è¥ key å­å¨ï¼åä»ä¹é½ä¸åï¼è¿å 0ã\n * expire - expire key timeoutï¼ä¸º key è®¾ç½®ä¸ä¸ªè¶æ¶æ¶é´ï¼åä½ä¸º secondï¼è¶è¿è¿ä¸ªæ¶é´éä¼èªå¨éæ¾ï¼é¿åæ­»éã\n * delete - delete keyï¼å é¤ key\n\n> æ³¨æï¼\n> \n> ä¸è¦å° setnx å expire ä½ä¸ºä¸¤ä¸ªå½ä»¤ç»åå®ç°å éï¼è¿æ ·å°±æ æ³ä¿è¯åå­æ§ãå¦æå®¢æ·ç«¯å¨ setnx ä¹åå´©æºï¼é£ä¹å°å¯¼è´éæ æ³éæ¾ãæ­£ç¡®çåæ³åºæ¯å¨ setnx å½ä»¤ä¸­æå® expire æ¶é´ã\n\n\n# 3.2. redis åå¸å¼éå®ç°\n\nï¼1ï¼ç³è¯·é\n\nset resource_name my_random_value nx px 30000\n\n\næ§è¡è¿ä¸ªå½ä»¤å°± okã\n\n * nxï¼è¡¨ç¤ºåªæ key ä¸å­å¨çæ¶åæä¼è®¾ç½®æåãï¼å¦ææ­¤æ¶ redis ä¸­å­å¨è¿ä¸ª keyï¼é£ä¹è®¾ç½®å¤±è´¥ï¼è¿å nilï¼\n * px 30000ï¼æææ¯ 30s åéèªå¨éæ¾ãå«äººåå»ºçæ¶åå¦æåç°å·²ç»æäºå°±ä¸è½å éäºã\n\nï¼2ï¼éæ¾é\n\néæ¾éå°±æ¯å é¤ key ï¼ä½æ¯ä¸è¬å¯ä»¥ç¨ lua èæ¬å é¤ï¼å¤æ­ value ä¸æ ·æå é¤ï¼\n\n-- å é¤éçæ¶åï¼æ¾å° key å¯¹åºç valueï¼è·èªå·±ä¼ è¿å»ç value åæ¯è¾ï¼å¦ææ¯ä¸æ ·çæå é¤ã\nif redis.call("get",keys[1]) == argv[1] then\n    return redis.call("del",keys[1])\nelse\n    return 0\nend\n\n\n\n# 3.3. æ°æ®åºåå¸å¼éå°ç»\n\nä¸ºå¥è¦ç¨ random_value éæºå¼å¢ï¼å ä¸ºå¦ææä¸ªå®¢æ·ç«¯è·åå°äºéï¼ä½æ¯é»å¡äºå¾é¿æ¶é´ææ§è¡å®ï¼æ¯å¦è¯´è¶è¿äº 30sï¼æ­¤æ¶å¯è½å·²ç»èªå¨éæ¾éäºï¼æ­¤æ¶å¯è½å«çå®¢æ·ç«¯å·²ç»è·åå°äºè¿ä¸ªéï¼è¦æ¯ä½ è¿ä¸ªæ¶åç´æ¥å é¤ key çè¯ä¼æé®é¢ï¼æä»¥å¾ç¨éæºå¼å ä¸é¢ç lua èæ¬æ¥éæ¾éã\n\nä½æ¯è¿æ ·æ¯è¯å®ä¸è¡çãå ä¸ºå¦ææ¯æ®éç redis åå®ä¾ï¼é£å°±æ¯åç¹æéãæèæ¯ redis æ®éä¸»ä»ï¼é£ redis ä¸»ä»å¼æ­¥å¤å¶ï¼å¦æä¸»èç¹æäºï¼key å°±æ²¡æäºï¼ï¼key è¿æ²¡åæ­¥å°ä»èç¹ï¼æ­¤æ¶ä»èç¹åæ¢ä¸ºä¸»èç¹ï¼å«äººå°±å¯ä»¥ set keyï¼ä»èæ¿å°éã\n\n\n# 3.4. redlock ç®æ³\n\nè¿ä¸ªåºæ¯æ¯åè®¾æä¸ä¸ª redis clusterï¼æ 5 ä¸ª redis master å®ä¾ãç¶åæ§è¡å¦ä¸æ­¥éª¤è·åä¸æéï¼\n\n 1. è·åå½åæ¶é´æ³ï¼åä½æ¯æ¯«ç§ï¼\n 2. è·ä¸é¢ç±»ä¼¼ï¼è½®æµå°è¯å¨æ¯ä¸ª master èç¹ä¸åå»ºéï¼è¿ææ¶é´è¾ç­ï¼ä¸è¬å°±å åæ¯«ç§ï¼\n 3. å°è¯å¨å¤§å¤æ°èç¹ä¸å»ºç«ä¸ä¸ªéï¼æ¯å¦ 5 ä¸ªèç¹å°±è¦æ±æ¯ 3 ä¸ªèç¹ n / 2 + 1ï¼\n 4. å®¢æ·ç«¯è®¡ç®å»ºç«å¥½éçæ¶é´ï¼å¦æå»ºç«éçæ¶é´å°äºè¶æ¶æ¶é´ï¼å°±ç®å»ºç«æåäºï¼\n 5. è¦æ¯éå»ºç«å¤±è´¥äºï¼é£ä¹å°±ä¾æ¬¡ä¹åå»ºç«è¿çéå é¤ï¼\n 6. åªè¦å«äººå»ºç«äºä¸æåå¸å¼éï¼ä½ å°±å¾ä¸æ­è½®è¯¢å»å°è¯è·åéã\n\nredis å®æ¹ç»åºäºä»¥ä¸ä¸¤ç§åºäº redis å®ç°åå¸å¼éçæ¹æ³ï¼è¯¦ç»è¯´æå¯ä»¥æ¥çï¼https://redis.io/topics/distlock ã\n\n\n# 4. zookeeper åå¸å¼é\n\n\n# 4.1. zookeeper åå¸å¼éåç\n\nzookeeper å®ç°åå¸å¼éåºäº zookeeper çä¸¤ä¸ªç¹æ§ï¼\n\n * é¡ºåºä¸´æ¶èç¹ï¼zookeeper çå­å¨ç±»ä¼¼äº dns é£æ ·çå·æå±çº§çå½åç©ºé´ãzookeeper èç¹ç±»åå¯ä»¥åä¸ºæä¹èç¹ï¼persistent ï¼ãä¸´æ¶èç¹ï¼ephemeralï¼ï¼æ¯ä¸ªèç¹è¿è½è¢«æ è®°ä¸ºæåºæ§ï¼sequentialï¼ï¼ä¸æ¦èç¹è¢«æ è®°ä¸ºæåºæ§ï¼é£ä¹æ´ä¸ªèç¹å°±å·æé¡ºåºèªå¢çç¹ç¹ã\n * watch æºå¶ï¼zookeeper åè®¸ç¨æ·å¨æå®èç¹ä¸æ³¨åä¸äº watcherï¼å¹¶ä¸å¨ç¹å®äºä»¶è§¦åçæ¶åï¼zookeeper æå¡ç«¯ä¼å°äºä»¶éç¥ç»ç¨æ·ã\n\nè¿ä¹æ¯ zookeeper å®¢æ·ç«¯ curator çåå¸å¼éå®ç°ã\n\n 1. åå»ºä¸ä¸ªç®å½ mylockï¼\n 2. çº¿ç¨ a æ³è·åéå°±å¨ mylock ç®å½ä¸åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n 3. è·å mylock ç®å½ä¸ææçå­èç¹ï¼ç¶åè·åæ¯èªå·±å°çåå¼èç¹ï¼å¦æä¸å­å¨ï¼åè¯´æå½åçº¿ç¨é¡ºåºå·æå°ï¼è·å¾éï¼\n 4. çº¿ç¨ b è·åææèç¹ï¼å¤æ­èªå·±ä¸æ¯æå°èç¹ï¼è®¾ç½®çå¬æ¯èªå·±æ¬¡å°çèç¹ï¼\n 5. çº¿ç¨ a å¤çå®ï¼å é¤èªå·±çèç¹ï¼çº¿ç¨ b çå¬å°åæ´äºä»¶ï¼å¤æ­èªå·±æ¯ä¸æ¯æå°çèç¹ï¼å¦ææ¯åè·å¾éã\n\n\n# 4.2. zookeeper åå¸å¼éå®ç°\n\n/**\n * zookeepersession\n *\n * @author bingo\n * @since 2018/11/29\n *\n */\npublic class zookeepersession {\n\n    private static countdownlatch connectedsemaphore = new countdownlatch(1);\n\n    private zookeeper zookeeper;\n    private countdownlatch latch;\n\n    public zookeepersession() {\n        try {\n            this.zookeeper = new zookeeper("192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181", 50000, new zookeeperwatcher());\n            try {\n                connectedsemaphore.await();\n            } catch (interruptedexception e) {\n                e.printstacktrace();\n            }\n\n            system.out.println("zookeeper session established......");\n        } catch (exception e) {\n            e.printstacktrace();\n        }\n    }\n\n    /**\n     * è·ååå¸å¼é\n     *\n     * @param productid\n     */\n    public boolean acquiredistributedlock(long productid) {\n        string path = "/product-lock-" + productid;\n\n        try {\n            zookeeper.create(path, "".getbytes(), ids.open_acl_unsafe, createmode.ephemeral);\n            return true;\n        } catch (exception e) {\n            while (true) {\n                try {\n                    // ç¸å½äºæ¯ç»nodeæ³¨åä¸ä¸ªçå¬å¨ï¼å»ççè¿ä¸ªçå¬å¨æ¯å¦å­å¨\n                    stat stat = zk.exists(path, true);\n\n                    if (stat != null) {\n                        this.latch = new countdownlatch(1);\n                        this.latch.await(waittime, timeunit.milliseconds);\n                        this.latch = null;\n                    }\n                    zookeeper.create(path, "".getbytes(), ids.open_acl_unsafe, createmode.ephemeral);\n                    return true;\n                } catch (exception ee) {\n                    continue;\n                }\n            }\n\n        }\n        return true;\n    }\n\n    /**\n     * éæ¾æä¸ä¸ªåå¸å¼é\n     *\n     * @param productid\n     */\n    public void releasedistributedlock(long productid) {\n        string path = "/product-lock-" + productid;\n        try {\n            zookeeper.delete(path, -1);\n            system.out.println("release the lock for product[id=" + productid + "]......");\n        } catch (exception e) {\n            e.printstacktrace();\n        }\n    }\n\n    /**\n     * å»ºç«zk sessionçwatcher\n     *\n     * @author bingo\n     * @since 2018/11/29\n     *\n     */\n    private class zookeeperwatcher implements watcher {\n\n        public void process(watchedevent event) {\n            system.out.println("receive watched event: " + event.getstate());\n\n            if (keeperstate.syncconnected == event.getstate()) {\n                connectedsemaphore.countdown();\n            }\n\n            if (this.latch != null) {\n                this.latch.countdown();\n            }\n        }\n\n    }\n\n    /**\n     * å°è£åä¾çéæåé¨ç±»\n     *\n     * @author bingo\n     * @since 2018/11/29\n     *\n     */\n    private static class singleton {\n\n        private static zookeepersession instance;\n\n        static {\n            instance = new zookeepersession();\n        }\n\n        public static zookeepersession getinstance() {\n            return instance;\n        }\n\n    }\n\n    /**\n     * è·ååä¾\n     *\n     * @return\n     */\n    public static zookeepersession getinstance() {\n        return singleton.getinstance();\n    }\n\n    /**\n     * åå§ååä¾çä¾¿æ·æ¹æ³\n     */\n    public static void init() {\n        getinstance();\n    }\n\n}\n\n\nä¹å¯ä»¥éç¨å¦ä¸ç§æ¹å¼ï¼åå»ºä¸´æ¶é¡ºåºèç¹ï¼\n\nå¦ææä¸æéï¼è¢«å¤ä¸ªäººç»ç«äºï¼æ­¤æ¶å¤ä¸ªäººä¼æéï¼ç¬¬ä¸ä¸ªæ¿å°éçäººä¼æ§è¡ï¼ç¶åéæ¾éï¼åé¢çæ¯ä¸ªäººé½ä¼å»çå¬æå¨èªå·±åé¢çé£ä¸ªäººåå»ºç node ä¸ï¼ä¸æ¦æä¸ªäººéæ¾äºéï¼æå¨èªå·±åé¢çäººå°±ä¼è¢« zookeeper ç»éç¥ï¼ä¸æ¦è¢«éç¥äºä¹åï¼å°± ok äºï¼èªå·±å°±è·åå°äºéï¼å°±å¯ä»¥æ§è¡ä»£ç äºã\n\npublic class zookeeperdistributedlock implements watcher {\n\n    private zookeeper zk;\n    private string locksroot = "/locks";\n    private string productid;\n    private string waitnode;\n    private string locknode;\n    private countdownlatch latch;\n    private countdownlatch connectedlatch = new countdownlatch(1);\n    private int sessiontimeout = 30000;\n\n    public zookeeperdistributedlock(string productid) {\n        this.productid = productid;\n        try {\n            string address = "192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181";\n            zk = new zookeeper(address, sessiontimeout, this);\n            connectedlatch.await();\n        } catch (ioexception e) {\n            throw new lockexception(e);\n        } catch (keeperexception e) {\n            throw new lockexception(e);\n        } catch (interruptedexception e) {\n            throw new lockexception(e);\n        }\n    }\n\n    public void process(watchedevent event) {\n        if (event.getstate() == keeperstate.syncconnected) {\n            connectedlatch.countdown();\n            return;\n        }\n\n        if (this.latch != null) {\n            this.latch.countdown();\n        }\n    }\n\n    public void acquiredistributedlock() {\n        try {\n            if (this.trylock()) {\n                return;\n            } else {\n                waitforlock(waitnode, sessiontimeout);\n            }\n        } catch (keeperexception e) {\n            throw new lockexception(e);\n        } catch (interruptedexception e) {\n            throw new lockexception(e);\n        }\n    }\n\n    public boolean trylock() {\n        try {\n \t\t    // ä¼ å¥è¿å»çlocksroot + â/â + productid\n\t\t    // åè®¾productidä»£è¡¨äºä¸ä¸ªååidï¼æ¯å¦è¯´1\n\t\t    // locksroot = locks\n\t\t    // /locks/10000000000ï¼/locks/10000000001ï¼/locks/10000000002\n            locknode = zk.create(locksroot + "/" + productid, new byte[0], zoodefs.ids.open_acl_unsafe, createmode.ephemeral_sequential);\n\n            // ççååå»ºçèç¹æ¯ä¸æ¯æå°çèç¹\n\t \t    // locksï¼10000000000ï¼10000000001ï¼10000000002\n            list<string> locks = zk.getchildren(locksroot, false);\n            collections.sort(locks);\n\n            if(locknode.equals(locksroot+"/"+ locks.get(0))){\n                //å¦ææ¯æå°çèç¹,åè¡¨ç¤ºåå¾é\n                return true;\n            }\n\n            //å¦æä¸æ¯æå°çèç¹ï¼æ¾å°æ¯èªå·±å°1çèç¹\n\t  int previouslockindex = -1;\n            for(int i = 0; i < locks.size(); i++) {\n\t\tif(locknode.equals(locksroot + â/â + locks.get(i))) {\n\t         \t    previouslockindex = i - 1;\n\t\t    break;\n\t\t}\n\t   }\n\n\t   this.waitnode = locks.get(previouslockindex);\n        } catch (keeperexception e) {\n            throw new lockexception(e);\n        } catch (interruptedexception e) {\n            throw new lockexception(e);\n        }\n        return false;\n    }\n\n    private boolean waitforlock(string waitnode, long waittime) throws interruptedexception, keeperexception {\n        stat stat = zk.exists(locksroot + "/" + waitnode, true);\n        if (stat != null) {\n            this.latch = new countdownlatch(1);\n            this.latch.await(waittime, timeunit.milliseconds);\n            this.latch = null;\n        }\n        return true;\n    }\n\n    public void unlock() {\n        try {\n            // å é¤/locks/10000000000èç¹\n            // å é¤/locks/10000000001èç¹\n            system.out.println("unlock " + locknode);\n            zk.delete(locknode, -1);\n            locknode = null;\n            zk.close();\n        } catch (interruptedexception e) {\n            e.printstacktrace();\n        } catch (keeperexception e) {\n            e.printstacktrace();\n        }\n    }\n\n    public class lockexception extends runtimeexception {\n        private static final long serialversionuid = 1l;\n\n        public lockexception(string e) {\n            super(e);\n        }\n\n        public lockexception(exception e) {\n            super(e);\n        }\n    }\n}\n\n\n\n# 4.3. zookeeper åå¸å¼éå°ç»\n\nzookeeper çæ¬çåå¸å¼éé®é¢ç¸å¯¹æ¯è¾æ¥è¯´å°ã\n\n * éçå ç¨æ¶é´éå¶ï¼redis å°±æå ç¨æ¶é´éå¶ï¼è zookeeper åæ²¡æï¼æä¸»è¦çåå æ¯ redis ç®åæ²¡æåæ³ç¥éå·²ç»è·åéçå®¢æ·ç«¯çç¶æï¼æ¯å·²ç»æäºå¢è¿æ¯æ­£å¨æ§è¡èæ¶è¾é¿çä¸å¡é»è¾ãè zookeeper éè¿ä¸´æ¶èç¹å°±è½æ¸æ°ç¥éï¼å¦æä¸´æ¶èç¹å­å¨è¯´æè¿å¨æ§è¡ä¸å¡é»è¾ï¼å¦æä¸´æ¶èç¹ä¸å­å¨è¯´æå·²ç»æ§è¡å®æ¯éæ¾éæèæ¯æäºãç±æ­¤çæ¥ redis å¦æè½å zookeeper ä¸æ ·æ·»å ä¸äºä¸å®¢æ·ç«¯ç»å®çä¸´æ¶é®ï¼ä¹æ¯ä¸å¤§å¥½äºã\n * æ¯å¦åç¹æéï¼redis æ¬èº«æå¾å¤ä¸­ç©æ³ï¼å¦å®¢æ·ç«¯ä¸è´æ§ hashï¼æå¡å¨ç«¯ sentinel æ¹æ¡æè cluster æ¹æ¡ï¼å¾é¾åå°ä¸ç§åå¸å¼éæ¹å¼è½åºå¯¹ææè¿äºæ¹æ¡ãè zookeeper åªæä¸ç§ç©æ³ï¼å¤å°æºå¨çèç¹æ°æ®æ¯ä¸è´çï¼æ²¡æ redis çé£ä¹å¤çéº»ç¦å ç´ è¦èèã\n\næ»ä½ä¸æ¥è¯´ zookeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãä½ zookeeper å ä¸ºéè¦é¢ç¹çåå»ºåå é¤èç¹ï¼æ§è½ä¸ä¸å¦ redis æ¹å¼ã\n\n\n# 5. åå¸å¼éæ¹æ¡å¯¹æ¯\n\næ°æ®åºåå¸å¼éï¼é®é¢æ¯è¾å¤ï¼è§£å³èµ·æ¥æ¯è¾éº»ç¦ï¼ä¸æ¨èã\n\næ§è½ï¼\n\n * redis åå¸å¼éï¼å¶å®éè¦èªå·±ä¸æ­èªæå»å°è¯è·åéï¼æ¯è¾æ¶èæ§è½ã\n * zookeeper åå¸å¼éï¼è·åä¸å°éï¼æ³¨åä¸ªçå¬å¨å³å¯ï¼ä¸éè¦ä¸æ­ä¸»å¨å°è¯è·åéï¼æ§è½å¼éè¾å°ã\n\nå¯é æ§ï¼\n\n * å¦ææ¯ redis è·åéçé£ä¸ªå®¢æ·ç«¯åºç° bug æäºï¼é£ä¹åªè½ç­å¾è¶æ¶æ¶é´ä¹åæè½éæ¾éï¼\n * è zk çè¯ï¼å ä¸ºåå»ºçæ¯ä¸´æ¶ znodeï¼åªè¦å®¢æ·ç«¯æäºï¼znode å°±æ²¡äºï¼æ­¤æ¶å°±èªå¨éæ¾éã\n\nç»¼ä¸åæï¼zookeeper å®ç°åå¸å¼éæ´å çç®åï¼å¯é æ§æ´é«ãâ\n\n\n# 6. åèèµæ\n\n * åå¸å¼éå®ç°æ±æ»\n * redis å®ç°åå¸å¼éï¼ä»¥åå¯éå¥éæè·¯',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ¶æ¯éååºæ¬åç",frontmatter:{title:"æ¶æ¯éååºæ¬åç",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","éä¿¡"],tags:["åå¸å¼","éä¿¡","æ¶æ¯éå"],abbrlink:"2d0902c8",date:"2019-07-05T15:11:00.000Z",permalink:"/pages/4bba35/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/04.%E9%80%9A%E4%BF%A1/01.%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/04.éä¿¡/01.æ¶æ¯éå.md",key:"v-30f4df2d",path:"/pages/4bba35/",headers:[{level:2,title:"1. MQ çç®ä»",slug:"_1-mq-çç®ä»",normalizedTitle:"1. mq çç®ä»",charIndex:281},{level:3,title:"1.1. ä»ä¹æ¯ MQ",slug:"_1-1-ä»ä¹æ¯-mq",normalizedTitle:"1.1. ä»ä¹æ¯ mq",charIndex:295},{level:3,title:"1.2. MQ éä¿¡æ¨¡å",slug:"_1-2-mq-éä¿¡æ¨¡å",normalizedTitle:"1.2. mq éä¿¡æ¨¡å",charIndex:748},{level:2,title:"2. MQ çåºç¨",slug:"_2-mq-çåºç¨",normalizedTitle:"2. mq çåºç¨",charIndex:1517},{level:3,title:"2.1. å¼æ­¥å¤ç",slug:"_2-1-å¼æ­¥å¤ç",normalizedTitle:"2.1. å¼æ­¥å¤ç",charIndex:1531},{level:3,title:"2.2. ç³»ç»è§£è¦",slug:"_2-2-ç³»ç»è§£è¦",normalizedTitle:"2.2. ç³»ç»è§£è¦",charIndex:1967},{level:3,title:"2.3. æµéåå³°",slug:"_2-3-æµéåå³°",normalizedTitle:"2.3. æµéåå³°",charIndex:2298},{level:3,title:"2.4. ä¼ è¾ç¼å²",slug:"_2-4-ä¼ è¾ç¼å²",normalizedTitle:"2.4. ä¼ è¾ç¼å²",charIndex:2855},{level:3,title:"2.5. æç»ä¸è´æ§",slug:"_2-5-æç»ä¸è´æ§",normalizedTitle:"2.5. æç»ä¸è´æ§",charIndex:3181},{level:3,title:"2.6. ç³»ç»é´éä¿¡",slug:"_2-6-ç³»ç»é´éä¿¡",normalizedTitle:"2.6. ç³»ç»é´éä¿¡",charIndex:3444},{level:2,title:"3. MQ çé®é¢",slug:"_3-mq-çé®é¢",normalizedTitle:"3. mq çé®é¢",charIndex:3586},{level:3,title:"3.1. éå¤æ¶è´¹",slug:"_3-1-éå¤æ¶è´¹",normalizedTitle:"3.1. éå¤æ¶è´¹",charIndex:3951},{level:4,title:"éå¤æ¶è´¹é®é¢åå ",slug:"éå¤æ¶è´¹é®é¢åå ",normalizedTitle:"éå¤æ¶è´¹é®é¢åå ",charIndex:4025},{level:4,title:"éå¤æ¶è´¹è§£å³æ¹æ¡",slug:"éå¤æ¶è´¹è§£å³æ¹æ¡",normalizedTitle:"éå¤æ¶è´¹è§£å³æ¹æ¡",charIndex:4375},{level:3,title:"3.2. æ¶æ¯ä¸¢å¤±",slug:"_3-2-æ¶æ¯ä¸¢å¤±",normalizedTitle:"3.2. æ¶æ¯ä¸¢å¤±",charIndex:4714},{level:4,title:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",slug:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",normalizedTitle:"æ¶è´¹æ¹ä¸¢å¤±æ°æ®",charIndex:4787},{level:4,title:"Kafka Server ä¸¢å¤±æ°æ®",slug:"kafka-server-ä¸¢å¤±æ°æ®",normalizedTitle:"kafka server ä¸¢å¤±æ°æ®",charIndex:5022},{level:4,title:"çäº§æ¹ä¸¢å¤±æ°æ®",slug:"çäº§æ¹ä¸¢å¤±æ°æ®",normalizedTitle:"çäº§æ¹ä¸¢å¤±æ°æ®",charIndex:4798},{level:3,title:"3.3. æ¶æ¯çé¡ºåºæ§",slug:"_3-3-æ¶æ¯çé¡ºåºæ§",normalizedTitle:"3.3. æ¶æ¯çé¡ºåºæ§",charIndex:5649},{level:3,title:"3.4. æ¶æ¯ç§¯å",slug:"_3-4-æ¶æ¯ç§¯å",normalizedTitle:"3.4. æ¶æ¯ç§¯å",charIndex:6066},{level:2,title:"4. MQ çé«å¯ç¨",slug:"_4-mq-çé«å¯ç¨",normalizedTitle:"4. mq çé«å¯ç¨",charIndex:6624},{level:3,title:"4.1. Kafka çé«å¯ç¨",slug:"_4-1-kafka-çé«å¯ç¨",normalizedTitle:"4.1. kafka çé«å¯ç¨",charIndex:6692},{level:4,title:"Kafka çæ ¸å¿æ¦å¿µ",slug:"kafka-çæ ¸å¿æ¦å¿µ",normalizedTitle:"kafka çæ ¸å¿æ¦å¿µ",charIndex:6711},{level:4,title:"Kafka çå¯æ¬æºå¶",slug:"kafka-çå¯æ¬æºå¶",normalizedTitle:"kafka çå¯æ¬æºå¶",charIndex:7188},{level:4,title:"Kafka éä¸¾ Leader",slug:"kafka-éä¸¾-leader",normalizedTitle:"kafka éä¸¾ leader",charIndex:7849},{level:2,title:"5. ä¸»æµ MQ",slug:"_5-ä¸»æµ-mq",normalizedTitle:"5. ä¸»æµ mq",charIndex:7979},{level:3,title:"5.1. ActiveMQ",slug:"_5-1-activemq",normalizedTitle:"5.1. activemq",charIndex:7992},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8142},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8785},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹",normalizedTitle:"(c) ä¼ç¹",charIndex:8874},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹",normalizedTitle:"(d) ç¼ºç¹",charIndex:9264},{level:3,title:"5.2. RabbitMQ",slug:"_5-2-rabbitmq",normalizedTitle:"5.2. rabbitmq",charIndex:9401},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-2",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8142},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-2",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8785},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-2",normalizedTitle:"(c) ä¼ç¹",charIndex:8874},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-2",normalizedTitle:"(d) ç¼ºç¹",charIndex:9264},{level:3,title:"5.3. RocketMQ",slug:"_5-3-rocketmq",normalizedTitle:"5.3. rocketmq",charIndex:10527},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-3",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8142},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-3",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8785},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-3",normalizedTitle:"(c) ä¼ç¹",charIndex:8874},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-3",normalizedTitle:"(d) ç¼ºç¹",charIndex:9264},{level:3,title:"5.4. Kafka",slug:"_5-4-kafka",normalizedTitle:"5.4. kafka",charIndex:11585},{level:4,title:"(a) ä¸»è¦ç¹æ§",slug:"a-ä¸»è¦ç¹æ§-4",normalizedTitle:"(a) ä¸»è¦ç¹æ§",charIndex:8142},{level:4,title:"(b) é¨ç½²ç¯å¢",slug:"b-é¨ç½²ç¯å¢-4",normalizedTitle:"(b) é¨ç½²ç¯å¢",charIndex:8785},{level:4,title:"(c) ä¼ç¹",slug:"c-ä¼ç¹-4",normalizedTitle:"(c) ä¼ç¹",charIndex:8874},{level:4,title:"(d) ç¼ºç¹",slug:"d-ç¼ºç¹-4",normalizedTitle:"(d) ç¼ºç¹",charIndex:9264},{level:3,title:"5.5. MQ çææ¯éå",slug:"_5-5-mq-çææ¯éå",normalizedTitle:"5.5. mq çææ¯éå",charIndex:12631},{level:2,title:"6. JMS",slug:"_6-jms",normalizedTitle:"6. jms",charIndex:14441},{level:3,title:"6.1. æ¶æ¯æ¨¡å",slug:"_6-1-æ¶æ¯æ¨¡å",normalizedTitle:"6.1. æ¶æ¯æ¨¡å",charIndex:14664},{level:4,title:"P2P æ¨¡å¼",slug:"p2p-æ¨¡å¼",normalizedTitle:"p2p æ¨¡å¼",charIndex:14751},{level:4,title:"Pub/sub æ¨¡å¼",slug:"pub-sub-æ¨¡å¼",normalizedTitle:"pub/sub æ¨¡å¼",charIndex:15041},{level:3,title:"6.2. æ¶æ¯æ¶è´¹",slug:"_6-2-æ¶æ¯æ¶è´¹",normalizedTitle:"6.2. æ¶æ¯æ¶è´¹",charIndex:15394},{level:3,title:"6.3. JMS ç¼ç¨æ¨¡å",slug:"_6-3-jms-ç¼ç¨æ¨¡å",normalizedTitle:"6.3. jms ç¼ç¨æ¨¡å",charIndex:15727},{level:4,title:"ConnectionFactory",slug:"connectionfactory",normalizedTitle:"connectionfactory",charIndex:15744},{level:4,title:"Destination",slug:"destination",normalizedTitle:"destination",charIndex:914},{level:4,title:"Connection",slug:"connection",normalizedTitle:"connection",charIndex:15744},{level:4,title:"Session",slug:"session",normalizedTitle:"session",charIndex:16200},{level:4,title:"æ¶æ¯ççäº§è",slug:"æ¶æ¯ççäº§è",normalizedTitle:"æ¶æ¯ççäº§è",charIndex:16440},{level:4,title:"æ¶æ¯æ¶è´¹è",slug:"æ¶æ¯æ¶è´¹è",normalizedTitle:"æ¶æ¯æ¶è´¹è",charIndex:15938},{level:4,title:"MessageListener",slug:"messagelistener",normalizedTitle:"messagelistener",charIndex:16781},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:16902}],headersStr:"1. MQ çç®ä» 1.1. ä»ä¹æ¯ MQ 1.2. MQ éä¿¡æ¨¡å 2. MQ çåºç¨ 2.1. å¼æ­¥å¤ç 2.2. ç³»ç»è§£è¦ 2.3. æµéåå³° 2.4. ä¼ è¾ç¼å² 2.5. æç»ä¸è´æ§ 2.6. ç³»ç»é´éä¿¡ 3. MQ çé®é¢ 3.1. éå¤æ¶è´¹ éå¤æ¶è´¹é®é¢åå  éå¤æ¶è´¹è§£å³æ¹æ¡ 3.2. æ¶æ¯ä¸¢å¤± æ¶è´¹æ¹ä¸¢å¤±æ°æ® Kafka Server ä¸¢å¤±æ°æ® çäº§æ¹ä¸¢å¤±æ°æ® 3.3. æ¶æ¯çé¡ºåºæ§ 3.4. æ¶æ¯ç§¯å 4. MQ çé«å¯ç¨ 4.1. Kafka çé«å¯ç¨ Kafka çæ ¸å¿æ¦å¿µ Kafka çå¯æ¬æºå¶ Kafka éä¸¾ Leader 5. ä¸»æµ MQ 5.1. ActiveMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ 5.2. RabbitMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ 5.3. RocketMQ (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ 5.4. Kafka (a) ä¸»è¦ç¹æ§ (b) é¨ç½²ç¯å¢ (c) ä¼ç¹ (d) ç¼ºç¹ 5.5. MQ çææ¯éå 6. JMS 6.1. æ¶æ¯æ¨¡å P2P æ¨¡å¼ Pub/sub æ¨¡å¼ 6.2. æ¶æ¯æ¶è´¹ 6.3. JMS ç¼ç¨æ¨¡å ConnectionFactory Destination Connection Session æ¶æ¯ççäº§è æ¶æ¯æ¶è´¹è MessageListener 7. åèèµæ",content:'# æ¶æ¯éååºæ¬åç\n\n> ð¦ æ¬æå·²å½æ¡£å°ï¼ãblogã\n> \n> æ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³å¼æ­¥å¤çãåºç¨é´è¦åï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> ç®åä¸»æµç MQ æï¼KafkaãRabbitMQãRocketMQãActiveMQï¼èé¨åæ°æ®åºå¦ RedisãMySQL ä»¥å phxsql ä¹å¯å®ç°æ¶æ¯éåçåè½ã\n> \n> æ³¨æï¼ä¸ºäºç®ä¾¿ï¼ä¸æä¸­é¤äºæç« æ é¢ï¼ä¸å¾ä½¿ç¨ MQ ç®ç§°ã\n\n\n# 1. MQ çç®ä»\n\n\n# 1.1. ä»ä¹æ¯ MQ\n\næ¶æ¯éåï¼Message Queueï¼ç®ç§° MQï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n\næ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n\nMQ æ¯æ¶è´¹-çäº§èæ¨¡åçä¸ä¸ªå¸åçä»£è¡¨ï¼ä¸ç«¯å¾æ¶æ¯éåä¸­ä¸æ­åå¥æ¶æ¯ï¼èå¦ä¸ç«¯åå¯ä»¥è¯»åéåä¸­çæ¶æ¯ãæ¶æ¯åå¸èåªç®¡ææ¶æ¯åå¸å° MQ ä¸­èä¸ç¨ç®¡è°æ¥åï¼æ¶æ¯ä½¿ç¨èåªç®¡ä» MQ ä¸­åæ¶æ¯èä¸ç®¡æ¯è°åå¸çãè¿æ ·åå¸èåä½¿ç¨èé½ä¸ç¨ç¥éå¯¹æ¹çå­å¨ã\n\nMQ çæ°æ®å¯é©»çå¨åå­æç£çä¸ï¼ç´å°å®ä»¬è¢«åºç¨ç¨åºè¯»åãéè¿ MQï¼åºç¨ç¨åºå¯ç¬ç«å°æ§è¡ï¼å®ä»¬ä¸éè¦ç¥éå½¼æ­¤çä½ç½®ï¼ä¸éè¦ç­å¾æ¥æ¶ç¨åºæ¥æ¶æ­¤æ¶æ¯ãå¨åå¸å¼è®¡ç®ç¯å¢ä¸­ï¼ä¸ºäºéæåå¸å¼åºç¨ï¼å¼åèéè¦å¯¹å¼æç½ç»ç¯å¢ä¸çåå¸å¼åºç¨æä¾ææçéä¿¡ææ®µãä¸ºäºç®¡çéè¦å±äº«çä¿¡æ¯ï¼å¯¹åºç¨æä¾å¬å±çä¿¡æ¯äº¤æ¢æºå¶æ¯éè¦çã\n\nç®åä¸»æµç MQ æï¼KafkaãRabbitMQãRocketMQãActiveMQã\n\n\n# 1.2. MQ éä¿¡æ¨¡å\n\nMQ éä¿¡æ¨¡åå¤§è´æä»¥ä¸ç±»åï¼\n\n * ç¹å¯¹ç¹ - ç¹å¯¹ç¹æ¹å¼æ¯æä¸ºä¼ ç»åå¸¸è§çéè®¯æ¹å¼ï¼å®æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹å¤ãå¤å¯¹ä¸ç­å¤ç§éç½®æ¹å¼ï¼æ¯ææ ç¶ãç½ç¶ç­å¤ç§ææç»æã\n * å¤ç¹å¹¿æ­ - MQ éç¨äºä¸åç±»åçåºç¨ãå¶ä¸­éè¦çï¼ä¹æ¯æ­£å¨åå±ä¸­çæ¯"å¤ç¹å¹¿æ­"åºç¨ï¼å³è½å¤å°æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ (Destination List)ãå¯ä»¥ä½¿ç¨ä¸æ¡ MQ æä»¤å°åä¸æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ï¼å¹¶ç¡®ä¿ä¸ºæ¯ä¸ç«ç¹å¯é å°æä¾ä¿¡æ¯ãMQ ä¸ä»æä¾äºå¤ç¹å¹¿æ­çåè½ï¼èä¸è¿æ¥ææºè½æ¶æ¯åååè½ï¼å¨å°ä¸æ¡æ¶æ¯åéå°åä¸ç³»ç»ä¸çå¤ä¸ªç¨æ·æ¶ï¼MQ å°æ¶æ¯çä¸ä¸ªå¤å¶çæ¬åè¯¥ç³»ç»ä¸æ¥æ¶èçåååéå°ç®æ  MQ ç³»ç»ãç®æ  MQ ç³»ç»å¨æ¬å°å¤å¶è¿äºæ¶æ¯ï¼å¹¶å°å®ä»¬åéå°ååä¸çéåï¼ä»èå°½å¯è½åå°ç½ç»çä¼ è¾éã\n * åå¸/è®¢é (Publish/Subscribe) - åå¸/è®¢éæ¨¡å¼ä½¿æ¶æ¯çååå¯ä»¥çªç ´ç®çéåå°çä½ç½®çéå¶ï¼ä½¿æ¶æ¯æç§ç¹å®çä¸»é¢çè³åå®¹è¿è¡ååï¼ç¨æ·æåºç¨ç¨åºå¯ä»¥æ ¹æ®ä¸»é¢æåå®¹æ¥æ¶å°æéè¦çæ¶æ¯ãåå¸/è®¢éæ¨¡å¼ä½¿å¾åéèåæ¥æ¶èä¹é´çè¦åå³ç³»åå¾æ´ä¸ºæ¾æ£ï¼åéèä¸å¿å³å¿æ¥æ¶èçç®çå°åï¼èæ¥æ¶èä¹ä¸å¿å³å¿æ¶æ¯çåéå°åï¼èåªæ¯æ ¹æ®æ¶æ¯çä¸»é¢è¿è¡æ¶æ¯çæ¶åã\n * éç¾¤ (Cluster) - ä¸ºäºç®åç¹å¯¹ç¹éè®¯æ¨¡å¼ä¸­çç³»ç»éç½®ï¼MQ æä¾ Cluster(éç¾¤) çè§£å³æ¹æ¡ãéç¾¤ç±»ä¼¼äºä¸ä¸ªå (Domain)ï¼éç¾¤åé¨çéåç®¡çå¨ä¹é´éè®¯æ¶ï¼ä¸éè¦ä¸¤ä¸¤ä¹é´å»ºç«æ¶æ¯ééï¼èæ¯éç¨éç¾¤ (Cluster) ééä¸å¶å®æåéè®¯ï¼ä»èå¤§å¤§ç®åäºç³»ç»éç½®ãæ­¤å¤ï¼éç¾¤ä¸­çéåç®¡çå¨ä¹é´è½å¤èªå¨è¿è¡è´è½½åè¡¡ï¼å½æä¸éåç®¡çå¨åºç°æéæ¶ï¼å¶å®éåç®¡çå¨å¯ä»¥æ¥ç®¡å®çå·¥ä½ï¼ä»èå¤§å¤§æé«ç³»ç»çé«å¯é æ§ã\n\n\n# 2. MQ çåºç¨\n\n\n# 2.1. å¼æ­¥å¤ç\n\n> MQ å¯ä»¥å°ç³»ç»é´çå¤çæµç¨å¼æ­¥åï¼åå°ç­å¾ååºçæ¶é´ï¼ä»èæé«æ´ä½å¹¶åååéã\n> \n> ä¸è¬ï¼MQ å¼æ­¥å¤çåºç¨äºéæ ¸å¿æµç¨ï¼ä¾å¦ï¼ç­ä¿¡/é®ä»¶éç¥ãæ°æ®æ¨éãä¸æ¥æ°æ®å°çæ§ä¸­å¿/æ¥å¿ä¸­å¿ç­ã\n\nåè®¾è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¨æ·åç³»ç» A åèµ·è¯·æ±ï¼ç³»ç» A å¤çè®¡ç®åªéè¦ 10 msï¼ç¶åéç¥ç³»ç» BCD ååºï¼ç³»ç» BCD ååºèæ¶åå«ä¸ºï¼100msã200msã300msãæç»æ»èæ¶ä¸ºï¼ 10+100ms+200ms+300ms=610msãæ­¤å¤ï¼å ä¸è¯·æ±åååºçç½ç»ä¼ è¾æ¶é´ï¼ä»ç¨æ·è§åº¦çï¼å¯è½è¦ç­å¾å°è¿ 1s æè½å¾å°ç»æã\n\n\n\nå¦æä½¿ç¨ MQï¼ç³»ç» A æ¥å°è¯·æ±åï¼èæ¶ 10ms å¤çè®¡ç®ï¼ç¶ååç³»ç» BCD è¿ç»­åéæ¶æ¯ï¼åè®¾èæ¶ 5msãé£ä¹ è¿ä¸è¿ç¨çæ»èæ¶ä¸º 3ms + 5ms = 8msï¼è¿ç¸æ¯äº 610 msï¼å¤§å¤§ç¼©ç­äºååºæ¶é´ãè³äºç³»ç» BCD çååºæä½ï¼åªè¦èªè¡æ¶è´¹ MQ åå¤çå³å¯ï¼ç¨æ·æ éå³æ³¨ã\n\n\n\n\n# 2.2. ç³»ç»è§£è¦\n\n> éè¿ MQï¼å¯ä»¥æ¶é¤ç³»ç»é´çå¼ºè¦åãå®çå¥½å¤å¨äºï¼\n> \n>  * æ¶æ¯çæ¶è´¹èç³»ç»å¯ä»¥éæå¢å ï¼æ éä¿®æ¹çäº§èç³»ç»çä»£ç ã\n>  * çäº§èç³»ç»ãæ¶è´¹èç³»ç»å½¼æ­¤ä¸ä¼å½±åå¯¹æ¹çæµç¨ã\n>    * å¦æçäº§èç³»ç»å®æºï¼æ¶è´¹èç³»ç»æ¶ä¸å°æ¶æ¯ï¼å°±ä¸ä¼æä¸ä¸æ­¥çå¨ä½ã\n>    * å¦ææ¶è´¹èç³»ç»å®æºï¼çäº§èç³»ç»è®©ç¶å¯ä»¥æ­£å¸¸åéæ¶æ¯ï¼ä¸å½±åæµç¨ã\n\nä¸åç³»ç»å¦æè¦å»ºç«éä¿¡ï¼ä¼ ç»çåæ³æ¯ï¼è°ç¨æ¥å£ã\n\nå¦æéè¦åæ°çç³»ç»å»ºç«éä¿¡æå é¤å·²å»ºç«çéä¿¡ï¼é½éè¦ä¿®æ¹ä»£ç ï¼è¿ç§æ¹æ¡æ¾ç¶è¦ååº¦å¾é«ã\n\n\n\nå¦æä½¿ç¨ MQï¼ç³»ç»é´çéä¿¡åªéè¦éè¿åå¸/è®¢éï¼Pub/Subï¼æ¨¡åå³å¯ï¼å½¼æ­¤æ²¡æç´æ¥èç³»ï¼ä¹å°±ä¸éè¦ç¸äºæç¥ï¼ä»èè¾¾å° è§£è¦ã\n\n\n\n\n# 2.3. æµéåå³°\n\n> å½ ä¸ä¸æ¸¸ç³»ç» å¤çè½åå­å¨å·®è·çæ¶åï¼å©ç¨ MQ åä¸ä¸ª âæ¼æâ æ¨¡åï¼è¿è¡ æµæ§ãæ MQ å½æå¯é ç æ¶æ¯æå­å°ï¼è¿è¡ä¸å®ç¨åº¦ç æ¶æ¯å ç§¯ï¼å¨ä¸æ¸¸æè½åå¤ççæ¶åï¼ååéæ¶æ¯ã\n> \n> MQ çæµéåå³°å¸¸ç¨äºé«å¹¶ååºæ¯ï¼ä¾å¦ï¼ç§æãå¢æ¢ç­ä¸å¡åºæ¯ï¼ï¼å®æ¯ç¼è§£ç¬æ¶æ´å¢æµéçæ ¸å¿ææ®µä¹ä¸ã\n> \n> å¦ææ²¡æ MQï¼ä¸¤ä¸ªç³»ç»ä¹é´éè¿ ååãæ»å¨çªå£ãéæµ/éçº§/çæ­ ç­å¤æçæ¹æ¡ä¹è½å®ç° æµæ§ãä½ ç³»ç»å¤ææ§ ææ°çº§å¢é¿ï¼å¿å¿å¨ä¸æ¸¸æèä¸æ¸¸åå­å¨ï¼å¹¶ä¸è¦å¤ç å®æ¶ãæ¥å¡ ç­ä¸ç³»åé®é¢ãèä¸æ¯å½æ å¤çè½åæå·®è· çæ¶åï¼é½éè¦ åç¬ å¼åä¸å¥é»è¾æ¥ç»´æ¤è¿å¥é»è¾ã\n\nåè®¾æä¸ªç³»ç»è¯»åæ°æ®åºçç¨³å®æ§è½ä¸ºæ¯ç§å¤ç 1000 æ¡æ°æ®ãå¹³å¸¸æåµä¸ï¼è¿è¿è¾¾ä¸å°è¿ä¹å¤§çå¤çéãåè®¾ï¼å ä¸ºå ä¸ºåæ´»å¨ï¼ç³»ç»çç¬æ¶è¯·æ±éå§å¢ï¼è¾¾å°æ¯ç§ 10000 ä¸ªå¹¶åè¯·æ±ï¼æ°æ®åºæ ¹æ¬æ¿åä¸äºï¼å¯è½ç´æ¥å°±ææ°æ®åºç»æ´å´©æºäºï¼è¿æ ·ç³»ç»æå¡å°±ä¸å¯ç¨äºã\n\n\n\nå¦æä½¿ç¨ MQï¼æ¯ç§åå¥ 10000 æ¡è¯·æ±ï¼ä½æ¯ç³»ç» A æ¯ç§åªä» MQ ä¸­æ¶è´¹ 1000 æ¡è¯·æ±ï¼ç¶ååå¥æ°æ®åºãè¿æ ·ï¼å°±ä¸ä¼è¶è¿æ°æ®åºçæ¿åè½åï¼èæ¯æè¯·æ±ç§¯åå¨ MQ ä¸­ãåªè¦é«å³°æä¸è¿ï¼ç³»ç» A å°±ä¼å¾å¿«æç§¯åçæ¶æ¯ç»å¤çæã\n\n\n\n\n# 2.4. ä¼ è¾ç¼å²\n\nï¼1ï¼MQ å¸¸è¢«ç¨äºåæµ·éæ°æ®çä¼ è¾ç¼å²ã\n\nä¾å¦ï¼Kafka å¸¸è¢«ç¨äºåä¸ºåç§æ¥å¿æ°æ®ãééæ°æ®çæ°æ®ä¸­è½¬ãç¶åï¼Kafka å°æ°æ®è½¬åç» LogstashãElasticsearch ä¸­ï¼ç¶ååºäº Elasticsearch æ¥åæ¥å¿ä¸­å¿ï¼æä¾æ£ç´¢ãèåãåææ¥å¿çè½åãå¼åèå¯ä»¥éè¿ Kibana éæ Elasticsearch æ°æ®è¿è¡å¯è§åå±ç¤ºï¼æèªè¡è¿è¡å®å¶åå¼åã\n\n\n\nï¼2ï¼MQ ä¹å¯ä»¥è¢«ç¨äºæµå¼å¤çã\n\nä¾å¦ï¼Kafka å ä¹å·²ç»æ¯æµè®¡ç®çæ°æ®ééç«¯çæ åç»ä»¶ãèæµè®¡ç®éè¿å®æ¶æ°æ®å¤çè½åï¼æä¾äºæ´ä¸ºå¿«æ·çèåè®¡ç®è½åï¼è¢«å¤§éåºç¨äºé¾è·¯çæ§ãå®æ¶çæ§ãå®æ¶æ°ä»ãå®æ¶å¤§å±ãé£æ§ãæ¨èç­åºç¨é¢åã\n\n\n# 2.5. æç»ä¸è´æ§\n\næç»ä¸è´æ§ ä¸æ¯ æ¶æ¯éå çå¿å¤ç¹æ§ï¼ä½ç¡®å®å¯ä»¥ä¾é  æ¶æ¯éå æ¥å æç»ä¸è´æ§ çäºæã\n\n * ååæ¶æ¯åæä½ï¼ç¡®ä¿æä½å®æååä¿®æ¹æ¶æ¯ç¶æãå®æ¶ä»»å¡è¡¥å¿æºå¶ å®ç°æ¶æ¯ å¯é åéæ¥æ¶ãä¸å¡æä½çå¯é æ§è¡ï¼è¦æ³¨æ æ¶æ¯éå¤ ä¸ å¹ç­è®¾è®¡ã\n * ææä¸ä¿è¯ 100% ä¸ä¸¢æ¶æ¯ çæ¶æ¯éåï¼çè®ºä¸æ æ³å®ç° æç»ä¸è´æ§ã\n\n> å Kafka ä¸ç±»çè®¾è®¡ï¼å¨è®¾è®¡å±é¢ä¸å°±æ ä¸¢æ¶æ¯ çå¯è½ï¼æ¯å¦ å®æ¶å·çï¼å¦ææçµå°±ä¼ä¸¢æ¶æ¯ï¼ãåªæåªä¸¢ååä¹ä¸çæ¶æ¯ï¼ä¸å¡ä¹å¿é¡»ç¨å¶ä»çææ®µæ¥ä¿è¯ç»ææ­£ç¡®ã\n\n\n# 2.6. ç³»ç»é´éä¿¡\n\næ¶æ¯éåä¸è¬é½åç½®äº é«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨äºåçº¯ç æ¶æ¯éè®¯ï¼æ¯å¦å®ç° ç¹å¯¹ç¹æ¶æ¯éå æè èå¤©å®¤ ç­ã\n\nçäº§è/æ¶è´¹è æ¨¡å¼ï¼åªéè¦å³å¿æ¶æ¯æ¯å¦ éè¾¾éåï¼è³äºè°å¸æè®¢éåéè¦æ¶è´¹ï¼æ¯ ä¸æ¸¸ çäºæï¼æ çæå¤§å°åå°äºå¼ååèè°çå·¥ä½éã\n\n\n# 3. MQ çé®é¢\n\nä»»ä½ææ¯é½ä¼æå©æå¼ï¼MQ ç»æ´ä½ç³»ç»æ¶æå¸¦æ¥å¾å¤å¥½å¤ï¼ä½ä¹ä¼ä»åºä¸å®çä»£ä»·ã\n\nMQ ä¸»è¦å¼å¥äºä»¥ä¸é®é¢ï¼\n\n * ç³»ç»å¯ç¨æ§éä½ï¼å¼å¥äº MQ åï¼éä¿¡éè¦åºäº MQ å®æï¼å¦æ MQ å®æºï¼åæå¡ä¸å¯ç¨ãå æ­¤ï¼MQ è¦ä¿è¯æ¯é«å¯ç¨çï¼è¯¦æåèï¼MQ çé«å¯ç¨\n * ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ MQï¼éè¦å³æ³¨ä¸äºæ°çé®é¢ï¼\n   * å¦ä½ä¿è¯æ¶æ¯æ²¡æ éå¤æ¶è´¹ï¼\n   * å¦ä½å¤ç æ¶æ¯ä¸¢å¤± çé®é¢ï¼\n   * å¦ä½ä¿è¯ä¼ é æ¶æ¯çé¡ºåºæ§ï¼\n   * å¦ä½å¤çå¤§é æ¶æ¯ç§¯å çé®é¢ï¼\n * ä¸è´æ§é®é¢ï¼åè®¾ç³»ç» A å¤çå®ç´æ¥è¿åæåçç»æç»ç¨æ·ï¼ç¨æ·è®¤ä¸ºè¯·æ±æåãä½å¦ææ­¤æ¶ï¼ç³»ç» BCD ä¸­åªè¦æä»»æä¸ä¸ªååºå¤±è´¥ï¼é£ä¹æ°æ®å°±ä¸ä¸è´äºãè¿ç§æåµå¦ä½å¤çï¼\n\nä¸é¢ï¼æä»¬éå¯¹ä»¥ä¸é®é¢æ¥ä¸ä¸åæã\n\n\n# 3.1. éå¤æ¶è´¹\n\nå¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ å å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ æ¯åä¸ä¸ªé®é¢ã\n\nå¿é¡»åæç¡®äº§çéå¤æ¶è´¹çåå ï¼æè½å¯¹çä¸è¯ã\n\n# éå¤æ¶è´¹é®é¢åå \n\néå¤æ¶è´¹é®é¢éå¸¸ä¸æ¯ MQ æ¥å¤çï¼èæ¯ç±å¼åæ¥å¤ççã\n\nä»¥ Kafka ä¸¾ä¾ï¼Kafka æ¯ä¸ª Partition é½æ¯ä¸ä¸ªæåºçãä¸å¯åçè®°å½åºåï¼ä¸æ­è¿½å å°ç»æåçæäº¤æ¥å¿ä¸­ãPartition ä¸­ä¸ºæ¯æ¡è®°å½åéä¸ä¸ªè¿ç»­ç id å·ï¼ç§°ä¸ºåç§»éï¼Offsetï¼ï¼ç¨äºå¯ä¸æ è¯ Partition åçè®°å½ã\n\nKafka çå®¢æ·ç«¯å Broker é½ä¼ä¿å­ Offsetãå®¢æ·ç«¯æ¶è´¹æ¶æ¯åï¼æ¯éä¸æ®µæ¶é´ï¼å°±æå·²æ¶è´¹ç Offset æäº¤ç» Kafka Brokerï¼è¡¨ç¤ºå·²æ¶è´¹ã\n\n\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æå®¢æ·ç«¯åºç¨æ¶è´¹æ¶æ¯åï¼å ä¸ºå®æºãéå¯ç­æåµèæ²¡ææäº¤å·²æ¶è´¹ç Offset ãå½ç³»ç»æ¢å¤åï¼ä¼ç»§ç»­æ¶è´¹æ¶æ¯ï¼ç±äº Offset æªæäº¤ï¼å°±ä¼åºç°éå¤æ¶è´¹çé®é¢ã\n\n# éå¤æ¶è´¹è§£å³æ¹æ¡\n\nåºå¯¹éå¤æ¶è´¹é®é¢ï¼éè¦å¨ä¸å¡å±é¢ï¼éè¿ å¹ç­æ§è®¾è®¡ æ¥è§£å³ã\n\nMQ éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯æ²¡æåºå¯¹æºå¶ï¼å¯ä»¥åé´çæè·¯æï¼\n\n * å¦ææ¯åå³ç³»åæ°æ®åºï¼å¯ä»¥åæ ¹æ®ä¸»é®æ¥è¯¢ï¼å¤æ­æ°æ®æ¯å¦å·²å­å¨ï¼å­å¨åæ´æ°ï¼ä¸å­å¨åæå¥ï¼\n * å¦ææ¯å Redisï¼ç±äº set æä½å¤©ç¶å·æå¹ç­æ§ï¼æä»¥ä»ä¹é½ä¸ç¨åï¼\n * å¦ææ¯æ ¹æ®æ¶æ¯åè¾å¤æçé»è¾å¤çï¼å¯ä»¥å¨æ¶æ¯ä¸­å å¥å¨å±å¯ä¸ IDï¼ä¾å¦ï¼è®¢å ID ç­ãå¨å®¢æ·ç«¯å­å¨ä¸­ï¼MysqlãRedis ç­ï¼ä¿å­å·²æ¶è´¹æ¶æ¯ç IDãä¸æ¦æ¥åå°æ°æ¶æ¯ï¼åå¤æ­æ¶æ¯ä¸­ç ID æ¯å¦å¨å·²æ¶è´¹æ¶æ¯ ID è¡¨ä¸­å­å¨ï¼å­å¨åä¸åå¤çï¼ä¸å­å¨åå¤çã\n\nå¨å®éå¼åä¸­ï¼å¯ä»¥åèä¸é¢çä¾å­ï¼ç»åç°å®åºæ¯ï¼è®¾è®¡åççå¹ç­æ§æ¹æ¡ã\n\n\n# 3.2. æ¶æ¯ä¸¢å¤±\n\nå¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ å å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ æ¯åä¸ä¸ªé®é¢ãå³æ³¨ç¹æï¼\n\n * MQ Server ä¸¢å¤±æ°æ®\n * æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n * çäº§æ¹ä¸¢å¤±æ°æ®\n\n# æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹æ¹ä¸¢å¤±æ°æ®çæåµæ¯ï¼æ¶è´¹æ¹è®¾ç½®äºèªå¨æäº¤ Offsetãä¸æ¦è®¾ç½®äºèªå¨æäº¤ Offsetï¼æ¥åå°æ¶æ¯åå°±ä¼èªå¨æäº¤ Offset ç» Kafka ï¼Kafka å°±è®¤ä¸ºæ¶æ¯å·²è¢«æ¶è´¹ãå¦ææ­¤æ¶ï¼æ¶è´¹æ¹å°æªæ¥å¾åå¤çæ¶æ¯å°±æäºï¼é£ä¹æ¶æ¯å°±ä¸¢äºã\n\nè§£å³æ¹æ³å°±æ¯ï¼æ¶è´¹æ¹å³é­èªå¨æäº¤ Offsetï¼å¤çå®æ¶æ¯åæå¨æäº¤ Offsetãä½è¿ç§æåµä¸å¯è½ä¼åºç°éå¤æ¶è´¹çæå½¢ï¼éè¦èªè¡ä¿è¯å¹ç­æ§ã\n\n# Kafka Server ä¸¢å¤±æ°æ®\n\nå½ Kafka æä¸ª Broker å®æºï¼éè¦éæ°éä¸¾ Partition ç Leaderãè¥æ­¤æ¶å¶ä»ç Follower å°æªåæ­¥ Leader çæ°æ®ï¼é£ä¹æ°éæä¸ª Follower ä¸º Leader åï¼å°±ä¸¢å¤±äºé¨åæ°æ®ã\n\nä¸ºæ­¤ï¼ä¸è¬è¦æ±è³å°è®¾ç½® 4 ä¸ªåæ°ï¼\n\n * ç» Topic è®¾ç½® replication.factor åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª Partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ Kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿æ¯è¦æ±ä¸ä¸ª Leader éè¦åè³å°ä¸ä¸ª Follower ä¿æéä¿¡ï¼è¿æ ·æè½ç¡®ä¿ Leader æäºè¿ææ¿è¡¥ã\n * å¨ Producer ç«¯è®¾ç½® acks=all - è¿æå³çï¼è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºåå¥æåäºã\n * å¨ Producer ç«¯è®¾ç½® retries=MAXï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ - è¿æå³çè¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\n# çäº§æ¹ä¸¢å¤±æ°æ®\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼çäº§æ¹ä¸å®ä¸ä¼ä¸¢æ°æ®ã\n\nè¦æ±æ¯ï¼ä½ ç Leader æ¥æ¶å°æ¶æ¯ï¼ææç Follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬çäº§æ¶æ¯æåäºãå¦ææªæ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# 3.3. æ¶æ¯çé¡ºåºæ§\n\nè¦ä¿è¯ MQ çé¡ºåºæ§ï¼å¿å¿è¦ä»åºä¸å®çä»£ä»·ï¼æä»¥å®æ½æ¹æ¡åï¼è¦åæç¡®ä¸å¡åºæ¯æ¯ä¸æ¯æå¿è¦ä¿è¯æ¶æ¯çé¡ºåºæ§ãåªæé£äºæç¡®å¯¹æ¶æ¯å¤çé¡ºåºæè¦æ±çä¸å¡åºæ¯æå¼å¾å»ä¿è¯æ¶æ¯é¡ºåºæ§ã\n\næ¹æ¡ä¸\n\nä¸ä¸ª Topicï¼ä¸ä¸ª Partitionï¼ä¸ä¸ª Consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n\næ¹æ¡äº\n\n * åå¥æ°æ®å° Partition æ¶æå®ä¸ä¸ªå¨å±å¯ä¸ç IDï¼ä¾å¦è®¢å IDãåéæ¹ä¿è¯ç¸å ID çæ¶æ¯æåºçåéå°åä¸ä¸ª Partitionã\n * åºäºä¸ä¸ç¹ï¼æ¶è´¹æ¹ä» Kafka Partition ä¸­æ¶è´¹æ¶æ¯æ¶ï¼æ­¤å»ä¸å®æ¯é¡ºåºçãä½å¦ææ¶è´¹æ¹å¼ä»¥å¹¶åæ¹å¼æ¶è´¹æ¶æ¯ï¼é¡ºåºå°±å¯è½ä¼è¢«æä¹±ãä¸ºæ­¤ï¼è¿æåå°ä»¥ä¸å ç¹ï¼\n   * æ¶è´¹æ¹ç»´æ¤ N ä¸ªç¼å­éåï¼å·æç¸å ID çæ°æ®é½åå¥åä¸ä¸ªéåä¸­ï¼\n   * åå»º N ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åªè´è´£ä»æå®çä¸ä¸ªéåä¸­åæ°æ®ã\n\n\n\n\n# 3.4. æ¶æ¯ç§¯å\n\nåè®¾ä¸ä¸ª MQ æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 1000 æ¡æ¶æ¯ï¼ä¸ä¸ª MQ æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 3000 æ¡æ¶æ¯ï¼é£ä¹ä¸åéçå¤çéæ¯ 18 ä¸æ¡ãå¦æ MQ ä¸­ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦å¾é¿çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nå¯¹äºäº§çº¿ç¯å¢æ¥è¯´ï¼æ¼«é¿çç­å¾æ¯ä¸å¯æ¥åçï¼æä»¥é¢ä¸´è¿ç§çªå¢æ¶ï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹ä»¥åºå¯¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ Consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ Consumer é½åæã\n * æ°å»ºä¸ä¸ª Topicï¼Partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç Queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç Consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç Queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² Consumer ï¼æ¯ä¸æ¹ Consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ Queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° Queue èµæºå Consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# 4. MQ çé«å¯ç¨\n\nä¸å MQ å®ç°é«å¯ç¨çåçåä¸ç¸åãå ä¸º Kafka æ¯è¾å·æä»£è¡¨æ§ï¼æä»¥è¿éä»¥ Kafka ä¸ºä¾ã\n\n\n# 4.1. Kafka çé«å¯ç¨\n\n# Kafka çæ ¸å¿æ¦å¿µ\n\näºè§£ Kafkaï¼å¿é¡»åäºè§£ Kafka çæ ¸å¿æ¦å¿µï¼\n\n * Broker - Kafka éç¾¤åå«ä¸ä¸ªæå¤ä¸ªèç¹ï¼è¿ç§èç¹è¢«ç§°ä¸º Brokerã\n\n * Topic - æ¯æ¡åå¸å° Kafka éç¾¤çæ¶æ¯é½æä¸ä¸ªç±»å«ï¼è¿ä¸ªç±»å«è¢«ç§°ä¸º Topicãï¼ä¸å Topic çæ¶æ¯æ¯ç©çéç¦»çï¼åä¸ä¸ª Topic çæ¶æ¯ä¿å­å¨ä¸ä¸ªæå¤ä¸ª Broker ä¸ï¼ä½ç¨æ·åªéæå®æ¶æ¯ç Topic å³å¯çäº§ææ¶è´¹æ°æ®èä¸å¿å³å¿æ°æ®å­äºä½å¤ï¼ãå¯¹äºæ¯ä¸ä¸ª Topicï¼ Kafka éç¾¤é½ä¼ç»´æä¸ä¸ªååºæ¥å¿ã\n\n * Partition - äºæé« Kafka çååçï¼æ¯ä¸ª Topic åå«ä¸ä¸ªæå¤ä¸ª Partitionï¼æ¯ä¸ª Partition å¨ç©çä¸å¯¹åºä¸ä¸ªæä»¶å¤¹ï¼è¯¥æä»¶å¤¹ä¸å­å¨è¿ä¸ª Partition çæææ¶æ¯åç´¢å¼æä»¶ã\n   \n   * Kafka æ¥å¿çååºï¼Partitionï¼åå¸å¨ Kafka éç¾¤çèç¹ä¸ãæ¯ä¸ªèç¹å¨å¤çæ°æ®åè¯·æ±æ¶ï¼å±äº«è¿äºååºãæ¯ä¸ä¸ªååºé½ä¼å¨å·²éç½®çèç¹ä¸è¿è¡å¤ä»½ï¼ç¡®ä¿å®¹éæ§ã\n\n\n\n# Kafka çå¯æ¬æºå¶\n\nKafka æ¯å¦ä½å®ç°é«å¯ç¨çå¢ï¼\n\nKafka å¨ 0.8 ä»¥åççæ¬ä¸­ï¼å¦æä¸ä¸ª Broker å®æºäºï¼å¶ä¸é¢ç Partition é½ä¸è½ç¨äºï¼è¿èªç¶ä¸æ¯é«å¯ç¨çã\n\nä¸ºäºå®ç°é«å¯ç¨ï¼Kafka å¼å¥äºå¤å¶åè½ã\n\nç®åæ¥è¯´ï¼å°±æ¯å¯æ¬æºå¶ï¼ Replicate ï¼ã\n\næ¯ä¸ª Partition é½æä¸ä¸ª Leaderï¼é¶ä¸ªæå¤ä¸ª FollowerãLeader å Follower é½æ¯ Brokerï¼æ¯ä¸ª Broker é½ä¼æä¸ºæäºååºç Leader åæäºååºç Followerï¼å æ­¤éç¾¤çè´è½½æ¯å¹³è¡¡çã\n\n * Leader å¤çä¸åå¯¹ Partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n * è Follower åªéè¢«å¨çåæ­¥ Leader ä¸çæ°æ®ã\n\nåä¸ä¸ª Topic çä¸å Partition ä¼åå¸å¨å¤ä¸ª Broker ä¸ï¼èä¸ä¸ä¸ª Partition è¿ä¼å¨å¶ä»ç Broker ä¸é¢è¿è¡å¤ä»½ï¼Producer å¨åå¸æ¶æ¯å°æä¸ª Partition æ¶ï¼åæ¾å°è¯¥ Partition ç Leaderï¼ç¶ååè¿ä¸ª Leader æ¨éæ¶æ¯ï¼æ¯ä¸ª Follower é½ä» Leader æåæ¶æ¯ï¼æåæ¶æ¯æåä¹åï¼å Leader åéä¸ä¸ª ACK ç¡®è®¤ã\n\n\n\n> FAQ\n> \n> é®ï¼ä¸ºä»ä¹è®© Leader å¤çä¸åå¯¹å¯¹ Partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n> \n> ç­ï¼å ä¸ºå¦æåè®¸ææ Broker é½å¯ä»¥å¤çè¯»åè¯·æ±ï¼å°±å¯è½äº§çæ°æ®ä¸è´æ§é®é¢ã\n\n# Kafka éä¸¾ Leader\n\nç±ä¸æå¯ç¥ï¼Partition å¨å¤ä¸ª Broker ä¸å­å¨å¯æ¬ã\n\nå¦ææä¸ª Follower å®æºï¼å¥äºå¿æ²¡æï¼æ­£å¸¸å·¥ä½ã\n\nå¦æ Leader å®æºäºï¼ä¼ä» Follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç Leaderã\n\n\n# 5. ä¸»æµ MQ\n\n\n# 5.1. ActiveMQ\n\nActiveMQ æ¯ç± Apache åºåï¼ActiveMQ æ¯ä¸ä¸ªå®å¨æ¯æJMS1.1 å J2EE 1.4 è§èç JMS Provider å®ç°ãå®éå¸¸å¿«éï¼æ¯æ å¤ç§è¯­è¨çå®¢æ·ç«¯ å åè®®ï¼èä¸å¯ä»¥éå¸¸å®¹æçåµå¥å°ä¼ä¸çåºç¨ç¯å¢ä¸­ï¼å¹¶æè®¸å¤é«çº§åè½ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. æä» JMS è§èï¼JMS è§èæä¾äºè¯å¥½çæ ååä¿è¯ï¼åæ¬ï¼åæ­¥ æ å¼æ­¥ çæ¶æ¯ååï¼ä¸æ¬¡åä»ä¸æ¬¡çæ¶æ¯ååï¼æ¶æ¯æ¥æ¶ å è®¢é ç­ç­ãéµä» JMS è§èçå¥½å¤å¨äºï¼ä¸è®ºä½¿ç¨ä»ä¹ JMS å®ç°æä¾èï¼è¿äºåºç¡ç¹æ§é½æ¯å¯ç¨çï¼\n 2. è¿æ¥çµæ´»æ§ï¼ActiveMQ æä¾äºå¹¿æ³ç è¿æ¥åè®®ï¼æ¯æçåè®®æï¼HTTP/Sï¼IP å¤æ­ï¼SSLï¼TCPï¼UDP ç­ç­ãå¯¹ä¼å¤åè®®çæ¯æè®© ActiveMQ æ¥æäºå¾å¥½ççµæ´»æ§ï¼\n 3. æ¯æçåè®®ç§ç±»å¤ï¼OpenWireãSTOMPãRESTãXMPPãAMQPï¼\n 4. æä¹åæä»¶åå®å¨æä»¶ï¼ActiveMQ æä¾äº å¤ç§æä¹å éæ©ãèä¸ï¼ActiveMQ çå®å¨æ§ä¹å¯ä»¥å®å¨ä¾æ®ç¨æ·éæ±è¿è¡ èªå®ä¹é´æ å ææï¼\n 5. æ¯æçå®¢æ·ç«¯è¯­è¨ç§ç±»å¤ï¼é¤äº Java ä¹å¤ï¼è¿æï¼C/C++ï¼.NETï¼Perlï¼PHPï¼Pythonï¼Rubyï¼\n 6. ä»£çéç¾¤ï¼å¤ä¸ª ActiveMQ ä»£ç å¯ä»¥ç»æä¸ä¸ª éç¾¤ æ¥æä¾æå¡ï¼\n 7. å¼å¸¸ç®åçç®¡çï¼ActiveMQ æ¯ä»¥å¼åèæç»´è¢«è®¾è®¡çãæä»¥ï¼å®å¹¶ä¸éè¦ä¸é¨çç®¡çåï¼å ä¸ºå®æä¾äºç®ååä½¿ç¨çç®¡çç¹æ§ãæå¾å¤ä¸­æ¹æ³å¯ä»¥ çæ§ ActiveMQ ä¸åå±é¢çæ°æ®ï¼åæ¬ä½¿ç¨å¨ JConsole æèå¨ ActiveMQ ç Web Console ä¸­ä½¿ç¨ JMXãéè¿å¤ç JMX çåè­¦æ¶æ¯ï¼éè¿ä½¿ç¨ å½ä»¤è¡èæ¬ï¼çè³å¯ä»¥éè¿çæ§åç§ç±»åç æ¥å¿ã\n\n# (b) é¨ç½²ç¯å¢\n\nActiveMQ å¯ä»¥è¿è¡å¨ Java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ ActiveMQ éè¦ï¼\n\n * Java JDK\n * ActiveMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. è·¨å¹³å° (JAVA ç¼åä¸å¹³å°æ å³ï¼ActiveMQ å ä¹å¯ä»¥è¿è¡å¨ä»»ä½ç JVM ä¸)ï¼\n 2. å¯ä»¥ç¨ JDBCï¼å¯ä»¥å° æ°æ®æä¹å å°æ°æ®åºãè½ç¶ä½¿ç¨ JDBC ä¼éä½ ActiveMQ çæ§è½ï¼ä½æ¯æ°æ®åºä¸ç´é½æ¯å¼åäººåæçæçå­å¨ä»è´¨ï¼\n 3. æ¯æ JMS è§èï¼æ¯æ JMS è§èæä¾ç ç»ä¸æ¥å£;\n 4. æ¯æ èªå¨éè¿ å éè¯¯éè¯æºå¶ï¼\n 5. æå®å¨æºå¶ï¼æ¯æåºäº shiroï¼jaas ç­å¤ç§ å®å¨éç½®æºå¶ï¼å¯ä»¥å¯¹ Queue/Topic è¿è¡ è®¤è¯åææï¼\n 6. çæ§å®åï¼æ¥æå®åç çæ§ï¼åæ¬ Web Consoleï¼JMXï¼Shell å½ä»¤è¡ï¼Jolokia ç RESTful APIï¼\n 7. çé¢ååï¼æä¾ç Web Console å¯ä»¥æ»¡è¶³å¤§é¨åæåµï¼è¿æå¾å¤ ç¬¬ä¸æ¹çç»ä»¶ å¯ä»¥ä½¿ç¨ï¼æ¯å¦ hawtioï¼\n\n# (d) ç¼ºç¹\n\n 1. ç¤¾åºæ´»è·åº¦ä¸å RabbitMQ é«ï¼\n 2. æ ¹æ®å¶ä»ç¨æ·åé¦ï¼ä¼åºè«åå¶å¦çé®é¢ï¼ä¼ ä¸¢å¤±æ¶æ¯ï¼\n 3. ç®åéå¿æ¾å° activemq 6.0 äº§å Apolloï¼å¯¹ 5.x çç»´æ¤è¾å°ï¼\n 4. ä¸éåç¨äº ä¸åä¸ªéå çåºç¨åºæ¯ï¼\n\n\n# 5.2. RabbitMQ\n\nRabbitMQ äº 2007 å¹´åå¸ï¼æ¯ä¸ä¸ªå¨ AMQP (é«çº§æ¶æ¯éååè®®)åºç¡ä¸å®æçï¼å¯å¤ç¨çä¼ä¸æ¶æ¯ç³»ç»ï¼æ¯å½åæä¸»æµçæ¶æ¯ä¸­é´ä»¶ä¹ä¸ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¯é æ§ï¼æä¾äºå¤ç§ææ¯å¯ä»¥è®©ä½ å¨ æ§è½ å å¯é æ§ ä¹é´è¿è¡ æè¡¡ãè¿äºææ¯åæ¬ æä¹æ§æºå¶ãæéç¡®è®¤ãåå¸èè¯å® å é«å¯ç¨æ§æºå¶ï¼\n 2. çµæ´»çè·¯ç±ï¼æ¶æ¯å¨å°è¾¾éååæ¯éè¿ äº¤æ¢æº è¿è¡ è·¯ç± çãRabbitMQ ä¸ºå¸åçè·¯ç±é»è¾æä¾äº å¤ç§åç½®äº¤æ¢æº ç±»åãå¦æä½ ææ´å¤æçè·¯ç±éæ±ï¼å¯ä»¥å°è¿äºäº¤æ¢æºç»åèµ·æ¥ä½¿ç¨ï¼ä½ çè³å¯ä»¥å®ç°èªå·±çäº¤æ¢æºç±»åï¼å¹¶ä¸å½å RabbitMQ ç æä»¶ æ¥ä½¿ç¨ï¼\n 3. æ¶æ¯éç¾¤ï¼å¨ç¸åå±åç½ä¸­çå¤ä¸ª RabbitMQ æå¡å¨å¯ä»¥ èå å¨ä¸èµ·ï¼ä½ä¸ºä¸ä¸ªç¬ç«çé»è¾ä»£çæ¥ä½¿ç¨ï¼\n 4. éåé«å¯ç¨ï¼éåå¯ä»¥å¨éç¾¤ä¸­çæºå¨ä¸ è¿è¡éåï¼ä»¥ç¡®ä¿å¨ç¡¬ä»¶é®é¢ä¸è¿ä¿è¯ æ¶æ¯å®å¨ï¼\n 5. æ¯æå¤ç§åè®®ï¼æ¯æ å¤ç§æ¶æ¯éååè®®ï¼\n 6. æ¯æå¤ç§è¯­è¨ï¼ç¨ Erlang è¯­è¨ç¼åï¼æ¯æåªè¦æ¯ä½ è½æ³å°ç ææç¼ç¨è¯­è¨ï¼\n 7. ç®¡ççé¢ï¼ RabbitMQ æä¸ä¸ªæç¨ç ç¨æ·çé¢ï¼ä½¿å¾ç¨æ·å¯ä»¥ çæ§ å ç®¡ç æ¶æ¯ Broker çè®¸å¤æ¹é¢ï¼\n 8. è·è¸ªæºå¶ï¼å¦æ æ¶æ¯å¼å¸¸ï¼RabbitMQ æä¾æ¶æ¯è·è¸ªæºå¶ï¼ä½¿ç¨èå¯ä»¥æ¾åºåçäºä»ä¹ï¼\n 9. æä»¶æºå¶ï¼æä¾äºè®¸å¤ æä»¶ï¼æ¥ä»å¤æ¹é¢è¿è¡æ©å±ï¼ä¹å¯ä»¥ç¼åèªå·±çæä»¶ã\n\n# (b) é¨ç½²ç¯å¢\n\nRabbitMQ å¯ä»¥è¿è¡å¨ Erlang è¯­è¨ææ¯æçå¹³å°ä¹ä¸ï¼åæ¬ Solarisï¼BSDï¼Linuxï¼MacOSXï¼TRU64ï¼Windows ç­ãä½¿ç¨ RabbitMQ éè¦ï¼\n\n * ErLang è¯­è¨å\n * RabbitMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. ç±äº Erlang è¯­è¨çç¹æ§ï¼æ¶æ¯éåæ§è½è¾å¥½ï¼æ¯æ é«å¹¶åï¼\n 2. å¥å£®ãç¨³å®ãæç¨ãè·¨å¹³å°ãæ¯æ å¤ç§è¯­è¨ãææ¡£é½å¨ï¼\n 3. ææ¶æ¯ ç¡®è®¤æºå¶ å æä¹åæºå¶ï¼å¯é æ§é«ï¼\n 4. é«åº¦å¯å®å¶ç è·¯ç±ï¼\n 5. ç®¡ççé¢ è¾ä¸°å¯ï¼å¨äºèç½å¬å¸ä¹æè¾å¤§è§æ¨¡çåºç¨ï¼ç¤¾åºæ´»è·åº¦é«ã\n\n# (d) ç¼ºç¹\n\n 1. å°½ç®¡ç»å Erlang è¯­è¨æ¬èº«çå¹¶åä¼å¿ï¼æ§è½è¾å¥½ï¼ä½æ¯ä¸å©äºå äºæ¬¡å¼ååç»´æ¤ï¼\n 2. å®ç°äº ä»£çæ¶æï¼æå³çæ¶æ¯å¨åéå°å®¢æ·ç«¯ä¹åå¯ä»¥å¨ ä¸­å¤®èç¹ ä¸æéãæ­¤ç¹æ§ä½¿å¾ RabbitMQ æäºä½¿ç¨åé¨ç½²ï¼ä½æ¯ä½¿å¾å¶ è¿è¡éåº¦è¾æ¢ï¼å ä¸ºä¸­å¤®èç¹ å¢å äºå»¶è¿ï¼æ¶æ¯å°è£å ä¹æ¯è¾å¤§ï¼\n 3. éè¦å­¦ä¹  æ¯è¾å¤æ ç æ¥å£ååè®®ï¼å­¦ä¹ åç»´æ¤ææ¬è¾é«ã\n\n\n# 5.3. RocketMQ\n\nRocketMQ åºèª é¿é çå¼æºäº§åï¼ç¨ Java è¯­è¨å®ç°ï¼å¨è®¾è®¡æ¶åèäº Kafkaï¼å¹¶ååºäºèªå·±çä¸äºæ¹è¿ï¼æ¶æ¯å¯é æ§ä¸ æ¯ Kafka æ´å¥½ãRocketMQ å¨é¿éåé¨ \b è¢«å¹¿æ³åºç¨å¨ è®¢åï¼äº¤æï¼åå¼ï¼æµè®¡ç®ï¼æ¶æ¯æ¨éï¼æ¥å¿æµå¼å¤çï¼binglog åå ç­åºæ¯ã\n\n# (a) ä¸»è¦ç¹æ§\n\n![img](data:image/svg+xml;utf8,)\n\n 1. åºäº éåæ¨¡åï¼å·æ é«æ§è½ãé«å¯é ãé«å®æ¶ãåå¸å¼ ç­ç¹ç¹ï¼\n 2. ProducerãConsumerãéå é½æ¯æ åå¸å¼ï¼\n 3. Producer åä¸äºéåè½®æµåéæ¶æ¯ï¼éåéå ç§°ä¸º TopicãConsumer å¦æå å¹¿æ­æ¶è´¹ï¼åä¸ä¸ª Consumer å®ä¾æ¶è´¹è¿ä¸ª Topic å¯¹åºç ææéåï¼å¦æå éç¾¤æ¶è´¹ï¼å å¤ä¸ª Consumer å®ä¾ å¹³åæ¶è´¹ è¿ä¸ª Topic å¯¹åºçéåéåï¼\n 4. è½å¤ä¿è¯ ä¸¥æ ¼çæ¶æ¯é¡ºåºï¼\n 5. æä¾ä¸°å¯ç æ¶æ¯æåæ¨¡å¼ï¼\n 6. é«æçè®¢éè æ°´å¹³æ©å±è½åï¼\n 7. å®æ¶ ç æ¶æ¯è®¢éæºå¶ï¼\n 8. äº¿çº§ æ¶æ¯å ç§¯ è½åï¼\n 9. è¾å°çå¤é¨ä¾èµã\n\n# (b) é¨ç½²ç¯å¢\n\nRocketMQ å¯ä»¥è¿è¡å¨ Java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ RocketMQ éè¦ï¼\n\n * Java JDK\n * å®è£ gitãMaven\n * RocketMQ å®è£å\n\n# (c) ä¼ç¹\n\n 1. åæº æ¯æ 1 ä¸ä»¥ä¸ æä¹åéåï¼\n 2. RocketMQ çæææ¶æ¯é½æ¯ æä¹åçï¼ååå¥ç³»ç» PAGECACHEï¼ç¶å å·çï¼å¯ä»¥ä¿è¯ åå­ ä¸ ç£ç é½æä¸ä»½æ°æ®ï¼è è®¿é® æ¶ï¼ç´æ¥ ä»åå­è¯»åã\n 3. æ¨¡åç®åï¼æ¥å£æç¨ï¼JMS çæ¥å£å¾å¤åºåå¹¶ä¸å¤ªå®ç¨ï¼ï¼\n 4. æ§è½éå¸¸å¥½ï¼å¯ä»¥åè®¸ å¤§éå ç§¯æ¶æ¯ å¨ Broker ä¸­ï¼\n 5. æ¯æ å¤ç§æ¶è´¹æ¨¡å¼ï¼åæ¬ éç¾¤æ¶è´¹ãå¹¿æ­æ¶è´¹ç­ï¼\n 6. åä¸ªç¯è åå¸å¼æ©å±è®¾è®¡ï¼æ¯æ ä¸»ä» å é«å¯ç¨ï¼\n 7. å¼ååº¦è¾æ´»è·ï¼çæ¬æ´æ°å¾å¿«ã\n\n# (d) ç¼ºç¹\n\n 1. æ¯æç å®¢æ·ç«¯è¯­è¨ ä¸å¤ï¼ç®åæ¯ Java å C++ï¼å¶ä¸­ C++ è¿ä¸æçï¼\n 2. RocketMQ ç¤¾åºå³æ³¨åº¦åæçåº¦ä¹ä¸ååä¸¤èï¼\n 3. æ²¡æ Web ç®¡ççé¢ï¼æä¾äºä¸ä¸ª CLI (å½ä»¤è¡çé¢) ç®¡çå·¥å·å¸¦æ¥ æ¥è¯¢ãç®¡ç å è¯æ­åç§é®é¢ï¼\n 4. æ²¡æå¨ MQ æ ¸å¿éå®ç° JMS ç­æ¥å£ï¼\n\n\n# 5.4. Kafka\n\nApache Kafka æ¯ä¸ä¸ª åå¸å¼æ¶æ¯åå¸è®¢é ç³»ç»ãå®æåç± LinkedIn å¬å¸åºäºç¬ç¹çè®¾è®¡å®ç°ä¸ºä¸ä¸ª åå¸å¼çæ¥å¿æäº¤ç³»ç» (a distributed commit log)ï¼ä¹åæä¸º Apache é¡¹ç®çä¸é¨åãKafka æ§è½é«æãå¯æ©å±è¯å¥½ å¹¶ä¸ å¯æä¹åãå®ç ååºç¹æ§ï¼å¯å¤å¶ å å¯å®¹é é½æ¯å¶ä¸éçç¹æ§ã\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¿«éæä¹åï¼å¯ä»¥å¨ O(1) çç³»ç»å¼éä¸è¿è¡ æ¶æ¯æä¹åï¼\n 2. é«ååï¼å¨ä¸å°æ®éçæå¡å¨ä¸æ¢å¯ä»¥è¾¾å° 10W/s ç ååéçï¼\n 3. å®å¨çåå¸å¼ç³»ç»ï¼BrokerãProducer å Consumer é½åçèªå¨æ¯æ åå¸å¼ï¼èªå¨å®ç° è´è½½åè¡¡ï¼\n 4. æ¯æ åæ­¥ å å¼æ­¥ å¤å¶ä¸¤ç§ é«å¯ç¨æºå¶ï¼\n 5. æ¯æ æ°æ®æ¹éåé å æåï¼\n 6. é¶æ·è´ææ¯(zero-copy)ï¼åå° IO æä½æ­¥éª¤ï¼æé« ç³»ç»ååéï¼\n 7. æ°æ®è¿ç§»ãæ©å®¹ å¯¹ç¨æ·éæï¼\n 8. æ éåæº å³å¯æ©å±æºå¨ï¼\n 9. å¶ä»ç¹æ§ï¼ä¸°å¯ç æ¶æ¯æåæ¨¡åãé«æ è®¢éèæ°´å¹³æ©å±ãå®æ¶ç æ¶æ¯è®¢éãäº¿çº§ç æ¶æ¯å ç§¯è½åãå®æå é¤æºå¶ï¼\n\n# (b) é¨ç½²ç¯å¢\n\nä½¿ç¨ Kafka éè¦ï¼\n\n * Java JDK\n * Kafka å®è£å\n\n# (c) ä¼ç¹\n\n 1. å®¢æ·ç«¯è¯­è¨ä¸°å¯ï¼æ¯æ Javaã.NetãPHPãRubyãPythonãGo ç­å¤ç§è¯­è¨ï¼\n 2. é«æ§è½ï¼åæºåå¥ TPS çº¦å¨ 100 ä¸æ¡/ç§ï¼æ¶æ¯å¤§å° 10 ä¸ªå­èï¼\n 3. æä¾ å®å¨åå¸å¼æ¶æï¼å¹¶æ replica æºå¶ï¼æ¥æè¾é«ç å¯ç¨æ§ å å¯é æ§ï¼çè®ºä¸æ¯æ æ¶æ¯æ éå ç§¯ï¼\n 4. æ¯ææ¹éæä½ï¼\n 5. æ¶è´¹è éç¨ Pull æ¹å¼è·åæ¶æ¯ãæ¶æ¯æåºï¼éè¿æ§å¶ è½å¤ä¿è¯æææ¶æ¯è¢«æ¶è´¹ä¸ä»è¢«æ¶è´¹ ä¸æ¬¡ï¼\n 6. æä¼ç§çç¬¬ä¸æ¹ Kafka Web ç®¡ççé¢ Kafka-Managerï¼\n 7. å¨ æ¥å¿é¢å æ¯è¾æçï¼è¢«å¤å®¶å¬å¸åå¤ä¸ªå¼æºé¡¹ç®ä½¿ç¨ã\n\n# (d) ç¼ºç¹\n\n 1. Kafka åæºè¶è¿ 64 ä¸ª éå/ååº æ¶ï¼Load æ¶ä¼åçææ¾çé£é«ç°è±¡ãéå è¶å¤ï¼è´è½½ è¶é«ï¼åéæ¶æ¯ ååºæ¶é´åé¿ï¼\n 2. ä½¿ç¨ ç­è½®è¯¢æ¹å¼ï¼å®æ¶æ§ åå³äº è½®è¯¢é´éæ¶é´ï¼\n 3. æ¶è´¹å¤±è´¥ ä¸æ¯æéè¯ï¼\n 4. æ¯æ æ¶æ¯é¡ºåºï¼ä½æ¯ ä¸å°ä»£çå®æº åï¼å°±ä¼äº§ç æ¶æ¯ä¹±åºï¼\n 5. ç¤¾åºæ´æ°è¾æ¢ã\n\n\n# 5.5. MQ çææ¯éå\n\nMQ çææ¯éåä¸è¬è¦èèä»¥ä¸å ç¹ï¼\n\n * æ¯å¦å¼æºï¼è¿å³å®äºè½å¦åç¨ï¼æä»¥æä¸ºéè¦ã\n * ç¤¾åºæ´»è·åº¦è¶é«è¶å¥½ï¼é«ç¤¾åºæ´»è·åº¦ï¼ä¸è¬ä¿è¯äºä½ Bug çï¼å ä¸ºå¤§é¨å Bugï¼å·²ç»æäººéå°å¹¶è§£å³äºã\n * ææ¯çæééæ§ï¼å®¢æ·ç«¯å¯¹åç§ç¼ç¨è¯­è¨çæ¯æãæ¯å¦ï¼å¦æä½¿ç¨ MQ çé½æ¯ Java åºç¨ï¼é£ä¹ ActiveMQãRabbitMQãRocketMQãKafka é½å¯ä»¥ãå¦æéè¦æ¯æå¶ä»è¯­è¨ï¼é£ä¹ RMQ æ¯è¾åéï¼å ä¸ºå®æ¯æçç¼ç¨è¯­è¨æ¯è¾ä¸°å¯ãå¦æ MQ æ¯åºç¨äºå¤§æ°æ®ææµå¼è®¡ç®ï¼é£ä¹ Kafka å ä¹æ¯æ éãå¦ææ¯åºç¨äºå¨çº¿ä¸å¡ç³»ç»ï¼é£ä¹ Kafka å°±ä¸åéäºï¼å¯ä»¥èè RabbitMQã RocketMQ å¾åéã\n * é«å¯ç¨æ§ï¼åºç¨äºçº¿ä¸çåå¥æ åã\n * æ§è½ï¼å·å¤è¶³å¤å¥½çæ§è½ï¼è½æ»¡è¶³ç»å¤§å¤æ°åºæ¯çæ§è½è¦æ±ã\n\nç¹æ§                ACTIVEMQ                     RABBITMQ                        ROCKETMQ                                      KAFKA\nåæºååé             ä¸çº§ï¼æ¯ RocketMQãKafka ä½ä¸ä¸ªæ°éçº§   å ActiveMQ                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡æµå¼è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ RocketMQ   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼Kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ RabbitMQ çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å ActiveMQ                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å RocketMQ\nåè½æ¯æ              MQ é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   MQ åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç MQ åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸å¡ç³»ç»åºæ¯ï¼å»ºè®®ä½¿ç¨ RocketMQãRabbitMQãå¦æææåºç¨é½æ¯ Javaï¼ä¼é RocketMQï¼å ä¸º RocketMQ æ¬èº«å°±æ¯ Java å¼åçï¼æä»¥æééãå¦æä¸å¡ä¸­æå¤ç§ç¼ç¨è¯­è¨çåºç¨ï¼å»ºè®®éæ© RabbitMQã\n * å¤§æ°æ®åæµå¼è®¡ç®é¢åï¼ææ¯ä½ä¸ºæ¥å¿ç¼å²ï¼å¼ºçå»ºè®®éæ© Kafkaï¼ä¸çæ åï¼ä¹ç»èéªã\n\n\n# 6. JMS\n\næå° MQï¼å°±é¡ºä¾¿æä¸ä¸ JMS ã\n\nJMSï¼JAVA Message Serviceï¼java æ¶æ¯æå¡ï¼API æ¯ä¸ä¸ªæ¶æ¯æå¡çæ å/è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº JavaEE å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nå¨ EJB æ¶æä¸­ï¼ææ¶æ¯ bean å¯ä»¥æ ç¼çä¸ JMS æ¶æ¯æå¡éæãå¨ J2EE æ¶ææ¨¡å¼ä¸­ï¼ææ¶æ¯æå¡èæ¨¡å¼ï¼ç¨äºå®ç°æ¶æ¯ä¸åºç¨ç´æ¥çè§£è¦ã\n\n\n# 6.1. æ¶æ¯æ¨¡å\n\nå¨ JMS æ åä¸­ï¼æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * P2P(Point to Point)\n * Pub/Sub(Publish/Subscribe)\n\n# P2P æ¨¡å¼\n\n\nP2P æ¨¡å¼åå«ä¸ä¸ªè§è²ï¼MQï¼Queueï¼ï¼åéè(Sender)ï¼æ¥æ¶è(Receiver)ãæ¯ä¸ªæ¶æ¯é½è¢«åéå°ä¸ä¸ªç¹å®çéåï¼æ¥æ¶èä»éåä¸­è·åæ¶æ¯ãéåä¿ççæ¶æ¯ï¼ç´å°ä»ä»¬è¢«æ¶è´¹æè¶æ¶ã\n\nP2P çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼Consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨ MQ ä¸­)\n * åéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éå\n * æ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æå\n\nå¦æå¸æåéçæ¯ä¸ªæ¶æ¯é½ä¼è¢«æåå¤ççè¯ï¼é£ä¹éè¦ P2P æ¨¡å¼ã\n\n# Pub/sub æ¨¡å¼\n\n\nåå«ä¸ä¸ªè§è²ä¸»é¢ï¼Topicï¼ï¼åå¸èï¼Publisherï¼ï¼è®¢éèï¼Subscriberï¼ ãå¤ä¸ªåå¸èå°æ¶æ¯åéå° Topic,ç³»ç»å°è¿äºæ¶æ¯ä¼ éç»å¤ä¸ªè®¢éèã\n\nPub/Sub çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹è\n * åå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼Topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ã\n * ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼JMS åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æå¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèåªè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ Pub/Sub æ¨¡åã\n\n\n# 6.2. æ¶æ¯æ¶è´¹\n\nå¨ JMS ä¸­ï¼æ¶æ¯çäº§çåæ¶è´¹é½æ¯å¼æ­¥çãå¯¹äºæ¶è´¹æ¥è¯´ï¼JMS çæ¶æ¯èå¯ä»¥éè¿ä¸¤ç§æ¹å¼æ¥æ¶è´¹æ¶æ¯ã\n\n * åæ­¥ - è®¢éèææ¥æ¶èéè¿ receive æ¹æ³æ¥æ¥æ¶æ¶æ¯ï¼receive æ¹æ³å¨æ¥æ¶å°æ¶æ¯ä¹åï¼æè¶æ¶ä¹åï¼å°ä¸ç´é»å¡ï¼\n * å¼æ­¥ - è®¢éèææ¥æ¶èå¯ä»¥æ³¨åä¸ºä¸ä¸ªæ¶æ¯çå¬å¨ãå½æ¶æ¯å°è¾¾ä¹åï¼ç³»ç»èªå¨è°ç¨çå¬å¨ç onMessage æ¹æ³ã\n\nJNDI - Java å½ååç®å½æ¥å£,æ¯ä¸ç§æ åç Java å½åç³»ç»æ¥å£ãå¯ä»¥å¨ç½ç»ä¸æ¥æ¾åè®¿é®æå¡ãéè¿æå®ä¸ä¸ªèµæºåç§°ï¼è¯¥åç§°å¯¹åºäºæ°æ®åºæå½åæå¡ä¸­çä¸ä¸ªè®°å½ï¼åæ¶è¿åèµæºè¿æ¥å»ºç«æå¿é¡»çä¿¡æ¯ã\n\nJNDI å¨ JMS ä¸­èµ·å°æ¥æ¾åè®¿é®åéç®æ ææ¶æ¯æ¥æºçä½ç¨ã\n\n\n# 6.3. JMS ç¼ç¨æ¨¡å\n\n# ConnectionFactory\n\nåå»º Connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ QueueConnectionFactory å TopicConnectionFactory ä¸¤ç§ãå¯ä»¥éè¿ JNDI æ¥æ¥æ¾ ConnectionFactory å¯¹è±¡ã\n\n# Destination\n\nDestination çæææ¯æ¶æ¯çäº§èçæ¶æ¯åéç®æ æèè¯´æ¶æ¯æ¶è´¹èçæ¶æ¯æ¥æºãå¯¹äºæ¶æ¯çäº§èæ¥è¯´ï¼å®ç Destination æ¯æä¸ªéåï¼Queueï¼ææä¸ªä¸»é¢ï¼Topicï¼;å¯¹äºæ¶æ¯æ¶è´¹èæ¥è¯´ï¼å®ç Destination ä¹æ¯æä¸ªéåæä¸»é¢ï¼å³æ¶æ¯æ¥æºï¼ã\n\næä»¥ï¼Destination å®éä¸å°±æ¯ä¸¤ç§ç±»åçå¯¹è±¡ï¼QueueãTopicãå¯ä»¥éè¿ JNDI æ¥æ¥æ¾ Destinationã\n\n# Connection\n\nConnection è¡¨ç¤ºå¨å®¢æ·ç«¯å JMS ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ TCP/IP socket çåè£ï¼ãConnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ª Sessionãè· ConnectionFactory ä¸æ ·ï¼Connection ä¹æä¸¤ç§ç±»åï¼QueueConnection å TopicConnectionã\n\n# Session\n\nSession æ¯æä½æ¶æ¯çæ¥å£ãå¯ä»¥éè¿ session åå»ºçäº§èãæ¶è´¹èãæ¶æ¯ç­ãSession æä¾äºäºå¡çåè½ãå½éè¦ä½¿ç¨ session åé/æ¥æ¶å¤ä¸ªæ¶æ¯æ¶ï¼å¯ä»¥å°è¿äºåé/æ¥æ¶å¨ä½æ¾å°ä¸ä¸ªäºå¡ä¸­ãåæ ·ï¼ä¹å QueueSession å TopicSessionã\n\n# æ¶æ¯ççäº§è\n\næ¶æ¯çäº§èç± Session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° Destinationãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼QueueSender å TopicPublisherãå¯ä»¥è°ç¨æ¶æ¯çäº§èçæ¹æ³ï¼send æ publish æ¹æ³ï¼åéæ¶æ¯ã\n\n# æ¶æ¯æ¶è´¹è\n\næ¶æ¯æ¶è´¹èç± Session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° Destination çæ¶æ¯ãä¸¤ç§ç±»åï¼QueueReceiver å TopicSubscriberãå¯åå«éè¿ session ç createReceiver(Queue)æ createSubscriber(Topic)æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatDurableSubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# MessageListener\n\næ¶æ¯çå¬å¨ãå¦ææ³¨åäºæ¶æ¯çå¬å¨ï¼ä¸æ¦æ¶æ¯å°è¾¾ï¼å°èªå¨è°ç¨çå¬å¨ç onMessage æ¹æ³ãEJB ä¸­ç MDBï¼Message-Driven Beanï¼å°±æ¯ä¸ç§ MessageListenerã\n\n\n# 7. åèèµæ\n\n * å¤§åç½ç«æ¶æç³»åï¼åå¸å¼ MQï¼ä¸ï¼\n * å¤§åç½ç«æ¶æç³»åï¼MQï¼äºï¼\n * åå¸å¼å¼æ¾ MQ(RocketMQ)çåçä¸å®è·µ\n * é¿é RocketMQ ä¼å¿å¯¹æ¯\n * advanced-java ä¹ MQ\n * æµè°æ¶æ¯éååå¸¸è§çæ¶æ¯ä¸­é´ä»¶',normalizedContent:'# æ¶æ¯éååºæ¬åç\n\n> ð¦ æ¬æå·²å½æ¡£å°ï¼ãblogã\n> \n> æ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n> \n> æ¶æ¯éåä¸»è¦è§£å³å¼æ­¥å¤çãåºç¨é´è¦åï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n> \n> ç®åä¸»æµç mq æï¼kafkaãrabbitmqãrocketmqãactivemqï¼èé¨åæ°æ®åºå¦ redisãmysql ä»¥å phxsql ä¹å¯å®ç°æ¶æ¯éåçåè½ã\n> \n> æ³¨æï¼ä¸ºäºç®ä¾¿ï¼ä¸æä¸­é¤äºæç« æ é¢ï¼ä¸å¾ä½¿ç¨ mq ç®ç§°ã\n\n\n# 1. mq çç®ä»\n\n\n# 1.1. ä»ä¹æ¯ mq\n\næ¶æ¯éåï¼message queueï¼ç®ç§° mqï¼ææ¯æ¯åºç¨é´äº¤æ¢ä¿¡æ¯çä¸ç§ææ¯ã\n\næ¶æ¯éåä¸»è¦è§£å³åºç¨è¦åï¼å¼æ­¥æ¶æ¯ï¼æµéåéç­é®é¢ï¼å®ç°é«æ§è½ï¼é«å¯ç¨ï¼å¯ä¼¸ç¼©åæç»ä¸è´æ§æ¶æãæ¯å¤§ååå¸å¼ç³»ç»ä¸å¯ç¼ºå°çä¸­é´ä»¶ã\n\nmq æ¯æ¶è´¹-çäº§èæ¨¡åçä¸ä¸ªå¸åçä»£è¡¨ï¼ä¸ç«¯å¾æ¶æ¯éåä¸­ä¸æ­åå¥æ¶æ¯ï¼èå¦ä¸ç«¯åå¯ä»¥è¯»åéåä¸­çæ¶æ¯ãæ¶æ¯åå¸èåªç®¡ææ¶æ¯åå¸å° mq ä¸­èä¸ç¨ç®¡è°æ¥åï¼æ¶æ¯ä½¿ç¨èåªç®¡ä» mq ä¸­åæ¶æ¯èä¸ç®¡æ¯è°åå¸çãè¿æ ·åå¸èåä½¿ç¨èé½ä¸ç¨ç¥éå¯¹æ¹çå­å¨ã\n\nmq çæ°æ®å¯é©»çå¨åå­æç£çä¸ï¼ç´å°å®ä»¬è¢«åºç¨ç¨åºè¯»åãéè¿ mqï¼åºç¨ç¨åºå¯ç¬ç«å°æ§è¡ï¼å®ä»¬ä¸éè¦ç¥éå½¼æ­¤çä½ç½®ï¼ä¸éè¦ç­å¾æ¥æ¶ç¨åºæ¥æ¶æ­¤æ¶æ¯ãå¨åå¸å¼è®¡ç®ç¯å¢ä¸­ï¼ä¸ºäºéæåå¸å¼åºç¨ï¼å¼åèéè¦å¯¹å¼æç½ç»ç¯å¢ä¸çåå¸å¼åºç¨æä¾ææçéä¿¡ææ®µãä¸ºäºç®¡çéè¦å±äº«çä¿¡æ¯ï¼å¯¹åºç¨æä¾å¬å±çä¿¡æ¯äº¤æ¢æºå¶æ¯éè¦çã\n\nç®åä¸»æµç mq æï¼kafkaãrabbitmqãrocketmqãactivemqã\n\n\n# 1.2. mq éä¿¡æ¨¡å\n\nmq éä¿¡æ¨¡åå¤§è´æä»¥ä¸ç±»åï¼\n\n * ç¹å¯¹ç¹ - ç¹å¯¹ç¹æ¹å¼æ¯æä¸ºä¼ ç»åå¸¸è§çéè®¯æ¹å¼ï¼å®æ¯æä¸å¯¹ä¸ãä¸å¯¹å¤ãå¤å¯¹å¤ãå¤å¯¹ä¸ç­å¤ç§éç½®æ¹å¼ï¼æ¯ææ ç¶ãç½ç¶ç­å¤ç§ææç»æã\n * å¤ç¹å¹¿æ­ - mq éç¨äºä¸åç±»åçåºç¨ãå¶ä¸­éè¦çï¼ä¹æ¯æ­£å¨åå±ä¸­çæ¯"å¤ç¹å¹¿æ­"åºç¨ï¼å³è½å¤å°æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ (destination list)ãå¯ä»¥ä½¿ç¨ä¸æ¡ mq æä»¤å°åä¸æ¶æ¯åéå°å¤ä¸ªç®æ ç«ç¹ï¼å¹¶ç¡®ä¿ä¸ºæ¯ä¸ç«ç¹å¯é å°æä¾ä¿¡æ¯ãmq ä¸ä»æä¾äºå¤ç¹å¹¿æ­çåè½ï¼èä¸è¿æ¥ææºè½æ¶æ¯åååè½ï¼å¨å°ä¸æ¡æ¶æ¯åéå°åä¸ç³»ç»ä¸çå¤ä¸ªç¨æ·æ¶ï¼mq å°æ¶æ¯çä¸ä¸ªå¤å¶çæ¬åè¯¥ç³»ç»ä¸æ¥æ¶èçåååéå°ç®æ  mq ç³»ç»ãç®æ  mq ç³»ç»å¨æ¬å°å¤å¶è¿äºæ¶æ¯ï¼å¹¶å°å®ä»¬åéå°ååä¸çéåï¼ä»èå°½å¯è½åå°ç½ç»çä¼ è¾éã\n * åå¸/è®¢é (publish/subscribe) - åå¸/è®¢éæ¨¡å¼ä½¿æ¶æ¯çååå¯ä»¥çªç ´ç®çéåå°çä½ç½®çéå¶ï¼ä½¿æ¶æ¯æç§ç¹å®çä¸»é¢çè³åå®¹è¿è¡ååï¼ç¨æ·æåºç¨ç¨åºå¯ä»¥æ ¹æ®ä¸»é¢æåå®¹æ¥æ¶å°æéè¦çæ¶æ¯ãåå¸/è®¢éæ¨¡å¼ä½¿å¾åéèåæ¥æ¶èä¹é´çè¦åå³ç³»åå¾æ´ä¸ºæ¾æ£ï¼åéèä¸å¿å³å¿æ¥æ¶èçç®çå°åï¼èæ¥æ¶èä¹ä¸å¿å³å¿æ¶æ¯çåéå°åï¼èåªæ¯æ ¹æ®æ¶æ¯çä¸»é¢è¿è¡æ¶æ¯çæ¶åã\n * éç¾¤ (cluster) - ä¸ºäºç®åç¹å¯¹ç¹éè®¯æ¨¡å¼ä¸­çç³»ç»éç½®ï¼mq æä¾ cluster(éç¾¤) çè§£å³æ¹æ¡ãéç¾¤ç±»ä¼¼äºä¸ä¸ªå (domain)ï¼éç¾¤åé¨çéåç®¡çå¨ä¹é´éè®¯æ¶ï¼ä¸éè¦ä¸¤ä¸¤ä¹é´å»ºç«æ¶æ¯ééï¼èæ¯éç¨éç¾¤ (cluster) ééä¸å¶å®æåéè®¯ï¼ä»èå¤§å¤§ç®åäºç³»ç»éç½®ãæ­¤å¤ï¼éç¾¤ä¸­çéåç®¡çå¨ä¹é´è½å¤èªå¨è¿è¡è´è½½åè¡¡ï¼å½æä¸éåç®¡çå¨åºç°æéæ¶ï¼å¶å®éåç®¡çå¨å¯ä»¥æ¥ç®¡å®çå·¥ä½ï¼ä»èå¤§å¤§æé«ç³»ç»çé«å¯é æ§ã\n\n\n# 2. mq çåºç¨\n\n\n# 2.1. å¼æ­¥å¤ç\n\n> mq å¯ä»¥å°ç³»ç»é´çå¤çæµç¨å¼æ­¥åï¼åå°ç­å¾ååºçæ¶é´ï¼ä»èæé«æ´ä½å¹¶åååéã\n> \n> ä¸è¬ï¼mq å¼æ­¥å¤çåºç¨äºéæ ¸å¿æµç¨ï¼ä¾å¦ï¼ç­ä¿¡/é®ä»¶éç¥ãæ°æ®æ¨éãä¸æ¥æ°æ®å°çæ§ä¸­å¿/æ¥å¿ä¸­å¿ç­ã\n\nåè®¾è¿æ ·ä¸ä¸ªåºæ¯ï¼ç¨æ·åç³»ç» a åèµ·è¯·æ±ï¼ç³»ç» a å¤çè®¡ç®åªéè¦ 10 msï¼ç¶åéç¥ç³»ç» bcd ååºï¼ç³»ç» bcd ååºèæ¶åå«ä¸ºï¼100msã200msã300msãæç»æ»èæ¶ä¸ºï¼ 10+100ms+200ms+300ms=610msãæ­¤å¤ï¼å ä¸è¯·æ±åååºçç½ç»ä¼ è¾æ¶é´ï¼ä»ç¨æ·è§åº¦çï¼å¯è½è¦ç­å¾å°è¿ 1s æè½å¾å°ç»æã\n\n\n\nå¦æä½¿ç¨ mqï¼ç³»ç» a æ¥å°è¯·æ±åï¼èæ¶ 10ms å¤çè®¡ç®ï¼ç¶ååç³»ç» bcd è¿ç»­åéæ¶æ¯ï¼åè®¾èæ¶ 5msãé£ä¹ è¿ä¸è¿ç¨çæ»èæ¶ä¸º 3ms + 5ms = 8msï¼è¿ç¸æ¯äº 610 msï¼å¤§å¤§ç¼©ç­äºååºæ¶é´ãè³äºç³»ç» bcd çååºæä½ï¼åªè¦èªè¡æ¶è´¹ mq åå¤çå³å¯ï¼ç¨æ·æ éå³æ³¨ã\n\n\n\n\n# 2.2. ç³»ç»è§£è¦\n\n> éè¿ mqï¼å¯ä»¥æ¶é¤ç³»ç»é´çå¼ºè¦åãå®çå¥½å¤å¨äºï¼\n> \n>  * æ¶æ¯çæ¶è´¹èç³»ç»å¯ä»¥éæå¢å ï¼æ éä¿®æ¹çäº§èç³»ç»çä»£ç ã\n>  * çäº§èç³»ç»ãæ¶è´¹èç³»ç»å½¼æ­¤ä¸ä¼å½±åå¯¹æ¹çæµç¨ã\n>    * å¦æçäº§èç³»ç»å®æºï¼æ¶è´¹èç³»ç»æ¶ä¸å°æ¶æ¯ï¼å°±ä¸ä¼æä¸ä¸æ­¥çå¨ä½ã\n>    * å¦ææ¶è´¹èç³»ç»å®æºï¼çäº§èç³»ç»è®©ç¶å¯ä»¥æ­£å¸¸åéæ¶æ¯ï¼ä¸å½±åæµç¨ã\n\nä¸åç³»ç»å¦æè¦å»ºç«éä¿¡ï¼ä¼ ç»çåæ³æ¯ï¼è°ç¨æ¥å£ã\n\nå¦æéè¦åæ°çç³»ç»å»ºç«éä¿¡æå é¤å·²å»ºç«çéä¿¡ï¼é½éè¦ä¿®æ¹ä»£ç ï¼è¿ç§æ¹æ¡æ¾ç¶è¦ååº¦å¾é«ã\n\n\n\nå¦æä½¿ç¨ mqï¼ç³»ç»é´çéä¿¡åªéè¦éè¿åå¸/è®¢éï¼pub/subï¼æ¨¡åå³å¯ï¼å½¼æ­¤æ²¡æç´æ¥èç³»ï¼ä¹å°±ä¸éè¦ç¸äºæç¥ï¼ä»èè¾¾å° è§£è¦ã\n\n\n\n\n# 2.3. æµéåå³°\n\n> å½ ä¸ä¸æ¸¸ç³»ç» å¤çè½åå­å¨å·®è·çæ¶åï¼å©ç¨ mq åä¸ä¸ª âæ¼æâ æ¨¡åï¼è¿è¡ æµæ§ãæ mq å½æå¯é ç æ¶æ¯æå­å°ï¼è¿è¡ä¸å®ç¨åº¦ç æ¶æ¯å ç§¯ï¼å¨ä¸æ¸¸æè½åå¤ççæ¶åï¼ååéæ¶æ¯ã\n> \n> mq çæµéåå³°å¸¸ç¨äºé«å¹¶ååºæ¯ï¼ä¾å¦ï¼ç§æãå¢æ¢ç­ä¸å¡åºæ¯ï¼ï¼å®æ¯ç¼è§£ç¬æ¶æ´å¢æµéçæ ¸å¿ææ®µä¹ä¸ã\n> \n> å¦ææ²¡æ mqï¼ä¸¤ä¸ªç³»ç»ä¹é´éè¿ ååãæ»å¨çªå£ãéæµ/éçº§/çæ­ ç­å¤æçæ¹æ¡ä¹è½å®ç° æµæ§ãä½ ç³»ç»å¤ææ§ ææ°çº§å¢é¿ï¼å¿å¿å¨ä¸æ¸¸æèä¸æ¸¸åå­å¨ï¼å¹¶ä¸è¦å¤ç å®æ¶ãæ¥å¡ ç­ä¸ç³»åé®é¢ãèä¸æ¯å½æ å¤çè½åæå·®è· çæ¶åï¼é½éè¦ åç¬ å¼åä¸å¥é»è¾æ¥ç»´æ¤è¿å¥é»è¾ã\n\nåè®¾æä¸ªç³»ç»è¯»åæ°æ®åºçç¨³å®æ§è½ä¸ºæ¯ç§å¤ç 1000 æ¡æ°æ®ãå¹³å¸¸æåµä¸ï¼è¿è¿è¾¾ä¸å°è¿ä¹å¤§çå¤çéãåè®¾ï¼å ä¸ºå ä¸ºåæ´»å¨ï¼ç³»ç»çç¬æ¶è¯·æ±éå§å¢ï¼è¾¾å°æ¯ç§ 10000 ä¸ªå¹¶åè¯·æ±ï¼æ°æ®åºæ ¹æ¬æ¿åä¸äºï¼å¯è½ç´æ¥å°±ææ°æ®åºç»æ´å´©æºäºï¼è¿æ ·ç³»ç»æå¡å°±ä¸å¯ç¨äºã\n\n\n\nå¦æä½¿ç¨ mqï¼æ¯ç§åå¥ 10000 æ¡è¯·æ±ï¼ä½æ¯ç³»ç» a æ¯ç§åªä» mq ä¸­æ¶è´¹ 1000 æ¡è¯·æ±ï¼ç¶ååå¥æ°æ®åºãè¿æ ·ï¼å°±ä¸ä¼è¶è¿æ°æ®åºçæ¿åè½åï¼èæ¯æè¯·æ±ç§¯åå¨ mq ä¸­ãåªè¦é«å³°æä¸è¿ï¼ç³»ç» a å°±ä¼å¾å¿«æç§¯åçæ¶æ¯ç»å¤çæã\n\n\n\n\n# 2.4. ä¼ è¾ç¼å²\n\nï¼1ï¼mq å¸¸è¢«ç¨äºåæµ·éæ°æ®çä¼ è¾ç¼å²ã\n\nä¾å¦ï¼kafka å¸¸è¢«ç¨äºåä¸ºåç§æ¥å¿æ°æ®ãééæ°æ®çæ°æ®ä¸­è½¬ãç¶åï¼kafka å°æ°æ®è½¬åç» logstashãelasticsearch ä¸­ï¼ç¶ååºäº elasticsearch æ¥åæ¥å¿ä¸­å¿ï¼æä¾æ£ç´¢ãèåãåææ¥å¿çè½åãå¼åèå¯ä»¥éè¿ kibana éæ elasticsearch æ°æ®è¿è¡å¯è§åå±ç¤ºï¼æèªè¡è¿è¡å®å¶åå¼åã\n\n\n\nï¼2ï¼mq ä¹å¯ä»¥è¢«ç¨äºæµå¼å¤çã\n\nä¾å¦ï¼kafka å ä¹å·²ç»æ¯æµè®¡ç®çæ°æ®ééç«¯çæ åç»ä»¶ãèæµè®¡ç®éè¿å®æ¶æ°æ®å¤çè½åï¼æä¾äºæ´ä¸ºå¿«æ·çèåè®¡ç®è½åï¼è¢«å¤§éåºç¨äºé¾è·¯çæ§ãå®æ¶çæ§ãå®æ¶æ°ä»ãå®æ¶å¤§å±ãé£æ§ãæ¨èç­åºç¨é¢åã\n\n\n# 2.5. æç»ä¸è´æ§\n\næç»ä¸è´æ§ ä¸æ¯ æ¶æ¯éå çå¿å¤ç¹æ§ï¼ä½ç¡®å®å¯ä»¥ä¾é  æ¶æ¯éå æ¥å æç»ä¸è´æ§ çäºæã\n\n * ååæ¶æ¯åæä½ï¼ç¡®ä¿æä½å®æååä¿®æ¹æ¶æ¯ç¶æãå®æ¶ä»»å¡è¡¥å¿æºå¶ å®ç°æ¶æ¯ å¯é åéæ¥æ¶ãä¸å¡æä½çå¯é æ§è¡ï¼è¦æ³¨æ æ¶æ¯éå¤ ä¸ å¹ç­è®¾è®¡ã\n * ææä¸ä¿è¯ 100% ä¸ä¸¢æ¶æ¯ çæ¶æ¯éåï¼çè®ºä¸æ æ³å®ç° æç»ä¸è´æ§ã\n\n> å kafka ä¸ç±»çè®¾è®¡ï¼å¨è®¾è®¡å±é¢ä¸å°±æ ä¸¢æ¶æ¯ çå¯è½ï¼æ¯å¦ å®æ¶å·çï¼å¦ææçµå°±ä¼ä¸¢æ¶æ¯ï¼ãåªæåªä¸¢ååä¹ä¸çæ¶æ¯ï¼ä¸å¡ä¹å¿é¡»ç¨å¶ä»çææ®µæ¥ä¿è¯ç»ææ­£ç¡®ã\n\n\n# 2.6. ç³»ç»é´éä¿¡\n\næ¶æ¯éåä¸è¬é½åç½®äº é«æçéä¿¡æºå¶ï¼å æ­¤ä¹å¯ä»¥ç¨äºåçº¯ç æ¶æ¯éè®¯ï¼æ¯å¦å®ç° ç¹å¯¹ç¹æ¶æ¯éå æè èå¤©å®¤ ç­ã\n\nçäº§è/æ¶è´¹è æ¨¡å¼ï¼åªéè¦å³å¿æ¶æ¯æ¯å¦ éè¾¾éåï¼è³äºè°å¸æè®¢éåéè¦æ¶è´¹ï¼æ¯ ä¸æ¸¸ çäºæï¼æ çæå¤§å°åå°äºå¼ååèè°çå·¥ä½éã\n\n\n# 3. mq çé®é¢\n\nä»»ä½ææ¯é½ä¼æå©æå¼ï¼mq ç»æ´ä½ç³»ç»æ¶æå¸¦æ¥å¾å¤å¥½å¤ï¼ä½ä¹ä¼ä»åºä¸å®çä»£ä»·ã\n\nmq ä¸»è¦å¼å¥äºä»¥ä¸é®é¢ï¼\n\n * ç³»ç»å¯ç¨æ§éä½ï¼å¼å¥äº mq åï¼éä¿¡éè¦åºäº mq å®æï¼å¦æ mq å®æºï¼åæå¡ä¸å¯ç¨ãå æ­¤ï¼mq è¦ä¿è¯æ¯é«å¯ç¨çï¼è¯¦æåèï¼mq çé«å¯ç¨\n * ç³»ç»å¤æåº¦æé«ï¼ä½¿ç¨ mqï¼éè¦å³æ³¨ä¸äºæ°çé®é¢ï¼\n   * å¦ä½ä¿è¯æ¶æ¯æ²¡æ éå¤æ¶è´¹ï¼\n   * å¦ä½å¤ç æ¶æ¯ä¸¢å¤± çé®é¢ï¼\n   * å¦ä½ä¿è¯ä¼ é æ¶æ¯çé¡ºåºæ§ï¼\n   * å¦ä½å¤çå¤§é æ¶æ¯ç§¯å çé®é¢ï¼\n * ä¸è´æ§é®é¢ï¼åè®¾ç³»ç» a å¤çå®ç´æ¥è¿åæåçç»æç»ç¨æ·ï¼ç¨æ·è®¤ä¸ºè¯·æ±æåãä½å¦ææ­¤æ¶ï¼ç³»ç» bcd ä¸­åªè¦æä»»æä¸ä¸ªååºå¤±è´¥ï¼é£ä¹æ°æ®å°±ä¸ä¸è´äºãè¿ç§æåµå¦ä½å¤çï¼\n\nä¸é¢ï¼æä»¬éå¯¹ä»¥ä¸é®é¢æ¥ä¸ä¸åæã\n\n\n# 3.1. éå¤æ¶è´¹\n\nå¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ å å¦ä½ä¿è¯æ¶æ¯æ¶è´¹çå¹ç­æ§ æ¯åä¸ä¸ªé®é¢ã\n\nå¿é¡»åæç¡®äº§çéå¤æ¶è´¹çåå ï¼æè½å¯¹çä¸è¯ã\n\n# éå¤æ¶è´¹é®é¢åå \n\néå¤æ¶è´¹é®é¢éå¸¸ä¸æ¯ mq æ¥å¤çï¼èæ¯ç±å¼åæ¥å¤ççã\n\nä»¥ kafka ä¸¾ä¾ï¼kafka æ¯ä¸ª partition é½æ¯ä¸ä¸ªæåºçãä¸å¯åçè®°å½åºåï¼ä¸æ­è¿½å å°ç»æåçæäº¤æ¥å¿ä¸­ãpartition ä¸­ä¸ºæ¯æ¡è®°å½åéä¸ä¸ªè¿ç»­ç id å·ï¼ç§°ä¸ºåç§»éï¼offsetï¼ï¼ç¨äºå¯ä¸æ è¯ partition åçè®°å½ã\n\nkafka çå®¢æ·ç«¯å broker é½ä¼ä¿å­ offsetãå®¢æ·ç«¯æ¶è´¹æ¶æ¯åï¼æ¯éä¸æ®µæ¶é´ï¼å°±æå·²æ¶è´¹ç offset æäº¤ç» kafka brokerï¼è¡¨ç¤ºå·²æ¶è´¹ã\n\n\n\nå¨è¿ä¸ªè¿ç¨ä¸­ï¼å¦æå®¢æ·ç«¯åºç¨æ¶è´¹æ¶æ¯åï¼å ä¸ºå®æºãéå¯ç­æåµèæ²¡ææäº¤å·²æ¶è´¹ç offset ãå½ç³»ç»æ¢å¤åï¼ä¼ç»§ç»­æ¶è´¹æ¶æ¯ï¼ç±äº offset æªæäº¤ï¼å°±ä¼åºç°éå¤æ¶è´¹çé®é¢ã\n\n# éå¤æ¶è´¹è§£å³æ¹æ¡\n\nåºå¯¹éå¤æ¶è´¹é®é¢ï¼éè¦å¨ä¸å¡å±é¢ï¼éè¿ å¹ç­æ§è®¾è®¡ æ¥è§£å³ã\n\nmq éå¤æ¶è´¹ä¸å¯æï¼å¯æçæ¯æ²¡æåºå¯¹æºå¶ï¼å¯ä»¥åé´çæè·¯æï¼\n\n * å¦ææ¯åå³ç³»åæ°æ®åºï¼å¯ä»¥åæ ¹æ®ä¸»é®æ¥è¯¢ï¼å¤æ­æ°æ®æ¯å¦å·²å­å¨ï¼å­å¨åæ´æ°ï¼ä¸å­å¨åæå¥ï¼\n * å¦ææ¯å redisï¼ç±äº set æä½å¤©ç¶å·æå¹ç­æ§ï¼æä»¥ä»ä¹é½ä¸ç¨åï¼\n * å¦ææ¯æ ¹æ®æ¶æ¯åè¾å¤æçé»è¾å¤çï¼å¯ä»¥å¨æ¶æ¯ä¸­å å¥å¨å±å¯ä¸ idï¼ä¾å¦ï¼è®¢å id ç­ãå¨å®¢æ·ç«¯å­å¨ä¸­ï¼mysqlãredis ç­ï¼ä¿å­å·²æ¶è´¹æ¶æ¯ç idãä¸æ¦æ¥åå°æ°æ¶æ¯ï¼åå¤æ­æ¶æ¯ä¸­ç id æ¯å¦å¨å·²æ¶è´¹æ¶æ¯ id è¡¨ä¸­å­å¨ï¼å­å¨åä¸åå¤çï¼ä¸å­å¨åå¤çã\n\nå¨å®éå¼åä¸­ï¼å¯ä»¥åèä¸é¢çä¾å­ï¼ç»åç°å®åºæ¯ï¼è®¾è®¡åççå¹ç­æ§æ¹æ¡ã\n\n\n# 3.2. æ¶æ¯ä¸¢å¤±\n\nå¦ä½å¤çæ¶æ¯ä¸¢å¤±çé®é¢ å å¦ä½ä¿è¯æ¶æ¯ä¸è¢«éå¤æ¶è´¹ æ¯åä¸ä¸ªé®é¢ãå³æ³¨ç¹æï¼\n\n * mq server ä¸¢å¤±æ°æ®\n * æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n * çäº§æ¹ä¸¢å¤±æ°æ®\n\n# æ¶è´¹æ¹ä¸¢å¤±æ°æ®\n\nå¯ä¸å¯è½å¯¼è´æ¶è´¹æ¹ä¸¢å¤±æ°æ®çæåµæ¯ï¼æ¶è´¹æ¹è®¾ç½®äºèªå¨æäº¤ offsetãä¸æ¦è®¾ç½®äºèªå¨æäº¤ offsetï¼æ¥åå°æ¶æ¯åå°±ä¼èªå¨æäº¤ offset ç» kafka ï¼kafka å°±è®¤ä¸ºæ¶æ¯å·²è¢«æ¶è´¹ãå¦ææ­¤æ¶ï¼æ¶è´¹æ¹å°æªæ¥å¾åå¤çæ¶æ¯å°±æäºï¼é£ä¹æ¶æ¯å°±ä¸¢äºã\n\nè§£å³æ¹æ³å°±æ¯ï¼æ¶è´¹æ¹å³é­èªå¨æäº¤ offsetï¼å¤çå®æ¶æ¯åæå¨æäº¤ offsetãä½è¿ç§æåµä¸å¯è½ä¼åºç°éå¤æ¶è´¹çæå½¢ï¼éè¦èªè¡ä¿è¯å¹ç­æ§ã\n\n# kafka server ä¸¢å¤±æ°æ®\n\nå½ kafka æä¸ª broker å®æºï¼éè¦éæ°éä¸¾ partition ç leaderãè¥æ­¤æ¶å¶ä»ç follower å°æªåæ­¥ leader çæ°æ®ï¼é£ä¹æ°éæä¸ª follower ä¸º leader åï¼å°±ä¸¢å¤±äºé¨åæ°æ®ã\n\nä¸ºæ­¤ï¼ä¸è¬è¦æ±è³å°è®¾ç½® 4 ä¸ªåæ°ï¼\n\n * ç» topic è®¾ç½® replication.factor åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¦æ±æ¯ä¸ª partition å¿é¡»æè³å° 2 ä¸ªå¯æ¬ã\n * å¨ kafka æå¡ç«¯è®¾ç½® min.insync.replicas åæ° - è¿ä¸ªå¼å¿é¡»å¤§äº 1ï¼è¿æ¯è¦æ±ä¸ä¸ª leader éè¦åè³å°ä¸ä¸ª follower ä¿æéä¿¡ï¼è¿æ ·æè½ç¡®ä¿ leader æäºè¿ææ¿è¡¥ã\n * å¨ producer ç«¯è®¾ç½® acks=all - è¿æå³çï¼è¦æ±æ¯æ¡æ°æ®ï¼å¿é¡»æ¯åå¥ææ replica ä¹åï¼æè½è®¤ä¸ºåå¥æåäºã\n * å¨ producer ç«¯è®¾ç½® retries=maxï¼å¾å¤§å¾å¤§å¾å¤§çä¸ä¸ªå¼ï¼æ éæ¬¡éè¯çææï¼ - è¿æå³çè¦æ±ä¸æ¦åå¥å¤±è´¥ï¼å°±æ ééè¯ï¼å¡å¨è¿éäºã\n\n# çäº§æ¹ä¸¢å¤±æ°æ®\n\nå¦ææç§ä¸è¿°çæè·¯è®¾ç½®äº acks=allï¼çäº§æ¹ä¸å®ä¸ä¼ä¸¢æ°æ®ã\n\nè¦æ±æ¯ï¼ä½ ç leader æ¥æ¶å°æ¶æ¯ï¼ææç follower é½åæ­¥å°äºæ¶æ¯ä¹åï¼æè®¤ä¸ºæ¬çäº§æ¶æ¯æåäºãå¦ææªæ»¡è¶³è¿ä¸ªæ¡ä»¶ï¼çäº§èä¼èªå¨ä¸æ­çéè¯ï¼éè¯æ éæ¬¡ã\n\n\n# 3.3. æ¶æ¯çé¡ºåºæ§\n\nè¦ä¿è¯ mq çé¡ºåºæ§ï¼å¿å¿è¦ä»åºä¸å®çä»£ä»·ï¼æä»¥å®æ½æ¹æ¡åï¼è¦åæç¡®ä¸å¡åºæ¯æ¯ä¸æ¯æå¿è¦ä¿è¯æ¶æ¯çé¡ºåºæ§ãåªæé£äºæç¡®å¯¹æ¶æ¯å¤çé¡ºåºæè¦æ±çä¸å¡åºæ¯æå¼å¾å»ä¿è¯æ¶æ¯é¡ºåºæ§ã\n\næ¹æ¡ä¸\n\nä¸ä¸ª topicï¼ä¸ä¸ª partitionï¼ä¸ä¸ª consumerï¼åé¨åçº¿ç¨æ¶è´¹ï¼åçº¿ç¨ååéå¤ªä½ï¼ä¸è¬ä¸ä¼ç¨è¿ä¸ªã\n\næ¹æ¡äº\n\n * åå¥æ°æ®å° partition æ¶æå®ä¸ä¸ªå¨å±å¯ä¸ç idï¼ä¾å¦è®¢å idãåéæ¹ä¿è¯ç¸å id çæ¶æ¯æåºçåéå°åä¸ä¸ª partitionã\n * åºäºä¸ä¸ç¹ï¼æ¶è´¹æ¹ä» kafka partition ä¸­æ¶è´¹æ¶æ¯æ¶ï¼æ­¤å»ä¸å®æ¯é¡ºåºçãä½å¦ææ¶è´¹æ¹å¼ä»¥å¹¶åæ¹å¼æ¶è´¹æ¶æ¯ï¼é¡ºåºå°±å¯è½ä¼è¢«æä¹±ãä¸ºæ­¤ï¼è¿æåå°ä»¥ä¸å ç¹ï¼\n   * æ¶è´¹æ¹ç»´æ¤ n ä¸ªç¼å­éåï¼å·æç¸å id çæ°æ®é½åå¥åä¸ä¸ªéåä¸­ï¼\n   * åå»º n ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨åªè´è´£ä»æå®çä¸ä¸ªéåä¸­åæ°æ®ã\n\n\n\n\n# 3.4. æ¶æ¯ç§¯å\n\nåè®¾ä¸ä¸ª mq æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 1000 æ¡æ¶æ¯ï¼ä¸ä¸ª mq æ¶è´¹èå¯ä»¥ä¸ç§å¤ç 3000 æ¡æ¶æ¯ï¼é£ä¹ä¸åéçå¤çéæ¯ 18 ä¸æ¡ãå¦æ mq ä¸­ç§¯åäºå ç¾ä¸å°ä¸åä¸çæ°æ®ï¼å³ä½¿æ¶è´¹èæ¢å¤äºï¼ä¹éè¦å¤§æ¦å¾é¿çæ¶é´æè½æ¢å¤è¿æ¥ã\n\nå¯¹äºäº§çº¿ç¯å¢æ¥è¯´ï¼æ¼«é¿çç­å¾æ¯ä¸å¯æ¥åçï¼æä»¥é¢ä¸´è¿ç§çªå¢æ¶ï¼åªè½ä¸´æ¶ç´§æ¥æ©å®¹ä»¥åºå¯¹äºï¼å·ä½æä½æ­¥éª¤åæè·¯å¦ä¸ï¼\n\n * åä¿®å¤ consumer çé®é¢ï¼ç¡®ä¿å¶æ¢å¤æ¶è´¹éåº¦ï¼ç¶åå°ç°æ consumer é½åæã\n * æ°å»ºä¸ä¸ª topicï¼partition æ¯åæ¥ç 10 åï¼ä¸´æ¶å»ºç«å¥½åå 10 åç queue æ°éã\n * ç¶ååä¸ä¸ªä¸´æ¶çååæ°æ®ç consumer ç¨åºï¼è¿ä¸ªç¨åºé¨ç½²ä¸å»æ¶è´¹ç§¯åçæ°æ®ï¼æ¶è´¹ä¹åä¸åèæ¶çå¤çï¼ç´æ¥ååè½®è¯¢åå¥ä¸´æ¶å»ºç«å¥½ç 10 åæ°éç queueã\n * æ¥çä¸´æ¶å¾ç¨ 10 åçæºå¨æ¥é¨ç½² consumer ï¼æ¯ä¸æ¹ consumer æ¶è´¹ä¸ä¸ªä¸´æ¶ queue çæ°æ®ãè¿ç§åæ³ç¸å½äºæ¯ä¸´æ¶å° queue èµæºå consumer èµæºæ©å¤§ 10 åï¼ä»¥æ­£å¸¸ç 10 åéåº¦æ¥æ¶è´¹æ°æ®ã\n * ç­å¿«éæ¶è´¹å®ç§¯åæ°æ®ä¹åï¼å¾æ¢å¤ååé¨ç½²çæ¶æï¼éæ°ç¨ååç consumer æºå¨æ¥æ¶è´¹æ¶æ¯ã\n\n\n# 4. mq çé«å¯ç¨\n\nä¸å mq å®ç°é«å¯ç¨çåçåä¸ç¸åãå ä¸º kafka æ¯è¾å·æä»£è¡¨æ§ï¼æä»¥è¿éä»¥ kafka ä¸ºä¾ã\n\n\n# 4.1. kafka çé«å¯ç¨\n\n# kafka çæ ¸å¿æ¦å¿µ\n\näºè§£ kafkaï¼å¿é¡»åäºè§£ kafka çæ ¸å¿æ¦å¿µï¼\n\n * broker - kafka éç¾¤åå«ä¸ä¸ªæå¤ä¸ªèç¹ï¼è¿ç§èç¹è¢«ç§°ä¸º brokerã\n\n * topic - æ¯æ¡åå¸å° kafka éç¾¤çæ¶æ¯é½æä¸ä¸ªç±»å«ï¼è¿ä¸ªç±»å«è¢«ç§°ä¸º topicãï¼ä¸å topic çæ¶æ¯æ¯ç©çéç¦»çï¼åä¸ä¸ª topic çæ¶æ¯ä¿å­å¨ä¸ä¸ªæå¤ä¸ª broker ä¸ï¼ä½ç¨æ·åªéæå®æ¶æ¯ç topic å³å¯çäº§ææ¶è´¹æ°æ®èä¸å¿å³å¿æ°æ®å­äºä½å¤ï¼ãå¯¹äºæ¯ä¸ä¸ª topicï¼ kafka éç¾¤é½ä¼ç»´æä¸ä¸ªååºæ¥å¿ã\n\n * partition - äºæé« kafka çååçï¼æ¯ä¸ª topic åå«ä¸ä¸ªæå¤ä¸ª partitionï¼æ¯ä¸ª partition å¨ç©çä¸å¯¹åºä¸ä¸ªæä»¶å¤¹ï¼è¯¥æä»¶å¤¹ä¸å­å¨è¿ä¸ª partition çæææ¶æ¯åç´¢å¼æä»¶ã\n   \n   * kafka æ¥å¿çååºï¼partitionï¼åå¸å¨ kafka éç¾¤çèç¹ä¸ãæ¯ä¸ªèç¹å¨å¤çæ°æ®åè¯·æ±æ¶ï¼å±äº«è¿äºååºãæ¯ä¸ä¸ªååºé½ä¼å¨å·²éç½®çèç¹ä¸è¿è¡å¤ä»½ï¼ç¡®ä¿å®¹éæ§ã\n\n\n\n# kafka çå¯æ¬æºå¶\n\nkafka æ¯å¦ä½å®ç°é«å¯ç¨çå¢ï¼\n\nkafka å¨ 0.8 ä»¥åççæ¬ä¸­ï¼å¦æä¸ä¸ª broker å®æºäºï¼å¶ä¸é¢ç partition é½ä¸è½ç¨äºï¼è¿èªç¶ä¸æ¯é«å¯ç¨çã\n\nä¸ºäºå®ç°é«å¯ç¨ï¼kafka å¼å¥äºå¤å¶åè½ã\n\nç®åæ¥è¯´ï¼å°±æ¯å¯æ¬æºå¶ï¼ replicate ï¼ã\n\næ¯ä¸ª partition é½æä¸ä¸ª leaderï¼é¶ä¸ªæå¤ä¸ª followerãleader å follower é½æ¯ brokerï¼æ¯ä¸ª broker é½ä¼æä¸ºæäºååºç leader åæäºååºç followerï¼å æ­¤éç¾¤çè´è½½æ¯å¹³è¡¡çã\n\n * leader å¤çä¸åå¯¹ partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n * è follower åªéè¢«å¨çåæ­¥ leader ä¸çæ°æ®ã\n\nåä¸ä¸ª topic çä¸å partition ä¼åå¸å¨å¤ä¸ª broker ä¸ï¼èä¸ä¸ä¸ª partition è¿ä¼å¨å¶ä»ç broker ä¸é¢è¿è¡å¤ä»½ï¼producer å¨åå¸æ¶æ¯å°æä¸ª partition æ¶ï¼åæ¾å°è¯¥ partition ç leaderï¼ç¶ååè¿ä¸ª leader æ¨éæ¶æ¯ï¼æ¯ä¸ª follower é½ä» leader æåæ¶æ¯ï¼æåæ¶æ¯æåä¹åï¼å leader åéä¸ä¸ª ack ç¡®è®¤ã\n\n\n\n> faq\n> \n> é®ï¼ä¸ºä»ä¹è®© leader å¤çä¸åå¯¹å¯¹ partition ï¼ååºï¼çè¯»åè¯·æ±ï¼\n> \n> ç­ï¼å ä¸ºå¦æåè®¸ææ broker é½å¯ä»¥å¤çè¯»åè¯·æ±ï¼å°±å¯è½äº§çæ°æ®ä¸è´æ§é®é¢ã\n\n# kafka éä¸¾ leader\n\nç±ä¸æå¯ç¥ï¼partition å¨å¤ä¸ª broker ä¸å­å¨å¯æ¬ã\n\nå¦ææä¸ª follower å®æºï¼å¥äºå¿æ²¡æï¼æ­£å¸¸å·¥ä½ã\n\nå¦æ leader å®æºäºï¼ä¼ä» follower ä¸­éæ°éä¸¾ä¸ä¸ªæ°ç leaderã\n\n\n# 5. ä¸»æµ mq\n\n\n# 5.1. activemq\n\nactivemq æ¯ç± apache åºåï¼activemq æ¯ä¸ä¸ªå®å¨æ¯æjms1.1 å j2ee 1.4 è§èç jms provider å®ç°ãå®éå¸¸å¿«éï¼æ¯æ å¤ç§è¯­è¨çå®¢æ·ç«¯ å åè®®ï¼èä¸å¯ä»¥éå¸¸å®¹æçåµå¥å°ä¼ä¸çåºç¨ç¯å¢ä¸­ï¼å¹¶æè®¸å¤é«çº§åè½ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. æä» jms è§èï¼jms è§èæä¾äºè¯å¥½çæ ååä¿è¯ï¼åæ¬ï¼åæ­¥ æ å¼æ­¥ çæ¶æ¯ååï¼ä¸æ¬¡åä»ä¸æ¬¡çæ¶æ¯ååï¼æ¶æ¯æ¥æ¶ å è®¢é ç­ç­ãéµä» jms è§èçå¥½å¤å¨äºï¼ä¸è®ºä½¿ç¨ä»ä¹ jms å®ç°æä¾èï¼è¿äºåºç¡ç¹æ§é½æ¯å¯ç¨çï¼\n 2. è¿æ¥çµæ´»æ§ï¼activemq æä¾äºå¹¿æ³ç è¿æ¥åè®®ï¼æ¯æçåè®®æï¼http/sï¼ip å¤æ­ï¼sslï¼tcpï¼udp ç­ç­ãå¯¹ä¼å¤åè®®çæ¯æè®© activemq æ¥æäºå¾å¥½ççµæ´»æ§ï¼\n 3. æ¯æçåè®®ç§ç±»å¤ï¼openwireãstompãrestãxmppãamqpï¼\n 4. æä¹åæä»¶åå®å¨æä»¶ï¼activemq æä¾äº å¤ç§æä¹å éæ©ãèä¸ï¼activemq çå®å¨æ§ä¹å¯ä»¥å®å¨ä¾æ®ç¨æ·éæ±è¿è¡ èªå®ä¹é´æ å ææï¼\n 5. æ¯æçå®¢æ·ç«¯è¯­è¨ç§ç±»å¤ï¼é¤äº java ä¹å¤ï¼è¿æï¼c/c++ï¼.netï¼perlï¼phpï¼pythonï¼rubyï¼\n 6. ä»£çéç¾¤ï¼å¤ä¸ª activemq ä»£ç å¯ä»¥ç»æä¸ä¸ª éç¾¤ æ¥æä¾æå¡ï¼\n 7. å¼å¸¸ç®åçç®¡çï¼activemq æ¯ä»¥å¼åèæç»´è¢«è®¾è®¡çãæä»¥ï¼å®å¹¶ä¸éè¦ä¸é¨çç®¡çåï¼å ä¸ºå®æä¾äºç®ååä½¿ç¨çç®¡çç¹æ§ãæå¾å¤ä¸­æ¹æ³å¯ä»¥ çæ§ activemq ä¸åå±é¢çæ°æ®ï¼åæ¬ä½¿ç¨å¨ jconsole æèå¨ activemq ç web console ä¸­ä½¿ç¨ jmxãéè¿å¤ç jmx çåè­¦æ¶æ¯ï¼éè¿ä½¿ç¨ å½ä»¤è¡èæ¬ï¼çè³å¯ä»¥éè¿çæ§åç§ç±»åç æ¥å¿ã\n\n# (b) é¨ç½²ç¯å¢\n\nactivemq å¯ä»¥è¿è¡å¨ java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ activemq éè¦ï¼\n\n * java jdk\n * activemq å®è£å\n\n# (c) ä¼ç¹\n\n 1. è·¨å¹³å° (java ç¼åä¸å¹³å°æ å³ï¼activemq å ä¹å¯ä»¥è¿è¡å¨ä»»ä½ç jvm ä¸)ï¼\n 2. å¯ä»¥ç¨ jdbcï¼å¯ä»¥å° æ°æ®æä¹å å°æ°æ®åºãè½ç¶ä½¿ç¨ jdbc ä¼éä½ activemq çæ§è½ï¼ä½æ¯æ°æ®åºä¸ç´é½æ¯å¼åäººåæçæçå­å¨ä»è´¨ï¼\n 3. æ¯æ jms è§èï¼æ¯æ jms è§èæä¾ç ç»ä¸æ¥å£;\n 4. æ¯æ èªå¨éè¿ å éè¯¯éè¯æºå¶ï¼\n 5. æå®å¨æºå¶ï¼æ¯æåºäº shiroï¼jaas ç­å¤ç§ å®å¨éç½®æºå¶ï¼å¯ä»¥å¯¹ queue/topic è¿è¡ è®¤è¯åææï¼\n 6. çæ§å®åï¼æ¥æå®åç çæ§ï¼åæ¬ web consoleï¼jmxï¼shell å½ä»¤è¡ï¼jolokia ç restful apiï¼\n 7. çé¢ååï¼æä¾ç web console å¯ä»¥æ»¡è¶³å¤§é¨åæåµï¼è¿æå¾å¤ ç¬¬ä¸æ¹çç»ä»¶ å¯ä»¥ä½¿ç¨ï¼æ¯å¦ hawtioï¼\n\n# (d) ç¼ºç¹\n\n 1. ç¤¾åºæ´»è·åº¦ä¸å rabbitmq é«ï¼\n 2. æ ¹æ®å¶ä»ç¨æ·åé¦ï¼ä¼åºè«åå¶å¦çé®é¢ï¼ä¼ ä¸¢å¤±æ¶æ¯ï¼\n 3. ç®åéå¿æ¾å° activemq 6.0 äº§å apolloï¼å¯¹ 5.x çç»´æ¤è¾å°ï¼\n 4. ä¸éåç¨äº ä¸åä¸ªéå çåºç¨åºæ¯ï¼\n\n\n# 5.2. rabbitmq\n\nrabbitmq äº 2007 å¹´åå¸ï¼æ¯ä¸ä¸ªå¨ amqp (é«çº§æ¶æ¯éååè®®)åºç¡ä¸å®æçï¼å¯å¤ç¨çä¼ä¸æ¶æ¯ç³»ç»ï¼æ¯å½åæä¸»æµçæ¶æ¯ä¸­é´ä»¶ä¹ä¸ã\n\n\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¯é æ§ï¼æä¾äºå¤ç§ææ¯å¯ä»¥è®©ä½ å¨ æ§è½ å å¯é æ§ ä¹é´è¿è¡ æè¡¡ãè¿äºææ¯åæ¬ æä¹æ§æºå¶ãæéç¡®è®¤ãåå¸èè¯å® å é«å¯ç¨æ§æºå¶ï¼\n 2. çµæ´»çè·¯ç±ï¼æ¶æ¯å¨å°è¾¾éååæ¯éè¿ äº¤æ¢æº è¿è¡ è·¯ç± çãrabbitmq ä¸ºå¸åçè·¯ç±é»è¾æä¾äº å¤ç§åç½®äº¤æ¢æº ç±»åãå¦æä½ ææ´å¤æçè·¯ç±éæ±ï¼å¯ä»¥å°è¿äºäº¤æ¢æºç»åèµ·æ¥ä½¿ç¨ï¼ä½ çè³å¯ä»¥å®ç°èªå·±çäº¤æ¢æºç±»åï¼å¹¶ä¸å½å rabbitmq ç æä»¶ æ¥ä½¿ç¨ï¼\n 3. æ¶æ¯éç¾¤ï¼å¨ç¸åå±åç½ä¸­çå¤ä¸ª rabbitmq æå¡å¨å¯ä»¥ èå å¨ä¸èµ·ï¼ä½ä¸ºä¸ä¸ªç¬ç«çé»è¾ä»£çæ¥ä½¿ç¨ï¼\n 4. éåé«å¯ç¨ï¼éåå¯ä»¥å¨éç¾¤ä¸­çæºå¨ä¸ è¿è¡éåï¼ä»¥ç¡®ä¿å¨ç¡¬ä»¶é®é¢ä¸è¿ä¿è¯ æ¶æ¯å®å¨ï¼\n 5. æ¯æå¤ç§åè®®ï¼æ¯æ å¤ç§æ¶æ¯éååè®®ï¼\n 6. æ¯æå¤ç§è¯­è¨ï¼ç¨ erlang è¯­è¨ç¼åï¼æ¯æåªè¦æ¯ä½ è½æ³å°ç ææç¼ç¨è¯­è¨ï¼\n 7. ç®¡ççé¢ï¼ rabbitmq æä¸ä¸ªæç¨ç ç¨æ·çé¢ï¼ä½¿å¾ç¨æ·å¯ä»¥ çæ§ å ç®¡ç æ¶æ¯ broker çè®¸å¤æ¹é¢ï¼\n 8. è·è¸ªæºå¶ï¼å¦æ æ¶æ¯å¼å¸¸ï¼rabbitmq æä¾æ¶æ¯è·è¸ªæºå¶ï¼ä½¿ç¨èå¯ä»¥æ¾åºåçäºä»ä¹ï¼\n 9. æä»¶æºå¶ï¼æä¾äºè®¸å¤ æä»¶ï¼æ¥ä»å¤æ¹é¢è¿è¡æ©å±ï¼ä¹å¯ä»¥ç¼åèªå·±çæä»¶ã\n\n# (b) é¨ç½²ç¯å¢\n\nrabbitmq å¯ä»¥è¿è¡å¨ erlang è¯­è¨ææ¯æçå¹³å°ä¹ä¸ï¼åæ¬ solarisï¼bsdï¼linuxï¼macosxï¼tru64ï¼windows ç­ãä½¿ç¨ rabbitmq éè¦ï¼\n\n * erlang è¯­è¨å\n * rabbitmq å®è£å\n\n# (c) ä¼ç¹\n\n 1. ç±äº erlang è¯­è¨çç¹æ§ï¼æ¶æ¯éåæ§è½è¾å¥½ï¼æ¯æ é«å¹¶åï¼\n 2. å¥å£®ãç¨³å®ãæç¨ãè·¨å¹³å°ãæ¯æ å¤ç§è¯­è¨ãææ¡£é½å¨ï¼\n 3. ææ¶æ¯ ç¡®è®¤æºå¶ å æä¹åæºå¶ï¼å¯é æ§é«ï¼\n 4. é«åº¦å¯å®å¶ç è·¯ç±ï¼\n 5. ç®¡ççé¢ è¾ä¸°å¯ï¼å¨äºèç½å¬å¸ä¹æè¾å¤§è§æ¨¡çåºç¨ï¼ç¤¾åºæ´»è·åº¦é«ã\n\n# (d) ç¼ºç¹\n\n 1. å°½ç®¡ç»å erlang è¯­è¨æ¬èº«çå¹¶åä¼å¿ï¼æ§è½è¾å¥½ï¼ä½æ¯ä¸å©äºå äºæ¬¡å¼ååç»´æ¤ï¼\n 2. å®ç°äº ä»£çæ¶æï¼æå³çæ¶æ¯å¨åéå°å®¢æ·ç«¯ä¹åå¯ä»¥å¨ ä¸­å¤®èç¹ ä¸æéãæ­¤ç¹æ§ä½¿å¾ rabbitmq æäºä½¿ç¨åé¨ç½²ï¼ä½æ¯ä½¿å¾å¶ è¿è¡éåº¦è¾æ¢ï¼å ä¸ºä¸­å¤®èç¹ å¢å äºå»¶è¿ï¼æ¶æ¯å°è£å ä¹æ¯è¾å¤§ï¼\n 3. éè¦å­¦ä¹  æ¯è¾å¤æ ç æ¥å£ååè®®ï¼å­¦ä¹ åç»´æ¤ææ¬è¾é«ã\n\n\n# 5.3. rocketmq\n\nrocketmq åºèª é¿é çå¼æºäº§åï¼ç¨ java è¯­è¨å®ç°ï¼å¨è®¾è®¡æ¶åèäº kafkaï¼å¹¶ååºäºèªå·±çä¸äºæ¹è¿ï¼æ¶æ¯å¯é æ§ä¸ æ¯ kafka æ´å¥½ãrocketmq å¨é¿éåé¨ \b è¢«å¹¿æ³åºç¨å¨ è®¢åï¼äº¤æï¼åå¼ï¼æµè®¡ç®ï¼æ¶æ¯æ¨éï¼æ¥å¿æµå¼å¤çï¼binglog åå ç­åºæ¯ã\n\n# (a) ä¸»è¦ç¹æ§\n\n![img](data:image/svg+xml;utf8,)\n\n 1. åºäº éåæ¨¡åï¼å·æ é«æ§è½ãé«å¯é ãé«å®æ¶ãåå¸å¼ ç­ç¹ç¹ï¼\n 2. producerãconsumerãéå é½æ¯æ åå¸å¼ï¼\n 3. producer åä¸äºéåè½®æµåéæ¶æ¯ï¼éåéå ç§°ä¸º topicãconsumer å¦æå å¹¿æ­æ¶è´¹ï¼åä¸ä¸ª consumer å®ä¾æ¶è´¹è¿ä¸ª topic å¯¹åºç ææéåï¼å¦æå éç¾¤æ¶è´¹ï¼å å¤ä¸ª consumer å®ä¾ å¹³åæ¶è´¹ è¿ä¸ª topic å¯¹åºçéåéåï¼\n 4. è½å¤ä¿è¯ ä¸¥æ ¼çæ¶æ¯é¡ºåºï¼\n 5. æä¾ä¸°å¯ç æ¶æ¯æåæ¨¡å¼ï¼\n 6. é«æçè®¢éè æ°´å¹³æ©å±è½åï¼\n 7. å®æ¶ ç æ¶æ¯è®¢éæºå¶ï¼\n 8. äº¿çº§ æ¶æ¯å ç§¯ è½åï¼\n 9. è¾å°çå¤é¨ä¾èµã\n\n# (b) é¨ç½²ç¯å¢\n\nrocketmq å¯ä»¥è¿è¡å¨ java è¯­è¨ææ¯æçå¹³å°ä¹ä¸ãä½¿ç¨ rocketmq éè¦ï¼\n\n * java jdk\n * å®è£ gitãmaven\n * rocketmq å®è£å\n\n# (c) ä¼ç¹\n\n 1. åæº æ¯æ 1 ä¸ä»¥ä¸ æä¹åéåï¼\n 2. rocketmq çæææ¶æ¯é½æ¯ æä¹åçï¼ååå¥ç³»ç» pagecacheï¼ç¶å å·çï¼å¯ä»¥ä¿è¯ åå­ ä¸ ç£ç é½æä¸ä»½æ°æ®ï¼è è®¿é® æ¶ï¼ç´æ¥ ä»åå­è¯»åã\n 3. æ¨¡åç®åï¼æ¥å£æç¨ï¼jms çæ¥å£å¾å¤åºåå¹¶ä¸å¤ªå®ç¨ï¼ï¼\n 4. æ§è½éå¸¸å¥½ï¼å¯ä»¥åè®¸ å¤§éå ç§¯æ¶æ¯ å¨ broker ä¸­ï¼\n 5. æ¯æ å¤ç§æ¶è´¹æ¨¡å¼ï¼åæ¬ éç¾¤æ¶è´¹ãå¹¿æ­æ¶è´¹ç­ï¼\n 6. åä¸ªç¯è åå¸å¼æ©å±è®¾è®¡ï¼æ¯æ ä¸»ä» å é«å¯ç¨ï¼\n 7. å¼ååº¦è¾æ´»è·ï¼çæ¬æ´æ°å¾å¿«ã\n\n# (d) ç¼ºç¹\n\n 1. æ¯æç å®¢æ·ç«¯è¯­è¨ ä¸å¤ï¼ç®åæ¯ java å c++ï¼å¶ä¸­ c++ è¿ä¸æçï¼\n 2. rocketmq ç¤¾åºå³æ³¨åº¦åæçåº¦ä¹ä¸ååä¸¤èï¼\n 3. æ²¡æ web ç®¡ççé¢ï¼æä¾äºä¸ä¸ª cli (å½ä»¤è¡çé¢) ç®¡çå·¥å·å¸¦æ¥ æ¥è¯¢ãç®¡ç å è¯æ­åç§é®é¢ï¼\n 4. æ²¡æå¨ mq æ ¸å¿éå®ç° jms ç­æ¥å£ï¼\n\n\n# 5.4. kafka\n\napache kafka æ¯ä¸ä¸ª åå¸å¼æ¶æ¯åå¸è®¢é ç³»ç»ãå®æåç± linkedin å¬å¸åºäºç¬ç¹çè®¾è®¡å®ç°ä¸ºä¸ä¸ª åå¸å¼çæ¥å¿æäº¤ç³»ç» (a distributed commit log)ï¼ä¹åæä¸º apache é¡¹ç®çä¸é¨åãkafka æ§è½é«æãå¯æ©å±è¯å¥½ å¹¶ä¸ å¯æä¹åãå®ç ååºç¹æ§ï¼å¯å¤å¶ å å¯å®¹é é½æ¯å¶ä¸éçç¹æ§ã\n\n# (a) ä¸»è¦ç¹æ§\n\n 1. å¿«éæä¹åï¼å¯ä»¥å¨ o(1) çç³»ç»å¼éä¸è¿è¡ æ¶æ¯æä¹åï¼\n 2. é«ååï¼å¨ä¸å°æ®éçæå¡å¨ä¸æ¢å¯ä»¥è¾¾å° 10w/s ç ååéçï¼\n 3. å®å¨çåå¸å¼ç³»ç»ï¼brokerãproducer å consumer é½åçèªå¨æ¯æ åå¸å¼ï¼èªå¨å®ç° è´è½½åè¡¡ï¼\n 4. æ¯æ åæ­¥ å å¼æ­¥ å¤å¶ä¸¤ç§ é«å¯ç¨æºå¶ï¼\n 5. æ¯æ æ°æ®æ¹éåé å æåï¼\n 6. é¶æ·è´ææ¯(zero-copy)ï¼åå° io æä½æ­¥éª¤ï¼æé« ç³»ç»ååéï¼\n 7. æ°æ®è¿ç§»ãæ©å®¹ å¯¹ç¨æ·éæï¼\n 8. æ éåæº å³å¯æ©å±æºå¨ï¼\n 9. å¶ä»ç¹æ§ï¼ä¸°å¯ç æ¶æ¯æåæ¨¡åãé«æ è®¢éèæ°´å¹³æ©å±ãå®æ¶ç æ¶æ¯è®¢éãäº¿çº§ç æ¶æ¯å ç§¯è½åãå®æå é¤æºå¶ï¼\n\n# (b) é¨ç½²ç¯å¢\n\nä½¿ç¨ kafka éè¦ï¼\n\n * java jdk\n * kafka å®è£å\n\n# (c) ä¼ç¹\n\n 1. å®¢æ·ç«¯è¯­è¨ä¸°å¯ï¼æ¯æ javaã.netãphpãrubyãpythonãgo ç­å¤ç§è¯­è¨ï¼\n 2. é«æ§è½ï¼åæºåå¥ tps çº¦å¨ 100 ä¸æ¡/ç§ï¼æ¶æ¯å¤§å° 10 ä¸ªå­èï¼\n 3. æä¾ å®å¨åå¸å¼æ¶æï¼å¹¶æ replica æºå¶ï¼æ¥æè¾é«ç å¯ç¨æ§ å å¯é æ§ï¼çè®ºä¸æ¯æ æ¶æ¯æ éå ç§¯ï¼\n 4. æ¯ææ¹éæä½ï¼\n 5. æ¶è´¹è éç¨ pull æ¹å¼è·åæ¶æ¯ãæ¶æ¯æåºï¼éè¿æ§å¶ è½å¤ä¿è¯æææ¶æ¯è¢«æ¶è´¹ä¸ä»è¢«æ¶è´¹ ä¸æ¬¡ï¼\n 6. æä¼ç§çç¬¬ä¸æ¹ kafka web ç®¡ççé¢ kafka-managerï¼\n 7. å¨ æ¥å¿é¢å æ¯è¾æçï¼è¢«å¤å®¶å¬å¸åå¤ä¸ªå¼æºé¡¹ç®ä½¿ç¨ã\n\n# (d) ç¼ºç¹\n\n 1. kafka åæºè¶è¿ 64 ä¸ª éå/ååº æ¶ï¼load æ¶ä¼åçææ¾çé£é«ç°è±¡ãéå è¶å¤ï¼è´è½½ è¶é«ï¼åéæ¶æ¯ ååºæ¶é´åé¿ï¼\n 2. ä½¿ç¨ ç­è½®è¯¢æ¹å¼ï¼å®æ¶æ§ åå³äº è½®è¯¢é´éæ¶é´ï¼\n 3. æ¶è´¹å¤±è´¥ ä¸æ¯æéè¯ï¼\n 4. æ¯æ æ¶æ¯é¡ºåºï¼ä½æ¯ ä¸å°ä»£çå®æº åï¼å°±ä¼äº§ç æ¶æ¯ä¹±åºï¼\n 5. ç¤¾åºæ´æ°è¾æ¢ã\n\n\n# 5.5. mq çææ¯éå\n\nmq çææ¯éåä¸è¬è¦èèä»¥ä¸å ç¹ï¼\n\n * æ¯å¦å¼æºï¼è¿å³å®äºè½å¦åç¨ï¼æä»¥æä¸ºéè¦ã\n * ç¤¾åºæ´»è·åº¦è¶é«è¶å¥½ï¼é«ç¤¾åºæ´»è·åº¦ï¼ä¸è¬ä¿è¯äºä½ bug çï¼å ä¸ºå¤§é¨å bugï¼å·²ç»æäººéå°å¹¶è§£å³äºã\n * ææ¯çæééæ§ï¼å®¢æ·ç«¯å¯¹åç§ç¼ç¨è¯­è¨çæ¯æãæ¯å¦ï¼å¦æä½¿ç¨ mq çé½æ¯ java åºç¨ï¼é£ä¹ activemqãrabbitmqãrocketmqãkafka é½å¯ä»¥ãå¦æéè¦æ¯æå¶ä»è¯­è¨ï¼é£ä¹ rmq æ¯è¾åéï¼å ä¸ºå®æ¯æçç¼ç¨è¯­è¨æ¯è¾ä¸°å¯ãå¦æ mq æ¯åºç¨äºå¤§æ°æ®ææµå¼è®¡ç®ï¼é£ä¹ kafka å ä¹æ¯æ éãå¦ææ¯åºç¨äºå¨çº¿ä¸å¡ç³»ç»ï¼é£ä¹ kafka å°±ä¸åéäºï¼å¯ä»¥èè rabbitmqã rocketmq å¾åéã\n * é«å¯ç¨æ§ï¼åºç¨äºçº¿ä¸çåå¥æ åã\n * æ§è½ï¼å·å¤è¶³å¤å¥½çæ§è½ï¼è½æ»¡è¶³ç»å¤§å¤æ°åºæ¯çæ§è½è¦æ±ã\n\nç¹æ§                activemq                     rabbitmq                        rocketmq                                      kafka\nåæºååé             ä¸çº§ï¼æ¯ rocketmqãkafka ä½ä¸ä¸ªæ°éçº§   å activemq                      10 ä¸çº§ï¼æ¯æé«åå                                   10 ä¸çº§ï¼é«ååï¼ä¸è¬éåå¤§æ°æ®ç±»çç³»ç»æ¥è¿è¡æµå¼è®¡ç®ãæ¥å¿ééç­åºæ¯\ntopic æ°éå¯¹ååéçå½±å                                                                topic å¯ä»¥è¾¾å°å ç¾/å åççº§å«ï¼ååéä¼æè¾å°å¹åº¦çä¸éï¼è¿æ¯ rocketmq   topic ä»å åå°å ç¾ä¸ªæ¶åï¼ååéä¼å¤§å¹åº¦ä¸éï¼å¨åç­æºå¨ä¸ï¼kafka å°½éä¿è¯ topic\n                                                                               çä¸å¤§ä¼å¿ï¼å¨åç­æºå¨ä¸ï¼å¯ä»¥æ¯æå¤§éç topic                    æ°éä¸è¦è¿å¤ï¼å¦æè¦æ¯æå¤§è§æ¨¡ç topicï¼éè¦å¢å æ´å¤çæºå¨èµæº\næ¶ææ§               ms çº§                         å¾®ç§çº§ï¼è¿æ¯ rabbitmq çä¸å¤§ç¹ç¹ï¼å»¶è¿æä½      ms çº§                                          å»¶è¿å¨ ms çº§ä»¥å\nå¯ç¨æ§               é«ï¼åºäºä¸»ä»æ¶æå®ç°é«å¯ç¨                å activemq                      éå¸¸é«ï¼åå¸å¼æ¶æ                                     éå¸¸é«ï¼åå¸å¼ï¼ä¸ä¸ªæ°æ®å¤ä¸ªå¯æ¬ï¼å°æ°æºå¨å®æºï¼ä¸ä¼ä¸¢å¤±æ°æ®ï¼ä¸ä¼å¯¼è´ä¸å¯ç¨\næ¶æ¯å¯é æ§             æè¾ä½çæ¦çä¸¢å¤±æ°æ®                   åºæ¬ä¸ä¸¢                            ç»è¿åæ°ä¼åéç½®ï¼å¯ä»¥åå° 0 ä¸¢å¤±                            å rocketmq\nåè½æ¯æ              mq é¢åçåè½æå¶å®å¤                 åºäº erlang å¼åï¼å¹¶åè½åå¾å¼ºï¼æ§è½æå¥½ï¼å»¶æ¶å¾ä½   mq åè½è¾ä¸ºå®åï¼è¿æ¯åå¸å¼çï¼æ©å±æ§å¥½                         åè½è¾ä¸ºç®åï¼ä¸»è¦æ¯æç®åç mq åè½ï¼å¨å¤§æ°æ®é¢åçå®æ¶è®¡ç®ä»¥åæ¥å¿ééè¢«å¤§è§æ¨¡ä½¿ç¨\n\nç»¼ä¸ï¼åç§å¯¹æ¯ä¹åï¼æå¦ä¸å»ºè®®ï¼\n\n * ä¸å¡ç³»ç»åºæ¯ï¼å»ºè®®ä½¿ç¨ rocketmqãrabbitmqãå¦æææåºç¨é½æ¯ javaï¼ä¼é rocketmqï¼å ä¸º rocketmq æ¬èº«å°±æ¯ java å¼åçï¼æä»¥æééãå¦æä¸å¡ä¸­æå¤ç§ç¼ç¨è¯­è¨çåºç¨ï¼å»ºè®®éæ© rabbitmqã\n * å¤§æ°æ®åæµå¼è®¡ç®é¢åï¼ææ¯ä½ä¸ºæ¥å¿ç¼å²ï¼å¼ºçå»ºè®®éæ© kafkaï¼ä¸çæ åï¼ä¹ç»èéªã\n\n\n# 6. jms\n\næå° mqï¼å°±é¡ºä¾¿æä¸ä¸ jms ã\n\njmsï¼java message serviceï¼java æ¶æ¯æå¡ï¼api æ¯ä¸ä¸ªæ¶æ¯æå¡çæ å/è§èï¼åè®¸åºç¨ç¨åºç»ä»¶åºäº javaee å¹³å°åå»ºãåéãæ¥æ¶åè¯»åæ¶æ¯ãå®ä½¿åå¸å¼éä¿¡è¦ååº¦æ´ä½ï¼æ¶æ¯æå¡æ´å å¯é ä»¥åå¼æ­¥æ§ã\n\nå¨ ejb æ¶æä¸­ï¼ææ¶æ¯ bean å¯ä»¥æ ç¼çä¸ jms æ¶æ¯æå¡éæãå¨ j2ee æ¶ææ¨¡å¼ä¸­ï¼ææ¶æ¯æå¡èæ¨¡å¼ï¼ç¨äºå®ç°æ¶æ¯ä¸åºç¨ç´æ¥çè§£è¦ã\n\n\n# 6.1. æ¶æ¯æ¨¡å\n\nå¨ jms æ åä¸­ï¼æä¸¤ç§æ¶æ¯æ¨¡åï¼\n\n * p2p(point to point)\n * pub/sub(publish/subscribe)\n\n# p2p æ¨¡å¼\n\n\np2p æ¨¡å¼åå«ä¸ä¸ªè§è²ï¼mqï¼queueï¼ï¼åéè(sender)ï¼æ¥æ¶è(receiver)ãæ¯ä¸ªæ¶æ¯é½è¢«åéå°ä¸ä¸ªç¹å®çéåï¼æ¥æ¶èä»éåä¸­è·åæ¶æ¯ãéåä¿ççæ¶æ¯ï¼ç´å°ä»ä»¬è¢«æ¶è´¹æè¶æ¶ã\n\np2p çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯åªæä¸ä¸ªæ¶è´¹èï¼consumerï¼(å³ä¸æ¦è¢«æ¶è´¹ï¼æ¶æ¯å°±ä¸åå¨ mq ä¸­)\n * åéèåæ¥æ¶èä¹é´å¨æ¶é´ä¸æ²¡æä¾èµæ§ï¼ä¹å°±æ¯è¯´å½åéèåéäºæ¶æ¯ä¹åï¼ä¸ç®¡æ¥æ¶èææ²¡ææ­£å¨è¿è¡ï¼å®ä¸ä¼å½±åå°æ¶æ¯è¢«åéå°éå\n * æ¥æ¶èå¨æåæ¥æ¶æ¶æ¯ä¹åéåéååºç­æå\n\nå¦æå¸æåéçæ¯ä¸ªæ¶æ¯é½ä¼è¢«æåå¤ççè¯ï¼é£ä¹éè¦ p2p æ¨¡å¼ã\n\n# pub/sub æ¨¡å¼\n\n\nåå«ä¸ä¸ªè§è²ä¸»é¢ï¼topicï¼ï¼åå¸èï¼publisherï¼ï¼è®¢éèï¼subscriberï¼ ãå¤ä¸ªåå¸èå°æ¶æ¯åéå° topic,ç³»ç»å°è¿äºæ¶æ¯ä¼ éç»å¤ä¸ªè®¢éèã\n\npub/sub çç¹ç¹\n\n * æ¯ä¸ªæ¶æ¯å¯ä»¥æå¤ä¸ªæ¶è´¹è\n * åå¸èåè®¢éèä¹é´ææ¶é´ä¸çä¾èµæ§ãéå¯¹æä¸ªä¸»é¢ï¼topicï¼çè®¢éèï¼å®å¿é¡»åå»ºä¸ä¸ªè®¢éèä¹åï¼æè½æ¶è´¹åå¸èçæ¶æ¯ã\n * ä¸ºäºæ¶è´¹æ¶æ¯ï¼è®¢éèå¿é¡»ä¿æè¿è¡çç¶æã\n\nä¸ºäºç¼åè¿æ ·ä¸¥æ ¼çæ¶é´ç¸å³æ§ï¼jms åè®¸è®¢éèåå»ºä¸ä¸ªå¯æä¹åçè®¢éãè¿æ ·ï¼å³ä½¿è®¢éèæ²¡æè¢«æ¿æ´»ï¼è¿è¡ï¼ï¼å®ä¹è½æ¥æ¶å°åå¸èçæ¶æ¯ã\n\nå¦æå¸æåéçæ¶æ¯å¯ä»¥ä¸è¢«åä»»ä½å¤çãæèåªè¢«ä¸ä¸ªæ¶æ¯èå¤çãæèå¯ä»¥è¢«å¤ä¸ªæ¶è´¹èå¤ççè¯ï¼é£ä¹å¯ä»¥éç¨ pub/sub æ¨¡åã\n\n\n# 6.2. æ¶æ¯æ¶è´¹\n\nå¨ jms ä¸­ï¼æ¶æ¯çäº§çåæ¶è´¹é½æ¯å¼æ­¥çãå¯¹äºæ¶è´¹æ¥è¯´ï¼jms çæ¶æ¯èå¯ä»¥éè¿ä¸¤ç§æ¹å¼æ¥æ¶è´¹æ¶æ¯ã\n\n * åæ­¥ - è®¢éèææ¥æ¶èéè¿ receive æ¹æ³æ¥æ¥æ¶æ¶æ¯ï¼receive æ¹æ³å¨æ¥æ¶å°æ¶æ¯ä¹åï¼æè¶æ¶ä¹åï¼å°ä¸ç´é»å¡ï¼\n * å¼æ­¥ - è®¢éèææ¥æ¶èå¯ä»¥æ³¨åä¸ºä¸ä¸ªæ¶æ¯çå¬å¨ãå½æ¶æ¯å°è¾¾ä¹åï¼ç³»ç»èªå¨è°ç¨çå¬å¨ç onmessage æ¹æ³ã\n\njndi - java å½ååç®å½æ¥å£,æ¯ä¸ç§æ åç java å½åç³»ç»æ¥å£ãå¯ä»¥å¨ç½ç»ä¸æ¥æ¾åè®¿é®æå¡ãéè¿æå®ä¸ä¸ªèµæºåç§°ï¼è¯¥åç§°å¯¹åºäºæ°æ®åºæå½åæå¡ä¸­çä¸ä¸ªè®°å½ï¼åæ¶è¿åèµæºè¿æ¥å»ºç«æå¿é¡»çä¿¡æ¯ã\n\njndi å¨ jms ä¸­èµ·å°æ¥æ¾åè®¿é®åéç®æ ææ¶æ¯æ¥æºçä½ç¨ã\n\n\n# 6.3. jms ç¼ç¨æ¨¡å\n\n# connectionfactory\n\nåå»º connection å¯¹è±¡çå·¥åï¼éå¯¹ä¸¤ç§ä¸åç jms æ¶æ¯æ¨¡åï¼åå«æ queueconnectionfactory å topicconnectionfactory ä¸¤ç§ãå¯ä»¥éè¿ jndi æ¥æ¥æ¾ connectionfactory å¯¹è±¡ã\n\n# destination\n\ndestination çæææ¯æ¶æ¯çäº§èçæ¶æ¯åéç®æ æèè¯´æ¶æ¯æ¶è´¹èçæ¶æ¯æ¥æºãå¯¹äºæ¶æ¯çäº§èæ¥è¯´ï¼å®ç destination æ¯æä¸ªéåï¼queueï¼ææä¸ªä¸»é¢ï¼topicï¼;å¯¹äºæ¶æ¯æ¶è´¹èæ¥è¯´ï¼å®ç destination ä¹æ¯æä¸ªéåæä¸»é¢ï¼å³æ¶æ¯æ¥æºï¼ã\n\næä»¥ï¼destination å®éä¸å°±æ¯ä¸¤ç§ç±»åçå¯¹è±¡ï¼queueãtopicãå¯ä»¥éè¿ jndi æ¥æ¥æ¾ destinationã\n\n# connection\n\nconnection è¡¨ç¤ºå¨å®¢æ·ç«¯å jms ç³»ç»ä¹é´å»ºç«çé¾æ¥ï¼å¯¹ tcp/ip socket çåè£ï¼ãconnection å¯ä»¥äº§çä¸ä¸ªæå¤ä¸ª sessionãè· connectionfactory ä¸æ ·ï¼connection ä¹æä¸¤ç§ç±»åï¼queueconnection å topicconnectionã\n\n# session\n\nsession æ¯æä½æ¶æ¯çæ¥å£ãå¯ä»¥éè¿ session åå»ºçäº§èãæ¶è´¹èãæ¶æ¯ç­ãsession æä¾äºäºå¡çåè½ãå½éè¦ä½¿ç¨ session åé/æ¥æ¶å¤ä¸ªæ¶æ¯æ¶ï¼å¯ä»¥å°è¿äºåé/æ¥æ¶å¨ä½æ¾å°ä¸ä¸ªäºå¡ä¸­ãåæ ·ï¼ä¹å queuesession å topicsessionã\n\n# æ¶æ¯ççäº§è\n\næ¶æ¯çäº§èç± session åå»ºï¼å¹¶ç¨äºå°æ¶æ¯åéå° destinationãåæ ·ï¼æ¶æ¯çäº§èåä¸¤ç§ç±»åï¼queuesender å topicpublisherãå¯ä»¥è°ç¨æ¶æ¯çäº§èçæ¹æ³ï¼send æ publish æ¹æ³ï¼åéæ¶æ¯ã\n\n# æ¶æ¯æ¶è´¹è\n\næ¶æ¯æ¶è´¹èç± session åå»ºï¼ç¨äºæ¥æ¶è¢«åéå° destination çæ¶æ¯ãä¸¤ç§ç±»åï¼queuereceiver å topicsubscriberãå¯åå«éè¿ session ç createreceiver(queue)æ createsubscriber(topic)æ¥åå»ºãå½ç¶ï¼ä¹å¯ä»¥ session ç creatdurablesubscriber æ¹æ³æ¥åå»ºæä¹åçè®¢éèã\n\n# messagelistener\n\næ¶æ¯çå¬å¨ãå¦ææ³¨åäºæ¶æ¯çå¬å¨ï¼ä¸æ¦æ¶æ¯å°è¾¾ï¼å°èªå¨è°ç¨çå¬å¨ç onmessage æ¹æ³ãejb ä¸­ç mdbï¼message-driven beanï¼å°±æ¯ä¸ç§ messagelistenerã\n\n\n# 7. åèèµæ\n\n * å¤§åç½ç«æ¶æç³»åï¼åå¸å¼ mqï¼ä¸ï¼\n * å¤§åç½ç«æ¶æç³»åï¼mqï¼äºï¼\n * åå¸å¼å¼æ¾ mq(rocketmq)çåçä¸å®è·µ\n * é¿é rocketmq ä¼å¿å¯¹æ¯\n * advanced-java ä¹ mq\n * æµè°æ¶æ¯éååå¸¸è§çæ¶æ¯ä¸­é´ä»¶',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æå¡æ³¨åååç°",frontmatter:{title:"æå¡æ³¨åååç°",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æå¡æ²»ç"],tags:["åå¸å¼","æå¡æ²»ç","æå¡æ³¨å","æå¡åç°","CAP"],abbrlink:"fd02eff6",date:"2022-04-18T19:34:47.000Z",permalink:"/pages/516f3b/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/05.%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/01.%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E5%8F%91%E7%8E%B0.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/01.æå¡æ³¨åååç°.md",key:"v-686da33c",path:"/pages/516f3b/",headers:[{level:2,title:"1. æå¡åæ°æ®",slug:"_1-æå¡åæ°æ®",normalizedTitle:"1. æå¡åæ°æ®",charIndex:14},{level:3,title:"1.1. REST API",slug:"_1-1-rest-api",normalizedTitle:"1.1. rest api",charIndex:280},{level:3,title:"1.2. XML æä»¶",slug:"_1-2-xml-æä»¶",normalizedTitle:"1.2. xml æä»¶",charIndex:1466},{level:3,title:"1.3. IDL æä»¶",slug:"_1-3-idl-æä»¶",normalizedTitle:"1.3. idl æä»¶",charIndex:3325},{level:2,title:"2. æå¡æ³¨åååç°åºæ¬åç",slug:"_2-æå¡æ³¨åååç°åºæ¬åç",normalizedTitle:"2. æå¡æ³¨åååç°åºæ¬åç",charIndex:5730},{level:3,title:"2.1. åºç¨åæ³¨åä¸åç°",slug:"_2-1-åºç¨åæ³¨åä¸åç°",normalizedTitle:"2.1. åºç¨åæ³¨åä¸åç°",charIndex:6169},{level:3,title:"2.2. åºç¨å¤æ³¨åä¸åç°",slug:"_2-2-åºç¨å¤æ³¨åä¸åç°",normalizedTitle:"2.2. åºç¨å¤æ³¨åä¸åç°",charIndex:6513},{level:2,title:"3. æ³¨åä¸­å¿åºæ¬åè½",slug:"_3-æ³¨åä¸­å¿åºæ¬åè½",normalizedTitle:"3. æ³¨åä¸­å¿åºæ¬åè½",charIndex:6880},{level:3,title:"3.1. æ³¨åä¸­å¿ API",slug:"_3-1-æ³¨åä¸­å¿-api",normalizedTitle:"3.1. æ³¨åä¸­å¿ api",charIndex:7229},{level:3,title:"3.2. éç¾¤é¨ç½²",slug:"_3-2-éç¾¤é¨ç½²",normalizedTitle:"3.2. éç¾¤é¨ç½²",charIndex:7578},{level:3,title:"3.3. åæ°æ®å­å¨",slug:"_3-3-åæ°æ®å­å¨",normalizedTitle:"3.3. åæ°æ®å­å¨",charIndex:8e3},{level:3,title:"3.4. ç½ååæºå¶",slug:"_3-4-ç½ååæºå¶",normalizedTitle:"3.4. ç½ååæºå¶",charIndex:8191},{level:2,title:"4. æå¡å¥åº·æ£æµ",slug:"_4-æå¡å¥åº·æ£æµ",normalizedTitle:"4. æå¡å¥åº·æ£æµ",charIndex:8564},{level:3,title:"4.1. æå¡ç¶æåæ´éç¥",slug:"_4-1-æå¡ç¶æåæ´éç¥",normalizedTitle:"4.1. æå¡ç¶æåæ´éç¥",charIndex:9e3},{level:3,title:"4.2. å¿è·³å¼å³ä¿æ¤æºå¶",slug:"_4-2-å¿è·³å¼å³ä¿æ¤æºå¶",normalizedTitle:"4.2. å¿è·³å¼å³ä¿æ¤æºå¶",charIndex:9280},{level:3,title:"4.3. æå¡èç¹æé¤ä¿æ¤æºå¶",slug:"_4-3-æå¡èç¹æé¤ä¿æ¤æºå¶",normalizedTitle:"4.3. æå¡èç¹æé¤ä¿æ¤æºå¶",charIndex:9812},{level:3,title:"4.4. éææ³¨åä¸­å¿",slug:"_4-4-éææ³¨åä¸­å¿",normalizedTitle:"4.4. éææ³¨åä¸­å¿",charIndex:10405},{level:2,title:"5. æ³¨åä¸­å¿éå",slug:"_5-æ³¨åä¸­å¿éå",normalizedTitle:"5. æ³¨åä¸­å¿éå",charIndex:10622},{level:3,title:"5.1. é«å¯ç¨æ§",slug:"_5-1-é«å¯ç¨æ§",normalizedTitle:"5.1. é«å¯ç¨æ§",charIndex:10666},{level:3,title:"5.2. æ°æ®ä¸è´æ§",slug:"_5-2-æ°æ®ä¸è´æ§",normalizedTitle:"5.2. æ°æ®ä¸è´æ§",charIndex:10919},{level:2,title:"6. æå¡åç°çé®é¢",slug:"_6-æå¡åç°çé®é¢",normalizedTitle:"6. æå¡åç°çé®é¢",charIndex:10934},{level:3,title:"6.1. å¤æ³¨åä¸­å¿",slug:"_6-1-å¤æ³¨åä¸­å¿",normalizedTitle:"6.1. å¤æ³¨åä¸­å¿",charIndex:10949},{level:3,title:"6.2. å¹¶è¡è®¢éæå¡",slug:"_6-2-å¹¶è¡è®¢éæå¡",normalizedTitle:"6.2. å¹¶è¡è®¢éæå¡",charIndex:11256},{level:3,title:"6.3. æ¹éæ³¨éæå¡",slug:"_6-3-æ¹éæ³¨éæå¡",normalizedTitle:"6.3. æ¹éæ³¨éæå¡",charIndex:11594},{level:3,title:"6.4. æå¡åæ´ä¿¡æ¯çå¢éæ´æ°",slug:"_6-4-æå¡åæ´ä¿¡æ¯çå¢éæ´æ°",normalizedTitle:"6.4. æå¡åæ´ä¿¡æ¯çå¢éæ´æ°",charIndex:11883},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:12280}],headersStr:"1. æå¡åæ°æ® 1.1. REST API 1.2. XML æä»¶ 1.3. IDL æä»¶ 2. æå¡æ³¨åååç°åºæ¬åç 2.1. åºç¨åæ³¨åä¸åç° 2.2. åºç¨å¤æ³¨åä¸åç° 3. æ³¨åä¸­å¿åºæ¬åè½ 3.1. æ³¨åä¸­å¿ API 3.2. éç¾¤é¨ç½² 3.3. åæ°æ®å­å¨ 3.4. ç½ååæºå¶ 4. æå¡å¥åº·æ£æµ 4.1. æå¡ç¶æåæ´éç¥ 4.2. å¿è·³å¼å³ä¿æ¤æºå¶ 4.3. æå¡èç¹æé¤ä¿æ¤æºå¶ 4.4. éææ³¨åä¸­å¿ 5. æ³¨åä¸­å¿éå 5.1. é«å¯ç¨æ§ 5.2. æ°æ®ä¸è´æ§ 6. æå¡åç°çé®é¢ 6.1. å¤æ³¨åä¸­å¿ 6.2. å¹¶è¡è®¢éæå¡ 6.3. æ¹éæ³¨éæå¡ 6.4. æå¡åæ´ä¿¡æ¯çå¢éæ´æ° 7. åèèµæ",content:'# æå¡æ³¨åååç°\n\n\n# 1. æå¡åæ°æ®\n\næå»ºå¾®æå¡çé¦è¦é®é¢æ¯ï¼æå¡æä¾èåæå¡æ¶è´¹èéä¿¡æ¶ï¼å¦ä½è¾¾æå±è¯ãå·ä½æ¥è¯´ï¼å°±æ¯è¿ä¸ªæå¡çæ¥å£åæ¯ä»ä¹ï¼è°ç¨è¿ä¸ªæå¡éè¦ä¼ éåªäºåæ°ï¼æ¥å£çè¿åå¼æ¯ä»ä¹ç±»åï¼ä»¥åä¸äºå¶ä»æ¥å£æè¿°ä¿¡æ¯ã\n\næå¡çåæ°æ®ä¿¡æ¯éå¸¸æä»¥ä¸ä¿¡æ¯ï¼\n\n * æå¡èç¹ä¿¡æ¯ï¼å¦ IPãç«¯å£ç­ã\n * æ¥å£å®ä¹ï¼å¦æ¥å£åãè¯·æ±åæ°ãååºåæ°ç­ã\n * è¯·æ±å¤±è´¥çéè¯æ¬¡æ°\n * åºååæ¹å¼\n * åç¼©æ¹å¼\n * éä¿¡åè®®\n * ç­ç­\n\nå¸¸è§çåå¸æå¡åæ°æ®çæ¹å¼æï¼\n\n * REST API\n * XML æä»¶\n * IDL æä»¶\n\n\n# 1.1. REST API\n\nä»¥ Eureka ä¸ºä¾\n\næå¡æä¾èå®ä¹æ¥å£\n\n@RestController\npublic class ProviderController {\n\n    private final DiscoveryClient discoveryClient;\n\n    public ProviderController(DiscoveryClient discoveryClient) {\n        this.discoveryClient = discoveryClient;\n    }\n\n    @GetMapping("/send")\n    public String send() {\n        String services = "Services: " + discoveryClient.getServices();\n        System.out.println(services);\n        return services;\n    }\n\n}\n\n\næå¡æ¶è´¹èæ¶è´¹æ¥å£\n\n@RestController\npublic class ConsumerController {\n\n    private final LoadBalancerClient loadBalancerClient;\n    private final RestTemplate restTemplate;\n\n    public ConsumerController(LoadBalancerClient loadBalancerClient,\n        RestTemplate restTemplate) {\n        this.loadBalancerClient = loadBalancerClient;\n        this.restTemplate = restTemplate;\n    }\n\n    @GetMapping("/recv")\n    public String recv() {\n        ServiceInstance serviceInstance = loadBalancerClient.choose("eureka-provider");\n        String url = "http://" + serviceInstance.getHost() + ":" + serviceInstance.getPort() + "/send";\n        System.out.println(url);\n        return restTemplate.getForObject(url, String.class);\n    }\n\n}\n\n\n\n# 1.2. XML æä»¶\n\nXML æä»¶è¿ç§æ¹å¼çæå¡åå¸åå¼ç¨ä¸»è¦åä¸ä¸ªæ­¥éª¤ï¼\n\nï¼1ï¼æå¡æä¾èå®ä¹æ¥å£ï¼å¹¶å®ç°æ¥å£ã\n\n// The demo service definition.\nservice DemoService {\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user\'s name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n\n\nï¼2ï¼æå¡æä¾èè¿ç¨å¯å¨æ¶ï¼éè¿å è½½ xml éç½®æä»¶å°æ¥å£æ´é²åºå»ã\n\n<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n       xmlns="http://www.springframework.org/schema/beans"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-provider"/>\n    <dubbo:registry address="zookeeper://127.0.0.1:2181"/>\n    <dubbo:protocol name="dubbo" port="20890"/>\n    <bean id="demoService" class="org.apache.dubbo.samples.basic.impl.DemoServiceImpl"/>\n    <dubbo:service interface="org.apache.dubbo.samples.basic.api.DemoService" ref="demoService"/>\n</beans>\n\n\nï¼3ï¼æå¡æ¶è´¹èè¿ç¨å¯å¨æ¶ï¼éè¿å è½½ xml éç½®æä»¶æ¥å¼å¥è¦è°ç¨çæ¥å£ã\n\nconsumer.xml ç¤ºä¾\n\n<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n       xmlns="http://www.springframework.org/schema/beans"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-consumer"/>\n    <dubbo:registry group="aaa" address="zookeeper://127.0.0.1:2181"/>\n    <dubbo:reference id="demoService" check="false" interface="org.apache.dubbo.samples.basic.api.DemoService"/>\n</beans>\n\n\n\n# 1.3. IDL æä»¶\n\nIDL å°±æ¯æ¥å£æè¿°è¯­è¨ï¼interface description languageï¼çç¼©åï¼éè¿ä¸ç§ä¸­ç«çæ¹å¼æ¥æè¿°æ¥å£ï¼ä½¿å¾å¨ä¸åçå¹³å°ä¸è¿è¡çå¯¹è±¡åä¸åè¯­è¨ç¼åçç¨åºå¯ä»¥ç¸äºéä¿¡äº¤æµã\n\nä¹å°±æ¯è¯´ IDL ä¸»è¦æ¯ç¨ä½è·¨è¯­è¨å¹³å°çæå¡ä¹é´çè°ç¨ï¼æä¸¤ç§æå¸¸ç¨ç IDLï¼ä¸ä¸ªæ¯ Facebook å¼æºçThrift åè®®ï¼å¦ä¸ä¸ªæ¯ Google å¼æºçgRPC åè®®ã\n\nä»¥ gRPC åè®®ä¸ºä¾ï¼gRPC åè®®ä½¿ç¨ Protobuf ç®ç§° proto æä»¶æ¥å®ä¹æ¥å£åãè°ç¨åæ°ä»¥åè¿åå¼ç±»åã\n\næ¯å¦æä»¶ helloword.proto å®ä¹äºä¸ä¸ªæ¥å£ SayHello æ¹æ³ï¼å®çè¯·æ±åæ°æ¯ HelloRequestï¼å®çè¿åå¼æ¯ HelloReplyã\n\n// The greeter service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}\n\n}\n\n// The request message containing the user\'s name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n\n\nåå¦æå¡æä¾èä½¿ç¨çæ¯ Java è¯­è¨ï¼é£ä¹å©ç¨ protoc æä»¶å³å¯èªå¨çæ Server ç«¯ç Java ä»£ç ã\n\nprivate class GreeterImpl extends GreeterGrpc.GreeterImplBase {\n\n  @Override\n  public void sayHello(HelloRequest req, StreamObserver<HelloReply> responseObserver) {\n    HelloReply reply = HelloReply.newBuilder().setMessage("Hello " + req.getName()).build();\n    responseObserver.onNext(reply);\n    responseObserver.onCompleted();\n  }\n\n  @Override\n  public void sayHelloAgain(HelloRequest req, StreamObserver<HelloReply> responseObserver) {\n    HelloReply reply = HelloReply.newBuilder().setMessage("Hello again " + req.getName()).build();\n    responseObserver.onNext(reply);\n    responseObserver.onCompleted();\n  }\n}\n\n\nåå¦æå¡æ¶è´¹èä½¿ç¨çä¹æ¯ Java è¯­è¨ï¼é£ä¹å©ç¨ protoc æä»¶å³å¯èªå¨çæ Client ç«¯ç Java ä»£ç ã\n\npublic void greet(String name) {\n  logger.info("Will try to greet " + name + " ...");\n  HelloRequest request = HelloRequest.newBuilder().setName(name).build();\n  HelloReply response;\n  try {\n    response = blockingStub.sayHello(request);\n  } catch (StatusRuntimeException e) {\n    logger.log(Level.WARNING, "RPC failed: {0}", e.getStatus());\n    return;\n  }\n  logger.info("Greeting: " + response.getMessage());\n  try {\n    response = blockingStub.sayHelloAgain(request);\n  } catch (StatusRuntimeException e) {\n    logger.log(Level.WARNING, "RPC failed: {0}", e.getStatus());\n    return;\n  }\n  logger.info("Greeting: " + response.getMessage());\n}\n\n\nåå¦æå¡æ¶è´¹èä½¿ç¨çæ¯å¶ä»è¯­è¨ï¼ä¹å¯ä»¥å©ç¨ç¸åºçæä»¶çæä»£ç ã\n\nç±æ­¤å¯è§ï¼gRPC åè®®çæå¡æè¿°æ¯éè¿ proto æä»¶æ¥å®ä¹æ¥å£çï¼ç¶ååä½¿ç¨ protoc æ¥çæä¸åè¯­è¨å¹³å°çå®¢æ·ç«¯åæå¡ç«¯ä»£ç ï¼ä»èå·å¤è·¨è¯­è¨æå¡è°ç¨è½åã\n\næä¸ç¹ç¹å«éè¦æ³¨æçæ¯ï¼å¨æè¿°æ¥å£å®ä¹æ¶ï¼IDL æä»¶éè¦å¯¹æ¥å£è¿åå¼è¿è¡è¯¦ç»å®ä¹ãå¦ææ¥å£è¿åå¼çå­æ®µæ¯è¾å¤ï¼å¹¶ä¸ç»å¸¸ååæ¶ï¼éç¨ IDL æä»¶æ¹å¼çæ¥å£å®ä¹å°±ä¸å¤ªåéäºãä¸æ¹é¢å¯è½ä¼é æ IDL æä»¶è¿å¤§é¾ä»¥ç»´æ¤ï¼å¦ä¸æ¹é¢åªè¦ IDL æä»¶ä¸­å®ä¹çæ¥å£è¿åå¼æåæ´ï¼é½éè¦åæ­¥ææçæå¡æ¶è´¹èé½æ´æ°ï¼ç®¡çææ¬å°±å¤ªé«äºã\n\n\n# 2. æå¡æ³¨åååç°åºæ¬åç\n\næå¡åç°éå¸¸ä¾èµäºæ³¨åä¸­å¿æ¥åè°æå¡åç°çè¿ç¨ï¼å¶æ­¥éª¤å¦ä¸ï¼\n\n 1. æå¡æä¾èå°æ¥å£ä¿¡æ¯ä»¥æ³¨åå°æ³¨åä¸­å¿ã\n 2. æå¡æ¶è´¹èä»æ³¨åä¸­å¿è¯»ååè®¢éæå¡æä¾èçå°åä¿¡æ¯ã\n 3. å¦ææå¯ç¨çæå¡ï¼æ³¨åä¸­å¿ä¼ä¸»å¨éç¥æå¡æ¶è´¹èã\n 4. æå¡æ¶è´¹èæ ¹æ®å¯ç¨æå¡çå°ååè¡¨ï¼è°ç¨æå¡æä¾èçæ¥å£ã\n\nè¿ä¸ªè¿ç¨å¾åæ¯çæ´»ä¸­çæ¿å±ç§èµï¼æ¿ä¸å°ç§æ¿ä¿¡æ¯æå°ä¸­ä»å¬å¸ï¼æ¿å®¢ä»ä¸­ä»å¬å¸æ¥æ¾ç§æ¿ä¿¡æ¯ãæ¿å®¢å¦ææ³è¦ç§æ¿ä¸çæ¿å­ï¼éè¿ä¸­ä»å¬å¸çµçº¿æ­æ¡¥ï¼èç³»ä¸æ¿ä¸ï¼åæ¹è°å¦¥ç­¾è®¢åè®®ï¼å°±å¯ä»¥æ­£å¼å»ºç«èµ·ç§èµå³ç³»ã\n\n\n\nä¸»æµçæå¡æ³¨åä¸åç°çè§£å³æ¹æ¡ï¼ä¸»è¦æä¸¤ç§ï¼\n\n * åºç¨åæ³¨åä¸åç°ï¼æ³¨åä¸­å¿æä¾æå¡ç«¯åå®¢æ·ç«¯ç SDKï¼ä¸å¡åºç¨éè¿å¼å¥æ³¨åä¸­å¿æä¾ç SDKï¼éè¿ SDK ä¸æ³¨åä¸­å¿äº¤äºï¼æ¥å®ç°æå¡çæ³¨åååç°ã\n * åºç¨å¤æ³¨åä¸åç°ï¼ä¸å¡åºç¨æ¬èº«ä¸éè¦éè¿ SDK ä¸æ³¨åä¸­å¿æäº¤éï¼èæ¯éè¿å¶ä»æ¹å¼ä¸æ³¨åä¸­å¿äº¤äºï¼é´æ¥å®ææå¡æ³¨åä¸åç°ã\n\n\n# 2.1. åºç¨åæ³¨åä¸åç°\n\nåºç¨åæ³¨åä¸åç°æ¹æ¡æ¯ï¼æ³¨åä¸­å¿æä¾æå¡ç«¯åå®¢æ·ç«¯ç SDKï¼ä¸å¡åºç¨éè¿å¼å¥æ³¨åä¸­å¿æä¾ç SDKï¼éè¿ SDK ä¸æ³¨åä¸­å¿äº¤äºï¼æ¥å®ç°æå¡çæ³¨åååç°ãæå¸åçæ¡ä¾è¦å± Netflix å¼æºç Eurekaï¼å®æ¹æ¶æå¾å¦ä¸ï¼\n\n\n\nEureka çæ¶æä¸»è¦ç±ä¸ä¸ªéè¦çç»ä»¶ç»æï¼\n\n * Eureka Serverï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°äºæå¡ä¿¡æ¯æ³¨åãå­å¨ä»¥åæ¥è¯¢ç­åè½ã\n * æå¡ç«¯ç Eureka Clientï¼éæå¨æå¡ç«¯çæ³¨åä¸­å¿ SDKï¼æå¡æä¾èéè¿è°ç¨ SDKï¼å®ç°æå¡æ³¨åãåæ³¨åç­åè½ã\n * å®¢æ·ç«¯ç Eureka Clientï¼éæå¨å®¢æ·ç«¯çæ³¨åä¸­å¿ SDKï¼æå¡æ¶è´¹èéè¿è°ç¨ SDKï¼å®ç°æå¡è®¢éãæå¡æ´æ°ç­åè½ã\n\n\n# 2.2. åºç¨å¤æ³¨åä¸åç°\n\nåºç¨å¤æ³¨åä¸åç°æ¹æ¡æ¯ï¼ä¸å¡åºç¨æ¬èº«ä¸éè¦éè¿ SDK ä¸æ³¨åä¸­å¿æäº¤éï¼èæ¯éè¿å¶ä»æ¹å¼ä¸æ³¨åä¸­å¿äº¤äºï¼é´æ¥å®ææå¡æ³¨åä¸åç°ãæå¸åçæ¡ä¾æ¯å¼æºæ³¨åä¸­å¿ Consulã\n\n\n\nConsul å®ç°åºç¨å¤æå¡æ³¨åååç°ä¸»è¦ä¾é ä¸ä¸ªéè¦çç»ä»¶ï¼\n\n * Consulï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°æå¡æ³¨åä¿¡æ¯çå­å¨ï¼å¹¶æä¾æ³¨åååç°æå¡ã\n * Registratorï¼ä¸ä¸ªå¼æºçç¬¬ä¸æ¹æå¡ç®¡çå¨é¡¹ç®ï¼å®éè¿çå¬æå¡é¨ç½²ç Docker å®ä¾æ¯å¦å­æ´»ï¼æ¥è´è´£æå¡æä¾èçæ³¨ååéæ¯ã\n * Consul Templateï¼å®æ¶ä»æ³¨åä¸­å¿æå¡ç«¯è·åææ°çæå¡æä¾èèç¹åè¡¨å¹¶å·æ° LB éç½®ï¼æ¯å¦ Nginx ç upstreamï¼ï¼è¿æ ·æå¡æ¶è´¹èå°±éè¿è®¿é® Nginx å°±å¯ä»¥è·åææ°çæå¡æä¾èä¿¡æ¯ã\n\n\n# 3. æ³¨åä¸­å¿åºæ¬åè½\n\nä»æå¡æ³¨åååç°çæµç¨ï¼å¯ä»¥çåºï¼æ³¨åä¸­å¿æ¯æå¡åç°çæ ¸å¿ç»ä»¶ãå¸¸è§çæ³¨åä¸­å¿ç»ä»¶æï¼NacosãConsulãZookeeper ç­ã\n\næ³¨åä¸­å¿æ¯ç¨æ¥å­å¨æå¡çåæ°æ®ä¿¡æ¯ãæå¡çåæ°æ®ä¿¡æ¯éå¸¸æä»¥ä¸ä¿¡æ¯ï¼\n\n * æå¡èç¹ä¿¡æ¯ï¼å¦ IPãç«¯å£ç­ã\n * æ¥å£å®ä¹ï¼å¦æ¥å£åãè¯·æ±åæ°ãååºåæ°ç­ã\n * è¯·æ±å¤±è´¥çéè¯æ¬¡æ°\n * åºååæ¹å¼\n * åç¼©æ¹å¼\n * éä¿¡åè®®\n * ç­ç­\n\nå¨å·ä½å­å¨æ¶ï¼ä¸è¬ä¼æç§âæå¡ - åç» - èç¹ä¿¡æ¯âä¸å±ç»ææ¥å­å¨ã\n\næ³¨åä¸­å¿çå®ç°ä¸»è¦æ¶åå ä¸ªé®é¢ï¼æ³¨åä¸­å¿éè¦æä¾åªäºæ¥å£ï¼è¯¥å¦ä½é¨ç½²ï¼å¦ä½å­å¨æå¡ä¿¡æ¯ï¼å¦ä½çæ§æå¡æä¾èèç¹çå­æ´»ï¼å¦ææå¡æä¾èèç¹æååå¦ä½éç¥æå¡æ¶è´¹èï¼ä»¥åå¦ä½æ§å¶æ³¨åä¸­å¿çè®¿é®æéã\n\n\n# 3.1. æ³¨åä¸­å¿ API\n\næ ¹æ®æ³¨åä¸­å¿åççæè¿°ï¼æ³¨åä¸­å¿å¿é¡»æä¾ä»¥ä¸æåºæ¬ç APIï¼ä¾å¦ï¼\n\n * æå¡æ³¨åæ¥å£ï¼æå¡æä¾èéè¿è°ç¨æå¡æ³¨åæ¥å£æ¥å®ææå¡æ³¨åã\n * æå¡åæ³¨åæ¥å£ï¼æå¡æä¾èéè¿è°ç¨æå¡åæ³¨åæ¥å£æ¥å®ææå¡æ³¨éã\n * å¿è·³æ±æ¥æ¥å£ï¼æå¡æä¾èéè¿è°ç¨å¿è·³æ±æ¥æ¥å£å®æèç¹å­æ´»ç¶æä¸æ¥ã\n * æå¡è®¢éæ¥å£ï¼æå¡æ¶è´¹èéè¿è°ç¨æå¡è®¢éæ¥å£å®ææå¡è®¢éï¼è·åå¯ç¨çæå¡æä¾èèç¹åè¡¨ã\n * æå¡åæ´æ¥è¯¢æ¥å£ï¼æå¡æ¶è´¹èéè¿è°ç¨æå¡åæ´æ¥è¯¢æ¥å£ï¼è·åææ°çå¯ç¨æå¡èç¹åè¡¨ã\n\né¤æ­¤ä¹å¤ï¼ä¸ºäºä¾¿äºç®¡çï¼æ³¨åä¸­å¿è¿å¿é¡»æä¾ä¸äºåå°ç®¡çç APIï¼ä¾å¦ï¼\n\n * æå¡æ¥è¯¢æ¥å£ï¼æ¥è¯¢æ³¨åä¸­å¿å½åæ³¨åäºåªäºæå¡ä¿¡æ¯ã\n * æå¡ä¿®æ¹æ¥å£ï¼ä¿®æ¹æ³¨åä¸­å¿ä¸­æä¸æå¡çä¿¡æ¯ã\n\n\n# 3.2. éç¾¤é¨ç½²\n\næ³¨åä¸­å¿ä½ä¸ºæå¡æä¾èåæå¡æ¶è´¹èä¹é´æ²éçæ¡¥æ¢ï¼å®çéè¦æ§ä¸è¨èå»ãæä»¥æ³¨åä¸­å¿ä¸è¬é½æ¯éç¨éç¾¤é¨ç½²æ¥ä¿è¯é«å¯ç¨æ§ï¼å¹¶éè¿åå¸å¼ä¸è´æ§åè®®æ¥ç¡®ä¿éç¾¤ä¸­ä¸åèç¹ä¹é´çæ°æ®ä¿æä¸è´ã\n\nä»¥å¼æºæ³¨åä¸­å¿ ZooKeeper ä¸ºä¾ï¼ZooKeeper éç¾¤ä¸­åå«å¤ä¸ªèç¹ï¼æå¡æä¾èåæå¡æ¶è´¹èå¯ä»¥åä»»æä¸ä¸ªèç¹éä¿¡ï¼å ä¸ºå®ä»¬çæ°æ®ä¸å®æ¯ç¸åçï¼è¿æ¯ä¸ºä»ä¹å¢ï¼è¿å°±è¦ä» ZooKeeper çå·¥ä½åçè¯´èµ·ï¼\n\n * æ¯ä¸ª Server å¨åå­ä¸­å­å¨äºä¸ä»½æ°æ®ï¼Client çè¯»è¯·æ±å¯ä»¥è¯·æ±ä»»æä¸ä¸ª Serverã\n * ZooKeeper å¯å¨æ¶ï¼å°ä»å®ä¾ä¸­éä¸¾ä¸ä¸ª leaderï¼Paxos åè®®ï¼ã\n * Leader è´è´£å¤çæ°æ®æ´æ°ç­æä½ï¼ZAB åè®®ï¼ã\n * ä¸ä¸ªæ´æ°æä½æåï¼å½ä¸ä»å½å¤§å¤æ° Server å¨åå­ä¸­æåä¿®æ¹ ã\n\néè¿ä¸é¢è¿ç§æ¹å¼ï¼ZooKeeper ä¿è¯äºé«å¯ç¨æ§ä»¥åæ°æ®ä¸è´æ§ã\n\n\n\n\n# 3.3. åæ°æ®å­å¨\n\næ³¨åä¸­å¿å­å¨æå¡ä¿¡æ¯ä¸è¬éç¨å±æ¬¡åçç®å½ç»æï¼ä»¥ ZooKeeper ä¸ºä¾ï¼\n\n * æ¯ä¸ªç®å½å¨ ZooKeeper ä¸­å«ä½ znodeï¼å¹¶ä¸å¶æä¸ä¸ªå¯ä¸çè·¯å¾æ è¯ã\n * znode å¯ä»¥åå«æ°æ®åå­ znodeã\n * znode ä¸­çæ°æ®å¯ä»¥æå¤ä¸ªçæ¬ï¼æ¯å¦æä¸ä¸ª znode ä¸å­æå¤ä¸ªæ°æ®çæ¬ï¼é£ä¹æ¥è¯¢è¿ä¸ªè·¯å¾ä¸çæ°æ®éå¸¦ä¸çæ¬ä¿¡æ¯ã\n\n\n\n\n# 3.4. ç½ååæºå¶\n\nå¨å®éçå¾®æå¡æµè¯åé¨ç½²æ¶ï¼éå¸¸åå«å¤å¥ç¯å¢ï¼æ¯å¦çäº§ç¯å¢ä¸å¥ãæµè¯ç¯å¢ä¸å¥ãå¼åå¨è¿è¡ä¸å¡èªæµãæµè¯å¨è¿è¡åå½æµè¯æ¶ï¼ä¸è¬é½æ¯ç¨æµè¯ç¯å¢ï¼é¨ç½²ç RPC Server èç¹æ³¨åå°æµè¯çæ³¨åä¸­å¿éç¾¤ãä½ç»å¸¸ä¼åºç°å¼åæèæµè¯å¨é¨ç½²æ¶ï¼éè¯¯çææµè¯ç¯å¢ä¸çæå¡èç¹æ³¨åå°äºçº¿ä¸æ³¨åä¸­å¿éç¾¤ï¼è¿æ ·çè¯çº¿ä¸æµéå°±ä¼è°ç¨å°æµè¯ç¯å¢ä¸ç RPC Server èç¹ï¼å¯è½ä¼é æææ³ä¸å°çåæã\n\nä¸ºäºé²æ­¢è¿ç§æåµåçï¼æ³¨åä¸­å¿éè¦æä¾ä¸ä¸ªä¿æ¤æºå¶ï¼ä½ å¯ä»¥ææ³¨åä¸­å¿æ³è±¡æä¸ä¸ªå¸¦æé¨ç¦çæ¿é´ï¼åªææ¥æé¨ç¦å¡ç RPC Server æè½è¿å¥ãå¨å®éåºç¨ä¸­ï¼æ³¨åä¸­å¿å¯ä»¥æä¾ä¸ä¸ªç½ååæºå¶ï¼åªææ·»å å°æ³¨åä¸­å¿ç½åååç RPC Serverï¼æè½å¤è°ç¨æ³¨åä¸­å¿çæ³¨åæ¥å£ï¼è¿æ ·çè¯å¯ä»¥é¿åæµè¯ç¯å¢ä¸­çèç¹æå¤è·å°çº¿ä¸ç¯å¢ä¸­å»ã\n\n\n# 4. æå¡å¥åº·æ£æµ\n\næ³¨åä¸­å¿é¤äºè¦æ¯ææåºæ¬çæå¡æ³¨ååæå¡è®¢éåè½ä»¥å¤ï¼è¿å¿é¡»å·å¤å¯¹æå¡æä¾èèç¹çå¥åº·ç¶ææ£æµåè½ï¼è¿æ ·æè½ä¿è¯æ³¨åä¸­å¿éä¿å­çæå¡èç¹é½æ¯å¯ç¨çã\n\nè¿æ¯ä»¥ ZooKeeper ä¸ºä¾ï¼å®æ¯åºäº ZooKeeper å®¢æ·ç«¯åæå¡ç«¯çé¿è¿æ¥åä¼è¯è¶æ¶æ§å¶æºå¶ï¼æ¥å®ç°æå¡å¥åº·ç¶ææ£æµçã\n\nå¨ ZooKeeper ä¸­ï¼å®¢æ·ç«¯åæå¡ç«¯å»ºç«è¿æ¥åï¼ä¼è¯ä¹éä¹å»ºç«ï¼å¹¶çæä¸ä¸ªå¨å±å¯ä¸ç Session IDãæå¡ç«¯åå®¢æ·ç«¯ç»´æçæ¯ä¸ä¸ªé¿è¿æ¥ï¼å¨ SESSION_TIMEOUT å¨æåï¼æå¡ç«¯ä¼æ£æµä¸å®¢æ·ç«¯çé¾è·¯æ¯å¦æ­£å¸¸ï¼å·ä½æ¹å¼æ¯éè¿å®¢æ·ç«¯å®æ¶åæå¡ç«¯åéå¿è·³æ¶æ¯ï¼ping æ¶æ¯ï¼ï¼æå¡å¨éç½®ä¸æ¬¡ SESSION_TIMEOUT æ¶é´ãå¦æè¶è¿ SESSION_TIMEOUT åæå¡ç«¯é½æ²¡ææ¶å°å®¢æ·ç«¯çå¿è·³æ¶æ¯ï¼åæå¡ç«¯è®¤ä¸ºè¿ä¸ª Session å°±å·²ç»ç»æäºï¼ZooKeeper å°±ä¼è®¤ä¸ºè¿ä¸ªæå¡èç¹å·²ç»ä¸å¯ç¨ï¼å°ä¼ä»æ³¨åä¸­å¿ä¸­å é¤å¶ä¿¡æ¯ã\n\n\n# 4.1. æå¡ç¶æåæ´éç¥\n\nä¸æ¦æ³¨åä¸­å¿æ¢æµå°ææå¡æä¾èèç¹æ°å å¥æèè¢«åé¤ï¼å°±å¿é¡»ç«å»éç¥ææè®¢éè¯¥æå¡çæå¡æ¶è´¹èï¼å·æ°æ¬å°ç¼å­çæå¡èç¹ä¿¡æ¯ï¼ç¡®ä¿æå¡è°ç¨ä¸ä¼è¯·æ±ä¸å¯ç¨çæå¡æä¾èèç¹ã\n\nç»§ç»­ä»¥ ZooKeeper ä¸ºä¾ï¼åºäº ZooKeeper ç Watcher æºå¶ï¼æ¥å®ç°æå¡ç¶æåæ´éç¥ç»æå¡æ¶è´¹èçãæå¡æ¶è´¹èå¨è°ç¨ ZooKeeper ç getData æ¹æ³è®¢éæå¡æ¶ï¼è¿å¯ä»¥éè¿çå¬å¨ Watcher ç process æ¹æ³è·åæå¡çåæ´ï¼ç¶åè°ç¨ getData æ¹æ³æ¥è·ååæ´åçæ°æ®ï¼å·æ°æ¬å°ç¼å­çæå¡èç¹ä¿¡æ¯ã\n\n\n# 4.2. å¿è·³å¼å³ä¿æ¤æºå¶\n\nå¨ç½ç»é¢ç¹æå¨çæåµä¸ï¼æ³¨åä¸­å¿ä¸­å¯ç¨çèç¹ä¼ä¸æ­ååï¼è¿æ¶åæå¡æ¶è´¹èä¼é¢ç¹æ¶å°æå¡æä¾èèç¹åæ´çä¿¡æ¯ï¼äºæ¯å°±ä¸æ­å°è¯·æ±æ³¨åä¸­å¿æ¥æåææ°çå¯ç¨æå¡èç¹ä¿¡æ¯ãå½ææç¾ä¸åä¸ªæå¡æ¶è´¹èï¼åæ¶è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡æä¾èçèç¹ä¿¡æ¯æ¶ï¼å¯è½ä¼ææ³¨åä¸­å¿çå¸¦å®½ç»å æ»¡ï¼å°¤å¶æ¯æ³¨åä¸­å¿æ¯ç¾åç½å¡çæåµä¸ã\n\néå¯¹è¿ç§æåµï¼éè¦ä¸ç§ä¿æ¤æºå¶ï¼å³ä½¿å¨ç½ç»é¢ç¹æå¨çæ¶åï¼æå¡æ¶è´¹èä¹ä¸è³äºåæ¶å»è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nä¸ä¸ªå¯è¡çè§£å³æ¹æ¡å°±æ¯ç»æ³¨åä¸­å¿è®¾ç½®ä¸ä¸ªå¼å³ï¼å½å¼å³æå¼æ¶ï¼å³ä½¿ç½ç»é¢ç¹æå¨ï¼æ³¨åä¸­å¿ä¹ä¸ä¼éç¥ææçæå¡æ¶è´¹èææå¡èç¹ä¿¡æ¯åæ´ï¼æ¯å¦åªç» 10% çæå¡æ¶è´¹èè¿ååæ´ï¼è¿æ ·çè¯å°±è½å°æ³¨åä¸­å¿çè¯·æ±éåå°å°åæ¥ç 1/10ãå½ç¶æå¼è¿ä¸ªå¼å³ä¹æ¯æä¸å®ä»£ä»·çï¼å®ä¼å¯¼è´æå¡æ¶è´¹èæç¥ææ°çæå¡èç¹ä¿¡æ¯å»¶è¿ï¼ååå¯è½å¨ 10s åå°±è½æç¥å°æå¡æä¾èèç¹ä¿¡æ¯çåæ´ï¼ç°å¨å¯è½ä¼å»¶è¿å°å åéï¼æä»¥å¨ç½ç»æ­£å¸¸çæåµä¸ï¼å¼å³å¹¶ä¸éåæå¼ï¼å¯ä»¥ä½ä¸ºä¸ä¸ªç´§æ¥æªæ½ï¼å¨ç½ç»é¢ç¹æå¨çæ¶åï¼ææå¼è¿ä¸ªå¼å³ã\n\nå¿è·³å¼å³ä¿æ¤æºå¶ï¼æ¯ä¸ºäºé²æ­¢æå¡æä¾èèç¹é¢ç¹åæ´å¯¼è´çæå¡æ¶è´¹èåæ¶å»æ³¨åä¸­å¿è·åææ°æå¡èç¹ä¿¡æ¯ã\n\n\n# 4.3. æå¡èç¹æé¤ä¿æ¤æºå¶\n\næå¡æä¾èå¨è¿ç¨å¯å¨æ¶ï¼ä¼æ³¨åæå¡å°æ³¨åä¸­å¿ï¼å¹¶æ¯éä¸æ®µæ¶é´ï¼æ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼ä»¥æ è¯èªå·±çå­æ´»ç¶æãå¦æéäºä¸æ®µåºå®æ¶é´åï¼æå¡æä¾èä»ç¶æ²¡ææ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼æ³¨åä¸­å¿å°±ä¼è®¤ä¸ºè¯¥èç¹å·²ç»å¤äºâdeadâç¶æï¼äºæ¯ä»æå¡çå¯ç¨èç¹ä¿¡æ¯ä¸­ç§»é¤åºå»ã\n\nå¦æéå°ç½ç»é®é¢ï¼å¤§æ¹æå¡æä¾èèç¹æ±æ¥ç»æ³¨åä¸­å¿çå¿è·³ä¿¡æ¯é½å¯è½ä¼ä¼ è¾¾å¤±è´¥ï¼æ³¨åä¸­å¿å°±ä¼æå®ä»¬é½ä»å¯ç¨èç¹åè¡¨ä¸­ç§»é¤åºå»ï¼é æå©ä¸çå¯ç¨èç¹é¾ä»¥æ¿åææçè°ç¨ï¼å¼èµ·âéªå´©âãä½æ¯è¿ç§æåµä¸ï¼å¯è½å¤§é¨åæå¡æä¾èèç¹æ¯å¯ç¨çï¼ä»ä»å ä¸ºç½ç»åå æ æ³æ±æ¥å¿è·³ç»æ³¨åä¸­å¿å°±è¢«âæ æâçæé¤äºã\n\nè¿ä¸ªæ¶åå°±éè¦æ ¹æ®å®éä¸å¡çæåµï¼è®¾å®ä¸ä¸ªéå¼æ¯ä¾ï¼å³ä½¿éå°åæè¯´çè¿ç§æåµï¼æ³¨åä¸­å¿ä¹ä¸è½æé¤è¶è¿è¿ä¸ªéå¼æ¯ä¾çèç¹ã\n\nè¿ä¸ªéå¼æ¯ä¾å¯ä»¥æ ¹æ®å®éä¸å¡çåä½åº¦æ¥ç¡®å®ï¼æéå¸¸ä¼æè¿ä¸ªæ¯ä¾è®¾å®å¨ 20%ï¼å°±æ¯è¯´æ³¨åä¸­å¿ä¸è½æé¤è¶è¿ 20% çèç¹ãå ä¸ºå¤§é¨åæåµä¸ï¼èç¹çååä¸ä¼è¿ä¹é¢ç¹ï¼åªæå¨ç½ç»æå¨æèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµä¸ææå¯è½åçãèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµæ¯å¯ä»¥é¢ç¥çï¼è¿ç§æåµä¸å¯ä»¥å³é­éå¼ä¿æ¤ï¼èæ­£å¸¸æåµä¸ï¼åºè¯¥æå¼éå¼ä¿æ¤ï¼ä»¥é²æ­¢ç½ç»æå¨æ¶ï¼å¤§æ¹éå¯ç¨çæå¡èç¹è¢«æé¤ã\n\næå¡èç¹æé¤ä¿æ¤æºå¶ï¼æ¯ä¸ºäºé²æ­¢æå¡æä¾èèç¹è¢«å¤§éæé¤å¼èµ·æå¡æ¶è´¹èå¯ä»¥è°ç¨çèç¹ä¸è¶³ã\n\n\n# 4.4. éææ³¨åä¸­å¿\n\nå ä¸ºæå¡æä¾èæ¯åæå¡æ¶è´¹èæä¾æå¡çï¼æ¯å¦å¯ç¨æå¡æ¶è´¹èåºè¯¥æ¯æ³¨åä¸­å¿æ´æ¸æ¥ï¼å æ­¤å¯ä»¥ç´æ¥å¨æå¡æ¶è´¹èç«¯æ ¹æ®è°ç¨æå¡æä¾èæ¯å¦æåæ¥å¤å®æå¡æä¾èæ¯å¦å¯ç¨ãå¦ææå¡æ¶è´¹èè°ç¨æä¸ä¸ªæå¡æä¾èèç¹è¿ç»­å¤±è´¥è¶è¿ä¸å®æ¬¡æ°ï¼å¯ä»¥å¨æ¬å°åå­ä¸­å°è¿ä¸ªèç¹æ è®°ä¸ºä¸å¯ç¨ãå¹¶ä¸æ¯éä¸æ®µåºå®æ¶é´ï¼æå¡æ¶è´¹èé½è¦åæ è®°ä¸ºä¸å¯ç¨çèç¹åèµ·ä¿æ´»æ¢æµï¼å¦ææ¢æµæåäºï¼å°±å°æ è®°ä¸ºä¸å¯ç¨çèç¹åæ¢å¤ä¸ºå¯ç¨ç¶æï¼éæ°åèµ·è°ç¨ã\n\n\n# 5. æ³¨åä¸­å¿éå\n\næ³¨åä¸­å¿éåæ¶æéè¦å³æ³¨ä¸¤ä¸ªé®é¢ï¼é«å¯ç¨æ§åæ°æ®ä¸è´æ§ã\n\n\n# 5.1. é«å¯ç¨æ§\n\næ³¨åä¸­å¿ä½ä¸ºæå¡æä¾èåæå¡æ¶è´¹èä¹é´æ²éççº½å¸¦ï¼å®çé«å¯ç¨æ§ååéè¦ãå¦ææ³¨åä¸­å¿ä¸å¯ç¨äºï¼é£ä¹æå¡æä¾èå°±æ æ³å¯¹å¤æ´é²èªå·±çæå¡ï¼èæå¡æ¶è´¹èä¹æ æ³ç¥éèªå·±æ³è¦è°ç¨çæå¡çå·ä½å°åã\n\nå®ç°é«å¯ç¨æ§çææ®µä¸»è¦æä¸¤ç§\n\n * éç¾¤é¨ç½²ï¼å³ä½¿æé¨åæºå¨å®æºï¼å°è¯·æ±ååå°æ­£å¸¸çæºå¨ä¸å°±å¯ä»¥ä¿è¯æå¡çæ­£å¸¸è®¿é®ã\n * å¤æºæ¿é¨ç½²ï¼é¿åä¸ä¸ªæºæ¿å ä¸ºæ­çµæèåç¼è¢«ææ­ç­ä¸å¯æåå ç´ ä¸å¯ç¨æ¶ï¼ä»ç¶å¯ä»¥éè¿æè¯·æ±è¿ç§»å°å¶ä»æºæ¿æ¥ä¿è¯æå¡çæ­£å¸¸è®¿é®ã\n\nè¿ä¸¤ç§ææ®µæ¬è´¨ä¸é½æ¯æå¡åä½ã\n\n\n# 5.2. æ°æ®ä¸è´æ§\n\n\n# 6. æå¡åç°çé®é¢\n\n\n# 6.1. å¤æ³¨åä¸­å¿\n\nçæ³æåµä¸ï¼å¦æå§ç»åªæä¸ä¸ªæ³¨åä¸­å¿ï¼é£ä¹æ´ä¸ªäº¤äºéå¸¸ç®åãä½å¨å®éå·¥ä½ä¸­ï¼å¾å¾éè¦å¯¹æ¥å¤ä¸ªæ³¨åä¸­å¿ï¼å¸¸è§åºæ¯å¦ä¸ï¼\n\n * æå¡æ¶è´¹èè®¢éå¤ä¸ªæ³¨åä¸­å¿ï¼æå¡æ¶è´¹èå¯è½è®¢éäºå¤ä¸ªæå¡ï¼å¤ä¸ªæå¡å¯è½æ¯ç±å¤ä¸ªä¸å¡é¨é¨æä¾çï¼èä¸æ¯ä¸ªä¸å¡é¨é¨é½æèªå·±çæ³¨åä¸­å¿ï¼æä¾çæå¡åªå¨èªå·±çæ³¨åä¸­å¿éæè®°å½ãè¿å°±è¦æ±æå¡æ¶è´¹èè¦å·å¤å¨å¯å¨æ¶ï¼è½å¤ä»å¤ä¸ªæ³¨åä¸­å¿è®¢éæå¡çè½åã\n * æå¡æä¾èæ³¨åå¤ä¸ªæ³¨åä¸­å¿ï¼ä¸ä¸ªæå¡æä¾èæä¾äºæä¸ªæå¡ï¼å¯è½ä½ä¸ºéææå¡å¯¹å¤æä¾ï¼ä¹å¯è½ä½ä¸ºå¨ææå¡å¯¹å¤æä¾ï¼è¿ä¸¤ä¸ªæå¡é¨ç½²å¨ä¸åçæ³¨åä¸­å¿ï¼æä»¥è¦æ±æå¡æä¾èå¨å¯å¨çæ¶åï¼è¦è½å¤åæ¶åå¤ä¸ªæ³¨åä¸­å¿æ³¨åæå¡ã\n\n\n# 6.2. å¹¶è¡è®¢éæå¡\n\néå¸¸ä¸ä¸ªæå¡æ¶è´¹èè®¢éäºä¸æ­¢ä¸ä¸ªæå¡ãå¦æéç¨ä¸²è¡è®¢éæ¹å¼ï¼å³æ¯è®¢éä¸ä¸ªæå¡ï¼æå¡æ¶è´¹èå°±è°ç¨ä¸æ¬¡æ³¨åä¸­å¿çè®¢éæ¥å£ï¼è·åè¿ä¸ªæå¡çèç¹åè¡¨å¹¶åå§åè¿æ¥ï¼å°±å¯è½è¦æ§è¡å¾å¤æ¬¡è¿æ ·çè¿ç¨ãå¨æäºæå¡èç¹çåå§åè¿æ¥è¿ç¨ä¸­ï¼åºç°è¿æ¥è¶æ¶çæåµï¼åç»­ææçæå¡èç¹çåå§åè¿æ¥é½éè¦ç­å¾å®å®æï¼å¯¼è´æå¡æ¶è´¹èå¯å¨åæ¢ï¼æåèè´¹äºå°è¿äºåéæ¶é´æ¥å®ææææå¡èç¹çåå§åè¿æ¥è¿ç¨ã\n\nç±äºä»¥ä¸é®é¢ï¼æä»¥æå¡åç°åºè¯¥æ¯æå¹¶è¡è®¢éï¼æ¯è®¢éä¸ä¸ªæå¡å°±åç¬ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çï¼è¿æ ·çè¯å³ä½¿éå°ä¸ªå«æå¡èç¹è¿æ¥è¶æ¶ï¼å¶ä»æå¡èç¹çåå§åè¿æ¥ä¹ä¸åå½±åï¼ææ¢ä¹å°±æ¯è¿ä¸ªæå¡èç¹çåå§åè¿æ¥èè´¹çæ¶é´ï¼æç»æææå¡èç¹çåå§åè¿æ¥èæ¶æ§å¶å¨ä¸ä¸ªå¯ä»¥æ¥åçæ¶é´èå´åã\n\n\n# 6.3. æ¹éæ³¨éæå¡\n\néå¸¸ä¸ä¸ªæå¡æä¾èèç¹æä¾ä¸æ­¢ä¸ä¸ªæå¡ï¼æä»¥æ³¨åååæ³¨åé½éè¦å¤æ¬¡è°ç¨æ³¨åä¸­å¿ãå¨ä¸æ³¨åä¸­å¿çå¤æ¬¡äº¤äºä¸­ï¼å¯è½ç±äºç½ç»æå¨ãæ³¨åä¸­å¿éç¾¤å¼å¸¸ç­åå ï¼å¯¼è´ä¸ªå«è°ç¨å¤±è´¥ãå¯¹äºæ³¨åä¸­å¿æ¥è¯´ï¼å¶åçæ³¨åè°ç¨å¤±è´¥å¯¹æå¡è°ç¨åºæ¬æ²¡æå½±åï¼å¶ç»æé¡¶å¤å°±æ¯æä¸ä¸ªæå¡å°äºä¸ä¸ªå¯ç¨çèç¹ãä½å¶åçåæ³¨åè°ç¨å¤±è´¥ä¼å¯¼è´ä¸å¯ç¨çèç¹æ®çå¨æ³¨åä¸­å¿ä¸­ï¼åæâåµå°¸èç¹âï¼ä½æå¡æ¶è´¹èç«¯è¿ä¼æå®å½æâæ´»èç¹âï¼ç»§ç»­åèµ·è°ç¨ï¼æç»å¯¼è´è°ç¨å¤±è´¥ã\n\nå¯ä»¥éè¿è°ç¨æ³¨åä¸­å¿æä¾çæ¹éåæ³¨åæ¥å£ï¼ä¸æ¬¡è°ç¨å°±å¯ä»¥æè¯¥èç¹ä¸æä¾çæææå¡åæ¶æ³¨éæï¼ä»èé¿åäºâåµå°¸èç¹âçåºç°ã\n\n\n# 6.4. æå¡åæ´ä¿¡æ¯çå¢éæ´æ°\n\næå¡æ¶è´¹èç«¯å¯å¨æ¶ï¼é¤äºä¼æ¥è¯¢è®¢éæå¡çå¯ç¨èç¹åè¡¨ååå§åè¿æ¥ï¼è¿ä¼è®¢éæå¡çåæ´ï¼æ¯éä¸æ®µæ¶é´ä»æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯æ è®° signï¼å¹¶ä¸æ¬å°ä¿å­ç sign å¼ä½æ¯å¯¹ï¼å¦æä¸ä¸æ ·ï¼å°±ä¼è°ç¨æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nä¸è¬æåµä¸ï¼æç§è¿ä¸ªè¿ç¨æ¯æ²¡é®é¢çï¼ä½æ¯å¨ç½ç»é¢ç¹æå¨æ¶ï¼æå¡æä¾èä¸æ¥ç»æ³¨åä¸­å¿çå¿è·³å¯è½ä¼ä¸ä¼å¿å¤±è´¥ä¸ä¼å¿æåï¼è¿æ¶åæ³¨åä¸­å¿å°±ä¼é¢ç¹æ´æ°æå¡çå¯ç¨èç¹ä¿¡æ¯ï¼å¯¼è´æå¡æ¶è´¹èé¢ç¹ä»æ³¨åä¸­å¿æåææ°çæå¡å¯ç¨èç¹ä¿¡æ¯ï¼ä¸¥éæ¶å¯è½äº§çç½ç»é£æ´ï¼å¯¼è´æ³¨åä¸­å¿å¸¦å®½è¢«ææ»¡ã\n\nä¸ºäºåå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿ä¸­æåçæå¡å¯ç¨èç¹ä¿¡æ¯çæ°æ®éï¼è¿ä¸ªæ¶åå¯ä»¥éè¿å¢éæ´æ°çæ¹å¼ï¼æ³¨åä¸­å¿åªè¿åååçé£é¨åèç¹ä¿¡æ¯ï¼å°¤å¶å¨åªæå°æ°èç¹ä¿¡æ¯åæ´æ¶ï¼æ­¤ä¸¾å¯ä»¥å¤§å¤§åå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿æåçæ°æ®éï¼ä»èæå¤§ç¨åº¦é¿åäº§çç½ç»é£æ´ã\n\n\n# 7. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * RPC å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²',normalizedContent:'# æå¡æ³¨åååç°\n\n\n# 1. æå¡åæ°æ®\n\næå»ºå¾®æå¡çé¦è¦é®é¢æ¯ï¼æå¡æä¾èåæå¡æ¶è´¹èéä¿¡æ¶ï¼å¦ä½è¾¾æå±è¯ãå·ä½æ¥è¯´ï¼å°±æ¯è¿ä¸ªæå¡çæ¥å£åæ¯ä»ä¹ï¼è°ç¨è¿ä¸ªæå¡éè¦ä¼ éåªäºåæ°ï¼æ¥å£çè¿åå¼æ¯ä»ä¹ç±»åï¼ä»¥åä¸äºå¶ä»æ¥å£æè¿°ä¿¡æ¯ã\n\næå¡çåæ°æ®ä¿¡æ¯éå¸¸æä»¥ä¸ä¿¡æ¯ï¼\n\n * æå¡èç¹ä¿¡æ¯ï¼å¦ ipãç«¯å£ç­ã\n * æ¥å£å®ä¹ï¼å¦æ¥å£åãè¯·æ±åæ°ãååºåæ°ç­ã\n * è¯·æ±å¤±è´¥çéè¯æ¬¡æ°\n * åºååæ¹å¼\n * åç¼©æ¹å¼\n * éä¿¡åè®®\n * ç­ç­\n\nå¸¸è§çåå¸æå¡åæ°æ®çæ¹å¼æï¼\n\n * rest api\n * xml æä»¶\n * idl æä»¶\n\n\n# 1.1. rest api\n\nä»¥ eureka ä¸ºä¾\n\næå¡æä¾èå®ä¹æ¥å£\n\n@restcontroller\npublic class providercontroller {\n\n    private final discoveryclient discoveryclient;\n\n    public providercontroller(discoveryclient discoveryclient) {\n        this.discoveryclient = discoveryclient;\n    }\n\n    @getmapping("/send")\n    public string send() {\n        string services = "services: " + discoveryclient.getservices();\n        system.out.println(services);\n        return services;\n    }\n\n}\n\n\næå¡æ¶è´¹èæ¶è´¹æ¥å£\n\n@restcontroller\npublic class consumercontroller {\n\n    private final loadbalancerclient loadbalancerclient;\n    private final resttemplate resttemplate;\n\n    public consumercontroller(loadbalancerclient loadbalancerclient,\n        resttemplate resttemplate) {\n        this.loadbalancerclient = loadbalancerclient;\n        this.resttemplate = resttemplate;\n    }\n\n    @getmapping("/recv")\n    public string recv() {\n        serviceinstance serviceinstance = loadbalancerclient.choose("eureka-provider");\n        string url = "http://" + serviceinstance.gethost() + ":" + serviceinstance.getport() + "/send";\n        system.out.println(url);\n        return resttemplate.getforobject(url, string.class);\n    }\n\n}\n\n\n\n# 1.2. xml æä»¶\n\nxml æä»¶è¿ç§æ¹å¼çæå¡åå¸åå¼ç¨ä¸»è¦åä¸ä¸ªæ­¥éª¤ï¼\n\nï¼1ï¼æå¡æä¾èå®ä¹æ¥å£ï¼å¹¶å®ç°æ¥å£ã\n\n// the demo service definition.\nservice demoservice {\n  rpc sayhello (hellorequest) returns (helloreply) {}\n}\n\n// the request message containing the user\'s name.\nmessage hellorequest {\n  string name = 1;\n}\n\n// the response message containing the greetings\nmessage helloreply {\n  string message = 1;\n}\n\n\nï¼2ï¼æå¡æä¾èè¿ç¨å¯å¨æ¶ï¼éè¿å è½½ xml éç½®æä»¶å°æ¥å£æ´é²åºå»ã\n\n<beans xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n       xmlns="http://www.springframework.org/schema/beans"\n       xsi:schemalocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-provider"/>\n    <dubbo:registry address="zookeeper://127.0.0.1:2181"/>\n    <dubbo:protocol name="dubbo" port="20890"/>\n    <bean id="demoservice" class="org.apache.dubbo.samples.basic.impl.demoserviceimpl"/>\n    <dubbo:service interface="org.apache.dubbo.samples.basic.api.demoservice" ref="demoservice"/>\n</beans>\n\n\nï¼3ï¼æå¡æ¶è´¹èè¿ç¨å¯å¨æ¶ï¼éè¿å è½½ xml éç½®æä»¶æ¥å¼å¥è¦è°ç¨çæ¥å£ã\n\nconsumer.xml ç¤ºä¾\n\n<beans xmlns:xsi="http://www.w3.org/2001/xmlschema-instance"\n       xmlns:dubbo="http://dubbo.apache.org/schema/dubbo"\n       xmlns="http://www.springframework.org/schema/beans"\n       xsi:schemalocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd">\n    <dubbo:application name="demo-consumer"/>\n    <dubbo:registry group="aaa" address="zookeeper://127.0.0.1:2181"/>\n    <dubbo:reference id="demoservice" check="false" interface="org.apache.dubbo.samples.basic.api.demoservice"/>\n</beans>\n\n\n\n# 1.3. idl æä»¶\n\nidl å°±æ¯æ¥å£æè¿°è¯­è¨ï¼interface description languageï¼çç¼©åï¼éè¿ä¸ç§ä¸­ç«çæ¹å¼æ¥æè¿°æ¥å£ï¼ä½¿å¾å¨ä¸åçå¹³å°ä¸è¿è¡çå¯¹è±¡åä¸åè¯­è¨ç¼åçç¨åºå¯ä»¥ç¸äºéä¿¡äº¤æµã\n\nä¹å°±æ¯è¯´ idl ä¸»è¦æ¯ç¨ä½è·¨è¯­è¨å¹³å°çæå¡ä¹é´çè°ç¨ï¼æä¸¤ç§æå¸¸ç¨ç idlï¼ä¸ä¸ªæ¯ facebook å¼æºçthrift åè®®ï¼å¦ä¸ä¸ªæ¯ google å¼æºçgrpc åè®®ã\n\nä»¥ grpc åè®®ä¸ºä¾ï¼grpc åè®®ä½¿ç¨ protobuf ç®ç§° proto æä»¶æ¥å®ä¹æ¥å£åãè°ç¨åæ°ä»¥åè¿åå¼ç±»åã\n\næ¯å¦æä»¶ helloword.proto å®ä¹äºä¸ä¸ªæ¥å£ sayhello æ¹æ³ï¼å®çè¯·æ±åæ°æ¯ hellorequestï¼å®çè¿åå¼æ¯ helloreplyã\n\n// the greeter service definition.\nservice greeter {\n  // sends a greeting\n  rpc sayhello (hellorequest) returns (helloreply) {}\n  rpc sayhelloagain (hellorequest) returns (helloreply) {}\n\n}\n\n// the request message containing the user\'s name.\nmessage hellorequest {\n  string name = 1;\n}\n\n// the response message containing the greetings\nmessage helloreply {\n  string message = 1;\n}\n\n\nåå¦æå¡æä¾èä½¿ç¨çæ¯ java è¯­è¨ï¼é£ä¹å©ç¨ protoc æä»¶å³å¯èªå¨çæ server ç«¯ç java ä»£ç ã\n\nprivate class greeterimpl extends greetergrpc.greeterimplbase {\n\n  @override\n  public void sayhello(hellorequest req, streamobserver<helloreply> responseobserver) {\n    helloreply reply = helloreply.newbuilder().setmessage("hello " + req.getname()).build();\n    responseobserver.onnext(reply);\n    responseobserver.oncompleted();\n  }\n\n  @override\n  public void sayhelloagain(hellorequest req, streamobserver<helloreply> responseobserver) {\n    helloreply reply = helloreply.newbuilder().setmessage("hello again " + req.getname()).build();\n    responseobserver.onnext(reply);\n    responseobserver.oncompleted();\n  }\n}\n\n\nåå¦æå¡æ¶è´¹èä½¿ç¨çä¹æ¯ java è¯­è¨ï¼é£ä¹å©ç¨ protoc æä»¶å³å¯èªå¨çæ client ç«¯ç java ä»£ç ã\n\npublic void greet(string name) {\n  logger.info("will try to greet " + name + " ...");\n  hellorequest request = hellorequest.newbuilder().setname(name).build();\n  helloreply response;\n  try {\n    response = blockingstub.sayhello(request);\n  } catch (statusruntimeexception e) {\n    logger.log(level.warning, "rpc failed: {0}", e.getstatus());\n    return;\n  }\n  logger.info("greeting: " + response.getmessage());\n  try {\n    response = blockingstub.sayhelloagain(request);\n  } catch (statusruntimeexception e) {\n    logger.log(level.warning, "rpc failed: {0}", e.getstatus());\n    return;\n  }\n  logger.info("greeting: " + response.getmessage());\n}\n\n\nåå¦æå¡æ¶è´¹èä½¿ç¨çæ¯å¶ä»è¯­è¨ï¼ä¹å¯ä»¥å©ç¨ç¸åºçæä»¶çæä»£ç ã\n\nç±æ­¤å¯è§ï¼grpc åè®®çæå¡æè¿°æ¯éè¿ proto æä»¶æ¥å®ä¹æ¥å£çï¼ç¶ååä½¿ç¨ protoc æ¥çæä¸åè¯­è¨å¹³å°çå®¢æ·ç«¯åæå¡ç«¯ä»£ç ï¼ä»èå·å¤è·¨è¯­è¨æå¡è°ç¨è½åã\n\næä¸ç¹ç¹å«éè¦æ³¨æçæ¯ï¼å¨æè¿°æ¥å£å®ä¹æ¶ï¼idl æä»¶éè¦å¯¹æ¥å£è¿åå¼è¿è¡è¯¦ç»å®ä¹ãå¦ææ¥å£è¿åå¼çå­æ®µæ¯è¾å¤ï¼å¹¶ä¸ç»å¸¸ååæ¶ï¼éç¨ idl æä»¶æ¹å¼çæ¥å£å®ä¹å°±ä¸å¤ªåéäºãä¸æ¹é¢å¯è½ä¼é æ idl æä»¶è¿å¤§é¾ä»¥ç»´æ¤ï¼å¦ä¸æ¹é¢åªè¦ idl æä»¶ä¸­å®ä¹çæ¥å£è¿åå¼æåæ´ï¼é½éè¦åæ­¥ææçæå¡æ¶è´¹èé½æ´æ°ï¼ç®¡çææ¬å°±å¤ªé«äºã\n\n\n# 2. æå¡æ³¨åååç°åºæ¬åç\n\næå¡åç°éå¸¸ä¾èµäºæ³¨åä¸­å¿æ¥åè°æå¡åç°çè¿ç¨ï¼å¶æ­¥éª¤å¦ä¸ï¼\n\n 1. æå¡æä¾èå°æ¥å£ä¿¡æ¯ä»¥æ³¨åå°æ³¨åä¸­å¿ã\n 2. æå¡æ¶è´¹èä»æ³¨åä¸­å¿è¯»ååè®¢éæå¡æä¾èçå°åä¿¡æ¯ã\n 3. å¦ææå¯ç¨çæå¡ï¼æ³¨åä¸­å¿ä¼ä¸»å¨éç¥æå¡æ¶è´¹èã\n 4. æå¡æ¶è´¹èæ ¹æ®å¯ç¨æå¡çå°ååè¡¨ï¼è°ç¨æå¡æä¾èçæ¥å£ã\n\nè¿ä¸ªè¿ç¨å¾åæ¯çæ´»ä¸­çæ¿å±ç§èµï¼æ¿ä¸å°ç§æ¿ä¿¡æ¯æå°ä¸­ä»å¬å¸ï¼æ¿å®¢ä»ä¸­ä»å¬å¸æ¥æ¾ç§æ¿ä¿¡æ¯ãæ¿å®¢å¦ææ³è¦ç§æ¿ä¸çæ¿å­ï¼éè¿ä¸­ä»å¬å¸çµçº¿æ­æ¡¥ï¼èç³»ä¸æ¿ä¸ï¼åæ¹è°å¦¥ç­¾è®¢åè®®ï¼å°±å¯ä»¥æ­£å¼å»ºç«èµ·ç§èµå³ç³»ã\n\n\n\nä¸»æµçæå¡æ³¨åä¸åç°çè§£å³æ¹æ¡ï¼ä¸»è¦æä¸¤ç§ï¼\n\n * åºç¨åæ³¨åä¸åç°ï¼æ³¨åä¸­å¿æä¾æå¡ç«¯åå®¢æ·ç«¯ç sdkï¼ä¸å¡åºç¨éè¿å¼å¥æ³¨åä¸­å¿æä¾ç sdkï¼éè¿ sdk ä¸æ³¨åä¸­å¿äº¤äºï¼æ¥å®ç°æå¡çæ³¨åååç°ã\n * åºç¨å¤æ³¨åä¸åç°ï¼ä¸å¡åºç¨æ¬èº«ä¸éè¦éè¿ sdk ä¸æ³¨åä¸­å¿æäº¤éï¼èæ¯éè¿å¶ä»æ¹å¼ä¸æ³¨åä¸­å¿äº¤äºï¼é´æ¥å®ææå¡æ³¨åä¸åç°ã\n\n\n# 2.1. åºç¨åæ³¨åä¸åç°\n\nåºç¨åæ³¨åä¸åç°æ¹æ¡æ¯ï¼æ³¨åä¸­å¿æä¾æå¡ç«¯åå®¢æ·ç«¯ç sdkï¼ä¸å¡åºç¨éè¿å¼å¥æ³¨åä¸­å¿æä¾ç sdkï¼éè¿ sdk ä¸æ³¨åä¸­å¿äº¤äºï¼æ¥å®ç°æå¡çæ³¨åååç°ãæå¸åçæ¡ä¾è¦å± netflix å¼æºç eurekaï¼å®æ¹æ¶æå¾å¦ä¸ï¼\n\n\n\neureka çæ¶æä¸»è¦ç±ä¸ä¸ªéè¦çç»ä»¶ç»æï¼\n\n * eureka serverï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°äºæå¡ä¿¡æ¯æ³¨åãå­å¨ä»¥åæ¥è¯¢ç­åè½ã\n * æå¡ç«¯ç eureka clientï¼éæå¨æå¡ç«¯çæ³¨åä¸­å¿ sdkï¼æå¡æä¾èéè¿è°ç¨ sdkï¼å®ç°æå¡æ³¨åãåæ³¨åç­åè½ã\n * å®¢æ·ç«¯ç eureka clientï¼éæå¨å®¢æ·ç«¯çæ³¨åä¸­å¿ sdkï¼æå¡æ¶è´¹èéè¿è°ç¨ sdkï¼å®ç°æå¡è®¢éãæå¡æ´æ°ç­åè½ã\n\n\n# 2.2. åºç¨å¤æ³¨åä¸åç°\n\nåºç¨å¤æ³¨åä¸åç°æ¹æ¡æ¯ï¼ä¸å¡åºç¨æ¬èº«ä¸éè¦éè¿ sdk ä¸æ³¨åä¸­å¿æäº¤éï¼èæ¯éè¿å¶ä»æ¹å¼ä¸æ³¨åä¸­å¿äº¤äºï¼é´æ¥å®ææå¡æ³¨åä¸åç°ãæå¸åçæ¡ä¾æ¯å¼æºæ³¨åä¸­å¿ consulã\n\n\n\nconsul å®ç°åºç¨å¤æå¡æ³¨åååç°ä¸»è¦ä¾é ä¸ä¸ªéè¦çç»ä»¶ï¼\n\n * consulï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°æå¡æ³¨åä¿¡æ¯çå­å¨ï¼å¹¶æä¾æ³¨åååç°æå¡ã\n * registratorï¼ä¸ä¸ªå¼æºçç¬¬ä¸æ¹æå¡ç®¡çå¨é¡¹ç®ï¼å®éè¿çå¬æå¡é¨ç½²ç docker å®ä¾æ¯å¦å­æ´»ï¼æ¥è´è´£æå¡æä¾èçæ³¨ååéæ¯ã\n * consul templateï¼å®æ¶ä»æ³¨åä¸­å¿æå¡ç«¯è·åææ°çæå¡æä¾èèç¹åè¡¨å¹¶å·æ° lb éç½®ï¼æ¯å¦ nginx ç upstreamï¼ï¼è¿æ ·æå¡æ¶è´¹èå°±éè¿è®¿é® nginx å°±å¯ä»¥è·åææ°çæå¡æä¾èä¿¡æ¯ã\n\n\n# 3. æ³¨åä¸­å¿åºæ¬åè½\n\nä»æå¡æ³¨åååç°çæµç¨ï¼å¯ä»¥çåºï¼æ³¨åä¸­å¿æ¯æå¡åç°çæ ¸å¿ç»ä»¶ãå¸¸è§çæ³¨åä¸­å¿ç»ä»¶æï¼nacosãconsulãzookeeper ç­ã\n\næ³¨åä¸­å¿æ¯ç¨æ¥å­å¨æå¡çåæ°æ®ä¿¡æ¯ãæå¡çåæ°æ®ä¿¡æ¯éå¸¸æä»¥ä¸ä¿¡æ¯ï¼\n\n * æå¡èç¹ä¿¡æ¯ï¼å¦ ipãç«¯å£ç­ã\n * æ¥å£å®ä¹ï¼å¦æ¥å£åãè¯·æ±åæ°ãååºåæ°ç­ã\n * è¯·æ±å¤±è´¥çéè¯æ¬¡æ°\n * åºååæ¹å¼\n * åç¼©æ¹å¼\n * éä¿¡åè®®\n * ç­ç­\n\nå¨å·ä½å­å¨æ¶ï¼ä¸è¬ä¼æç§âæå¡ - åç» - èç¹ä¿¡æ¯âä¸å±ç»ææ¥å­å¨ã\n\næ³¨åä¸­å¿çå®ç°ä¸»è¦æ¶åå ä¸ªé®é¢ï¼æ³¨åä¸­å¿éè¦æä¾åªäºæ¥å£ï¼è¯¥å¦ä½é¨ç½²ï¼å¦ä½å­å¨æå¡ä¿¡æ¯ï¼å¦ä½çæ§æå¡æä¾èèç¹çå­æ´»ï¼å¦ææå¡æä¾èèç¹æååå¦ä½éç¥æå¡æ¶è´¹èï¼ä»¥åå¦ä½æ§å¶æ³¨åä¸­å¿çè®¿é®æéã\n\n\n# 3.1. æ³¨åä¸­å¿ api\n\næ ¹æ®æ³¨åä¸­å¿åççæè¿°ï¼æ³¨åä¸­å¿å¿é¡»æä¾ä»¥ä¸æåºæ¬ç apiï¼ä¾å¦ï¼\n\n * æå¡æ³¨åæ¥å£ï¼æå¡æä¾èéè¿è°ç¨æå¡æ³¨åæ¥å£æ¥å®ææå¡æ³¨åã\n * æå¡åæ³¨åæ¥å£ï¼æå¡æä¾èéè¿è°ç¨æå¡åæ³¨åæ¥å£æ¥å®ææå¡æ³¨éã\n * å¿è·³æ±æ¥æ¥å£ï¼æå¡æä¾èéè¿è°ç¨å¿è·³æ±æ¥æ¥å£å®æèç¹å­æ´»ç¶æä¸æ¥ã\n * æå¡è®¢éæ¥å£ï¼æå¡æ¶è´¹èéè¿è°ç¨æå¡è®¢éæ¥å£å®ææå¡è®¢éï¼è·åå¯ç¨çæå¡æä¾èèç¹åè¡¨ã\n * æå¡åæ´æ¥è¯¢æ¥å£ï¼æå¡æ¶è´¹èéè¿è°ç¨æå¡åæ´æ¥è¯¢æ¥å£ï¼è·åææ°çå¯ç¨æå¡èç¹åè¡¨ã\n\né¤æ­¤ä¹å¤ï¼ä¸ºäºä¾¿äºç®¡çï¼æ³¨åä¸­å¿è¿å¿é¡»æä¾ä¸äºåå°ç®¡çç apiï¼ä¾å¦ï¼\n\n * æå¡æ¥è¯¢æ¥å£ï¼æ¥è¯¢æ³¨åä¸­å¿å½åæ³¨åäºåªäºæå¡ä¿¡æ¯ã\n * æå¡ä¿®æ¹æ¥å£ï¼ä¿®æ¹æ³¨åä¸­å¿ä¸­æä¸æå¡çä¿¡æ¯ã\n\n\n# 3.2. éç¾¤é¨ç½²\n\næ³¨åä¸­å¿ä½ä¸ºæå¡æä¾èåæå¡æ¶è´¹èä¹é´æ²éçæ¡¥æ¢ï¼å®çéè¦æ§ä¸è¨èå»ãæä»¥æ³¨åä¸­å¿ä¸è¬é½æ¯éç¨éç¾¤é¨ç½²æ¥ä¿è¯é«å¯ç¨æ§ï¼å¹¶éè¿åå¸å¼ä¸è´æ§åè®®æ¥ç¡®ä¿éç¾¤ä¸­ä¸åèç¹ä¹é´çæ°æ®ä¿æä¸è´ã\n\nä»¥å¼æºæ³¨åä¸­å¿ zookeeper ä¸ºä¾ï¼zookeeper éç¾¤ä¸­åå«å¤ä¸ªèç¹ï¼æå¡æä¾èåæå¡æ¶è´¹èå¯ä»¥åä»»æä¸ä¸ªèç¹éä¿¡ï¼å ä¸ºå®ä»¬çæ°æ®ä¸å®æ¯ç¸åçï¼è¿æ¯ä¸ºä»ä¹å¢ï¼è¿å°±è¦ä» zookeeper çå·¥ä½åçè¯´èµ·ï¼\n\n * æ¯ä¸ª server å¨åå­ä¸­å­å¨äºä¸ä»½æ°æ®ï¼client çè¯»è¯·æ±å¯ä»¥è¯·æ±ä»»æä¸ä¸ª serverã\n * zookeeper å¯å¨æ¶ï¼å°ä»å®ä¾ä¸­éä¸¾ä¸ä¸ª leaderï¼paxos åè®®ï¼ã\n * leader è´è´£å¤çæ°æ®æ´æ°ç­æä½ï¼zab åè®®ï¼ã\n * ä¸ä¸ªæ´æ°æä½æåï¼å½ä¸ä»å½å¤§å¤æ° server å¨åå­ä¸­æåä¿®æ¹ ã\n\néè¿ä¸é¢è¿ç§æ¹å¼ï¼zookeeper ä¿è¯äºé«å¯ç¨æ§ä»¥åæ°æ®ä¸è´æ§ã\n\n\n\n\n# 3.3. åæ°æ®å­å¨\n\næ³¨åä¸­å¿å­å¨æå¡ä¿¡æ¯ä¸è¬éç¨å±æ¬¡åçç®å½ç»æï¼ä»¥ zookeeper ä¸ºä¾ï¼\n\n * æ¯ä¸ªç®å½å¨ zookeeper ä¸­å«ä½ znodeï¼å¹¶ä¸å¶æä¸ä¸ªå¯ä¸çè·¯å¾æ è¯ã\n * znode å¯ä»¥åå«æ°æ®åå­ znodeã\n * znode ä¸­çæ°æ®å¯ä»¥æå¤ä¸ªçæ¬ï¼æ¯å¦æä¸ä¸ª znode ä¸å­æå¤ä¸ªæ°æ®çæ¬ï¼é£ä¹æ¥è¯¢è¿ä¸ªè·¯å¾ä¸çæ°æ®éå¸¦ä¸çæ¬ä¿¡æ¯ã\n\n\n\n\n# 3.4. ç½ååæºå¶\n\nå¨å®éçå¾®æå¡æµè¯åé¨ç½²æ¶ï¼éå¸¸åå«å¤å¥ç¯å¢ï¼æ¯å¦çäº§ç¯å¢ä¸å¥ãæµè¯ç¯å¢ä¸å¥ãå¼åå¨è¿è¡ä¸å¡èªæµãæµè¯å¨è¿è¡åå½æµè¯æ¶ï¼ä¸è¬é½æ¯ç¨æµè¯ç¯å¢ï¼é¨ç½²ç rpc server èç¹æ³¨åå°æµè¯çæ³¨åä¸­å¿éç¾¤ãä½ç»å¸¸ä¼åºç°å¼åæèæµè¯å¨é¨ç½²æ¶ï¼éè¯¯çææµè¯ç¯å¢ä¸çæå¡èç¹æ³¨åå°äºçº¿ä¸æ³¨åä¸­å¿éç¾¤ï¼è¿æ ·çè¯çº¿ä¸æµéå°±ä¼è°ç¨å°æµè¯ç¯å¢ä¸ç rpc server èç¹ï¼å¯è½ä¼é æææ³ä¸å°çåæã\n\nä¸ºäºé²æ­¢è¿ç§æåµåçï¼æ³¨åä¸­å¿éè¦æä¾ä¸ä¸ªä¿æ¤æºå¶ï¼ä½ å¯ä»¥ææ³¨åä¸­å¿æ³è±¡æä¸ä¸ªå¸¦æé¨ç¦çæ¿é´ï¼åªææ¥æé¨ç¦å¡ç rpc server æè½è¿å¥ãå¨å®éåºç¨ä¸­ï¼æ³¨åä¸­å¿å¯ä»¥æä¾ä¸ä¸ªç½ååæºå¶ï¼åªææ·»å å°æ³¨åä¸­å¿ç½åååç rpc serverï¼æè½å¤è°ç¨æ³¨åä¸­å¿çæ³¨åæ¥å£ï¼è¿æ ·çè¯å¯ä»¥é¿åæµè¯ç¯å¢ä¸­çèç¹æå¤è·å°çº¿ä¸ç¯å¢ä¸­å»ã\n\n\n# 4. æå¡å¥åº·æ£æµ\n\næ³¨åä¸­å¿é¤äºè¦æ¯ææåºæ¬çæå¡æ³¨ååæå¡è®¢éåè½ä»¥å¤ï¼è¿å¿é¡»å·å¤å¯¹æå¡æä¾èèç¹çå¥åº·ç¶ææ£æµåè½ï¼è¿æ ·æè½ä¿è¯æ³¨åä¸­å¿éä¿å­çæå¡èç¹é½æ¯å¯ç¨çã\n\nè¿æ¯ä»¥ zookeeper ä¸ºä¾ï¼å®æ¯åºäº zookeeper å®¢æ·ç«¯åæå¡ç«¯çé¿è¿æ¥åä¼è¯è¶æ¶æ§å¶æºå¶ï¼æ¥å®ç°æå¡å¥åº·ç¶ææ£æµçã\n\nå¨ zookeeper ä¸­ï¼å®¢æ·ç«¯åæå¡ç«¯å»ºç«è¿æ¥åï¼ä¼è¯ä¹éä¹å»ºç«ï¼å¹¶çæä¸ä¸ªå¨å±å¯ä¸ç session idãæå¡ç«¯åå®¢æ·ç«¯ç»´æçæ¯ä¸ä¸ªé¿è¿æ¥ï¼å¨ session_timeout å¨æåï¼æå¡ç«¯ä¼æ£æµä¸å®¢æ·ç«¯çé¾è·¯æ¯å¦æ­£å¸¸ï¼å·ä½æ¹å¼æ¯éè¿å®¢æ·ç«¯å®æ¶åæå¡ç«¯åéå¿è·³æ¶æ¯ï¼ping æ¶æ¯ï¼ï¼æå¡å¨éç½®ä¸æ¬¡ session_timeout æ¶é´ãå¦æè¶è¿ session_timeout åæå¡ç«¯é½æ²¡ææ¶å°å®¢æ·ç«¯çå¿è·³æ¶æ¯ï¼åæå¡ç«¯è®¤ä¸ºè¿ä¸ª session å°±å·²ç»ç»æäºï¼zookeeper å°±ä¼è®¤ä¸ºè¿ä¸ªæå¡èç¹å·²ç»ä¸å¯ç¨ï¼å°ä¼ä»æ³¨åä¸­å¿ä¸­å é¤å¶ä¿¡æ¯ã\n\n\n# 4.1. æå¡ç¶æåæ´éç¥\n\nä¸æ¦æ³¨åä¸­å¿æ¢æµå°ææå¡æä¾èèç¹æ°å å¥æèè¢«åé¤ï¼å°±å¿é¡»ç«å»éç¥ææè®¢éè¯¥æå¡çæå¡æ¶è´¹èï¼å·æ°æ¬å°ç¼å­çæå¡èç¹ä¿¡æ¯ï¼ç¡®ä¿æå¡è°ç¨ä¸ä¼è¯·æ±ä¸å¯ç¨çæå¡æä¾èèç¹ã\n\nç»§ç»­ä»¥ zookeeper ä¸ºä¾ï¼åºäº zookeeper ç watcher æºå¶ï¼æ¥å®ç°æå¡ç¶æåæ´éç¥ç»æå¡æ¶è´¹èçãæå¡æ¶è´¹èå¨è°ç¨ zookeeper ç getdata æ¹æ³è®¢éæå¡æ¶ï¼è¿å¯ä»¥éè¿çå¬å¨ watcher ç process æ¹æ³è·åæå¡çåæ´ï¼ç¶åè°ç¨ getdata æ¹æ³æ¥è·ååæ´åçæ°æ®ï¼å·æ°æ¬å°ç¼å­çæå¡èç¹ä¿¡æ¯ã\n\n\n# 4.2. å¿è·³å¼å³ä¿æ¤æºå¶\n\nå¨ç½ç»é¢ç¹æå¨çæåµä¸ï¼æ³¨åä¸­å¿ä¸­å¯ç¨çèç¹ä¼ä¸æ­ååï¼è¿æ¶åæå¡æ¶è´¹èä¼é¢ç¹æ¶å°æå¡æä¾èèç¹åæ´çä¿¡æ¯ï¼äºæ¯å°±ä¸æ­å°è¯·æ±æ³¨åä¸­å¿æ¥æåææ°çå¯ç¨æå¡èç¹ä¿¡æ¯ãå½ææç¾ä¸åä¸ªæå¡æ¶è´¹èï¼åæ¶è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡æä¾èçèç¹ä¿¡æ¯æ¶ï¼å¯è½ä¼ææ³¨åä¸­å¿çå¸¦å®½ç»å æ»¡ï¼å°¤å¶æ¯æ³¨åä¸­å¿æ¯ç¾åç½å¡çæåµä¸ã\n\néå¯¹è¿ç§æåµï¼éè¦ä¸ç§ä¿æ¤æºå¶ï¼å³ä½¿å¨ç½ç»é¢ç¹æå¨çæ¶åï¼æå¡æ¶è´¹èä¹ä¸è³äºåæ¶å»è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nä¸ä¸ªå¯è¡çè§£å³æ¹æ¡å°±æ¯ç»æ³¨åä¸­å¿è®¾ç½®ä¸ä¸ªå¼å³ï¼å½å¼å³æå¼æ¶ï¼å³ä½¿ç½ç»é¢ç¹æå¨ï¼æ³¨åä¸­å¿ä¹ä¸ä¼éç¥ææçæå¡æ¶è´¹èææå¡èç¹ä¿¡æ¯åæ´ï¼æ¯å¦åªç» 10% çæå¡æ¶è´¹èè¿ååæ´ï¼è¿æ ·çè¯å°±è½å°æ³¨åä¸­å¿çè¯·æ±éåå°å°åæ¥ç 1/10ãå½ç¶æå¼è¿ä¸ªå¼å³ä¹æ¯æä¸å®ä»£ä»·çï¼å®ä¼å¯¼è´æå¡æ¶è´¹èæç¥ææ°çæå¡èç¹ä¿¡æ¯å»¶è¿ï¼ååå¯è½å¨ 10s åå°±è½æç¥å°æå¡æä¾èèç¹ä¿¡æ¯çåæ´ï¼ç°å¨å¯è½ä¼å»¶è¿å°å åéï¼æä»¥å¨ç½ç»æ­£å¸¸çæåµä¸ï¼å¼å³å¹¶ä¸éåæå¼ï¼å¯ä»¥ä½ä¸ºä¸ä¸ªç´§æ¥æªæ½ï¼å¨ç½ç»é¢ç¹æå¨çæ¶åï¼ææå¼è¿ä¸ªå¼å³ã\n\nå¿è·³å¼å³ä¿æ¤æºå¶ï¼æ¯ä¸ºäºé²æ­¢æå¡æä¾èèç¹é¢ç¹åæ´å¯¼è´çæå¡æ¶è´¹èåæ¶å»æ³¨åä¸­å¿è·åææ°æå¡èç¹ä¿¡æ¯ã\n\n\n# 4.3. æå¡èç¹æé¤ä¿æ¤æºå¶\n\næå¡æä¾èå¨è¿ç¨å¯å¨æ¶ï¼ä¼æ³¨åæå¡å°æ³¨åä¸­å¿ï¼å¹¶æ¯éä¸æ®µæ¶é´ï¼æ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼ä»¥æ è¯èªå·±çå­æ´»ç¶æãå¦æéäºä¸æ®µåºå®æ¶é´åï¼æå¡æä¾èä»ç¶æ²¡ææ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼æ³¨åä¸­å¿å°±ä¼è®¤ä¸ºè¯¥èç¹å·²ç»å¤äºâdeadâç¶æï¼äºæ¯ä»æå¡çå¯ç¨èç¹ä¿¡æ¯ä¸­ç§»é¤åºå»ã\n\nå¦æéå°ç½ç»é®é¢ï¼å¤§æ¹æå¡æä¾èèç¹æ±æ¥ç»æ³¨åä¸­å¿çå¿è·³ä¿¡æ¯é½å¯è½ä¼ä¼ è¾¾å¤±è´¥ï¼æ³¨åä¸­å¿å°±ä¼æå®ä»¬é½ä»å¯ç¨èç¹åè¡¨ä¸­ç§»é¤åºå»ï¼é æå©ä¸çå¯ç¨èç¹é¾ä»¥æ¿åææçè°ç¨ï¼å¼èµ·âéªå´©âãä½æ¯è¿ç§æåµä¸ï¼å¯è½å¤§é¨åæå¡æä¾èèç¹æ¯å¯ç¨çï¼ä»ä»å ä¸ºç½ç»åå æ æ³æ±æ¥å¿è·³ç»æ³¨åä¸­å¿å°±è¢«âæ æâçæé¤äºã\n\nè¿ä¸ªæ¶åå°±éè¦æ ¹æ®å®éä¸å¡çæåµï¼è®¾å®ä¸ä¸ªéå¼æ¯ä¾ï¼å³ä½¿éå°åæè¯´çè¿ç§æåµï¼æ³¨åä¸­å¿ä¹ä¸è½æé¤è¶è¿è¿ä¸ªéå¼æ¯ä¾çèç¹ã\n\nè¿ä¸ªéå¼æ¯ä¾å¯ä»¥æ ¹æ®å®éä¸å¡çåä½åº¦æ¥ç¡®å®ï¼æéå¸¸ä¼æè¿ä¸ªæ¯ä¾è®¾å®å¨ 20%ï¼å°±æ¯è¯´æ³¨åä¸­å¿ä¸è½æé¤è¶è¿ 20% çèç¹ãå ä¸ºå¤§é¨åæåµä¸ï¼èç¹çååä¸ä¼è¿ä¹é¢ç¹ï¼åªæå¨ç½ç»æå¨æèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµä¸ææå¯è½åçãèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµæ¯å¯ä»¥é¢ç¥çï¼è¿ç§æåµä¸å¯ä»¥å³é­éå¼ä¿æ¤ï¼èæ­£å¸¸æåµä¸ï¼åºè¯¥æå¼éå¼ä¿æ¤ï¼ä»¥é²æ­¢ç½ç»æå¨æ¶ï¼å¤§æ¹éå¯ç¨çæå¡èç¹è¢«æé¤ã\n\næå¡èç¹æé¤ä¿æ¤æºå¶ï¼æ¯ä¸ºäºé²æ­¢æå¡æä¾èèç¹è¢«å¤§éæé¤å¼èµ·æå¡æ¶è´¹èå¯ä»¥è°ç¨çèç¹ä¸è¶³ã\n\n\n# 4.4. éææ³¨åä¸­å¿\n\nå ä¸ºæå¡æä¾èæ¯åæå¡æ¶è´¹èæä¾æå¡çï¼æ¯å¦å¯ç¨æå¡æ¶è´¹èåºè¯¥æ¯æ³¨åä¸­å¿æ´æ¸æ¥ï¼å æ­¤å¯ä»¥ç´æ¥å¨æå¡æ¶è´¹èç«¯æ ¹æ®è°ç¨æå¡æä¾èæ¯å¦æåæ¥å¤å®æå¡æä¾èæ¯å¦å¯ç¨ãå¦ææå¡æ¶è´¹èè°ç¨æä¸ä¸ªæå¡æä¾èèç¹è¿ç»­å¤±è´¥è¶è¿ä¸å®æ¬¡æ°ï¼å¯ä»¥å¨æ¬å°åå­ä¸­å°è¿ä¸ªèç¹æ è®°ä¸ºä¸å¯ç¨ãå¹¶ä¸æ¯éä¸æ®µåºå®æ¶é´ï¼æå¡æ¶è´¹èé½è¦åæ è®°ä¸ºä¸å¯ç¨çèç¹åèµ·ä¿æ´»æ¢æµï¼å¦ææ¢æµæåäºï¼å°±å°æ è®°ä¸ºä¸å¯ç¨çèç¹åæ¢å¤ä¸ºå¯ç¨ç¶æï¼éæ°åèµ·è°ç¨ã\n\n\n# 5. æ³¨åä¸­å¿éå\n\næ³¨åä¸­å¿éåæ¶æéè¦å³æ³¨ä¸¤ä¸ªé®é¢ï¼é«å¯ç¨æ§åæ°æ®ä¸è´æ§ã\n\n\n# 5.1. é«å¯ç¨æ§\n\næ³¨åä¸­å¿ä½ä¸ºæå¡æä¾èåæå¡æ¶è´¹èä¹é´æ²éççº½å¸¦ï¼å®çé«å¯ç¨æ§ååéè¦ãå¦ææ³¨åä¸­å¿ä¸å¯ç¨äºï¼é£ä¹æå¡æä¾èå°±æ æ³å¯¹å¤æ´é²èªå·±çæå¡ï¼èæå¡æ¶è´¹èä¹æ æ³ç¥éèªå·±æ³è¦è°ç¨çæå¡çå·ä½å°åã\n\nå®ç°é«å¯ç¨æ§çææ®µä¸»è¦æä¸¤ç§\n\n * éç¾¤é¨ç½²ï¼å³ä½¿æé¨åæºå¨å®æºï¼å°è¯·æ±ååå°æ­£å¸¸çæºå¨ä¸å°±å¯ä»¥ä¿è¯æå¡çæ­£å¸¸è®¿é®ã\n * å¤æºæ¿é¨ç½²ï¼é¿åä¸ä¸ªæºæ¿å ä¸ºæ­çµæèåç¼è¢«ææ­ç­ä¸å¯æåå ç´ ä¸å¯ç¨æ¶ï¼ä»ç¶å¯ä»¥éè¿æè¯·æ±è¿ç§»å°å¶ä»æºæ¿æ¥ä¿è¯æå¡çæ­£å¸¸è®¿é®ã\n\nè¿ä¸¤ç§ææ®µæ¬è´¨ä¸é½æ¯æå¡åä½ã\n\n\n# 5.2. æ°æ®ä¸è´æ§\n\n\n# 6. æå¡åç°çé®é¢\n\n\n# 6.1. å¤æ³¨åä¸­å¿\n\nçæ³æåµä¸ï¼å¦æå§ç»åªæä¸ä¸ªæ³¨åä¸­å¿ï¼é£ä¹æ´ä¸ªäº¤äºéå¸¸ç®åãä½å¨å®éå·¥ä½ä¸­ï¼å¾å¾éè¦å¯¹æ¥å¤ä¸ªæ³¨åä¸­å¿ï¼å¸¸è§åºæ¯å¦ä¸ï¼\n\n * æå¡æ¶è´¹èè®¢éå¤ä¸ªæ³¨åä¸­å¿ï¼æå¡æ¶è´¹èå¯è½è®¢éäºå¤ä¸ªæå¡ï¼å¤ä¸ªæå¡å¯è½æ¯ç±å¤ä¸ªä¸å¡é¨é¨æä¾çï¼èä¸æ¯ä¸ªä¸å¡é¨é¨é½æèªå·±çæ³¨åä¸­å¿ï¼æä¾çæå¡åªå¨èªå·±çæ³¨åä¸­å¿éæè®°å½ãè¿å°±è¦æ±æå¡æ¶è´¹èè¦å·å¤å¨å¯å¨æ¶ï¼è½å¤ä»å¤ä¸ªæ³¨åä¸­å¿è®¢éæå¡çè½åã\n * æå¡æä¾èæ³¨åå¤ä¸ªæ³¨åä¸­å¿ï¼ä¸ä¸ªæå¡æä¾èæä¾äºæä¸ªæå¡ï¼å¯è½ä½ä¸ºéææå¡å¯¹å¤æä¾ï¼ä¹å¯è½ä½ä¸ºå¨ææå¡å¯¹å¤æä¾ï¼è¿ä¸¤ä¸ªæå¡é¨ç½²å¨ä¸åçæ³¨åä¸­å¿ï¼æä»¥è¦æ±æå¡æä¾èå¨å¯å¨çæ¶åï¼è¦è½å¤åæ¶åå¤ä¸ªæ³¨åä¸­å¿æ³¨åæå¡ã\n\n\n# 6.2. å¹¶è¡è®¢éæå¡\n\néå¸¸ä¸ä¸ªæå¡æ¶è´¹èè®¢éäºä¸æ­¢ä¸ä¸ªæå¡ãå¦æéç¨ä¸²è¡è®¢éæ¹å¼ï¼å³æ¯è®¢éä¸ä¸ªæå¡ï¼æå¡æ¶è´¹èå°±è°ç¨ä¸æ¬¡æ³¨åä¸­å¿çè®¢éæ¥å£ï¼è·åè¿ä¸ªæå¡çèç¹åè¡¨å¹¶åå§åè¿æ¥ï¼å°±å¯è½è¦æ§è¡å¾å¤æ¬¡è¿æ ·çè¿ç¨ãå¨æäºæå¡èç¹çåå§åè¿æ¥è¿ç¨ä¸­ï¼åºç°è¿æ¥è¶æ¶çæåµï¼åç»­ææçæå¡èç¹çåå§åè¿æ¥é½éè¦ç­å¾å®å®æï¼å¯¼è´æå¡æ¶è´¹èå¯å¨åæ¢ï¼æåèè´¹äºå°è¿äºåéæ¶é´æ¥å®ææææå¡èç¹çåå§åè¿æ¥è¿ç¨ã\n\nç±äºä»¥ä¸é®é¢ï¼æä»¥æå¡åç°åºè¯¥æ¯æå¹¶è¡è®¢éï¼æ¯è®¢éä¸ä¸ªæå¡å°±åç¬ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çï¼è¿æ ·çè¯å³ä½¿éå°ä¸ªå«æå¡èç¹è¿æ¥è¶æ¶ï¼å¶ä»æå¡èç¹çåå§åè¿æ¥ä¹ä¸åå½±åï¼ææ¢ä¹å°±æ¯è¿ä¸ªæå¡èç¹çåå§åè¿æ¥èè´¹çæ¶é´ï¼æç»æææå¡èç¹çåå§åè¿æ¥èæ¶æ§å¶å¨ä¸ä¸ªå¯ä»¥æ¥åçæ¶é´èå´åã\n\n\n# 6.3. æ¹éæ³¨éæå¡\n\néå¸¸ä¸ä¸ªæå¡æä¾èèç¹æä¾ä¸æ­¢ä¸ä¸ªæå¡ï¼æä»¥æ³¨åååæ³¨åé½éè¦å¤æ¬¡è°ç¨æ³¨åä¸­å¿ãå¨ä¸æ³¨åä¸­å¿çå¤æ¬¡äº¤äºä¸­ï¼å¯è½ç±äºç½ç»æå¨ãæ³¨åä¸­å¿éç¾¤å¼å¸¸ç­åå ï¼å¯¼è´ä¸ªå«è°ç¨å¤±è´¥ãå¯¹äºæ³¨åä¸­å¿æ¥è¯´ï¼å¶åçæ³¨åè°ç¨å¤±è´¥å¯¹æå¡è°ç¨åºæ¬æ²¡æå½±åï¼å¶ç»æé¡¶å¤å°±æ¯æä¸ä¸ªæå¡å°äºä¸ä¸ªå¯ç¨çèç¹ãä½å¶åçåæ³¨åè°ç¨å¤±è´¥ä¼å¯¼è´ä¸å¯ç¨çèç¹æ®çå¨æ³¨åä¸­å¿ä¸­ï¼åæâåµå°¸èç¹âï¼ä½æå¡æ¶è´¹èç«¯è¿ä¼æå®å½æâæ´»èç¹âï¼ç»§ç»­åèµ·è°ç¨ï¼æç»å¯¼è´è°ç¨å¤±è´¥ã\n\nå¯ä»¥éè¿è°ç¨æ³¨åä¸­å¿æä¾çæ¹éåæ³¨åæ¥å£ï¼ä¸æ¬¡è°ç¨å°±å¯ä»¥æè¯¥èç¹ä¸æä¾çæææå¡åæ¶æ³¨éæï¼ä»èé¿åäºâåµå°¸èç¹âçåºç°ã\n\n\n# 6.4. æå¡åæ´ä¿¡æ¯çå¢éæ´æ°\n\næå¡æ¶è´¹èç«¯å¯å¨æ¶ï¼é¤äºä¼æ¥è¯¢è®¢éæå¡çå¯ç¨èç¹åè¡¨ååå§åè¿æ¥ï¼è¿ä¼è®¢éæå¡çåæ´ï¼æ¯éä¸æ®µæ¶é´ä»æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯æ è®° signï¼å¹¶ä¸æ¬å°ä¿å­ç sign å¼ä½æ¯å¯¹ï¼å¦æä¸ä¸æ ·ï¼å°±ä¼è°ç¨æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nä¸è¬æåµä¸ï¼æç§è¿ä¸ªè¿ç¨æ¯æ²¡é®é¢çï¼ä½æ¯å¨ç½ç»é¢ç¹æå¨æ¶ï¼æå¡æä¾èä¸æ¥ç»æ³¨åä¸­å¿çå¿è·³å¯è½ä¼ä¸ä¼å¿å¤±è´¥ä¸ä¼å¿æåï¼è¿æ¶åæ³¨åä¸­å¿å°±ä¼é¢ç¹æ´æ°æå¡çå¯ç¨èç¹ä¿¡æ¯ï¼å¯¼è´æå¡æ¶è´¹èé¢ç¹ä»æ³¨åä¸­å¿æåææ°çæå¡å¯ç¨èç¹ä¿¡æ¯ï¼ä¸¥éæ¶å¯è½äº§çç½ç»é£æ´ï¼å¯¼è´æ³¨åä¸­å¿å¸¦å®½è¢«ææ»¡ã\n\nä¸ºäºåå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿ä¸­æåçæå¡å¯ç¨èç¹ä¿¡æ¯çæ°æ®éï¼è¿ä¸ªæ¶åå¯ä»¥éè¿å¢éæ´æ°çæ¹å¼ï¼æ³¨åä¸­å¿åªè¿åååçé£é¨åèç¹ä¿¡æ¯ï¼å°¤å¶å¨åªæå°æ°èç¹ä¿¡æ¯åæ´æ¶ï¼æ­¤ä¸¾å¯ä»¥å¤§å¤§åå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿æåçæ°æ®éï¼ä»èæå¤§ç¨åº¦é¿åäº§çç½ç»é£æ´ã\n\n\n# 7. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * rpc å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æå¡çæ§",frontmatter:{title:"æå¡çæ§",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æå¡æ²»ç"],tags:["åå¸å¼","æå¡æ²»ç","çæ§"],abbrlink:"a7bb904f",date:"2022-04-19T20:02:48.000Z",permalink:"/pages/4c0174/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/05.%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/02.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/02.æå¡çæ§.md",key:"v-03ef00cc",path:"/pages/4c0174/",headers:[{level:2,title:"çæ§å¯¹è±¡",slug:"çæ§å¯¹è±¡",normalizedTitle:"çæ§å¯¹è±¡",charIndex:133},{level:2,title:"çæ§ç»´åº¦",slug:"çæ§ç»´åº¦",normalizedTitle:"çæ§ç»´åº¦",charIndex:367},{level:2,title:"ç³»ç»çæ§åç",slug:"ç³»ç»çæ§åç",normalizedTitle:"ç³»ç»çæ§åç",charIndex:889},{level:3,title:"æ°æ®éé",slug:"æ°æ®éé",normalizedTitle:"æ°æ®éé",charIndex:935},{level:3,title:"æ°æ®ä¼ è¾",slug:"æ°æ®ä¼ è¾",normalizedTitle:"æ°æ®ä¼ è¾",charIndex:940},{level:3,title:"æ°æ®å¤ç",slug:"æ°æ®å¤ç",normalizedTitle:"æ°æ®å¤ç",charIndex:945},{level:3,title:"æ°æ®å±ç¤º",slug:"æ°æ®å±ç¤º",normalizedTitle:"æ°æ®å±ç¤º",charIndex:950},{level:2,title:"çæ§ææ¯",slug:"çæ§ææ¯",normalizedTitle:"çæ§ææ¯",charIndex:1797},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2117}],headersStr:"çæ§å¯¹è±¡ çæ§ç»´åº¦ ç³»ç»çæ§åç æ°æ®éé æ°æ®ä¼ è¾ æ°æ®å¤ç æ°æ®å±ç¤º çæ§ææ¯ åèèµæ",content:"# æå¡çæ§\n\nå½æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´å»ºç«äºéä¿¡ï¼ä½ä¸ºç®¡çèéè¦éè¿çæ§ææ®µæ¥è§å¯æå¡æ¯å¦æ­£å¸¸ï¼è°ç¨æ¯å¦æåãæå¡çæ§æ¯å¾å¤æçï¼å¨å¾®æå¡æ¶æä¸ï¼ä¸æ¬¡ç¨æ·è°ç¨ä¼å ä¸ºæå¡åæååï¼åæå¤ä¸ªä¸åæå¡ä¹é´çç¸äºè°ç¨ï¼è¿ä¹å°±éè¦å¯¹æååçæ¯ä¸ªæå¡é½çæ§èµ·æ¥ã\n\n\n# çæ§å¯¹è±¡\n\næå¡çæ§ä¸å®æ¯éè¿è§å¯æ°æ®æ¥éååæï¼æä»¥é¦åè¦æç¡®éè¦çæ§ä»ä¹ã\n\nä¸è¬æ¥è¯´ï¼æå¡çæ§æ°æ®æä»¥ä¸åç±»ï¼\n\n * ä¸å¡çæ§ï¼æ ¸å¿ææ ãç»å½ãç»åºãä¸åãæ¯ä»ç­ã\n * åºç¨çæ§ï¼æ¥å£çæ§ãè®¿é®æå¡ãSQLãåå­ä½¿ç¨çãååºæ¶é´ãTPSãQPS ç­ã\n * ç³»ç»çæ§ï¼CPU å©ç¨çãåå­ä½¿ç¨éãç½ç»å¸¦å®½ãIO å¸¦å®½ãç£çä½¿ç¨çç­ã\n * åºç¡çæ§ï¼ç½ç»æµéãä¸¢åæ°ãéåæ°ãè¿æ¥æ°ç­ã\n * å®¢æ·ç«¯çæ§ï¼æ§è½ãè¿åç ãå°åãè¿è¥åãçæ¬ãç³»ç»ç­ã\n\n\n# çæ§ç»´åº¦\n\nä¸è¬æ¥è¯´ï¼è¦ä»å¤ä¸ªç»´åº¦æ¥å¯¹ä¸å¡è¿è¡çæ§ï¼å·ä½æ¥è®²å¯ä»¥åæ¬ä¸é¢å ä¸ªç»´åº¦ï¼\n\n * å¨å±ç»´åº¦ãä»æ´ä½è§åº¦çæ§å¯¹è±¡ççè¯·æ±éãå¹³åèæ¶ä»¥åéè¯¯çï¼å¨å±ç»´åº¦ççæ§ä¸è¬æ¯ä¸ºäºè®©ä½ å¯¹çæ§å¯¹è±¡çè°ç¨æåµæä¸ªæ´ä½äºè§£ã\n * æºæ¿ç»´åº¦ãä¸è¬ä¸ºäºä¸å¡çé«å¯ç¨æ§ï¼æå¡éå¸¸é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ï¼å ä¸ºä¸åæºæ¿å°åçä¸åï¼åä¸ä¸ªçæ§å¯¹è±¡çåç§ææ å¯è½ä¼ç¸å·®å¾å¤§ï¼æä»¥éè¦æ·±å¥å°æºæ¿åé¨å»äºè§£ã\n * åæºç»´åº¦ãå³ä¾¿æ¯å¨åä¸ä¸ªæºæ¿åé¨ï¼å¯è½ç±äºéè´­å¹´ä»½åæ¹æ¬¡çä¸åï¼ä½äºä¸åæºå¨ä¸çåä¸ä¸ªçæ§å¯¹è±¡çåç§ææ ä¹ä¼æå¾å¤§å·®å¼ãä¸è¬æ¥è¯´ï¼æ°éè´­çæºå¨éå¸¸ç±äºææ¬æ´ä½ï¼éç½®ä¹æ´é«ï¼å¨åç­è¯·æ±éçæåµä¸ï¼å¯è½è¡¨ç°åºè¾å¤§çæ§è½å·®å¼ï¼å æ­¤ä¹éè¦ä»åæºç»´åº¦å»çæ§åä¸ä¸ªå¯¹è±¡ã\n * æ¶é´ç»´åº¦ãåä¸ä¸ªçæ§å¯¹è±¡ï¼å¨æ¯å¤©çåä¸æ¶å»åç§ææ éå¸¸ä¹ä¸ä¼ä¸æ ·ï¼è¿ç§å·®å¼è¦ä¹æ¯ç±ä¸å¡åæ´å¯¼è´ï¼è¦ä¹æ¯è¿è¥æ´»å¨å¯¼è´ãä¸ºäºäºè§£çæ§å¯¹è±¡åç§ææ çååï¼éå¸¸éè¦ä¸ä¸å¤©åãä¸å¨åãä¸ä¸ªæåï¼çè³ä¸ä¸ªæååæ¯è¾ã\n * æ ¸å¿ç»´åº¦ãä¸å¡ä¸ä¸è¬ä¼ä¾æ®éè¦æ§ç¨åº¦å¯¹çæ§å¯¹è±¡è¿è¡åçº§ï¼æç®åçæ¯åææ ¸å¿ä¸å¡åéæ ¸å¿ä¸å¡ãæ ¸å¿ä¸å¡åéæ ¸å¿ä¸å¡å¨é¨ç½²ä¸å¿é¡»éç¦»ï¼åå¼çæ§ï¼è¿æ ·æè½å¯¹æ ¸å¿ä¸å¡åéç¹ä¿éã\n\n\n# ç³»ç»çæ§åç\n\nä¸æ¦æç¡®äºè¦çæ§çå¯¹è±¡ï¼æ¥ä¸å°±æ¯èèå¦ä½çæ§ã\n\nçæ§ç³»ç»ä¸»è¦åæ¬åä¸ªç¯èï¼æ°æ®ééãæ°æ®ä¼ è¾ãæ°æ®å¤çåæ°æ®å±ç¤º\n\n\n# æ°æ®éé\n\néå¸¸æä¸¤ç§æ°æ®æ¶éæ¹å¼ï¼\n\n * æå¡ä¸»å¨ä¸æ¥ï¼è¿ç§å¤çæ¹å¼éè¿å¨ä¸å¡ä»£ç æèæå¡æ¡æ¶éå å¥æ°æ®æ¶éä»£ç é»è¾ï¼å¨æ¯ä¸æ¬¡æå¡è°ç¨å®æåï¼ä¸»å¨ä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãè¿ç§æ¹å¼å¨é¾è·¯è·è¸ªä¸­è¾ä¸ºå¸¸è§ï¼ä¸»æµçææ¯æ¹æ¡æï¼Zipkinã\n * ä»£çæ¶éï¼è¿ç§å¤çæ¹å¼éè¿æå¡è°ç¨åæè°ç¨çè¯¦ç»ä¿¡æ¯è®°å½å°æ¬å°æ¥å¿æä»¶ä¸­ï¼ç¶ååéè¿ä»£çå»è§£ææ¬å°æ¥å¿æä»¶ï¼ç¶ååä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãä¸»æµçææ¯æ¹æ¡æï¼ELKãFlumeã\n\n\n# æ°æ®ä¼ è¾\n\næ°æ®ä¼ è¾æå¸¸ç¨çæ¹å¼æä¸¤ç§ï¼\n\n * UDP ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®å¤çååæä¾æå¡å¨çè¯·æ±å°åï¼æ°æ®ééåéè¿ UDP åè®®ä¸æå¡å¨å»ºç«è¿æ¥ï¼ç¶åææ°æ®åéè¿å»ã\n * Kafka ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®ééååéå°æå®ç Topicï¼ç¶åæ°æ®å¤çåååè®¢éå¯¹åºç Topicï¼å°±å¯ä»¥ä» Kafka æ¶æ¯éåä¸­è¯»åå°å¯¹åºçæ°æ®ãç±äº Kafka æéå¸¸é«çååè½åï¼æä»¥å¾éåä½ä¸ºå¤§æ°æ®éçç¼å²æ± ã\n\n\n# æ°æ®å¤ç\n\næ°æ®å¤çæ¯å¯¹æ¶éæ¥çåå§æ°æ®è¿è¡èåå¹¶å­å¨ãæ°æ®èåéå¸¸æä¸¤ä¸ªç»´åº¦ï¼\n\n * æ¥å£ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§æ¥å£åç»´åº¦å®æ¶èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥å¾å°æ¯ä¸ªæ¥å£çæ¯ç§è¯·æ±éãå¹³åèæ¶ãæåçç­ä¿¡æ¯ã\n * æºå¨ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§è°ç¨çèç¹ç»´åº¦èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥ä»åæºç»´åº¦å»æ¥çæ¯ä¸ªæ¥å£çå®æ¶è¯·æ±éãå¹³åèæ¶ç­ä¿¡æ¯ã\n\nèååçæ°æ®éè¦æä¹åå°æ°æ®åºä¸­å­å¨ï¼æéç¨çæ°æ®åºä¸è¬åä¸ºä¸¤ç§ï¼\n\n * å¨ææ£ç´¢æ°æ®åºï¼æ¯å¦ Elasticsearchï¼ä»¥åæç´¢å¼çæ°æ®ç»æå­å¨ï¼éè¦æ¥è¯¢çæ¶åï¼æ ¹æ®ç´¢å¼æ¥æ¥è¯¢ã\n * æ¶åºæ°æ®åºï¼æ¯å¦ OpenTSDBï¼ä»¥æ¶åºåºåæ°æ®çæ¹å¼å­å¨ï¼æ¥è¯¢çæ¶åæç§æ¶åºå¦ 1minã5min ç­ç»´åº¦æ¥æ¥è¯¢ã\n\n\n# æ°æ®å±ç¤º\n\næ°æ®å±ç¤ºæ¯æå¤çåçæ°æ®ä»¥ Dashboard çæ¹å¼å±ç¤ºç»ç¨æ·ãæ°æ®å±ç¤ºæå¤ç§æ¹å¼ï¼æ¯å¦æ²çº¿å¾ãé¥¼ç¶å¾ãæ ¼å­å¾å±ç¤ºç­ã\n\n\n# çæ§ææ¯\n\n * ELK çææ¯æ æ¯è¾æçï¼åºç¨èå´ä¹æ¯è¾å¹¿ï¼é¤äºå¯ç¨ä½çæ§ç³»ç»å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿æ¥è¯¢ååæã\n * Graphite æ¯åºäºæ¶é´åºåæ°æ®åºå­å¨ççæ§ç³»ç»ï¼å¹¶ä¸æä¾äºåè½å¼ºå¤§çåç§èåå½æ°æ¯å¦ sumãaverageãtop5 ç­å¯ç¨äºçæ§åæï¼èä¸å¯¹å¤æä¾äº API ä¹å¯ä»¥æ¥å¥å¶ä»å¾å½¢åçæ§ç³»ç»å¦ Grafanaã\n * TICK çæ ¸å¿å¨äºå¶æ¶é´åºåæ°æ®åº InfluxDB çå­å¨åè½å¼ºå¤§ï¼ä¸æ¯æç±»ä¼¼ SQL è¯­è¨çå¤ææ°æ®å¤çæä½ã\n * Prometheus çç¬ç¹ä¹å¤å¨äºå®éç¨äºææ°æ®çæ¹å¼ï¼å¯¹ä¸å¡å½±åè¾å°ï¼åæ¶ä¹éç¨äºæ¶é´åºåæ°æ®åºå­å¨ï¼èä¸æ¯æç¬æç PromQL æ¥è¯¢è¯­è¨ï¼åè½å¼ºå¤§èä¸ç®æ´ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * RPC å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²",normalizedContent:"# æå¡çæ§\n\nå½æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´å»ºç«äºéä¿¡ï¼ä½ä¸ºç®¡çèéè¦éè¿çæ§ææ®µæ¥è§å¯æå¡æ¯å¦æ­£å¸¸ï¼è°ç¨æ¯å¦æåãæå¡çæ§æ¯å¾å¤æçï¼å¨å¾®æå¡æ¶æä¸ï¼ä¸æ¬¡ç¨æ·è°ç¨ä¼å ä¸ºæå¡åæååï¼åæå¤ä¸ªä¸åæå¡ä¹é´çç¸äºè°ç¨ï¼è¿ä¹å°±éè¦å¯¹æååçæ¯ä¸ªæå¡é½çæ§èµ·æ¥ã\n\n\n# çæ§å¯¹è±¡\n\næå¡çæ§ä¸å®æ¯éè¿è§å¯æ°æ®æ¥éååæï¼æä»¥é¦åè¦æç¡®éè¦çæ§ä»ä¹ã\n\nä¸è¬æ¥è¯´ï¼æå¡çæ§æ°æ®æä»¥ä¸åç±»ï¼\n\n * ä¸å¡çæ§ï¼æ ¸å¿ææ ãç»å½ãç»åºãä¸åãæ¯ä»ç­ã\n * åºç¨çæ§ï¼æ¥å£çæ§ãè®¿é®æå¡ãsqlãåå­ä½¿ç¨çãååºæ¶é´ãtpsãqps ç­ã\n * ç³»ç»çæ§ï¼cpu å©ç¨çãåå­ä½¿ç¨éãç½ç»å¸¦å®½ãio å¸¦å®½ãç£çä½¿ç¨çç­ã\n * åºç¡çæ§ï¼ç½ç»æµéãä¸¢åæ°ãéåæ°ãè¿æ¥æ°ç­ã\n * å®¢æ·ç«¯çæ§ï¼æ§è½ãè¿åç ãå°åãè¿è¥åãçæ¬ãç³»ç»ç­ã\n\n\n# çæ§ç»´åº¦\n\nä¸è¬æ¥è¯´ï¼è¦ä»å¤ä¸ªç»´åº¦æ¥å¯¹ä¸å¡è¿è¡çæ§ï¼å·ä½æ¥è®²å¯ä»¥åæ¬ä¸é¢å ä¸ªç»´åº¦ï¼\n\n * å¨å±ç»´åº¦ãä»æ´ä½è§åº¦çæ§å¯¹è±¡ççè¯·æ±éãå¹³åèæ¶ä»¥åéè¯¯çï¼å¨å±ç»´åº¦ççæ§ä¸è¬æ¯ä¸ºäºè®©ä½ å¯¹çæ§å¯¹è±¡çè°ç¨æåµæä¸ªæ´ä½äºè§£ã\n * æºæ¿ç»´åº¦ãä¸è¬ä¸ºäºä¸å¡çé«å¯ç¨æ§ï¼æå¡éå¸¸é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ï¼å ä¸ºä¸åæºæ¿å°åçä¸åï¼åä¸ä¸ªçæ§å¯¹è±¡çåç§ææ å¯è½ä¼ç¸å·®å¾å¤§ï¼æä»¥éè¦æ·±å¥å°æºæ¿åé¨å»äºè§£ã\n * åæºç»´åº¦ãå³ä¾¿æ¯å¨åä¸ä¸ªæºæ¿åé¨ï¼å¯è½ç±äºéè´­å¹´ä»½åæ¹æ¬¡çä¸åï¼ä½äºä¸åæºå¨ä¸çåä¸ä¸ªçæ§å¯¹è±¡çåç§ææ ä¹ä¼æå¾å¤§å·®å¼ãä¸è¬æ¥è¯´ï¼æ°éè´­çæºå¨éå¸¸ç±äºææ¬æ´ä½ï¼éç½®ä¹æ´é«ï¼å¨åç­è¯·æ±éçæåµä¸ï¼å¯è½è¡¨ç°åºè¾å¤§çæ§è½å·®å¼ï¼å æ­¤ä¹éè¦ä»åæºç»´åº¦å»çæ§åä¸ä¸ªå¯¹è±¡ã\n * æ¶é´ç»´åº¦ãåä¸ä¸ªçæ§å¯¹è±¡ï¼å¨æ¯å¤©çåä¸æ¶å»åç§ææ éå¸¸ä¹ä¸ä¼ä¸æ ·ï¼è¿ç§å·®å¼è¦ä¹æ¯ç±ä¸å¡åæ´å¯¼è´ï¼è¦ä¹æ¯è¿è¥æ´»å¨å¯¼è´ãä¸ºäºäºè§£çæ§å¯¹è±¡åç§ææ çååï¼éå¸¸éè¦ä¸ä¸å¤©åãä¸å¨åãä¸ä¸ªæåï¼çè³ä¸ä¸ªæååæ¯è¾ã\n * æ ¸å¿ç»´åº¦ãä¸å¡ä¸ä¸è¬ä¼ä¾æ®éè¦æ§ç¨åº¦å¯¹çæ§å¯¹è±¡è¿è¡åçº§ï¼æç®åçæ¯åææ ¸å¿ä¸å¡åéæ ¸å¿ä¸å¡ãæ ¸å¿ä¸å¡åéæ ¸å¿ä¸å¡å¨é¨ç½²ä¸å¿é¡»éç¦»ï¼åå¼çæ§ï¼è¿æ ·æè½å¯¹æ ¸å¿ä¸å¡åéç¹ä¿éã\n\n\n# ç³»ç»çæ§åç\n\nä¸æ¦æç¡®äºè¦çæ§çå¯¹è±¡ï¼æ¥ä¸å°±æ¯èèå¦ä½çæ§ã\n\nçæ§ç³»ç»ä¸»è¦åæ¬åä¸ªç¯èï¼æ°æ®ééãæ°æ®ä¼ è¾ãæ°æ®å¤çåæ°æ®å±ç¤º\n\n\n# æ°æ®éé\n\néå¸¸æä¸¤ç§æ°æ®æ¶éæ¹å¼ï¼\n\n * æå¡ä¸»å¨ä¸æ¥ï¼è¿ç§å¤çæ¹å¼éè¿å¨ä¸å¡ä»£ç æèæå¡æ¡æ¶éå å¥æ°æ®æ¶éä»£ç é»è¾ï¼å¨æ¯ä¸æ¬¡æå¡è°ç¨å®æåï¼ä¸»å¨ä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãè¿ç§æ¹å¼å¨é¾è·¯è·è¸ªä¸­è¾ä¸ºå¸¸è§ï¼ä¸»æµçææ¯æ¹æ¡æï¼zipkinã\n * ä»£çæ¶éï¼è¿ç§å¤çæ¹å¼éè¿æå¡è°ç¨åæè°ç¨çè¯¦ç»ä¿¡æ¯è®°å½å°æ¬å°æ¥å¿æä»¶ä¸­ï¼ç¶ååéè¿ä»£çå»è§£ææ¬å°æ¥å¿æä»¶ï¼ç¶ååä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãä¸»æµçææ¯æ¹æ¡æï¼elkãflumeã\n\n\n# æ°æ®ä¼ è¾\n\næ°æ®ä¼ è¾æå¸¸ç¨çæ¹å¼æä¸¤ç§ï¼\n\n * udp ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®å¤çååæä¾æå¡å¨çè¯·æ±å°åï¼æ°æ®ééåéè¿ udp åè®®ä¸æå¡å¨å»ºç«è¿æ¥ï¼ç¶åææ°æ®åéè¿å»ã\n * kafka ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®ééååéå°æå®ç topicï¼ç¶åæ°æ®å¤çåååè®¢éå¯¹åºç topicï¼å°±å¯ä»¥ä» kafka æ¶æ¯éåä¸­è¯»åå°å¯¹åºçæ°æ®ãç±äº kafka æéå¸¸é«çååè½åï¼æä»¥å¾éåä½ä¸ºå¤§æ°æ®éçç¼å²æ± ã\n\n\n# æ°æ®å¤ç\n\næ°æ®å¤çæ¯å¯¹æ¶éæ¥çåå§æ°æ®è¿è¡èåå¹¶å­å¨ãæ°æ®èåéå¸¸æä¸¤ä¸ªç»´åº¦ï¼\n\n * æ¥å£ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§æ¥å£åç»´åº¦å®æ¶èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥å¾å°æ¯ä¸ªæ¥å£çæ¯ç§è¯·æ±éãå¹³åèæ¶ãæåçç­ä¿¡æ¯ã\n * æºå¨ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§è°ç¨çèç¹ç»´åº¦èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥ä»åæºç»´åº¦å»æ¥çæ¯ä¸ªæ¥å£çå®æ¶è¯·æ±éãå¹³åèæ¶ç­ä¿¡æ¯ã\n\nèååçæ°æ®éè¦æä¹åå°æ°æ®åºä¸­å­å¨ï¼æéç¨çæ°æ®åºä¸è¬åä¸ºä¸¤ç§ï¼\n\n * å¨ææ£ç´¢æ°æ®åºï¼æ¯å¦ elasticsearchï¼ä»¥åæç´¢å¼çæ°æ®ç»æå­å¨ï¼éè¦æ¥è¯¢çæ¶åï¼æ ¹æ®ç´¢å¼æ¥æ¥è¯¢ã\n * æ¶åºæ°æ®åºï¼æ¯å¦ opentsdbï¼ä»¥æ¶åºåºåæ°æ®çæ¹å¼å­å¨ï¼æ¥è¯¢çæ¶åæç§æ¶åºå¦ 1minã5min ç­ç»´åº¦æ¥æ¥è¯¢ã\n\n\n# æ°æ®å±ç¤º\n\næ°æ®å±ç¤ºæ¯æå¤çåçæ°æ®ä»¥ dashboard çæ¹å¼å±ç¤ºç»ç¨æ·ãæ°æ®å±ç¤ºæå¤ç§æ¹å¼ï¼æ¯å¦æ²çº¿å¾ãé¥¼ç¶å¾ãæ ¼å­å¾å±ç¤ºç­ã\n\n\n# çæ§ææ¯\n\n * elk çææ¯æ æ¯è¾æçï¼åºç¨èå´ä¹æ¯è¾å¹¿ï¼é¤äºå¯ç¨ä½çæ§ç³»ç»å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿æ¥è¯¢ååæã\n * graphite æ¯åºäºæ¶é´åºåæ°æ®åºå­å¨ççæ§ç³»ç»ï¼å¹¶ä¸æä¾äºåè½å¼ºå¤§çåç§èåå½æ°æ¯å¦ sumãaverageãtop5 ç­å¯ç¨äºçæ§åæï¼èä¸å¯¹å¤æä¾äº api ä¹å¯ä»¥æ¥å¥å¶ä»å¾å½¢åçæ§ç³»ç»å¦ grafanaã\n * tick çæ ¸å¿å¨äºå¶æ¶é´åºåæ°æ®åº influxdb çå­å¨åè½å¼ºå¤§ï¼ä¸æ¯æç±»ä¼¼ sql è¯­è¨çå¤ææ°æ®å¤çæä½ã\n * prometheus çç¬ç¹ä¹å¤å¨äºå®éç¨äºææ°æ®çæ¹å¼ï¼å¯¹ä¸å¡å½±åè¾å°ï¼åæ¶ä¹éç¨äºæ¶é´åºåæ°æ®åºå­å¨ï¼èä¸æ¯æç¬æç promql æ¥è¯¢è¯­è¨ï¼åè½å¼ºå¤§èä¸ç®æ´ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * rpc å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æå¡é¾è·¯çæ§",frontmatter:{title:"æå¡é¾è·¯çæ§",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æå¡æ²»ç"],tags:["åå¸å¼","æå¡æ²»ç","çæ§","APM","é¾è·¯è¿½è¸ª"],abbrlink:"ec339fb7",date:"2022-04-20T09:08:29.000Z",permalink:"/pages/f918df/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/05.%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/03.%E6%9C%8D%E5%8A%A1%E9%93%BE%E8%B7%AF%E7%9B%91%E6%8E%A7.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/03.æå¡é¾è·¯çæ§.md",key:"v-7f83aac5",path:"/pages/f918df/",headers:[{level:2,title:"ä»ä¹æ¯æå¡è¿½è¸ª",slug:"ä»ä¹æ¯æå¡è¿½è¸ª",normalizedTitle:"ä»ä¹æ¯æå¡è¿½è¸ª",charIndex:11},{level:2,title:"ä¸ºä»ä¹éè¦æå¡è¿½è¸ª",slug:"ä¸ºä»ä¹éè¦æå¡è¿½è¸ª",normalizedTitle:"ä¸ºä»ä¹éè¦æå¡è¿½è¸ª",charIndex:256},{level:2,title:"æå¡é¾è·¯çæ§çåç",slug:"æå¡é¾è·¯çæ§çåç",normalizedTitle:"æå¡é¾è·¯çæ§çåç",charIndex:1035},{level:2,title:"æå¡è¿½è¸ªç³»ç»å®ç°",slug:"æå¡è¿½è¸ªç³»ç»å®ç°",normalizedTitle:"æå¡è¿½è¸ªç³»ç»å®ç°",charIndex:1958},{level:3,title:"æ°æ®ééå±",slug:"æ°æ®ééå±",normalizedTitle:"æ°æ®ééå±",charIndex:1988},{level:3,title:"æ°æ®å¤çå±",slug:"æ°æ®å¤çå±",normalizedTitle:"æ°æ®å¤çå±",charIndex:2008},{level:3,title:"æ°æ®å±ç¤ºå±",slug:"æ°æ®å±ç¤ºå±",normalizedTitle:"æ°æ®å±ç¤ºå±",charIndex:2029},{level:4,title:"è°ç¨é¾è·¯å¾",slug:"è°ç¨é¾è·¯å¾",normalizedTitle:"è°ç¨é¾è·¯å¾",charIndex:3013},{level:4,title:"è°ç¨ææå¾",slug:"è°ç¨ææå¾",normalizedTitle:"è°ç¨ææå¾",charIndex:785},{level:2,title:"æå¡è¿½è¸ªææ¯éå",slug:"æå¡è¿½è¸ªææ¯éå",normalizedTitle:"æå¡è¿½è¸ªææ¯éå",charIndex:3384},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:3730}],headersStr:"ä»ä¹æ¯æå¡è¿½è¸ª ä¸ºä»ä¹éè¦æå¡è¿½è¸ª æå¡é¾è·¯çæ§çåç æå¡è¿½è¸ªç³»ç»å®ç° æ°æ®ééå± æ°æ®å¤çå± æ°æ®å±ç¤ºå± è°ç¨é¾è·¯å¾ è°ç¨ææå¾ æå¡è¿½è¸ªææ¯éå åèèµæ",content:"# æå¡è¿½è¸ª\n\n\n# ä»ä¹æ¯æå¡è¿½è¸ª\n\nå¨å¾®æå¡æ¶æä¸ï¼ç±äºè¿è¡äºæå¡æåï¼ä¸æ¬¡è¯·æ±å¾å¾éè¦æ¶åå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡å¯è½æ¯ç±ä¸åçå¢éå¼åï¼ä½¿ç¨äºä¸åçç¼ç¨è¯­è¨ï¼è¿æå¯è½é¨ç½²å¨ä¸åçæºå¨ä¸ï¼åå¸å¨ä¸åçæ°æ®ä¸­å¿ãå¦æè¯·æ±å¤±è´¥äºï¼è¦æ³æ¥æ¸æ¥å°åºæ¯åªä¸ªåºç¨å¯¼è´ï¼ä¼æ¯éå¸¸å¤æçä¸ä»¶äºæã\n\nå¦ææä¸ä¸ªç³»ç»ï¼å¯ä»¥è·è¸ªè®°å½ä¸æ¬¡ç¨æ·è¯·æ±é½åèµ·äºåªäºè°ç¨ï¼ç»è¿åªäºæå¡å¤çï¼å¹¶ä¸è®°å½æ¯ä¸æ¬¡è°ç¨ææ¶åçæå¡çè¯¦ç»ä¿¡æ¯ï¼è¿æ¶åå¦æåçè°ç¨å¤±è´¥ï¼ä½ å°±å¯ä»¥éè¿è¿ä¸ªæ¥å¿å¿«éå®ä½æ¯å¨åªä¸ªç¯èåºäºé®é¢ï¼è¿ä¸ªç³»ç»å°±æ¯æå¡é¾è·¯çæ§ã\n\n\n# ä¸ºä»ä¹éè¦æå¡è¿½è¸ª\n\n * ä¼åç³»ç»ç¶é¢ï¼éè¿è®°å½è°ç¨ç»è¿çæ¯ä¸æ¡é¾è·¯ä¸çèæ¶ï¼æä»¬è½å¿«éå®ä½æ´ä¸ªç³»ç»çç¶é¢ç¹å¨åªéãæ¯å¦ä½ è®¿é®å¾®åé¦é¡µåç°å¾æ¢ï¼è¯å®æ¯ç±äºæç§åå é æçï¼æå¯è½æ¯è¿è¥åç½ç»å»¶è¿ï¼æå¯è½æ¯ç½å³ç³»ç»å¼å¸¸ï¼æå¯è½æ¯æä¸ªæå¡å¼å¸¸ï¼è¿æå¯è½æ¯ç¼å­æèæ°æ®åºå¼å¸¸ãéè¿æå¡è¿½è¸ªï¼å¯ä»¥ä»å¨å±è§è§ä¸å»è§å¯ï¼æ¾åºæ´ä¸ªç³»ç»çç¶é¢ç¹æå¨ï¼ç¶åååºéå¯¹æ§çä¼åã\n * ä¼åé¾è·¯è°ç¨ï¼éè¿æå¡è¿½è¸ªå¯ä»¥åæè°ç¨æç»è¿çè·¯å¾ï¼ç¶åè¯ä¼°æ¯å¦åçãæ¯å¦ä¸ä¸ªæå¡è°ç¨ä¸æ¸¸ä¾èµäºå¤ä¸ªæå¡ï¼éè¿è°ç¨é¾åæï¼å¯ä»¥è¯ä¼°æ¯å¦æ¯ä¸ªä¾èµé½æ¯å¿è¦çï¼æ¯å¦å¯ä»¥éè¿ä¸å¡ä¼åæ¥åå°æå¡ä¾èµãè¿æå°±æ¯ï¼ä¸è¬ä¸å¡é½ä¼å¨å¤ä¸ªæ°æ®ä¸­å¿é½é¨ç½²æå¡ï¼ä»¥å®ç°å¼å°å®¹ç¾ï¼è¿ä¸ªæ¶åç»å¸¸ä¼åºç°ä¸ç§ç¶åµå°±æ¯æå¡ A è°ç¨äºå¦å¤ä¸ä¸ªæ°æ®ä¸­å¿çæå¡ Bï¼èæ²¡æè°ç¨åå¤äºä¸ä¸ªæ°æ®ä¸­å¿çæå¡ Bãæ ¹æ®æçç»éªï¼è·¨æ°æ®ä¸­å¿çè°ç¨è§è·ç¦»è¿è¿é½ä¼æä¸å®çç½ç»å»¶è¿ï¼ååäº¬åå¹¿å·è¿ç§å åå¬éè·ç¦»çç½ç»å»¶è¿å¯è½è¾¾å° 30ms ä»¥ä¸ï¼è¿å¯¹äºæäºä¸å¡å ä¹æ¯ä¸å¯æ¥åçãéè¿å¯¹è°ç¨é¾è·¯è¿è¡åæï¼å¯ä»¥æ¾åºè·¨æ°æ®ä¸­å¿çæå¡è°ç¨ï¼ä»èè¿è¡ä¼åï¼å°½éè§é¿è¿ç§æåµåºç°ã\n * çæç½ç»ææï¼éè¿æå¡è¿½è¸ªç³»ç»ä¸­è®°å½çé¾è·¯ä¿¡æ¯ï¼å¯ä»¥çæä¸å¼ ç³»ç»çç½ç»è°ç¨ææå¾ï¼å®å¯ä»¥åæ ç³»ç»é½ä¾èµäºåªäºæå¡ï¼ä»¥åæå¡ä¹é´çè°ç¨å³ç³»æ¯ä»ä¹æ ·çï¼å¯ä»¥ä¸ç®äºç¶ãé¤æ­¤ä¹å¤ï¼å¨ç½ç»ææå¾ä¸è¿å¯ä»¥ææå¡è°ç¨çè¯¦ç»ä¿¡æ¯ä¹æ åºæ¥ï¼ä¹è½èµ·å°æå¡çæ§çä½ç¨ã\n * éæä¼ è¾æ°æ®ï¼é¤äºæå¡è¿½è¸ªï¼ä¸å¡ä¸ç»å¸¸æä¸ç§éæ±ï¼ææè½æä¸äºç¨æ·æ°æ®ï¼ä»è°ç¨çå¼å§ä¸ç´å¾ä¸ä¼ éï¼ä»¥ä¾¿ç³»ç»ä¸­çåä¸ªæå¡é½è½è·åå°è¿ä¸ªä¿¡æ¯ãæ¯å¦ä¸å¡æ³åä¸äº A/B æµè¯ï¼è¿æ¶åå°±æ³éè¿æå¡è¿½è¸ªç³»ç»ï¼æ A/B æµè¯çå¼å³é»è¾ä¸ç´å¾ä¸ä¼ éï¼ç»è¿çæ¯ä¸å±æå¡é½è½è·åå°è¿ä¸ªå¼å³å¼ï¼å°±è½å¤ç»ä¸è¿è¡ A/B æµè¯ã\n\n\n# æå¡é¾è·¯çæ§çåç\n\nGoogle åå¸çä¸ç¯çè®ºæ Dapper, a Large-Scale Distributed Systems Tracing Infrastructureï¼éé¢è¯¦ç»è®²è§£äºæå¡è¿½è¸ªç³»ç»çå®ç°åçãå®çæ ¸å¿çå¿µå°±æ¯è°ç¨é¾ï¼éè¿ä¸ä¸ªå¨å±å¯ä¸ç ID å°åå¸å¨åä¸ªæå¡èç¹ä¸çåä¸æ¬¡è¯·æ±ä¸²èèµ·æ¥ï¼ä»èè¿ååæçè°ç¨å³ç³»ï¼å¯ä»¥è¿½è¸ªç³»ç»é®é¢ãåæè°ç¨æ°æ®å¹¶ç»è®¡åç§ç³»ç»ææ ã\n\nå¯ä»¥è¯´åé¢çè¯çåç§æå¡è¿½è¸ªç³»ç»é½æ¯åºäº Dapper è¡çåºæ¥çï¼æ¯è¾æåçæ Twitter çZipkinãé¿éçé¹°ç¼ãç¾å¢çMTraceç­ã\n\nè¦çè§£æå¡è¿½è¸ªçåçï¼é¦åå¿é¡»ææä¸äºåºæ¬æ¦å¿µï¼traceIdãspanIdãannonation ç­ãDapper è¿ç¯è®ºæè®²å¾æ¯è¾æ¸æ¥ï¼ä½å¯¹åå­¦èæ¥è¯´çè§£èµ·æ¥å¯è½æç¹å°é¾ï¼ç¾å¢ç MTrace çåçä»ç»çè§£èµ·æ¥ç¸å¯¹å®¹æä¸äºï¼ä¸é¢æå°±ä»¥ MTrace ä¸ºä¾ï¼ç»ä½ è¯¦ç»è®²è¿°æå¡è¿½è¸ªç³»ç»çå®ç°åçãè½ç¶åçæäºæ¦æ¶©ï¼ä½å´æ¯ä½ å¿é¡»ææ¡çï¼åªæçè§£äºæå¡è¿½è¸ªçåºæ¬æ¦å¿µï¼æè½æ´å¥½å°å°å¶å®ç°åºæ¥ã\n\n\n\n * Traceï¼ç¨äºè¡¨ç¤ºæä¸æ¬¡å·ä½çè¯·æ±ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼ä¼å¨ RPC è°ç¨ç½ç»çç¬¬ä¸å±çæä¸ä¸ªå¨å±å¯ä¸ç Trace IDï¼å¹¶ä¸ä¼éçæ¯ä¸å±ç RPC è°ç¨ï¼ä¸æ­å¾åä¼ éï¼è¿æ ·çè¯éè¿ Trace ID å°±å¯ä»¥æä¸æ¬¡ç¨æ·è¯·æ±å¨ç³»ç»ä¸­è°ç¨çè·¯å¾ä¸²èèµ·æ¥ã\n * Spanï¼å·¥ä½çåºæ¬åä½ãSpan ç¨äºæ è¯ä¸æ¬¡ RPC è°ç¨å¨åå¸å¼è¯·æ±ä¸­çä½ç½®ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼å¤å¨ RPC è°ç¨ç½ç»çç¬¬ä¸å± A æ¶ Span ID åå§å¼æ¯ 0ï¼è¿å¥ä¸ä¸å± RPC è°ç¨ B çæ¶å Span ID æ¯ 0.1ï¼ç»§ç»­è¿å¥ä¸ä¸å± RPC è°ç¨ C æ¶ Span ID æ¯ 0.1.1ï¼èä¸ B å¤å¨åä¸å±ç RPC è°ç¨ E ç Span ID æ¯ 0.2ï¼è¿æ ·çè¯éè¿ Span ID å°±å¯ä»¥å®ä½æä¸æ¬¡ RPC è¯·æ±å¨ç³»ç»è°ç¨ä¸­æå¤çä½ç½®ï¼ä»¥åå®çä¸ä¸æ¸¸ä¾èµåå«æ¯è°ã\n * Annotationï¼ç¨äºä¸å¡èªå®ä¹åç¹æ°æ®ï¼å¯ä»¥æ¯ä¸å¡æå´è¶£çæ³ä¸ä¼ å°åç«¯çæ°æ®ï¼æ¯å¦ä¸æ¬¡è¯·æ±çç¨æ· UIDã\n\n\n# æå¡è¿½è¸ªç³»ç»å®ç°\n\nä¸ä¸ªæå¡è¿½è¸ªç³»ç»å¯ä»¥åä¸ºä¸å±ï¼\n\n * æ°æ®ééå±ï¼è´è´£æ°æ®åç¹å¹¶ä¸æ¥ã\n * æ°æ®å¤çå±ï¼è´è´£æ°æ®çå­å¨ä¸è®¡ç®ã\n * æ°æ®å±ç¤ºå±ï¼è´è´£æ°æ®çå¾å½¢åå±ç¤ºã\n\n\n# æ°æ®ééå±\n\næ°æ®ééå±çä½ç¨å°±æ¯å¨ç³»ç»çåä¸ªä¸åæ¨¡åä¸­è¿è¡åç¹ï¼ééæ°æ®å¹¶ä¸æ¥ç»æ°æ®å¤çå±è¿è¡å¤çã\n\né£ä¹è¯¥å¦ä½è¿è¡æ°æ®åç¹å¢ï¼\n\nä¸æ¬¡ RPC è¯·æ±å¯ä»¥åä¸ºåä¸ªé¶æ®µã\n\n * **CSï¼Client Sendï¼**é¶æ®µ : å®¢æ·ç«¯åèµ·è¯·æ±ï¼å¹¶çæè°ç¨çä¸ä¸æã\n * **SRï¼Server Recieveï¼**é¶æ®µ : æå¡ç«¯æ¥æ¶è¯·æ±ï¼å¹¶çæä¸ä¸æã\n * **SSï¼Server Sendï¼**é¶æ®µ : æå¡ç«¯è¿åè¯·æ±ï¼è¿ä¸ªé¶æ®µä¼å°æå¡ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸é¢è¿å¼ å¾å¯ä»¥è¯´æä¸æ¥çæ°æ®æï¼traceId=123456ï¼spanId=0.1ï¼appKey=Bï¼method=B.methodï¼start=103ï¼duration=38ã\n * **CRï¼Client Recieveï¼**é¶æ®µ : å®¢æ·ç«¯æ¥æ¶è¿åç»æï¼è¿ä¸ªé¶æ®µä¼å°å®¢æ·ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanId=0.1ï¼appKey=Aï¼method=B.methodï¼start=103ï¼duration=38ã\n\n\n# æ°æ®å¤çå±\n\næ°æ®å¤çå±çä½ç¨å°±æ¯ææ°æ®ééå±ä¸æ¥çæ°æ®æéè®¡ç®ï¼ç¶åè½å°å­å¨ä¾æ¥è¯¢ä½¿ç¨ã\n\næ°æ®å¤ççéæ±ä¸è¬åä¸ºä¸¤ç±»ï¼ä¸ç±»æ¯å®æ¶è®¡ç®éæ±ï¼ä¸ç±»æ¯ç¦»çº¿è®¡ç®éæ±ã\n\nå®æ¶è®¡ç®éæ±å¯¹è®¡ç®æçè¦æ±æ¯è¾é«ï¼ä¸è¬è¦æ±å¯¹æ¶éçé¾è·¯æ°æ®è½å¤å¨ç§çº§å«å®æèåè®¡ç®ï¼ä»¥ä¾å®æ¶æ¥è¯¢ãèç¦»çº¿è®¡ç®éæ±å¯¹è®¡ç®æçè¦æ±å°±æ²¡é£ä¹é«äºï¼ä¸è¬è½å¨å°æ¶çº§å«å®æé¾è·¯æ°æ®çèåè®¡ç®å³å¯ï¼ä¸è¬ç¨ä½æ°æ®æ±æ»ç»è®¡ãéå¯¹è¿ä¸¤ç±»ä¸åçæ°æ®å¤çéæ±ï¼éç¨çè®¡ç®æ¹æ³åå­å¨ä¹ä¸ç¸åã\n\n * å®æ¶æ°æ®å¤çï¼éå¯¹å®æ¶æ°æ®å¤çï¼ä¸è¬éç¨ FlinkãStormãSpark Streaming æ¥å¯¹é¾è·¯æ°æ®è¿è¡å®æ¶èåå å·¥ï¼å­å¨ä¸è¬ä½¿ç¨ OLTP æ°æ®ä»åºï¼æ¯å¦ HBaseï¼ä½¿ç¨ traceId ä½ä¸º RowKeyï¼è½å¤©ç¶å°æä¸æ´æ¡è°ç¨é¾èåå¨ä¸èµ·ï¼æé«æ¥è¯¢æçã\n\n * ç¦»çº¿æ°æ®å¤çï¼éå¯¹ç¦»çº¿æ°æ®å¤çï¼ä¸è¬éè¿è¿è¡ MapReduce æè Spark æ¹å¤çç¨åºæ¥å¯¹é¾è·¯æ°æ®è¿è¡ç¦»çº¿è®¡ç®ï¼å­å¨ä¸è¬ä½¿ç¨ Hiveã\n\n\n# æ°æ®å±ç¤ºå±\n\næ°æ®å±ç¤ºå±çä½ç¨å°±æ¯å°å¤çåçé¾è·¯ä¿¡æ¯ä»¥å¾å½¢åçæ¹å¼å±ç¤ºç»ç¨æ·ã\n\nå®éé¡¹ç®ä¸­ä¸»è¦ç¨å°ä¸¤ç§å¾å½¢å±ç¤ºï¼ä¸ç§æ¯è°ç¨é¾è·¯å¾ï¼ä¸ç§æ¯è°ç¨ææå¾ã\n\n# è°ç¨é¾è·¯å¾\n\nè°ç¨é¾è·¯å¾ä¸è¬å±ç¤ºæå¡æ»èæ¶ãæå¡è°ç¨çç½ç»æ·±åº¦ãæ¯ä¸å±ç»è¿çç³»ç»ï¼ä»¥åå¤å°æ¬¡è°ç¨ãè°ç¨é¾è·¯å¾å¨å®éé¡¹ç®ä¸­ï¼ä¸»è¦æ¯è¢«ç¨æ¥åæéå®ä½ï¼æ¯å¦æä¸æ¬¡ç¨æ·è°ç¨å¤±è´¥äºï¼å¯ä»¥éè¿è°ç¨é¾è·¯å¾æ¥è¯¢è¿æ¬¡ç¨æ·è°ç¨ç»è¿äºåªäºç¯èï¼å°åºæ¯åªä¸å±çè°ç¨å¤±è´¥æå¯¼è´ã\n\nä¸é¢æ¯ Zipkin çè°ç¨é¾è·¯å¾ï¼\n\n\n\n# è°ç¨ææå¾\n\nè°ç¨ææå¾ä¸è¬å±ç¤ºç³»ç»åé½åå«åªäºåºç¨ï¼å®ä»¬ä¹é´æ¯ä»ä¹å³ç³»ï¼ä»¥åä¾èµè°ç¨ç QPSãå¹³åèæ¶æåµãè°ç¨ææå¾æ¯ä¸ç§å¨å±è§éå¾ï¼å¨å®éé¡¹ç®ä¸­ï¼ä¸»è¦ç¨ä½å¨å±çæ§ï¼ç¨äºåç°ç³»ç»ä¸­å¼å¸¸çç¹ï¼ä»èå¿«éååºå³ç­ãæ¯å¦ï¼æä¸ä¸ªæå¡çªç¶åºç°å¼å¸¸ï¼é£ä¹å¨è°ç¨é¾è·¯ææå¾ä¸­å¯ä»¥çåºå¯¹è¿ä¸ªæå¡çè°ç¨èæ¶é½åé«äºï¼å¯ä»¥ç¨çº¢è²çå¾æ ·æ åºæ¥ï¼ç¨ä½çæ§æ¥è­¦ã\n\nä¸é¢æ¯ Pinpoint çè°ç¨é¾è·¯å¾ï¼\n\n\n\n\n# æå¡è¿½è¸ªææ¯éå\n\næå¡è¿½è¸ªçä¸»æµå¼æºäº§åæ¯è¾ä¸°å¯ï¼ä¸»è¦æ\n\n * Zipkinï¼Zipkin æ¯ Twitter å¼æºçè°ç¨é¾åæå·¥å·ï¼ç®ååºäº spring-cloud-sleuth å¾å°äºå¹¿æ³çä½¿ç¨ï¼ç¹ç¹æ¯è½»éï¼ä½¿ç¨ãé¨ç½²ç®åã\n * Pinpointï¼æ¯é©å½äººå¼æºçåºäºå­èç æ³¨å¥çè°ç¨é¾åæï¼ä»¥ååºç¨çæ§åæå·¥å·ãç¹ç¹æ¯æ¯æå¤ç§æä»¶ï¼UI åè½å¼ºå¤§ï¼æ¥å¥ç«¯æ ä»£ç ä¾µå¥ã\n * SkyWalkingï¼æ¯æ¬åå¼æºçåºäºå­èç æ³¨å¥çè°ç¨é¾åæï¼ä»¥ååºç¨çæ§åæå·¥å·ãç¹ç¹æ¯æ¯æå¤ç§æä»¶ï¼UI åè½è¾å¼ºï¼æ¥å¥ç«¯æ ä»£ç ä¾µå¥ãç®åå·²å å¥ Apache å­µåå¨ã\n * CATï¼CAT æ¯ç¾å¢ç¹è¯å¼æºçåºäºç¼ç åéç½®çè°ç¨é¾åæï¼åºç¨çæ§åæï¼æ¥å¿ééï¼çæ§æ¥è­¦ç­ä¸ç³»åççæ§å¹³å°å·¥å·ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * RPC å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²",normalizedContent:"# æå¡è¿½è¸ª\n\n\n# ä»ä¹æ¯æå¡è¿½è¸ª\n\nå¨å¾®æå¡æ¶æä¸ï¼ç±äºè¿è¡äºæå¡æåï¼ä¸æ¬¡è¯·æ±å¾å¾éè¦æ¶åå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡å¯è½æ¯ç±ä¸åçå¢éå¼åï¼ä½¿ç¨äºä¸åçç¼ç¨è¯­è¨ï¼è¿æå¯è½é¨ç½²å¨ä¸åçæºå¨ä¸ï¼åå¸å¨ä¸åçæ°æ®ä¸­å¿ãå¦æè¯·æ±å¤±è´¥äºï¼è¦æ³æ¥æ¸æ¥å°åºæ¯åªä¸ªåºç¨å¯¼è´ï¼ä¼æ¯éå¸¸å¤æçä¸ä»¶äºæã\n\nå¦ææä¸ä¸ªç³»ç»ï¼å¯ä»¥è·è¸ªè®°å½ä¸æ¬¡ç¨æ·è¯·æ±é½åèµ·äºåªäºè°ç¨ï¼ç»è¿åªäºæå¡å¤çï¼å¹¶ä¸è®°å½æ¯ä¸æ¬¡è°ç¨ææ¶åçæå¡çè¯¦ç»ä¿¡æ¯ï¼è¿æ¶åå¦æåçè°ç¨å¤±è´¥ï¼ä½ å°±å¯ä»¥éè¿è¿ä¸ªæ¥å¿å¿«éå®ä½æ¯å¨åªä¸ªç¯èåºäºé®é¢ï¼è¿ä¸ªç³»ç»å°±æ¯æå¡é¾è·¯çæ§ã\n\n\n# ä¸ºä»ä¹éè¦æå¡è¿½è¸ª\n\n * ä¼åç³»ç»ç¶é¢ï¼éè¿è®°å½è°ç¨ç»è¿çæ¯ä¸æ¡é¾è·¯ä¸çèæ¶ï¼æä»¬è½å¿«éå®ä½æ´ä¸ªç³»ç»çç¶é¢ç¹å¨åªéãæ¯å¦ä½ è®¿é®å¾®åé¦é¡µåç°å¾æ¢ï¼è¯å®æ¯ç±äºæç§åå é æçï¼æå¯è½æ¯è¿è¥åç½ç»å»¶è¿ï¼æå¯è½æ¯ç½å³ç³»ç»å¼å¸¸ï¼æå¯è½æ¯æä¸ªæå¡å¼å¸¸ï¼è¿æå¯è½æ¯ç¼å­æèæ°æ®åºå¼å¸¸ãéè¿æå¡è¿½è¸ªï¼å¯ä»¥ä»å¨å±è§è§ä¸å»è§å¯ï¼æ¾åºæ´ä¸ªç³»ç»çç¶é¢ç¹æå¨ï¼ç¶åååºéå¯¹æ§çä¼åã\n * ä¼åé¾è·¯è°ç¨ï¼éè¿æå¡è¿½è¸ªå¯ä»¥åæè°ç¨æç»è¿çè·¯å¾ï¼ç¶åè¯ä¼°æ¯å¦åçãæ¯å¦ä¸ä¸ªæå¡è°ç¨ä¸æ¸¸ä¾èµäºå¤ä¸ªæå¡ï¼éè¿è°ç¨é¾åæï¼å¯ä»¥è¯ä¼°æ¯å¦æ¯ä¸ªä¾èµé½æ¯å¿è¦çï¼æ¯å¦å¯ä»¥éè¿ä¸å¡ä¼åæ¥åå°æå¡ä¾èµãè¿æå°±æ¯ï¼ä¸è¬ä¸å¡é½ä¼å¨å¤ä¸ªæ°æ®ä¸­å¿é½é¨ç½²æå¡ï¼ä»¥å®ç°å¼å°å®¹ç¾ï¼è¿ä¸ªæ¶åç»å¸¸ä¼åºç°ä¸ç§ç¶åµå°±æ¯æå¡ a è°ç¨äºå¦å¤ä¸ä¸ªæ°æ®ä¸­å¿çæå¡ bï¼èæ²¡æè°ç¨åå¤äºä¸ä¸ªæ°æ®ä¸­å¿çæå¡ bãæ ¹æ®æçç»éªï¼è·¨æ°æ®ä¸­å¿çè°ç¨è§è·ç¦»è¿è¿é½ä¼æä¸å®çç½ç»å»¶è¿ï¼ååäº¬åå¹¿å·è¿ç§å åå¬éè·ç¦»çç½ç»å»¶è¿å¯è½è¾¾å° 30ms ä»¥ä¸ï¼è¿å¯¹äºæäºä¸å¡å ä¹æ¯ä¸å¯æ¥åçãéè¿å¯¹è°ç¨é¾è·¯è¿è¡åæï¼å¯ä»¥æ¾åºè·¨æ°æ®ä¸­å¿çæå¡è°ç¨ï¼ä»èè¿è¡ä¼åï¼å°½éè§é¿è¿ç§æåµåºç°ã\n * çæç½ç»ææï¼éè¿æå¡è¿½è¸ªç³»ç»ä¸­è®°å½çé¾è·¯ä¿¡æ¯ï¼å¯ä»¥çæä¸å¼ ç³»ç»çç½ç»è°ç¨ææå¾ï¼å®å¯ä»¥åæ ç³»ç»é½ä¾èµäºåªäºæå¡ï¼ä»¥åæå¡ä¹é´çè°ç¨å³ç³»æ¯ä»ä¹æ ·çï¼å¯ä»¥ä¸ç®äºç¶ãé¤æ­¤ä¹å¤ï¼å¨ç½ç»ææå¾ä¸è¿å¯ä»¥ææå¡è°ç¨çè¯¦ç»ä¿¡æ¯ä¹æ åºæ¥ï¼ä¹è½èµ·å°æå¡çæ§çä½ç¨ã\n * éæä¼ è¾æ°æ®ï¼é¤äºæå¡è¿½è¸ªï¼ä¸å¡ä¸ç»å¸¸æä¸ç§éæ±ï¼ææè½æä¸äºç¨æ·æ°æ®ï¼ä»è°ç¨çå¼å§ä¸ç´å¾ä¸ä¼ éï¼ä»¥ä¾¿ç³»ç»ä¸­çåä¸ªæå¡é½è½è·åå°è¿ä¸ªä¿¡æ¯ãæ¯å¦ä¸å¡æ³åä¸äº a/b æµè¯ï¼è¿æ¶åå°±æ³éè¿æå¡è¿½è¸ªç³»ç»ï¼æ a/b æµè¯çå¼å³é»è¾ä¸ç´å¾ä¸ä¼ éï¼ç»è¿çæ¯ä¸å±æå¡é½è½è·åå°è¿ä¸ªå¼å³å¼ï¼å°±è½å¤ç»ä¸è¿è¡ a/b æµè¯ã\n\n\n# æå¡é¾è·¯çæ§çåç\n\ngoogle åå¸çä¸ç¯çè®ºæ dapper, a large-scale distributed systems tracing infrastructureï¼éé¢è¯¦ç»è®²è§£äºæå¡è¿½è¸ªç³»ç»çå®ç°åçãå®çæ ¸å¿çå¿µå°±æ¯è°ç¨é¾ï¼éè¿ä¸ä¸ªå¨å±å¯ä¸ç id å°åå¸å¨åä¸ªæå¡èç¹ä¸çåä¸æ¬¡è¯·æ±ä¸²èèµ·æ¥ï¼ä»èè¿ååæçè°ç¨å³ç³»ï¼å¯ä»¥è¿½è¸ªç³»ç»é®é¢ãåæè°ç¨æ°æ®å¹¶ç»è®¡åç§ç³»ç»ææ ã\n\nå¯ä»¥è¯´åé¢çè¯çåç§æå¡è¿½è¸ªç³»ç»é½æ¯åºäº dapper è¡çåºæ¥çï¼æ¯è¾æåçæ twitter çzipkinãé¿éçé¹°ç¼ãç¾å¢çmtraceç­ã\n\nè¦çè§£æå¡è¿½è¸ªçåçï¼é¦åå¿é¡»ææä¸äºåºæ¬æ¦å¿µï¼traceidãspanidãannonation ç­ãdapper è¿ç¯è®ºæè®²å¾æ¯è¾æ¸æ¥ï¼ä½å¯¹åå­¦èæ¥è¯´çè§£èµ·æ¥å¯è½æç¹å°é¾ï¼ç¾å¢ç mtrace çåçä»ç»çè§£èµ·æ¥ç¸å¯¹å®¹æä¸äºï¼ä¸é¢æå°±ä»¥ mtrace ä¸ºä¾ï¼ç»ä½ è¯¦ç»è®²è¿°æå¡è¿½è¸ªç³»ç»çå®ç°åçãè½ç¶åçæäºæ¦æ¶©ï¼ä½å´æ¯ä½ å¿é¡»ææ¡çï¼åªæçè§£äºæå¡è¿½è¸ªçåºæ¬æ¦å¿µï¼æè½æ´å¥½å°å°å¶å®ç°åºæ¥ã\n\n\n\n * traceï¼ç¨äºè¡¨ç¤ºæä¸æ¬¡å·ä½çè¯·æ±ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼ä¼å¨ rpc è°ç¨ç½ç»çç¬¬ä¸å±çæä¸ä¸ªå¨å±å¯ä¸ç trace idï¼å¹¶ä¸ä¼éçæ¯ä¸å±ç rpc è°ç¨ï¼ä¸æ­å¾åä¼ éï¼è¿æ ·çè¯éè¿ trace id å°±å¯ä»¥æä¸æ¬¡ç¨æ·è¯·æ±å¨ç³»ç»ä¸­è°ç¨çè·¯å¾ä¸²èèµ·æ¥ã\n * spanï¼å·¥ä½çåºæ¬åä½ãspan ç¨äºæ è¯ä¸æ¬¡ rpc è°ç¨å¨åå¸å¼è¯·æ±ä¸­çä½ç½®ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼å¤å¨ rpc è°ç¨ç½ç»çç¬¬ä¸å± a æ¶ span id åå§å¼æ¯ 0ï¼è¿å¥ä¸ä¸å± rpc è°ç¨ b çæ¶å span id æ¯ 0.1ï¼ç»§ç»­è¿å¥ä¸ä¸å± rpc è°ç¨ c æ¶ span id æ¯ 0.1.1ï¼èä¸ b å¤å¨åä¸å±ç rpc è°ç¨ e ç span id æ¯ 0.2ï¼è¿æ ·çè¯éè¿ span id å°±å¯ä»¥å®ä½æä¸æ¬¡ rpc è¯·æ±å¨ç³»ç»è°ç¨ä¸­æå¤çä½ç½®ï¼ä»¥åå®çä¸ä¸æ¸¸ä¾èµåå«æ¯è°ã\n * annotationï¼ç¨äºä¸å¡èªå®ä¹åç¹æ°æ®ï¼å¯ä»¥æ¯ä¸å¡æå´è¶£çæ³ä¸ä¼ å°åç«¯çæ°æ®ï¼æ¯å¦ä¸æ¬¡è¯·æ±çç¨æ· uidã\n\n\n# æå¡è¿½è¸ªç³»ç»å®ç°\n\nä¸ä¸ªæå¡è¿½è¸ªç³»ç»å¯ä»¥åä¸ºä¸å±ï¼\n\n * æ°æ®ééå±ï¼è´è´£æ°æ®åç¹å¹¶ä¸æ¥ã\n * æ°æ®å¤çå±ï¼è´è´£æ°æ®çå­å¨ä¸è®¡ç®ã\n * æ°æ®å±ç¤ºå±ï¼è´è´£æ°æ®çå¾å½¢åå±ç¤ºã\n\n\n# æ°æ®ééå±\n\næ°æ®ééå±çä½ç¨å°±æ¯å¨ç³»ç»çåä¸ªä¸åæ¨¡åä¸­è¿è¡åç¹ï¼ééæ°æ®å¹¶ä¸æ¥ç»æ°æ®å¤çå±è¿è¡å¤çã\n\né£ä¹è¯¥å¦ä½è¿è¡æ°æ®åç¹å¢ï¼\n\nä¸æ¬¡ rpc è¯·æ±å¯ä»¥åä¸ºåä¸ªé¶æ®µã\n\n * **csï¼client sendï¼**é¶æ®µ : å®¢æ·ç«¯åèµ·è¯·æ±ï¼å¹¶çæè°ç¨çä¸ä¸æã\n * **srï¼server recieveï¼**é¶æ®µ : æå¡ç«¯æ¥æ¶è¯·æ±ï¼å¹¶çæä¸ä¸æã\n * **ssï¼server sendï¼**é¶æ®µ : æå¡ç«¯è¿åè¯·æ±ï¼è¿ä¸ªé¶æ®µä¼å°æå¡ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸é¢è¿å¼ å¾å¯ä»¥è¯´æä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanid=0.1ï¼appkey=bï¼method=b.methodï¼start=103ï¼duration=38ã\n * **crï¼client recieveï¼**é¶æ®µ : å®¢æ·ç«¯æ¥æ¶è¿åç»æï¼è¿ä¸ªé¶æ®µä¼å°å®¢æ·ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanid=0.1ï¼appkey=aï¼method=b.methodï¼start=103ï¼duration=38ã\n\n\n# æ°æ®å¤çå±\n\næ°æ®å¤çå±çä½ç¨å°±æ¯ææ°æ®ééå±ä¸æ¥çæ°æ®æéè®¡ç®ï¼ç¶åè½å°å­å¨ä¾æ¥è¯¢ä½¿ç¨ã\n\næ°æ®å¤ççéæ±ä¸è¬åä¸ºä¸¤ç±»ï¼ä¸ç±»æ¯å®æ¶è®¡ç®éæ±ï¼ä¸ç±»æ¯ç¦»çº¿è®¡ç®éæ±ã\n\nå®æ¶è®¡ç®éæ±å¯¹è®¡ç®æçè¦æ±æ¯è¾é«ï¼ä¸è¬è¦æ±å¯¹æ¶éçé¾è·¯æ°æ®è½å¤å¨ç§çº§å«å®æèåè®¡ç®ï¼ä»¥ä¾å®æ¶æ¥è¯¢ãèç¦»çº¿è®¡ç®éæ±å¯¹è®¡ç®æçè¦æ±å°±æ²¡é£ä¹é«äºï¼ä¸è¬è½å¨å°æ¶çº§å«å®æé¾è·¯æ°æ®çèåè®¡ç®å³å¯ï¼ä¸è¬ç¨ä½æ°æ®æ±æ»ç»è®¡ãéå¯¹è¿ä¸¤ç±»ä¸åçæ°æ®å¤çéæ±ï¼éç¨çè®¡ç®æ¹æ³åå­å¨ä¹ä¸ç¸åã\n\n * å®æ¶æ°æ®å¤çï¼éå¯¹å®æ¶æ°æ®å¤çï¼ä¸è¬éç¨ flinkãstormãspark streaming æ¥å¯¹é¾è·¯æ°æ®è¿è¡å®æ¶èåå å·¥ï¼å­å¨ä¸è¬ä½¿ç¨ oltp æ°æ®ä»åºï¼æ¯å¦ hbaseï¼ä½¿ç¨ traceid ä½ä¸º rowkeyï¼è½å¤©ç¶å°æä¸æ´æ¡è°ç¨é¾èåå¨ä¸èµ·ï¼æé«æ¥è¯¢æçã\n\n * ç¦»çº¿æ°æ®å¤çï¼éå¯¹ç¦»çº¿æ°æ®å¤çï¼ä¸è¬éè¿è¿è¡ mapreduce æè spark æ¹å¤çç¨åºæ¥å¯¹é¾è·¯æ°æ®è¿è¡ç¦»çº¿è®¡ç®ï¼å­å¨ä¸è¬ä½¿ç¨ hiveã\n\n\n# æ°æ®å±ç¤ºå±\n\næ°æ®å±ç¤ºå±çä½ç¨å°±æ¯å°å¤çåçé¾è·¯ä¿¡æ¯ä»¥å¾å½¢åçæ¹å¼å±ç¤ºç»ç¨æ·ã\n\nå®éé¡¹ç®ä¸­ä¸»è¦ç¨å°ä¸¤ç§å¾å½¢å±ç¤ºï¼ä¸ç§æ¯è°ç¨é¾è·¯å¾ï¼ä¸ç§æ¯è°ç¨ææå¾ã\n\n# è°ç¨é¾è·¯å¾\n\nè°ç¨é¾è·¯å¾ä¸è¬å±ç¤ºæå¡æ»èæ¶ãæå¡è°ç¨çç½ç»æ·±åº¦ãæ¯ä¸å±ç»è¿çç³»ç»ï¼ä»¥åå¤å°æ¬¡è°ç¨ãè°ç¨é¾è·¯å¾å¨å®éé¡¹ç®ä¸­ï¼ä¸»è¦æ¯è¢«ç¨æ¥åæéå®ä½ï¼æ¯å¦æä¸æ¬¡ç¨æ·è°ç¨å¤±è´¥äºï¼å¯ä»¥éè¿è°ç¨é¾è·¯å¾æ¥è¯¢è¿æ¬¡ç¨æ·è°ç¨ç»è¿äºåªäºç¯èï¼å°åºæ¯åªä¸å±çè°ç¨å¤±è´¥æå¯¼è´ã\n\nä¸é¢æ¯ zipkin çè°ç¨é¾è·¯å¾ï¼\n\n\n\n# è°ç¨ææå¾\n\nè°ç¨ææå¾ä¸è¬å±ç¤ºç³»ç»åé½åå«åªäºåºç¨ï¼å®ä»¬ä¹é´æ¯ä»ä¹å³ç³»ï¼ä»¥åä¾èµè°ç¨ç qpsãå¹³åèæ¶æåµãè°ç¨ææå¾æ¯ä¸ç§å¨å±è§éå¾ï¼å¨å®éé¡¹ç®ä¸­ï¼ä¸»è¦ç¨ä½å¨å±çæ§ï¼ç¨äºåç°ç³»ç»ä¸­å¼å¸¸çç¹ï¼ä»èå¿«éååºå³ç­ãæ¯å¦ï¼æä¸ä¸ªæå¡çªç¶åºç°å¼å¸¸ï¼é£ä¹å¨è°ç¨é¾è·¯ææå¾ä¸­å¯ä»¥çåºå¯¹è¿ä¸ªæå¡çè°ç¨èæ¶é½åé«äºï¼å¯ä»¥ç¨çº¢è²çå¾æ ·æ åºæ¥ï¼ç¨ä½çæ§æ¥è­¦ã\n\nä¸é¢æ¯ pinpoint çè°ç¨é¾è·¯å¾ï¼\n\n\n\n\n# æå¡è¿½è¸ªææ¯éå\n\næå¡è¿½è¸ªçä¸»æµå¼æºäº§åæ¯è¾ä¸°å¯ï¼ä¸»è¦æ\n\n * zipkinï¼zipkin æ¯ twitter å¼æºçè°ç¨é¾åæå·¥å·ï¼ç®ååºäº spring-cloud-sleuth å¾å°äºå¹¿æ³çä½¿ç¨ï¼ç¹ç¹æ¯è½»éï¼ä½¿ç¨ãé¨ç½²ç®åã\n * pinpointï¼æ¯é©å½äººå¼æºçåºäºå­èç æ³¨å¥çè°ç¨é¾åæï¼ä»¥ååºç¨çæ§åæå·¥å·ãç¹ç¹æ¯æ¯æå¤ç§æä»¶ï¼ui åè½å¼ºå¤§ï¼æ¥å¥ç«¯æ ä»£ç ä¾µå¥ã\n * skywalkingï¼æ¯æ¬åå¼æºçåºäºå­èç æ³¨å¥çè°ç¨é¾åæï¼ä»¥ååºç¨çæ§åæå·¥å·ãç¹ç¹æ¯æ¯æå¤ç§æä»¶ï¼ui åè½è¾å¼ºï¼æ¥å¥ç«¯æ ä»£ç ä¾µå¥ãç®åå·²å å¥ apache å­µåå¨ã\n * catï¼cat æ¯ç¾å¢ç¹è¯å¼æºçåºäºç¼ç åéç½®çè°ç¨é¾åæï¼åºç¨çæ§åæï¼æ¥å¿ééï¼çæ§æ¥è­¦ç­ä¸ç³»åççæ§å¹³å°å·¥å·ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * rpc å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æå¡å®¹é",frontmatter:{title:"æå¡å®¹é",categories:["åå¸å¼","åå¸å¼å³é®ææ¯","æå¡æ²»ç"],tags:["åå¸å¼","æå¡æ²»ç","çæ§","APM","é¾è·¯è¿½è¸ª"],abbrlink:"9c24212e",date:"2022-04-20T17:27:42.000Z",permalink:"/pages/28bda8/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/03.%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF/05.%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/04.%E6%9C%8D%E5%8A%A1%E5%AE%B9%E9%94%99.html",relativePath:"02.åå¸å¼/03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/04.æå¡å®¹é.md",key:"v-35aeaf87",path:"/pages/28bda8/",headers:[{level:2,title:"æéåç±»",slug:"æéåç±»",normalizedTitle:"æéåç±»",charIndex:11},{level:3,title:"éç¾¤æéåºå¯¹å¤ç",slug:"éç¾¤æéåºå¯¹å¤ç",normalizedTitle:"éç¾¤æéåºå¯¹å¤ç",charIndex:293},{level:3,title:"æºæ¿æéåºå¯¹å¤ç",slug:"æºæ¿æéåºå¯¹å¤ç",normalizedTitle:"æºæ¿æéåºå¯¹å¤ç",charIndex:465},{level:3,title:"åæºæéåºå¯¹å¤ç",slug:"åæºæéåºå¯¹å¤ç",normalizedTitle:"åæºæéåºå¯¹å¤ç",charIndex:921},{level:2,title:"å®¹éç­ç¥",slug:"å®¹éç­ç¥",normalizedTitle:"å®¹éç­ç¥",charIndex:1111},{level:2,title:"å®¹éè®¾è®¡æ¨¡å¼",slug:"å®¹éè®¾è®¡æ¨¡å¼",normalizedTitle:"å®¹éè®¾è®¡æ¨¡å¼",charIndex:1986},{level:3,title:"æ­è·¯å¨æ¨¡å¼",slug:"æ­è·¯å¨æ¨¡å¼",normalizedTitle:"æ­è·¯å¨æ¨¡å¼",charIndex:1997},{level:3,title:"è±å£éç¦»æ¨¡å¼",slug:"è±å£éç¦»æ¨¡å¼",normalizedTitle:"è±å£éç¦»æ¨¡å¼",charIndex:2271},{level:3,title:"éè¯æ¨¡å¼",slug:"éè¯æ¨¡å¼",normalizedTitle:"éè¯æ¨¡å¼",charIndex:2433},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2680}],headersStr:"æéåç±» éç¾¤æéåºå¯¹å¤ç æºæ¿æéåºå¯¹å¤ç åæºæéåºå¯¹å¤ç å®¹éç­ç¥ å®¹éè®¾è®¡æ¨¡å¼ æ­è·¯å¨æ¨¡å¼ è±å£éç¦»æ¨¡å¼ éè¯æ¨¡å¼ åèèµæ",content:"# æå¡å®¹é\n\n\n# æéåç±»\n\nä»æéå½±åèå´ç»´åº¦æ¥çï¼åå¸å¼ç³»ç»çæéå¯ä»¥åä¸ºä¸ç±»ï¼\n\n * éç¾¤æéï¼æ ¹æ®ä¸å¡éå¤§å°èå®ï¼éç¾¤è§æ¨¡ä»å å°å°çè³ä¸ä¸å°é½æå¯è½ãä¸æ¦æäºä»£ç åºç° bugï¼å¯è½æ´ä¸ªéç¾¤é½ä¼åçæéï¼ä¸è½æä¾å¯¹å¤æä¾æå¡ã\n * æºæ¿æéï¼ç°å¨å¤§å¤æ°äºèç½å¬å¸ä¸ºäºä¿è¯ä¸å¡çé«å¯ç¨æ§ï¼å¾å¾ä¸å¡é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ãç¶èç°å®ä¸­ï¼ææºæ¿çåç¼å ä¸ºéè·¯æ½å·¥è¢«ææ­ï¼å¯¼è´æ´ä¸ªæºæ¿è±ç½çäºæï¼ä¹æ¯æ¶æåççãå¹¶ä¸è¿ç§äºæå¾å¾å®¹æä¸ç­æã\n * åæºæéï¼éç¾¤ä¸­çä¸ªå«æºå¨åºç°æéï¼è¿ç§æåµå¾å¾å¯¹å¨å±æ²¡æå¤ªå¤§å½±åï¼ä½ä¼å¯¼è´è°ç¨å°æéæºå¨ä¸çè¯·æ±é½å¤±è´¥ï¼å½±åæ´ä¸ªç³»ç»çæåçã\n\n\n# éç¾¤æéåºå¯¹å¤ç\n\nä¸è¬èè¨ï¼éç¾¤æéçäº§çåå ä¸å¤ä¹æä¸¤ç§ï¼\n\n * ä¸ç§æ¯ä»£ç  bug æå¯¼è´ï¼æ¯å¦è¯´æä¸æ®µ Java ä»£ç ä¸æ­å°åéå¤§å¯¹è±¡ï¼ä½æ²¡æåæ¶åæ¶å¯¼è´ JVM OOM éåºï¼\n * å¦ä¸ç§æ¯æµéçªåºï¼ç­æ¶é´çªç¶èè³çå¤§éè¯·æ±è¶åºäºç³»ç»çæ¿è½½è½åã\n\nåºä»éç¾¤æéçæè·¯ï¼ä¸»è¦æ¯éç¨æµéæ§å¶ï¼ä¸»è¦ææ®µæï¼éæµãéçº§ãçæ­ã\n\n\n# æºæ¿æéåºå¯¹å¤ç\n\nåæºæ¿è±ç½çäºæï¼å¤åæ¯å ä¸ºä¸äºä¸å¯æå ç´ ï¼å¦ï¼æºæ¿å¤±ç«ãåç¼è¢«ææ­ç­ç­ãæå¥èè¯å«ï¼ä¸è¦æé¸¡èé½æ¾å¨ä¸ä¸ªç¯®å­éãåçï¼ä¸è¦æä¸å¡é½é¨ç½²å¨ä¸ä¸ªæºæ¿ä¸­ï¼ä¸æ¦æºæ¿åºäºï¼é£å°±å½»åºå®èäºãæä»¥ï¼å¾å¤äºèç½å¬å¸çä¸å¡é½éç¨å¤æºæ¿é¨ç½²ãå¦æè¦è¿½æ±æ´é«çå¯é æ§ï¼å¯ä»¥éç¨ååå¤æ´»é¨ç½²ï¼çè³å¼å°å¤æ´»é¨ç½²ã\n\nå¤æºæ¿é¨ç½²çå¥½å¤æ¾èæè§ï¼å³æé«äºç³»ç»çå¯ç¨æ§ï¼ä½æ¯è¿ç§æ¶æå¼å¥äºå¶ä»çé®é¢ï¼å¦ä½ä¿è¯ä¸åæºæ¿æ°æ®çä¸è´æ§ï¼å¦ä½åæ¢å¤æºæ¿çæµéï¼ç­ç­ã\n\néå¯¹æµéåæ¢é®é¢ï¼ä¸è¬æä¸¤ç§ææ®µï¼\n\n * åºäº DNS è§£æçæµéåæ¢ï¼ä¸è¬æ¯éè¿æè¯·æ±è®¿é®ååè§£æç VIP ä»ä¸ä¸ª IDC åæ¢å°å¦å¤ä¸ä¸ª IDCã\n * åºäº RPC åç»çæµéåæ¢ï¼å¯¹äºä¸ä¸ªæå¡æ¥è¯´ï¼å¦ææ¯é¨ç½²å¨å¤ä¸ª IDC çè¯ï¼ä¸è¬æ¯ä¸ª IDC å°±æ¯ä¸ä¸ªåç»ãåå¦ä¸ä¸ª IDC åºç°æéï¼é£ä¹ååè·¯ç±å°è¿ä¸ªåç»çæµéï¼å°±å¯ä»¥éè¿åéç½®ä¸­å¿ä¸åå½ä»¤ï¼æååè·¯ç±å°è¿ä¸ªåç»çæµéå¨é¨åæ¢å°å«çåç»ï¼è¿æ ·çè¯å°±å¯ä»¥åæ¢æé IDC çæµéäºã\n\n\n# åæºæéåºå¯¹å¤ç\n\nå¯¹äºå¤§è§æ¨¡éç¾¤æ¥è¯´ï¼åºç°åæºæéçæ¦çæ¯å¾é«çãå½åºç°åæºæéæ¶ï¼éè¦æä¸å®çèªå¨åå¤çææ®µã\n\nå¤çåæºæéä¸ä¸ªææçåæ³å°±æ¯èªå¨éå¯ãå·ä½æ¥è®²ï¼ä½ å¯ä»¥è®¾ç½®ä¸ä¸ªéå¼ï¼æ¯å¦ä»¥æä¸ªæ¥å£çå¹³åèæ¶ä¸ºåï¼å½çæ§åæºä¸æä¸ªæ¥å£çå¹³åèæ¶è¶è¿ä¸å®éå¼æ¶ï¼å°±è®¤ä¸ºè¿å°æºå¨æé®é¢ï¼è¿ä¸ªæ¶åå°±éè¦ææé®é¢çæºå¨ä»çº¿ä¸éç¾¤ä¸­æé¤æï¼ç¶åå¨éå¯æå¡åï¼éæ°å å¥å°éç¾¤ä¸­ã\n\n\n# å®¹éç­ç¥\n\næå¡è°ç¨å¹¶ä¸æ»æ¯ä¸å®æåçï¼åé¢æè®²è¿ï¼å¯è½å ä¸ºæå¡æä¾èèç¹èªèº«å®æºãè¿ç¨å¼å¸¸éåºæèæå¡æ¶è´¹èä¸æä¾èä¹é´çç½ç»åºç°æéç­åå ãå¯¹äºæå¡è°ç¨å¤±è´¥çæåµï¼éè¦æææ®µèªå¨æ¢å¤ï¼æ¥ä¿è¯è°ç¨æåã\n\nå¸¸ç¨çææ®µä¸»è¦æä»¥ä¸å ç§ï¼\n\n * æéè½¬ç§»ï¼FailOverï¼ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãè¿ç§ç­ç¥è¦æ±æå¡è°ç¨çæä½å¿é¡»æ¯å¹ç­çï¼ä¹å°±æ¯è¯´æ è®ºè°ç¨å¤å°æ¬¡ï¼åªè¦æ¯åä¸ä¸ªè°ç¨ï¼è¿åçç»æé½æ¯ç¸åçï¼ä¸è¬éåæå¡è°ç¨æ¯è¯»è¯·æ±çåºæ¯ã\n * å¿«éå¤±è´¥ï¼FailFastï¼ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ãå®éå¨ä¸å¡æ§è¡æ¶ï¼ä¸è¬éæ ¸å¿ä¸å¡çè°ç¨ï¼ä¼éç¨å¿«éå¤±è´¥ç­ç¥ï¼è°ç¨å¤±è´¥åä¸è¬å°±è®°å½ä¸å¤±è´¥æ¥å¿å°±è¿åäºã\n * å®å¨å¤±è´¥ï¼Failsafeï¼ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã\n * éé»å¤±è´¥ï¼Failsilentï¼ï¼å¦æå¤§éçè¯·æ±éè¦ç­å°è¶æ¶ï¼æèé¿æ¶é´å¤çåï¼æå®£åå¤±è´¥ï¼å¾å®¹æç±äºæä¸ªè¿ç¨æå¡çè¯·æ±å ç§¯èæ¶èå¤§éççº¿ç¨ãåå­ãç½ç»ç­èµæºï¼è¿èå½±åå°æ´ä¸ªç³»ç»çç¨³å®ãé¢å¯¹è¿ç§æåµï¼ä¸ç§åççå¤±è´¥ç­ç¥æ¯å½è¯·æ±å¤±è´¥åï¼å°±é»è®¤æå¡æä¾èä¸å®æ¶é´åæ æ³åå¯¹å¤æä¾æå¡ï¼ä¸ååå®åéè¯·æ±æµéï¼å°éè¯¯éç¦»å¼æ¥ï¼é¿åå¯¹ç³»ç»å¶ä»é¨åäº§çå½±åï¼æ­¤å³ä¸ºæ²é»å¤±è´¥ç­ç¥ã\n * æéæ¢å¤ï¼FailBackï¼ï¼å°±æ¯æå¡æ¶è´¹èè°ç¨å¤±è´¥æèè¶æ¶åï¼ä¸åéè¯ï¼èæ¯æ ¹æ®å¤±è´¥çè¯¦ç»ä¿¡æ¯ï¼æ¥å³å®åç»­çæ§è¡ç­ç¥ãæ¯å¦å¯¹äºéå¹ç­çè°ç¨åºæ¯ï¼å¦æè°ç¨å¤±è´¥åï¼ä¸è½ç®åå°éè¯ï¼èæ¯åºè¯¥æ¥è¯¢æå¡ç«¯çç¶æï¼çè°ç¨å°åºæ¯å¦å®éçæï¼å¦æå·²ç»çæäºå°±ä¸è½åéè¯äºï¼å¦ææ²¡æçæå¯ä»¥ååèµ·ä¸æ¬¡è°ç¨ãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã\n * å¹¶è¡è°ç¨ï¼Forkingï¼ï¼å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºã\n * å¹¿æ­è°ç¨ï¼Broadcastï¼ï¼å¹¿æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\n\n# å®¹éè®¾è®¡æ¨¡å¼\n\n\n# æ­è·¯å¨æ¨¡å¼\n\næ­è·¯å¨çåºæ¬æè·¯æ¯å¾ç®åçï¼å°±æ¯éè¿ä»£çï¼æ­è·¯å¨å¯¹è±¡ï¼æ¥ä¸å¯¹ä¸å°ï¼ä¸ä¸ªè¿ç¨æå¡å¯¹åºä¸ä¸ªæ­è·¯å¨å¯¹è±¡ï¼æ¥ç®¡æå¡è°ç¨èçè¿ç¨è¯·æ±ãæ­è·¯å¨ä¼æç»­çæ§å¹¶ç»è®¡æå¡è¿åçæåãå¤±è´¥ãè¶æ¶ãæç»ç­åç§ç»æï¼å½åºç°æéï¼å¤±è´¥ãè¶æ¶ãæç»ï¼çæ¬¡æ°è¾¾å°æ­è·¯å¨çéå¼æ¶ï¼å®ç¶æå°±èªå¨åä¸ºâOPENâï¼åç»­æ­¤æ­è·¯å¨ä»£ççè¿ç¨è®¿é®é½å°ç´æ¥è¿åè°ç¨å¤±è´¥ï¼èä¸ä¼ååºçæ­£çè¿ç¨æå¡è¯·æ±ãéè¿æ­è·¯å¨å¯¹è¿ç¨æå¡ççæ­ï¼é¿åå æç»­çå¤±è´¥ææç»èæ¶èèµæºï¼å æç»­çè¶æ¶èå ç§¯è¯·æ±ï¼æç»çç®çå°±æ¯é¿åéªå´©æåºçåºç°ãç±æ­¤å¯è§ï¼æ­è·¯å¨æ¬è´¨æ¯ä¸ç§å¿«éå¤±è´¥ç­ç¥çå®ç°æ¹å¼ã\n\n\n# è±å£éç¦»æ¨¡å¼\n\nè±å£éç¦»æ¨¡å¼æ¯å¸¸ç¨çå®ç°æå¡éç¦»çè®¾è®¡æ¨¡å¼ï¼è±å£è¿ä¸ªè¯æ¯æ¥èªé è¹ä¸çè¶æ¥åï¼å®åæ¬çæææ¯è®¾è®¡è°è¹æ¶ï¼è¦å¨æ¯ä¸ªåºåè®¾è®¡ç¬ç«çæ°´å¯è±å®¤ï¼ä¸æ¦æä¸ªè±å®¤è¿æ°´ï¼ä¹åªæ¯å½±åè¿ä¸ªè±å®¤ä¸­çè´§ç©ï¼èä¸è³äºè®©æ´èè°èæ²æ²¡ãè¿ç§ææ³å°±å¾ç¬¦åå®¹éç­ç¥ä¸­å¤±è´¥éé»ç­ç¥ã\n\nHystrix å°±éç¨è±å£éç¦»æ¨¡å¼æ¥å®ç°çº¿ç¨éç¦»ã\n\n\n# éè¯æ¨¡å¼\n\næéè½¬ç§»åæéæ¢å¤ç­ç¥é½éè¦å¯¹æå¡è¿è¡éå¤è°ç¨ï¼å·®å«æ¯è¿äºéå¤è°ç¨æå¯è½æ¯åæ­¥çï¼ä¹å¯è½æ¯åå°å¼æ­¥è¿è¡ï¼æå¯è½ä¼éå¤è°ç¨åä¸ä¸ªæå¡ï¼ä¹å¯è½ä¼è°ç¨å°æå¡çå¶ä»å¯æ¬ãæ è®ºå·ä½æ¯éè¿ææ ·çæ¹å¼è°ç¨ãè°ç¨çæå¡å®ä¾æ¯å¦ç¸åï¼é½å¯ä»¥å½ç»ä¸ºéè¯è®¾è®¡æ¨¡å¼çåºç¨èç´ãéè¯æ¨¡å¼éåè§£å³ç³»ç»ä¸­çç¬æ¶æéï¼ç®åçè¯´å°±æ¯æå¯è½èªå·±æ¢å¤ï¼Resilientï¼ç§°ä¸ºèªæï¼ä¹å«ååå¼¹æ§ï¼çä¸´æ¶æ§å¤±çµï¼ç½ç»æå¨ãæå¡çä¸´æ¶è¿è½½ï¼å¸åçå¦è¿åäº 503 Bad Gateway éè¯¯ï¼è¿äºé½å±äºç¬æ¶æéã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * å¤å°æ¶æä¹æå¡å®¹é",normalizedContent:"# æå¡å®¹é\n\n\n# æéåç±»\n\nä»æéå½±åèå´ç»´åº¦æ¥çï¼åå¸å¼ç³»ç»çæéå¯ä»¥åä¸ºä¸ç±»ï¼\n\n * éç¾¤æéï¼æ ¹æ®ä¸å¡éå¤§å°èå®ï¼éç¾¤è§æ¨¡ä»å å°å°çè³ä¸ä¸å°é½æå¯è½ãä¸æ¦æäºä»£ç åºç° bugï¼å¯è½æ´ä¸ªéç¾¤é½ä¼åçæéï¼ä¸è½æä¾å¯¹å¤æä¾æå¡ã\n * æºæ¿æéï¼ç°å¨å¤§å¤æ°äºèç½å¬å¸ä¸ºäºä¿è¯ä¸å¡çé«å¯ç¨æ§ï¼å¾å¾ä¸å¡é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ãç¶èç°å®ä¸­ï¼ææºæ¿çåç¼å ä¸ºéè·¯æ½å·¥è¢«ææ­ï¼å¯¼è´æ´ä¸ªæºæ¿è±ç½çäºæï¼ä¹æ¯æ¶æåççãå¹¶ä¸è¿ç§äºæå¾å¾å®¹æä¸ç­æã\n * åæºæéï¼éç¾¤ä¸­çä¸ªå«æºå¨åºç°æéï¼è¿ç§æåµå¾å¾å¯¹å¨å±æ²¡æå¤ªå¤§å½±åï¼ä½ä¼å¯¼è´è°ç¨å°æéæºå¨ä¸çè¯·æ±é½å¤±è´¥ï¼å½±åæ´ä¸ªç³»ç»çæåçã\n\n\n# éç¾¤æéåºå¯¹å¤ç\n\nä¸è¬èè¨ï¼éç¾¤æéçäº§çåå ä¸å¤ä¹æä¸¤ç§ï¼\n\n * ä¸ç§æ¯ä»£ç  bug æå¯¼è´ï¼æ¯å¦è¯´æä¸æ®µ java ä»£ç ä¸æ­å°åéå¤§å¯¹è±¡ï¼ä½æ²¡æåæ¶åæ¶å¯¼è´ jvm oom éåºï¼\n * å¦ä¸ç§æ¯æµéçªåºï¼ç­æ¶é´çªç¶èè³çå¤§éè¯·æ±è¶åºäºç³»ç»çæ¿è½½è½åã\n\nåºä»éç¾¤æéçæè·¯ï¼ä¸»è¦æ¯éç¨æµéæ§å¶ï¼ä¸»è¦ææ®µæï¼éæµãéçº§ãçæ­ã\n\n\n# æºæ¿æéåºå¯¹å¤ç\n\nåæºæ¿è±ç½çäºæï¼å¤åæ¯å ä¸ºä¸äºä¸å¯æå ç´ ï¼å¦ï¼æºæ¿å¤±ç«ãåç¼è¢«ææ­ç­ç­ãæå¥èè¯å«ï¼ä¸è¦æé¸¡èé½æ¾å¨ä¸ä¸ªç¯®å­éãåçï¼ä¸è¦æä¸å¡é½é¨ç½²å¨ä¸ä¸ªæºæ¿ä¸­ï¼ä¸æ¦æºæ¿åºäºï¼é£å°±å½»åºå®èäºãæä»¥ï¼å¾å¤äºèç½å¬å¸çä¸å¡é½éç¨å¤æºæ¿é¨ç½²ãå¦æè¦è¿½æ±æ´é«çå¯é æ§ï¼å¯ä»¥éç¨ååå¤æ´»é¨ç½²ï¼çè³å¼å°å¤æ´»é¨ç½²ã\n\nå¤æºæ¿é¨ç½²çå¥½å¤æ¾èæè§ï¼å³æé«äºç³»ç»çå¯ç¨æ§ï¼ä½æ¯è¿ç§æ¶æå¼å¥äºå¶ä»çé®é¢ï¼å¦ä½ä¿è¯ä¸åæºæ¿æ°æ®çä¸è´æ§ï¼å¦ä½åæ¢å¤æºæ¿çæµéï¼ç­ç­ã\n\néå¯¹æµéåæ¢é®é¢ï¼ä¸è¬æä¸¤ç§ææ®µï¼\n\n * åºäº dns è§£æçæµéåæ¢ï¼ä¸è¬æ¯éè¿æè¯·æ±è®¿é®ååè§£æç vip ä»ä¸ä¸ª idc åæ¢å°å¦å¤ä¸ä¸ª idcã\n * åºäº rpc åç»çæµéåæ¢ï¼å¯¹äºä¸ä¸ªæå¡æ¥è¯´ï¼å¦ææ¯é¨ç½²å¨å¤ä¸ª idc çè¯ï¼ä¸è¬æ¯ä¸ª idc å°±æ¯ä¸ä¸ªåç»ãåå¦ä¸ä¸ª idc åºç°æéï¼é£ä¹ååè·¯ç±å°è¿ä¸ªåç»çæµéï¼å°±å¯ä»¥éè¿åéç½®ä¸­å¿ä¸åå½ä»¤ï¼æååè·¯ç±å°è¿ä¸ªåç»çæµéå¨é¨åæ¢å°å«çåç»ï¼è¿æ ·çè¯å°±å¯ä»¥åæ¢æé idc çæµéäºã\n\n\n# åæºæéåºå¯¹å¤ç\n\nå¯¹äºå¤§è§æ¨¡éç¾¤æ¥è¯´ï¼åºç°åæºæéçæ¦çæ¯å¾é«çãå½åºç°åæºæéæ¶ï¼éè¦æä¸å®çèªå¨åå¤çææ®µã\n\nå¤çåæºæéä¸ä¸ªææçåæ³å°±æ¯èªå¨éå¯ãå·ä½æ¥è®²ï¼ä½ å¯ä»¥è®¾ç½®ä¸ä¸ªéå¼ï¼æ¯å¦ä»¥æä¸ªæ¥å£çå¹³åèæ¶ä¸ºåï¼å½çæ§åæºä¸æä¸ªæ¥å£çå¹³åèæ¶è¶è¿ä¸å®éå¼æ¶ï¼å°±è®¤ä¸ºè¿å°æºå¨æé®é¢ï¼è¿ä¸ªæ¶åå°±éè¦ææé®é¢çæºå¨ä»çº¿ä¸éç¾¤ä¸­æé¤æï¼ç¶åå¨éå¯æå¡åï¼éæ°å å¥å°éç¾¤ä¸­ã\n\n\n# å®¹éç­ç¥\n\næå¡è°ç¨å¹¶ä¸æ»æ¯ä¸å®æåçï¼åé¢æè®²è¿ï¼å¯è½å ä¸ºæå¡æä¾èèç¹èªèº«å®æºãè¿ç¨å¼å¸¸éåºæèæå¡æ¶è´¹èä¸æä¾èä¹é´çç½ç»åºç°æéç­åå ãå¯¹äºæå¡è°ç¨å¤±è´¥çæåµï¼éè¦æææ®µèªå¨æ¢å¤ï¼æ¥ä¿è¯è°ç¨æåã\n\nå¸¸ç¨çææ®µä¸»è¦æä»¥ä¸å ç§ï¼\n\n * æéè½¬ç§»ï¼failoverï¼ï¼å½åºç°å¤±è´¥ï¼éè¯å¶å®æå¡å¨ãéå¸¸ç¨äºè¯»æä½ï¼ä½éè¯ä¼å¸¦æ¥æ´é¿å»¶è¿ãè¿ç§ç­ç¥è¦æ±æå¡è°ç¨çæä½å¿é¡»æ¯å¹ç­çï¼ä¹å°±æ¯è¯´æ è®ºè°ç¨å¤å°æ¬¡ï¼åªè¦æ¯åä¸ä¸ªè°ç¨ï¼è¿åçç»æé½æ¯ç¸åçï¼ä¸è¬éåæå¡è°ç¨æ¯è¯»è¯·æ±çåºæ¯ã\n * å¿«éå¤±è´¥ï¼failfastï¼ï¼åªåèµ·ä¸æ¬¡è°ç¨ï¼å¤±è´¥ç«å³æ¥éãéå¸¸ç¨äºéå¹ç­æ§çåæä½ï¼æ¯å¦æ°å¢è®°å½ãå®éå¨ä¸å¡æ§è¡æ¶ï¼ä¸è¬éæ ¸å¿ä¸å¡çè°ç¨ï¼ä¼éç¨å¿«éå¤±è´¥ç­ç¥ï¼è°ç¨å¤±è´¥åä¸è¬å°±è®°å½ä¸å¤±è´¥æ¥å¿å°±è¿åäºã\n * å®å¨å¤±è´¥ï¼failsafeï¼ï¼åºç°å¼å¸¸æ¶ï¼ç´æ¥å¿½ç¥ãéå¸¸ç¨äºåå¥å®¡è®¡æ¥å¿ç­æä½ã\n * éé»å¤±è´¥ï¼failsilentï¼ï¼å¦æå¤§éçè¯·æ±éè¦ç­å°è¶æ¶ï¼æèé¿æ¶é´å¤çåï¼æå®£åå¤±è´¥ï¼å¾å®¹æç±äºæä¸ªè¿ç¨æå¡çè¯·æ±å ç§¯èæ¶èå¤§éççº¿ç¨ãåå­ãç½ç»ç­èµæºï¼è¿èå½±åå°æ´ä¸ªç³»ç»çç¨³å®ãé¢å¯¹è¿ç§æåµï¼ä¸ç§åççå¤±è´¥ç­ç¥æ¯å½è¯·æ±å¤±è´¥åï¼å°±é»è®¤æå¡æä¾èä¸å®æ¶é´åæ æ³åå¯¹å¤æä¾æå¡ï¼ä¸ååå®åéè¯·æ±æµéï¼å°éè¯¯éç¦»å¼æ¥ï¼é¿åå¯¹ç³»ç»å¶ä»é¨åäº§çå½±åï¼æ­¤å³ä¸ºæ²é»å¤±è´¥ç­ç¥ã\n * æéæ¢å¤ï¼failbackï¼ï¼å°±æ¯æå¡æ¶è´¹èè°ç¨å¤±è´¥æèè¶æ¶åï¼ä¸åéè¯ï¼èæ¯æ ¹æ®å¤±è´¥çè¯¦ç»ä¿¡æ¯ï¼æ¥å³å®åç»­çæ§è¡ç­ç¥ãæ¯å¦å¯¹äºéå¹ç­çè°ç¨åºæ¯ï¼å¦æè°ç¨å¤±è´¥åï¼ä¸è½ç®åå°éè¯ï¼èæ¯åºè¯¥æ¥è¯¢æå¡ç«¯çç¶æï¼çè°ç¨å°åºæ¯å¦å®éçæï¼å¦æå·²ç»çæäºå°±ä¸è½åéè¯äºï¼å¦ææ²¡æçæå¯ä»¥ååèµ·ä¸æ¬¡è°ç¨ãéå¸¸ç¨äºæ¶æ¯éç¥æä½ã\n * å¹¶è¡è°ç¨ï¼forkingï¼ï¼å¹¶è¡è°ç¨å¤ä¸ªæå¡å¨ï¼åªè¦ä¸ä¸ªæåå³è¿åãéå¸¸ç¨äºå®æ¶æ§è¦æ±è¾é«çè¯»æä½ï¼ä½éè¦æµªè´¹æ´å¤æå¡èµæºã\n * å¹¿æ­è°ç¨ï¼broadcastï¼ï¼å¹¿æ­è°ç¨æææä¾èï¼éä¸ªè°ç¨ï¼ä»»æä¸å°æ¥éåæ¥éãéå¸¸ç¨äºéç¥æææä¾èæ´æ°ç¼å­ææ¥å¿ç­æ¬å°èµæºä¿¡æ¯ã\n\n\n# å®¹éè®¾è®¡æ¨¡å¼\n\n\n# æ­è·¯å¨æ¨¡å¼\n\næ­è·¯å¨çåºæ¬æè·¯æ¯å¾ç®åçï¼å°±æ¯éè¿ä»£çï¼æ­è·¯å¨å¯¹è±¡ï¼æ¥ä¸å¯¹ä¸å°ï¼ä¸ä¸ªè¿ç¨æå¡å¯¹åºä¸ä¸ªæ­è·¯å¨å¯¹è±¡ï¼æ¥ç®¡æå¡è°ç¨èçè¿ç¨è¯·æ±ãæ­è·¯å¨ä¼æç»­çæ§å¹¶ç»è®¡æå¡è¿åçæåãå¤±è´¥ãè¶æ¶ãæç»ç­åç§ç»æï¼å½åºç°æéï¼å¤±è´¥ãè¶æ¶ãæç»ï¼çæ¬¡æ°è¾¾å°æ­è·¯å¨çéå¼æ¶ï¼å®ç¶æå°±èªå¨åä¸ºâopenâï¼åç»­æ­¤æ­è·¯å¨ä»£ççè¿ç¨è®¿é®é½å°ç´æ¥è¿åè°ç¨å¤±è´¥ï¼èä¸ä¼ååºçæ­£çè¿ç¨æå¡è¯·æ±ãéè¿æ­è·¯å¨å¯¹è¿ç¨æå¡ççæ­ï¼é¿åå æç»­çå¤±è´¥ææç»èæ¶èèµæºï¼å æç»­çè¶æ¶èå ç§¯è¯·æ±ï¼æç»çç®çå°±æ¯é¿åéªå´©æåºçåºç°ãç±æ­¤å¯è§ï¼æ­è·¯å¨æ¬è´¨æ¯ä¸ç§å¿«éå¤±è´¥ç­ç¥çå®ç°æ¹å¼ã\n\n\n# è±å£éç¦»æ¨¡å¼\n\nè±å£éç¦»æ¨¡å¼æ¯å¸¸ç¨çå®ç°æå¡éç¦»çè®¾è®¡æ¨¡å¼ï¼è±å£è¿ä¸ªè¯æ¯æ¥èªé è¹ä¸çè¶æ¥åï¼å®åæ¬çæææ¯è®¾è®¡è°è¹æ¶ï¼è¦å¨æ¯ä¸ªåºåè®¾è®¡ç¬ç«çæ°´å¯è±å®¤ï¼ä¸æ¦æä¸ªè±å®¤è¿æ°´ï¼ä¹åªæ¯å½±åè¿ä¸ªè±å®¤ä¸­çè´§ç©ï¼èä¸è³äºè®©æ´èè°èæ²æ²¡ãè¿ç§ææ³å°±å¾ç¬¦åå®¹éç­ç¥ä¸­å¤±è´¥éé»ç­ç¥ã\n\nhystrix å°±éç¨è±å£éç¦»æ¨¡å¼æ¥å®ç°çº¿ç¨éç¦»ã\n\n\n# éè¯æ¨¡å¼\n\næéè½¬ç§»åæéæ¢å¤ç­ç¥é½éè¦å¯¹æå¡è¿è¡éå¤è°ç¨ï¼å·®å«æ¯è¿äºéå¤è°ç¨æå¯è½æ¯åæ­¥çï¼ä¹å¯è½æ¯åå°å¼æ­¥è¿è¡ï¼æå¯è½ä¼éå¤è°ç¨åä¸ä¸ªæå¡ï¼ä¹å¯è½ä¼è°ç¨å°æå¡çå¶ä»å¯æ¬ãæ è®ºå·ä½æ¯éè¿ææ ·çæ¹å¼è°ç¨ãè°ç¨çæå¡å®ä¾æ¯å¦ç¸åï¼é½å¯ä»¥å½ç»ä¸ºéè¯è®¾è®¡æ¨¡å¼çåºç¨èç´ãéè¯æ¨¡å¼éåè§£å³ç³»ç»ä¸­çç¬æ¶æéï¼ç®åçè¯´å°±æ¯æå¯è½èªå·±æ¢å¤ï¼resilientï¼ç§°ä¸ºèªæï¼ä¹å«ååå¼¹æ§ï¼çä¸´æ¶æ§å¤±çµï¼ç½ç»æå¨ãæå¡çä¸´æ¶è¿è½½ï¼å¸åçå¦è¿åäº 503 bad gateway éè¯¯ï¼è¿äºé½å±äºç¬æ¶æéã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * å¤å°æ¶æä¹æå¡å®¹é",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å¾®æå¡åºæ¬åç",frontmatter:{title:"å¾®æå¡åºæ¬åç",categories:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],tags:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],abbrlink:"717ee426",date:"2020-07-21T15:35:00.000Z",permalink:"/pages/5b6d71/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/04.%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.html",relativePath:"02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/01.å¾®æå¡åºæ¬åç.md",key:"v-6c538cc0",path:"/pages/5b6d71/",headers:[{level:2,title:"1. å¾®æå¡ç®ä»",slug:"_1-å¾®æå¡ç®ä»",normalizedTitle:"1. å¾®æå¡ç®ä»",charIndex:14},{level:3,title:"1.1. ä»ä¹æ¯å¾®æå¡æ¶æ",slug:"_1-1-ä»ä¹æ¯å¾®æå¡æ¶æ",normalizedTitle:"1.1. ä»ä¹æ¯å¾®æå¡æ¶æ",charIndex:27},{level:3,title:"1.2. å¦ä½æè¡¡å¾®æå¡çå©å¼",slug:"_1-2-å¦ä½æè¡¡å¾®æå¡çå©å¼",normalizedTitle:"1.2. å¦ä½æè¡¡å¾®æå¡çå©å¼",charIndex:198},{level:3,title:"1.3. åº·å¨å®å¾",slug:"_1-3-åº·å¨å®å¾",normalizedTitle:"1.3. åº·å¨å®å¾",charIndex:293},{level:3,title:"1.4. å¦ä½æåå¾®æå¡",slug:"_1-4-å¦ä½æåå¾®æå¡",normalizedTitle:"1.4. å¦ä½æåå¾®æå¡",charIndex:429},{level:2,title:"2. å¾®æå¡ææ¯æ¶æ",slug:"_2-å¾®æå¡ææ¯æ¶æ",normalizedTitle:"2. å¾®æå¡ææ¯æ¶æ",charIndex:705},{level:2,title:"3. æå¡æ³¨ååç°",slug:"_3-æå¡æ³¨ååç°",normalizedTitle:"3. æå¡æ³¨ååç°",charIndex:834},{level:3,title:"3.1. æ³¨åä¸­å¿çå·¥ä½æµç¨",slug:"_3-1-æ³¨åä¸­å¿çå·¥ä½æµç¨",normalizedTitle:"3.1. æ³¨åä¸­å¿çå·¥ä½æµç¨",charIndex:1234},{level:3,title:"3.2. æ³¨åä¸­å¿å®ç°æ¨¡å¼",slug:"_3-2-æ³¨åä¸­å¿å®ç°æ¨¡å¼",normalizedTitle:"3.2. æ³¨åä¸­å¿å®ç°æ¨¡å¼",charIndex:1431},{level:4,title:"3.2.1. åºç¨åæ³¨åååç°",slug:"_3-2-1-åºç¨åæ³¨åååç°",normalizedTitle:"3.2.1. åºç¨åæ³¨åååç°",charIndex:1448},{level:4,title:"3.2.2. åºç¨å¤æ³¨åååç°",slug:"_3-2-2-åºç¨å¤æ³¨åååç°",normalizedTitle:"3.2.2. åºç¨å¤æ³¨åååç°",charIndex:1743},{level:4,title:"3.2.3. æ³¨åä¸­å¿éå",slug:"_3-2-3-æ³¨åä¸­å¿éå",normalizedTitle:"3.2.3. æ³¨åä¸­å¿éå",charIndex:2039},{level:5,title:"3.2.3.1. é«å¯ç¨æ§",slug:"_3-2-3-1-é«å¯ç¨æ§",normalizedTitle:"3.2.3.1. é«å¯ç¨æ§",charIndex:2056},{level:5,title:"3.2.3.2. æ°æ®ä¸è´æ§",slug:"_3-2-3-2-æ°æ®ä¸è´æ§",normalizedTitle:"3.2.3.2. æ°æ®ä¸è´æ§",charIndex:2122},{level:3,title:"3.3. æå¡æ³¨ååç°çé®é¢",slug:"_3-3-æå¡æ³¨ååç°çé®é¢",normalizedTitle:"3.3. æå¡æ³¨ååç°çé®é¢",charIndex:2635},{level:4,title:"3.3.1. å¤æ³¨åä¸­å¿",slug:"_3-3-1-å¤æ³¨åä¸­å¿",normalizedTitle:"3.3.1. å¤æ³¨åä¸­å¿",charIndex:2653},{level:4,title:"3.3.2. å¹¶è¡è®¢éæå¡",slug:"_3-3-2-å¹¶è¡è®¢éæå¡",normalizedTitle:"3.3.2. å¹¶è¡è®¢éæå¡",charIndex:2725},{level:4,title:"3.3.3. æ¹éæ³¨éæå¡",slug:"_3-3-3-æ¹éæ³¨éæå¡",normalizedTitle:"3.3.3. æ¹éæ³¨éæå¡",charIndex:2853},{level:4,title:"3.3.4. æå¡åæ´ä¿¡æ¯åæ­¥æ´æ°",slug:"_3-3-4-æå¡åæ´ä¿¡æ¯åæ­¥æ´æ°",normalizedTitle:"3.3.4. æå¡åæ´ä¿¡æ¯åæ­¥æ´æ°",charIndex:2929},{level:3,title:"3.4. è¯å«æå¡èç¹æ¯å¦å­æ´»",slug:"_3-4-è¯å«æå¡èç¹æ¯å¦å­æ´»",normalizedTitle:"3.4. è¯å«æå¡èç¹æ¯å¦å­æ´»",charIndex:3073},{level:4,title:"3.4.1. å¿è·³å¼å³ä¿æ¤æºå¶",slug:"_3-4-1-å¿è·³å¼å³ä¿æ¤æºå¶",normalizedTitle:"3.4.1. å¿è·³å¼å³ä¿æ¤æºå¶",charIndex:3092},{level:4,title:"3.4.2. æå¡èç¹æé¤ä¿æ¤æºå¶",slug:"_3-4-2-æå¡èç¹æé¤ä¿æ¤æºå¶",normalizedTitle:"3.4.2. æå¡èç¹æé¤ä¿æ¤æºå¶",charIndex:3588},{level:2,title:"4. æå¡éä¿¡",slug:"_4-æå¡éä¿¡",normalizedTitle:"4. æå¡éä¿¡",charIndex:4136},{level:3,title:"4.1. åºååæ¹å¼",slug:"_4-1-åºååæ¹å¼",normalizedTitle:"4.1. åºååæ¹å¼",charIndex:4554},{level:3,title:"4.2. éä¿¡åè®®",slug:"_4-2-éä¿¡åè®®",normalizedTitle:"4.2. éä¿¡åè®®",charIndex:4639},{level:2,title:"5. æå¡çæ§",slug:"_5-æå¡çæ§",normalizedTitle:"5. æå¡çæ§",charIndex:5072},{level:3,title:"5.1. çæ§å¯¹è±¡",slug:"_5-1-çæ§å¯¹è±¡",normalizedTitle:"5.1. çæ§å¯¹è±¡",charIndex:5206},{level:3,title:"5.2. ç³»ç»çæ§åç",slug:"_5-2-ç³»ç»çæ§åç",normalizedTitle:"5.2. ç³»ç»çæ§åç",charIndex:5427},{level:4,title:"5.2.1. æ°æ®éé",slug:"_5-2-1-æ°æ®éé",normalizedTitle:"5.2.1. æ°æ®éé",charIndex:5501},{level:4,title:"5.2.2. æ°æ®ä¼ è¾",slug:"_5-2-2-æ°æ®ä¼ è¾",normalizedTitle:"5.2.2. æ°æ®ä¼ è¾",charIndex:5718},{level:4,title:"5.2.3. æ°æ®å¤ç",slug:"_5-2-3-æ°æ®å¤ç",normalizedTitle:"5.2.3. æ°æ®å¤ç",charIndex:5937},{level:4,title:"5.2.4. æ°æ®å±ç¤º",slug:"_5-2-4-æ°æ®å±ç¤º",normalizedTitle:"5.2.4. æ°æ®å±ç¤º",charIndex:6286},{level:3,title:"5.3. çæ§ææ¯",slug:"_5-3-çæ§ææ¯",normalizedTitle:"5.3. çæ§ææ¯",charIndex:6364},{level:2,title:"6. æå¡æ²»ç",slug:"_6-æå¡æ²»ç",normalizedTitle:"6. æå¡æ²»ç",charIndex:6691},{level:2,title:"7. API ç½å³",slug:"_7-api-ç½å³",normalizedTitle:"7. api ç½å³",charIndex:7143},{level:3,title:"7.1. Zuul",slug:"_7-1-zuul",normalizedTitle:"7.1. zuul",charIndex:7383},{level:2,title:"8. è´è½½åè¡¡",slug:"_8-è´è½½åè¡¡",normalizedTitle:"8. è´è½½åè¡¡",charIndex:7855},{level:2,title:"9. æå¡è·¯ç±",slug:"_9-æå¡è·¯ç±",normalizedTitle:"9. æå¡è·¯ç±",charIndex:7882},{level:3,title:"9.1. æå¡è·¯ç±çåºç¨åºæ¯",slug:"_9-1-æå¡è·¯ç±çåºç¨åºæ¯",normalizedTitle:"9.1. æå¡è·¯ç±çåºç¨åºæ¯",charIndex:7945},{level:3,title:"9.2. æå¡è·¯ç±çè§å",slug:"_9-2-æå¡è·¯ç±çè§å",normalizedTitle:"9.2. æå¡è·¯ç±çè§å",charIndex:8439},{level:4,title:"9.2.1. æ¡ä»¶è·¯ç±",slug:"_9-2-1-æ¡ä»¶è·¯ç±",normalizedTitle:"9.2.1. æ¡ä»¶è·¯ç±",charIndex:8485},{level:4,title:"9.2.2. èæ¬è·¯ç±",slug:"_9-2-2-èæ¬è·¯ç±",normalizedTitle:"9.2.2. èæ¬è·¯ç±",charIndex:10120},{level:3,title:"9.3. æå¡è·¯ç±çè·åæ¹å¼",slug:"_9-3-æå¡è·¯ç±çè·åæ¹å¼",normalizedTitle:"9.3. æå¡è·¯ç±çè·åæ¹å¼",charIndex:10738},{level:3,title:"9.4. åé¨æå¡è°ç¨",slug:"_9-4-åé¨æå¡è°ç¨",normalizedTitle:"9.4. åé¨æå¡è°ç¨",charIndex:11033},{level:3,title:"9.5. å¤é¨æå¡è°ç¨",slug:"_9-5-å¤é¨æå¡è°ç¨",normalizedTitle:"9.5. å¤é¨æå¡è°ç¨",charIndex:11213},{level:2,title:"10. éç½®ä¸­å¿",slug:"_10-éç½®ä¸­å¿",normalizedTitle:"10. éç½®ä¸­å¿",charIndex:11621},{level:3,title:"10.1. Apollo",slug:"_10-1-apollo",normalizedTitle:"10.1. apollo",charIndex:11822},{level:3,title:"10.2. Spring Cloud Git",slug:"_10-2-spring-cloud-git",normalizedTitle:"10.2. spring cloud git",charIndex:11917},{level:2,title:"11. é¾è·¯è¿½è¸ª",slug:"_11-é¾è·¯è¿½è¸ª",normalizedTitle:"11. é¾è·¯è¿½è¸ª",charIndex:12032},{level:3,title:"11.1. é¾è·¯è¿½è¸ªçä½ç¨",slug:"_11-1-é¾è·¯è¿½è¸ªçä½ç¨",normalizedTitle:"11.1. é¾è·¯è¿½è¸ªçä½ç¨",charIndex:12045},{level:3,title:"11.2. é¾è·¯è¿½è¸ªçåç",slug:"_11-2-é¾è·¯è¿½è¸ªçåç",normalizedTitle:"11.2. é¾è·¯è¿½è¸ªçåç",charIndex:12104},{level:3,title:"11.3. é¾è·¯è¿½è¸ªçå®ç°",slug:"_11-3-é¾è·¯è¿½è¸ªçå®ç°",normalizedTitle:"11.3. é¾è·¯è¿½è¸ªçå®ç°",charIndex:12577},{level:4,title:"11.3.1. æ°æ®ééå±",slug:"_11-3-1-æ°æ®ééå±",normalizedTitle:"11.3.1. æ°æ®ééå±",charIndex:12676},{level:4,title:"11.3.2. æ°æ®å¤çå±",slug:"_11-3-2-æ°æ®å¤çå±",normalizedTitle:"11.3.2. æ°æ®å¤çå±",charIndex:13070},{level:4,title:"11.3.3. æ°æ®å±ç¤ºå±",slug:"_11-3-3-æ°æ®å±ç¤ºå±",normalizedTitle:"11.3.3. æ°æ®å±ç¤ºå±",charIndex:13343},{level:3,title:"11.4. é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯",slug:"_11-4-é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯",normalizedTitle:"11.4. é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯",charIndex:13431},{level:2,title:"12. éæµçæ­",slug:"_12-éæµçæ­",normalizedTitle:"12. éæµçæ­",charIndex:13452},{level:3,title:"12.1. éæµ",slug:"_12-1-éæµ",normalizedTitle:"12.1. éæµ",charIndex:13658},{level:3,title:"12.2. éçº§",slug:"_12-2-éçº§",normalizedTitle:"12.2. éçº§",charIndex:14228},{level:2,title:"13. DEVOPS",slug:"_13-devops",normalizedTitle:"13. devops",charIndex:14880},{level:3,title:"13.1. å®¹å¨åå®¹å¨å¹³å°",slug:"_13-1-å®¹å¨åå®¹å¨å¹³å°",normalizedTitle:"13.1. å®¹å¨åå®¹å¨å¹³å°",charIndex:14895},{level:2,title:"14. RPC éå",slug:"_14-rpc-éå",normalizedTitle:"14. rpc éå",charIndex:14940},{level:3,title:"14.1. éå®è¯­è¨ RPC",slug:"_14-1-éå®è¯­è¨-rpc",normalizedTitle:"14.1. éå®è¯­è¨ rpc",charIndex:14955},{level:3,title:"14.2. è·¨è¯­è¨ RPC",slug:"_14-2-è·¨è¯­è¨-rpc",normalizedTitle:"14.2. è·¨è¯­è¨ rpc",charIndex:15674},{level:2,title:"15. Service Mesh",slug:"_15-service-mesh",normalizedTitle:"15. service mesh",charIndex:16306},{level:3,title:"15.1. Service Mesh çå®ç°åç",slug:"_15-1-service-mesh-çå®ç°åç",normalizedTitle:"15.1. service mesh çå®ç°åç",charIndex:16329},{level:2,title:"16. åèèµæ",slug:"_16-åèèµæ",normalizedTitle:"16. åèèµæ",charIndex:16522}],headersStr:"1. å¾®æå¡ç®ä» 1.1. ä»ä¹æ¯å¾®æå¡æ¶æ 1.2. å¦ä½æè¡¡å¾®æå¡çå©å¼ 1.3. åº·å¨å®å¾ 1.4. å¦ä½æåå¾®æå¡ 2. å¾®æå¡ææ¯æ¶æ 3. æå¡æ³¨ååç° 3.1. æ³¨åä¸­å¿çå·¥ä½æµç¨ 3.2. æ³¨åä¸­å¿å®ç°æ¨¡å¼ 3.2.1. åºç¨åæ³¨åååç° 3.2.2. åºç¨å¤æ³¨åååç° 3.2.3. æ³¨åä¸­å¿éå 3.2.3.1. é«å¯ç¨æ§ 3.2.3.2. æ°æ®ä¸è´æ§ 3.3. æå¡æ³¨ååç°çé®é¢ 3.3.1. å¤æ³¨åä¸­å¿ 3.3.2. å¹¶è¡è®¢éæå¡ 3.3.3. æ¹éæ³¨éæå¡ 3.3.4. æå¡åæ´ä¿¡æ¯åæ­¥æ´æ° 3.4. è¯å«æå¡èç¹æ¯å¦å­æ´» 3.4.1. å¿è·³å¼å³ä¿æ¤æºå¶ 3.4.2. æå¡èç¹æé¤ä¿æ¤æºå¶ 4. æå¡éä¿¡ 4.1. åºååæ¹å¼ 4.2. éä¿¡åè®® 5. æå¡çæ§ 5.1. çæ§å¯¹è±¡ 5.2. ç³»ç»çæ§åç 5.2.1. æ°æ®éé 5.2.2. æ°æ®ä¼ è¾ 5.2.3. æ°æ®å¤ç 5.2.4. æ°æ®å±ç¤º 5.3. çæ§ææ¯ 6. æå¡æ²»ç 7. API ç½å³ 7.1. Zuul 8. è´è½½åè¡¡ 9. æå¡è·¯ç± 9.1. æå¡è·¯ç±çåºç¨åºæ¯ 9.2. æå¡è·¯ç±çè§å 9.2.1. æ¡ä»¶è·¯ç± 9.2.2. èæ¬è·¯ç± 9.3. æå¡è·¯ç±çè·åæ¹å¼ 9.4. åé¨æå¡è°ç¨ 9.5. å¤é¨æå¡è°ç¨ 10. éç½®ä¸­å¿ 10.1. Apollo 10.2. Spring Cloud Git 11. é¾è·¯è¿½è¸ª 11.1. é¾è·¯è¿½è¸ªçä½ç¨ 11.2. é¾è·¯è¿½è¸ªçåç 11.3. é¾è·¯è¿½è¸ªçå®ç° 11.3.1. æ°æ®ééå± 11.3.2. æ°æ®å¤çå± 11.3.3. æ°æ®å±ç¤ºå± 11.4. é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯ 12. éæµçæ­ 12.1. éæµ 12.2. éçº§ 13. DEVOPS 13.1. å®¹å¨åå®¹å¨å¹³å° 14. RPC éå 14.1. éå®è¯­è¨ RPC 14.2. è·¨è¯­è¨ RPC 15. Service Mesh 15.1. Service Mesh çå®ç°åç 16. åèèµæ",content:'# å¾®æå¡åºæ¬åç\n\n\n# 1. å¾®æå¡ç®ä»\n\n\n# 1.1. ä»ä¹æ¯å¾®æå¡æ¶æ\n\näºèç½åºç¨æ¶æå¤§è´çæ¼è¿æ¹åä¸ºï¼åä½æ¶æ -> æå¡åæ¶æ -> å¾®æå¡æ¶æã\n\nå¾®æå¡æ¶æçç¹ç¹ï¼\n\n * æå¡æåç²åº¦æ´ç»ï¼æ ¹æ®ä¸å¡æåã\n * ç¬ç«é¨ç½²ï¼æ¯ä¸ªæå¡é¨ç½²å¨ç©çä¸éç¦»ï¼äºä¸å½±åã\n * ç¬ç«ç»´æ¤ï¼æ ¹æ®ç»ç»æ¶ææåï¼åå¢éç»´æ¤ã\n * æå¡æ²»çï¼æå¡æ°éåå¤ï¼éè¦æç»ä¸çæå¡æ²»çå¹³å°ã\n\n\n# 1.2. å¦ä½æè¡¡å¾®æå¡çå©å¼\n\nä¼ç¹\n\n * å¼ºæ¨¡ååè¾¹ç\n * å¯ç¬ç«é¨ç½²\n * ææ¯å¤æ ·æ§\n\nç¼ºç¹\n\n * åå¸å¼å¤æåº¦\n * æç»ä¸è´æ§\n * è¿ç»´å¤æåº¦\n * æµè¯å¤æåº¦\n\n\n# 1.3. åº·å¨å®å¾\n\n * ç¬¬ä¸å®å¾ï¼ç»ç»æ²éæ¹å¼ä¼éè¿ç³»ç»è®¾è®¡è¡¨è¾¾åºæ¥\n * ç¬¬äºå®å¾ï¼æ¶é´åå¤ä¸ä»¶äºæä¹ä¸å¯è½åçå®ç¾ï¼ä½æ»ææ¶é´åå®ä¸ä»¶äºæ\n * ç¬¬ä¸å®å¾ï¼çº¿åç³»ç»åçº¿åç»ç»æ¶æé´ææ½å¨çå¼è´¨åæç¹æ§\n * ç¬¬åå®å¾ï¼å¤§çç³»ç»ç»ç»æ»æ¯æ¯å°ç³»ç»æ´å¾åäºåè§£\n\n\n# 1.4. å¦ä½æåå¾®æå¡\n\nåºç¨å¾®æå¡åæ¶æåï¼è¦æèå ä¸ªé®é¢ï¼\n\nä»ä¹æ¶åè¿è¡æå¡åæåï¼å¦ä½æåæå¡ï¼\n\nå½åºç¨å¤æåº¦ãå¼åå¢éè¨èå°é¾ä»¥ç»´æ¤æ¶ï¼å°±è¯¥èèæå¡åæåäºã\n\næåæå¡çæèç»´åº¦ï¼\n\n * ä¸å¡ç»´åº¦ï¼ä¸å¡åæ°æ®å³ç³»å¯åçåºè¯¥æ¾å¨ä¸èµ·ã\n * åè½ç»´åº¦ï¼å¬å±åè½èåä¸ºä¸ä¸ªæå¡ã\n * ç»ç»æ¶æï¼æ ¹æ®å®éç»ç»æ¶æï¼å¤©ç¶åä¸ºä¸åçå¢éï¼æ¯ä¸ªå¢éç¬ç«ç»´æ¤è¥å¹²å¾®æå¡ã\n\næåæå¡çåç½®æ¡ä»¶ï¼\n\nåºç¨å¾®æå¡æ¶æè¦åè§£å³ä»¥ä¸é®é¢ï¼\n\n * æå¡å¦ä½å®\n * æå¡å¦ä½åå¸åè®¢é\n * æå¡å¦ä½çæ§\n * æå¡å¦ä½æ²»ç\n * æéå¦ä½å®ä½\n\n\n# 2. å¾®æå¡ææ¯æ¶æ\n\n\n\nç¬¬ä¸å±ï¼æ¥å¥å±\n\nå¤é¨è®¾å¤è®¿é®çç»ä¸æ¥å¥å±ã\n\nç¬¬äºå±ï¼èåæå¡å±\n\nå¯¹ä¸å±çåºç¡æå¡åä¸äºèåï¼åªè£çå·¥ä½ï¼ééä¸å±ä¸åè®¾å¤çæ°æ®è¾åºã\n\nç¬¬ä¸å±ï¼åºç¡æå¡å±\n\næ¯è¾ç»ç²åº¦çå¾®æå¡å±ï¼æä¾åºç¡çæ ¸å¿æå¡ï¼å¬å±æå¡ã\n\n\n\n\n# 3. æå¡æ³¨ååç°\n\nå¨å¾®æå¡æ¶æä¸ï¼ä¸»è¦æä¸ç§è§è²ï¼\n\n * æå¡æä¾èï¼RPC Server / Providerï¼\n * æå¡æ¶è´¹èï¼RPC Client / Consumerï¼\n * æå¡æ³¨åä¸­å¿ï¼Registryï¼\n\næ³¨åä¸­å¿çå®ç°ä¾èµä»¥ä¸æºå¶ï¼\n\n * æ³¨åä¸­å¿ API\n * éç¾¤é¨ç½²ï¼å¦ææ³¨åä¸­å¿æ¯åç¹ï¼æ æ³ä¿éé«å¯ç¨ã\n * åæ°æ®å­å¨ï¼ä¾å¦ ZooKeeper å°æ°æ®ä»¥å±æ¬¡åçç®å½ç»æå­å¨ã\n * æå¡å¥åº·æ£æ¥ï¼ä½¿ç¨é¿è¿æ¥æå¿è·³æ¢æµæ¹å¼æ£æ¥æå¡å¥åº·ç¶æã\n * æå¡ç¶æåæ´éç¥ï¼å¯ä»¥åºäºè®¢éèæ¨¡å¼å®ç°ï¼ä¾å¦ ZooKeeper ç Watch æºå¶ã\n * ç½ååæºå¶\n\næ³¨åä¸­å¿çæå¡æ³¨åååç°é½æ¯åºäº API çãä¸è¬éè¦æ¯æä»¥ä¸åè½ï¼\n\n * æå¡æ³¨å\n * æå¡æ³¨é\n * æ¥å£ç»­çº¦ï¼å¿è·³ï¼\n * æå¡è®¢é\n * å¯ç¨æå¡åæ­¥\n * æå¡æ¥è¯¢\n * æå¡ä¿®æ¹\n\n\n# 3.1. æ³¨åä¸­å¿çå·¥ä½æµç¨\n\nä¸è¬æ¥è®²ï¼æ³¨åä¸­å¿çå·¥ä½æµç¨æ¯ï¼\n\n * æå¡æä¾èå¨å¯å¨æ¶ï¼æ ¹æ®æå¡åå¸æä»¶ä¸­éç½®çåå¸ä¿¡æ¯åæ³¨åä¸­å¿æ³¨åèªå·±çæå¡ã\n * æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼æ ¹æ®æ¶è´¹èéç½®æä»¶ä¸­éç½®çæå¡ä¿¡æ¯åæ³¨åä¸­å¿è®¢éèªå·±æéè¦çæå¡ã\n * æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æå¡æ¶è´¹èã\n * å½æå¡æä¾èåçååï¼æ¯å¦æèç¹æ°å¢æèéæ¯ï¼æ³¨åä¸­å¿å°åæ´éç¥ç»æå¡æ¶è´¹èã\n\n\n# 3.2. æ³¨åä¸­å¿å®ç°æ¨¡å¼\n\n# 3.2.1. åºç¨åæ³¨åååç°\n\néç¨åºç¨åæ³¨åä¸åç°çæ¹å¼ï¼æå¸åçæ¡ä¾è¦å± Netflix å¼æºç Eurekaï¼å®æ¹æ¶æå¾å¦ä¸ã\n\n\n\nå¯¹çè¿å¼ å¾ï¼ææ¥ä»ç»ä¸ Eureka çæ¶æï¼å®ä¸»è¦ç±ä¸ä¸ªéè¦çç»ä»¶ç»æï¼\n\n * Eureka Serverï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°äºæå¡ä¿¡æ¯æ³¨åãå­å¨ä»¥åæ¥è¯¢ç­åè½ã\n * æå¡ç«¯ç Eureka Clientï¼éæå¨æå¡ç«¯çæ³¨åä¸­å¿ SDKï¼æå¡æä¾èéè¿è°ç¨ SDKï¼å®ç°æå¡æ³¨åãåæ³¨åç­åè½ã\n * å®¢æ·ç«¯ç Eureka Clientï¼éæå¨å®¢æ·ç«¯çæ³¨åä¸­å¿ SDKï¼æå¡æ¶è´¹èéè¿è°ç¨ SDKï¼å®ç°æå¡è®¢éãæå¡æ´æ°ç­åè½ã\n\n# 3.2.2. åºç¨å¤æ³¨åååç°\n\n\n\néè¿è¿å¼ æ¶æå¾ï¼å¯ä»¥çåºæ¥ä½¿ç¨ Consul å®ç°åºç¨å¤æå¡æ³¨åååç°ä¸»è¦ä¾é ä¸ä¸ªéè¦çç»ä»¶ï¼\n\n * Consulï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°æå¡æ³¨åä¿¡æ¯çå­å¨ï¼å¹¶æä¾æ³¨åååç°æå¡ã\n * Registratorï¼ä¸ä¸ªå¼æºçç¬¬ä¸æ¹æå¡ç®¡çå¨é¡¹ç®ï¼å®éè¿çå¬æå¡é¨ç½²ç Docker å®ä¾æ¯å¦å­æ´»ï¼æ¥è´è´£æå¡æä¾èçæ³¨ååéæ¯ã\n * Consul Templateï¼å®æ¶ä»æ³¨åä¸­å¿æå¡ç«¯è·åææ°çæå¡æä¾èèç¹åè¡¨å¹¶å·æ° LB éç½®ï¼æ¯å¦ Nginx ç upstreamï¼ï¼è¿æ ·æå¡æ¶è´¹èå°±éè¿è®¿é® Nginx å°±å¯ä»¥è·åææ°çæå¡æä¾èä¿¡æ¯ã\n\n# 3.2.3. æ³¨åä¸­å¿éå\n\n# 3.2.3.1. é«å¯ç¨æ§\n\néç¾¤é¨ç½²ï¼éè¿é¨ç½²å¤ä¸ªå®ä¾ç»æéç¾¤æ¥ä¿è¯é«å¯ç¨æ§ã\n\nå¤ IDC é¨ç½²ï¼å³é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ã\n\n# 3.2.3.2. æ°æ®ä¸è´æ§\n\næ ¹æ® CAP çè®ºï¼ä¸èä¸è½åæ¶æ»¡è¶³ï¼\n\n * CP åæ³¨åä¸­å¿ï¼çºç²å¯ç¨æ§æ¥ä¿è¯æ°æ®å¼ºä¸è´æ§ï¼æå¸åçä¾å­å°±æ¯ ZooKeeperï¼etcdï¼Consul äºãZooKeeper éç¾¤ååªæä¸ä¸ª Leaderï¼èä¸å¨ Leader æ æ³ä½¿ç¨çæ¶åéè¿ Paxos ç®æ³éä¸¾åºä¸ä¸ªæ°ç Leaderãè¿ä¸ª Leader çç®çå°±æ¯ä¿è¯åä¿¡æ¯çæ¶ååªåè¿ä¸ª Leader åå¥ï¼Leader ä¼åæ­¥ä¿¡æ¯å° Followersï¼è¿ä¸ªè¿ç¨å°±å¯ä»¥ä¿è¯æ°æ®çå¼ºä¸è´æ§ãä½å¦æå¤ä¸ª ZooKeeper ä¹é´ç½ç»åºç°é®é¢ï¼é æåºç°å¤ä¸ª Leaderï¼åçèè£çè¯ï¼æ³¨åä¸­å¿å°±ä¸å¯ç¨äºãè etcd å Consul éç¾¤åé½æ¯éè¿ raft åè®®æ¥ä¿è¯å¼ºä¸è´æ§ï¼å¦æåºç°èè£çè¯ï¼ æ³¨åä¸­å¿ä¹ä¸å¯ç¨ã\n * AP åæ³¨åä¸­å¿ï¼çºç²ä¸è´æ§æ¥ä¿è¯å¯ç¨æ§ï¼æå¸åçä¾å­å°±æ¯ Eureka äºãå¯¹æ¯ä¸ Zookeeperï¼Eureka ä¸ç¨éä¸¾ä¸ä¸ª Leaderï¼æ¯ä¸ª Eureka æå¡å¨åç¬ä¿å­æå¡æ³¨åå°åï¼å æ­¤æå¯è½åºç°æ°æ®ä¿¡æ¯ä¸ä¸è´çæåµãä½æ¯å½ç½ç»åºç°é®é¢çæ¶åï¼æ¯å°æå¡å¨é½å¯ä»¥å®æç¬ç«çæå¡ã\n\n\n# 3.3. æå¡æ³¨ååç°çé®é¢\n\n# 3.3.1. å¤æ³¨åä¸­å¿\n\nå¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼è¦è½å¤åæ¶ä»å¤ä¸ªæ³¨åä¸­å¿è®¢éæå¡ï¼å¯¹äºæå¡æä¾èæ¥è¯´ï¼è¦è½å¤åæ¶åå¤ä¸ªæ³¨åä¸­å¿æ³¨åæå¡ã\n\n# 3.3.2. å¹¶è¡è®¢éæå¡\n\nå¯ä»¥æ¯è®¢éä¸ä¸ªæå¡å°±åç¬ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çï¼è¿æ ·çè¯å³ä½¿éå°ä¸ªå«æå¡èç¹è¿æ¥è¶æ¶ï¼å¶ä»æå¡èç¹çåå§åè¿æ¥ä¹ä¸åå½±åï¼ææ¢ä¹å°±æ¯è¿ä¸ªæå¡èç¹çåå§åè¿æ¥èè´¹çæ¶é´ï¼æç»æææå¡èç¹çåå§åè¿æ¥èæ¶æ§å¶å¨äº 30 ç§ä»¥åã\n\n# 3.3.3. æ¹éæ³¨éæå¡\n\néè¦å®æ¶å»æ¸çæ³¨åä¸­å¿ä¸­çâåµå°¸èç¹âï¼å¦ææ¯ææ¹éæ³¨éæå¡ï¼å°±å¯ä»¥ä¸æ¬¡è°ç¨å°±æè¯¥èç¹ä¸æä¾çæææå¡åæ¶æ³¨éæã\n\n# 3.3.4. æå¡åæ´ä¿¡æ¯åæ­¥æ´æ°\n\nä¸ºäºåå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿ä¸­æåçæå¡å¯ç¨èç¹ä¿¡æ¯çæ°æ®éï¼è¿ä¸ªæ¶åå¯ä»¥éè¿å¢éæ´æ°çæ¹å¼ï¼æ³¨åä¸­å¿åªè¿åååçé£é¨åèç¹ä¿¡æ¯ï¼å°¤å¶å¨åªæå°æ°èç¹ä¿¡æ¯åæ´æ¶ï¼æ­¤ä¸¾å¯ä»¥å¤§å¤§åå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿æåçæ°æ®éï¼ä»èæå¤§ç¨åº¦é¿åäº§çç½ç»é£æ´ã\n\n\n# 3.4. è¯å«æå¡èç¹æ¯å¦å­æ´»\n\n# 3.4.1. å¿è·³å¼å³ä¿æ¤æºå¶\n\nå¨ç½ç»é¢ç¹æå¨çæåµä¸ï¼æ³¨åä¸­å¿ä¸­å¯ç¨çèç¹ä¼ä¸æ­ååï¼è¿æ¶åæå¡æ¶è´¹èä¼é¢ç¹æ¶å°æå¡æä¾èèç¹åæ´çä¿¡æ¯ï¼äºæ¯å°±ä¸æ­å°è¯·æ±æ³¨åä¸­å¿æ¥æåææ°çå¯ç¨æå¡èç¹ä¿¡æ¯ãå½ææç¾ä¸åä¸ªæå¡æ¶è´¹èï¼åæ¶è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡æä¾èçèç¹ä¿¡æ¯æ¶ï¼å¯è½ä¼ææ³¨åä¸­å¿çå¸¦å®½ç»å æ»¡ï¼å°¤å¶æ¯æ³¨åä¸­å¿æ¯ç¾åç½å¡çæåµä¸ã\n\næä»¥éå¯¹è¿ç§æåµï¼éè¦ä¸ç§ä¿æ¤æºå¶ï¼å³ä½¿å¨ç½ç»é¢ç¹æå¨çæ¶åï¼æå¡æ¶è´¹èä¹ä¸è³äºåæ¶å»è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nææ¾ç»å°±éå°è¿è¿ç§æåµï¼ä¸ä¸ªå¯è¡çè§£å³æ¹æ¡å°±æ¯ç»æ³¨åä¸­å¿è®¾ç½®ä¸ä¸ªå¼å³ï¼å½å¼å³æå¼æ¶ï¼å³ä½¿ç½ç»é¢ç¹æå¨ï¼æ³¨åä¸­å¿ä¹ä¸ä¼éç¥ææçæå¡æ¶è´¹èææå¡èç¹ä¿¡æ¯åæ´ï¼æ¯å¦åªç» 10% çæå¡æ¶è´¹èè¿ååæ´ï¼è¿æ ·çè¯å°±è½å°æ³¨åä¸­å¿çè¯·æ±éåå°å°åæ¥ç 1/10ã\n\nå½ç¶æå¼è¿ä¸ªå¼å³ä¹æ¯æä¸å®ä»£ä»·çï¼å®ä¼å¯¼è´æå¡æ¶è´¹èæç¥ææ°çæå¡èç¹ä¿¡æ¯å»¶è¿ï¼ååå¯è½å¨ 10s åå°±è½æç¥å°æå¡æä¾èèç¹ä¿¡æ¯çåæ´ï¼ç°å¨å¯è½ä¼å»¶è¿å°å åéï¼æä»¥å¨ç½ç»æ­£å¸¸çæåµä¸ï¼å¼å³å¹¶ä¸éåæå¼ï¼å¯ä»¥ä½ä¸ºä¸ä¸ªç´§æ¥æªæ½ï¼å¨ç½ç»é¢ç¹æå¨çæ¶åï¼ææå¼è¿ä¸ªå¼å³ã\n\n# 3.4.2. æå¡èç¹æé¤ä¿æ¤æºå¶\n\næå¡æä¾èå¨è¿ç¨å¯å¨æ¶ï¼ä¼æ³¨åæå¡å°æ³¨åä¸­å¿ï¼å¹¶æ¯éä¸æ®µæ¶é´ï¼æ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼ä»¥æ è¯èªå·±çå­æ´»ç¶æãå¦æéäºä¸æ®µåºå®æ¶é´åï¼æå¡æä¾èä»ç¶æ²¡ææ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼æ³¨åä¸­å¿å°±ä¼è®¤ä¸ºè¯¥èç¹å·²ç»å¤äºâdeadâç¶æï¼äºæ¯ä»æå¡çå¯ç¨èç¹ä¿¡æ¯ä¸­ç§»é¤åºå»ã\n\nå¦æéå°ç½ç»é®é¢ï¼å¤§æ¹æå¡æä¾èèç¹æ±æ¥ç»æ³¨åä¸­å¿çå¿è·³ä¿¡æ¯é½å¯è½ä¼ä¼ è¾¾å¤±è´¥ï¼æ³¨åä¸­å¿å°±ä¼æå®ä»¬é½ä»å¯ç¨èç¹åè¡¨ä¸­ç§»é¤åºå»ï¼é æå©ä¸çå¯ç¨èç¹é¾ä»¥æ¿åææçè°ç¨ï¼å¼èµ·âéªå´©âãä½æ¯è¿ç§æåµä¸ï¼å¯è½å¤§é¨åæå¡æä¾èèç¹æ¯å¯ç¨çï¼ä»ä»å ä¸ºç½ç»åå æ æ³æ±æ¥å¿è·³ç»æ³¨åä¸­å¿å°±è¢«âæ æâçæé¤äºã\n\nè¿ä¸ªæ¶åå°±éè¦æ ¹æ®å®éä¸å¡çæåµï¼è®¾å®ä¸ä¸ªéå¼æ¯ä¾ï¼å³ä½¿éå°åæè¯´çè¿ç§æåµï¼æ³¨åä¸­å¿ä¹ä¸è½æé¤è¶è¿è¿ä¸ªéå¼æ¯ä¾çèç¹ã\n\nè¿ä¸ªéå¼æ¯ä¾å¯ä»¥æ ¹æ®å®éä¸å¡çåä½åº¦æ¥ç¡®å®ï¼æéå¸¸ä¼æè¿ä¸ªæ¯ä¾è®¾å®å¨ 20%ï¼å°±æ¯è¯´æ³¨åä¸­å¿ä¸è½æé¤è¶è¿ 20% çèç¹ãå ä¸ºå¤§é¨åæåµä¸ï¼èç¹çååä¸ä¼è¿ä¹é¢ç¹ï¼åªæå¨ç½ç»æå¨æèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµä¸ææå¯è½åçãèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµæ¯å¯ä»¥é¢ç¥çï¼è¿ç§æåµä¸å¯ä»¥å³é­éå¼ä¿æ¤ï¼èæ­£å¸¸æåµä¸ï¼åºè¯¥æå¼éå¼ä¿æ¤ï¼ä»¥é²æ­¢ç½ç»æå¨æ¶ï¼å¤§æ¹éå¯ç¨çæå¡èç¹è¢«æé¤ã\n\n\n# 4. æå¡éä¿¡\n\néè¿æ³¨åä¸­å¿ï¼æå¡æ¶è´¹èåæå¡æä¾èå°±å¯ä»¥æç¥å½¼æ­¤ï¼ä½æ¯ï¼è¦å®ç°äº¤äºè¿å¿é¡»è§£å³éä¿¡é®é¢ï¼\n\n * éä¿¡åè®®ãå³æå¡æä¾èåæå¡æ¶è´¹èä¹é´ä»¥ä»ä¹æ ·ç åè®® è¿è¡ç½ç»éä¿¡ï¼è¯´ç½äºï¼æ¯è¦è§£å³å®¢æ·ç«¯åæå¡ç«¯å¦ä½å»ºç«è¿æ¥ãç®¡çè¿æ¥ä»¥åæå¡ç«¯å¦ä½å¤çè¯·æ±çé®é¢ãæ¯éç¨åå± TCPãUDP åè®®ï¼è¿æ¯éç¨ä¸å± HTTP åè®®ï¼è¿æ¯éç¨å¶ä»åè®®ï¼ä¾å¦ï¼Dubbo åºäº TCP éä¿¡ï¼è Spring Cloud åºäº HTTP REST éä¿¡ãTCP éä¿¡æ¹å¼ï¼ä¼ è¾æçæ´é«ï¼ä½æ¯ HTTP æ¹å¼å¤©ç¶å¯ä»¥æä¾å¯¹å¤æå¡ã\n * ä¼ è¾æ¹å¼ãå³æå¡æä¾èåæå¡æ¶è´¹èä¹é´çæ°æ®ä¼ è¾éç¨åªç§æ¹å¼ãæ¯åæ­¥è¿æ¯å¼æ­¥ï¼æ¯å¨åè¿æ¥ä¸ä¼ è¾ï¼è¿æ¯å¤è·¯å¤ç¨ã\n * åºåååååºååãå®ä¸»è¦è§£å³å®¢æ·ç«¯åæå¡ç«¯éç¨åªç§æ°æ®ç¼è§£ç çé®é¢ãå¸¸è§çåºååæ¹å¼åæ¬ï¼XMLãJSONï¼äºè¿å¶ç±»å¦ï¼thriftãprotobufãhessianãJDKã\n\n\n# 4.1. åºååæ¹å¼\n\nåºååæ¹å¼çéåï¼ä¸è¬åºäºä»¥ä¸èèï¼\n\n * æ¯ææ°æ®ç»æç±»åçä¸°å¯åº¦\n * è·¨è¯­è¨æ¯æ\n * æ§è½\n\n> ð åèï¼Java åºåå\n\n\n# 4.2. éä¿¡åè®®\n\nå¾®æå¡æ¡æ¶å¯¹æ¯ï¼\n\n       RPC                                       REST\nè¦åæ§    å¼ºè¦å                                       æ¾æ£è¦å\nåè®®     Tcp                                       HttpãHttp2\nåºåå    äºè¿å¶ï¼ThriftãProtobufãHessianãAvroãJDK ç­ï¼   XmlãJson\næ§è½     é«                                         ä½\nå®¢æ·ç«¯    å¯¹ç¼ç¨è¯­è¨æéå¶                                  è·¨è¯­è¨æ¯ææ´å¥½ï¼æ¯æ Http å³å¯ï¼\nä»£è¡¨ææ¯   DubboãMotanãTarsãgRpcãThrift              Spring Cloud\n\n\n# 5. æå¡çæ§\n\nå½æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´å»ºç«äºéä¿¡ï¼ä½ä¸ºç®¡çèéè¦éè¿çæ§ææ®µæ¥è§å¯æå¡æ¯å¦æ­£å¸¸ï¼è°ç¨æ¯å¦æåãæå¡çæ§æ¯å¾å¤æçï¼å¨å¾®æå¡æ¶æä¸ï¼ä¸æ¬¡ç¨æ·è°ç¨ä¼å ä¸ºæå¡åæååï¼åæå¤ä¸ªä¸åæå¡ä¹é´çç¸äºè°ç¨ï¼è¿ä¹å°±éè¦å¯¹æååçæ¯ä¸ªæå¡é½çæ§èµ·æ¥ã\n\n\n# 5.1. çæ§å¯¹è±¡\n\næå¡çæ§ä¸å®æ¯éè¿è§å¯æ°æ®æ¥éååæï¼æä»¥é¦åè¦æç¡®éè¦çæ§ä»ä¹ã\n\nä¸è¬æ¥è¯´ï¼æå¡çæ§æ°æ®æä»¥ä¸åç±»ï¼\n\n * ä¸å¡çæ§ï¼æ ¸å¿ææ ãç»å½ãç»åºãä¸åãæ¯ä»ç­ã\n * åºç¨çæ§ï¼è®¿é®æ¥å£ãè®¿é®æå¡ãSQLãåå­ä½¿ç¨çãååºæ¶é´ãTPSãQPS ç­ã\n * ç³»ç»çæ§ï¼CPUãåå­ãç½ç»ãç£çç­ã\n * åºç¡çæ§ï¼ç½ç»æµéãä¸¢åæ°ãéåæ°ãè¿æ¥æ°ç­ã\n * å®¢æ·ç«¯çæ§ï¼æ§è½ãè¿åç ãå°åãè¿è¥åãçæ¬ãç³»ç»ç­ã\n\n\n# 5.2. ç³»ç»çæ§åç\n\nä¸æ¦æç¡®äºè¦çæ§çå¯¹è±¡ï¼æ¥ä¸å°±æ¯èèå¦ä½çæ§ã\n\nçæ§ç³»ç»ä¸»è¦åæ¬åä¸ªç¯èï¼æ°æ®ééãæ°æ®ä¼ è¾ãæ°æ®å¤çåæ°æ®å±ç¤º\n\n# 5.2.1. æ°æ®éé\n\néå¸¸æä¸¤ç§æ°æ®æ¶éæ¹å¼ï¼\n\n * æå¡ä¸»å¨ä¸æ¥ï¼è¿ç§å¤çæ¹å¼éè¿å¨ä¸å¡ä»£ç æèæå¡æ¡æ¶éå å¥æ°æ®æ¶éä»£ç é»è¾ï¼å¨æ¯ä¸æ¬¡æå¡è°ç¨å®æåï¼ä¸»å¨ä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãè¿ç§æ¹å¼å¨é¾è·¯è·è¸ªä¸­è¾ä¸ºå¸¸è§ï¼ä¸»æµçææ¯æ¹æ¡æï¼Zipkinã\n * ä»£çæ¶éï¼è¿ç§å¤çæ¹å¼éè¿æå¡è°ç¨åæè°ç¨çè¯¦ç»ä¿¡æ¯è®°å½å°æ¬å°æ¥å¿æä»¶ä¸­ï¼ç¶ååéè¿ä»£çå»è§£ææ¬å°æ¥å¿æä»¶ï¼ç¶ååä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãä¸»æµçææ¯æ¹æ¡æï¼ELKãFlumeã\n\n# 5.2.2. æ°æ®ä¼ è¾\n\næ°æ®ä¼ è¾æå¸¸ç¨çæ¹å¼æä¸¤ç§ï¼\n\n * UDP ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®å¤çååæä¾æå¡å¨çè¯·æ±å°åï¼æ°æ®ééåéè¿ UDP åè®®ä¸æå¡å¨å»ºç«è¿æ¥ï¼ç¶åææ°æ®åéè¿å»ã\n * Kafka ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®ééååéå°æå®ç Topicï¼ç¶åæ°æ®å¤çåååè®¢éå¯¹åºç Topicï¼å°±å¯ä»¥ä» Kafka æ¶æ¯éåä¸­è¯»åå°å¯¹åºçæ°æ®ãç±äº Kafka æéå¸¸é«çååè½åï¼æä»¥å¾éåä½ä¸ºå¤§æ°æ®éçç¼å²æ± ã\n\n# 5.2.3. æ°æ®å¤ç\n\næ°æ®å¤çæ¯å¯¹æ¶éæ¥çåå§æ°æ®è¿è¡èåå¹¶å­å¨ãæ°æ®èåéå¸¸æä¸¤ä¸ªç»´åº¦ï¼\n\n * æ¥å£ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§æ¥å£åç»´åº¦å®æ¶èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥å¾å°æ¯ä¸ªæ¥å£çæ¯ç§è¯·æ±éãå¹³åèæ¶ãæåçç­ä¿¡æ¯ã\n * æºå¨ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§è°ç¨çèç¹ç»´åº¦èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥ä»åæºç»´åº¦å»æ¥çæ¯ä¸ªæ¥å£çå®æ¶è¯·æ±éãå¹³åèæ¶ç­ä¿¡æ¯ã\n\nèååçæ°æ®éè¦æä¹åå°æ°æ®åºä¸­å­å¨ï¼æéç¨çæ°æ®åºä¸è¬åä¸ºä¸¤ç§ï¼\n\n * å¨ææ£ç´¢æ°æ®åºï¼æ¯å¦ Elasticsearchï¼ä»¥åæç´¢å¼çæ°æ®ç»æå­å¨ï¼éè¦æ¥è¯¢çæ¶åï¼æ ¹æ®ç´¢å¼æ¥æ¥è¯¢ã\n * æ¶åºæ°æ®åºï¼æ¯å¦ OpenTSDBï¼ä»¥æ¶åºåºåæ°æ®çæ¹å¼å­å¨ï¼æ¥è¯¢çæ¶åæç§æ¶åºå¦ 1minã5min ç­ç»´åº¦æ¥æ¥è¯¢ã\n\n# 5.2.4. æ°æ®å±ç¤º\n\næ°æ®å±ç¤ºæ¯æå¤çåçæ°æ®ä»¥ Dashboard çæ¹å¼å±ç¤ºç»ç¨æ·ãæ°æ®å±ç¤ºæå¤ç§æ¹å¼ï¼æ¯å¦æ²çº¿å¾ãé¥¼ç¶å¾ãæ ¼å­å¾å±ç¤ºç­ã\n\n\n# 5.3. çæ§ææ¯\n\n\n\n * ELK çææ¯æ æ¯è¾æçï¼åºç¨èå´ä¹æ¯è¾å¹¿ï¼é¤äºå¯ç¨ä½çæ§ç³»ç»å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿æ¥è¯¢ååæã\n * Graphite æ¯åºäºæ¶é´åºåæ°æ®åºå­å¨ççæ§ç³»ç»ï¼å¹¶ä¸æä¾äºåè½å¼ºå¤§çåç§èåå½æ°æ¯å¦ sumãaverageãtop5 ç­å¯ç¨äºçæ§åæï¼èä¸å¯¹å¤æä¾äº API ä¹å¯ä»¥æ¥å¥å¶ä»å¾å½¢åçæ§ç³»ç»å¦ Grafanaã\n * TICK çæ ¸å¿å¨äºå¶æ¶é´åºåæ°æ®åº InfluxDB çå­å¨åè½å¼ºå¤§ï¼ä¸æ¯æç±»ä¼¼ SQL è¯­è¨çå¤ææ°æ®å¤çæä½ã\n * Prometheus çç¬ç¹ä¹å¤å¨äºå®éç¨äºææ°æ®çæ¹å¼ï¼å¯¹ä¸å¡å½±åè¾å°ï¼åæ¶ä¹éç¨äºæ¶é´åºåæ°æ®åºå­å¨ï¼èä¸æ¯æç¬æç PromQL æ¥è¯¢è¯­è¨ï¼åè½å¼ºå¤§èä¸ç®æ´ã\n\n\n# 6. æå¡æ²»ç\n\nå¾®æå¡æ²»çå¹³å°å°±æ¯ä¸æå¡æäº¤éçç»ä¸å¥å£ï¼æ è®ºæ¯å¼åäººåè¿æ¯è¿ç»´äººåï¼é½è½éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡åç§æä½ï¼æ¯å¦å¼åäººåå¯ä»¥éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡éçº§æä½ï¼è¿ç»´äººåå¯ä»¥éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡ä¸ä¸çº¿æä½ï¼èä¸éè¦å³å¿è¿ä¸ªæä½èåçå·ä½å®ç°ã\n\nå¾®æå¡æ²»çå¹³å°å³é®ä¹å¤å°±å¨äºå®è½å¤å°è£å¯¹å¾®æå¡æ¶æåçåä¸ªåºç¡è®¾æ½ç»ä»¶çè°ç¨ï¼ä»èå¯¹å¤æä¾ç»ä¸çæå¡æä½ APIï¼èä¸è¿æä¾äºå¯è§åççé¢ï¼ä»¥æ¹ä¾¿å¼åäººååè¿ç»´äººåæä½ã\n\n\n\næå¡æ²»ççå¸¸ç¨ææ®µæï¼\n\n * èç¹ç®¡ç\n   * æ³¨åä¸­å¿ä¸»å¨æé¤æºå¶\n   * æå¡æ¶è´¹èæé¤æºå¶\n * è´è½½åè¡¡\n   * è½®è¯¢\n   * éæº\n   * æè¿æå°è¿æ¥\n   * ä¸è´æ§ Hash\n * æå¡è·¯ç±\n   * ä¸å¡å­å¨ç°åº¦åå¸çéæ±\n   * å¤æºæ¿å°±è¿è®¿é®çéæ±\n * æå¡å®¹é\n   * FailOverï¼å¤±è´¥èªå¨åæ¢\n   * FailBackï¼å¤±è´¥éç¥\n   * FailCacheï¼å¤±è´¥ç¼å­\n   * FailFastï¼å¿«éå¤±è´¥\n\n\n# 7. API ç½å³\n\nAPI ç½å³æ¯ä¸ä¸ªæå¡å¨ï¼æ¯ç³»ç»çå¯ä¸å¥å£ãä»é¢åå¯¹è±¡è®¾è®¡çè§åº¦çï¼å®ä¸å¤è§æ¨¡å¼ç±»ä¼¼ãAPI ç½å³å°è£äºç³»ç»åé¨æ¶æï¼ä¸ºæ¯ä¸ªå®¢æ·ç«¯æä¾ä¸ä¸ªå®å¶ç APIãå®å¯è½è¿å·æå¶å®èè´£ï¼å¦èº«ä»½éªè¯ãçæ§ãè´è½½åè¡¡ãç¼å­ãè¯·æ±åçä¸ç®¡çãéæååºå¤çã API ç½å³æ¹å¼çæ ¸å¿è¦ç¹æ¯ï¼ææçå®¢æ·ç«¯åæ¶è´¹ç«¯é½éè¿ç»ä¸çç½å³æ¥å¥å¾®æå¡ï¼å¨ç½å³å±å¤çææçéä¸å¡åè½ãéå¸¸ï¼ç½å³ä¹æ¯æä¾ REST/HTTP çè®¿é® APIãæå¡ç«¯éè¿ API-GW æ³¨ååç®¡çæå¡ã\n\n\n# 7.1. Zuul\n\n\n\nå¨ zuul ä¸­ï¼ æ´ä¸ªè¯·æ±çè¿ç¨æ¯è¿æ ·çï¼é¦åå°è¯·æ±ç» zuulservlet å¤çï¼zuulservlet ä¸­æä¸ä¸ª zuulRunner å¯¹è±¡ï¼è¯¥å¯¹è±¡ä¸­åå§åäº RequestContextï¼ä½ä¸ºå­å¨æ´ä¸ªè¯·æ±çä¸äºæ°æ®ï¼å¹¶è¢«ææç zuulfilter å±äº«ãzuulRunner ä¸­è¿æ FilterProcessorï¼FilterProcessor ä½ä¸ºæ§è¡ææç zuulfilter çç®¡çå¨ãFilterProcessor ä» filterloader ä¸­è·å zuulfilterï¼è zuulfilter æ¯è¢« filterFileManager æå è½½ï¼å¹¶æ¯æ groovy ç­å è½½ï¼éç¨äºè½®è¯¢çæ¹å¼ç­å è½½ãæäºè¿äº filter ä¹åï¼zuulservelet é¦åæ§è¡ç Pre ç±»åçè¿æ»¤å¨ï¼åæ§è¡ route ç±»åçè¿æ»¤å¨ï¼æåæ§è¡çæ¯ post ç±»åçè¿æ»¤å¨ï¼å¦æå¨æ§è¡è¿äºè¿æ»¤å¨æéè¯¯çæ¶ååä¼æ§è¡ error ç±»åçè¿æ»¤å¨ãæ§è¡å®è¿äºè¿æ»¤å¨ï¼æç»å°è¯·æ±çç»æè¿åç»å®¢æ·ç«¯ã\n\n\n# 8. è´è½½åè¡¡\n\n> åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 9. æå¡è·¯ç±\n\næå¡è·¯ç±å°±æ¯æå¡æ¶è´¹èå¨åèµ·æå¡è°ç¨æ¶ï¼å¿é¡»æ ¹æ®ç¹å®çè§åæ¥éæ©æå¡èç¹ï¼ä»èæ»¡è¶³æäºç¹å®çéæ±ã\n\n\n# 9.1. æå¡è·¯ç±çåºç¨åºæ¯\n\n * åç»è°ç¨ãä¸è¬æ¥è®²ï¼ä¸ºäºä¿è¯æå¡çé«å¯ç¨æ§ï¼å®ç°å¼å°å¤æ´»çéæ±ï¼ä¸ä¸ªæå¡å¾å¾ä¸æ­¢é¨ç½²å¨ä¸ä¸ªæ°æ®ä¸­å¿ï¼èä¸åºäºèçææ¬ç­èèï¼æäºä¸å¡å¯è½ä¸ä»å¨ç§ææºæ¿é¨ç½²ï¼è¿ä¼éç¨å¬æäºé¨ç½²ï¼çè³éç¨å¤å®¶å¬æäºé¨ç½²ãæå¡èç¹ä¹ä¼æç§ä¸åçæ°æ®ä¸­å¿åæä¸åçåç»ï¼è¿æ¶å¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼éæ©åªä¸ä¸ªåç»è°ç¨ï¼å°±å¿é¡»æç¸åºçè·¯ç±è§åã\n * ç°åº¦åå¸ãå¨æå¡ä¸çº¿åå¸çè¿ç¨ä¸­ï¼ä¸è¬éè¦åå¨ä¸å°é¨åè§æ¨¡çæå¡èç¹ä¸ååå¸æå¡ï¼ç¶åéªè¯åè½æ¯å¦æ­£å¸¸ãå¦ææ­£å¸¸çè¯å°±ç»§ç»­æ©å¤§åå¸èå´ï¼å¦æä¸æ­£å¸¸çè¯ï¼å°±éè¦ææ¥é®é¢ï¼è§£å³é®é¢åç»§ç»­åå¸ãè¿ä¸ªè¿ç¨å°±å«ä½ç°åº¦åå¸ï¼ä¹å«éä¸éé¨ç½²ã\n * æµéåæ¢ãå¨ä¸å¡çº¿ä¸è¿è¡è¿ç¨ä¸­ï¼ç»å¸¸ä¼éå°ä¸äºä¸å¯æåå ç´ å¯¼è´ä¸å¡æéï¼æ¯å¦æä¸ªæºæ¿çåç¼è¢«ææ­ï¼æèåççç«ç­äºæå¯¼è´æ´ä¸ªæºæ¿çæå¡é½ä¸å¯ç¨ãè¿ä¸ªæ¶åå°±éè¦æç§æä¸ªæä»¤ï¼è½å¤æåæ¥è°ç¨è¿ä¸ªæºæ¿æå¡çæµéåæ¢å°å¶ä»æ­£å¸¸çæºæ¿ã\n * è¯»ååç¦»ãå¯¹äºå¤§å¤æ°äºèç½ä¸å¡æ¥è¯´é½æ¯è¯»å¤åå°ï¼æä»¥å¨è¿è¡æå¡é¨ç½²çæ¶åï¼å¯ä»¥æè¯»ååå¼é¨ç½²ï¼ææåæ¥å£å¯ä»¥é¨ç½²å¨ä¸èµ·ï¼èè¯»æ¥å£é¨ç½²å¨å¦å¤çèç¹ä¸ã\n\n\n# 9.2. æå¡è·¯ç±çè§å\n\næå¡è·¯ç±ä¸»è¦æä¸¤ç§è§åï¼ä¸ç§æ¯æ¡ä»¶è·¯ç±ï¼ä¸ç§æ¯èæ¬è·¯ç±ã\n\n# 9.2.1. æ¡ä»¶è·¯ç±\n\næ¡ä»¶è·¯ç±æ¯åºäºæ¡ä»¶è¡¨è¾¾å¼çè·¯ç±è§åã\n\ncondition://0.0.0.0/dubbo.test.interfaces.TestService?category=routers&dynamic=true&priority=2&enabled=true&rule=" + URL.encode(" host = 10.20.153.10=> host = 10.20.153.11")\n\n\nè¿éé¢ condition:// ä»£è¡¨äºè¿æ¯ä¸æ®µç¨æ¡ä»¶è¡¨è¾¾å¼ç¼åçè·¯ç±è§åï¼å·ä½çè§åæ¯\n\nhost = 10.20.153.10 => host = 10.20.153.11\n\n\nåéç¬¦â=>âåé¢æ¯æå¡æ¶è´¹èçå¹éæ¡ä»¶ï¼åé¢æ¯æå¡æä¾èçè¿æ»¤æ¡ä»¶ãå½æå¡æ¶è´¹èèç¹æ»¡è¶³å¹éæ¡ä»¶æ¶ï¼å°±å¯¹è¯¥æå¡æ¶è´¹èæ§è¡åé¢çè¿æ»¤è§åãé£ä¹ä¸é¢è¿æ®µè¡¨è¾¾å¼è¡¨è¾¾çæä¹å°±æ¯ IP ä¸ºâ10.20.153.10âçæå¡æ¶è´¹èé½è°ç¨ IP ä¸ºâ10.20.153.11âçæå¡æä¾èèç¹ã\n\nå¦ææå¡æ¶è´¹èçå¹éæ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºå¯¹ææçæå¡æ¶è´¹èåºç¨ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\n=> host ï¼= 10.20.153.11\n\n\nå¦ææå¡æä¾èçè¿æ»¤æ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºç¦æ­¢æå¡æ¶è´¹èè®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\nhost = 10.20.153.10=>\n\n\nä¸é¢æä¸¾ä¸äº Dubbo æ¡æ¶ä¸­çæ¡ä»¶è·¯ç±ï¼æ¥ç»ä½ è®²è§£ä¸æ¡ä»¶è·¯ç±çå·ä½åºç¨åºæ¯ã\n\n * æé¤æä¸ªæå¡èç¹\n\n=> host != 172.22.3.91\n\n\nä¸æ¦è¿æ¡è·¯ç±è§åè¢«åºç¨å°çº¿ä¸ï¼ææçæå¡æ¶è´¹èé½ä¸ä¼è®¿é® IP ä¸º 172.22.3.91 çæå¡èç¹ï¼è¿ç§è·¯ç±è§åä¸è¬åºç¨å¨çº¿ä¸æµéæé¤é¢åå¸æºä»¥åæé¤æä¸ªæéèç¹çåºæ¯ã\n\n * ç½åååé»åååè½\n\nhost != 10.20.153.10,10.20.153.11 =>\n\n\nè¿æ¡è·¯ç±è§åæææ¯é¤äº IP ä¸º 10.20.153.10 å 10.20.153.11 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ä»¥å¤ï¼å¶ä»æå¡æ¶è´¹èé½ä¸å¯ä»¥ï¼ä¸»è¦ç¨äºç½ååè®¿é®é»è¾ï¼æ¯å¦æä¸ªåå°æå¡åªåè®¸ç¹å®çå å°æºå¨æå¯ä»¥è®¿é®ï¼è¿æ ·çè¯å¯ä»¥æºå¨æ§å¶è®¿é®æéã\n\nhost = 10.20.153.10,10.20.153.11 =>\n\n\nåçï¼è¿æ¡è·¯ç±è§åæææ¯é¤äº IP ä¸º 10.20.153.10 å 10.20.153.11 çæå¡æ¶è´¹èä¸è½åèµ·æå¡è°ç¨ä»¥å¤ï¼å¶ä»æå¡æ¶è´¹èé½å¯ä»¥ï¼ä¹å°±æ¯å®ç°äºé»åååè½ï¼æ¯å¦çº¿ä¸ç»å¸¸ä¼éå°æäºè°ç¨æ¹ä¸ç®¡æ¯åºäºææè¿æ¯æ æçä¸åçè°ç¨ï¼å½±åäºæå¡çç¨³å®æ§ï¼è¿æ¶åå¯ä»¥éè¿é»åååè½ææ¶äºä»¥å°æã\n\n * æºæ¿éç¦»\n\nhost = 172.22.3.* => host = 172.22.3.*\n\n\nè¿æ¡è·¯ç±è§åæææ¯ IP ç½æ®µä¸º 172.22.3.* çæå¡æ¶è´¹èï¼æå¯ä»¥è®¿é®åç½æ®µçæå¡èç¹ï¼è¿ç§è§åä¸è¬åºç¨äºæå¡é¨ç½²å¨å¤ä¸ª IDCï¼çè®ºä¸åä¸ä¸ª IDC åçè°ç¨æ§è½è¦æ¯è·¨ IDC è°ç¨æ§è½è¦å¥½ï¼åºç¨è¿ä¸ªè§åæ¯ä¸ºäºå®ç°å IDC å°±è¿è®¿é®ã\n\n * è¯»ååç¦»\n\nmethod = find*,list*,get*,is* => host =172.22.3.94,172.22.3.95\nmethod != find*,list*,get*,is* => host = 172.22.3.97,172.22.3.98\n\n\nè¿æ¡è·¯ç±è§åæææ¯ find*ãget*ãis* ç­è¯»æ¹æ³è°ç¨ IP ä¸º 172.22.3.94 å 172.22.3.95 çèç¹ï¼é¤æ­¤ä»¥å¤çåæ¹æ³è°ç¨ IP ä¸º 172.22.3.97 å 172.22.3.98 çèç¹ãå¯¹äºå¤§é¨åäºèç½ä¸å¡æ¥è¯´ï¼å¾å¾è¯»è¯·æ±è¦è¿è¿å¤§äºåè¯·æ±ï¼èåè¯·æ±çéè¦æ§å¾å¾è¦è¿è¿é«äºè¯»è¯·æ±ï¼æä»¥éè¦æè¯»åè¯·æ±è¿è¡åç¦»ï¼ä»¥é¿åè¯»è¯·æ±å¼å¸¸å½±åå°åè¯·æ±ï¼è¿æ¶åå°±å¯ä»¥åºç¨è¿ç§è§åã\n\n# 9.2.2. èæ¬è·¯ç±\n\nèæ¬è·¯ç±æ¯åºäºèæ¬è¯­è¨çè·¯ç±è§åï¼å¸¸ç¨çèæ¬è¯­è¨æ¯å¦ JavaScriptãGroovyãJRuby ç­ã\n\n"script://0.0.0.0/com.foo.BarService?category=routers&dynamic=false&rule=" + URL.encode("ï¼function route(invokers) { ... } (invokers)ï¼")\n\n\nè¿éé¢âscript://âå°±ä»£è¡¨äºè¿æ¯ä¸æ®µèæ¬è¯­è¨ç¼åçè·¯ç±è§åï¼å·ä½è§åå®ä¹å¨èæ¬è¯­è¨ç route æ¹æ³å®ç°éï¼æ¯å¦ä¸é¢è¿æ®µç¨ JavaScript ç¼åç route() æ¹æ³è¡¨è¾¾çæææ¯ï¼åªæ IP ä¸º 10.20.153.10 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ã\n\nfunction route(invokers){\n  var result = new java.util.ArrayList(invokers.size());\n  for(i =0; i < invokers.size(); i ++){\n    if("10.20.153.10".equals(invokers.get(i).getUrl().getHost())){\n       result.add(invokers.get(i));\n    }\n  }\n  return result;\n } (invokers)ï¼;\n\n\n\n# 9.3. æå¡è·¯ç±çè·åæ¹å¼\n\næå¡è·¯ç±çè·åæ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * æ¬å°éç½®\n\né¡¾åæä¹å°±æ¯è·¯ç±è§åå­å¨å¨æå¡æ¶è´¹èæ¬å°ä¸ãæå¡æ¶è´¹èåèµ·è°ç¨æ¶ï¼ä»æ¬å°åºå®ä½ç½®è¯»åè·¯ç±è§åï¼ç¶åæç§è·¯ç±è§åéåä¸ä¸ªæå¡èç¹åèµ·è°ç¨ã\n\n * éç½®ä¸­å¿ç®¡ç\n\nè¿ç§æ¹å¼ä¸ï¼ææçæå¡æ¶è´¹èé½ä»éç½®ä¸­å¿è·åè·¯ç±è§åï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çã\n\n * å¨æä¸å\n\nè¿ç§æ¹å¼ä¸ï¼ä¸è¬æ¯è¿ç»´äººåæèå¼åäººåï¼éè¿æå¡æ²»çå¹³å°ä¿®æ¹è·¯ç±è§åï¼æå¡æ²»çå¹³å°è°ç¨éç½®ä¸­å¿æ¥å£ï¼æä¿®æ¹åçè·¯ç±è§åæä¹åå°éç½®ä¸­å¿ãå ä¸ºæå¡æ¶è´¹èè®¢éäºè·¯ç±è§åçåæ´ï¼äºæ¯å°±ä¼ä»éç½®ä¸­å¿è·åææ°çè·¯ç±è§åï¼æç§ææ°çè·¯ç±è§åæ¥æ§è¡ã\n\n\n# 9.4. åé¨æå¡è°ç¨\n\nåºç¡æå¡ä¹é´çè°ç¨ï¼ç»åæå¡æ³¨åä¸­å¿ä»¥åä¸å±çå·æè´è½½åè¡¡åè½çå®¢æ·ç«¯ï¼å¦ Eureka+ï¼restTemplate+Ribbonï¼æè Eureka+Feign èåæå¡è°ç¨ï¼ç»åæå¡æ³¨åä¸­å¿ä»¥åä¸å±çå·æè´è½½åè¡¡åè½çå®¢æ·ç«¯ï¼å¦ Eureka+ï¼restTemplate+Ribbonï¼æè Eureka+Feign\n\n\n\n\n# 9.5. å¤é¨æå¡è°ç¨\n\nåºäº Netflix ç zuulï¼åäºç®åäºè§£ï¼SpringCloud ä¸ zuul éæçæ¹å¼ãè¿éåå¯¹æ ¸å¿æµç¨åä¸ªç®åäºè§£ï¼åç»­ä¼ææ·±å¥çåºç¨ãåæã\n\nSpring Cloud å¾å¥½çéæäº zuulï¼å¹¶ä¸å¯ä»¥éè¿æ³¨è§£çå½¢å¼æ¥è¿è¡è¯·æ±çååè·¯ç±ä»¥å API ç½å³åè½ Spring Cloud éæ zuulï¼å¯¹ä¸ url æ å°çå¤çæ¹å¼ä¸ SpringMVC å¯¹ url çè¯·æ±æ¹å¼ç±»ä¼¼ï¼é½æ¯éè¿ RequestMapping æ¥è¿è¡è¯·æ±ç»å®çãæ ¸å¿ç±»ï¼ZuulHandlerMapping zuul çæ ¸å¿æ¯ ZuulServletï¼ä¸ä¸ªè¯·æ±æ ¸å¿æµç¨ï¼HttpServletRequest â>ZuulHandlerMapping â>ZuulController â> ZuulServlet â> ZuulFilter â> HttpServletResponse\n\n\n# 10. éç½®ä¸­å¿\n\néç½®ä¸­å¿çæè·¯å°±æ¯ææå¡çåç§éç½®ï¼å¦ä»£ç ééç½®çåç§åæ°ãæå¡éçº§çå¼å³çè³ä¾èµçèµæºç­é½å¨ä¸ä¸ªå°æ¹ç»ä¸è¿è¡ç®¡çãæå¡å¯å¨æ¶ï¼å¯ä»¥èªå¨ä»éç½®ä¸­å¿ä¸­æåæéçéç½®ï¼å¹¶ä¸å¦ææéç½®åæ´çæåµï¼åæ ·å¯ä»¥èªå¨ä»éç½®ä¸­å¿æåææ°çéç½®ä¿¡æ¯ï¼æå¡æ é¡»éæ°åå¸ã\n\néç½®ä¸­å¿ä¸è¬åå«ä¸é¢å ä¸ªåè½ï¼\n\n * éç½®æ³¨ååè½\n * éç½®åæ³¨ååè½\n * éç½®æ¥çåè½\n * éç½®åæ´è®¢éåè½\n\n\n# 10.1. Apollo\n\næºç¨å¼æºçåå¸å¼éç½®ä¸­å¿ï¼æ¯æ Java å.Net è¯­è¨ï¼å®¢æ·ç«¯åéç½®ä¸­å¿éè¿ HTTP é¿è¿æ¥å®ç°å®æ¶æ¨éï¼å¹¶ä¸æç»ä¸çç®¡ççé¢æ¥å®ç°éç½®ç®¡çã\n\n\n\n\n# 10.2. Spring Cloud Git\n\nSpring Cloud ä¸­ä½¿ç¨çéç½®ä¸­å¿ç»ä»¶ï¼åªæ¯æ Java è¯­è¨ï¼éç½®å­å¨å¨ git ä¸­ï¼åæ´éç½®ä¹éè¦éè¿ git æä½ï¼å¦æéç½®ä¸­å¿æéç½®åæ´ï¼éè¦æå¨å·æ°ã\n\n\n\n\n# 11. é¾è·¯è¿½è¸ª\n\n\n# 11.1. é¾è·¯è¿½è¸ªçä½ç¨\n\n * ä¼åç³»ç»ç¶é¢\n * ä¼åé¾è·¯è°ç¨\n * çæç½ç»ææ\n * éæä¼ è¾æ°æ®\n\n\n# 11.2. é¾è·¯è¿½è¸ªçåç\n\nçè§£é¾è·¯è¿½è¸ªå¿é¡»åäºè§£ä»¥ä¸æ¦å¿µï¼\n\n * traceIdï¼ç¨äºæ è¯æä¸æ¬¡å·ä½çè¯·æ± IDãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼ä¼å¨ RPC è°ç¨ç½ç»çç¬¬ä¸å±çæä¸ä¸ªå¨å±å¯ä¸ç traceIdï¼å¹¶ä¸ä¼éçæ¯ä¸å±ç RPC è°ç¨ï¼ä¸æ­å¾åä¼ éï¼è¿æ ·çè¯éè¿ traceId å°±å¯ä»¥æä¸æ¬¡ç¨æ·è¯·æ±å¨ç³»ç»ä¸­è°ç¨çè·¯å¾ä¸²èèµ·æ¥ã\n * spanIdï¼ç¨äºæ è¯ä¸æ¬¡ RPC è°ç¨å¨åå¸å¼è¯·æ±ä¸­çä½ç½®ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼å¤å¨ RPC è°ç¨ç½ç»çç¬¬ä¸å± A æ¶ spanId åå§å¼æ¯ 0ï¼è¿å¥ä¸ä¸å± RPC è°ç¨ B çæ¶å spanId æ¯ 0.1ï¼ç»§ç»­è¿å¥ä¸ä¸å± RPC è°ç¨ C æ¶ spanId æ¯ 0.1.1ï¼èä¸ B å¤å¨åä¸å±ç RPC è°ç¨ E ç spanId æ¯ 0.2ï¼è¿æ ·çè¯éè¿ spanId å°±å¯ä»¥å®ä½æä¸æ¬¡ RPC è¯·æ±å¨ç³»ç»è°ç¨ä¸­æå¤çä½ç½®ï¼ä»¥åå®çä¸ä¸æ¸¸ä¾èµåå«æ¯è°ã\n * annotationï¼ç¨äºä¸å¡èªå®ä¹åç¹æ°æ®ï¼å¯ä»¥æ¯ä¸å¡æå´è¶£çæ³ä¸ä¼ å°åç«¯çæ°æ®ï¼æ¯å¦ä¸æ¬¡è¯·æ±çç¨æ· UIDã\n\n\n\n\n# 11.3. é¾è·¯è¿½è¸ªçå®ç°\n\nä¸ä¸ªæå¡è¿½è¸ªç³»ç»ä¸è¬å¯ä»¥åä¸ºä¸å±ï¼\n\n * æ°æ®ééå±ï¼è´è´£æ°æ®åç¹å¹¶ä¸æ¥ã\n * æ°æ®å¤çå±ï¼è´è´£æ°æ®çå­å¨ä¸è®¡ç®ã\n * æ°æ®å±ç¤ºå±ï¼è´è´£æ°æ®çå¾å½¢åå±ç¤ºã\n\n# 11.3.1. æ°æ®ééå±\n\nä¸æ¬¡ RPC è¯·æ±å¯ä»¥åä¸ºåä¸ªé¶æ®µã\n\n * CSï¼Client Sendï¼é¶æ®µ : å®¢æ·ç«¯åèµ·è¯·æ±ï¼å¹¶çæè°ç¨çä¸ä¸æã\n * SRï¼Server Recieveï¼é¶æ®µ : æå¡ç«¯æ¥æ¶è¯·æ±ï¼å¹¶çæä¸ä¸æã\n * SSï¼Server Sendï¼é¶æ®µ : æå¡ç«¯è¿åè¯·æ±ï¼è¿ä¸ªé¶æ®µä¼å°æå¡ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸é¢è¿å¼ å¾å¯ä»¥è¯´æä¸æ¥çæ°æ®æï¼traceId=123456ï¼spanId=0.1ï¼appKey=Bï¼method=B.methodï¼start=103ï¼duration=38ã\n * CRï¼Client Recieveï¼é¶æ®µ : å®¢æ·ç«¯æ¥æ¶è¿åç»æï¼è¿ä¸ªé¶æ®µä¼å°å®¢æ·ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanId=0.1ï¼appKey=Aï¼method=B.methodï¼start=103ï¼duration=38ã\n\n# 11.3.2. æ°æ®å¤çå±\n\næ°æ®å¤çå±çä½ç¨å°±æ¯ææ°æ®ééå±ä¸æ¥çæ°æ®æéè®¡ç®ï¼ç¶åè½å°å­å¨ä¾æ¥è¯¢ä½¿ç¨ã\n\n * å®æ¶æ°æ®å¤ç\n\néå¯¹å®æ¶æ°æ®å¤çï¼ä¸è¬éç¨ Storm æè Spark Streaming æ¥å¯¹é¾è·¯æ°æ®è¿è¡å®æ¶èåå å·¥ï¼å­å¨ä¸è¬ä½¿ç¨ OLTP æ°æ®ä»åºï¼æ¯å¦ HBaseï¼ä½¿ç¨ traceId ä½ä¸º RowKeyï¼è½å¤©ç¶å°æä¸æ´æ¡è°ç¨é¾èåå¨ä¸èµ·ï¼æé«æ¥è¯¢æçã\n\n * ç¦»çº¿æ°æ®å¤ç\n\néå¯¹ç¦»çº¿æ°æ®å¤çï¼ä¸è¬éè¿è¿è¡ MapReduce æè Spark æ¹å¤çç¨åºæ¥å¯¹é¾è·¯æ°æ®è¿è¡ç¦»çº¿è®¡ç®ï¼å­å¨ä¸è¬ä½¿ç¨ Hiveã\n\n# 11.3.3. æ°æ®å±ç¤ºå±\n\næ°æ®å±ç¤ºå±çä½ç¨å°±æ¯å°å¤çåçé¾è·¯ä¿¡æ¯ä»¥å¾å½¢åçæ¹å¼å±ç¤ºç»ç¨æ·ã\n\nå®éé¡¹ç®ä¸­ä¸»è¦ç¨å°ä¸¤ç§å¾å½¢å±ç¤ºï¼ä¸ç§æ¯è°ç¨é¾è·¯å¾ï¼ä¸ç§æ¯è°ç¨ææå¾ã\n\n\n# 11.4. é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯\n\n\n\n\n# 12. éæµçæ­\n\nä¸è¬èè¨ï¼éç¾¤æéçäº§çåå ä¸å¤ä¹æä¸¤ç§ï¼\n\nä¸ç§æ¯ä»£ç  bug æå¯¼è´ï¼æ¯å¦è¯´æä¸æ®µ Java ä»£ç ä¸æ­å°åéå¤§å¯¹è±¡ï¼ä½æ²¡æåæ¶åæ¶å¯¼è´ JVM OOM éåºï¼\n\nå¦ä¸ç§æ¯çªåçæµéå²å»ï¼è¶åºäºç³»ç»çæå¤§æ¿è½½è½åï¼æ¯å¦âå 11âè¿ç§è´­ç©æ´»å¨ï¼çµåç³»ç»ä¼å¨é¶ç¹ä¸ç¬é´æ¶å¥å¤§éæµéï¼è¶åºç³»ç»çæå¤§æ¿è½½è½åï¼ä¸ä¸å­å°±ææ´ä¸ªç³»ç»ç»åå®äºã\n\nåºä»éç¾¤æéçæè·¯ï¼ä¸»è¦æä¸¤ç§ï¼éæµåéçº§ã\n\n\n# 12.1. éæµ\n\néæµå°±æ¯éå¶æµéãéå¸¸æåµä¸ï¼ç³»ç»è½å¤æ¿è½½çæµéæ ¹æ®éç¾¤è§æ¨¡çå¤§å°æ¯åºå®çï¼å¯ä»¥ç§°ä¹ä¸ºç³»ç»çæå¤§å®¹éãå½çå®æµéè¶è¿äºç³»ç»çæå¤§å®¹éåï¼å°±ä¼å¯¼è´ç³»ç»ååºåæ¢ï¼æå¡è°ç¨åºç°å¤§éè¶æ¶ï¼åæ ç»ç¨æ·çæè§å°±æ¯å¡é¡¿ãæ ååºãæä»¥ï¼åºè¯¥æ ¹æ®ç³»ç»çæå¤§å®¹éï¼ç»ç³»ç»è®¾ç½®ä¸ä¸ªéå¼ï¼è¶è¿è¿ä¸ªéå¼çè¯·æ±ä¼è¢«èªå¨æå¼ï¼è¿æ ·çè¯å¯ä»¥æå¤§éåº¦å°ä¿è¯ç³»ç»æä¾çæå¡æ­£å¸¸ã\n\né¤æ­¤ä¹å¤ï¼éå¸¸ä¸ä¸ªå¾®æå¡ç³»ç»ä¼åæ¶æä¾å¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡å¨åä¸æ¶å»çè¯·æ±éä¹æ¯ä¸åçï¼å¾å¯è½åºç°çä¸ç§æåµå°±æ¯ï¼ç³»ç»ä¸­æä¸ªæå¡çè¯·æ±éçªå¢ï¼å ç¨äºç³»ç»ä¸­å¤§é¨åèµæºï¼å¯¼è´å¶ä»æå¡æ²¡æèµæºå¯ç¨ãå æ­¤ï¼è¿è¦éå¯¹ç³»ç»ä¸­æ¯ä¸ªæå¡çè¯·æ±éä¹è®¾ç½®ä¸ä¸ªéå¼ï¼è¶è¿è¿ä¸ªéå¼çè¯·æ±ä¹è¦è¢«èªå¨æå¼ï¼è¿æ ·çè¯ä¸è³äºå ä¸ºä¸ä¸ªæå¡å½±åäºå¶ä»æææå¡ã\n\nå¨å®éé¡¹ç®ä¸­ï¼å¯ä»¥ç¨ä¸¤ä¸ªææ æ¥è¡¡éæå¡çè¯·æ±éï¼ä¸ä¸ªæ¯ QPS å³æ¯ç§è¯·æ±éï¼ä¸ä¸ªæ¯å·¥ä½çº¿ç¨æ°ãä¸è¿ QPS å ä¸ºä¸åæå¡çååºå¿«æ¢ä¸åï¼æä»¥ç³»ç»è½å¤æ¿è½½ç QPS ç¸å·®å¾å¤§ï¼å æ­¤ä¸è¬éæ©å·¥ä½çº¿ç¨æ°æ¥ä½ä¸ºéæµçææ ï¼ç»ç³»ç»è®¾ç½®ä¸ä¸ªæ»çæå¤§å·¥ä½çº¿ç¨æ°ä»¥ååä¸ªæå¡çæå¤§å·¥ä½çº¿ç¨æ°ï¼è¿æ ·çè¯æ è®ºæ¯ç³»ç»çæ»è¯·æ±éè¿å¤§å¯¼è´æ´ä½å·¥ä½çº¿ç¨æ°éè¾¾å°æå¤§å·¥ä½çº¿ç¨æ°ï¼è¿æ¯æä¸ªæå¡çè¯·æ±éè¶è¿åä¸ªæå¡çæå¤§å·¥ä½çº¿ç¨æ°ï¼é½ä¼è¢«éæµï¼ä»¥èµ·å°ä¿æ¤æ´ä¸ªç³»ç»çä½ç¨ã\n\n\n# 12.2. éçº§\n\nä»ä¹æ¯éçº§å¢ï¼å¨æçæ¥ï¼éçº§å°±æ¯éè¿åæ­¢ç³»ç»ä¸­çæäºåè½ï¼æ¥ä¿è¯ç³»ç»æ´ä½çå¯ç¨æ§ãéçº§å¯ä»¥è¯´æ¯ä¸ç§è¢«å¨é²å¾¡çæªæ½ï¼ä¸ºä»ä¹è¿ä¹è¯´å¢ï¼å ä¸ºå®ä¸è¬æ¯ç³»ç»å·²ç»åºç°æéåæéåçä¸ç§æ­¢ææªæ½ã\n\né£ä¹éçº§ä¸è¬æ¯å¦ä½å®ç°çå¢ï¼æ ¹æ®æçå®è·µæ¥çï¼ ä¸ç§å¯è¡çæ¹æ¡æ¯éè¿å¼å³æ¥å®ç°ã\n\nå·ä½æ¥è®²ï¼å°±æ¯å¨ç³»ç»è¿è¡çåå­ä¸­å¼è¾ä¸ååºåï¼ä¸é¨ç¨äºå­å¨å¼å³çç¶æï¼ä¹å°±æ¯å¼å¯è¿æ¯å³é­ãå¹¶ä¸éè¦çå¬æä¸ªç«¯å£ï¼éè¿è¿ä¸ªç«¯å£å¯ä»¥åç³»ç»ä¸åå½ä»¤ï¼æ¥æ¹ååå­ä¸­å¼å³çç¶æãå½å¼å³å¼å¯æ¶ï¼ä¸å¡çæä¸æ®µé»è¾å°±ä¸åæ§è¡ï¼èæ­£å¸¸æåµä¸ï¼å¼å³æ¯å³é­çç¶æã\n\nå¼å³ä¸è¬ç¨å¨ä¸¤ç§å°æ¹ï¼ä¸ç§æ¯æ°å¢çä¸å¡é»è¾ï¼å ä¸ºæ°å¢çä¸å¡é»è¾ç¸å¯¹æ¥è¯´ä¸æçï¼å¾å¾å·å¤ä¸å®çé£é©ï¼æä»¥éè¦å å¼å³æ¥æ§å¶æ°ä¸å¡é»è¾æ¯å¦æ§è¡ï¼å¦ä¸ç§æ¯ä¾èµçæå¡æèµæºï¼å ä¸ºä¾èµçæå¡æèèµæºä¸æ»æ¯å¯é çï¼æä»¥æå¥½æ¯æå¼å³è½å¤æ§å¶æ¯å¦å¯¹ä¾èµæå¡æèµæºåèµ·è°ç¨ï¼æ¥ä¿è¯å³ä½¿ä¾èµåºç°é®é¢ï¼ä¹è½éè¿éçº§æ¥é¿åå½±åã\n\nå¨å®éä¸å¡åºç¨çæ¶åï¼éçº§è¦æç§å¯¹ä¸å¡çå½±åç¨åº¦è¿è¡åçº§ï¼ä¸è¬åä¸ºä¸çº§ï¼ä¸çº§éçº§æ¯å¯¹ä¸å¡å½±åæå°çéçº§ï¼å¨æéçæåµä¸ï¼é¦åæ§è¡ä¸çº§éçº§ï¼æä»¥ä¸çº§éçº§ä¹å¯ä»¥è®¾ç½®æèªå¨éçº§ï¼ä¸éè¦äººä¸ºå¹²é¢ï¼äºçº§éçº§æ¯å¯¹ä¸å¡æä¸å®å½±åçéçº§ï¼å¨æéçæåµä¸ï¼å¦æä¸çº§éçº§èµ·ä¸å°å¤å¤§ä½ç¨çæ¶åï¼å¯ä»¥äººä¸ºéåæªæ½ï¼æ§è¡äºçº§éçº§ï¼ä¸çº§éçº§æ¯å¯¹ä¸å¡æè¾å¤§å½±åçéçº§ï¼è¿ç§éçº§è¦ä¹æ¯å¯¹åä¸æ¶å¥æéå¤§å½±åï¼è¦ä¹æ¯å¯¹ç¨æ·ä½éªæéå¤§å½±åï¼æä»¥æä½èµ·æ¥è¦éå¸¸è°¨æï¼ä¸å¨æåæ¶å»ä¸è¬ä¸äºéç¨ã\n\n\n# 13. DEVOPS\n\n\n# 13.1. å®¹å¨åå®¹å¨å¹³å°\n\nMesosãMarathonãKubernetes\n\n\n# 14. RPC éå\n\n\n# 14.1. éå®è¯­è¨ RPC\n\nè·è¯­è¨å¹³å°ç»å®çå¼æº RPC æ¡æ¶ä¸»è¦æä¸é¢å ç§ã\n\n * Dubboï¼å½åææ©å¼æºç RPC æ¡æ¶ï¼ç±é¿éå·´å·´å¬å¸å¼åå¹¶äº 2011 å¹´æ«å¯¹å¤å¼æºï¼ä»æ¯æ Java è¯­è¨ã\n * Motanï¼å¾®ååé¨ä½¿ç¨ç RPC æ¡æ¶ï¼äº 2016 å¹´å¯¹å¤å¼æºï¼ä»æ¯æ Java è¯­è¨ã\n * Tarsï¼è¾è®¯åé¨ä½¿ç¨ç RPC æ¡æ¶ï¼äº 2017 å¹´å¯¹å¤å¼æºï¼ä»æ¯æ C++ è¯­è¨ã\n * Spring Cloudï¼å½å¤ Pivotal å¬å¸ 2014 å¹´å¯¹å¤å¼æºç RPC æ¡æ¶ï¼ä»æ¯æ Java è¯­è¨ï¼æè¿å å¹´çæåå±å¾æ¯è¾å¥½ï¼æ¯æ¯è¾ç«ç RPC æ¡æ¶ã\n\næä»¥å¾ææ¾ï¼å¦æä½ çä¸å¡åºæ¯ä»ä»å±éäºä¸ç§è¯­è¨çè¯ï¼å¯ä»¥éæ©è·è¯­è¨ç»å®ç RPC æ¡æ¶ä¸­çä¸ç§ï¼å¦ææ¶åå¤ä¸ªè¯­è¨å¹³å°ä¹é´çç¸äºè°ç¨ï¼å°±åºè¯¥éæ©è·¨è¯­è¨å¹³å°ç RPC æ¡æ¶ã\n\nä»ç»åæï¼å¯ä»¥çåº Spring Cloud ä¸ä»æä¾äºåºæ¬ç RPC æ¡æ¶åè½ï¼è¿æä¾äºæå¡æ³¨åç»ä»¶ãéç½®ä¸­å¿ç»ä»¶ãè´è½½åè¡¡ç»ä»¶ãæ­è·¯å¨ç»ä»¶ãåå¸å¼æ¶æ¯è¿½è¸ªç»ä»¶ç­ä¸ç³»åç»ä»¶ï¼ä¹é¾æªè¢«ææ¯åçäººç§°ä¹ä¸ºâSpring Cloud å¨å®¶æ¡¶âãå¦æä½ ä¸æ³èªå·±å®ç°ä»¥ä¸è¿äºåè½ï¼é£ä¹ Spring Cloud åºæ¬å¯ä»¥æ»¡è¶³ä½ çå¨é¨éæ±ãè DubboãMotan åºæ¬ä¸åªæä¾äºæåºç¡ç RPC æ¡æ¶çåè½ï¼å¶ä»å¾®æå¡ç»ä»¶é½éè¦èªå·±å»å®ç°ãä¸è¿ç±äº Spring Cloud ç RPC éä¿¡éç¨äº HTTP åè®®ï¼ç¸æ¯ Dubbo å Motan æéç¨çç§æåè®®æ¥è¯´ï¼å¨é«å¹¶åçéä¿¡åºæ¯ä¸ï¼æ§è½ç¸å¯¹è¦å·®ä¸äºï¼æä»¥å¯¹æ§è½æèå»è¦æ±çæåµä¸ï¼å¯ä»¥èè Dubbo å Motanã\n\n\n# 14.2. è·¨è¯­è¨ RPC\n\nèè·¨è¯­è¨å¹³å°çå¼æº RPC æ¡æ¶ä¸»è¦æä»¥ä¸å ç§ã\n\n * gRPCï¼Google äº 2015 å¹´å¯¹å¤å¼æºçè·¨è¯­è¨ RPC æ¡æ¶ï¼æ¯æå¸¸ç¨ç C++ãJavaãPythonãGoãRubyãPHPãAndroid JavaãObjective-C ç­å¤ç§è¯­è¨ã\n * Thriftï¼æåæ¯ç± Facebook å¼åçåé¨ç³»ç»è·¨è¯­è¨ç RPC æ¡æ¶ï¼2007 å¹´è´¡ç®ç»äº Apache åºéï¼æä¸º Apache å¼æºé¡¹ç®ä¹ä¸ï¼æ¯æå¸¸ç¨ç C++ãJavaãPHPãPythonãRubyãErlang ç­å¤ç§è¯­è¨ã\n\nä»æçåº¦ä¸æ¥è®²ï¼Thrift å ä¸ºè¯ççæ¶é´è¦æ©äº gRPCï¼æä»¥ä½¿ç¨çèå´è¦é«äº gRPCï¼å¨ HBaseãHadoopãScribeãCassandra ç­è®¸å¤å¼æºç»ä»¶ä¸­é½å¾å°äºå¹¿æ³å°åºç¨ãèä¸ Thrift æ¯æå¤è¾¾ 25 ç§è¯­è¨ï¼è¿è¦æ¯ gRPC æ¯æçè¯­è¨æ´å¤ï¼æä»¥å¦æéå° gRPC ä¸æ¯æçè¯­è¨åºæ¯ä¸ï¼éæ© Thrift æ´åéã\n\nä½ gRPC ä½ä¸ºåèµ·ä¹ç§ï¼å ä¸ºéç¨äº HTTP/2 ä½ä¸ºéä¿¡åè®®ãProtoBuf ä½ä¸ºæ°æ®åºååæ ¼å¼ï¼å¨ç§»å¨ç«¯è®¾å¤çåºç¨ä»¥åå¯¹ä¼ è¾å¸¦å®½æ¯è¾ææçåºæ¯ä¸å·æå¾å¤§çä¼å¿ï¼èä¸å¼åææ¡£ä¸°å¯ï¼æ ¹æ® ProtoBuf æä»¶çæçä»£ç è¦æ¯ Thrift æ´ç®æ´ä¸äºï¼ä»ä½¿ç¨é¾æç¨åº¦ä¸æ´å ä¼å¿ï¼æä»¥å¦æä½¿ç¨çè¯­è¨å¹³å° gRPC æ¯æçè¯ï¼å»ºè®®è¿æ¯éç¨ gRPC æ¯è¾å¥½ã\n\n\n# 15. Service Mesh\n\n\n\n\n# 15.1. Service Mesh çå®ç°åç\n\nService Mesh å®ç°çå³é®å°±å¨äºä¸¤ç¹ï¼\n\nä¸ä¸ªæ¯ä¸é¢æå°çè½»éçº§çç½ç»ä»£çä¹å« SideCarï¼å®çä½ç¨å°±æ¯è½¬åæå¡ä¹é´çè°ç¨ï¼\n\nä¸ä¸ªæ¯åºäº SideCar çæå¡æ²»çä¹è¢«å«ä½ Control Planeï¼å®çä½ç¨æ¯å SideCar åéåç§æä»¤ï¼ä»¥å®æåç§æå¡æ²»çåè½ãä¸é¢æå°±æ¥è¯¦ç»è®²è§£è¿ä¸¤ç¹æ¯å¦ä½å®ç°çã\n\n\n# 16. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * RPC å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n * è°è°å¾®æå¡ä¸­ç API ç½å³ï¼API Gatewayï¼',normalizedContent:'# å¾®æå¡åºæ¬åç\n\n\n# 1. å¾®æå¡ç®ä»\n\n\n# 1.1. ä»ä¹æ¯å¾®æå¡æ¶æ\n\näºèç½åºç¨æ¶æå¤§è´çæ¼è¿æ¹åä¸ºï¼åä½æ¶æ -> æå¡åæ¶æ -> å¾®æå¡æ¶æã\n\nå¾®æå¡æ¶æçç¹ç¹ï¼\n\n * æå¡æåç²åº¦æ´ç»ï¼æ ¹æ®ä¸å¡æåã\n * ç¬ç«é¨ç½²ï¼æ¯ä¸ªæå¡é¨ç½²å¨ç©çä¸éç¦»ï¼äºä¸å½±åã\n * ç¬ç«ç»´æ¤ï¼æ ¹æ®ç»ç»æ¶ææåï¼åå¢éç»´æ¤ã\n * æå¡æ²»çï¼æå¡æ°éåå¤ï¼éè¦æç»ä¸çæå¡æ²»çå¹³å°ã\n\n\n# 1.2. å¦ä½æè¡¡å¾®æå¡çå©å¼\n\nä¼ç¹\n\n * å¼ºæ¨¡ååè¾¹ç\n * å¯ç¬ç«é¨ç½²\n * ææ¯å¤æ ·æ§\n\nç¼ºç¹\n\n * åå¸å¼å¤æåº¦\n * æç»ä¸è´æ§\n * è¿ç»´å¤æåº¦\n * æµè¯å¤æåº¦\n\n\n# 1.3. åº·å¨å®å¾\n\n * ç¬¬ä¸å®å¾ï¼ç»ç»æ²éæ¹å¼ä¼éè¿ç³»ç»è®¾è®¡è¡¨è¾¾åºæ¥\n * ç¬¬äºå®å¾ï¼æ¶é´åå¤ä¸ä»¶äºæä¹ä¸å¯è½åçå®ç¾ï¼ä½æ»ææ¶é´åå®ä¸ä»¶äºæ\n * ç¬¬ä¸å®å¾ï¼çº¿åç³»ç»åçº¿åç»ç»æ¶æé´ææ½å¨çå¼è´¨åæç¹æ§\n * ç¬¬åå®å¾ï¼å¤§çç³»ç»ç»ç»æ»æ¯æ¯å°ç³»ç»æ´å¾åäºåè§£\n\n\n# 1.4. å¦ä½æåå¾®æå¡\n\nåºç¨å¾®æå¡åæ¶æåï¼è¦æèå ä¸ªé®é¢ï¼\n\nä»ä¹æ¶åè¿è¡æå¡åæåï¼å¦ä½æåæå¡ï¼\n\nå½åºç¨å¤æåº¦ãå¼åå¢éè¨èå°é¾ä»¥ç»´æ¤æ¶ï¼å°±è¯¥èèæå¡åæåäºã\n\næåæå¡çæèç»´åº¦ï¼\n\n * ä¸å¡ç»´åº¦ï¼ä¸å¡åæ°æ®å³ç³»å¯åçåºè¯¥æ¾å¨ä¸èµ·ã\n * åè½ç»´åº¦ï¼å¬å±åè½èåä¸ºä¸ä¸ªæå¡ã\n * ç»ç»æ¶æï¼æ ¹æ®å®éç»ç»æ¶æï¼å¤©ç¶åä¸ºä¸åçå¢éï¼æ¯ä¸ªå¢éç¬ç«ç»´æ¤è¥å¹²å¾®æå¡ã\n\næåæå¡çåç½®æ¡ä»¶ï¼\n\nåºç¨å¾®æå¡æ¶æè¦åè§£å³ä»¥ä¸é®é¢ï¼\n\n * æå¡å¦ä½å®\n * æå¡å¦ä½åå¸åè®¢é\n * æå¡å¦ä½çæ§\n * æå¡å¦ä½æ²»ç\n * æéå¦ä½å®ä½\n\n\n# 2. å¾®æå¡ææ¯æ¶æ\n\n\n\nç¬¬ä¸å±ï¼æ¥å¥å±\n\nå¤é¨è®¾å¤è®¿é®çç»ä¸æ¥å¥å±ã\n\nç¬¬äºå±ï¼èåæå¡å±\n\nå¯¹ä¸å±çåºç¡æå¡åä¸äºèåï¼åªè£çå·¥ä½ï¼ééä¸å±ä¸åè®¾å¤çæ°æ®è¾åºã\n\nç¬¬ä¸å±ï¼åºç¡æå¡å±\n\næ¯è¾ç»ç²åº¦çå¾®æå¡å±ï¼æä¾åºç¡çæ ¸å¿æå¡ï¼å¬å±æå¡ã\n\n\n\n\n# 3. æå¡æ³¨ååç°\n\nå¨å¾®æå¡æ¶æä¸ï¼ä¸»è¦æä¸ç§è§è²ï¼\n\n * æå¡æä¾èï¼rpc server / providerï¼\n * æå¡æ¶è´¹èï¼rpc client / consumerï¼\n * æå¡æ³¨åä¸­å¿ï¼registryï¼\n\næ³¨åä¸­å¿çå®ç°ä¾èµä»¥ä¸æºå¶ï¼\n\n * æ³¨åä¸­å¿ api\n * éç¾¤é¨ç½²ï¼å¦ææ³¨åä¸­å¿æ¯åç¹ï¼æ æ³ä¿éé«å¯ç¨ã\n * åæ°æ®å­å¨ï¼ä¾å¦ zookeeper å°æ°æ®ä»¥å±æ¬¡åçç®å½ç»æå­å¨ã\n * æå¡å¥åº·æ£æ¥ï¼ä½¿ç¨é¿è¿æ¥æå¿è·³æ¢æµæ¹å¼æ£æ¥æå¡å¥åº·ç¶æã\n * æå¡ç¶æåæ´éç¥ï¼å¯ä»¥åºäºè®¢éèæ¨¡å¼å®ç°ï¼ä¾å¦ zookeeper ç watch æºå¶ã\n * ç½ååæºå¶\n\næ³¨åä¸­å¿çæå¡æ³¨åååç°é½æ¯åºäº api çãä¸è¬éè¦æ¯æä»¥ä¸åè½ï¼\n\n * æå¡æ³¨å\n * æå¡æ³¨é\n * æ¥å£ç»­çº¦ï¼å¿è·³ï¼\n * æå¡è®¢é\n * å¯ç¨æå¡åæ­¥\n * æå¡æ¥è¯¢\n * æå¡ä¿®æ¹\n\n\n# 3.1. æ³¨åä¸­å¿çå·¥ä½æµç¨\n\nä¸è¬æ¥è®²ï¼æ³¨åä¸­å¿çå·¥ä½æµç¨æ¯ï¼\n\n * æå¡æä¾èå¨å¯å¨æ¶ï¼æ ¹æ®æå¡åå¸æä»¶ä¸­éç½®çåå¸ä¿¡æ¯åæ³¨åä¸­å¿æ³¨åèªå·±çæå¡ã\n * æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼æ ¹æ®æ¶è´¹èéç½®æä»¶ä¸­éç½®çæå¡ä¿¡æ¯åæ³¨åä¸­å¿è®¢éèªå·±æéè¦çæå¡ã\n * æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æå¡æ¶è´¹èã\n * å½æå¡æä¾èåçååï¼æ¯å¦æèç¹æ°å¢æèéæ¯ï¼æ³¨åä¸­å¿å°åæ´éç¥ç»æå¡æ¶è´¹èã\n\n\n# 3.2. æ³¨åä¸­å¿å®ç°æ¨¡å¼\n\n# 3.2.1. åºç¨åæ³¨åååç°\n\néç¨åºç¨åæ³¨åä¸åç°çæ¹å¼ï¼æå¸åçæ¡ä¾è¦å± netflix å¼æºç eurekaï¼å®æ¹æ¶æå¾å¦ä¸ã\n\n\n\nå¯¹çè¿å¼ å¾ï¼ææ¥ä»ç»ä¸ eureka çæ¶æï¼å®ä¸»è¦ç±ä¸ä¸ªéè¦çç»ä»¶ç»æï¼\n\n * eureka serverï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°äºæå¡ä¿¡æ¯æ³¨åãå­å¨ä»¥åæ¥è¯¢ç­åè½ã\n * æå¡ç«¯ç eureka clientï¼éæå¨æå¡ç«¯çæ³¨åä¸­å¿ sdkï¼æå¡æä¾èéè¿è°ç¨ sdkï¼å®ç°æå¡æ³¨åãåæ³¨åç­åè½ã\n * å®¢æ·ç«¯ç eureka clientï¼éæå¨å®¢æ·ç«¯çæ³¨åä¸­å¿ sdkï¼æå¡æ¶è´¹èéè¿è°ç¨ sdkï¼å®ç°æå¡è®¢éãæå¡æ´æ°ç­åè½ã\n\n# 3.2.2. åºç¨å¤æ³¨åååç°\n\n\n\néè¿è¿å¼ æ¶æå¾ï¼å¯ä»¥çåºæ¥ä½¿ç¨ consul å®ç°åºç¨å¤æå¡æ³¨åååç°ä¸»è¦ä¾é ä¸ä¸ªéè¦çç»ä»¶ï¼\n\n * consulï¼æ³¨åä¸­å¿çæå¡ç«¯ï¼å®ç°æå¡æ³¨åä¿¡æ¯çå­å¨ï¼å¹¶æä¾æ³¨åååç°æå¡ã\n * registratorï¼ä¸ä¸ªå¼æºçç¬¬ä¸æ¹æå¡ç®¡çå¨é¡¹ç®ï¼å®éè¿çå¬æå¡é¨ç½²ç docker å®ä¾æ¯å¦å­æ´»ï¼æ¥è´è´£æå¡æä¾èçæ³¨ååéæ¯ã\n * consul templateï¼å®æ¶ä»æ³¨åä¸­å¿æå¡ç«¯è·åææ°çæå¡æä¾èèç¹åè¡¨å¹¶å·æ° lb éç½®ï¼æ¯å¦ nginx ç upstreamï¼ï¼è¿æ ·æå¡æ¶è´¹èå°±éè¿è®¿é® nginx å°±å¯ä»¥è·åææ°çæå¡æä¾èä¿¡æ¯ã\n\n# 3.2.3. æ³¨åä¸­å¿éå\n\n# 3.2.3.1. é«å¯ç¨æ§\n\néç¾¤é¨ç½²ï¼éè¿é¨ç½²å¤ä¸ªå®ä¾ç»æéç¾¤æ¥ä¿è¯é«å¯ç¨æ§ã\n\nå¤ idc é¨ç½²ï¼å³é¨ç½²å¨ä¸æ­¢ä¸ä¸ªæºæ¿ã\n\n# 3.2.3.2. æ°æ®ä¸è´æ§\n\næ ¹æ® cap çè®ºï¼ä¸èä¸è½åæ¶æ»¡è¶³ï¼\n\n * cp åæ³¨åä¸­å¿ï¼çºç²å¯ç¨æ§æ¥ä¿è¯æ°æ®å¼ºä¸è´æ§ï¼æå¸åçä¾å­å°±æ¯ zookeeperï¼etcdï¼consul äºãzookeeper éç¾¤ååªæä¸ä¸ª leaderï¼èä¸å¨ leader æ æ³ä½¿ç¨çæ¶åéè¿ paxos ç®æ³éä¸¾åºä¸ä¸ªæ°ç leaderãè¿ä¸ª leader çç®çå°±æ¯ä¿è¯åä¿¡æ¯çæ¶ååªåè¿ä¸ª leader åå¥ï¼leader ä¼åæ­¥ä¿¡æ¯å° followersï¼è¿ä¸ªè¿ç¨å°±å¯ä»¥ä¿è¯æ°æ®çå¼ºä¸è´æ§ãä½å¦æå¤ä¸ª zookeeper ä¹é´ç½ç»åºç°é®é¢ï¼é æåºç°å¤ä¸ª leaderï¼åçèè£çè¯ï¼æ³¨åä¸­å¿å°±ä¸å¯ç¨äºãè etcd å consul éç¾¤åé½æ¯éè¿ raft åè®®æ¥ä¿è¯å¼ºä¸è´æ§ï¼å¦æåºç°èè£çè¯ï¼ æ³¨åä¸­å¿ä¹ä¸å¯ç¨ã\n * ap åæ³¨åä¸­å¿ï¼çºç²ä¸è´æ§æ¥ä¿è¯å¯ç¨æ§ï¼æå¸åçä¾å­å°±æ¯ eureka äºãå¯¹æ¯ä¸ zookeeperï¼eureka ä¸ç¨éä¸¾ä¸ä¸ª leaderï¼æ¯ä¸ª eureka æå¡å¨åç¬ä¿å­æå¡æ³¨åå°åï¼å æ­¤æå¯è½åºç°æ°æ®ä¿¡æ¯ä¸ä¸è´çæåµãä½æ¯å½ç½ç»åºç°é®é¢çæ¶åï¼æ¯å°æå¡å¨é½å¯ä»¥å®æç¬ç«çæå¡ã\n\n\n# 3.3. æå¡æ³¨ååç°çé®é¢\n\n# 3.3.1. å¤æ³¨åä¸­å¿\n\nå¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼è¦è½å¤åæ¶ä»å¤ä¸ªæ³¨åä¸­å¿è®¢éæå¡ï¼å¯¹äºæå¡æä¾èæ¥è¯´ï¼è¦è½å¤åæ¶åå¤ä¸ªæ³¨åä¸­å¿æ³¨åæå¡ã\n\n# 3.3.2. å¹¶è¡è®¢éæå¡\n\nå¯ä»¥æ¯è®¢éä¸ä¸ªæå¡å°±åç¬ç¨ä¸ä¸ªçº¿ç¨æ¥å¤çï¼è¿æ ·çè¯å³ä½¿éå°ä¸ªå«æå¡èç¹è¿æ¥è¶æ¶ï¼å¶ä»æå¡èç¹çåå§åè¿æ¥ä¹ä¸åå½±åï¼ææ¢ä¹å°±æ¯è¿ä¸ªæå¡èç¹çåå§åè¿æ¥èè´¹çæ¶é´ï¼æç»æææå¡èç¹çåå§åè¿æ¥èæ¶æ§å¶å¨äº 30 ç§ä»¥åã\n\n# 3.3.3. æ¹éæ³¨éæå¡\n\néè¦å®æ¶å»æ¸çæ³¨åä¸­å¿ä¸­çâåµå°¸èç¹âï¼å¦ææ¯ææ¹éæ³¨éæå¡ï¼å°±å¯ä»¥ä¸æ¬¡è°ç¨å°±æè¯¥èç¹ä¸æä¾çæææå¡åæ¶æ³¨éæã\n\n# 3.3.4. æå¡åæ´ä¿¡æ¯åæ­¥æ´æ°\n\nä¸ºäºåå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿ä¸­æåçæå¡å¯ç¨èç¹ä¿¡æ¯çæ°æ®éï¼è¿ä¸ªæ¶åå¯ä»¥éè¿å¢éæ´æ°çæ¹å¼ï¼æ³¨åä¸­å¿åªè¿åååçé£é¨åèç¹ä¿¡æ¯ï¼å°¤å¶å¨åªæå°æ°èç¹ä¿¡æ¯åæ´æ¶ï¼æ­¤ä¸¾å¯ä»¥å¤§å¤§åå°æå¡æ¶è´¹èä»æ³¨åä¸­å¿æåçæ°æ®éï¼ä»èæå¤§ç¨åº¦é¿åäº§çç½ç»é£æ´ã\n\n\n# 3.4. è¯å«æå¡èç¹æ¯å¦å­æ´»\n\n# 3.4.1. å¿è·³å¼å³ä¿æ¤æºå¶\n\nå¨ç½ç»é¢ç¹æå¨çæåµä¸ï¼æ³¨åä¸­å¿ä¸­å¯ç¨çèç¹ä¼ä¸æ­ååï¼è¿æ¶åæå¡æ¶è´¹èä¼é¢ç¹æ¶å°æå¡æä¾èèç¹åæ´çä¿¡æ¯ï¼äºæ¯å°±ä¸æ­å°è¯·æ±æ³¨åä¸­å¿æ¥æåææ°çå¯ç¨æå¡èç¹ä¿¡æ¯ãå½ææç¾ä¸åä¸ªæå¡æ¶è´¹èï¼åæ¶è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡æä¾èçèç¹ä¿¡æ¯æ¶ï¼å¯è½ä¼ææ³¨åä¸­å¿çå¸¦å®½ç»å æ»¡ï¼å°¤å¶æ¯æ³¨åä¸­å¿æ¯ç¾åç½å¡çæåµä¸ã\n\næä»¥éå¯¹è¿ç§æåµï¼éè¦ä¸ç§ä¿æ¤æºå¶ï¼å³ä½¿å¨ç½ç»é¢ç¹æå¨çæ¶åï¼æå¡æ¶è´¹èä¹ä¸è³äºåæ¶å»è¯·æ±æ³¨åä¸­å¿è·åææ°çæå¡èç¹ä¿¡æ¯ã\n\nææ¾ç»å°±éå°è¿è¿ç§æåµï¼ä¸ä¸ªå¯è¡çè§£å³æ¹æ¡å°±æ¯ç»æ³¨åä¸­å¿è®¾ç½®ä¸ä¸ªå¼å³ï¼å½å¼å³æå¼æ¶ï¼å³ä½¿ç½ç»é¢ç¹æå¨ï¼æ³¨åä¸­å¿ä¹ä¸ä¼éç¥ææçæå¡æ¶è´¹èææå¡èç¹ä¿¡æ¯åæ´ï¼æ¯å¦åªç» 10% çæå¡æ¶è´¹èè¿ååæ´ï¼è¿æ ·çè¯å°±è½å°æ³¨åä¸­å¿çè¯·æ±éåå°å°åæ¥ç 1/10ã\n\nå½ç¶æå¼è¿ä¸ªå¼å³ä¹æ¯æä¸å®ä»£ä»·çï¼å®ä¼å¯¼è´æå¡æ¶è´¹èæç¥ææ°çæå¡èç¹ä¿¡æ¯å»¶è¿ï¼ååå¯è½å¨ 10s åå°±è½æç¥å°æå¡æä¾èèç¹ä¿¡æ¯çåæ´ï¼ç°å¨å¯è½ä¼å»¶è¿å°å åéï¼æä»¥å¨ç½ç»æ­£å¸¸çæåµä¸ï¼å¼å³å¹¶ä¸éåæå¼ï¼å¯ä»¥ä½ä¸ºä¸ä¸ªç´§æ¥æªæ½ï¼å¨ç½ç»é¢ç¹æå¨çæ¶åï¼ææå¼è¿ä¸ªå¼å³ã\n\n# 3.4.2. æå¡èç¹æé¤ä¿æ¤æºå¶\n\næå¡æä¾èå¨è¿ç¨å¯å¨æ¶ï¼ä¼æ³¨åæå¡å°æ³¨åä¸­å¿ï¼å¹¶æ¯éä¸æ®µæ¶é´ï¼æ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼ä»¥æ è¯èªå·±çå­æ´»ç¶æãå¦æéäºä¸æ®µåºå®æ¶é´åï¼æå¡æä¾èä»ç¶æ²¡ææ±æ¥å¿è·³ç»æ³¨åä¸­å¿ï¼æ³¨åä¸­å¿å°±ä¼è®¤ä¸ºè¯¥èç¹å·²ç»å¤äºâdeadâç¶æï¼äºæ¯ä»æå¡çå¯ç¨èç¹ä¿¡æ¯ä¸­ç§»é¤åºå»ã\n\nå¦æéå°ç½ç»é®é¢ï¼å¤§æ¹æå¡æä¾èèç¹æ±æ¥ç»æ³¨åä¸­å¿çå¿è·³ä¿¡æ¯é½å¯è½ä¼ä¼ è¾¾å¤±è´¥ï¼æ³¨åä¸­å¿å°±ä¼æå®ä»¬é½ä»å¯ç¨èç¹åè¡¨ä¸­ç§»é¤åºå»ï¼é æå©ä¸çå¯ç¨èç¹é¾ä»¥æ¿åææçè°ç¨ï¼å¼èµ·âéªå´©âãä½æ¯è¿ç§æåµä¸ï¼å¯è½å¤§é¨åæå¡æä¾èèç¹æ¯å¯ç¨çï¼ä»ä»å ä¸ºç½ç»åå æ æ³æ±æ¥å¿è·³ç»æ³¨åä¸­å¿å°±è¢«âæ æâçæé¤äºã\n\nè¿ä¸ªæ¶åå°±éè¦æ ¹æ®å®éä¸å¡çæåµï¼è®¾å®ä¸ä¸ªéå¼æ¯ä¾ï¼å³ä½¿éå°åæè¯´çè¿ç§æåµï¼æ³¨åä¸­å¿ä¹ä¸è½æé¤è¶è¿è¿ä¸ªéå¼æ¯ä¾çèç¹ã\n\nè¿ä¸ªéå¼æ¯ä¾å¯ä»¥æ ¹æ®å®éä¸å¡çåä½åº¦æ¥ç¡®å®ï¼æéå¸¸ä¼æè¿ä¸ªæ¯ä¾è®¾å®å¨ 20%ï¼å°±æ¯è¯´æ³¨åä¸­å¿ä¸è½æé¤è¶è¿ 20% çèç¹ãå ä¸ºå¤§é¨åæåµä¸ï¼èç¹çååä¸ä¼è¿ä¹é¢ç¹ï¼åªæå¨ç½ç»æå¨æèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµä¸ææå¯è½åçãèä¸å¡æç¡®è¦ä¸çº¿å¤§æ¹éèç¹çæåµæ¯å¯ä»¥é¢ç¥çï¼è¿ç§æåµä¸å¯ä»¥å³é­éå¼ä¿æ¤ï¼èæ­£å¸¸æåµä¸ï¼åºè¯¥æå¼éå¼ä¿æ¤ï¼ä»¥é²æ­¢ç½ç»æå¨æ¶ï¼å¤§æ¹éå¯ç¨çæå¡èç¹è¢«æé¤ã\n\n\n# 4. æå¡éä¿¡\n\néè¿æ³¨åä¸­å¿ï¼æå¡æ¶è´¹èåæå¡æä¾èå°±å¯ä»¥æç¥å½¼æ­¤ï¼ä½æ¯ï¼è¦å®ç°äº¤äºè¿å¿é¡»è§£å³éä¿¡é®é¢ï¼\n\n * éä¿¡åè®®ãå³æå¡æä¾èåæå¡æ¶è´¹èä¹é´ä»¥ä»ä¹æ ·ç åè®® è¿è¡ç½ç»éä¿¡ï¼è¯´ç½äºï¼æ¯è¦è§£å³å®¢æ·ç«¯åæå¡ç«¯å¦ä½å»ºç«è¿æ¥ãç®¡çè¿æ¥ä»¥åæå¡ç«¯å¦ä½å¤çè¯·æ±çé®é¢ãæ¯éç¨åå± tcpãudp åè®®ï¼è¿æ¯éç¨ä¸å± http åè®®ï¼è¿æ¯éç¨å¶ä»åè®®ï¼ä¾å¦ï¼dubbo åºäº tcp éä¿¡ï¼è spring cloud åºäº http rest éä¿¡ãtcp éä¿¡æ¹å¼ï¼ä¼ è¾æçæ´é«ï¼ä½æ¯ http æ¹å¼å¤©ç¶å¯ä»¥æä¾å¯¹å¤æå¡ã\n * ä¼ è¾æ¹å¼ãå³æå¡æä¾èåæå¡æ¶è´¹èä¹é´çæ°æ®ä¼ è¾éç¨åªç§æ¹å¼ãæ¯åæ­¥è¿æ¯å¼æ­¥ï¼æ¯å¨åè¿æ¥ä¸ä¼ è¾ï¼è¿æ¯å¤è·¯å¤ç¨ã\n * åºåååååºååãå®ä¸»è¦è§£å³å®¢æ·ç«¯åæå¡ç«¯éç¨åªç§æ°æ®ç¼è§£ç çé®é¢ãå¸¸è§çåºååæ¹å¼åæ¬ï¼xmlãjsonï¼äºè¿å¶ç±»å¦ï¼thriftãprotobufãhessianãjdkã\n\n\n# 4.1. åºååæ¹å¼\n\nåºååæ¹å¼çéåï¼ä¸è¬åºäºä»¥ä¸èèï¼\n\n * æ¯ææ°æ®ç»æç±»åçä¸°å¯åº¦\n * è·¨è¯­è¨æ¯æ\n * æ§è½\n\n> ð åèï¼java åºåå\n\n\n# 4.2. éä¿¡åè®®\n\nå¾®æå¡æ¡æ¶å¯¹æ¯ï¼\n\n       rpc                                       rest\nè¦åæ§    å¼ºè¦å                                       æ¾æ£è¦å\nåè®®     tcp                                       httpãhttp2\nåºåå    äºè¿å¶ï¼thriftãprotobufãhessianãavroãjdk ç­ï¼   xmlãjson\næ§è½     é«                                         ä½\nå®¢æ·ç«¯    å¯¹ç¼ç¨è¯­è¨æéå¶                                  è·¨è¯­è¨æ¯ææ´å¥½ï¼æ¯æ http å³å¯ï¼\nä»£è¡¨ææ¯   dubboãmotanãtarsãgrpcãthrift              spring cloud\n\n\n# 5. æå¡çæ§\n\nå½æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´å»ºç«äºéä¿¡ï¼ä½ä¸ºç®¡çèéè¦éè¿çæ§ææ®µæ¥è§å¯æå¡æ¯å¦æ­£å¸¸ï¼è°ç¨æ¯å¦æåãæå¡çæ§æ¯å¾å¤æçï¼å¨å¾®æå¡æ¶æä¸ï¼ä¸æ¬¡ç¨æ·è°ç¨ä¼å ä¸ºæå¡åæååï¼åæå¤ä¸ªä¸åæå¡ä¹é´çç¸äºè°ç¨ï¼è¿ä¹å°±éè¦å¯¹æååçæ¯ä¸ªæå¡é½çæ§èµ·æ¥ã\n\n\n# 5.1. çæ§å¯¹è±¡\n\næå¡çæ§ä¸å®æ¯éè¿è§å¯æ°æ®æ¥éååæï¼æä»¥é¦åè¦æç¡®éè¦çæ§ä»ä¹ã\n\nä¸è¬æ¥è¯´ï¼æå¡çæ§æ°æ®æä»¥ä¸åç±»ï¼\n\n * ä¸å¡çæ§ï¼æ ¸å¿ææ ãç»å½ãç»åºãä¸åãæ¯ä»ç­ã\n * åºç¨çæ§ï¼è®¿é®æ¥å£ãè®¿é®æå¡ãsqlãåå­ä½¿ç¨çãååºæ¶é´ãtpsãqps ç­ã\n * ç³»ç»çæ§ï¼cpuãåå­ãç½ç»ãç£çç­ã\n * åºç¡çæ§ï¼ç½ç»æµéãä¸¢åæ°ãéåæ°ãè¿æ¥æ°ç­ã\n * å®¢æ·ç«¯çæ§ï¼æ§è½ãè¿åç ãå°åãè¿è¥åãçæ¬ãç³»ç»ç­ã\n\n\n# 5.2. ç³»ç»çæ§åç\n\nä¸æ¦æç¡®äºè¦çæ§çå¯¹è±¡ï¼æ¥ä¸å°±æ¯èèå¦ä½çæ§ã\n\nçæ§ç³»ç»ä¸»è¦åæ¬åä¸ªç¯èï¼æ°æ®ééãæ°æ®ä¼ è¾ãæ°æ®å¤çåæ°æ®å±ç¤º\n\n# 5.2.1. æ°æ®éé\n\néå¸¸æä¸¤ç§æ°æ®æ¶éæ¹å¼ï¼\n\n * æå¡ä¸»å¨ä¸æ¥ï¼è¿ç§å¤çæ¹å¼éè¿å¨ä¸å¡ä»£ç æèæå¡æ¡æ¶éå å¥æ°æ®æ¶éä»£ç é»è¾ï¼å¨æ¯ä¸æ¬¡æå¡è°ç¨å®æåï¼ä¸»å¨ä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãè¿ç§æ¹å¼å¨é¾è·¯è·è¸ªä¸­è¾ä¸ºå¸¸è§ï¼ä¸»æµçææ¯æ¹æ¡æï¼zipkinã\n * ä»£çæ¶éï¼è¿ç§å¤çæ¹å¼éè¿æå¡è°ç¨åæè°ç¨çè¯¦ç»ä¿¡æ¯è®°å½å°æ¬å°æ¥å¿æä»¶ä¸­ï¼ç¶ååéè¿ä»£çå»è§£ææ¬å°æ¥å¿æä»¶ï¼ç¶ååä¸æ¥æå¡çè°ç¨ä¿¡æ¯ãä¸»æµçææ¯æ¹æ¡æï¼elkãflumeã\n\n# 5.2.2. æ°æ®ä¼ è¾\n\næ°æ®ä¼ è¾æå¸¸ç¨çæ¹å¼æä¸¤ç§ï¼\n\n * udp ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®å¤çååæä¾æå¡å¨çè¯·æ±å°åï¼æ°æ®ééåéè¿ udp åè®®ä¸æå¡å¨å»ºç«è¿æ¥ï¼ç¶åææ°æ®åéè¿å»ã\n * kafka ä¼ è¾ï¼è¿ç§å¤çæ¹å¼æ¯æ°æ®ééååéå°æå®ç topicï¼ç¶åæ°æ®å¤çåååè®¢éå¯¹åºç topicï¼å°±å¯ä»¥ä» kafka æ¶æ¯éåä¸­è¯»åå°å¯¹åºçæ°æ®ãç±äº kafka æéå¸¸é«çååè½åï¼æä»¥å¾éåä½ä¸ºå¤§æ°æ®éçç¼å²æ± ã\n\n# 5.2.3. æ°æ®å¤ç\n\næ°æ®å¤çæ¯å¯¹æ¶éæ¥çåå§æ°æ®è¿è¡èåå¹¶å­å¨ãæ°æ®èåéå¸¸æä¸¤ä¸ªç»´åº¦ï¼\n\n * æ¥å£ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§æ¥å£åç»´åº¦å®æ¶èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥å¾å°æ¯ä¸ªæ¥å£çæ¯ç§è¯·æ±éãå¹³åèæ¶ãæåçç­ä¿¡æ¯ã\n * æºå¨ç»´åº¦èåï¼è¿ä¸ªç»´åº¦æ¯æå®æ¶æ¶å°çæ°æ®æç§è°ç¨çèç¹ç»´åº¦èåå¨ä¸èµ·ï¼è¿æ ·å°±å¯ä»¥ä»åæºç»´åº¦å»æ¥çæ¯ä¸ªæ¥å£çå®æ¶è¯·æ±éãå¹³åèæ¶ç­ä¿¡æ¯ã\n\nèååçæ°æ®éè¦æä¹åå°æ°æ®åºä¸­å­å¨ï¼æéç¨çæ°æ®åºä¸è¬åä¸ºä¸¤ç§ï¼\n\n * å¨ææ£ç´¢æ°æ®åºï¼æ¯å¦ elasticsearchï¼ä»¥åæç´¢å¼çæ°æ®ç»æå­å¨ï¼éè¦æ¥è¯¢çæ¶åï¼æ ¹æ®ç´¢å¼æ¥æ¥è¯¢ã\n * æ¶åºæ°æ®åºï¼æ¯å¦ opentsdbï¼ä»¥æ¶åºåºåæ°æ®çæ¹å¼å­å¨ï¼æ¥è¯¢çæ¶åæç§æ¶åºå¦ 1minã5min ç­ç»´åº¦æ¥æ¥è¯¢ã\n\n# 5.2.4. æ°æ®å±ç¤º\n\næ°æ®å±ç¤ºæ¯æå¤çåçæ°æ®ä»¥ dashboard çæ¹å¼å±ç¤ºç»ç¨æ·ãæ°æ®å±ç¤ºæå¤ç§æ¹å¼ï¼æ¯å¦æ²çº¿å¾ãé¥¼ç¶å¾ãæ ¼å­å¾å±ç¤ºç­ã\n\n\n# 5.3. çæ§ææ¯\n\n\n\n * elk çææ¯æ æ¯è¾æçï¼åºç¨èå´ä¹æ¯è¾å¹¿ï¼é¤äºå¯ç¨ä½çæ§ç³»ç»å¤ï¼è¿å¯ä»¥ç¨ä½æ¥å¿æ¥è¯¢ååæã\n * graphite æ¯åºäºæ¶é´åºåæ°æ®åºå­å¨ççæ§ç³»ç»ï¼å¹¶ä¸æä¾äºåè½å¼ºå¤§çåç§èåå½æ°æ¯å¦ sumãaverageãtop5 ç­å¯ç¨äºçæ§åæï¼èä¸å¯¹å¤æä¾äº api ä¹å¯ä»¥æ¥å¥å¶ä»å¾å½¢åçæ§ç³»ç»å¦ grafanaã\n * tick çæ ¸å¿å¨äºå¶æ¶é´åºåæ°æ®åº influxdb çå­å¨åè½å¼ºå¤§ï¼ä¸æ¯æç±»ä¼¼ sql è¯­è¨çå¤ææ°æ®å¤çæä½ã\n * prometheus çç¬ç¹ä¹å¤å¨äºå®éç¨äºææ°æ®çæ¹å¼ï¼å¯¹ä¸å¡å½±åè¾å°ï¼åæ¶ä¹éç¨äºæ¶é´åºåæ°æ®åºå­å¨ï¼èä¸æ¯æç¬æç promql æ¥è¯¢è¯­è¨ï¼åè½å¼ºå¤§èä¸ç®æ´ã\n\n\n# 6. æå¡æ²»ç\n\nå¾®æå¡æ²»çå¹³å°å°±æ¯ä¸æå¡æäº¤éçç»ä¸å¥å£ï¼æ è®ºæ¯å¼åäººåè¿æ¯è¿ç»´äººåï¼é½è½éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡åç§æä½ï¼æ¯å¦å¼åäººåå¯ä»¥éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡éçº§æä½ï¼è¿ç»´äººåå¯ä»¥éè¿è¿ä¸ªå¹³å°å¯¹æå¡è¿è¡ä¸ä¸çº¿æä½ï¼èä¸éè¦å³å¿è¿ä¸ªæä½èåçå·ä½å®ç°ã\n\nå¾®æå¡æ²»çå¹³å°å³é®ä¹å¤å°±å¨äºå®è½å¤å°è£å¯¹å¾®æå¡æ¶æåçåä¸ªåºç¡è®¾æ½ç»ä»¶çè°ç¨ï¼ä»èå¯¹å¤æä¾ç»ä¸çæå¡æä½ apiï¼èä¸è¿æä¾äºå¯è§åççé¢ï¼ä»¥æ¹ä¾¿å¼åäººååè¿ç»´äººåæä½ã\n\n\n\næå¡æ²»ççå¸¸ç¨ææ®µæï¼\n\n * èç¹ç®¡ç\n   * æ³¨åä¸­å¿ä¸»å¨æé¤æºå¶\n   * æå¡æ¶è´¹èæé¤æºå¶\n * è´è½½åè¡¡\n   * è½®è¯¢\n   * éæº\n   * æè¿æå°è¿æ¥\n   * ä¸è´æ§ hash\n * æå¡è·¯ç±\n   * ä¸å¡å­å¨ç°åº¦åå¸çéæ±\n   * å¤æºæ¿å°±è¿è®¿é®çéæ±\n * æå¡å®¹é\n   * failoverï¼å¤±è´¥èªå¨åæ¢\n   * failbackï¼å¤±è´¥éç¥\n   * failcacheï¼å¤±è´¥ç¼å­\n   * failfastï¼å¿«éå¤±è´¥\n\n\n# 7. api ç½å³\n\napi ç½å³æ¯ä¸ä¸ªæå¡å¨ï¼æ¯ç³»ç»çå¯ä¸å¥å£ãä»é¢åå¯¹è±¡è®¾è®¡çè§åº¦çï¼å®ä¸å¤è§æ¨¡å¼ç±»ä¼¼ãapi ç½å³å°è£äºç³»ç»åé¨æ¶æï¼ä¸ºæ¯ä¸ªå®¢æ·ç«¯æä¾ä¸ä¸ªå®å¶ç apiãå®å¯è½è¿å·æå¶å®èè´£ï¼å¦èº«ä»½éªè¯ãçæ§ãè´è½½åè¡¡ãç¼å­ãè¯·æ±åçä¸ç®¡çãéæååºå¤çã api ç½å³æ¹å¼çæ ¸å¿è¦ç¹æ¯ï¼ææçå®¢æ·ç«¯åæ¶è´¹ç«¯é½éè¿ç»ä¸çç½å³æ¥å¥å¾®æå¡ï¼å¨ç½å³å±å¤çææçéä¸å¡åè½ãéå¸¸ï¼ç½å³ä¹æ¯æä¾ rest/http çè®¿é® apiãæå¡ç«¯éè¿ api-gw æ³¨ååç®¡çæå¡ã\n\n\n# 7.1. zuul\n\n\n\nå¨ zuul ä¸­ï¼ æ´ä¸ªè¯·æ±çè¿ç¨æ¯è¿æ ·çï¼é¦åå°è¯·æ±ç» zuulservlet å¤çï¼zuulservlet ä¸­æä¸ä¸ª zuulrunner å¯¹è±¡ï¼è¯¥å¯¹è±¡ä¸­åå§åäº requestcontextï¼ä½ä¸ºå­å¨æ´ä¸ªè¯·æ±çä¸äºæ°æ®ï¼å¹¶è¢«ææç zuulfilter å±äº«ãzuulrunner ä¸­è¿æ filterprocessorï¼filterprocessor ä½ä¸ºæ§è¡ææç zuulfilter çç®¡çå¨ãfilterprocessor ä» filterloader ä¸­è·å zuulfilterï¼è zuulfilter æ¯è¢« filterfilemanager æå è½½ï¼å¹¶æ¯æ groovy ç­å è½½ï¼éç¨äºè½®è¯¢çæ¹å¼ç­å è½½ãæäºè¿äº filter ä¹åï¼zuulservelet é¦åæ§è¡ç pre ç±»åçè¿æ»¤å¨ï¼åæ§è¡ route ç±»åçè¿æ»¤å¨ï¼æåæ§è¡çæ¯ post ç±»åçè¿æ»¤å¨ï¼å¦æå¨æ§è¡è¿äºè¿æ»¤å¨æéè¯¯çæ¶ååä¼æ§è¡ error ç±»åçè¿æ»¤å¨ãæ§è¡å®è¿äºè¿æ»¤å¨ï¼æç»å°è¯·æ±çç»æè¿åç»å®¢æ·ç«¯ã\n\n\n# 8. è´è½½åè¡¡\n\n> åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 9. æå¡è·¯ç±\n\næå¡è·¯ç±å°±æ¯æå¡æ¶è´¹èå¨åèµ·æå¡è°ç¨æ¶ï¼å¿é¡»æ ¹æ®ç¹å®çè§åæ¥éæ©æå¡èç¹ï¼ä»èæ»¡è¶³æäºç¹å®çéæ±ã\n\n\n# 9.1. æå¡è·¯ç±çåºç¨åºæ¯\n\n * åç»è°ç¨ãä¸è¬æ¥è®²ï¼ä¸ºäºä¿è¯æå¡çé«å¯ç¨æ§ï¼å®ç°å¼å°å¤æ´»çéæ±ï¼ä¸ä¸ªæå¡å¾å¾ä¸æ­¢é¨ç½²å¨ä¸ä¸ªæ°æ®ä¸­å¿ï¼èä¸åºäºèçææ¬ç­èèï¼æäºä¸å¡å¯è½ä¸ä»å¨ç§ææºæ¿é¨ç½²ï¼è¿ä¼éç¨å¬æäºé¨ç½²ï¼çè³éç¨å¤å®¶å¬æäºé¨ç½²ãæå¡èç¹ä¹ä¼æç§ä¸åçæ°æ®ä¸­å¿åæä¸åçåç»ï¼è¿æ¶å¯¹äºæå¡æ¶è´¹èæ¥è¯´ï¼éæ©åªä¸ä¸ªåç»è°ç¨ï¼å°±å¿é¡»æç¸åºçè·¯ç±è§åã\n * ç°åº¦åå¸ãå¨æå¡ä¸çº¿åå¸çè¿ç¨ä¸­ï¼ä¸è¬éè¦åå¨ä¸å°é¨åè§æ¨¡çæå¡èç¹ä¸ååå¸æå¡ï¼ç¶åéªè¯åè½æ¯å¦æ­£å¸¸ãå¦ææ­£å¸¸çè¯å°±ç»§ç»­æ©å¤§åå¸èå´ï¼å¦æä¸æ­£å¸¸çè¯ï¼å°±éè¦ææ¥é®é¢ï¼è§£å³é®é¢åç»§ç»­åå¸ãè¿ä¸ªè¿ç¨å°±å«ä½ç°åº¦åå¸ï¼ä¹å«éä¸éé¨ç½²ã\n * æµéåæ¢ãå¨ä¸å¡çº¿ä¸è¿è¡è¿ç¨ä¸­ï¼ç»å¸¸ä¼éå°ä¸äºä¸å¯æåå ç´ å¯¼è´ä¸å¡æéï¼æ¯å¦æä¸ªæºæ¿çåç¼è¢«ææ­ï¼æèåççç«ç­äºæå¯¼è´æ´ä¸ªæºæ¿çæå¡é½ä¸å¯ç¨ãè¿ä¸ªæ¶åå°±éè¦æç§æä¸ªæä»¤ï¼è½å¤æåæ¥è°ç¨è¿ä¸ªæºæ¿æå¡çæµéåæ¢å°å¶ä»æ­£å¸¸çæºæ¿ã\n * è¯»ååç¦»ãå¯¹äºå¤§å¤æ°äºèç½ä¸å¡æ¥è¯´é½æ¯è¯»å¤åå°ï¼æä»¥å¨è¿è¡æå¡é¨ç½²çæ¶åï¼å¯ä»¥æè¯»ååå¼é¨ç½²ï¼ææåæ¥å£å¯ä»¥é¨ç½²å¨ä¸èµ·ï¼èè¯»æ¥å£é¨ç½²å¨å¦å¤çèç¹ä¸ã\n\n\n# 9.2. æå¡è·¯ç±çè§å\n\næå¡è·¯ç±ä¸»è¦æä¸¤ç§è§åï¼ä¸ç§æ¯æ¡ä»¶è·¯ç±ï¼ä¸ç§æ¯èæ¬è·¯ç±ã\n\n# 9.2.1. æ¡ä»¶è·¯ç±\n\næ¡ä»¶è·¯ç±æ¯åºäºæ¡ä»¶è¡¨è¾¾å¼çè·¯ç±è§åã\n\ncondition://0.0.0.0/dubbo.test.interfaces.testservice?category=routers&dynamic=true&priority=2&enabled=true&rule=" + url.encode(" host = 10.20.153.10=> host = 10.20.153.11")\n\n\nè¿éé¢ condition:// ä»£è¡¨äºè¿æ¯ä¸æ®µç¨æ¡ä»¶è¡¨è¾¾å¼ç¼åçè·¯ç±è§åï¼å·ä½çè§åæ¯\n\nhost = 10.20.153.10 => host = 10.20.153.11\n\n\nåéç¬¦â=>âåé¢æ¯æå¡æ¶è´¹èçå¹éæ¡ä»¶ï¼åé¢æ¯æå¡æä¾èçè¿æ»¤æ¡ä»¶ãå½æå¡æ¶è´¹èèç¹æ»¡è¶³å¹éæ¡ä»¶æ¶ï¼å°±å¯¹è¯¥æå¡æ¶è´¹èæ§è¡åé¢çè¿æ»¤è§åãé£ä¹ä¸é¢è¿æ®µè¡¨è¾¾å¼è¡¨è¾¾çæä¹å°±æ¯ ip ä¸ºâ10.20.153.10âçæå¡æ¶è´¹èé½è°ç¨ ip ä¸ºâ10.20.153.11âçæå¡æä¾èèç¹ã\n\nå¦ææå¡æ¶è´¹èçå¹éæ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºå¯¹ææçæå¡æ¶è´¹èåºç¨ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\n=> host ï¼= 10.20.153.11\n\n\nå¦ææå¡æä¾èçè¿æ»¤æ¡ä»¶ä¸ºç©ºï¼å°±è¡¨ç¤ºç¦æ­¢æå¡æ¶è´¹èè®¿é®ï¼å°±åä¸é¢çè¡¨è¾¾å¼ä¸æ ·ã\n\nhost = 10.20.153.10=>\n\n\nä¸é¢æä¸¾ä¸äº dubbo æ¡æ¶ä¸­çæ¡ä»¶è·¯ç±ï¼æ¥ç»ä½ è®²è§£ä¸æ¡ä»¶è·¯ç±çå·ä½åºç¨åºæ¯ã\n\n * æé¤æä¸ªæå¡èç¹\n\n=> host != 172.22.3.91\n\n\nä¸æ¦è¿æ¡è·¯ç±è§åè¢«åºç¨å°çº¿ä¸ï¼ææçæå¡æ¶è´¹èé½ä¸ä¼è®¿é® ip ä¸º 172.22.3.91 çæå¡èç¹ï¼è¿ç§è·¯ç±è§åä¸è¬åºç¨å¨çº¿ä¸æµéæé¤é¢åå¸æºä»¥åæé¤æä¸ªæéèç¹çåºæ¯ã\n\n * ç½åååé»åååè½\n\nhost != 10.20.153.10,10.20.153.11 =>\n\n\nè¿æ¡è·¯ç±è§åæææ¯é¤äº ip ä¸º 10.20.153.10 å 10.20.153.11 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ä»¥å¤ï¼å¶ä»æå¡æ¶è´¹èé½ä¸å¯ä»¥ï¼ä¸»è¦ç¨äºç½ååè®¿é®é»è¾ï¼æ¯å¦æä¸ªåå°æå¡åªåè®¸ç¹å®çå å°æºå¨æå¯ä»¥è®¿é®ï¼è¿æ ·çè¯å¯ä»¥æºå¨æ§å¶è®¿é®æéã\n\nhost = 10.20.153.10,10.20.153.11 =>\n\n\nåçï¼è¿æ¡è·¯ç±è§åæææ¯é¤äº ip ä¸º 10.20.153.10 å 10.20.153.11 çæå¡æ¶è´¹èä¸è½åèµ·æå¡è°ç¨ä»¥å¤ï¼å¶ä»æå¡æ¶è´¹èé½å¯ä»¥ï¼ä¹å°±æ¯å®ç°äºé»åååè½ï¼æ¯å¦çº¿ä¸ç»å¸¸ä¼éå°æäºè°ç¨æ¹ä¸ç®¡æ¯åºäºææè¿æ¯æ æçä¸åçè°ç¨ï¼å½±åäºæå¡çç¨³å®æ§ï¼è¿æ¶åå¯ä»¥éè¿é»åååè½ææ¶äºä»¥å°æã\n\n * æºæ¿éç¦»\n\nhost = 172.22.3.* => host = 172.22.3.*\n\n\nè¿æ¡è·¯ç±è§åæææ¯ ip ç½æ®µä¸º 172.22.3.* çæå¡æ¶è´¹èï¼æå¯ä»¥è®¿é®åç½æ®µçæå¡èç¹ï¼è¿ç§è§åä¸è¬åºç¨äºæå¡é¨ç½²å¨å¤ä¸ª idcï¼çè®ºä¸åä¸ä¸ª idc åçè°ç¨æ§è½è¦æ¯è·¨ idc è°ç¨æ§è½è¦å¥½ï¼åºç¨è¿ä¸ªè§åæ¯ä¸ºäºå®ç°å idc å°±è¿è®¿é®ã\n\n * è¯»ååç¦»\n\nmethod = find*,list*,get*,is* => host =172.22.3.94,172.22.3.95\nmethod != find*,list*,get*,is* => host = 172.22.3.97,172.22.3.98\n\n\nè¿æ¡è·¯ç±è§åæææ¯ find*ãget*ãis* ç­è¯»æ¹æ³è°ç¨ ip ä¸º 172.22.3.94 å 172.22.3.95 çèç¹ï¼é¤æ­¤ä»¥å¤çåæ¹æ³è°ç¨ ip ä¸º 172.22.3.97 å 172.22.3.98 çèç¹ãå¯¹äºå¤§é¨åäºèç½ä¸å¡æ¥è¯´ï¼å¾å¾è¯»è¯·æ±è¦è¿è¿å¤§äºåè¯·æ±ï¼èåè¯·æ±çéè¦æ§å¾å¾è¦è¿è¿é«äºè¯»è¯·æ±ï¼æä»¥éè¦æè¯»åè¯·æ±è¿è¡åç¦»ï¼ä»¥é¿åè¯»è¯·æ±å¼å¸¸å½±åå°åè¯·æ±ï¼è¿æ¶åå°±å¯ä»¥åºç¨è¿ç§è§åã\n\n# 9.2.2. èæ¬è·¯ç±\n\nèæ¬è·¯ç±æ¯åºäºèæ¬è¯­è¨çè·¯ç±è§åï¼å¸¸ç¨çèæ¬è¯­è¨æ¯å¦ javascriptãgroovyãjruby ç­ã\n\n"script://0.0.0.0/com.foo.barservice?category=routers&dynamic=false&rule=" + url.encode("ï¼function route(invokers) { ... } (invokers)ï¼")\n\n\nè¿éé¢âscript://âå°±ä»£è¡¨äºè¿æ¯ä¸æ®µèæ¬è¯­è¨ç¼åçè·¯ç±è§åï¼å·ä½è§åå®ä¹å¨èæ¬è¯­è¨ç route æ¹æ³å®ç°éï¼æ¯å¦ä¸é¢è¿æ®µç¨ javascript ç¼åç route() æ¹æ³è¡¨è¾¾çæææ¯ï¼åªæ ip ä¸º 10.20.153.10 çæå¡æ¶è´¹èå¯ä»¥åèµ·æå¡è°ç¨ã\n\nfunction route(invokers){\n  var result = new java.util.arraylist(invokers.size());\n  for(i =0; i < invokers.size(); i ++){\n    if("10.20.153.10".equals(invokers.get(i).geturl().gethost())){\n       result.add(invokers.get(i));\n    }\n  }\n  return result;\n } (invokers)ï¼;\n\n\n\n# 9.3. æå¡è·¯ç±çè·åæ¹å¼\n\næå¡è·¯ç±çè·åæ¹å¼ä¸»è¦æä¸ç§ï¼\n\n * æ¬å°éç½®\n\né¡¾åæä¹å°±æ¯è·¯ç±è§åå­å¨å¨æå¡æ¶è´¹èæ¬å°ä¸ãæå¡æ¶è´¹èåèµ·è°ç¨æ¶ï¼ä»æ¬å°åºå®ä½ç½®è¯»åè·¯ç±è§åï¼ç¶åæç§è·¯ç±è§åéåä¸ä¸ªæå¡èç¹åèµ·è°ç¨ã\n\n * éç½®ä¸­å¿ç®¡ç\n\nè¿ç§æ¹å¼ä¸ï¼ææçæå¡æ¶è´¹èé½ä»éç½®ä¸­å¿è·åè·¯ç±è§åï¼ç±éç½®ä¸­å¿æ¥ç»ä¸ç®¡çã\n\n * å¨æä¸å\n\nè¿ç§æ¹å¼ä¸ï¼ä¸è¬æ¯è¿ç»´äººåæèå¼åäººåï¼éè¿æå¡æ²»çå¹³å°ä¿®æ¹è·¯ç±è§åï¼æå¡æ²»çå¹³å°è°ç¨éç½®ä¸­å¿æ¥å£ï¼æä¿®æ¹åçè·¯ç±è§åæä¹åå°éç½®ä¸­å¿ãå ä¸ºæå¡æ¶è´¹èè®¢éäºè·¯ç±è§åçåæ´ï¼äºæ¯å°±ä¼ä»éç½®ä¸­å¿è·åææ°çè·¯ç±è§åï¼æç§ææ°çè·¯ç±è§åæ¥æ§è¡ã\n\n\n# 9.4. åé¨æå¡è°ç¨\n\nåºç¡æå¡ä¹é´çè°ç¨ï¼ç»åæå¡æ³¨åä¸­å¿ä»¥åä¸å±çå·æè´è½½åè¡¡åè½çå®¢æ·ç«¯ï¼å¦ eureka+ï¼resttemplate+ribbonï¼æè eureka+feign èåæå¡è°ç¨ï¼ç»åæå¡æ³¨åä¸­å¿ä»¥åä¸å±çå·æè´è½½åè¡¡åè½çå®¢æ·ç«¯ï¼å¦ eureka+ï¼resttemplate+ribbonï¼æè eureka+feign\n\n\n\n\n# 9.5. å¤é¨æå¡è°ç¨\n\nåºäº netflix ç zuulï¼åäºç®åäºè§£ï¼springcloud ä¸ zuul éæçæ¹å¼ãè¿éåå¯¹æ ¸å¿æµç¨åä¸ªç®åäºè§£ï¼åç»­ä¼ææ·±å¥çåºç¨ãåæã\n\nspring cloud å¾å¥½çéæäº zuulï¼å¹¶ä¸å¯ä»¥éè¿æ³¨è§£çå½¢å¼æ¥è¿è¡è¯·æ±çååè·¯ç±ä»¥å api ç½å³åè½ spring cloud éæ zuulï¼å¯¹ä¸ url æ å°çå¤çæ¹å¼ä¸ springmvc å¯¹ url çè¯·æ±æ¹å¼ç±»ä¼¼ï¼é½æ¯éè¿ requestmapping æ¥è¿è¡è¯·æ±ç»å®çãæ ¸å¿ç±»ï¼zuulhandlermapping zuul çæ ¸å¿æ¯ zuulservletï¼ä¸ä¸ªè¯·æ±æ ¸å¿æµç¨ï¼httpservletrequest â>zuulhandlermapping â>zuulcontroller â> zuulservlet â> zuulfilter â> httpservletresponse\n\n\n# 10. éç½®ä¸­å¿\n\néç½®ä¸­å¿çæè·¯å°±æ¯ææå¡çåç§éç½®ï¼å¦ä»£ç ééç½®çåç§åæ°ãæå¡éçº§çå¼å³çè³ä¾èµçèµæºç­é½å¨ä¸ä¸ªå°æ¹ç»ä¸è¿è¡ç®¡çãæå¡å¯å¨æ¶ï¼å¯ä»¥èªå¨ä»éç½®ä¸­å¿ä¸­æåæéçéç½®ï¼å¹¶ä¸å¦ææéç½®åæ´çæåµï¼åæ ·å¯ä»¥èªå¨ä»éç½®ä¸­å¿æåææ°çéç½®ä¿¡æ¯ï¼æå¡æ é¡»éæ°åå¸ã\n\néç½®ä¸­å¿ä¸è¬åå«ä¸é¢å ä¸ªåè½ï¼\n\n * éç½®æ³¨ååè½\n * éç½®åæ³¨ååè½\n * éç½®æ¥çåè½\n * éç½®åæ´è®¢éåè½\n\n\n# 10.1. apollo\n\næºç¨å¼æºçåå¸å¼éç½®ä¸­å¿ï¼æ¯æ java å.net è¯­è¨ï¼å®¢æ·ç«¯åéç½®ä¸­å¿éè¿ http é¿è¿æ¥å®ç°å®æ¶æ¨éï¼å¹¶ä¸æç»ä¸çç®¡ççé¢æ¥å®ç°éç½®ç®¡çã\n\n\n\n\n# 10.2. spring cloud git\n\nspring cloud ä¸­ä½¿ç¨çéç½®ä¸­å¿ç»ä»¶ï¼åªæ¯æ java è¯­è¨ï¼éç½®å­å¨å¨ git ä¸­ï¼åæ´éç½®ä¹éè¦éè¿ git æä½ï¼å¦æéç½®ä¸­å¿æéç½®åæ´ï¼éè¦æå¨å·æ°ã\n\n\n\n\n# 11. é¾è·¯è¿½è¸ª\n\n\n# 11.1. é¾è·¯è¿½è¸ªçä½ç¨\n\n * ä¼åç³»ç»ç¶é¢\n * ä¼åé¾è·¯è°ç¨\n * çæç½ç»ææ\n * éæä¼ è¾æ°æ®\n\n\n# 11.2. é¾è·¯è¿½è¸ªçåç\n\nçè§£é¾è·¯è¿½è¸ªå¿é¡»åäºè§£ä»¥ä¸æ¦å¿µï¼\n\n * traceidï¼ç¨äºæ è¯æä¸æ¬¡å·ä½çè¯·æ± idãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼ä¼å¨ rpc è°ç¨ç½ç»çç¬¬ä¸å±çæä¸ä¸ªå¨å±å¯ä¸ç traceidï¼å¹¶ä¸ä¼éçæ¯ä¸å±ç rpc è°ç¨ï¼ä¸æ­å¾åä¼ éï¼è¿æ ·çè¯éè¿ traceid å°±å¯ä»¥æä¸æ¬¡ç¨æ·è¯·æ±å¨ç³»ç»ä¸­è°ç¨çè·¯å¾ä¸²èèµ·æ¥ã\n * spanidï¼ç¨äºæ è¯ä¸æ¬¡ rpc è°ç¨å¨åå¸å¼è¯·æ±ä¸­çä½ç½®ãå½ç¨æ·çè¯·æ±è¿å¥ç³»ç»åï¼å¤å¨ rpc è°ç¨ç½ç»çç¬¬ä¸å± a æ¶ spanid åå§å¼æ¯ 0ï¼è¿å¥ä¸ä¸å± rpc è°ç¨ b çæ¶å spanid æ¯ 0.1ï¼ç»§ç»­è¿å¥ä¸ä¸å± rpc è°ç¨ c æ¶ spanid æ¯ 0.1.1ï¼èä¸ b å¤å¨åä¸å±ç rpc è°ç¨ e ç spanid æ¯ 0.2ï¼è¿æ ·çè¯éè¿ spanid å°±å¯ä»¥å®ä½æä¸æ¬¡ rpc è¯·æ±å¨ç³»ç»è°ç¨ä¸­æå¤çä½ç½®ï¼ä»¥åå®çä¸ä¸æ¸¸ä¾èµåå«æ¯è°ã\n * annotationï¼ç¨äºä¸å¡èªå®ä¹åç¹æ°æ®ï¼å¯ä»¥æ¯ä¸å¡æå´è¶£çæ³ä¸ä¼ å°åç«¯çæ°æ®ï¼æ¯å¦ä¸æ¬¡è¯·æ±çç¨æ· uidã\n\n\n\n\n# 11.3. é¾è·¯è¿½è¸ªçå®ç°\n\nä¸ä¸ªæå¡è¿½è¸ªç³»ç»ä¸è¬å¯ä»¥åä¸ºä¸å±ï¼\n\n * æ°æ®ééå±ï¼è´è´£æ°æ®åç¹å¹¶ä¸æ¥ã\n * æ°æ®å¤çå±ï¼è´è´£æ°æ®çå­å¨ä¸è®¡ç®ã\n * æ°æ®å±ç¤ºå±ï¼è´è´£æ°æ®çå¾å½¢åå±ç¤ºã\n\n# 11.3.1. æ°æ®ééå±\n\nä¸æ¬¡ rpc è¯·æ±å¯ä»¥åä¸ºåä¸ªé¶æ®µã\n\n * csï¼client sendï¼é¶æ®µ : å®¢æ·ç«¯åèµ·è¯·æ±ï¼å¹¶çæè°ç¨çä¸ä¸æã\n * srï¼server recieveï¼é¶æ®µ : æå¡ç«¯æ¥æ¶è¯·æ±ï¼å¹¶çæä¸ä¸æã\n * ssï¼server sendï¼é¶æ®µ : æå¡ç«¯è¿åè¯·æ±ï¼è¿ä¸ªé¶æ®µä¼å°æå¡ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸é¢è¿å¼ å¾å¯ä»¥è¯´æä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanid=0.1ï¼appkey=bï¼method=b.methodï¼start=103ï¼duration=38ã\n * crï¼client recieveï¼é¶æ®µ : å®¢æ·ç«¯æ¥æ¶è¿åç»æï¼è¿ä¸ªé¶æ®µä¼å°å®¢æ·ç«¯ä¸ä¸ææ°æ®ä¸æ¥ï¼ä¸æ¥çæ°æ®æï¼traceid=123456ï¼spanid=0.1ï¼appkey=aï¼method=b.methodï¼start=103ï¼duration=38ã\n\n# 11.3.2. æ°æ®å¤çå±\n\næ°æ®å¤çå±çä½ç¨å°±æ¯ææ°æ®ééå±ä¸æ¥çæ°æ®æéè®¡ç®ï¼ç¶åè½å°å­å¨ä¾æ¥è¯¢ä½¿ç¨ã\n\n * å®æ¶æ°æ®å¤ç\n\néå¯¹å®æ¶æ°æ®å¤çï¼ä¸è¬éç¨ storm æè spark streaming æ¥å¯¹é¾è·¯æ°æ®è¿è¡å®æ¶èåå å·¥ï¼å­å¨ä¸è¬ä½¿ç¨ oltp æ°æ®ä»åºï¼æ¯å¦ hbaseï¼ä½¿ç¨ traceid ä½ä¸º rowkeyï¼è½å¤©ç¶å°æä¸æ´æ¡è°ç¨é¾èåå¨ä¸èµ·ï¼æé«æ¥è¯¢æçã\n\n * ç¦»çº¿æ°æ®å¤ç\n\néå¯¹ç¦»çº¿æ°æ®å¤çï¼ä¸è¬éè¿è¿è¡ mapreduce æè spark æ¹å¤çç¨åºæ¥å¯¹é¾è·¯æ°æ®è¿è¡ç¦»çº¿è®¡ç®ï¼å­å¨ä¸è¬ä½¿ç¨ hiveã\n\n# 11.3.3. æ°æ®å±ç¤ºå±\n\næ°æ®å±ç¤ºå±çä½ç¨å°±æ¯å°å¤çåçé¾è·¯ä¿¡æ¯ä»¥å¾å½¢åçæ¹å¼å±ç¤ºç»ç¨æ·ã\n\nå®éé¡¹ç®ä¸­ä¸»è¦ç¨å°ä¸¤ç§å¾å½¢å±ç¤ºï¼ä¸ç§æ¯è°ç¨é¾è·¯å¾ï¼ä¸ç§æ¯è°ç¨ææå¾ã\n\n\n# 11.4. é¾è·¯è¿½è¸ªæ¹æ¡å¯¹æ¯\n\n\n\n\n# 12. éæµçæ­\n\nä¸è¬èè¨ï¼éç¾¤æéçäº§çåå ä¸å¤ä¹æä¸¤ç§ï¼\n\nä¸ç§æ¯ä»£ç  bug æå¯¼è´ï¼æ¯å¦è¯´æä¸æ®µ java ä»£ç ä¸æ­å°åéå¤§å¯¹è±¡ï¼ä½æ²¡æåæ¶åæ¶å¯¼è´ jvm oom éåºï¼\n\nå¦ä¸ç§æ¯çªåçæµéå²å»ï¼è¶åºäºç³»ç»çæå¤§æ¿è½½è½åï¼æ¯å¦âå 11âè¿ç§è´­ç©æ´»å¨ï¼çµåç³»ç»ä¼å¨é¶ç¹ä¸ç¬é´æ¶å¥å¤§éæµéï¼è¶åºç³»ç»çæå¤§æ¿è½½è½åï¼ä¸ä¸å­å°±ææ´ä¸ªç³»ç»ç»åå®äºã\n\nåºä»éç¾¤æéçæè·¯ï¼ä¸»è¦æä¸¤ç§ï¼éæµåéçº§ã\n\n\n# 12.1. éæµ\n\néæµå°±æ¯éå¶æµéãéå¸¸æåµä¸ï¼ç³»ç»è½å¤æ¿è½½çæµéæ ¹æ®éç¾¤è§æ¨¡çå¤§å°æ¯åºå®çï¼å¯ä»¥ç§°ä¹ä¸ºç³»ç»çæå¤§å®¹éãå½çå®æµéè¶è¿äºç³»ç»çæå¤§å®¹éåï¼å°±ä¼å¯¼è´ç³»ç»ååºåæ¢ï¼æå¡è°ç¨åºç°å¤§éè¶æ¶ï¼åæ ç»ç¨æ·çæè§å°±æ¯å¡é¡¿ãæ ååºãæä»¥ï¼åºè¯¥æ ¹æ®ç³»ç»çæå¤§å®¹éï¼ç»ç³»ç»è®¾ç½®ä¸ä¸ªéå¼ï¼è¶è¿è¿ä¸ªéå¼çè¯·æ±ä¼è¢«èªå¨æå¼ï¼è¿æ ·çè¯å¯ä»¥æå¤§éåº¦å°ä¿è¯ç³»ç»æä¾çæå¡æ­£å¸¸ã\n\né¤æ­¤ä¹å¤ï¼éå¸¸ä¸ä¸ªå¾®æå¡ç³»ç»ä¼åæ¶æä¾å¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡å¨åä¸æ¶å»çè¯·æ±éä¹æ¯ä¸åçï¼å¾å¯è½åºç°çä¸ç§æåµå°±æ¯ï¼ç³»ç»ä¸­æä¸ªæå¡çè¯·æ±éçªå¢ï¼å ç¨äºç³»ç»ä¸­å¤§é¨åèµæºï¼å¯¼è´å¶ä»æå¡æ²¡æèµæºå¯ç¨ãå æ­¤ï¼è¿è¦éå¯¹ç³»ç»ä¸­æ¯ä¸ªæå¡çè¯·æ±éä¹è®¾ç½®ä¸ä¸ªéå¼ï¼è¶è¿è¿ä¸ªéå¼çè¯·æ±ä¹è¦è¢«èªå¨æå¼ï¼è¿æ ·çè¯ä¸è³äºå ä¸ºä¸ä¸ªæå¡å½±åäºå¶ä»æææå¡ã\n\nå¨å®éé¡¹ç®ä¸­ï¼å¯ä»¥ç¨ä¸¤ä¸ªææ æ¥è¡¡éæå¡çè¯·æ±éï¼ä¸ä¸ªæ¯ qps å³æ¯ç§è¯·æ±éï¼ä¸ä¸ªæ¯å·¥ä½çº¿ç¨æ°ãä¸è¿ qps å ä¸ºä¸åæå¡çååºå¿«æ¢ä¸åï¼æä»¥ç³»ç»è½å¤æ¿è½½ç qps ç¸å·®å¾å¤§ï¼å æ­¤ä¸è¬éæ©å·¥ä½çº¿ç¨æ°æ¥ä½ä¸ºéæµçææ ï¼ç»ç³»ç»è®¾ç½®ä¸ä¸ªæ»çæå¤§å·¥ä½çº¿ç¨æ°ä»¥ååä¸ªæå¡çæå¤§å·¥ä½çº¿ç¨æ°ï¼è¿æ ·çè¯æ è®ºæ¯ç³»ç»çæ»è¯·æ±éè¿å¤§å¯¼è´æ´ä½å·¥ä½çº¿ç¨æ°éè¾¾å°æå¤§å·¥ä½çº¿ç¨æ°ï¼è¿æ¯æä¸ªæå¡çè¯·æ±éè¶è¿åä¸ªæå¡çæå¤§å·¥ä½çº¿ç¨æ°ï¼é½ä¼è¢«éæµï¼ä»¥èµ·å°ä¿æ¤æ´ä¸ªç³»ç»çä½ç¨ã\n\n\n# 12.2. éçº§\n\nä»ä¹æ¯éçº§å¢ï¼å¨æçæ¥ï¼éçº§å°±æ¯éè¿åæ­¢ç³»ç»ä¸­çæäºåè½ï¼æ¥ä¿è¯ç³»ç»æ´ä½çå¯ç¨æ§ãéçº§å¯ä»¥è¯´æ¯ä¸ç§è¢«å¨é²å¾¡çæªæ½ï¼ä¸ºä»ä¹è¿ä¹è¯´å¢ï¼å ä¸ºå®ä¸è¬æ¯ç³»ç»å·²ç»åºç°æéåæéåçä¸ç§æ­¢ææªæ½ã\n\né£ä¹éçº§ä¸è¬æ¯å¦ä½å®ç°çå¢ï¼æ ¹æ®æçå®è·µæ¥çï¼ ä¸ç§å¯è¡çæ¹æ¡æ¯éè¿å¼å³æ¥å®ç°ã\n\nå·ä½æ¥è®²ï¼å°±æ¯å¨ç³»ç»è¿è¡çåå­ä¸­å¼è¾ä¸ååºåï¼ä¸é¨ç¨äºå­å¨å¼å³çç¶æï¼ä¹å°±æ¯å¼å¯è¿æ¯å³é­ãå¹¶ä¸éè¦çå¬æä¸ªç«¯å£ï¼éè¿è¿ä¸ªç«¯å£å¯ä»¥åç³»ç»ä¸åå½ä»¤ï¼æ¥æ¹ååå­ä¸­å¼å³çç¶æãå½å¼å³å¼å¯æ¶ï¼ä¸å¡çæä¸æ®µé»è¾å°±ä¸åæ§è¡ï¼èæ­£å¸¸æåµä¸ï¼å¼å³æ¯å³é­çç¶æã\n\nå¼å³ä¸è¬ç¨å¨ä¸¤ç§å°æ¹ï¼ä¸ç§æ¯æ°å¢çä¸å¡é»è¾ï¼å ä¸ºæ°å¢çä¸å¡é»è¾ç¸å¯¹æ¥è¯´ä¸æçï¼å¾å¾å·å¤ä¸å®çé£é©ï¼æä»¥éè¦å å¼å³æ¥æ§å¶æ°ä¸å¡é»è¾æ¯å¦æ§è¡ï¼å¦ä¸ç§æ¯ä¾èµçæå¡æèµæºï¼å ä¸ºä¾èµçæå¡æèèµæºä¸æ»æ¯å¯é çï¼æä»¥æå¥½æ¯æå¼å³è½å¤æ§å¶æ¯å¦å¯¹ä¾èµæå¡æèµæºåèµ·è°ç¨ï¼æ¥ä¿è¯å³ä½¿ä¾èµåºç°é®é¢ï¼ä¹è½éè¿éçº§æ¥é¿åå½±åã\n\nå¨å®éä¸å¡åºç¨çæ¶åï¼éçº§è¦æç§å¯¹ä¸å¡çå½±åç¨åº¦è¿è¡åçº§ï¼ä¸è¬åä¸ºä¸çº§ï¼ä¸çº§éçº§æ¯å¯¹ä¸å¡å½±åæå°çéçº§ï¼å¨æéçæåµä¸ï¼é¦åæ§è¡ä¸çº§éçº§ï¼æä»¥ä¸çº§éçº§ä¹å¯ä»¥è®¾ç½®æèªå¨éçº§ï¼ä¸éè¦äººä¸ºå¹²é¢ï¼äºçº§éçº§æ¯å¯¹ä¸å¡æä¸å®å½±åçéçº§ï¼å¨æéçæåµä¸ï¼å¦æä¸çº§éçº§èµ·ä¸å°å¤å¤§ä½ç¨çæ¶åï¼å¯ä»¥äººä¸ºéåæªæ½ï¼æ§è¡äºçº§éçº§ï¼ä¸çº§éçº§æ¯å¯¹ä¸å¡æè¾å¤§å½±åçéçº§ï¼è¿ç§éçº§è¦ä¹æ¯å¯¹åä¸æ¶å¥æéå¤§å½±åï¼è¦ä¹æ¯å¯¹ç¨æ·ä½éªæéå¤§å½±åï¼æä»¥æä½èµ·æ¥è¦éå¸¸è°¨æï¼ä¸å¨æåæ¶å»ä¸è¬ä¸äºéç¨ã\n\n\n# 13. devops\n\n\n# 13.1. å®¹å¨åå®¹å¨å¹³å°\n\nmesosãmarathonãkubernetes\n\n\n# 14. rpc éå\n\n\n# 14.1. éå®è¯­è¨ rpc\n\nè·è¯­è¨å¹³å°ç»å®çå¼æº rpc æ¡æ¶ä¸»è¦æä¸é¢å ç§ã\n\n * dubboï¼å½åææ©å¼æºç rpc æ¡æ¶ï¼ç±é¿éå·´å·´å¬å¸å¼åå¹¶äº 2011 å¹´æ«å¯¹å¤å¼æºï¼ä»æ¯æ java è¯­è¨ã\n * motanï¼å¾®ååé¨ä½¿ç¨ç rpc æ¡æ¶ï¼äº 2016 å¹´å¯¹å¤å¼æºï¼ä»æ¯æ java è¯­è¨ã\n * tarsï¼è¾è®¯åé¨ä½¿ç¨ç rpc æ¡æ¶ï¼äº 2017 å¹´å¯¹å¤å¼æºï¼ä»æ¯æ c++ è¯­è¨ã\n * spring cloudï¼å½å¤ pivotal å¬å¸ 2014 å¹´å¯¹å¤å¼æºç rpc æ¡æ¶ï¼ä»æ¯æ java è¯­è¨ï¼æè¿å å¹´çæåå±å¾æ¯è¾å¥½ï¼æ¯æ¯è¾ç«ç rpc æ¡æ¶ã\n\næä»¥å¾ææ¾ï¼å¦æä½ çä¸å¡åºæ¯ä»ä»å±éäºä¸ç§è¯­è¨çè¯ï¼å¯ä»¥éæ©è·è¯­è¨ç»å®ç rpc æ¡æ¶ä¸­çä¸ç§ï¼å¦ææ¶åå¤ä¸ªè¯­è¨å¹³å°ä¹é´çç¸äºè°ç¨ï¼å°±åºè¯¥éæ©è·¨è¯­è¨å¹³å°ç rpc æ¡æ¶ã\n\nä»ç»åæï¼å¯ä»¥çåº spring cloud ä¸ä»æä¾äºåºæ¬ç rpc æ¡æ¶åè½ï¼è¿æä¾äºæå¡æ³¨åç»ä»¶ãéç½®ä¸­å¿ç»ä»¶ãè´è½½åè¡¡ç»ä»¶ãæ­è·¯å¨ç»ä»¶ãåå¸å¼æ¶æ¯è¿½è¸ªç»ä»¶ç­ä¸ç³»åç»ä»¶ï¼ä¹é¾æªè¢«ææ¯åçäººç§°ä¹ä¸ºâspring cloud å¨å®¶æ¡¶âãå¦æä½ ä¸æ³èªå·±å®ç°ä»¥ä¸è¿äºåè½ï¼é£ä¹ spring cloud åºæ¬å¯ä»¥æ»¡è¶³ä½ çå¨é¨éæ±ãè dubboãmotan åºæ¬ä¸åªæä¾äºæåºç¡ç rpc æ¡æ¶çåè½ï¼å¶ä»å¾®æå¡ç»ä»¶é½éè¦èªå·±å»å®ç°ãä¸è¿ç±äº spring cloud ç rpc éä¿¡éç¨äº http åè®®ï¼ç¸æ¯ dubbo å motan æéç¨çç§æåè®®æ¥è¯´ï¼å¨é«å¹¶åçéä¿¡åºæ¯ä¸ï¼æ§è½ç¸å¯¹è¦å·®ä¸äºï¼æä»¥å¯¹æ§è½æèå»è¦æ±çæåµä¸ï¼å¯ä»¥èè dubbo å motanã\n\n\n# 14.2. è·¨è¯­è¨ rpc\n\nèè·¨è¯­è¨å¹³å°çå¼æº rpc æ¡æ¶ä¸»è¦æä»¥ä¸å ç§ã\n\n * grpcï¼google äº 2015 å¹´å¯¹å¤å¼æºçè·¨è¯­è¨ rpc æ¡æ¶ï¼æ¯æå¸¸ç¨ç c++ãjavaãpythonãgoãrubyãphpãandroid javaãobjective-c ç­å¤ç§è¯­è¨ã\n * thriftï¼æåæ¯ç± facebook å¼åçåé¨ç³»ç»è·¨è¯­è¨ç rpc æ¡æ¶ï¼2007 å¹´è´¡ç®ç»äº apache åºéï¼æä¸º apache å¼æºé¡¹ç®ä¹ä¸ï¼æ¯æå¸¸ç¨ç c++ãjavaãphpãpythonãrubyãerlang ç­å¤ç§è¯­è¨ã\n\nä»æçåº¦ä¸æ¥è®²ï¼thrift å ä¸ºè¯ççæ¶é´è¦æ©äº grpcï¼æä»¥ä½¿ç¨çèå´è¦é«äº grpcï¼å¨ hbaseãhadoopãscribeãcassandra ç­è®¸å¤å¼æºç»ä»¶ä¸­é½å¾å°äºå¹¿æ³å°åºç¨ãèä¸ thrift æ¯æå¤è¾¾ 25 ç§è¯­è¨ï¼è¿è¦æ¯ grpc æ¯æçè¯­è¨æ´å¤ï¼æä»¥å¦æéå° grpc ä¸æ¯æçè¯­è¨åºæ¯ä¸ï¼éæ© thrift æ´åéã\n\nä½ grpc ä½ä¸ºåèµ·ä¹ç§ï¼å ä¸ºéç¨äº http/2 ä½ä¸ºéä¿¡åè®®ãprotobuf ä½ä¸ºæ°æ®åºååæ ¼å¼ï¼å¨ç§»å¨ç«¯è®¾å¤çåºç¨ä»¥åå¯¹ä¼ è¾å¸¦å®½æ¯è¾ææçåºæ¯ä¸å·æå¾å¤§çä¼å¿ï¼èä¸å¼åææ¡£ä¸°å¯ï¼æ ¹æ® protobuf æä»¶çæçä»£ç è¦æ¯ thrift æ´ç®æ´ä¸äºï¼ä»ä½¿ç¨é¾æç¨åº¦ä¸æ´å ä¼å¿ï¼æä»¥å¦æä½¿ç¨çè¯­è¨å¹³å° grpc æ¯æçè¯ï¼å»ºè®®è¿æ¯éç¨ grpc æ¯è¾å¥½ã\n\n\n# 15. service mesh\n\n\n\n\n# 15.1. service mesh çå®ç°åç\n\nservice mesh å®ç°çå³é®å°±å¨äºä¸¤ç¹ï¼\n\nä¸ä¸ªæ¯ä¸é¢æå°çè½»éçº§çç½ç»ä»£çä¹å« sidecarï¼å®çä½ç¨å°±æ¯è½¬åæå¡ä¹é´çè°ç¨ï¼\n\nä¸ä¸ªæ¯åºäº sidecar çæå¡æ²»çä¹è¢«å«ä½ control planeï¼å®çä½ç¨æ¯å sidecar åéåç§æä»¤ï¼ä»¥å®æåç§æå¡æ²»çåè½ãä¸é¢æå°±æ¥è¯¦ç»è®²è§£è¿ä¸¤ç¹æ¯å¦ä½å®ç°çã\n\n\n# 16. åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡\n * rpc å®æä¸æ ¸å¿åç\n * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n * è°è°å¾®æå¡ä¸­ç api ç½å³ï¼api gatewayï¼',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å¾®æå¡ç®ä»",frontmatter:{title:"å¾®æå¡ç®ä»",categories:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],tags:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],abbrlink:"2c46bfa7",date:"2022-04-15T16:42:51.000Z",permalink:"/pages/f13c06/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/04.%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%AE%80%E4%BB%8B.html",relativePath:"02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/01.å¾®æå¡ç®ä».md",key:"v-056e1262",path:"/pages/f13c06/",headers:[{level:2,title:"ä»ä¹æ¯å¾®æå¡",slug:"ä»ä¹æ¯å¾®æå¡",normalizedTitle:"ä»ä¹æ¯å¾®æå¡",charIndex:12},{level:3,title:"åä½åºç¨",slug:"åä½åºç¨",normalizedTitle:"åä½åºç¨",charIndex:285},{level:3,title:"å¾®æå¡",slug:"å¾®æå¡",normalizedTitle:"å¾®æå¡",charIndex:2},{level:2,title:"ä½æ¶éè¦å¾®æå¡",slug:"ä½æ¶éè¦å¾®æå¡",normalizedTitle:"ä½æ¶éè¦å¾®æå¡",charIndex:889},{level:3,title:"æåæå¡çæèç»´åº¦",slug:"æåæå¡çæèç»´åº¦",normalizedTitle:"æåæå¡çæèç»´åº¦",charIndex:973},{level:3,title:"æåæå¡çåå",slug:"æåæå¡çåå",normalizedTitle:"æåæå¡çåå",charIndex:1209},{level:3,title:"æåæå¡çåç½®æ¡ä»¶",slug:"æåæå¡çåç½®æ¡ä»¶",normalizedTitle:"æåæå¡çåç½®æ¡ä»¶",charIndex:1261},{level:2,title:"å¾®æå¡çåºç¡æ¶æ",slug:"å¾®æå¡çåºç¡æ¶æ",normalizedTitle:"å¾®æå¡çåºç¡æ¶æ",charIndex:1973},{level:3,title:"æå¡æè¿°",slug:"æå¡æè¿°",normalizedTitle:"æå¡æè¿°",charIndex:2012},{level:3,title:"æ³¨åä¸­å¿",slug:"æ³¨åä¸­å¿",normalizedTitle:"æ³¨åä¸­å¿",charIndex:1506},{level:3,title:"æå¡æ¡æ¶",slug:"æå¡æ¡æ¶",normalizedTitle:"æå¡æ¡æ¶",charIndex:2028},{level:3,title:"æå¡çæ§",slug:"æå¡çæ§",normalizedTitle:"æå¡çæ§",charIndex:2036},{level:3,title:"æå¡é¾è·¯è¿½è¸ª",slug:"æå¡é¾è·¯è¿½è¸ª",normalizedTitle:"æå¡é¾è·¯è¿½è¸ª",charIndex:3373},{level:3,title:"æå¡æ²»ç",slug:"æå¡æ²»ç",normalizedTitle:"æå¡æ²»ç",charIndex:792},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:4299}],headersStr:"ä»ä¹æ¯å¾®æå¡ åä½åºç¨ å¾®æå¡ ä½æ¶éè¦å¾®æå¡ æåæå¡çæèç»´åº¦ æåæå¡çåå æåæå¡çåç½®æ¡ä»¶ å¾®æå¡çåºç¡æ¶æ æå¡æè¿° æ³¨åä¸­å¿ æå¡æ¡æ¶ æå¡çæ§ æå¡é¾è·¯è¿½è¸ª æå¡æ²»ç åèèµæ",content:"# å¾®æå¡ç®ä»\n\n\n# ä»ä¹æ¯å¾®æå¡\n\n> Martin Fowler ä¸ James Lewis å±åæåºäºå¾®æå¡çæ¦å¿µï¼å®ä¹äºå¾®æå¡æ¯ç±åä¸åºç¨ç¨åºææçå°æå¡ï¼èªå·±æ¥æèªå·±çè¿ç¨ä¸è½»éåå¤çï¼æå¡ä¾ä¸å¡åè½è®¾è®¡ï¼ä»¥å¨èªå¨çæ¹å¼é¨ç½²ï¼ä¸å¶ä»æå¡ä½¿ç¨ HTTP API éä¿¡ãåæ¶æå¡ä¼ä½¿ç¨æå°çè§æ¨¡çéä¸­ç®¡ç (ä¾å¦ Docker) è½åï¼æå¡å¯ä»¥ç¨ä¸åçç¼ç¨è¯­è¨ä¸æ°æ®åºç­ç»ä»¶å®ç°ãââå¾®æå¡çç»´åºç¾ç§è¯æ¡å®ä¹\n\näºèç½åºç¨æ¶æå¤§è´çæ¼è¿æ¹åä¸ºï¼åä½æ¶æ -> æå¡åæ¶æ -> å¾®æå¡æ¶æãå¨æ¼åè¿ç¨ä¸­ï¼æ¶æè¶æ¥è¶å¤æï¼ä¸ä¸ªåºç¨è¢«æåçæå¡ä¹è¶æ¥è¶ç»ã\n\n\n# åä½åºç¨\n\näºèç½æ©æçææ¯æ éå¸¸ä¸º LAMPï¼Linux + Apache + MySQL + PHPï¼æ MVCï¼Spring + iBatis/Hibernate + Tomcatï¼ãè¿ä¸¤ç§æ¶æé½æ¯å¸åçåä½åºç¨æ¶æãå¶ä¼ç¹æ¯ææ¯æ ç®åï¼å æ­¤å­¦ä¹ ä¸æå¿«ï¼é¨ç½²ä¹å®¹æã\n\néçä¸å¡è¶æ¥è¶å¤æï¼å¼åå¢éè§æ¨¡ä¸æ­æ©å¼ ï¼åä½åºç¨æ¶æå°±é¾ä»¥éåºå¼åè¿­ä»£èå¥ï¼ä¸»è¦æä»¥ä¸é®é¢ï¼\n\n * æå»ºãé¨ç½²æçä½ï¼ä»£ç è¶å¤ï¼ä¾èµèµæºè¶å¤ï¼åæå»ºãé¨ç½²çèè´¹æ¶é´èªç¶ä¼è¶é¿ãå³ä½¿æ¯æ¬¡ä¿®æ¹ä¸ä¸ªå¾å°çåè½ç¹ï¼ä¹ä¸å¾ä¸å¨éæå»ºãå¨é¨é¨ç½²ï¼èæ¶èåã\n * å¢éåä½ææ¬é«ï¼åä½åºç¨çä»£ç å¾å¾å¨ä¸ä¸ªå·¥ç¨ä¸­ï¼èä¸ä¸ªå·¥ç¨ä¸­çå¼åäººåè¶å¤ï¼æ¾ç¶æ²éææ¬è¶é«ã\n * å¯ç¨æ§å·®ï¼å ä¸ºææçåè½å¼åæåé½é¨ç½²å°åä¸ä¸ª WAR åéï¼è¿è¡å¨åä¸ä¸ª Tomcat è¿ç¨ä¹ä¸­ï¼ä¸æ¦æä¸åè½æ¶åçä»£ç æèèµæºæé®é¢ï¼é£å°±ä¼å½±åæ´ä¸ª WAR åä¸­é¨ç½²çåè½ã\n\n\n# å¾®æå¡\n\nå¾®æå¡æ¶ææä»¥ä¸ 4 ä¸ªç¹ç¹ï¼\n\n * æå¡æåç²åº¦æ´ç»ï¼æ ¹æ®ä¸å¡æåã\n * ç¬ç«é¨ç½²ï¼æ¯ä¸ªæå¡é¨ç½²å¨ç©çä¸éç¦»ï¼äºä¸å½±åã\n * ç¬ç«ç»´æ¤ï¼æ ¹æ®ç»ç»æ¶ææåï¼åå¢éç»´æ¤ã\n * æå¡æ²»çï¼æå¡æ°éåå¤ï¼éè¦æç»ä¸çæå¡æ²»çå¹³å°ã\n\nç®åæ¥è¯´ï¼å¾®æå¡å°±æ¯å°åºæèè¿çåä½åºç¨æåæç»ç²åº¦çæå¡ï¼ç¬ç«é¨ç½²ï¼å¹¶äº¤ç»åä¸ªä¸­å°å¢éæ¥è´è´£å¼åãæµè¯ãä¸çº¿åè¿ç»´æ´ä¸ªçå½å¨æã\n\n\n# ä½æ¶éè¦å¾®æå¡\n\nåºç¨å¾®æå¡åæ¶æåï¼è¦æèå ä¸ªé®é¢ï¼ä»ä¹æ¶åè¿è¡æå¡åæåï¼å¦ä½æåæå¡ï¼\n\nå½åºç¨å¤æåº¦ãå¼åå¢éè¨èå°é¾ä»¥ç»´æ¤æ¶ï¼å°±è¯¥èèæå¡åæåäºã\n\n\n# æåæå¡çæèç»´åº¦\n\n * ä¸å¡ç»´åº¦ï¼ä¸å¡åæ°æ®å³ç³»å¯åçåºè¯¥æåä¸ºä¸ä¸ªå¾®æå¡ï¼èåè½ç¸å¯¹æ¯è¾ç¬ç«çä¸å¡éååç¬æåä¸ºä¸ä¸ªå¾®æå¡ã\n * åè½ç»´åº¦ï¼å¬å±åè½èåä¸ºä¸ä¸ªæå¡ãæ åæ¯æ¯å¦è¢«å¤ä¸ªå¶ä»æå¡è°ç¨ï¼ä¸ä¾èµçèµæºç¬ç«ä¸ä¸å¶ä»ä¸å¡è¦åã\n * ç»ç»æ¶æï¼æ ¹æ®å®éç»ç»æ¶æï¼å¤©ç¶åä¸ºä¸åçå¢éï¼æ¯ä¸ªå¢éç¬ç«ç»´æ¤è¥å¹²å¾®æå¡ã\n\nä½å¹¶ä¸æ¯è¯´åè½æåçè¶ç»è¶å¥½ï¼è¿åº¦çæååèä¼è®©æå¡æ°éè¨èåå¾é¾ä»¥ç®¡çï¼å æ­¤æ¾å°ç¬¦åèªå·±ä¸å¡ç°ç¶åå¢éäººåææ¯æ°´å¹³çæåç²åº¦ææ¯å¯åçã\n\n\n# æåæå¡çåå\n\nåä¸èè´£\n\né«åèï¼ä½è¦å\n\nåç²åç»ï¼éæ¸ç»å\n\næ¸è¿å¼è¿­ä»£\n\nèèæ©å±æ§\n\n\n# æåæå¡çåç½®æ¡ä»¶\n\n * æå¡å¦ä½å®ä¹ï¼\n   * å¯¹äºåä½åºç¨æ¥è¯´ï¼ä¸ååè½æ¨¡åä¹åç¸äºäº¤äºæ¶ï¼éå¸¸æ¯ä»¥ç±»åºçæ¹å¼æ¥æä¾åä¸ªæ¨¡åçåè½ã\n   * å¯¹äºå¾®æå¡æ¥è¯´ï¼æ¯ä¸ªæå¡é½è¿è¡å¨åèªçè¿ç¨ä¹ä¸­ï¼æ è®ºéç¨åªç§éè®¯åè®®ï¼æ¯ HTTP è¿æ¯ RPCï¼æå¡ä¹é´çè°ç¨é½éè¿æ¥å£æ¥çº¦å®å¦ä½äº¤äºãçº¦å®åå®¹åæ¬æ¥å£åãæ¥å£åæ°ä»¥åæ¥å£è¿åå¼ã\n * æå¡å¦ä½åå¸åè®¢éï¼\n   * åä½åºç¨ç±äºé¨ç½²å¨åä¸ä¸ª WAR åéï¼æ¥å£ä¹é´çè°ç¨å±äºè¿ç¨åçè°ç¨ã\n   * å¯¹äºå¾®æå¡æ¥è¯´ï¼æå¡æä¾èéè¦åæ³¨åä¸­å¿åå¸èªå·±æä¾çæå¡ï¼æ´é²æ¥å£ä¿¡æ¯ä»¥åæ¥å£å°åï¼ï¼æå¡æ¶è´¹èåæ³¨åä¸­å¿è®¢éåªäºæå¡å¯ç¨ã\n * æå¡å¦ä½çæ§ï¼éå¸¸å¯¹äºä¸ä¸ªæå¡ï¼æä»¬æå³å¿çæ¯ QPSï¼è°ç¨éï¼ãAvgTimeï¼å¹³åèæ¶ï¼ä»¥å P999ï¼99.9% çè¯·æ±æ§è½å¨å¤å°æ¯«ç§ä»¥åï¼è¿äºææ ãè¿æ¶åä½ å°±éè¦ä¸ç§éç¨ççæ§æ¹æ¡ï¼è½å¤è¦çä¸å¡åç¹ãæ°æ®æ¶éãæ°æ®å¤çï¼æåå°æ°æ®å±ç¤ºçå¨é¾è·¯åè½ã\n * æå¡å¦ä½æ²»çï¼å¯ä»¥æ³è±¡ï¼æåä¸ºå¾®æå¡æ¶æåï¼æå¡çæ°éåå¤äºï¼ä¾èµå³ç³»ä¹åå¤æäºãæ¯å¦ä¸ä¸ªæå¡çæ§è½æé®é¢æ¶ï¼ä¾èµçæå¡é½å¿å¿ä¼åå°å½±åãå¯ä»¥è®¾å®ä¸ä¸ªè°ç¨æ§è½éå¼ï¼å¦æä¸æ®µæ¶é´åä¸ç´è¶è¿è¿ä¸ªå¼ï¼é£ä¹ä¾èµæå¡çè°ç¨å¯ä»¥ç´æ¥è¿åï¼è¿å°±æ¯çæ­ï¼ä¹æ¯æå¡æ²»çæå¸¸ç¨çææ®µä¹ä¸ã\n * æéå¦ä½å®ä½ï¼å¨åä½åºç¨æåä¸ºå¾®æå¡ä¹åï¼ä¸æ¬¡ç¨æ·è°ç¨å¯è½ä¾èµå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡åé¨ç½²å¨ä¸åçèç¹ä¸ï¼å¦æç¨æ·è°ç¨åºç°é®é¢ï¼ä½ éè¦æä¸ç§è§£å³æ¹æ¡è½å¤å°ä¸æ¬¡ç¨æ·è¯·æ±è¿è¡æ è®°ï¼å¹¶å¨å¤ä¸ªä¾èµçæå¡ç³»ç»ä¸­ç»§ç»­ä¼ éï¼ä»¥ä¾¿ä¸²èææè·¯å¾ï¼ä»èè¿è¡æéå®ä½ã\n\nåºç¨å¾®æå¡æ¶æï¼å¿é¡»è¦åè§£å³ä»¥ä¸é®é¢\n\n\n# å¾®æå¡çåºç¡æ¶æ\n\nå¾®æå¡æ¶æä¸ï¼æå¡è°ç¨ä¸»è¦ä¾èµä¸é¢å ä¸ªåºæ¬ç»ä»¶ï¼\n\n * æå¡æè¿°\n * æ³¨åä¸­å¿\n * æå¡æ¡æ¶\n * æå¡çæ§\n * æå¡è¿½è¸ª\n * æå¡æ²»ç\n\n\n# æå¡æè¿°\n\næå¡è°ç¨é¦åè¦è§£å³çé®é¢å°±æ¯æå¡å¦ä½å¯¹å¤æè¿°ãæ¯å¦ï¼ä½ å¯¹å¤æä¾äºä¸ä¸ªæå¡ï¼é£ä¹è¿ä¸ªæå¡çæå¡åå«ä»ä¹ï¼è°ç¨è¿ä¸ªæå¡éè¦æä¾åªäºä¿¡æ¯ï¼è°ç¨è¿ä¸ªæå¡è¿åçç»ææ¯ä»ä¹æ ¼å¼çï¼è¯¥å¦ä½è§£æï¼è¿äºå°±æ¯æå¡æè¿°è¦è§£å³çé®é¢ã\n\nå¸¸ç¨çæå¡æè¿°æ¹å¼åæ¬ RESTful APIãXML éç½®ä»¥å IDL æä»¶ä¸ç§ã\n\nå¶ä¸­ï¼RESTful API æ¹å¼éå¸¸ç¨äº HTTP åè®®çæå¡æè¿°ï¼å¹¶ä¸å¸¸ç¨ Wiki æèSwaggeræ¥è¿è¡ç®¡çãä¸é¢æ¯ä¸ä¸ª RESTful API æ¹å¼çæå¡æè¿°çä¾å­ã\n\nXML éç½®æ¹å¼å¤ç¨ä½ RPC åè®®çæå¡æè¿°ï¼éè¿ *.xml éç½®æä»¶æ¥å®ä¹æ¥å£åãåæ°ä»¥åè¿åå¼ç±»åç­ãä¸é¢æ¯ä¸ä¸ª XML éç½®æ¹å¼çæå¡æè¿°çä¾å­ã\n\nIDL æä»¶æ¹å¼éå¸¸ç¨ä½ Thrift å gRPC è¿ç±»è·¨è¯­è¨æå¡è°ç¨æ¡æ¶ä¸­ï¼æ¯å¦ gRPC å°±æ¯éè¿ Protobuf æä»¶æ¥å®ä¹æå¡çæ¥å£åãåæ°ä»¥åè¿åå¼çæ°æ®ç»æã\n\n\n# æ³¨åä¸­å¿\n\n\n\næäºæå¡çæ¥å£æè¿°ï¼ä¸ä¸æ­¥è¦è§£å³çé®é¢å°±æ¯æå¡çåå¸åè®¢éï¼å°±æ¯è¯´ä½ æä¾äºä¸ä¸ªæå¡ï¼å¦ä½è®©å¤é¨æ³è°ç¨ä½ çæå¡çäººç¥éãè¿ä¸ªæ¶åå°±éè¦ä¸ä¸ªç±»ä¼¼æ³¨åä¸­å¿çè§è²ï¼æå¡æä¾èå°èªå·±æä¾çæå¡ä»¥åå°åç»è®°å°æ³¨åä¸­å¿ï¼æå¡æ¶è´¹èåä»æ³¨åä¸­å¿æ¥è¯¢æéè¦è°ç¨çæå¡çå°åï¼ç¶ååèµ·è¯·æ±ã\n\nä¸è¬æ¥è®²ï¼æ³¨åä¸­å¿çå·¥ä½æµç¨æ¯ï¼\n\n * æå¡æä¾èå¨å¯å¨æ¶ï¼æ ¹æ®æå¡åå¸æä»¶ä¸­éç½®çåå¸ä¿¡æ¯åæ³¨åä¸­å¿æ³¨åèªå·±çæå¡ã\n * æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼æ ¹æ®æ¶è´¹èéç½®æä»¶ä¸­éç½®çæå¡ä¿¡æ¯åæ³¨åä¸­å¿è®¢éèªå·±æéè¦çæå¡ã\n * æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æå¡æ¶è´¹èã\n * å½æå¡æä¾èåçååï¼æ¯å¦æèç¹æ°å¢æèéæ¯ï¼æ³¨åä¸­å¿å°åæ´éç¥ç»æå¡æ¶è´¹èã\n\n\n# æå¡æ¡æ¶\n\næå¡æ¶è´¹èåèµ·è°ç¨éè§£å³ä»¥ä¸é®é¢ï¼\n\n * æå¡éä¿¡éç¨ä»ä¹åè®®ï¼å°±æ¯è¯´æå¡æä¾èåæå¡æ¶è´¹èä¹é´ä»¥ä»ä¹æ ·çåè®®è¿è¡ç½ç»éä¿¡ï¼æ¯éç¨åå± TCPãUDP åè®®ï¼è¿æ¯éç¨ä¸å± HTTP åè®®ï¼è¿æ¯éç¨å¶ä»åè®®ï¼\n * æ°æ®ä¼ è¾éç¨ä»ä¹æ¹å¼ï¼å°±æ¯è¯´æå¡æä¾èåæå¡æ¶è´¹èä¹é´çæ°æ®ä¼ è¾éç¨åªç§æ¹å¼ï¼æ¯åæ­¥è¿æ¯å¼æ­¥ï¼æ¯å¨åè¿æ¥ä¸ä¼ è¾ï¼è¿æ¯å¤è·¯å¤ç¨ã\n * æ°æ®åç¼©éç¨ä»ä¹æ ¼å¼ï¼éå¸¸æ°æ®ä¼ è¾é½ä¼å¯¹æ°æ®è¿è¡åç¼©ï¼æ¥åå°ç½ç»ä¼ è¾çæ°æ®éï¼ä»èåå°å¸¦å®½æ¶èåç½ç»ä¼ è¾æ¶é´ï¼æ¯å¦å¸¸è§ç JSON åºååãJava å¯¹è±¡åºååä»¥å Protobuf åºååç­ã\n\n\n# æå¡çæ§\n\nä¸æ¦æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´è½å¤æ­£å¸¸åèµ·æå¡è°ç¨ï¼ä½ å°±éè¦å¯¹è°ç¨æåµè¿è¡çæ§ï¼ä»¥äºè§£æå¡æ¯å¦æ­£å¸¸ãéå¸¸æ¥è®²ï¼æå¡çæ§ä¸»è¦åæ¬ä¸ä¸ªæµç¨ã\n\n * æ°æ®æ¶éãå°±æ¯è¦ææ¯ä¸æ¬¡æå¡è°ç¨çè¯·æ±èæ¶ä»¥åæåä¸å¦æ¶éèµ·æ¥ï¼å¹¶ä¸ä¼ å°éä¸­çæ°æ®å¤çä¸­å¿ã\n * æ°æ®å¤çãæäºæ¯æ¬¡è°ç¨çè¯·æ±èæ¶ä»¥åæåä¸å¦ç­ä¿¡æ¯ï¼å°±å¯ä»¥è®¡ç®æ¯ç§æå¡è¯·æ±éãå¹³åèæ¶ä»¥åæåçç­ææ ã\n * æ°æ®å±ç¤ºãæ°æ®æ¶éèµ·æ¥ï¼ç»è¿å¤çä¹åï¼è¿éè¦ä»¥åå¥½çæ¹å¼å¯¹å¤å±ç¤ºï¼æè½åæ¥ä»·å¼ãéå¸¸é½æ¯å°æ°æ®å±ç¤ºå¨ Dashboard é¢æ¿ä¸ï¼å¹¶ä¸æ¯é 10s ç­é´éèªå¨å·æ°ï¼ç¨ä½ä¸å¡çæ§åæ¥è­¦ç­ã\n\n\n# æå¡é¾è·¯è¿½è¸ª\n\né¤äºéè¦å¯¹æå¡è°ç¨æåµè¿è¡çæ§ä¹å¤ï¼ä½ è¿éè¦è®°å½æå¡è°ç¨ç»è¿çæ¯ä¸å±é¾è·¯ï¼ä»¥ä¾¿è¿è¡é®é¢è¿½è¸ªåæéå®ä½ã\n\næå¡é¾è·¯è¿½è¸ªçå·¥ä½åçå¤§è´å¦ä¸ï¼\n\n * æå¡æ¶è´¹èåèµ·è°ç¨åï¼ä¼å¨æ¬å°æç§ä¸å®çè§åçæä¸ä¸ª requestidï¼åèµ·è°ç¨æ¶ï¼å° requestid å½ä½è¯·æ±åæ°çä¸é¨åï¼ä¼ éç»æå¡æä¾èã\n * æå¡æä¾èæ¥æ¶å°è¯·æ±åï¼è®°å½ä¸è¿æ¬¡è¯·æ±ç requestidï¼ç¶åå¤çè¯·æ±ãå¦ææå¡æä¾èç»§ç»­è¯·æ±å¶ä»æå¡ï¼ä¼å¨æ¬å°åçæä¸ä¸ªèªå·±ç requestidï¼ç¶åæè¿ä¸¤ä¸ª requestid é½å½ä½è¯·æ±åæ°ç»§ç»­å¾ä¸ä¼ éã\n\nä»¥æ­¤ç±»æ¨ï¼éè¿è¿ç§å±å±å¾ä¸ä¼ éçæ¹å¼ï¼ä¸æ¬¡è¯·æ±ï¼æ è®ºæåä¾èµå¤å°æ¬¡æå¡è°ç¨ãç»è¿å¤å°æå¡èç¹ï¼é½å¯ä»¥éè¿æå¼å§çæç requestid ä¸²èææèç¹ï¼ä»èè¾¾å°æå¡è¿½è¸ªçç®çã\n\n\n# æå¡æ²»ç\n\næå¡çæ§è½å¤åç°é®é¢ï¼æå¡è¿½è¸ªè½å¤å®ä½é®é¢æå¨ï¼èè§£å³é®é¢å°±å¾é æå¡æ²»çäºãæå¡æ²»çå°±æ¯éè¿ä¸ç³»åçææ®µæ¥ä¿è¯å¨åç§æå¤æåµä¸ï¼æå¡è°ç¨ä»ç¶è½å¤æ­£å¸¸è¿è¡ã\n\nå¨çäº§ç¯å¢ä¸­ï¼ä½ åºè¯¥ç»å¸¸ä¼éå°ä¸é¢å ç§ç¶åµã\n\n * åæºæéãéå¸¸éå°åæºæéï¼é½æ¯é è¿ç»´åç°å¹¶éå¯æå¡æèä»çº¿ä¸æé¤æéèç¹ãç¶èéç¾¤çè§æ¨¡è¶å¤§ï¼è¶æ¯å®¹æéå°åæºæéï¼å¨æºå¨è§æ¨¡è¶è¿ä¸ç¾å°ä»¥ä¸æ¶ï¼é ä¼ ç»çäººèè¿ç»´æ¾ç¶é¾ä»¥åºå¯¹ãèæå¡æ²»çå¯ä»¥éè¿ä¸å®çç­ç¥ï¼èªå¨æé¤æéèç¹ï¼ä¸éè¦äººä¸ºå¹²é¢ï¼å°±è½ä¿è¯åæºæéä¸ä¼å½±åä¸å¡ã\n * å IDC æéãä½ åºè¯¥ç»å¸¸å¬è¯´ææ Appï¼å ä¸ºæ½å·¥ææ­åç¼å¯¼è´å¤§æ¹éç¨æ·æ æ³ä½¿ç¨çä¸¥éæéãèæå¡æ²»çå¯ä»¥éè¿èªå¨åæ¢æé IDC çæµéå°å¶ä»æ­£å¸¸ IDCï¼å¯ä»¥é¿åå ä¸ºå IDC æéå¼èµ·çå¤§æ¹éä¸å¡åå½±åã\n * ä¾èµæå¡ä¸å¯ç¨ãæ¯å¦ä½ çæå¡ä¾èµä¾èµäºå¦ä¸ä¸ªæå¡ï¼å½å¦ä¸ä¸ªæå¡åºç°é®é¢æ¶ï¼ä¼ææ¢çè³æå®ä½ çæå¡ãèæå¡æ²»çå¯ä»¥éè¿çæ­ï¼å¨ä¾èµæå¡å¼å¸¸çæåµä¸ï¼ä¸æ®µæ¶æååæ­¢åèµ·è°ç¨èç´æ¥è¿åãè¿æ ·ä¸æ¹é¢ä¿è¯äºæå¡æ¶è´¹èè½å¤ä¸è¢«æå®ï¼å¦ä¸æ¹é¢ä¹ç»æå¡æä¾èåå°ååï¼ä½¿å¶è½å¤å°½å¿«æ¢å¤ã\n\nä¸é¢æ¯ä¸ç§æå¸¸è§çéè¦å¼å¥æå¡æ²»ççåºæ¯ï¼å½ç¶è¿æä¸äºå¶ä»æå¡æ²»ççææ®µæ¯å¦èªå¨æ©ç¼©å®¹ï¼å¯ä»¥ç¨æ¥è§£å³æå¡çå®¹éé®é¢ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡",normalizedContent:"# å¾®æå¡ç®ä»\n\n\n# ä»ä¹æ¯å¾®æå¡\n\n> martin fowler ä¸ james lewis å±åæåºäºå¾®æå¡çæ¦å¿µï¼å®ä¹äºå¾®æå¡æ¯ç±åä¸åºç¨ç¨åºææçå°æå¡ï¼èªå·±æ¥æèªå·±çè¿ç¨ä¸è½»éåå¤çï¼æå¡ä¾ä¸å¡åè½è®¾è®¡ï¼ä»¥å¨èªå¨çæ¹å¼é¨ç½²ï¼ä¸å¶ä»æå¡ä½¿ç¨ http api éä¿¡ãåæ¶æå¡ä¼ä½¿ç¨æå°çè§æ¨¡çéä¸­ç®¡ç (ä¾å¦ docker) è½åï¼æå¡å¯ä»¥ç¨ä¸åçç¼ç¨è¯­è¨ä¸æ°æ®åºç­ç»ä»¶å®ç°ãââå¾®æå¡çç»´åºç¾ç§è¯æ¡å®ä¹\n\näºèç½åºç¨æ¶æå¤§è´çæ¼è¿æ¹åä¸ºï¼åä½æ¶æ -> æå¡åæ¶æ -> å¾®æå¡æ¶æãå¨æ¼åè¿ç¨ä¸­ï¼æ¶æè¶æ¥è¶å¤æï¼ä¸ä¸ªåºç¨è¢«æåçæå¡ä¹è¶æ¥è¶ç»ã\n\n\n# åä½åºç¨\n\näºèç½æ©æçææ¯æ éå¸¸ä¸º lampï¼linux + apache + mysql + phpï¼æ mvcï¼spring + ibatis/hibernate + tomcatï¼ãè¿ä¸¤ç§æ¶æé½æ¯å¸åçåä½åºç¨æ¶æãå¶ä¼ç¹æ¯ææ¯æ ç®åï¼å æ­¤å­¦ä¹ ä¸æå¿«ï¼é¨ç½²ä¹å®¹æã\n\néçä¸å¡è¶æ¥è¶å¤æï¼å¼åå¢éè§æ¨¡ä¸æ­æ©å¼ ï¼åä½åºç¨æ¶æå°±é¾ä»¥éåºå¼åè¿­ä»£èå¥ï¼ä¸»è¦æä»¥ä¸é®é¢ï¼\n\n * æå»ºãé¨ç½²æçä½ï¼ä»£ç è¶å¤ï¼ä¾èµèµæºè¶å¤ï¼åæå»ºãé¨ç½²çèè´¹æ¶é´èªç¶ä¼è¶é¿ãå³ä½¿æ¯æ¬¡ä¿®æ¹ä¸ä¸ªå¾å°çåè½ç¹ï¼ä¹ä¸å¾ä¸å¨éæå»ºãå¨é¨é¨ç½²ï¼èæ¶èåã\n * å¢éåä½ææ¬é«ï¼åä½åºç¨çä»£ç å¾å¾å¨ä¸ä¸ªå·¥ç¨ä¸­ï¼èä¸ä¸ªå·¥ç¨ä¸­çå¼åäººåè¶å¤ï¼æ¾ç¶æ²éææ¬è¶é«ã\n * å¯ç¨æ§å·®ï¼å ä¸ºææçåè½å¼åæåé½é¨ç½²å°åä¸ä¸ª war åéï¼è¿è¡å¨åä¸ä¸ª tomcat è¿ç¨ä¹ä¸­ï¼ä¸æ¦æä¸åè½æ¶åçä»£ç æèèµæºæé®é¢ï¼é£å°±ä¼å½±åæ´ä¸ª war åä¸­é¨ç½²çåè½ã\n\n\n# å¾®æå¡\n\nå¾®æå¡æ¶ææä»¥ä¸ 4 ä¸ªç¹ç¹ï¼\n\n * æå¡æåç²åº¦æ´ç»ï¼æ ¹æ®ä¸å¡æåã\n * ç¬ç«é¨ç½²ï¼æ¯ä¸ªæå¡é¨ç½²å¨ç©çä¸éç¦»ï¼äºä¸å½±åã\n * ç¬ç«ç»´æ¤ï¼æ ¹æ®ç»ç»æ¶ææåï¼åå¢éç»´æ¤ã\n * æå¡æ²»çï¼æå¡æ°éåå¤ï¼éè¦æç»ä¸çæå¡æ²»çå¹³å°ã\n\nç®åæ¥è¯´ï¼å¾®æå¡å°±æ¯å°åºæèè¿çåä½åºç¨æåæç»ç²åº¦çæå¡ï¼ç¬ç«é¨ç½²ï¼å¹¶äº¤ç»åä¸ªä¸­å°å¢éæ¥è´è´£å¼åãæµè¯ãä¸çº¿åè¿ç»´æ´ä¸ªçå½å¨æã\n\n\n# ä½æ¶éè¦å¾®æå¡\n\nåºç¨å¾®æå¡åæ¶æåï¼è¦æèå ä¸ªé®é¢ï¼ä»ä¹æ¶åè¿è¡æå¡åæåï¼å¦ä½æåæå¡ï¼\n\nå½åºç¨å¤æåº¦ãå¼åå¢éè¨èå°é¾ä»¥ç»´æ¤æ¶ï¼å°±è¯¥èèæå¡åæåäºã\n\n\n# æåæå¡çæèç»´åº¦\n\n * ä¸å¡ç»´åº¦ï¼ä¸å¡åæ°æ®å³ç³»å¯åçåºè¯¥æåä¸ºä¸ä¸ªå¾®æå¡ï¼èåè½ç¸å¯¹æ¯è¾ç¬ç«çä¸å¡éååç¬æåä¸ºä¸ä¸ªå¾®æå¡ã\n * åè½ç»´åº¦ï¼å¬å±åè½èåä¸ºä¸ä¸ªæå¡ãæ åæ¯æ¯å¦è¢«å¤ä¸ªå¶ä»æå¡è°ç¨ï¼ä¸ä¾èµçèµæºç¬ç«ä¸ä¸å¶ä»ä¸å¡è¦åã\n * ç»ç»æ¶æï¼æ ¹æ®å®éç»ç»æ¶æï¼å¤©ç¶åä¸ºä¸åçå¢éï¼æ¯ä¸ªå¢éç¬ç«ç»´æ¤è¥å¹²å¾®æå¡ã\n\nä½å¹¶ä¸æ¯è¯´åè½æåçè¶ç»è¶å¥½ï¼è¿åº¦çæååèä¼è®©æå¡æ°éè¨èåå¾é¾ä»¥ç®¡çï¼å æ­¤æ¾å°ç¬¦åèªå·±ä¸å¡ç°ç¶åå¢éäººåææ¯æ°´å¹³çæåç²åº¦ææ¯å¯åçã\n\n\n# æåæå¡çåå\n\nåä¸èè´£\n\né«åèï¼ä½è¦å\n\nåç²åç»ï¼éæ¸ç»å\n\næ¸è¿å¼è¿­ä»£\n\nèèæ©å±æ§\n\n\n# æåæå¡çåç½®æ¡ä»¶\n\n * æå¡å¦ä½å®ä¹ï¼\n   * å¯¹äºåä½åºç¨æ¥è¯´ï¼ä¸ååè½æ¨¡åä¹åç¸äºäº¤äºæ¶ï¼éå¸¸æ¯ä»¥ç±»åºçæ¹å¼æ¥æä¾åä¸ªæ¨¡åçåè½ã\n   * å¯¹äºå¾®æå¡æ¥è¯´ï¼æ¯ä¸ªæå¡é½è¿è¡å¨åèªçè¿ç¨ä¹ä¸­ï¼æ è®ºéç¨åªç§éè®¯åè®®ï¼æ¯ http è¿æ¯ rpcï¼æå¡ä¹é´çè°ç¨é½éè¿æ¥å£æ¥çº¦å®å¦ä½äº¤äºãçº¦å®åå®¹åæ¬æ¥å£åãæ¥å£åæ°ä»¥åæ¥å£è¿åå¼ã\n * æå¡å¦ä½åå¸åè®¢éï¼\n   * åä½åºç¨ç±äºé¨ç½²å¨åä¸ä¸ª war åéï¼æ¥å£ä¹é´çè°ç¨å±äºè¿ç¨åçè°ç¨ã\n   * å¯¹äºå¾®æå¡æ¥è¯´ï¼æå¡æä¾èéè¦åæ³¨åä¸­å¿åå¸èªå·±æä¾çæå¡ï¼æ´é²æ¥å£ä¿¡æ¯ä»¥åæ¥å£å°åï¼ï¼æå¡æ¶è´¹èåæ³¨åä¸­å¿è®¢éåªäºæå¡å¯ç¨ã\n * æå¡å¦ä½çæ§ï¼éå¸¸å¯¹äºä¸ä¸ªæå¡ï¼æä»¬æå³å¿çæ¯ qpsï¼è°ç¨éï¼ãavgtimeï¼å¹³åèæ¶ï¼ä»¥å p999ï¼99.9% çè¯·æ±æ§è½å¨å¤å°æ¯«ç§ä»¥åï¼è¿äºææ ãè¿æ¶åä½ å°±éè¦ä¸ç§éç¨ççæ§æ¹æ¡ï¼è½å¤è¦çä¸å¡åç¹ãæ°æ®æ¶éãæ°æ®å¤çï¼æåå°æ°æ®å±ç¤ºçå¨é¾è·¯åè½ã\n * æå¡å¦ä½æ²»çï¼å¯ä»¥æ³è±¡ï¼æåä¸ºå¾®æå¡æ¶æåï¼æå¡çæ°éåå¤äºï¼ä¾èµå³ç³»ä¹åå¤æäºãæ¯å¦ä¸ä¸ªæå¡çæ§è½æé®é¢æ¶ï¼ä¾èµçæå¡é½å¿å¿ä¼åå°å½±åãå¯ä»¥è®¾å®ä¸ä¸ªè°ç¨æ§è½éå¼ï¼å¦æä¸æ®µæ¶é´åä¸ç´è¶è¿è¿ä¸ªå¼ï¼é£ä¹ä¾èµæå¡çè°ç¨å¯ä»¥ç´æ¥è¿åï¼è¿å°±æ¯çæ­ï¼ä¹æ¯æå¡æ²»çæå¸¸ç¨çææ®µä¹ä¸ã\n * æéå¦ä½å®ä½ï¼å¨åä½åºç¨æåä¸ºå¾®æå¡ä¹åï¼ä¸æ¬¡ç¨æ·è°ç¨å¯è½ä¾èµå¤ä¸ªæå¡ï¼æ¯ä¸ªæå¡åé¨ç½²å¨ä¸åçèç¹ä¸ï¼å¦æç¨æ·è°ç¨åºç°é®é¢ï¼ä½ éè¦æä¸ç§è§£å³æ¹æ¡è½å¤å°ä¸æ¬¡ç¨æ·è¯·æ±è¿è¡æ è®°ï¼å¹¶å¨å¤ä¸ªä¾èµçæå¡ç³»ç»ä¸­ç»§ç»­ä¼ éï¼ä»¥ä¾¿ä¸²èææè·¯å¾ï¼ä»èè¿è¡æéå®ä½ã\n\nåºç¨å¾®æå¡æ¶æï¼å¿é¡»è¦åè§£å³ä»¥ä¸é®é¢\n\n\n# å¾®æå¡çåºç¡æ¶æ\n\nå¾®æå¡æ¶æä¸ï¼æå¡è°ç¨ä¸»è¦ä¾èµä¸é¢å ä¸ªåºæ¬ç»ä»¶ï¼\n\n * æå¡æè¿°\n * æ³¨åä¸­å¿\n * æå¡æ¡æ¶\n * æå¡çæ§\n * æå¡è¿½è¸ª\n * æå¡æ²»ç\n\n\n# æå¡æè¿°\n\næå¡è°ç¨é¦åè¦è§£å³çé®é¢å°±æ¯æå¡å¦ä½å¯¹å¤æè¿°ãæ¯å¦ï¼ä½ å¯¹å¤æä¾äºä¸ä¸ªæå¡ï¼é£ä¹è¿ä¸ªæå¡çæå¡åå«ä»ä¹ï¼è°ç¨è¿ä¸ªæå¡éè¦æä¾åªäºä¿¡æ¯ï¼è°ç¨è¿ä¸ªæå¡è¿åçç»ææ¯ä»ä¹æ ¼å¼çï¼è¯¥å¦ä½è§£æï¼è¿äºå°±æ¯æå¡æè¿°è¦è§£å³çé®é¢ã\n\nå¸¸ç¨çæå¡æè¿°æ¹å¼åæ¬ restful apiãxml éç½®ä»¥å idl æä»¶ä¸ç§ã\n\nå¶ä¸­ï¼restful api æ¹å¼éå¸¸ç¨äº http åè®®çæå¡æè¿°ï¼å¹¶ä¸å¸¸ç¨ wiki æèswaggeræ¥è¿è¡ç®¡çãä¸é¢æ¯ä¸ä¸ª restful api æ¹å¼çæå¡æè¿°çä¾å­ã\n\nxml éç½®æ¹å¼å¤ç¨ä½ rpc åè®®çæå¡æè¿°ï¼éè¿ *.xml éç½®æä»¶æ¥å®ä¹æ¥å£åãåæ°ä»¥åè¿åå¼ç±»åç­ãä¸é¢æ¯ä¸ä¸ª xml éç½®æ¹å¼çæå¡æè¿°çä¾å­ã\n\nidl æä»¶æ¹å¼éå¸¸ç¨ä½ thrift å grpc è¿ç±»è·¨è¯­è¨æå¡è°ç¨æ¡æ¶ä¸­ï¼æ¯å¦ grpc å°±æ¯éè¿ protobuf æä»¶æ¥å®ä¹æå¡çæ¥å£åãåæ°ä»¥åè¿åå¼çæ°æ®ç»æã\n\n\n# æ³¨åä¸­å¿\n\n\n\næäºæå¡çæ¥å£æè¿°ï¼ä¸ä¸æ­¥è¦è§£å³çé®é¢å°±æ¯æå¡çåå¸åè®¢éï¼å°±æ¯è¯´ä½ æä¾äºä¸ä¸ªæå¡ï¼å¦ä½è®©å¤é¨æ³è°ç¨ä½ çæå¡çäººç¥éãè¿ä¸ªæ¶åå°±éè¦ä¸ä¸ªç±»ä¼¼æ³¨åä¸­å¿çè§è²ï¼æå¡æä¾èå°èªå·±æä¾çæå¡ä»¥åå°åç»è®°å°æ³¨åä¸­å¿ï¼æå¡æ¶è´¹èåä»æ³¨åä¸­å¿æ¥è¯¢æéè¦è°ç¨çæå¡çå°åï¼ç¶ååèµ·è¯·æ±ã\n\nä¸è¬æ¥è®²ï¼æ³¨åä¸­å¿çå·¥ä½æµç¨æ¯ï¼\n\n * æå¡æä¾èå¨å¯å¨æ¶ï¼æ ¹æ®æå¡åå¸æä»¶ä¸­éç½®çåå¸ä¿¡æ¯åæ³¨åä¸­å¿æ³¨åèªå·±çæå¡ã\n * æå¡æ¶è´¹èå¨å¯å¨æ¶ï¼æ ¹æ®æ¶è´¹èéç½®æä»¶ä¸­éç½®çæå¡ä¿¡æ¯åæ³¨åä¸­å¿è®¢éèªå·±æéè¦çæå¡ã\n * æ³¨åä¸­å¿è¿åæå¡æä¾èå°ååè¡¨ç»æå¡æ¶è´¹èã\n * å½æå¡æä¾èåçååï¼æ¯å¦æèç¹æ°å¢æèéæ¯ï¼æ³¨åä¸­å¿å°åæ´éç¥ç»æå¡æ¶è´¹èã\n\n\n# æå¡æ¡æ¶\n\næå¡æ¶è´¹èåèµ·è°ç¨éè§£å³ä»¥ä¸é®é¢ï¼\n\n * æå¡éä¿¡éç¨ä»ä¹åè®®ï¼å°±æ¯è¯´æå¡æä¾èåæå¡æ¶è´¹èä¹é´ä»¥ä»ä¹æ ·çåè®®è¿è¡ç½ç»éä¿¡ï¼æ¯éç¨åå± tcpãudp åè®®ï¼è¿æ¯éç¨ä¸å± http åè®®ï¼è¿æ¯éç¨å¶ä»åè®®ï¼\n * æ°æ®ä¼ è¾éç¨ä»ä¹æ¹å¼ï¼å°±æ¯è¯´æå¡æä¾èåæå¡æ¶è´¹èä¹é´çæ°æ®ä¼ è¾éç¨åªç§æ¹å¼ï¼æ¯åæ­¥è¿æ¯å¼æ­¥ï¼æ¯å¨åè¿æ¥ä¸ä¼ è¾ï¼è¿æ¯å¤è·¯å¤ç¨ã\n * æ°æ®åç¼©éç¨ä»ä¹æ ¼å¼ï¼éå¸¸æ°æ®ä¼ è¾é½ä¼å¯¹æ°æ®è¿è¡åç¼©ï¼æ¥åå°ç½ç»ä¼ è¾çæ°æ®éï¼ä»èåå°å¸¦å®½æ¶èåç½ç»ä¼ è¾æ¶é´ï¼æ¯å¦å¸¸è§ç json åºååãjava å¯¹è±¡åºååä»¥å protobuf åºååç­ã\n\n\n# æå¡çæ§\n\nä¸æ¦æå¡æ¶è´¹èä¸æå¡æä¾èä¹é´è½å¤æ­£å¸¸åèµ·æå¡è°ç¨ï¼ä½ å°±éè¦å¯¹è°ç¨æåµè¿è¡çæ§ï¼ä»¥äºè§£æå¡æ¯å¦æ­£å¸¸ãéå¸¸æ¥è®²ï¼æå¡çæ§ä¸»è¦åæ¬ä¸ä¸ªæµç¨ã\n\n * æ°æ®æ¶éãå°±æ¯è¦ææ¯ä¸æ¬¡æå¡è°ç¨çè¯·æ±èæ¶ä»¥åæåä¸å¦æ¶éèµ·æ¥ï¼å¹¶ä¸ä¼ å°éä¸­çæ°æ®å¤çä¸­å¿ã\n * æ°æ®å¤çãæäºæ¯æ¬¡è°ç¨çè¯·æ±èæ¶ä»¥åæåä¸å¦ç­ä¿¡æ¯ï¼å°±å¯ä»¥è®¡ç®æ¯ç§æå¡è¯·æ±éãå¹³åèæ¶ä»¥åæåçç­ææ ã\n * æ°æ®å±ç¤ºãæ°æ®æ¶éèµ·æ¥ï¼ç»è¿å¤çä¹åï¼è¿éè¦ä»¥åå¥½çæ¹å¼å¯¹å¤å±ç¤ºï¼æè½åæ¥ä»·å¼ãéå¸¸é½æ¯å°æ°æ®å±ç¤ºå¨ dashboard é¢æ¿ä¸ï¼å¹¶ä¸æ¯é 10s ç­é´éèªå¨å·æ°ï¼ç¨ä½ä¸å¡çæ§åæ¥è­¦ç­ã\n\n\n# æå¡é¾è·¯è¿½è¸ª\n\né¤äºéè¦å¯¹æå¡è°ç¨æåµè¿è¡çæ§ä¹å¤ï¼ä½ è¿éè¦è®°å½æå¡è°ç¨ç»è¿çæ¯ä¸å±é¾è·¯ï¼ä»¥ä¾¿è¿è¡é®é¢è¿½è¸ªåæéå®ä½ã\n\næå¡é¾è·¯è¿½è¸ªçå·¥ä½åçå¤§è´å¦ä¸ï¼\n\n * æå¡æ¶è´¹èåèµ·è°ç¨åï¼ä¼å¨æ¬å°æç§ä¸å®çè§åçæä¸ä¸ª requestidï¼åèµ·è°ç¨æ¶ï¼å° requestid å½ä½è¯·æ±åæ°çä¸é¨åï¼ä¼ éç»æå¡æä¾èã\n * æå¡æä¾èæ¥æ¶å°è¯·æ±åï¼è®°å½ä¸è¿æ¬¡è¯·æ±ç requestidï¼ç¶åå¤çè¯·æ±ãå¦ææå¡æä¾èç»§ç»­è¯·æ±å¶ä»æå¡ï¼ä¼å¨æ¬å°åçæä¸ä¸ªèªå·±ç requestidï¼ç¶åæè¿ä¸¤ä¸ª requestid é½å½ä½è¯·æ±åæ°ç»§ç»­å¾ä¸ä¼ éã\n\nä»¥æ­¤ç±»æ¨ï¼éè¿è¿ç§å±å±å¾ä¸ä¼ éçæ¹å¼ï¼ä¸æ¬¡è¯·æ±ï¼æ è®ºæåä¾èµå¤å°æ¬¡æå¡è°ç¨ãç»è¿å¤å°æå¡èç¹ï¼é½å¯ä»¥éè¿æå¼å§çæç requestid ä¸²èææèç¹ï¼ä»èè¾¾å°æå¡è¿½è¸ªçç®çã\n\n\n# æå¡æ²»ç\n\næå¡çæ§è½å¤åç°é®é¢ï¼æå¡è¿½è¸ªè½å¤å®ä½é®é¢æå¨ï¼èè§£å³é®é¢å°±å¾é æå¡æ²»çäºãæå¡æ²»çå°±æ¯éè¿ä¸ç³»åçææ®µæ¥ä¿è¯å¨åç§æå¤æåµä¸ï¼æå¡è°ç¨ä»ç¶è½å¤æ­£å¸¸è¿è¡ã\n\nå¨çäº§ç¯å¢ä¸­ï¼ä½ åºè¯¥ç»å¸¸ä¼éå°ä¸é¢å ç§ç¶åµã\n\n * åæºæéãéå¸¸éå°åæºæéï¼é½æ¯é è¿ç»´åç°å¹¶éå¯æå¡æèä»çº¿ä¸æé¤æéèç¹ãç¶èéç¾¤çè§æ¨¡è¶å¤§ï¼è¶æ¯å®¹æéå°åæºæéï¼å¨æºå¨è§æ¨¡è¶è¿ä¸ç¾å°ä»¥ä¸æ¶ï¼é ä¼ ç»çäººèè¿ç»´æ¾ç¶é¾ä»¥åºå¯¹ãèæå¡æ²»çå¯ä»¥éè¿ä¸å®çç­ç¥ï¼èªå¨æé¤æéèç¹ï¼ä¸éè¦äººä¸ºå¹²é¢ï¼å°±è½ä¿è¯åæºæéä¸ä¼å½±åä¸å¡ã\n * å idc æéãä½ åºè¯¥ç»å¸¸å¬è¯´ææ appï¼å ä¸ºæ½å·¥ææ­åç¼å¯¼è´å¤§æ¹éç¨æ·æ æ³ä½¿ç¨çä¸¥éæéãèæå¡æ²»çå¯ä»¥éè¿èªå¨åæ¢æé idc çæµéå°å¶ä»æ­£å¸¸ idcï¼å¯ä»¥é¿åå ä¸ºå idc æéå¼èµ·çå¤§æ¹éä¸å¡åå½±åã\n * ä¾èµæå¡ä¸å¯ç¨ãæ¯å¦ä½ çæå¡ä¾èµä¾èµäºå¦ä¸ä¸ªæå¡ï¼å½å¦ä¸ä¸ªæå¡åºç°é®é¢æ¶ï¼ä¼ææ¢çè³æå®ä½ çæå¡ãèæå¡æ²»çå¯ä»¥éè¿çæ­ï¼å¨ä¾èµæå¡å¼å¸¸çæåµä¸ï¼ä¸æ®µæ¶æååæ­¢åèµ·è°ç¨èç´æ¥è¿åãè¿æ ·ä¸æ¹é¢ä¿è¯äºæå¡æ¶è´¹èè½å¤ä¸è¢«æå®ï¼å¦ä¸æ¹é¢ä¹ç»æå¡æä¾èåå°ååï¼ä½¿å¶è½å¤å°½å¿«æ¢å¤ã\n\nä¸é¢æ¯ä¸ç§æå¸¸è§çéè¦å¼å¥æå¡æ²»ççåºæ¯ï¼å½ç¶è¿æä¸äºå¶ä»æå¡æ²»ççææ®µæ¯å¦èªå¨æ©ç¼©å®¹ï¼å¯ä»¥ç¨æ¥è§£å³æå¡çå®¹éé®é¢ã\n\n\n# åèèµæ\n\n * ä» 0 å¼å§å­¦å¾®æå¡",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"RPC åºæ¬åç",frontmatter:{title:"RPC åºæ¬åç",categories:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],tags:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡","RPC"],abbrlink:"65334efa",date:"2020-06-10T16:00:00.000Z",permalink:"/pages/ebf86b/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/04.%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1/02.RPC.html",relativePath:"02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/02.RPC.md",key:"v-ecdbd4a2",path:"/pages/ebf86b/",headers:[{level:2,title:"1. RPC ç®ä»",slug:"_1-rpc-ç®ä»",normalizedTitle:"1. rpc ç®ä»",charIndex:15},{level:3,title:"1.1. ä»ä¹æ¯ RPC",slug:"_1-1-ä»ä¹æ¯-rpc",normalizedTitle:"1.1. ä»ä¹æ¯ rpc",charIndex:29},{level:3,title:"1.2. RPC éä¿¡",slug:"_1-2-rpc-éä¿¡",normalizedTitle:"1.2. rpc éä¿¡",charIndex:137},{level:3,title:"1.3. RPC åè®®",slug:"_1-3-rpc-åè®®",normalizedTitle:"1.3. rpc åè®®",charIndex:455},{level:2,title:"2. åºåå",slug:"_2-åºåå",normalizedTitle:"2. åºåå",charIndex:647},{level:3,title:"2.1. å¸¸è§åºååæ¹å¼",slug:"_2-1-å¸¸è§åºååæ¹å¼",normalizedTitle:"2.1. å¸¸è§åºååæ¹å¼",charIndex:713},{level:4,title:"2.1.1. JDK åºåå",slug:"_2-1-1-jdk-åºåå",normalizedTitle:"2.1.1. jdk åºåå",charIndex:729},{level:4,title:"2.1.2. JSON",slug:"_2-1-2-json",normalizedTitle:"2.1.2. json",charIndex:787},{level:4,title:"2.1.3. Hessian",slug:"_2-1-3-hessian",normalizedTitle:"2.1.3. hessian",charIndex:866},{level:4,title:"2.1.4. Thrift / Protobuf",slug:"_2-1-4-thrift-protobuf",normalizedTitle:"2.1.4. thrift / protobuf",charIndex:1130},{level:3,title:"2.2. åºååé®é¢",slug:"_2-2-åºååé®é¢",normalizedTitle:"2.2. åºååé®é¢",charIndex:1364},{level:2,title:"3. åå°+å¨æä»£ç",slug:"_3-åå°-å¨æä»£ç",normalizedTitle:"3. åå°+å¨æä»£ç",charIndex:1955},{level:2,title:"4. ç½ç»éä¿¡",slug:"_4-ç½ç»éä¿¡",normalizedTitle:"4. ç½ç»éä¿¡",charIndex:2226},{level:3,title:"4.1. IO å¤è·¯å¤ç¨",slug:"_4-1-io-å¤è·¯å¤ç¨",normalizedTitle:"4.1. io å¤è·¯å¤ç¨",charIndex:2343},{level:3,title:"4.2. é¶æ·è´",slug:"_4-2-é¶æ·è´",normalizedTitle:"4.2. é¶æ·è´",charIndex:2529},{level:2,title:"5. RPC æ¶ææ¨¡å",slug:"_5-rpc-æ¶ææ¨¡å",normalizedTitle:"5. rpc æ¶ææ¨¡å",charIndex:3387},{level:2,title:"6. æå¡æ³¨åååç°",slug:"_6-æå¡æ³¨åååç°",normalizedTitle:"6. æå¡æ³¨åååç°",charIndex:3913},{level:3,title:"6.1. åºäº ZooKeeper çæå¡åç°",slug:"_6-1-åºäº-zookeeper-çæå¡åç°",normalizedTitle:"6.1. åºäº zookeeper çæå¡åç°",charIndex:4096},{level:3,title:"6.2. åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿",slug:"_6-2-åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿",normalizedTitle:"6.2. åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿",charIndex:4567},{level:2,title:"7. å¥åº·æ£æ¥",slug:"_7-å¥åº·æ£æ¥",normalizedTitle:"7. å¥åº·æ£æ¥",charIndex:4894},{level:2,title:"8. è·¯ç±åè´è½½åè¡¡",slug:"_8-è·¯ç±åè´è½½åè¡¡",normalizedTitle:"8. è·¯ç±åè´è½½åè¡¡",charIndex:5123},{level:3,title:"8.1. è¶æ¶éè¯",slug:"_8-1-è¶æ¶éè¯",normalizedTitle:"8.1. è¶æ¶éè¯",charIndex:5522},{level:3,title:"8.2. éæµãéçº§ãçæ­",slug:"_8-2-éæµãéçº§ãçæ­",normalizedTitle:"8.2. éæµãéçº§ãçæ­",charIndex:5615},{level:3,title:"8.3. ä¼éå¯å¨å³é­",slug:"_8-3-ä¼éå¯å¨å³é­",normalizedTitle:"8.3. ä¼éå¯å¨å³é­",charIndex:5674},{level:2,title:"9. å®¹éå¤ç",slug:"_9-å®¹éå¤ç",normalizedTitle:"9. å®¹éå¤ç",charIndex:5732},{level:3,title:"9.1. å¼å¸¸éè¯",slug:"_9-1-å¼å¸¸éè¯",normalizedTitle:"9.1. å¼å¸¸éè¯",charIndex:5744},{level:3,title:"9.2. éè¯è¶æ¶æ¶é´",slug:"_9-2-éè¯è¶æ¶æ¶é´",normalizedTitle:"9.2. éè¯è¶æ¶æ¶é´",charIndex:5969},{level:3,title:"9.3. ä¸å¡å¼å¸¸",slug:"_9-3-ä¸å¡å¼å¸¸",normalizedTitle:"9.3. ä¸å¡å¼å¸¸",charIndex:6242},{level:2,title:"10. ä¼éä¸çº¿ä¸çº¿",slug:"_10-ä¼éä¸çº¿ä¸çº¿",normalizedTitle:"10. ä¼éä¸çº¿ä¸çº¿",charIndex:6497},{level:3,title:"10.1. ä¼éä¸çº¿",slug:"_10-1-ä¼éä¸çº¿",normalizedTitle:"10.1. ä¼éä¸çº¿",charIndex:6530},{level:3,title:"10.2. ä¼éä¸çº¿",slug:"_10-2-ä¼éä¸çº¿",normalizedTitle:"10.2. ä¼éä¸çº¿",charIndex:6947},{level:4,title:"10.2.1. å¯å¨é¢ç­",slug:"_10-2-1-å¯å¨é¢ç­",normalizedTitle:"10.2.1. å¯å¨é¢ç­",charIndex:6961},{level:4,title:"10.2.2. å»¶è¿æ´é²",slug:"_10-2-2-å»¶è¿æ´é²",normalizedTitle:"10.2.2. å»¶è¿æ´é²",charIndex:7262},{level:2,title:"11. éæµçæ­",slug:"_11-éæµçæ­",normalizedTitle:"11. éæµçæ­",charIndex:7727},{level:2,title:"12. ä¸å¡åç»",slug:"_12-ä¸å¡åç»",normalizedTitle:"12. ä¸å¡åç»",charIndex:8174},{level:3,title:"12.1. å¨æåç»",slug:"_12-1-å¨æåç»",normalizedTitle:"12.1. å¨æåç»",charIndex:8482},{level:2,title:"13. é¾è·¯è·è¸ª",slug:"_13-é¾è·¯è·è¸ª",normalizedTitle:"13. é¾è·¯è·è¸ª",charIndex:8734},{level:2,title:"14. æ³åè°ç¨",slug:"_14-æ³åè°ç¨",normalizedTitle:"14. æ³åè°ç¨",charIndex:9432},{level:2,title:"15. æ¶éè½®",slug:"_15-æ¶éè½®",normalizedTitle:"15. æ¶éè½®",charIndex:10082},{level:2,title:"16. æµéåæ¾",slug:"_16-æµéåæ¾",normalizedTitle:"16. æµéåæ¾",charIndex:10691},{level:2,title:"17. RPC é«çº§",slug:"_17-rpc-é«çº§",normalizedTitle:"17. rpc é«çº§",charIndex:11136},{level:3,title:"17.1. RPC æ§è½",slug:"_17-1-rpc-æ§è½",normalizedTitle:"17.1. rpc æ§è½",charIndex:11151},{level:3,title:"17.2. RPC å®å¨",slug:"_17-2-rpc-å®å¨",normalizedTitle:"17.2. rpc å®å¨",charIndex:11368},{level:2,title:"18. åèèµæ",slug:"_18-åèèµæ",normalizedTitle:"18. åèèµæ",charIndex:11684}],headersStr:"1. RPC ç®ä» 1.1. ä»ä¹æ¯ RPC 1.2. RPC éä¿¡ 1.3. RPC åè®® 2. åºåå 2.1. å¸¸è§åºååæ¹å¼ 2.1.1. JDK åºåå 2.1.2. JSON 2.1.3. Hessian 2.1.4. Thrift / Protobuf 2.2. åºååé®é¢ 3. åå°+å¨æä»£ç 4. ç½ç»éä¿¡ 4.1. IO å¤è·¯å¤ç¨ 4.2. é¶æ·è´ 5. RPC æ¶ææ¨¡å 6. æå¡æ³¨åååç° 6.1. åºäº ZooKeeper çæå¡åç° 6.2. åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿ 7. å¥åº·æ£æ¥ 8. è·¯ç±åè´è½½åè¡¡ 8.1. è¶æ¶éè¯ 8.2. éæµãéçº§ãçæ­ 8.3. ä¼éå¯å¨å³é­ 9. å®¹éå¤ç 9.1. å¼å¸¸éè¯ 9.2. éè¯è¶æ¶æ¶é´ 9.3. ä¸å¡å¼å¸¸ 10. ä¼éä¸çº¿ä¸çº¿ 10.1. ä¼éä¸çº¿ 10.2. ä¼éä¸çº¿ 10.2.1. å¯å¨é¢ç­ 10.2.2. å»¶è¿æ´é² 11. éæµçæ­ 12. ä¸å¡åç» 12.1. å¨æåç» 13. é¾è·¯è·è¸ª 14. æ³åè°ç¨ 15. æ¶éè½® 16. æµéåæ¾ 17. RPC é«çº§ 17.1. RPC æ§è½ 17.2. RPC å®å¨ 18. åèèµæ",content:"# RPC åºæ¬åç\n\n\n# 1. RPC ç®ä»\n\n\n# 1.1. ä»ä¹æ¯ RPC\n\nRPC çå¨ç§°æ¯ Remote Procedure Callï¼å³è¿ç¨è¿ç¨è°ç¨ã\n\nRPC çä¸»è¦ä½ç¨æ¯ï¼\n\n * å±è½è¿ç¨è°ç¨è·æ¬å°è°ç¨çåºå«ã\n * éèåºå±ç½ç»éä¿¡çå¤ææ§ã\n\n\n# 1.2. RPC éä¿¡\n\nè¿ç¨è°ç¨è¯´æäºï¼RPC éè¦éä¿¡ï¼é£ä¹ RPC çéä¿¡è¿ç¨æ¯ææ ·çå¢ï¼\n\nRPC å¸¸ç¨äºä¸å¡ç³»ç»ä¹é´çæ°æ®äº¤äºï¼éè¦ä¿è¯å¶å¯é æ§ï¼æä»¥ RPC ä¸è¬é»è®¤éç¨ TCP æ¥ä¼ è¾ã\n\nç½ç»ä¼ è¾çæ°æ®å¿é¡»æ¯äºè¿å¶æ°æ®ï¼ä½è°ç¨æ¹è¯·æ±çåºå¥åæ°é½æ¯å¯¹è±¡ï¼æä»¥å¿é¡»è¦å°å¶è½¬æ¢ï¼è¿ä¸ªè¿ç¨å«åºååã\n\n\n\n * RPC æ¦æªè°ç¨æ¹è¦æ§è¡çè¿ç¨æ¹æ³ï¼å°æ¹æ³åãåæ°ç­åºååä¸ºæ¹ä¾¿å¨ç½ç»ä¸­ä¼ è¾çäºè¿å¶æ JSON æ°æ®ï¼ç¶åå°è¿äºè¯·æ±ä¿¡æ¯ä¼ ç»æå¡æä¾æ¹ï¼\n * æå¡æä¾æ¹å°è¯·æ±ä¿¡æ¯ååºååä¸ºæ¬å°çæ¹æ³åè¯·æ±åæ°ï¼ç¶åæ§è¡ï¼æåå°æ§è¡ç»æåºååä¸ºäºè¿å¶æ JSON æ°æ®ï¼åååºç»è°ç¨æ¹ã\n * è°ç¨æ¹å°åºç­æ°æ®ååºååã\n\n\n# 1.3. RPC åè®®\n\næ¢ç¶æäºç°æç HTTP åè®®ï¼è¿æå¿è¦è®¾è®¡ RPC åè®®åï¼\n\næå¿è¦ãå ä¸º HTTP è¿äºéä¿¡æ ååè®®ï¼æ°æ®åä¸­çå®éè¯·æ±æ°æ®ç¸å¯¹äºæ°æ®åæ¬èº«è¦å°å¾å¤ï¼æå¾å¤æ ç¨çåå®¹ï¼å¹¶ä¸ HTTP å±äºæ ç¶æåè®®ï¼æ æ³å°è¯·æ±åååºå³èï¼æ¯æ¬¡è¯·æ±è¦éæ°å»ºç«è¿æ¥ãè¿å¯¹äºé«æ§è½ç RPC æ¥è¯´ï¼HTTP åè®®é¾ä»¥æ»¡è¶³éæ±ï¼æä»¥æå¿è¦è®¾è®¡ä¸ä¸ªç´§åçç§æåè®®ã\n\n\n\n\n# 2. åºåå\n\n> åºååå¯ä»¥å°å¯¹è±¡çå­èåºåæä¹åââä¿å­å¨åå­ãæä»¶ãæ°æ®åºä¸­ã\n\nåºååæ¯ RPC çè¦ç¹ä¹ä¸ã\n\n\n\n\n# 2.1. å¸¸è§åºååæ¹å¼\n\n# 2.1.1. JDK åºåå\n\n> æå´è¶£æ·±å¥äºè§£ JDK åºååæ¹å¼ï¼å¯ä»¥åèï¼æ·±å¥çè§£ Java åºåå\n\n# 2.1.2. JSON\n\njacksonãgsonãfastjson - éç¨äºå¯¹åºåååçæ°æ®è¦æ±æè¯å¥½çå¯è¯»æ§ï¼è½¬ä¸º json ãxml å½¢å¼ï¼ã\n\n# 2.1.3. Hessian\n\nhessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n\nä½ Hessian æ¬èº«ä¹æé®é¢ï¼å®æ¹çæ¬å¯¹ Java éé¢ä¸äºå¸¸è§å¯¹è±¡çç±»åä¸æ¯æï¼æ¯å¦ï¼\n\n * Linked ç³»åï¼LinkedHashMapãLinkedHashSet ç­ï¼ä½æ¯å¯ä»¥éè¿æ©å± CollectionDeserializer ç±»ä¿®å¤ï¼\n * Locale ç±»ï¼å¯ä»¥éè¿æ©å± ContextSerializerFactory ç±»ä¿®å¤ï¼\n * Byte/Short ååºååçæ¶ååæ Integerã\n\n# 2.1.4. Thrift / Protobuf\n\nthriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n\nåæ¬¡ä»¥å¤ï¼è¿æå¾å¤å¶ä»çåºååæ¹æ¡ãé£ä¹ï¼RPC çåºååæ¹å¼å¦ä½éæ©å¢ï¼\n\n\n\nç»¼åä»¥ä¸ï¼Java RPC æ¡æ¶ä¸­åºååæ¹å¼ï¼ä¸è¬é¦é Protobuf å Hessianï¼äºèå¨æ§è½ãéç¨æ§ãå®å¨æ§ãå¼å®¹æ§ãç©ºé´å¼éä¸é½è¡¨ç°ä¸éãå¶ä¸­ï¼Protobuf æ§è½ãéç¨æ§æ´å¥½ï¼è Hessian å¨å¼åä½éªä¸æ´ä¸ºä¾¿æ·ã\n\n\n# 2.2. åºååé®é¢\n\nJava å¯¹è±¡åºååï¼ä¸è¬è¦å³æ³¨ä»¥ä¸é®é¢ï¼\n\nå¸¸è§æ§é®é¢ï¼\n\n * å½ç¶ç±»ç»§æ¿ Serializable æ¥å£æ¶ï¼ææå­ç±»é½å¯ä»¥è¢«åºååã\n * å­ç±»å®ç°äº Serializable æ¥å£ï¼ç¶ç±»æ²¡æï¼åç¶ç±»çå±æ§ä¸ä¼è¢«åºååï¼ä¸æ¥éï¼æ°æ®ä¸¢å¤±ï¼ï¼å­ç±»çå±æ§ä»å¯ä»¥æ­£ç¡®åºååã\n * å¦æåºååçå±æ§æ¯å¯¹è±¡ï¼åè¿ä¸ªå¯¹è±¡ä¹å¿é¡»å®ç° Serializable æ¥å£ï¼å¦åä¼æ¥éã\n * å¨ååºååæ¶ï¼å¦æå¯¹è±¡çå±æ§æä¿®æ¹æå åï¼åä¿®æ¹çé¨åå±æ§ä¼ä¸¢å¤±ï¼ä½ä¸ä¼æ¥éã\n * å¨ååºååæ¶ï¼å¦æ serialVersionUID è¢«ä¿®æ¹ï¼åååºååæ¶ä¼å¤±è´¥ã\n\nè®¾è®¡é®é¢ï¼\n\n * å¯¹è±¡è¿äºå¤æãåºå¤§ - å¯¹è±¡è¿äºå¤æãåºå¤§ï¼ä¼éä½åºååãååºååçæçï¼å¹¶å¢å ä¼ è¾å¼éï¼ä»èå¯¼è´ååºæ¶å»¶å¢å¤§ã\n * å¯¹è±¡æå¤æçç»§æ¿å³ç³» - å¯¹è±¡å³ç³»è¶å¤æï¼å°±è¶æµªè´¹æ§è½ï¼åæ¶åå¾å®¹æåºç°åºååä¸çé®é¢ã\n * ä½¿ç¨åºååæ¡æ¶ä¸æ¯æçç±»ä½ä¸ºå¥åç±» - æ¯å¦ Hessian æ¡æ¶ï¼ä»å¤©ç¶æ¯ä¸æ¯æ LinkHashMapãLinkedHashSet ç­ï¼èä¸å¤§å¤æ°æåµä¸æå¥½ä¸è¦ä½¿ç¨ç¬¬ä¸æ¹éåç±»ï¼å¦ Guava ä¸­çéåç±»ï¼å¾å¤å¼æºçåºååæ¡æ¶é½æ¯ä¼åæ¯æç¼ç¨è¯­è¨åççå¯¹è±¡ãå æ­¤å¦æå¥åæ¯éåç±»ï¼åºå°½ééç¨åççãæä¸ºå¸¸ç¨çéåç±»ï¼å¦ HashMapãArrayListã\n\n\n# 3. åå°+å¨æä»£ç\n\nRPC çè¿ç¨è¿ç¨è°ç¨æ¶éè¿åå°+å¨æä»£çå®ç°çã\n\n\n\nRPC æ¡æ¶ä¼èªå¨ä¸ºè¦è°ç¨çæ¥å£çæä¸ä¸ªä»£çç±»ãå½å¨é¡¹ç®ä¸­æ³¨å¥æ¥å£çæ¶åï¼è¿è¡è¿ç¨ä¸­å®éç»å®çå°±æ¯è¿ä¸ªæ¥å£çæçä»£çç±»ãå¨æ¥å£æ¹æ³è¢«è°ç¨æ¶ï¼ä¼è¢«ä»£çç±»æ¦æªï¼è¿æ ·ï¼å°±å¯ä»¥å¨çæçä»£çç±»ä¸­ï¼å å¥è¿ç¨è°ç¨é»è¾ã\n\né¤äº JDK é»è®¤ç InvocationHandler è½å®æä»£çåè½ï¼è¿æå¾å¤å¶ä»çç¬¬ä¸æ¹æ¡æ¶ä¹å¯ä»¥ï¼æ¯å¦å JavassistãByte Buddy è¿æ ·çæ¡æ¶ã\n\n> åå°+å¨æä»£çæ´å¤è¯¦æå¯ä»¥åèï¼æ·±å¥çè§£ Java åå°åå¨æä»£ç\n\n\n# 4. ç½ç»éä¿¡\n\nä¸æ¬¡ RPC è°ç¨ï¼æ¬è´¨å°±æ¯æå¡æ¶è´¹èä¸æå¡æä¾èé´çä¸æ¬¡ç½ç»ä¿¡æ¯äº¤æ¢çè¿ç¨ãå¯è§ï¼éä¿¡æ¶ RPC å®ç°çæ ¸å¿ã\n\nå¸¸è§çç½ç» IO æ¨¡åæï¼åæ­¥é»å¡ï¼BIOï¼ãåæ­¥éé»å¡ï¼NIOï¼ãå¼æ­¥éé»å¡ï¼AIOï¼ã\n\n\n# 4.1. IO å¤è·¯å¤ç¨\n\nIO å¤è·¯å¤ç¨ï¼Reactor æ¨¡å¼ï¼å¨é«å¹¶ååºæ¯ä¸ä½¿ç¨æä¸ºå¹¿æ³ï¼å¾å¤ç¥åè½¯ä»¶é½åºç¨äºè¿ä¸ææ¯ï¼å¦ï¼NettyãRedisãNginx ç­ã\n\nIO å¤è·¯å¤ç¨åä¸º selectï¼poll å epollã\n\nä»ä¹æ¯ IO å¤è·¯å¤ç¨ï¼å­é¢ä¸ççè§£ï¼å¤è·¯å°±æ¯æå¤ä¸ªééï¼ä¹å°±æ¯å¤ä¸ªç½ç»è¿æ¥ç IOï¼èå¤ç¨å°±æ¯æå¤ä¸ªééå¤ç¨å¨ä¸ä¸ªå¤ç¨å¨ä¸ã\n\n\n# 4.2. é¶æ·è´\n\nç³»ç»åæ ¸å¤ç IO æä½åä¸ºä¸¤ä¸ªé¶æ®µââç­å¾æ°æ®åæ·è´æ°æ®ãç­å¾æ°æ®ï¼å°±æ¯ç³»ç»åæ ¸å¨ç­å¾ç½å¡æ¥æ¶å°æ°æ®åï¼ææ°æ®åå°åæ ¸ä¸­ï¼èæ·è´æ°æ®ï¼å°±æ¯ç³»ç»åæ ¸å¨è·åå°æ°æ®åï¼å°æ°æ®æ·è´å°ç¨æ·è¿ç¨çç©ºé´ä¸­ã\n\n\n\nåºç¨è¿ç¨çæ¯ä¸æ¬¡åæä½ï¼é½ä¼ææ°æ®åå°ç¨æ·ç©ºé´çç¼å²åºä¸­ï¼åç± CPU å°æ°æ®æ·è´å°ç³»ç»åæ ¸çç¼å²åºä¸­ï¼ä¹ååç± DMA å°è¿ä»½æ°æ®æ·è´å°ç½å¡ä¸­ï¼æåç±ç½å¡åéåºå»ãè¿éæä»¬å¯ä»¥çå°ï¼ä¸æ¬¡åæä½æ°æ®è¦æ·è´ä¸¤æ¬¡æè½éè¿ç½å¡åéåºå»ï¼èç¨æ·è¿ç¨çè¯»æä½åæ¯å°æ´ä¸ªæµç¨åè¿æ¥ï¼æ°æ®åæ ·ä¼æ·è´ä¸¤æ¬¡æè½è®©åºç¨ç¨åºè¯»åå°æ°æ®ã\n\nåºç¨è¿ç¨çä¸æ¬¡å®æ´çè¯»åæä½ï¼é½éè¦å¨ç¨æ·ç©ºé´ä¸åæ ¸ç©ºé´ä¸­æ¥åæ·è´ï¼å¹¶ä¸æ¯ä¸æ¬¡æ·è´ï¼é½éè¦ CPU è¿è¡ä¸æ¬¡ä¸ä¸æåæ¢ï¼ç±ç¨æ·è¿ç¨åæ¢å°ç³»ç»åæ ¸ï¼æç±ç³»ç»åæ ¸åæ¢å°ç¨æ·è¿ç¨ï¼ï¼è¿æ ·å¾æµªè´¹ CPU åæ§è½ã\n\næè°çé¶æ·è´ï¼å°±æ¯åæ¶ç¨æ·ç©ºé´ä¸åæ ¸ç©ºé´ä¹é´çæ°æ®æ·è´æä½ï¼åºç¨è¿ç¨æ¯ä¸æ¬¡çè¯»åæä½ï¼å¯ä»¥éè¿ä¸ç§æ¹å¼ï¼ç´æ¥å°æ°æ®åå¥åæ ¸æä»åæ ¸ä¸­è¯»åæ°æ®ï¼åéè¿ DMA å°åæ ¸ä¸­çæ°æ®æ·è´å°ç½å¡ï¼æå°ç½å¡ä¸­çæ°æ® copy å°åæ ¸ã\n\n\n\nNetty çé¶æ·è´ååäºç¨æ·ç©ºé´ä¸­å¯¹æ°æ®æä½çä¼åï¼è¿å¯¹å¤ç TCP ä¼ è¾ä¸­çæåç²åé®é¢æçéè¦çæä¹ï¼å¯¹åºç¨ç¨åºå¤çè¯·æ±æ°æ®ä¸è¿åæ°æ®ä¹æéè¦çæä¹ã\n\nNetty æ¡æ¶ä¸­å¾å¤åé¨ç ChannelHandler å®ç°ç±»ï¼é½æ¯éè¿ CompositeByteBufãsliceãwrap æä½æ¥å¤ç TCP ä¼ è¾ä¸­çæåä¸ç²åé®é¢çã\n\nNetty ç ByteBuffer å¯ä»¥éç¨ Direct Buffersï¼ä½¿ç¨å å¤ç´æ¥åå­è¿è¡ Socketd çè¯»å æä½ï¼æç»çææä¸æåæè®²è§£çèæåå­æå®ç°çæææ¯ä¸æ ·çã\n\nNetty è¿æä¾ FileRegion ä¸­åè£ NIO ç FileChannel.transferTo() æ¹æ³å®ç°äºé¶æ· è´ï¼è¿ä¸ Linux ä¸­ç sendfile æ¹å¼å¨åçä¸ä¹æ¯ä¸æ ·çã\n\n\n# 5. RPC æ¶ææ¨¡å\n\näºè§£åé¢çç¥è¯ç¹ï¼åºååãå¨æä»£çãéä¿¡ï¼ï¼å¶å®å·²ç»å¯ä»¥å®ç°ä¸ä¸ªç¹å¯¹ç¹ç RPC æ¶æäºã\n\néç¨å¾®åæ ¸æ¶æç RPC æ¶ææ¨¡åï¼\n\n\n\nå¨ RPC æ¡æ¶éé¢ï¼æä¹æ¯ææä»¶åæ¶æçå¢ï¼æä»¬å¯ä»¥å°æ¯ä¸ªåè½ç¹æ½è±¡æä¸ä¸ªæ¥ å£ï¼å°è¿ä¸ªæ¥å£ä½ä¸ºæä»¶çå¥çº¦ï¼ç¶åæè¿ä¸ªåè½çæ¥å£ä¸åè½çå®ç°åç¦»ï¼å¹¶æä¾æ¥å£çé»è®¤å®ç°ãå¨ Java éé¢ï¼JDK æèªå¸¦ç SPIï¼Service Provider Interfaceï¼æå¡åç°æº å¶ï¼å®å¯ä»¥å¨æå°ä¸ºæä¸ªæ¥å£å¯»æ¾æå¡å®ç°ãä½¿ç¨ SPI æºå¶éè¦å¨ Classpath ä¸ç META-INF/services ç®å½éåå»ºä¸ä¸ªä»¥æå¡æ¥å£å½åçæä»¶ï¼è¿ä¸ªæä»¶éçåå®¹å°±æ¯è¿ä¸ªæ¥å£çå·ä½å®ç°ç±»ã\n\nä½å¨å®éé¡¹ç®ä¸­ï¼æä»¬å¶å®å¾å°ä½¿ç¨å° JDK èªå¸¦ç SPI æºå¶ï¼é¦åå®ä¸è½æéå è½½ï¼ ServiceLoader å è½½æä¸ªæ¥å£å®ç°ç±»çæ¶åï¼ä¼éåå¨é¨è·åï¼ä¹å°±æ¯æ¥å£çå®ç°ç±»å¾å¨é¨è½½å¥å¹¶å®ä¾åä¸éï¼ä¼é æä¸å¿è¦çæµªè´¹ãå¦å¤å°±æ¯æ©å±å¦æä¾èµå¶å®çæ©å±ï¼é£å°±åä¸å°èªå¨æ³¨å¥åè£éï¼è¿å°±å¾é¾åå¶ä»æ¡æ¶éæï¼æ¯å¦æ©å±éé¢ä¾èµäºä¸ä¸ª Spring Beanï¼åçç Java SPI å°±ä¸æ¯æã\n\n\n# 6. æå¡æ³¨åååç°\n\nRPC æ¡æ¶å¿é¡»è¦ææå¡æ³¨åååç°æºå¶ï¼è¿æ ·ï¼éç¾¤ä¸­çèç¹æè½ç¥ééä¿¡æ¹çè¯·æ±å°åã\n\n * æå¡æ³¨åï¼å¨æå¡æä¾æ¹å¯å¨çæ¶åï¼å°å¯¹å¤æ´é²çæ¥å£æ³¨åå°æ³¨åä¸­å¿ä¹ä¸­ï¼æ³¨åä¸­å¿å°è¿ä¸ªæå¡èç¹ç IP åæ¥å£ä¿å­ä¸æ¥ã\n * æå¡è®¢éï¼å¨æå¡è°ç¨æ¹å¯å¨çæ¶åï¼å»æ³¨åä¸­å¿æ¥æ¾å¹¶è®¢éæå¡æä¾æ¹ç IPï¼ç¶åç¼å­å°æ¬å°ï¼å¹¶ç¨äºåç»­çè¿ç¨è°ç¨ã\n\n\n# 6.1. åºäº ZooKeeper çæå¡åç°\n\nä½¿ç¨ ZooKeeper ä½ä¸ºæå¡æ³¨åä¸­å¿ï¼æ¯ Java åå¸å¼ç³»ç»çç»å¸æ¹æ¡ã\n\næ­å»ºä¸ä¸ª ZooKeeper éç¾¤ä½ä¸ºæ³¨åä¸­å¿éç¾¤ï¼æå¡æ³¨åçæ¶ååªéè¦æå¡èç¹å ZooKeeper èç¹åå¥æ³¨åä¿¡æ¯å³å¯ï¼å©ç¨ ZooKeeper ç Watcher æºå¶å®ææå¡è®¢éä¸æå¡ä¸ååè½\n\n\n\néå¸¸æä»¬å¯ä»¥ä½¿ç¨ ZooKeeperãetcd æèåå¸å¼ç¼å­ï¼å¦ Hazelcastï¼æ¥è§£å³äºä»¶éç¥é®é¢ï¼ä½å½éç¾¤è¾¾å°ä¸å®è§æ¨¡ä¹åï¼ä¾èµç ZooKeeper éç¾¤ãetcd éç¾¤å¯è½å°±ä¸ç¨³å®äºï¼æ æ³æ»¡è¶³æä»¬çéæ±ã\n\nå¨è¶å¤§è§æ¨¡çæå¡éç¾¤ä¸ï¼æ³¨åä¸­å¿æé¢ä¸´çææå°±æ¯è¶å¤§æ¹éæå¡èç¹åæ¶ä¸ä¸çº¿ï¼æ³¨åä¸­å¿éç¾¤æ¥åå°å¤§éæå¡åæ´è¯·æ±ï¼éç¾¤é´åèç¹é´éè¦åæ­¥å¤§éæå¡èç¹æ°æ®ï¼æç»å¯¼è´å¦ä¸é®é¢ï¼\n\n * æ³¨åä¸­å¿è´è½½è¿é«ï¼\n * åèç¹æ°æ®ä¸ä¸è´ï¼\n * æå¡ä¸åä¸åæ¶æä¸åéè¯¯çæå¡èç¹åè¡¨ã\n\nRPC æ¡æ¶ä¾èµçæ³¨åä¸­å¿çæå¡æ°æ®çä¸è´æ§å¶å®å¹¶ä¸éè¦æ»¡è¶³ CPï¼åªè¦æ»¡è¶³ AP å³å¯ã\n\n\n# 6.2. åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿\n\nZooKeeper çä¸å¤§ç¹ç¹å°±æ¯å¼ºä¸è´æ§ï¼ZooKeeper éç¾¤çæ¯ä¸ªèç¹çæ°æ®æ¯æ¬¡åçæ´æ°æä½ï¼é½ä¼éç¥å¶å® ZooKeeper èç¹åæ¶æ§è¡æ´æ°ãå®è¦æ±ä¿è¯æ¯ä¸ªèç¹çæ°æ®è½å¤å®æ¶çå®å¨ä¸è´ï¼è¿ä¹å°±ç´æ¥å¯¼è´äº ZooKeeper éç¾¤æ§è½ä¸çä¸éã\n\nè RPC æ¡æ¶çæå¡åç°ï¼å¨æå¡èç¹åä¸çº¿æ¶ï¼æå¡è°ç¨æ¹æ¯å¯ä»¥å®¹å¿å¨ä¸æ®µæ¶é´ä¹å ï¼æ¯å¦å ç§éä¹åï¼åç°è¿ä¸ªæ°ä¸çº¿çèç¹çãæ¯ç«æå¡èç¹åä¸çº¿ä¹åçå ç§åï¼çè³æ´é¿çä¸æ®µæ¶é´åæ²¡ææ¥æ¶å°è¯·æ±æµéï¼å¯¹æ´ä¸ªæå¡éç¾¤æ¯æ²¡æä»ä¹å½±åçï¼æä»¥æä»¬å¯ä»¥çºç²æ CPï¼å¼ºå¶ä¸è´æ§ï¼ï¼èéæ© APï¼æç»ä¸è´ï¼ï¼æ¥æ¢åæ´ä¸ªæ³¨åä¸­å¿éç¾¤çæ§è½åç¨³å®æ§ã\n\n\n\n\n# 7. å¥åº·æ£æ¥\n\nä½¿ç¨é¢çéä¸­çå¿è·³å»æ£æµç®æ æºå¨çå¥åº·ç¶æã\n\n * å¥åº·ç¶æï¼å»ºç«è¿æ¥æåï¼å¹¶ä¸å¿è·³æ¢æ´»ä¹ä¸ç´æåï¼\n * äºå¥åº·ç¶æï¼å»ºç«è¿æ¥æåï¼ä½æ¯å¿è·³è¯·æ±è¿ç»­å¤±è´¥ï¼\n * æ­»äº¡ç¶æï¼å»ºç«è¿æ¥å¤±è´¥ã\n\nå¯ä»¥ä½¿ç¨å¯ç¨çæ¥ä½ä¸ºå¥åº·ç¶æçéåæ åï¼\n\nå¯ç¨ç = ä¸ä¸ªæ¶é´çªå£åæ¥å£è°ç¨æåæ¬¡æ° / æ»è°ç¨æ¬¡æ°\n\n\nå½å¯ç¨çä½äºæä¸ªæ¯ä¾ï¼å°±è®¤ä¸ºè¿ä¸ªèç¹å­å¨é®é¢ï¼æå®æªå°äºå¥åº·åè¡¨ï¼è¿æ ·æ¢èèäºé«ä½é¢çè°ç¨æ¥å£ï¼ä¹å¼é¡¾äºæ¥å£ååºæ¶é´ä¸åçé®é¢ã\n\n\n# 8. è·¯ç±åè´è½½åè¡¡\n\nå¯¹äºæå¡è°ç¨æ¹æ¥è¯´ï¼ä¸ä¸ªæ¥å£ä¼æå¤ä¸ªæå¡æä¾æ¹åæ¶æä¾æå¡ï¼æä»¥æä»¬ç RPC å¨æ¯æ¬¡åèµ·è¯·æ±çæ¶åï¼é½éè¦ä»å¤ä¸ªæå¡æä¾æ¹èç¹éé¢éæ©ä¸ä¸ªç¨äºåè¯·æ±çèç¹ãè¿è¢«ç§°ä¸ºè·¯ç±ç­ç¥ã\n\n * IP è·¯ç±ï¼æç®åçå½ç¶æ¯ IP è·¯ç±ï¼å ä¸ºæå¡ä¸çº¿åï¼ä¼æ´é²æå¡å°æ³¨åä¸­å¿ï¼å°èªèº« IPãç«¯å£ç­åä¿¡æ¯åç¥æ³¨åä¸­å¿ãè¿æ ·æ¶è´¹æ¹å°±å¯ä»¥å¨åæ³¨åä¸­å¿è¯·æ±æå¡å°åæ¶ï¼æç¥å¶å­å¨ã\n * åæ°è·¯ç±ï¼ä½ææ¶ï¼ä¼æä¸äºå¤æçåºæ¯ï¼å¦ï¼ç°åº¦åå¸ãå®ç¹è°ç¨ï¼æä»¬å¹¶ä¸å¸æä¸çº¿çæå¡è¢«æææ¶è´¹èæç¥ï¼ä¸ºäºæ´å ç»ç²åº¦çæ§å¶ï¼å¯ä»¥ä½¿ç¨åæ°è·¯ç±ãéè¿åæ°æ§å¶éä¿¡çè·¯ç±ç­ç¥ã\n\né¤äºç¹æ®åºæ¯çè·¯ç±ç­ç¥ä»¥å¤ï¼å¯¹äºæºå¨ä¸­å¤ä¸ªæå¡æ¹ï¼å¦ä½éæ©è°ç¨åªä¸ªæå¡èç¹ï¼å¯ä»¥åºç¨è´è½½åè¡¡ç­ç¥ãRPC è´è½½åè¡¡ç­ç¥ä¸è¬åæ¬éæºãè½®è¯¢ãä¸è´æ§ Hashãæè¿æå°è¿æ¥ç­ã\n\n\n\n> è´è½½åè¡¡è¯¦æå¯ä»¥åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 8.1. è¶æ¶éè¯\n\nè¶æ¶éè¯æºå¶æ¯æï¼å½è°ç¨ç«¯åèµ·çè¯·æ±å¤±è´¥æè¶æ¶æªæ¶å°ååºæ¶ï¼RPC æ¡æ¶èªèº«å¯ä»¥è¿è¡éè¯ï¼åéæ°åéè¯·æ±ï¼ç¨æ·å¯ä»¥èªè¡è®¾ç½®æ¯å¦å¼å¯éè¯ä»¥åéè¯çæ¬¡æ°ã\n\n\n\n\n# 8.2. éæµãéçº§ãçæ­\n\néæµæ¹æ¡ï¼Redis + luaãSentinel\n\nçæ­æ¹æ¡ï¼Hystrix\n\n\n# 8.3. ä¼éå¯å¨å³é­\n\nå¦ä½é¿åæå¡åæºå¸¦æ¥çä¸å¡æå¤±ï¼\n\n\n\nå¦ä½é¿åæµéæå°æ²¡æå¯å¨å®æçèç¹ï¼\n\n\n\n\n# 9. å®¹éå¤ç\n\n\n# 9.1. å¼å¸¸éè¯\n\nå°±æ¯å½è°ç¨ç«¯åèµ·çè¯·æ±å¤±è´¥æ¶ï¼RPC æ¡æ¶èªèº«å¯ä»¥è¿è¡éè¯ï¼åéæ°åéè¯·æ±ï¼ç¨æ·å¯ä»¥èªè¡è®¾ç½®æ¯å¦å¼å¯éè¯ä»¥åéè¯çæ¬¡æ°ã\n\nå½ç¶ï¼ä¸æ¯ææçå¼å¸¸é½è¦è§¦åéè¯ï¼åªæç¬¦åéè¯æ¡ä»¶çå¼å¸¸æè½è§¦åéè¯ï¼æ¯å¦ç½ç»è¶æ¶å¼å¸¸ãç½ç»è¿æ¥å¼å¸¸ç­ç­ï¼è¿ä¸ªéè¦ RPC å»å¤å®ï¼ã\n\n> æ³¨æï¼ææ¶ç½ç»å¯è½åçæå¨ï¼å¯¼è´è¯·æ±è¶æ¶ï¼è¿æ¶å¦æ RPC è§¦åè¶æ¶éè¯ï¼ä¼è§¦åä¸å¡é»è¾éå¤æ§è¡ï¼å¦ææ¥å£æ²¡æå¹ç­æ§è®¾è®¡ï¼å°±å¯è½å¼åé®é¢ãå¦ï¼éååè¡¨ã\n\n\n# 9.2. éè¯è¶æ¶æ¶é´\n\nè¿ç»­çå¼å¸¸éè¯å¯è½ä¼åºç°ä¸ç§ä¸å¯é çæåµï¼é£å°±æ¯è¿ç»­çå¼å¸¸éè¯å¹¶ä¸æ¯æ¬¡å¤ççè¯·æ±æ¶é´æ¯è¾é¿ï¼æç»ä¼å¯¼è´è¯·æ±å¤ççæ¶é´è¿é¿ï¼è¶åºç¨æ·è®¾ç½®çè¶æ¶æ¶é´ã\n\nè§£å³è¿ä¸ªé®é¢æç´æ¥çæ¹å¼å°±æ¯ï¼å¨æ¯æ¬¡éè¯åé½éç½®ä¸ä¸è¯·æ±çè¶æ¶æ¶é´ã\n\nå½è°ç¨ç«¯åèµ· RPC è¯·æ±æ¶ï¼å¦æåéè¯·æ±åçå¼å¸¸å¹¶è§¦åäºå¼å¸¸éè¯ï¼æä»¬å¯ä»¥åå¤å®ä¸è¿ä¸ªè¯·æ±æ¯å¦å·²ç»è¶æ¶ï¼å¦æå·²ç»è¶æ¶äºå°±ç´æ¥è¿åè¶æ¶å¼å¸¸ï¼å¦åå°±åéç½®ä¸è¿ä¸ªè¯·æ±çè¶æ¶æ¶é´ï¼ä¹åååèµ·éè¯ã\n\nå¨ææåèµ·éè¯ãè´è½½åè¡¡éæ©èç¹çæ¶åï¼å»æéè¯ä¹ååºç°è¿é®é¢çé£ä¸ªèç¹ï¼ä»¥ä¿è¯éè¯çæåçã\n\n\n# 9.3. ä¸å¡å¼å¸¸\n\nRPC æ¡æ¶æ¯ä¸ä¼ç¥éåªäºä¸å¡å¼å¸¸è½å¤å»è¿è¡å¼å¸¸éè¯çï¼æä»¬å¯ä»¥å ä¸ªéè¯å¼å¸¸çç½å åï¼ç¨æ·å¯ä»¥å°åè®¸éè¯çå¼å¸¸å å¥å°è¿ä¸ªç½ååä¸­ãå½è°ç¨ç«¯åèµ·è°ç¨ï¼å¹¶ä¸éç½®äºå¼å¸¸éè¯ç­ç¥ï¼æè·å°å¼å¸¸ä¹åï¼æä»¬å°±å¯ä»¥éç¨è¿æ ·çå¼å¸¸å¤çç­ç¥ãå¦æè¿ä¸ªå¼å¸¸æ¯ RPC æ¡æ¶åè®¸éè¯çå¼å¸¸ï¼æèè¿ä¸ªå¼å¸¸ç±»åå­å¨äºå¯éè¯å¼å¸¸çç½ååä¸­ï¼æä»¬å°±åè®¸å¯¹è¿ä¸ªè¯·æ±è¿è¡éè¯ã\n\n----------------------------------------\n\nç»¼ä¸ï¼ä¸ä¸ªå¯é ç RPC å®¹éå¤çæºå¶å¦ä¸ï¼\n\n\n\n\n# 10. ä¼éä¸çº¿ä¸çº¿\n\nå¦ä½é¿åæå¡åæºå¸¦æ¥çä¸å¡æå¤±ï¼\n\n\n# 10.1. ä¼éä¸çº¿\n\nå½æå¡æä¾æ¹æ­£å¨å³é­ï¼å¦æè¿ä¹åè¿æ¶å°äºæ°çä¸å¡è¯·æ±ï¼æå¡æä¾æ¹ç´æ¥è¿åä¸ä¸ªç¹å®çå¼å¸¸ç»è°ç¨æ¹ï¼æ¯å¦ ShutdownExceptionï¼ãè¿ä¸ªå¼å¸¸å°±æ¯åè¯è°ç¨æ¹âæå·²ç»æ¶å°è¿ä¸ªè¯·æ±äºï¼ä½æ¯ææ­£å¨å³é­ï¼å¹¶æ²¡æå¤çè¿ä¸ªè¯·æ±âï¼ç¶åè°ç¨æ¹æ¶å°è¿ä¸ªå¼å¸¸ååºåï¼RPC æ¡æ¶æè¿ä¸ªèç¹ä»å¥åº·åè¡¨æªåºï¼å¹¶æè¯·æ±èªå¨éè¯å°å¶ä»èç¹ï¼å ä¸ºè¿ä¸ªè¯·æ±æ¯æ²¡æè¢«æå¡æä¾æ¹å¤çè¿ï¼æä»¥å¯ä»¥å®å¨å°éè¯å°å¶ä»èç¹ï¼è¿æ ·å°±å¯ä»¥å®ç°å¯¹ä¸å¡æ æã\n\nå¨ Java è¯­è¨éé¢ï¼å¯¹åºçæ¯ Runtime.addShutdownHook æ¹æ³ï¼å¯ä»¥æ³¨åå³é­çé©å­ãå¨ RPC å¯å¨çæ¶åï¼æä»¬æåæ³¨åå³é­é©å­ï¼å¹¶å¨éé¢æ·»å äºä¸¤ä¸ªå¤çç¨åºï¼ä¸ä¸ªè´è´£å¼å¯å³é­æ è¯ï¼ä¸ä¸ªè´è´£å®å¨å³é­æå¡å¯¹è±¡ï¼æå¡å¯¹è±¡å¨å³é­çæ¶åä¼éç¥è°ç¨æ¹ä¸çº¿èç¹ãåæ¶éè¦å¨æä»¬è°ç¨é¾éé¢å ä¸æ¡æ¿å¤çå¨ï¼å½æ°çè¯·æ±æ¥çæ¶åï¼ä¼å¤æ­å³é­æ è¯ï¼å¦ææ­£å¨å³é­ï¼åæåºç¹å®å¼å¸¸ã\n\n\n\n\n# 10.2. ä¼éä¸çº¿\n\n# 10.2.1. å¯å¨é¢ç­\n\nå¯å¨é¢ç­ï¼å°±æ¯è®©åå¯å¨çæå¡æä¾æ¹åºç¨ä¸æ¿æå¨é¨çæµéï¼èæ¯è®©å®è¢«è°ç¨çæ¬¡æ°éçæ¶é´çç§»å¨æ¢æ¢å¢å ï¼æç»è®©æµéç¼åå°å¢å å°è·å·²ç»è¿è¡ä¸æ®µæ¶é´åçæ°´å¹³ä¸æ ·ã\n\né¦åï¼å¨çå®ç¯å¢ä¸­æºå¨é½ä¼é»è®¤å¼å¯ NTP æ¶é´åæ­¥åè½ï¼æ¥ä¿è¯æææºå¨æ¶é´çä¸è´æ§ã\n\nè°ç¨æ¹éè¿æå¡åç°ï¼é¤äºå¯ä»¥æ¿å° IP åè¡¨ï¼è¿å¯ä»¥æ¿å°å¯¹åºçå¯å¨æ¶é´ãæä»¬éè¦æè¿ä¸ªæ¶é´ä½ç¨å¨è´è½½åè¡¡ä¸ã\n\n\n\néè¿è¿ä¸ªå°é»è¾çæ¹å¨ï¼æä»¬å°±å¯ä»¥ä¿è¯å½æå¡æä¾æ¹è¿è¡æ¶é¿å°äºé¢ç­æ¶é´æ¶ï¼å¯¹æå¡æä¾æ¹è¿è¡éæï¼åå°è¢«è´è½½åè¡¡éæ©çæ¦çï¼é¿åè®©åºç¨å¨å¯å¨ä¹åå°±å¤äºé«è´è½½ç¶æï¼ä»èå®ç°æå¡æä¾æ¹å¨å¯å¨åæä¸ä¸ªé¢ç­çè¿ç¨ã\n\n# 10.2.2. å»¶è¿æ´é²\n\næå¡æä¾æ¹åºç¨å¨æ²¡æå¯å¨å®æçæ¶åï¼è°ç¨æ¹çè¯·æ±å°±è¿æ¥äºï¼èè°ç¨æ¹è¯·æ±è¿æ¥çåå æ¯ï¼æå¡æä¾æ¹åºç¨å¨å¯å¨è¿ç¨ä¸­æè§£æå°ç RPC æå¡æ³¨åå°äºæ³¨åä¸­å¿ï¼è¿å°±å¯¼è´å¨åç»­å è½½æ²¡æå®æçæåµä¸æå¡æä¾æ¹çå°åå°±è¢«æå¡è°ç¨æ¹æç¥å°äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦å¨åºç¨å¯å¨å è½½ãè§£æ Bean çæ¶åï¼å¦æéå°äº RPC æå¡ç Beanï¼åªåæè¿ä¸ª Bean æ³¨åå° Spring-BeanFactory éé¢å»ï¼èå¹¶ä¸æè¿ä¸ª Bean å¯¹åºçæ¥å£æ³¨åå°æ³¨åä¸­å¿ï¼åªæç­åºç¨å¯å¨å®æåï¼æææ¥å£æ³¨åå°æ³¨åä¸­å¿ç¨äºæå¡åç°ï¼ä»èå®ç°è®©æå¡è°ç¨æ¹å»¶è¿è·åå°æå¡æä¾æ¹å°åã\n\nå·ä½å¦ä½å®ç°å¢ï¼\n\næä»¬å¯ä»¥å¨æå¡æä¾æ¹åºç¨å¯å¨åï¼æ¥å£æ³¨åå°æ³¨åä¸­å¿åï¼é¢çä¸ä¸ª Hook è¿ç¨ï¼è®©ç¨æ·å¯ä»¥å®ç°å¯æ©å±ç Hook é»è¾ãç¨æ·å¯ä»¥å¨ Hook éé¢æ¨¡æè°ç¨é»è¾ï¼ä»èä½¿ JVM æä»¤è½å¤é¢ç­èµ·æ¥ï¼å¹¶ä¸ç¨æ·ä¹å¯ä»¥å¨ Hook éé¢äºåé¢å è½½ä¸äºèµæºï¼åªæç­ææçèµæºé½å è½½å®æåï¼æåæææ¥å£æ³¨åå°æ³¨åä¸­å¿ã\n\n\n\n\n# 11. éæµçæ­\n\néæµç®æ³æå¾å¤ï¼æ¯å¦æç®åçè®¡æ°å¨ï¼è¿æå¯ä»¥åå°å¹³æ»éæµçæ»å¨çªå£ãæ¼æç®æ³ä»¥åä»¤çæ¡¶ç®æ³ç­ç­ãå¶ä¸­ä»¤çæ¡¶ç®æ³æä¸ºå¸¸ç¨ã\n\næå¡ç«¯ä¸»è¦æ¯éè¿éæµæ¥è¿è¡èªæä¿æ¤ï¼æä»¬å¨å®ç°éæµæ¶è¦èèå°åºç¨å IP çº§å«ï¼æ¹ä¾¿æä»¬å¨æå¡æ²»ççæ¶åï¼å¯¹é¨åè®¿é®éç¹å«å¤§çåºç¨è¿è¡åççéæµã\n\næå¡ç«¯çéæµéå¼éç½®é½æ¯ä½ç¨äºåæºçï¼èå¨æäºåºæ¯ä¸ï¼ä¾å¦å¯¹æ´ä¸ªæå¡è®¾ç½®éæµéå¼ï¼æå¡è¿è¡æ©å®¹æ¶ï¼ éæµçéç½®å¹¶ä¸æ¹ä¾¿ï¼æä»¬å¯ä»¥å¨æ³¨åä¸­å¿æéç½®ä¸­å¿ä¸åéæµéå¼éç½®çæ¶åï¼å°æ»æå¡èç¹æ°ä¹ä¸åç»æå¡èç¹ï¼è®© RPC æ¡æ¶èªå·±å»è®¡ç®éæµéå¼ã\n\næä»¬è¿å¯ä»¥è®© RPC æ¡æ¶çéæµæ¨¡åä¾èµä¸ä¸ªä¸é¨çéæµæå¡ï¼å¯¹æå¡è®¾ç½®éæµéå¼è¿è¡ç²¾åå°æ§å¶ï¼ä½æ¯è¿ç§æ¹å¼ä¾èµäºéæµæå¡ï¼ç¸æ¯åæºçéæµæ¹å¼ï¼å¨æ§è½åèæ¶ä¸æå£å¿ã\n\nè°ç¨ç«¯å¯ä»¥éè¿çæ­æºå¶è¿è¡èªæä¿æ¤ï¼é²æ­¢è°ç¨ä¸æ¸¸æå¡åºç°å¼å¸¸ï¼æèèæ¶è¿é¿å½±åè° ç¨ç«¯çä¸å¡é»è¾ï¼RPC æ¡æ¶å¯ä»¥å¨å¨æä»£ççé»è¾ä¸­å»æ´åçæ­å¨ï¼å®ç° RPC æ¡æ¶ççæ­ åè½ã\n\n\n# 12. ä¸å¡åç»\n\n\n\nå¨ RPC éé¢æä»¬å¯ä»¥éè¿åç»çæ¹å¼äººä¸ºå°ç»ä¸åçè°ç¨æ¹åååºä¸åçå°éç¾¤ï¼ä»èå®ç°è°ç¨æ¹æµééç¦»çææï¼ä¿éæä»¬çæ ¸å¿ä¸å¡ä¸åéæ ¸å¿ä¸å¡çå¹²æ°ãä½æä»¬å¨èèé®é¢çæ¶åï¼ä¸è½é¡¾æ­¤å¤±å½¼ï¼ä¸è½å ä¸ºæ°å ä¸ä¸ªçåè½èå½±åå°åæç³»ç»çç¨³å®æ§ã\n\nå¶å®æä»¬ä¸ä»å¯ä»¥éè¿åç»ææå¡æä¾æ¹ååæä¸åè§æ¨¡çå°éç¾¤ï¼æä»¬è¿å¯ä»¥å©ç¨åç»å®æä¸ä¸ªæ¥å£å¤ç§å®ç°çåè½ãæ­£å¸¸æåµä¸ï¼ä¸ºäºæ¹ä¾¿æä»¬èªå·±ç®¡çæå¡ï¼æä¸è¬é½ä¼å»ºè®®æ¯ä¸ªæ¥å£å®æçåè½å°½éä¿è¯å¯ä¸ãä½å¨æäºç¹æ®åºæ¯ä¸ï¼ä¸¤ä¸ªæ¥å£ä¹ä¼å®å¨ä¸æ ·ï¼åªæ¯å·ä½å®ç°ä¸æé£ä¹ä¸ç¹ä¸åï¼é£ä¹æä»¬å°±å¯ä»¥å¨æå¡æä¾æ¹åºç¨éé¢åæ¶æ´é²ä¸¤ä¸ªç¸åæ¥å£ï¼ä½åªæ¯æ¥å£åç»ä¸ä¸æ ·ç½¢äºã\n\n\n# 12.1. å¨æåç»\n\nåç»å¯ä»¥å¸®å©æå¡æä¾æ¹å®ç°è°ç¨æ¹çéç¦»ãä½æ¯å ä¸ºè°ç¨æ¹æµéå¹¶ä¸æ¯ä¸æä¸åçï¼èä¸è¿å¯è½ä¼å ä¸ºçªåäºä»¶å¯¼è´æä¸ªåç»çæµéæº¢åºï¼èå¨æ´ä¸ªå¤§éç¾¤è¿æå¯ä½è½åçæ¶åï¼åå ä¸ºåç»éç¦»ä¸è½ä¸ºåºé®é¢çéç¾¤æä¾å¸®å©ã\n\nä¸ºäºè§£å³è¿ç§çªåæµéçé®é¢ï¼æä»¬æä¾äºä¸ç§æ´é«æçæ¹æ¡ï¼å¯ä»¥å®ç°åç»çå¿«éä¼¸ç¼©ãäºå®ä¸æä»¬è¿å¯ä»¥å©ç¨å¨æåç»è§£å³åç»åç»æ¯ä¸ªåç»é¢çæºå¨åä½çé®é¢ï¼æä»¬æ²¡æå¿è¦æææåä½çæºå¨é½åéå°åç»éé¢ï¼æä»¬å¯ä»¥æè¿äºé¢ççæºå¨åæä¸ä¸ªå±äº«çæ± å­ï¼ä»èåå°æ´ä½é¢ççå®ä¾æ°éã\n\n\n# 13. é¾è·¯è·è¸ª\n\nåå¸å¼é¾è·¯è·è¸ªå°±æ¯å°ä¸æ¬¡åå¸å¼è¯·æ±è¿åä¸ºä¸ä¸ªå®æ´çè°ç¨é¾è·¯ï¼æä»¬å¯ä»¥å¨æ´ä¸ªè°ç¨é¾è·¯ä¸­è·è¸ªå°è¿ä¸æ¬¡åå¸å¼è¯·æ±çæ¯ä¸ä¸ªç¯èçè°ç¨æåµï¼æ¯å¦è°ç¨æ¯å¦æåï¼è¿åä»ä¹å¼å¸¸ï¼è°ç¨çåªä¸ªæå¡èç¹ä»¥åè¯·æ±èæ¶ç­ç­ã\n\nTrace å°±æ¯ä»£è¡¨æ´ä¸ªé¾è·¯ï¼æ¯æ¬¡åå¸å¼é½ä¼äº§çä¸ä¸ª Traceï¼æ¯ä¸ª Trace é½æå®çå¯ä¸æ è¯å³ TraceIdï¼å¨åå¸å¼é¾è·¯è·è¸ªç³»ç»ä¸­ï¼å°±æ¯éè¿ TraceId æ¥åºåæ¯ä¸ª Trace çã Span å°±æ¯ä»£è¡¨äºæ´ä¸ªé¾è·¯ä¸­çä¸æ®µé¾è·¯ï¼ä¹å°±æ¯è¯´ Trace æ¯ç±å¤ä¸ª Span ç»æçãå¨ä¸ä¸ª Trace ä¸ï¼æ¯ä¸ª Span ä¹é½æå®çå¯ä¸æ è¯ SpanIdï¼è Span æ¯å­å¨ç¶å­å³ç³»çãè¿æ¯ä»¥è®²è¿çä¾å­ä¸ºä¾å­ï¼å¨ A->B->C->D çæåµä¸ï¼å¨æ´ä¸ªè°ç¨é¾ä¸­ï¼æ­£å¸¸æåµä¸ä¼äº§ç 3 ä¸ª Spanï¼åå«æ¯ Span1ï¼A->Bï¼ãSpan2ï¼B->Cï¼ãSpan3ï¼C->Dï¼ï¼è¿æ¶ Span3 çç¶ Span å°±æ¯ Span2ï¼è Span2 çç¶ Span å°±æ¯ Span1ã\n\nRPC å¨æ´ååå¸å¼é¾è·¯è·è¸ªéè¦åçææ ¸å¿çä¸¤ä»¶äºå°±æ¯âåç¹âåâä¼ éâã\n\næä»¬åé¢è¯´æ¯å ä¸ºåå­åºç¨ãå­æå¡é´å¤æçä¾èµå³ç³»ï¼æä»¥éè¿æ¥å¿é¾å®ä½é®é¢ãé£æä»¬å°±æ³åæ³éè¿æ¥å¿å®ä½å°æ¯åªä¸ªå­åºç¨çå­æå¡åºç°é®é¢å°±è¡äºã\n\nå¶å®ï¼å¨ RPC æ¡æ¶æå°çå¼å¸¸ä¿¡æ¯ä¸­ï¼æ¯åæ¬å®ä½å¼å¸¸æéè¦çå¼å¸¸ä¿¡æ¯çï¼æ¯å¦æ¯åªç±»å¼å¸¸å¼èµ·çé®é¢ï¼å¦åºååé®é¢æç½ç»è¶æ¶é®é¢ï¼ï¼æ¯è°ç¨ç«¯è¿æ¯æå¡ç«¯åºç°çå¼å¸¸ï¼è°ç¨ç«¯ä¸æå¡ç«¯ç IP æ¯ä»ä¹ï¼ä»¥åæå¡æ¥å£ä¸æå¡åç»é½æ¯ä»ä¹ç­ç­ãå·ä½å¦ä¸å¾æç¤ºï¼\n\n\n\n\n# 14. æ³åè°ç¨\n\nå¨ä¸äºç¹å®åºæ¯ä¸ï¼éè¦å¨æ²¡ææ¥å£çæåµä¸è¿è¡ RPC è°ç¨ãä¾å¦ï¼\n\nåºæ¯ä¸ï¼æ­å»ºä¸ä¸ªç»ä¸çæµè¯å¹³å°ï¼å¯ä»¥è®©åä¸ªä¸å¡æ¹å¨æµè¯å¹³å°ä¸­éè¿è¾å¥æ¥å£ãåç»åãæ¹æ³åä»¥ååæ°å¼ï¼å¨çº¿æµè¯èªå·±åå¸ç RPC æå¡ã\n\n\n\nåºæ¯äºï¼æ­å»ºä¸ä¸ªè½»éçº§çæå¡ç½å³ï¼å¯ä»¥è®©åä¸ªä¸å¡æ¹ç¨ HTTP çæ¹å¼ï¼éè¿æå¡ç½å³è°ç¨å¶å®æå¡ã\n\n\n\nä¸ºäºè§£å³è¿äºåºæ¯çé®é¢ï¼å¯ä»¥ä½¿ç¨æ³åè°ç¨ã\n\nå°±æ¯ RPC æ¡æ¶æä¾ç»ä¸çæ³åè°ç¨æ¥å£ï¼GenericServiceï¼ï¼è°ç¨ç«¯å¨åå»º GenericService ä»£çæ¶æå®çæ­£éè¦è°ç¨çæ¥å£çæ¥å£åä»¥ååç»åï¼éè¿è°ç¨ GenericService ä»£çç $invoke æ¹æ³å°æå¡ç«¯æéè¦çææä¿¡æ¯ï¼åæ¬æ¥å£åãä¸å¡åç»åãæ¹æ³åä»¥ååæ°ä¿¡æ¯ç­å°è£æè¯·æ±æ¶æ¯ï¼åéç»æå¡ç«¯ï¼å®ç°å¨æ²¡ææ¥å£çæåµä¸è¿è¡ RPC è°ç¨çåè½ã\n\nclass GenericService {\nObject $invoke(String methodName, String[] paramTypes, Object[] params);\nCompletableFuture<Object> $asyncInvoke(String methodName, String[] paramTypes\n}\n\n\nèéè¿æ³åè°ç¨çæ¹å¼åèµ·è°ç¨ï¼ç±äºè°ç¨ç«¯æ²¡ææå¡ç«¯æä¾æ¹æä¾çæ¥å£ APIï¼ä¸è½æ­£å¸¸å°è¿è¡åºååä¸ååºååï¼æä»¬å¯ä»¥ä¸ºæ³åè°ç¨æä¾ä¸å±çåºååæä»¶ï¼æ¥è§£å³å®éé®é¢ã\n\n\n# 15. æ¶éè½®\n\næ¶éè½®è¿ä¸ªæºå¶å¾å¥½å°è§£å³äºå®æ¶ä»»å¡ä¸­ï¼å æ¯ä¸ªä»»å¡é½åå»ºä¸ä¸ªçº¿ç¨ï¼å¯¼è´çåå»ºè¿å¤çº¿ç¨çé®é¢ï¼ä»¥åä¸ä¸ªçº¿ç¨æ«æææçå®æ¶ä»»å¡ï¼è®© CPU åäºå¾å¤é¢å¤çè½®è¯¢éåæä½èæµªè´¹ CPU çé®é¢ã\n\næ¶éè½®çå®ç°æºå¶å°±æ¯æ¨¡æç°å®çæ´»ä¸­çæ¶éï¼å°æ¯ä¸ªå®æ¶ä»»å¡æ¾å°å¯¹åºçæ¶é´æ§½ä½ä¸ï¼è¿æ ·å¯ä»¥åå°æ«æä»»å¡æ¶å¯¹å¶å®æ¶é´æ§½ä½å®æ¶ä»»å¡çé¢å¤éåæä½ã\n\nå¨æ¶é´è½®çä½¿ç¨ä¸­ï¼æäºé®é¢éè¦ä½ é¢å¤æ³¨æï¼\n\næ¶é´æ§½ä½çåä½æ¶é´è¶ç­ï¼æ¶é´è½®è§¦åä»»å¡çæ¶é´å°±è¶ç²¾ç¡®ãä¾å¦æ¶é´æ§½ä½çåä½æ¶é´æ¯ 10 æ¯«ç§ï¼é£ä¹æ§è¡å®æ¶ä»»å¡çæ¶é´è¯¯å·®å°±å¨ 10 æ¯«ç§åï¼å¦ææ¯ 100 æ¯«ç§ï¼é£ä¹è¯¯å·®å°±å¨ 100 æ¯«ç§åã\n\næ¶é´è½®çæ§½ä½è¶å¤ï¼é£ä¹ä¸ä¸ªä»»å¡è¢«éå¤æ«æçæ¦çå°±è¶å°ï¼å ä¸ºåªæå¨å¤å±æ¶éè½®ä¸­çä»»å¡æä¼è¢«éå¤æ«æãæ¯å¦ä¸ä¸ªæ¶é´è½®çæ§½ä½æ 1000 ä¸ªï¼ä¸ä¸ªæ§½ä½çåä½æ¶é´æ¯ 10 æ¯«ç§ï¼é£ä¹ä¸ä¸å±æ¶é´è½®çä¸ä¸ªæ§½ä½çåä½æ¶é´å°±æ¯ 10 ç§ï¼è¶è¿ 10 ç§çå®æ¶ä»»å¡ä¼è¢«æ¾å°ä¸ä¸å±æ¶é´è½®ä¸­ï¼ä¹å°±æ¯åªæè¶è¿ 10 ç§çå®æ¶ä»»å¡ä¼è¢«æ«æéåä¸¤æ¬¡ï¼ä½å¦ææ§½ä½æ¯ 10 ä¸ªï¼é£ä¹è¶è¿ 100 æ¯«ç§çä»»å¡ï¼å°±ä¼è¢«æ«æéåä¸¤æ¬¡ã\n\nç»åè¿äºç¹ç¹ï¼æä»¬å°±å¯ä»¥è§å·ä½çä¸å¡åºæ¯èå®ï¼å¯¹æ¶éè½®çå¨æåæ¶é´æ§½æ°è¿è¡è®¾ç½®ã\n\nå¨ RPC æ¡æ¶ä¸­ï¼åªè¦æ¶åå°å®æ¶ä»»å¡ï¼æä»¬é½å¯ä»¥åºç¨æ¶éè½®ï¼æ¯è¾å¸åçå°±æ¯è°ç¨ç«¯çè¶æ¶å¤çãè°ç¨ç«¯ä¸æå¡ç«¯çå¯å¨è¶æ¶ä»¥åå®æ¶å¿è·³ç­ç­ã\n\n\n# 16. æµéåæ¾\n\næè°çæµéå°±æ¯æä¸ªæ¶é´æ®µåçææè¯·æ±ï¼æä»¬éè¿æç§ææ®µæåéå° A åºç¨çææè¯·æ±å½å¶ä¸æ¥ï¼ç¶åæè¿äºè¯·æ±ç»ä¸è½¬åå° B åºç¨ï¼è®© B åºç¨æ¥æ¶å°çè¯·æ±åæ°è· A åºç¨ä¿æä¸è´ï¼ä»èå®ç° A æ¥æ¶å°çè¯·æ±å¨ B åºç¨éé¢éæ°è¯·æ±äºä¸éãæ´ä¸ªè¿ç¨ç§°ä¹ä¸ºâæµéåæ¾âã\n\næµéåæ¾å¯ä»¥åä»ä¹ï¼\n\nä¸ºäºä¿éåºç¨åçº§åï¼æä»¬çä¸å¡è¡ä¸ºè¿è½ä¿æååçº§åä¸æ ·ï¼æä»¬å¨å¤§å¤æ°æåµä¸é½æ¯ä¾é å·²æç TestCase å»éªè¯ï¼ä½è¿ç§æ¹å¼å¨ä¸å®ç¨åº¦ä¸å¹¶ä¸æ¯å®å¨å¯é çãæå¯é çæ¹å¼å°±æ¯å¼å¥çº¿ä¸ Case å»éªè¯æ¹é åçåºç¨ï¼æçº¿ä¸ççå®æµéå¨æ¹é åçåºç¨éé¢è¿è¡åæ¾ï¼è¿æ ·ä¸ä»èçæ´ä¸ªä¸çº¿æ¶é´ï¼è¿è½å¼¥è¡¥æå¨ç»´æ¤ Case å­å¨çç¼ºé·ã\n\nåºç¨å¼å¥äº RPC åï¼ææçè¯·æ±æµéé½ä¼è¢« RPC æ¥ç®¡ï¼æä»¥æä»¬å¯ä»¥å¾èªç¶å°å¨ RPC éé¢æ¯ææµéåæ¾åè½ãè½ç¶è¿ä¸ªåè½æ¬èº«å¹¶ä¸æ¯ RPC çæ ¸å¿åè½ï¼ä½å¯¹äºä½¿ç¨ RPC çäººæ¥è¯´ï¼ä»ä»¬æäºè¿ä¸ªåè½ä¹åï¼å°±å¯ä»¥æ´æ¾å¿å°åçº§èªå·±çåºç¨äºã\n\n\n# 17. RPC é«çº§\n\n\n# 17.1. RPC æ§è½\n\nå¦ä½æååæºååéï¼\n\nå¤§å¤æ°æåµä¸ï¼å½±åå° RPC è°ç¨çååéçåå ä¹å°±æ¯ä¸å¡é»è¾å¤çæ¢äºï¼CPU å¤§é¨åæ¶é´é½å¨ç­å¾èµæºã\n\nä¸ºäºè§£å³ç­å¾çèæ¶ï¼å¯ä»¥ä½¿ç¨å¼æ­¥ãå¼æ­¥å¯ä»¥ä½¿ç¨ Future æ Callback æ¹å¼ï¼Future æä¸ºç®åã\n\n\n\nå¦å¤ï¼æä»¬å¯ä»¥éè¿å¯¹ CompletableFuture çæ¯æï¼å®ç° RPC è°ç¨å¨è°ç¨ç«¯ä¸æå¡ç«¯ä¹é´çå®å¨å¼æ­¥ï¼åæ¶æåä¸¤ç«¯çåæºååéã\n\n\n# 17.2. RPC å®å¨\n\nè½ç¶ RPC ç»å¸¸ç¨äºè§£å³åç½åºç¨ä¹é´çè°ç¨ï¼åç½ç¯å¢ç¸å¯¹å¬ç½ä¹æ²¡æé£ä¹æ¶å£ï¼ä½æä»¬ä¹æå¿è¦å»å»ºç«ä¸å¥å¯æ§çå®å¨ä½ç³»ï¼å»é²æ­¢ä¸äºéè¯¯è¡ä¸ºãå¯¹äº RPC æ¥è¯´ï¼æä»¬æå³å¿çå®å¨é®é¢ä¸ä¼æå¬ç½åºç¨é£ä¹å¤æï¼æä»¬åªè¦ä¿è¯è®©æå¡è°ç¨æ¹è½æ¿å°çå®çæå¡æä¾æ¹ IP å°åéåï¼ä¸æå¡æä¾æ¹å¯ä»¥ç®¡æ§è°ç¨èªå·±çåºç¨å°±å¤äºã\n\næå¡æä¾æ¹åºç¨éé¢æ¾ä¸ä¸ªç¨äº HMAC ç­¾åçç§é¥ï¼å¨ææå¹³å°ä¸ç¨è¿ä¸ªç§é¥ä¸ºç³è¯·è°ç¨çè°ç¨æ¹åºç¨è¿è¡ç­¾åï¼è¿ä¸ªç­¾åçæçä¸²å°±åæäºè°ç¨æ¹å¯ä¸çèº«ä»½ãæå¡æä¾æ¹å¨æ¶å°è°ç¨æ¹çææè¯·æ±ä¹åï¼æä»¬åªè¦éè¦éªè¯ä¸è¿ä¸ªç­¾åè·è°ç¨æ¹åºç¨ä¿¡æ¯æ¯å¦å¯¹åºå¾ä¸å°±è¡äºï¼è¿æ ·éä¸­å¼ææçç¶é¢ä¹å°±ä¸å­å¨äºã\n\n\n# 18. åèèµæ\n\n * ãRPC å®æä¸æ ¸å¿åçã",normalizedContent:"# rpc åºæ¬åç\n\n\n# 1. rpc ç®ä»\n\n\n# 1.1. ä»ä¹æ¯ rpc\n\nrpc çå¨ç§°æ¯ remote procedure callï¼å³è¿ç¨è¿ç¨è°ç¨ã\n\nrpc çä¸»è¦ä½ç¨æ¯ï¼\n\n * å±è½è¿ç¨è°ç¨è·æ¬å°è°ç¨çåºå«ã\n * éèåºå±ç½ç»éä¿¡çå¤ææ§ã\n\n\n# 1.2. rpc éä¿¡\n\nè¿ç¨è°ç¨è¯´æäºï¼rpc éè¦éä¿¡ï¼é£ä¹ rpc çéä¿¡è¿ç¨æ¯ææ ·çå¢ï¼\n\nrpc å¸¸ç¨äºä¸å¡ç³»ç»ä¹é´çæ°æ®äº¤äºï¼éè¦ä¿è¯å¶å¯é æ§ï¼æä»¥ rpc ä¸è¬é»è®¤éç¨ tcp æ¥ä¼ è¾ã\n\nç½ç»ä¼ è¾çæ°æ®å¿é¡»æ¯äºè¿å¶æ°æ®ï¼ä½è°ç¨æ¹è¯·æ±çåºå¥åæ°é½æ¯å¯¹è±¡ï¼æä»¥å¿é¡»è¦å°å¶è½¬æ¢ï¼è¿ä¸ªè¿ç¨å«åºååã\n\n\n\n * rpc æ¦æªè°ç¨æ¹è¦æ§è¡çè¿ç¨æ¹æ³ï¼å°æ¹æ³åãåæ°ç­åºååä¸ºæ¹ä¾¿å¨ç½ç»ä¸­ä¼ è¾çäºè¿å¶æ json æ°æ®ï¼ç¶åå°è¿äºè¯·æ±ä¿¡æ¯ä¼ ç»æå¡æä¾æ¹ï¼\n * æå¡æä¾æ¹å°è¯·æ±ä¿¡æ¯ååºååä¸ºæ¬å°çæ¹æ³åè¯·æ±åæ°ï¼ç¶åæ§è¡ï¼æåå°æ§è¡ç»æåºååä¸ºäºè¿å¶æ json æ°æ®ï¼åååºç»è°ç¨æ¹ã\n * è°ç¨æ¹å°åºç­æ°æ®ååºååã\n\n\n# 1.3. rpc åè®®\n\næ¢ç¶æäºç°æç http åè®®ï¼è¿æå¿è¦è®¾è®¡ rpc åè®®åï¼\n\næå¿è¦ãå ä¸º http è¿äºéä¿¡æ ååè®®ï¼æ°æ®åä¸­çå®éè¯·æ±æ°æ®ç¸å¯¹äºæ°æ®åæ¬èº«è¦å°å¾å¤ï¼æå¾å¤æ ç¨çåå®¹ï¼å¹¶ä¸ http å±äºæ ç¶æåè®®ï¼æ æ³å°è¯·æ±åååºå³èï¼æ¯æ¬¡è¯·æ±è¦éæ°å»ºç«è¿æ¥ãè¿å¯¹äºé«æ§è½ç rpc æ¥è¯´ï¼http åè®®é¾ä»¥æ»¡è¶³éæ±ï¼æä»¥æå¿è¦è®¾è®¡ä¸ä¸ªç´§åçç§æåè®®ã\n\n\n\n\n# 2. åºåå\n\n> åºååå¯ä»¥å°å¯¹è±¡çå­èåºåæä¹åââä¿å­å¨åå­ãæä»¶ãæ°æ®åºä¸­ã\n\nåºååæ¯ rpc çè¦ç¹ä¹ä¸ã\n\n\n\n\n# 2.1. å¸¸è§åºååæ¹å¼\n\n# 2.1.1. jdk åºåå\n\n> æå´è¶£æ·±å¥äºè§£ jdk åºååæ¹å¼ï¼å¯ä»¥åèï¼æ·±å¥çè§£ java åºåå\n\n# 2.1.2. json\n\njacksonãgsonãfastjson - éç¨äºå¯¹åºåååçæ°æ®è¦æ±æè¯å¥½çå¯è¯»æ§ï¼è½¬ä¸º json ãxml å½¢å¼ï¼ã\n\n# 2.1.3. hessian\n\nhessian - éç¨äºå¯¹å¼åä½éªææï¼æ§è½æè¦æ±çåå¤é¨ç³»ç»ã\n\nä½ hessian æ¬èº«ä¹æé®é¢ï¼å®æ¹çæ¬å¯¹ java éé¢ä¸äºå¸¸è§å¯¹è±¡çç±»åä¸æ¯æï¼æ¯å¦ï¼\n\n * linked ç³»åï¼linkedhashmapãlinkedhashset ç­ï¼ä½æ¯å¯ä»¥éè¿æ©å± collectiondeserializer ç±»ä¿®å¤ï¼\n * locale ç±»ï¼å¯ä»¥éè¿æ©å± contextserializerfactory ç±»ä¿®å¤ï¼\n * byte/short ååºååçæ¶ååæ integerã\n\n# 2.1.4. thrift / protobuf\n\nthriftãprotobuf - éç¨äºå¯¹æ§è½ææï¼å¯¹å¼åä½éªè¦æ±ä¸é«çåé¨ç³»ç»ã\n\nåæ¬¡ä»¥å¤ï¼è¿æå¾å¤å¶ä»çåºååæ¹æ¡ãé£ä¹ï¼rpc çåºååæ¹å¼å¦ä½éæ©å¢ï¼\n\n\n\nç»¼åä»¥ä¸ï¼java rpc æ¡æ¶ä¸­åºååæ¹å¼ï¼ä¸è¬é¦é protobuf å hessianï¼äºèå¨æ§è½ãéç¨æ§ãå®å¨æ§ãå¼å®¹æ§ãç©ºé´å¼éä¸é½è¡¨ç°ä¸éãå¶ä¸­ï¼protobuf æ§è½ãéç¨æ§æ´å¥½ï¼è hessian å¨å¼åä½éªä¸æ´ä¸ºä¾¿æ·ã\n\n\n# 2.2. åºååé®é¢\n\njava å¯¹è±¡åºååï¼ä¸è¬è¦å³æ³¨ä»¥ä¸é®é¢ï¼\n\nå¸¸è§æ§é®é¢ï¼\n\n * å½ç¶ç±»ç»§æ¿ serializable æ¥å£æ¶ï¼ææå­ç±»é½å¯ä»¥è¢«åºååã\n * å­ç±»å®ç°äº serializable æ¥å£ï¼ç¶ç±»æ²¡æï¼åç¶ç±»çå±æ§ä¸ä¼è¢«åºååï¼ä¸æ¥éï¼æ°æ®ä¸¢å¤±ï¼ï¼å­ç±»çå±æ§ä»å¯ä»¥æ­£ç¡®åºååã\n * å¦æåºååçå±æ§æ¯å¯¹è±¡ï¼åè¿ä¸ªå¯¹è±¡ä¹å¿é¡»å®ç° serializable æ¥å£ï¼å¦åä¼æ¥éã\n * å¨ååºååæ¶ï¼å¦æå¯¹è±¡çå±æ§æä¿®æ¹æå åï¼åä¿®æ¹çé¨åå±æ§ä¼ä¸¢å¤±ï¼ä½ä¸ä¼æ¥éã\n * å¨ååºååæ¶ï¼å¦æ serialversionuid è¢«ä¿®æ¹ï¼åååºååæ¶ä¼å¤±è´¥ã\n\nè®¾è®¡é®é¢ï¼\n\n * å¯¹è±¡è¿äºå¤æãåºå¤§ - å¯¹è±¡è¿äºå¤æãåºå¤§ï¼ä¼éä½åºååãååºååçæçï¼å¹¶å¢å ä¼ è¾å¼éï¼ä»èå¯¼è´ååºæ¶å»¶å¢å¤§ã\n * å¯¹è±¡æå¤æçç»§æ¿å³ç³» - å¯¹è±¡å³ç³»è¶å¤æï¼å°±è¶æµªè´¹æ§è½ï¼åæ¶åå¾å®¹æåºç°åºååä¸çé®é¢ã\n * ä½¿ç¨åºååæ¡æ¶ä¸æ¯æçç±»ä½ä¸ºå¥åç±» - æ¯å¦ hessian æ¡æ¶ï¼ä»å¤©ç¶æ¯ä¸æ¯æ linkhashmapãlinkedhashset ç­ï¼èä¸å¤§å¤æ°æåµä¸æå¥½ä¸è¦ä½¿ç¨ç¬¬ä¸æ¹éåç±»ï¼å¦ guava ä¸­çéåç±»ï¼å¾å¤å¼æºçåºååæ¡æ¶é½æ¯ä¼åæ¯æç¼ç¨è¯­è¨åççå¯¹è±¡ãå æ­¤å¦æå¥åæ¯éåç±»ï¼åºå°½ééç¨åççãæä¸ºå¸¸ç¨çéåç±»ï¼å¦ hashmapãarraylistã\n\n\n# 3. åå°+å¨æä»£ç\n\nrpc çè¿ç¨è¿ç¨è°ç¨æ¶éè¿åå°+å¨æä»£çå®ç°çã\n\n\n\nrpc æ¡æ¶ä¼èªå¨ä¸ºè¦è°ç¨çæ¥å£çæä¸ä¸ªä»£çç±»ãå½å¨é¡¹ç®ä¸­æ³¨å¥æ¥å£çæ¶åï¼è¿è¡è¿ç¨ä¸­å®éç»å®çå°±æ¯è¿ä¸ªæ¥å£çæçä»£çç±»ãå¨æ¥å£æ¹æ³è¢«è°ç¨æ¶ï¼ä¼è¢«ä»£çç±»æ¦æªï¼è¿æ ·ï¼å°±å¯ä»¥å¨çæçä»£çç±»ä¸­ï¼å å¥è¿ç¨è°ç¨é»è¾ã\n\né¤äº jdk é»è®¤ç invocationhandler è½å®æä»£çåè½ï¼è¿æå¾å¤å¶ä»çç¬¬ä¸æ¹æ¡æ¶ä¹å¯ä»¥ï¼æ¯å¦å javassistãbyte buddy è¿æ ·çæ¡æ¶ã\n\n> åå°+å¨æä»£çæ´å¤è¯¦æå¯ä»¥åèï¼æ·±å¥çè§£ java åå°åå¨æä»£ç\n\n\n# 4. ç½ç»éä¿¡\n\nä¸æ¬¡ rpc è°ç¨ï¼æ¬è´¨å°±æ¯æå¡æ¶è´¹èä¸æå¡æä¾èé´çä¸æ¬¡ç½ç»ä¿¡æ¯äº¤æ¢çè¿ç¨ãå¯è§ï¼éä¿¡æ¶ rpc å®ç°çæ ¸å¿ã\n\nå¸¸è§çç½ç» io æ¨¡åæï¼åæ­¥é»å¡ï¼bioï¼ãåæ­¥éé»å¡ï¼nioï¼ãå¼æ­¥éé»å¡ï¼aioï¼ã\n\n\n# 4.1. io å¤è·¯å¤ç¨\n\nio å¤è·¯å¤ç¨ï¼reactor æ¨¡å¼ï¼å¨é«å¹¶ååºæ¯ä¸ä½¿ç¨æä¸ºå¹¿æ³ï¼å¾å¤ç¥åè½¯ä»¶é½åºç¨äºè¿ä¸ææ¯ï¼å¦ï¼nettyãredisãnginx ç­ã\n\nio å¤è·¯å¤ç¨åä¸º selectï¼poll å epollã\n\nä»ä¹æ¯ io å¤è·¯å¤ç¨ï¼å­é¢ä¸ççè§£ï¼å¤è·¯å°±æ¯æå¤ä¸ªééï¼ä¹å°±æ¯å¤ä¸ªç½ç»è¿æ¥ç ioï¼èå¤ç¨å°±æ¯æå¤ä¸ªééå¤ç¨å¨ä¸ä¸ªå¤ç¨å¨ä¸ã\n\n\n# 4.2. é¶æ·è´\n\nç³»ç»åæ ¸å¤ç io æä½åä¸ºä¸¤ä¸ªé¶æ®µââç­å¾æ°æ®åæ·è´æ°æ®ãç­å¾æ°æ®ï¼å°±æ¯ç³»ç»åæ ¸å¨ç­å¾ç½å¡æ¥æ¶å°æ°æ®åï¼ææ°æ®åå°åæ ¸ä¸­ï¼èæ·è´æ°æ®ï¼å°±æ¯ç³»ç»åæ ¸å¨è·åå°æ°æ®åï¼å°æ°æ®æ·è´å°ç¨æ·è¿ç¨çç©ºé´ä¸­ã\n\n\n\nåºç¨è¿ç¨çæ¯ä¸æ¬¡åæä½ï¼é½ä¼ææ°æ®åå°ç¨æ·ç©ºé´çç¼å²åºä¸­ï¼åç± cpu å°æ°æ®æ·è´å°ç³»ç»åæ ¸çç¼å²åºä¸­ï¼ä¹ååç± dma å°è¿ä»½æ°æ®æ·è´å°ç½å¡ä¸­ï¼æåç±ç½å¡åéåºå»ãè¿éæä»¬å¯ä»¥çå°ï¼ä¸æ¬¡åæä½æ°æ®è¦æ·è´ä¸¤æ¬¡æè½éè¿ç½å¡åéåºå»ï¼èç¨æ·è¿ç¨çè¯»æä½åæ¯å°æ´ä¸ªæµç¨åè¿æ¥ï¼æ°æ®åæ ·ä¼æ·è´ä¸¤æ¬¡æè½è®©åºç¨ç¨åºè¯»åå°æ°æ®ã\n\nåºç¨è¿ç¨çä¸æ¬¡å®æ´çè¯»åæä½ï¼é½éè¦å¨ç¨æ·ç©ºé´ä¸åæ ¸ç©ºé´ä¸­æ¥åæ·è´ï¼å¹¶ä¸æ¯ä¸æ¬¡æ·è´ï¼é½éè¦ cpu è¿è¡ä¸æ¬¡ä¸ä¸æåæ¢ï¼ç±ç¨æ·è¿ç¨åæ¢å°ç³»ç»åæ ¸ï¼æç±ç³»ç»åæ ¸åæ¢å°ç¨æ·è¿ç¨ï¼ï¼è¿æ ·å¾æµªè´¹ cpu åæ§è½ã\n\næè°çé¶æ·è´ï¼å°±æ¯åæ¶ç¨æ·ç©ºé´ä¸åæ ¸ç©ºé´ä¹é´çæ°æ®æ·è´æä½ï¼åºç¨è¿ç¨æ¯ä¸æ¬¡çè¯»åæä½ï¼å¯ä»¥éè¿ä¸ç§æ¹å¼ï¼ç´æ¥å°æ°æ®åå¥åæ ¸æä»åæ ¸ä¸­è¯»åæ°æ®ï¼åéè¿ dma å°åæ ¸ä¸­çæ°æ®æ·è´å°ç½å¡ï¼æå°ç½å¡ä¸­çæ°æ® copy å°åæ ¸ã\n\n\n\nnetty çé¶æ·è´ååäºç¨æ·ç©ºé´ä¸­å¯¹æ°æ®æä½çä¼åï¼è¿å¯¹å¤ç tcp ä¼ è¾ä¸­çæåç²åé®é¢æçéè¦çæä¹ï¼å¯¹åºç¨ç¨åºå¤çè¯·æ±æ°æ®ä¸è¿åæ°æ®ä¹æéè¦çæä¹ã\n\nnetty æ¡æ¶ä¸­å¾å¤åé¨ç channelhandler å®ç°ç±»ï¼é½æ¯éè¿ compositebytebufãsliceãwrap æä½æ¥å¤ç tcp ä¼ è¾ä¸­çæåä¸ç²åé®é¢çã\n\nnetty ç bytebuffer å¯ä»¥éç¨ direct buffersï¼ä½¿ç¨å å¤ç´æ¥åå­è¿è¡ socketd çè¯»å æä½ï¼æç»çææä¸æåæè®²è§£çèæåå­æå®ç°çæææ¯ä¸æ ·çã\n\nnetty è¿æä¾ fileregion ä¸­åè£ nio ç filechannel.transferto() æ¹æ³å®ç°äºé¶æ· è´ï¼è¿ä¸ linux ä¸­ç sendfile æ¹å¼å¨åçä¸ä¹æ¯ä¸æ ·çã\n\n\n# 5. rpc æ¶ææ¨¡å\n\näºè§£åé¢çç¥è¯ç¹ï¼åºååãå¨æä»£çãéä¿¡ï¼ï¼å¶å®å·²ç»å¯ä»¥å®ç°ä¸ä¸ªç¹å¯¹ç¹ç rpc æ¶æäºã\n\néç¨å¾®åæ ¸æ¶æç rpc æ¶ææ¨¡åï¼\n\n\n\nå¨ rpc æ¡æ¶éé¢ï¼æä¹æ¯ææä»¶åæ¶æçå¢ï¼æä»¬å¯ä»¥å°æ¯ä¸ªåè½ç¹æ½è±¡æä¸ä¸ªæ¥ å£ï¼å°è¿ä¸ªæ¥å£ä½ä¸ºæä»¶çå¥çº¦ï¼ç¶åæè¿ä¸ªåè½çæ¥å£ä¸åè½çå®ç°åç¦»ï¼å¹¶æä¾æ¥å£çé»è®¤å®ç°ãå¨ java éé¢ï¼jdk æèªå¸¦ç spiï¼service provider interfaceï¼æå¡åç°æº å¶ï¼å®å¯ä»¥å¨æå°ä¸ºæä¸ªæ¥å£å¯»æ¾æå¡å®ç°ãä½¿ç¨ spi æºå¶éè¦å¨ classpath ä¸ç meta-inf/services ç®å½éåå»ºä¸ä¸ªä»¥æå¡æ¥å£å½åçæä»¶ï¼è¿ä¸ªæä»¶éçåå®¹å°±æ¯è¿ä¸ªæ¥å£çå·ä½å®ç°ç±»ã\n\nä½å¨å®éé¡¹ç®ä¸­ï¼æä»¬å¶å®å¾å°ä½¿ç¨å° jdk èªå¸¦ç spi æºå¶ï¼é¦åå®ä¸è½æéå è½½ï¼ serviceloader å è½½æä¸ªæ¥å£å®ç°ç±»çæ¶åï¼ä¼éåå¨é¨è·åï¼ä¹å°±æ¯æ¥å£çå®ç°ç±»å¾å¨é¨è½½å¥å¹¶å®ä¾åä¸éï¼ä¼é æä¸å¿è¦çæµªè´¹ãå¦å¤å°±æ¯æ©å±å¦æä¾èµå¶å®çæ©å±ï¼é£å°±åä¸å°èªå¨æ³¨å¥åè£éï¼è¿å°±å¾é¾åå¶ä»æ¡æ¶éæï¼æ¯å¦æ©å±éé¢ä¾èµäºä¸ä¸ª spring beanï¼åçç java spi å°±ä¸æ¯æã\n\n\n# 6. æå¡æ³¨åååç°\n\nrpc æ¡æ¶å¿é¡»è¦ææå¡æ³¨åååç°æºå¶ï¼è¿æ ·ï¼éç¾¤ä¸­çèç¹æè½ç¥ééä¿¡æ¹çè¯·æ±å°åã\n\n * æå¡æ³¨åï¼å¨æå¡æä¾æ¹å¯å¨çæ¶åï¼å°å¯¹å¤æ´é²çæ¥å£æ³¨åå°æ³¨åä¸­å¿ä¹ä¸­ï¼æ³¨åä¸­å¿å°è¿ä¸ªæå¡èç¹ç ip åæ¥å£ä¿å­ä¸æ¥ã\n * æå¡è®¢éï¼å¨æå¡è°ç¨æ¹å¯å¨çæ¶åï¼å»æ³¨åä¸­å¿æ¥æ¾å¹¶è®¢éæå¡æä¾æ¹ç ipï¼ç¶åç¼å­å°æ¬å°ï¼å¹¶ç¨äºåç»­çè¿ç¨è°ç¨ã\n\n\n# 6.1. åºäº zookeeper çæå¡åç°\n\nä½¿ç¨ zookeeper ä½ä¸ºæå¡æ³¨åä¸­å¿ï¼æ¯ java åå¸å¼ç³»ç»çç»å¸æ¹æ¡ã\n\næ­å»ºä¸ä¸ª zookeeper éç¾¤ä½ä¸ºæ³¨åä¸­å¿éç¾¤ï¼æå¡æ³¨åçæ¶ååªéè¦æå¡èç¹å zookeeper èç¹åå¥æ³¨åä¿¡æ¯å³å¯ï¼å©ç¨ zookeeper ç watcher æºå¶å®ææå¡è®¢éä¸æå¡ä¸ååè½\n\n\n\néå¸¸æä»¬å¯ä»¥ä½¿ç¨ zookeeperãetcd æèåå¸å¼ç¼å­ï¼å¦ hazelcastï¼æ¥è§£å³äºä»¶éç¥é®é¢ï¼ä½å½éç¾¤è¾¾å°ä¸å®è§æ¨¡ä¹åï¼ä¾èµç zookeeper éç¾¤ãetcd éç¾¤å¯è½å°±ä¸ç¨³å®äºï¼æ æ³æ»¡è¶³æä»¬çéæ±ã\n\nå¨è¶å¤§è§æ¨¡çæå¡éç¾¤ä¸ï¼æ³¨åä¸­å¿æé¢ä¸´çææå°±æ¯è¶å¤§æ¹éæå¡èç¹åæ¶ä¸ä¸çº¿ï¼æ³¨åä¸­å¿éç¾¤æ¥åå°å¤§éæå¡åæ´è¯·æ±ï¼éç¾¤é´åèç¹é´éè¦åæ­¥å¤§éæå¡èç¹æ°æ®ï¼æç»å¯¼è´å¦ä¸é®é¢ï¼\n\n * æ³¨åä¸­å¿è´è½½è¿é«ï¼\n * åèç¹æ°æ®ä¸ä¸è´ï¼\n * æå¡ä¸åä¸åæ¶æä¸åéè¯¯çæå¡èç¹åè¡¨ã\n\nrpc æ¡æ¶ä¾èµçæ³¨åä¸­å¿çæå¡æ°æ®çä¸è´æ§å¶å®å¹¶ä¸éè¦æ»¡è¶³ cpï¼åªè¦æ»¡è¶³ ap å³å¯ã\n\n\n# 6.2. åºäºæ¶æ¯æ»çº¿çæç»ä¸è´æ§çæ³¨åä¸­å¿\n\nzookeeper çä¸å¤§ç¹ç¹å°±æ¯å¼ºä¸è´æ§ï¼zookeeper éç¾¤çæ¯ä¸ªèç¹çæ°æ®æ¯æ¬¡åçæ´æ°æä½ï¼é½ä¼éç¥å¶å® zookeeper èç¹åæ¶æ§è¡æ´æ°ãå®è¦æ±ä¿è¯æ¯ä¸ªèç¹çæ°æ®è½å¤å®æ¶çå®å¨ä¸è´ï¼è¿ä¹å°±ç´æ¥å¯¼è´äº zookeeper éç¾¤æ§è½ä¸çä¸éã\n\nè rpc æ¡æ¶çæå¡åç°ï¼å¨æå¡èç¹åä¸çº¿æ¶ï¼æå¡è°ç¨æ¹æ¯å¯ä»¥å®¹å¿å¨ä¸æ®µæ¶é´ä¹å ï¼æ¯å¦å ç§éä¹åï¼åç°è¿ä¸ªæ°ä¸çº¿çèç¹çãæ¯ç«æå¡èç¹åä¸çº¿ä¹åçå ç§åï¼çè³æ´é¿çä¸æ®µæ¶é´åæ²¡ææ¥æ¶å°è¯·æ±æµéï¼å¯¹æ´ä¸ªæå¡éç¾¤æ¯æ²¡æä»ä¹å½±åçï¼æä»¥æä»¬å¯ä»¥çºç²æ cpï¼å¼ºå¶ä¸è´æ§ï¼ï¼èéæ© apï¼æç»ä¸è´ï¼ï¼æ¥æ¢åæ´ä¸ªæ³¨åä¸­å¿éç¾¤çæ§è½åç¨³å®æ§ã\n\n\n\n\n# 7. å¥åº·æ£æ¥\n\nä½¿ç¨é¢çéä¸­çå¿è·³å»æ£æµç®æ æºå¨çå¥åº·ç¶æã\n\n * å¥åº·ç¶æï¼å»ºç«è¿æ¥æåï¼å¹¶ä¸å¿è·³æ¢æ´»ä¹ä¸ç´æåï¼\n * äºå¥åº·ç¶æï¼å»ºç«è¿æ¥æåï¼ä½æ¯å¿è·³è¯·æ±è¿ç»­å¤±è´¥ï¼\n * æ­»äº¡ç¶æï¼å»ºç«è¿æ¥å¤±è´¥ã\n\nå¯ä»¥ä½¿ç¨å¯ç¨çæ¥ä½ä¸ºå¥åº·ç¶æçéåæ åï¼\n\nå¯ç¨ç = ä¸ä¸ªæ¶é´çªå£åæ¥å£è°ç¨æåæ¬¡æ° / æ»è°ç¨æ¬¡æ°\n\n\nå½å¯ç¨çä½äºæä¸ªæ¯ä¾ï¼å°±è®¤ä¸ºè¿ä¸ªèç¹å­å¨é®é¢ï¼æå®æªå°äºå¥åº·åè¡¨ï¼è¿æ ·æ¢èèäºé«ä½é¢çè°ç¨æ¥å£ï¼ä¹å¼é¡¾äºæ¥å£ååºæ¶é´ä¸åçé®é¢ã\n\n\n# 8. è·¯ç±åè´è½½åè¡¡\n\nå¯¹äºæå¡è°ç¨æ¹æ¥è¯´ï¼ä¸ä¸ªæ¥å£ä¼æå¤ä¸ªæå¡æä¾æ¹åæ¶æä¾æå¡ï¼æä»¥æä»¬ç rpc å¨æ¯æ¬¡åèµ·è¯·æ±çæ¶åï¼é½éè¦ä»å¤ä¸ªæå¡æä¾æ¹èç¹éé¢éæ©ä¸ä¸ªç¨äºåè¯·æ±çèç¹ãè¿è¢«ç§°ä¸ºè·¯ç±ç­ç¥ã\n\n * ip è·¯ç±ï¼æç®åçå½ç¶æ¯ ip è·¯ç±ï¼å ä¸ºæå¡ä¸çº¿åï¼ä¼æ´é²æå¡å°æ³¨åä¸­å¿ï¼å°èªèº« ipãç«¯å£ç­åä¿¡æ¯åç¥æ³¨åä¸­å¿ãè¿æ ·æ¶è´¹æ¹å°±å¯ä»¥å¨åæ³¨åä¸­å¿è¯·æ±æå¡å°åæ¶ï¼æç¥å¶å­å¨ã\n * åæ°è·¯ç±ï¼ä½ææ¶ï¼ä¼æä¸äºå¤æçåºæ¯ï¼å¦ï¼ç°åº¦åå¸ãå®ç¹è°ç¨ï¼æä»¬å¹¶ä¸å¸æä¸çº¿çæå¡è¢«æææ¶è´¹èæç¥ï¼ä¸ºäºæ´å ç»ç²åº¦çæ§å¶ï¼å¯ä»¥ä½¿ç¨åæ°è·¯ç±ãéè¿åæ°æ§å¶éä¿¡çè·¯ç±ç­ç¥ã\n\né¤äºç¹æ®åºæ¯çè·¯ç±ç­ç¥ä»¥å¤ï¼å¯¹äºæºå¨ä¸­å¤ä¸ªæå¡æ¹ï¼å¦ä½éæ©è°ç¨åªä¸ªæå¡èç¹ï¼å¯ä»¥åºç¨è´è½½åè¡¡ç­ç¥ãrpc è´è½½åè¡¡ç­ç¥ä¸è¬åæ¬éæºãè½®è¯¢ãä¸è´æ§ hashãæè¿æå°è¿æ¥ç­ã\n\n\n\n> è´è½½åè¡¡è¯¦æå¯ä»¥åèï¼è´è½½åè¡¡åºæ¬åç\n\n\n# 8.1. è¶æ¶éè¯\n\nè¶æ¶éè¯æºå¶æ¯æï¼å½è°ç¨ç«¯åèµ·çè¯·æ±å¤±è´¥æè¶æ¶æªæ¶å°ååºæ¶ï¼rpc æ¡æ¶èªèº«å¯ä»¥è¿è¡éè¯ï¼åéæ°åéè¯·æ±ï¼ç¨æ·å¯ä»¥èªè¡è®¾ç½®æ¯å¦å¼å¯éè¯ä»¥åéè¯çæ¬¡æ°ã\n\n\n\n\n# 8.2. éæµãéçº§ãçæ­\n\néæµæ¹æ¡ï¼redis + luaãsentinel\n\nçæ­æ¹æ¡ï¼hystrix\n\n\n# 8.3. ä¼éå¯å¨å³é­\n\nå¦ä½é¿åæå¡åæºå¸¦æ¥çä¸å¡æå¤±ï¼\n\n\n\nå¦ä½é¿åæµéæå°æ²¡æå¯å¨å®æçèç¹ï¼\n\n\n\n\n# 9. å®¹éå¤ç\n\n\n# 9.1. å¼å¸¸éè¯\n\nå°±æ¯å½è°ç¨ç«¯åèµ·çè¯·æ±å¤±è´¥æ¶ï¼rpc æ¡æ¶èªèº«å¯ä»¥è¿è¡éè¯ï¼åéæ°åéè¯·æ±ï¼ç¨æ·å¯ä»¥èªè¡è®¾ç½®æ¯å¦å¼å¯éè¯ä»¥åéè¯çæ¬¡æ°ã\n\nå½ç¶ï¼ä¸æ¯ææçå¼å¸¸é½è¦è§¦åéè¯ï¼åªæç¬¦åéè¯æ¡ä»¶çå¼å¸¸æè½è§¦åéè¯ï¼æ¯å¦ç½ç»è¶æ¶å¼å¸¸ãç½ç»è¿æ¥å¼å¸¸ç­ç­ï¼è¿ä¸ªéè¦ rpc å»å¤å®ï¼ã\n\n> æ³¨æï¼ææ¶ç½ç»å¯è½åçæå¨ï¼å¯¼è´è¯·æ±è¶æ¶ï¼è¿æ¶å¦æ rpc è§¦åè¶æ¶éè¯ï¼ä¼è§¦åä¸å¡é»è¾éå¤æ§è¡ï¼å¦ææ¥å£æ²¡æå¹ç­æ§è®¾è®¡ï¼å°±å¯è½å¼åé®é¢ãå¦ï¼éååè¡¨ã\n\n\n# 9.2. éè¯è¶æ¶æ¶é´\n\nè¿ç»­çå¼å¸¸éè¯å¯è½ä¼åºç°ä¸ç§ä¸å¯é çæåµï¼é£å°±æ¯è¿ç»­çå¼å¸¸éè¯å¹¶ä¸æ¯æ¬¡å¤ççè¯·æ±æ¶é´æ¯è¾é¿ï¼æç»ä¼å¯¼è´è¯·æ±å¤ççæ¶é´è¿é¿ï¼è¶åºç¨æ·è®¾ç½®çè¶æ¶æ¶é´ã\n\nè§£å³è¿ä¸ªé®é¢æç´æ¥çæ¹å¼å°±æ¯ï¼å¨æ¯æ¬¡éè¯åé½éç½®ä¸ä¸è¯·æ±çè¶æ¶æ¶é´ã\n\nå½è°ç¨ç«¯åèµ· rpc è¯·æ±æ¶ï¼å¦æåéè¯·æ±åçå¼å¸¸å¹¶è§¦åäºå¼å¸¸éè¯ï¼æä»¬å¯ä»¥åå¤å®ä¸è¿ä¸ªè¯·æ±æ¯å¦å·²ç»è¶æ¶ï¼å¦æå·²ç»è¶æ¶äºå°±ç´æ¥è¿åè¶æ¶å¼å¸¸ï¼å¦åå°±åéç½®ä¸è¿ä¸ªè¯·æ±çè¶æ¶æ¶é´ï¼ä¹åååèµ·éè¯ã\n\nå¨ææåèµ·éè¯ãè´è½½åè¡¡éæ©èç¹çæ¶åï¼å»æéè¯ä¹ååºç°è¿é®é¢çé£ä¸ªèç¹ï¼ä»¥ä¿è¯éè¯çæåçã\n\n\n# 9.3. ä¸å¡å¼å¸¸\n\nrpc æ¡æ¶æ¯ä¸ä¼ç¥éåªäºä¸å¡å¼å¸¸è½å¤å»è¿è¡å¼å¸¸éè¯çï¼æä»¬å¯ä»¥å ä¸ªéè¯å¼å¸¸çç½å åï¼ç¨æ·å¯ä»¥å°åè®¸éè¯çå¼å¸¸å å¥å°è¿ä¸ªç½ååä¸­ãå½è°ç¨ç«¯åèµ·è°ç¨ï¼å¹¶ä¸éç½®äºå¼å¸¸éè¯ç­ç¥ï¼æè·å°å¼å¸¸ä¹åï¼æä»¬å°±å¯ä»¥éç¨è¿æ ·çå¼å¸¸å¤çç­ç¥ãå¦æè¿ä¸ªå¼å¸¸æ¯ rpc æ¡æ¶åè®¸éè¯çå¼å¸¸ï¼æèè¿ä¸ªå¼å¸¸ç±»åå­å¨äºå¯éè¯å¼å¸¸çç½ååä¸­ï¼æä»¬å°±åè®¸å¯¹è¿ä¸ªè¯·æ±è¿è¡éè¯ã\n\n----------------------------------------\n\nç»¼ä¸ï¼ä¸ä¸ªå¯é ç rpc å®¹éå¤çæºå¶å¦ä¸ï¼\n\n\n\n\n# 10. ä¼éä¸çº¿ä¸çº¿\n\nå¦ä½é¿åæå¡åæºå¸¦æ¥çä¸å¡æå¤±ï¼\n\n\n# 10.1. ä¼éä¸çº¿\n\nå½æå¡æä¾æ¹æ­£å¨å³é­ï¼å¦æè¿ä¹åè¿æ¶å°äºæ°çä¸å¡è¯·æ±ï¼æå¡æä¾æ¹ç´æ¥è¿åä¸ä¸ªç¹å®çå¼å¸¸ç»è°ç¨æ¹ï¼æ¯å¦ shutdownexceptionï¼ãè¿ä¸ªå¼å¸¸å°±æ¯åè¯è°ç¨æ¹âæå·²ç»æ¶å°è¿ä¸ªè¯·æ±äºï¼ä½æ¯ææ­£å¨å³é­ï¼å¹¶æ²¡æå¤çè¿ä¸ªè¯·æ±âï¼ç¶åè°ç¨æ¹æ¶å°è¿ä¸ªå¼å¸¸ååºåï¼rpc æ¡æ¶æè¿ä¸ªèç¹ä»å¥åº·åè¡¨æªåºï¼å¹¶æè¯·æ±èªå¨éè¯å°å¶ä»èç¹ï¼å ä¸ºè¿ä¸ªè¯·æ±æ¯æ²¡æè¢«æå¡æä¾æ¹å¤çè¿ï¼æä»¥å¯ä»¥å®å¨å°éè¯å°å¶ä»èç¹ï¼è¿æ ·å°±å¯ä»¥å®ç°å¯¹ä¸å¡æ æã\n\nå¨ java è¯­è¨éé¢ï¼å¯¹åºçæ¯ runtime.addshutdownhook æ¹æ³ï¼å¯ä»¥æ³¨åå³é­çé©å­ãå¨ rpc å¯å¨çæ¶åï¼æä»¬æåæ³¨åå³é­é©å­ï¼å¹¶å¨éé¢æ·»å äºä¸¤ä¸ªå¤çç¨åºï¼ä¸ä¸ªè´è´£å¼å¯å³é­æ è¯ï¼ä¸ä¸ªè´è´£å®å¨å³é­æå¡å¯¹è±¡ï¼æå¡å¯¹è±¡å¨å³é­çæ¶åä¼éç¥è°ç¨æ¹ä¸çº¿èç¹ãåæ¶éè¦å¨æä»¬è°ç¨é¾éé¢å ä¸æ¡æ¿å¤çå¨ï¼å½æ°çè¯·æ±æ¥çæ¶åï¼ä¼å¤æ­å³é­æ è¯ï¼å¦ææ­£å¨å³é­ï¼åæåºç¹å®å¼å¸¸ã\n\n\n\n\n# 10.2. ä¼éä¸çº¿\n\n# 10.2.1. å¯å¨é¢ç­\n\nå¯å¨é¢ç­ï¼å°±æ¯è®©åå¯å¨çæå¡æä¾æ¹åºç¨ä¸æ¿æå¨é¨çæµéï¼èæ¯è®©å®è¢«è°ç¨çæ¬¡æ°éçæ¶é´çç§»å¨æ¢æ¢å¢å ï¼æç»è®©æµéç¼åå°å¢å å°è·å·²ç»è¿è¡ä¸æ®µæ¶é´åçæ°´å¹³ä¸æ ·ã\n\né¦åï¼å¨çå®ç¯å¢ä¸­æºå¨é½ä¼é»è®¤å¼å¯ ntp æ¶é´åæ­¥åè½ï¼æ¥ä¿è¯æææºå¨æ¶é´çä¸è´æ§ã\n\nè°ç¨æ¹éè¿æå¡åç°ï¼é¤äºå¯ä»¥æ¿å° ip åè¡¨ï¼è¿å¯ä»¥æ¿å°å¯¹åºçå¯å¨æ¶é´ãæä»¬éè¦æè¿ä¸ªæ¶é´ä½ç¨å¨è´è½½åè¡¡ä¸ã\n\n\n\néè¿è¿ä¸ªå°é»è¾çæ¹å¨ï¼æä»¬å°±å¯ä»¥ä¿è¯å½æå¡æä¾æ¹è¿è¡æ¶é¿å°äºé¢ç­æ¶é´æ¶ï¼å¯¹æå¡æä¾æ¹è¿è¡éæï¼åå°è¢«è´è½½åè¡¡éæ©çæ¦çï¼é¿åè®©åºç¨å¨å¯å¨ä¹åå°±å¤äºé«è´è½½ç¶æï¼ä»èå®ç°æå¡æä¾æ¹å¨å¯å¨åæä¸ä¸ªé¢ç­çè¿ç¨ã\n\n# 10.2.2. å»¶è¿æ´é²\n\næå¡æä¾æ¹åºç¨å¨æ²¡æå¯å¨å®æçæ¶åï¼è°ç¨æ¹çè¯·æ±å°±è¿æ¥äºï¼èè°ç¨æ¹è¯·æ±è¿æ¥çåå æ¯ï¼æå¡æä¾æ¹åºç¨å¨å¯å¨è¿ç¨ä¸­æè§£æå°ç rpc æå¡æ³¨åå°äºæ³¨åä¸­å¿ï¼è¿å°±å¯¼è´å¨åç»­å è½½æ²¡æå®æçæåµä¸æå¡æä¾æ¹çå°åå°±è¢«æå¡è°ç¨æ¹æç¥å°äºã\n\nä¸ºäºè§£å³è¿ä¸ªé®é¢ï¼éè¦å¨åºç¨å¯å¨å è½½ãè§£æ bean çæ¶åï¼å¦æéå°äº rpc æå¡ç beanï¼åªåæè¿ä¸ª bean æ³¨åå° spring-beanfactory éé¢å»ï¼èå¹¶ä¸æè¿ä¸ª bean å¯¹åºçæ¥å£æ³¨åå°æ³¨åä¸­å¿ï¼åªæç­åºç¨å¯å¨å®æåï¼æææ¥å£æ³¨åå°æ³¨åä¸­å¿ç¨äºæå¡åç°ï¼ä»èå®ç°è®©æå¡è°ç¨æ¹å»¶è¿è·åå°æå¡æä¾æ¹å°åã\n\nå·ä½å¦ä½å®ç°å¢ï¼\n\næä»¬å¯ä»¥å¨æå¡æä¾æ¹åºç¨å¯å¨åï¼æ¥å£æ³¨åå°æ³¨åä¸­å¿åï¼é¢çä¸ä¸ª hook è¿ç¨ï¼è®©ç¨æ·å¯ä»¥å®ç°å¯æ©å±ç hook é»è¾ãç¨æ·å¯ä»¥å¨ hook éé¢æ¨¡æè°ç¨é»è¾ï¼ä»èä½¿ jvm æä»¤è½å¤é¢ç­èµ·æ¥ï¼å¹¶ä¸ç¨æ·ä¹å¯ä»¥å¨ hook éé¢äºåé¢å è½½ä¸äºèµæºï¼åªæç­ææçèµæºé½å è½½å®æåï¼æåæææ¥å£æ³¨åå°æ³¨åä¸­å¿ã\n\n\n\n\n# 11. éæµçæ­\n\néæµç®æ³æå¾å¤ï¼æ¯å¦æç®åçè®¡æ°å¨ï¼è¿æå¯ä»¥åå°å¹³æ»éæµçæ»å¨çªå£ãæ¼æç®æ³ä»¥åä»¤çæ¡¶ç®æ³ç­ç­ãå¶ä¸­ä»¤çæ¡¶ç®æ³æä¸ºå¸¸ç¨ã\n\næå¡ç«¯ä¸»è¦æ¯éè¿éæµæ¥è¿è¡èªæä¿æ¤ï¼æä»¬å¨å®ç°éæµæ¶è¦èèå°åºç¨å ip çº§å«ï¼æ¹ä¾¿æä»¬å¨æå¡æ²»ççæ¶åï¼å¯¹é¨åè®¿é®éç¹å«å¤§çåºç¨è¿è¡åççéæµã\n\næå¡ç«¯çéæµéå¼éç½®é½æ¯ä½ç¨äºåæºçï¼èå¨æäºåºæ¯ä¸ï¼ä¾å¦å¯¹æ´ä¸ªæå¡è®¾ç½®éæµéå¼ï¼æå¡è¿è¡æ©å®¹æ¶ï¼ éæµçéç½®å¹¶ä¸æ¹ä¾¿ï¼æä»¬å¯ä»¥å¨æ³¨åä¸­å¿æéç½®ä¸­å¿ä¸åéæµéå¼éç½®çæ¶åï¼å°æ»æå¡èç¹æ°ä¹ä¸åç»æå¡èç¹ï¼è®© rpc æ¡æ¶èªå·±å»è®¡ç®éæµéå¼ã\n\næä»¬è¿å¯ä»¥è®© rpc æ¡æ¶çéæµæ¨¡åä¾èµä¸ä¸ªä¸é¨çéæµæå¡ï¼å¯¹æå¡è®¾ç½®éæµéå¼è¿è¡ç²¾åå°æ§å¶ï¼ä½æ¯è¿ç§æ¹å¼ä¾èµäºéæµæå¡ï¼ç¸æ¯åæºçéæµæ¹å¼ï¼å¨æ§è½åèæ¶ä¸æå£å¿ã\n\nè°ç¨ç«¯å¯ä»¥éè¿çæ­æºå¶è¿è¡èªæä¿æ¤ï¼é²æ­¢è°ç¨ä¸æ¸¸æå¡åºç°å¼å¸¸ï¼æèèæ¶è¿é¿å½±åè° ç¨ç«¯çä¸å¡é»è¾ï¼rpc æ¡æ¶å¯ä»¥å¨å¨æä»£ççé»è¾ä¸­å»æ´åçæ­å¨ï¼å®ç° rpc æ¡æ¶ççæ­ åè½ã\n\n\n# 12. ä¸å¡åç»\n\n\n\nå¨ rpc éé¢æä»¬å¯ä»¥éè¿åç»çæ¹å¼äººä¸ºå°ç»ä¸åçè°ç¨æ¹åååºä¸åçå°éç¾¤ï¼ä»èå®ç°è°ç¨æ¹æµééç¦»çææï¼ä¿éæä»¬çæ ¸å¿ä¸å¡ä¸åéæ ¸å¿ä¸å¡çå¹²æ°ãä½æä»¬å¨èèé®é¢çæ¶åï¼ä¸è½é¡¾æ­¤å¤±å½¼ï¼ä¸è½å ä¸ºæ°å ä¸ä¸ªçåè½èå½±åå°åæç³»ç»çç¨³å®æ§ã\n\nå¶å®æä»¬ä¸ä»å¯ä»¥éè¿åç»ææå¡æä¾æ¹ååæä¸åè§æ¨¡çå°éç¾¤ï¼æä»¬è¿å¯ä»¥å©ç¨åç»å®æä¸ä¸ªæ¥å£å¤ç§å®ç°çåè½ãæ­£å¸¸æåµä¸ï¼ä¸ºäºæ¹ä¾¿æä»¬èªå·±ç®¡çæå¡ï¼æä¸è¬é½ä¼å»ºè®®æ¯ä¸ªæ¥å£å®æçåè½å°½éä¿è¯å¯ä¸ãä½å¨æäºç¹æ®åºæ¯ä¸ï¼ä¸¤ä¸ªæ¥å£ä¹ä¼å®å¨ä¸æ ·ï¼åªæ¯å·ä½å®ç°ä¸æé£ä¹ä¸ç¹ä¸åï¼é£ä¹æä»¬å°±å¯ä»¥å¨æå¡æä¾æ¹åºç¨éé¢åæ¶æ´é²ä¸¤ä¸ªç¸åæ¥å£ï¼ä½åªæ¯æ¥å£åç»ä¸ä¸æ ·ç½¢äºã\n\n\n# 12.1. å¨æåç»\n\nåç»å¯ä»¥å¸®å©æå¡æä¾æ¹å®ç°è°ç¨æ¹çéç¦»ãä½æ¯å ä¸ºè°ç¨æ¹æµéå¹¶ä¸æ¯ä¸æä¸åçï¼èä¸è¿å¯è½ä¼å ä¸ºçªåäºä»¶å¯¼è´æä¸ªåç»çæµéæº¢åºï¼èå¨æ´ä¸ªå¤§éç¾¤è¿æå¯ä½è½åçæ¶åï¼åå ä¸ºåç»éç¦»ä¸è½ä¸ºåºé®é¢çéç¾¤æä¾å¸®å©ã\n\nä¸ºäºè§£å³è¿ç§çªåæµéçé®é¢ï¼æä»¬æä¾äºä¸ç§æ´é«æçæ¹æ¡ï¼å¯ä»¥å®ç°åç»çå¿«éä¼¸ç¼©ãäºå®ä¸æä»¬è¿å¯ä»¥å©ç¨å¨æåç»è§£å³åç»åç»æ¯ä¸ªåç»é¢çæºå¨åä½çé®é¢ï¼æä»¬æ²¡æå¿è¦æææåä½çæºå¨é½åéå°åç»éé¢ï¼æä»¬å¯ä»¥æè¿äºé¢ççæºå¨åæä¸ä¸ªå±äº«çæ± å­ï¼ä»èåå°æ´ä½é¢ççå®ä¾æ°éã\n\n\n# 13. é¾è·¯è·è¸ª\n\nåå¸å¼é¾è·¯è·è¸ªå°±æ¯å°ä¸æ¬¡åå¸å¼è¯·æ±è¿åä¸ºä¸ä¸ªå®æ´çè°ç¨é¾è·¯ï¼æä»¬å¯ä»¥å¨æ´ä¸ªè°ç¨é¾è·¯ä¸­è·è¸ªå°è¿ä¸æ¬¡åå¸å¼è¯·æ±çæ¯ä¸ä¸ªç¯èçè°ç¨æåµï¼æ¯å¦è°ç¨æ¯å¦æåï¼è¿åä»ä¹å¼å¸¸ï¼è°ç¨çåªä¸ªæå¡èç¹ä»¥åè¯·æ±èæ¶ç­ç­ã\n\ntrace å°±æ¯ä»£è¡¨æ´ä¸ªé¾è·¯ï¼æ¯æ¬¡åå¸å¼é½ä¼äº§çä¸ä¸ª traceï¼æ¯ä¸ª trace é½æå®çå¯ä¸æ è¯å³ traceidï¼å¨åå¸å¼é¾è·¯è·è¸ªç³»ç»ä¸­ï¼å°±æ¯éè¿ traceid æ¥åºåæ¯ä¸ª trace çã span å°±æ¯ä»£è¡¨äºæ´ä¸ªé¾è·¯ä¸­çä¸æ®µé¾è·¯ï¼ä¹å°±æ¯è¯´ trace æ¯ç±å¤ä¸ª span ç»æçãå¨ä¸ä¸ª trace ä¸ï¼æ¯ä¸ª span ä¹é½æå®çå¯ä¸æ è¯ spanidï¼è span æ¯å­å¨ç¶å­å³ç³»çãè¿æ¯ä»¥è®²è¿çä¾å­ä¸ºä¾å­ï¼å¨ a->b->c->d çæåµä¸ï¼å¨æ´ä¸ªè°ç¨é¾ä¸­ï¼æ­£å¸¸æåµä¸ä¼äº§ç 3 ä¸ª spanï¼åå«æ¯ span1ï¼a->bï¼ãspan2ï¼b->cï¼ãspan3ï¼c->dï¼ï¼è¿æ¶ span3 çç¶ span å°±æ¯ span2ï¼è span2 çç¶ span å°±æ¯ span1ã\n\nrpc å¨æ´ååå¸å¼é¾è·¯è·è¸ªéè¦åçææ ¸å¿çä¸¤ä»¶äºå°±æ¯âåç¹âåâä¼ éâã\n\næä»¬åé¢è¯´æ¯å ä¸ºåå­åºç¨ãå­æå¡é´å¤æçä¾èµå³ç³»ï¼æä»¥éè¿æ¥å¿é¾å®ä½é®é¢ãé£æä»¬å°±æ³åæ³éè¿æ¥å¿å®ä½å°æ¯åªä¸ªå­åºç¨çå­æå¡åºç°é®é¢å°±è¡äºã\n\nå¶å®ï¼å¨ rpc æ¡æ¶æå°çå¼å¸¸ä¿¡æ¯ä¸­ï¼æ¯åæ¬å®ä½å¼å¸¸æéè¦çå¼å¸¸ä¿¡æ¯çï¼æ¯å¦æ¯åªç±»å¼å¸¸å¼èµ·çé®é¢ï¼å¦åºååé®é¢æç½ç»è¶æ¶é®é¢ï¼ï¼æ¯è°ç¨ç«¯è¿æ¯æå¡ç«¯åºç°çå¼å¸¸ï¼è°ç¨ç«¯ä¸æå¡ç«¯ç ip æ¯ä»ä¹ï¼ä»¥åæå¡æ¥å£ä¸æå¡åç»é½æ¯ä»ä¹ç­ç­ãå·ä½å¦ä¸å¾æç¤ºï¼\n\n\n\n\n# 14. æ³åè°ç¨\n\nå¨ä¸äºç¹å®åºæ¯ä¸ï¼éè¦å¨æ²¡ææ¥å£çæåµä¸è¿è¡ rpc è°ç¨ãä¾å¦ï¼\n\nåºæ¯ä¸ï¼æ­å»ºä¸ä¸ªç»ä¸çæµè¯å¹³å°ï¼å¯ä»¥è®©åä¸ªä¸å¡æ¹å¨æµè¯å¹³å°ä¸­éè¿è¾å¥æ¥å£ãåç»åãæ¹æ³åä»¥ååæ°å¼ï¼å¨çº¿æµè¯èªå·±åå¸ç rpc æå¡ã\n\n\n\nåºæ¯äºï¼æ­å»ºä¸ä¸ªè½»éçº§çæå¡ç½å³ï¼å¯ä»¥è®©åä¸ªä¸å¡æ¹ç¨ http çæ¹å¼ï¼éè¿æå¡ç½å³è°ç¨å¶å®æå¡ã\n\n\n\nä¸ºäºè§£å³è¿äºåºæ¯çé®é¢ï¼å¯ä»¥ä½¿ç¨æ³åè°ç¨ã\n\nå°±æ¯ rpc æ¡æ¶æä¾ç»ä¸çæ³åè°ç¨æ¥å£ï¼genericserviceï¼ï¼è°ç¨ç«¯å¨åå»º genericservice ä»£çæ¶æå®çæ­£éè¦è°ç¨çæ¥å£çæ¥å£åä»¥ååç»åï¼éè¿è°ç¨ genericservice ä»£çç $invoke æ¹æ³å°æå¡ç«¯æéè¦çææä¿¡æ¯ï¼åæ¬æ¥å£åãä¸å¡åç»åãæ¹æ³åä»¥ååæ°ä¿¡æ¯ç­å°è£æè¯·æ±æ¶æ¯ï¼åéç»æå¡ç«¯ï¼å®ç°å¨æ²¡ææ¥å£çæåµä¸è¿è¡ rpc è°ç¨çåè½ã\n\nclass genericservice {\nobject $invoke(string methodname, string[] paramtypes, object[] params);\ncompletablefuture<object> $asyncinvoke(string methodname, string[] paramtypes\n}\n\n\nèéè¿æ³åè°ç¨çæ¹å¼åèµ·è°ç¨ï¼ç±äºè°ç¨ç«¯æ²¡ææå¡ç«¯æä¾æ¹æä¾çæ¥å£ apiï¼ä¸è½æ­£å¸¸å°è¿è¡åºååä¸ååºååï¼æä»¬å¯ä»¥ä¸ºæ³åè°ç¨æä¾ä¸å±çåºååæä»¶ï¼æ¥è§£å³å®éé®é¢ã\n\n\n# 15. æ¶éè½®\n\næ¶éè½®è¿ä¸ªæºå¶å¾å¥½å°è§£å³äºå®æ¶ä»»å¡ä¸­ï¼å æ¯ä¸ªä»»å¡é½åå»ºä¸ä¸ªçº¿ç¨ï¼å¯¼è´çåå»ºè¿å¤çº¿ç¨çé®é¢ï¼ä»¥åä¸ä¸ªçº¿ç¨æ«æææçå®æ¶ä»»å¡ï¼è®© cpu åäºå¾å¤é¢å¤çè½®è¯¢éåæä½èæµªè´¹ cpu çé®é¢ã\n\næ¶éè½®çå®ç°æºå¶å°±æ¯æ¨¡æç°å®çæ´»ä¸­çæ¶éï¼å°æ¯ä¸ªå®æ¶ä»»å¡æ¾å°å¯¹åºçæ¶é´æ§½ä½ä¸ï¼è¿æ ·å¯ä»¥åå°æ«æä»»å¡æ¶å¯¹å¶å®æ¶é´æ§½ä½å®æ¶ä»»å¡çé¢å¤éåæä½ã\n\nå¨æ¶é´è½®çä½¿ç¨ä¸­ï¼æäºé®é¢éè¦ä½ é¢å¤æ³¨æï¼\n\næ¶é´æ§½ä½çåä½æ¶é´è¶ç­ï¼æ¶é´è½®è§¦åä»»å¡çæ¶é´å°±è¶ç²¾ç¡®ãä¾å¦æ¶é´æ§½ä½çåä½æ¶é´æ¯ 10 æ¯«ç§ï¼é£ä¹æ§è¡å®æ¶ä»»å¡çæ¶é´è¯¯å·®å°±å¨ 10 æ¯«ç§åï¼å¦ææ¯ 100 æ¯«ç§ï¼é£ä¹è¯¯å·®å°±å¨ 100 æ¯«ç§åã\n\næ¶é´è½®çæ§½ä½è¶å¤ï¼é£ä¹ä¸ä¸ªä»»å¡è¢«éå¤æ«æçæ¦çå°±è¶å°ï¼å ä¸ºåªæå¨å¤å±æ¶éè½®ä¸­çä»»å¡æä¼è¢«éå¤æ«æãæ¯å¦ä¸ä¸ªæ¶é´è½®çæ§½ä½æ 1000 ä¸ªï¼ä¸ä¸ªæ§½ä½çåä½æ¶é´æ¯ 10 æ¯«ç§ï¼é£ä¹ä¸ä¸å±æ¶é´è½®çä¸ä¸ªæ§½ä½çåä½æ¶é´å°±æ¯ 10 ç§ï¼è¶è¿ 10 ç§çå®æ¶ä»»å¡ä¼è¢«æ¾å°ä¸ä¸å±æ¶é´è½®ä¸­ï¼ä¹å°±æ¯åªæè¶è¿ 10 ç§çå®æ¶ä»»å¡ä¼è¢«æ«æéåä¸¤æ¬¡ï¼ä½å¦ææ§½ä½æ¯ 10 ä¸ªï¼é£ä¹è¶è¿ 100 æ¯«ç§çä»»å¡ï¼å°±ä¼è¢«æ«æéåä¸¤æ¬¡ã\n\nç»åè¿äºç¹ç¹ï¼æä»¬å°±å¯ä»¥è§å·ä½çä¸å¡åºæ¯èå®ï¼å¯¹æ¶éè½®çå¨æåæ¶é´æ§½æ°è¿è¡è®¾ç½®ã\n\nå¨ rpc æ¡æ¶ä¸­ï¼åªè¦æ¶åå°å®æ¶ä»»å¡ï¼æä»¬é½å¯ä»¥åºç¨æ¶éè½®ï¼æ¯è¾å¸åçå°±æ¯è°ç¨ç«¯çè¶æ¶å¤çãè°ç¨ç«¯ä¸æå¡ç«¯çå¯å¨è¶æ¶ä»¥åå®æ¶å¿è·³ç­ç­ã\n\n\n# 16. æµéåæ¾\n\næè°çæµéå°±æ¯æä¸ªæ¶é´æ®µåçææè¯·æ±ï¼æä»¬éè¿æç§ææ®µæåéå° a åºç¨çææè¯·æ±å½å¶ä¸æ¥ï¼ç¶åæè¿äºè¯·æ±ç»ä¸è½¬åå° b åºç¨ï¼è®© b åºç¨æ¥æ¶å°çè¯·æ±åæ°è· a åºç¨ä¿æä¸è´ï¼ä»èå®ç° a æ¥æ¶å°çè¯·æ±å¨ b åºç¨éé¢éæ°è¯·æ±äºä¸éãæ´ä¸ªè¿ç¨ç§°ä¹ä¸ºâæµéåæ¾âã\n\næµéåæ¾å¯ä»¥åä»ä¹ï¼\n\nä¸ºäºä¿éåºç¨åçº§åï¼æä»¬çä¸å¡è¡ä¸ºè¿è½ä¿æååçº§åä¸æ ·ï¼æä»¬å¨å¤§å¤æ°æåµä¸é½æ¯ä¾é å·²æç testcase å»éªè¯ï¼ä½è¿ç§æ¹å¼å¨ä¸å®ç¨åº¦ä¸å¹¶ä¸æ¯å®å¨å¯é çãæå¯é çæ¹å¼å°±æ¯å¼å¥çº¿ä¸ case å»éªè¯æ¹é åçåºç¨ï¼æçº¿ä¸ççå®æµéå¨æ¹é åçåºç¨éé¢è¿è¡åæ¾ï¼è¿æ ·ä¸ä»èçæ´ä¸ªä¸çº¿æ¶é´ï¼è¿è½å¼¥è¡¥æå¨ç»´æ¤ case å­å¨çç¼ºé·ã\n\nåºç¨å¼å¥äº rpc åï¼ææçè¯·æ±æµéé½ä¼è¢« rpc æ¥ç®¡ï¼æä»¥æä»¬å¯ä»¥å¾èªç¶å°å¨ rpc éé¢æ¯ææµéåæ¾åè½ãè½ç¶è¿ä¸ªåè½æ¬èº«å¹¶ä¸æ¯ rpc çæ ¸å¿åè½ï¼ä½å¯¹äºä½¿ç¨ rpc çäººæ¥è¯´ï¼ä»ä»¬æäºè¿ä¸ªåè½ä¹åï¼å°±å¯ä»¥æ´æ¾å¿å°åçº§èªå·±çåºç¨äºã\n\n\n# 17. rpc é«çº§\n\n\n# 17.1. rpc æ§è½\n\nå¦ä½æååæºååéï¼\n\nå¤§å¤æ°æåµä¸ï¼å½±åå° rpc è°ç¨çååéçåå ä¹å°±æ¯ä¸å¡é»è¾å¤çæ¢äºï¼cpu å¤§é¨åæ¶é´é½å¨ç­å¾èµæºã\n\nä¸ºäºè§£å³ç­å¾çèæ¶ï¼å¯ä»¥ä½¿ç¨å¼æ­¥ãå¼æ­¥å¯ä»¥ä½¿ç¨ future æ callback æ¹å¼ï¼future æä¸ºç®åã\n\n\n\nå¦å¤ï¼æä»¬å¯ä»¥éè¿å¯¹ completablefuture çæ¯æï¼å®ç° rpc è°ç¨å¨è°ç¨ç«¯ä¸æå¡ç«¯ä¹é´çå®å¨å¼æ­¥ï¼åæ¶æåä¸¤ç«¯çåæºååéã\n\n\n# 17.2. rpc å®å¨\n\nè½ç¶ rpc ç»å¸¸ç¨äºè§£å³åç½åºç¨ä¹é´çè°ç¨ï¼åç½ç¯å¢ç¸å¯¹å¬ç½ä¹æ²¡æé£ä¹æ¶å£ï¼ä½æä»¬ä¹æå¿è¦å»å»ºç«ä¸å¥å¯æ§çå®å¨ä½ç³»ï¼å»é²æ­¢ä¸äºéè¯¯è¡ä¸ºãå¯¹äº rpc æ¥è¯´ï¼æä»¬æå³å¿çå®å¨é®é¢ä¸ä¼æå¬ç½åºç¨é£ä¹å¤æï¼æä»¬åªè¦ä¿è¯è®©æå¡è°ç¨æ¹è½æ¿å°çå®çæå¡æä¾æ¹ ip å°åéåï¼ä¸æå¡æä¾æ¹å¯ä»¥ç®¡æ§è°ç¨èªå·±çåºç¨å°±å¤äºã\n\næå¡æä¾æ¹åºç¨éé¢æ¾ä¸ä¸ªç¨äº hmac ç­¾åçç§é¥ï¼å¨ææå¹³å°ä¸ç¨è¿ä¸ªç§é¥ä¸ºç³è¯·è°ç¨çè°ç¨æ¹åºç¨è¿è¡ç­¾åï¼è¿ä¸ªç­¾åçæçä¸²å°±åæäºè°ç¨æ¹å¯ä¸çèº«ä»½ãæå¡æä¾æ¹å¨æ¶å°è°ç¨æ¹çææè¯·æ±ä¹åï¼æä»¬åªè¦éè¦éªè¯ä¸è¿ä¸ªç­¾åè·è°ç¨æ¹åºç¨ä¿¡æ¯æ¯å¦å¯¹åºå¾ä¸å°±è¡äºï¼è¿æ ·éä¸­å¼ææçç¶é¢ä¹å°±ä¸å­å¨äºã\n\n\n# 18. åèèµæ\n\n * ãrpc å®æä¸æ ¸å¿åçã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"kong",frontmatter:{title:"kong",categories:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],tags:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],abbrlink:"a64091d1",date:"2018-10-11T13:08:18.000Z",permalink:"/pages/3c87eb/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/04.%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1/22.Kong.html",relativePath:"02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/22.Kong.md",key:"v-27b2649e",path:"/pages/3c87eb/",headers:[{level:2,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:90},{level:3,title:"ä¸ºä»ä¹éæ© Kong",slug:"ä¸ºä»ä¹éæ©-kong",normalizedTitle:"ä¸ºä»ä¹éæ© kong",charIndex:97},{level:2,title:"Quickstart",slug:"quickstart",normalizedTitle:"quickstart",charIndex:120},{level:3,title:"å®è£éç½®",slug:"å®è£éç½®",normalizedTitle:"å®è£éç½®",charIndex:135},{level:3,title:"ä½¿ç¨ Kong",slug:"ä½¿ç¨-kong",normalizedTitle:"ä½¿ç¨ kong",charIndex:794},{level:3,title:"éç½®æå¡",slug:"éç½®æå¡",normalizedTitle:"éç½®æå¡",charIndex:955},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:2227}],headersStr:"ç®ä» ä¸ºä»ä¹éæ© Kong Quickstart å®è£éç½® ä½¿ç¨ Kong éç½®æå¡ åèèµæ",content:'# Kong\n\n> Kong æ¯ä¸ä¸ªäºåçãå¿«éãå¯æ©å±ååå¸å¼çå¾®æå¡æ½è±¡å±ï¼ä¹ç§°ä¸º API ç½å³ï¼API ä¸­é´ä»¶ï¼ã\n> \n> å³é®è¯ï¼nginx,apiç½å³,å¾®æå¡\n\n\n# ç®ä»\n\n\n# ä¸ºä»ä¹éæ© Kong\n\n\n\n\n\n\n\n\n\n\n# Quickstart\n\n\n# å®è£éç½®\n\n> æ¬æä»ä»¥ Centos7 ä¸ºä¾ã\n\nKong æ¯æå¨å¤ç§ç¯å¢ä¸å®è£ã\n\nå®æ¹å®è£è¯´æï¼https://konghq.com/install/\n\n\n\n\n\n\n\n\n\nä»¥ä¸ä¸º Centos7 å®è£æ­¥éª¤ï¼\n\nï¼1ï¼ä¸è½½ rpm å®è£åå°æ¬å°\n\nï¼2ï¼å®è£ Kong\n\n$ sudo yum install epel-release\n$ sudo yum install kong-community-edition-0.14.1.*.noarch.rpm --nogpgcheck\n\n\nï¼3ï¼åå¤æ°æ®åº\n\nKong éè¦å­å¨æ°æ®ï¼æ¯æä¸¤ç§æ°æ®åºï¼PostgreSQL 9.5+ å Cassandra 3.x.x\n\næ¬äººéæ©äº PostgreSQLï¼å®è£æ¹æ³å¯ä»¥åè ââ PostgreSQL å®è£\n\nå®è£ PostgreSQL åï¼éç½®ä¸ä¸ªæ°æ®åºåæ°æ®åºç¨æ·ï¼\n\nCREATE USER kong;\nCREATE DATABASE kong OWNER kong;\n\n\nï¼4ï¼æ§è¡ Kong è¿ç§»\n\næ§è¡ä»¥ä¸å½ä»¤ï¼\n\n$ kong migrations up [-c /path/to/kong.conf]\n\n\næ³¨æï¼æ°¸è¿ä¸åºåæ¶è¿è¡è¿ç§»ï¼ä¸ä¸ª Kong èç¹åºè¯¥åªæ§è¡ä¸æ¬¡è¿ç§»ã\n\nï¼5ï¼å¯å¨ Kong\n\n$ kong start [-c /path/to/kong.conf]\n\n\nï¼6ï¼æµè¯å¯å¨æå\n\n$ curl -i http://localhost:8001/\n\n\nè³æ­¤ï¼å®è£éç½®å®æã\n\n\n# ä½¿ç¨ Kong\n\n * å¯å¨ï¼å¿é¡»ç¡®ä¿æ§è¡è¿ kong migrations upï¼ - kong start [-c /path/to/kong.conf]\n   * -c /path/to/kong.conf åæ°ç¨æ¥æå®ç¨æ·çéç½®\n * åæ­¢ - kong stop\n * éå¯ - kong reload\n\n\n# éç½®æå¡\n\nï¼1ï¼æ·»å ç¬¬ä¸ä¸ªæå¡\n\n$ curl -i -X POST \\\n  --url http://localhost:8001/services/ \\\n  --data \'name=example-service\' \\\n  --data \'url=http://mockbin.org\'\n\n\nåºç­ç±»ä¼¼ä¸é¢å½¢å¼ï¼\n\nHTTP/1.1 201 Created\nContent-Type: application/json\nConnection: keep-alive\n\n{\n   "host":"mockbin.org",\n   "created_at":1519130509,\n   "connect_timeout":60000,\n   "id":"92956672-f5ea-4e9a-b096-667bf55bc40c",\n   "protocol":"http",\n   "name":"example-service",\n   "read_timeout":60000,\n   "port":80,\n   "path":null,\n   "updated_at":1519130509,\n   "retries":5,\n   "write_timeout":60000\n}\n\n\nï¼2ï¼ä¸ºæå¡æ·»å è·¯ç±\n\n$ curl -i -X POST \\\n  --url http://localhost:8001/services/example-service/routes \\\n  --data \'hosts[]=example.com\'\n\n\nåºç­ç±»ä¼¼ä¸é¢å½¢å¼ï¼\n\nHTTP/1.1 201 Created\nContent-Type: application/json\nConnection: keep-alive\n\n{\n   "created_at":1519131139,\n   "strip_path":true,\n   "hosts":[\n      "example.com"\n   ],\n   "preserve_host":false,\n   "regex_priority":0,\n   "updated_at":1519131139,\n   "paths":null,\n   "service":{\n      "id":"79d7ee6e-9fc7-4b95-aa3b-61d2e17e7516"\n   },\n   "methods":null,\n   "protocols":[\n      "http",\n      "https"\n   ],\n   "id":"f9ce2ed7-c06e-4e16-bd5d-3a82daef3f9d"\n}\n\n\næ­¤æ¶ï¼Kong å·²ç»å³æ³¨è¿ä¸ªæå¡ï¼å¹¶åå¤ä»£çè¯·æ±ã\n\nï¼3ï¼éè¿ Kong è½¬åè¯·æ±\n\n$ curl -i -X GET \\\n  --url http://localhost:8000/ \\\n  --header \'Host: example.com\'\n\n\n\n# åèèµæ\n\nhttps://www.itcodemonkey.com/article/5980.html',normalizedContent:'# kong\n\n> kong æ¯ä¸ä¸ªäºåçãå¿«éãå¯æ©å±ååå¸å¼çå¾®æå¡æ½è±¡å±ï¼ä¹ç§°ä¸º api ç½å³ï¼api ä¸­é´ä»¶ï¼ã\n> \n> å³é®è¯ï¼nginx,apiç½å³,å¾®æå¡\n\n\n# ç®ä»\n\n\n# ä¸ºä»ä¹éæ© kong\n\n\n\n\n\n\n\n\n\n\n# quickstart\n\n\n# å®è£éç½®\n\n> æ¬æä»ä»¥ centos7 ä¸ºä¾ã\n\nkong æ¯æå¨å¤ç§ç¯å¢ä¸å®è£ã\n\nå®æ¹å®è£è¯´æï¼https://konghq.com/install/\n\n\n\n\n\n\n\n\n\nä»¥ä¸ä¸º centos7 å®è£æ­¥éª¤ï¼\n\nï¼1ï¼ä¸è½½ rpm å®è£åå°æ¬å°\n\nï¼2ï¼å®è£ kong\n\n$ sudo yum install epel-release\n$ sudo yum install kong-community-edition-0.14.1.*.noarch.rpm --nogpgcheck\n\n\nï¼3ï¼åå¤æ°æ®åº\n\nkong éè¦å­å¨æ°æ®ï¼æ¯æä¸¤ç§æ°æ®åºï¼postgresql 9.5+ å cassandra 3.x.x\n\næ¬äººéæ©äº postgresqlï¼å®è£æ¹æ³å¯ä»¥åè ââ postgresql å®è£\n\nå®è£ postgresql åï¼éç½®ä¸ä¸ªæ°æ®åºåæ°æ®åºç¨æ·ï¼\n\ncreate user kong;\ncreate database kong owner kong;\n\n\nï¼4ï¼æ§è¡ kong è¿ç§»\n\næ§è¡ä»¥ä¸å½ä»¤ï¼\n\n$ kong migrations up [-c /path/to/kong.conf]\n\n\næ³¨æï¼æ°¸è¿ä¸åºåæ¶è¿è¡è¿ç§»ï¼ä¸ä¸ª kong èç¹åºè¯¥åªæ§è¡ä¸æ¬¡è¿ç§»ã\n\nï¼5ï¼å¯å¨ kong\n\n$ kong start [-c /path/to/kong.conf]\n\n\nï¼6ï¼æµè¯å¯å¨æå\n\n$ curl -i http://localhost:8001/\n\n\nè³æ­¤ï¼å®è£éç½®å®æã\n\n\n# ä½¿ç¨ kong\n\n * å¯å¨ï¼å¿é¡»ç¡®ä¿æ§è¡è¿ kong migrations upï¼ - kong start [-c /path/to/kong.conf]\n   * -c /path/to/kong.conf åæ°ç¨æ¥æå®ç¨æ·çéç½®\n * åæ­¢ - kong stop\n * éå¯ - kong reload\n\n\n# éç½®æå¡\n\nï¼1ï¼æ·»å ç¬¬ä¸ä¸ªæå¡\n\n$ curl -i -x post \\\n  --url http://localhost:8001/services/ \\\n  --data \'name=example-service\' \\\n  --data \'url=http://mockbin.org\'\n\n\nåºç­ç±»ä¼¼ä¸é¢å½¢å¼ï¼\n\nhttp/1.1 201 created\ncontent-type: application/json\nconnection: keep-alive\n\n{\n   "host":"mockbin.org",\n   "created_at":1519130509,\n   "connect_timeout":60000,\n   "id":"92956672-f5ea-4e9a-b096-667bf55bc40c",\n   "protocol":"http",\n   "name":"example-service",\n   "read_timeout":60000,\n   "port":80,\n   "path":null,\n   "updated_at":1519130509,\n   "retries":5,\n   "write_timeout":60000\n}\n\n\nï¼2ï¼ä¸ºæå¡æ·»å è·¯ç±\n\n$ curl -i -x post \\\n  --url http://localhost:8001/services/example-service/routes \\\n  --data \'hosts[]=example.com\'\n\n\nåºç­ç±»ä¼¼ä¸é¢å½¢å¼ï¼\n\nhttp/1.1 201 created\ncontent-type: application/json\nconnection: keep-alive\n\n{\n   "created_at":1519131139,\n   "strip_path":true,\n   "hosts":[\n      "example.com"\n   ],\n   "preserve_host":false,\n   "regex_priority":0,\n   "updated_at":1519131139,\n   "paths":null,\n   "service":{\n      "id":"79d7ee6e-9fc7-4b95-aa3b-61d2e17e7516"\n   },\n   "methods":null,\n   "protocols":[\n      "http",\n      "https"\n   ],\n   "id":"f9ce2ed7-c06e-4e16-bd5d-3a82daef3f9d"\n}\n\n\næ­¤æ¶ï¼kong å·²ç»å³æ³¨è¿ä¸ªæå¡ï¼å¹¶åå¤ä»£çè¯·æ±ã\n\nï¼3ï¼éè¿ kong è½¬åè¯·æ±\n\n$ curl -i -x get \\\n  --url http://localhost:8000/ \\\n  --header \'host: example.com\'\n\n\n\n# åèèµæ\n\nhttps://www.itcodemonkey.com/article/5980.html',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å¾®æå¡",frontmatter:{title:"å¾®æå¡",categories:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],tags:["åå¸å¼","åå¸å¼åºç¨","å¾®æå¡"],abbrlink:"460c1130",date:"2021-06-02T11:22:02.000Z",permalink:"/pages/7e2fd1/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/04.%E5%88%86%E5%B8%83%E5%BC%8F%E5%BA%94%E7%94%A8/01.%E5%BE%AE%E6%9C%8D%E5%8A%A1/",relativePath:"02.åå¸å¼/04.åå¸å¼åºç¨/01.å¾®æå¡/README.md",key:"v-55732b48",path:"/pages/7e2fd1/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:10},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:169},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:472}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# å¾®æå¡\n\n\n# ð åå®¹\n\n * å¾®æå¡åºæ¬åç - å³é®è¯ï¼å¾®æå¡ãåºååãå¨æä»£çãéä¿¡ãæå¡æ³¨ååç°ãå¥åº·æ£æ¥ãè·¯ç±ãè´è½½åè¡¡ãå®¹éå¤çãä¼éä¸çº¿ä¸çº¿ãéæµãçæ­ãä¸å¡åç»\n * RPC - å³é®è¯ï¼å¾®æå¡ãåºååãå¨æä»£çãéä¿¡ãæå¡æ³¨ååç°ãå¥åº·æ£æ¥ãè·¯ç±ãè´è½½åè¡¡ãå®¹éå¤çãä¼éä¸çº¿ä¸çº¿ãéæµãçæ­ãä¸å¡åç»\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * å¤§åç½ç«ç³»ç»ä¸ Java ä¸­é´ä»¶å®è·µ\n   * äº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»\n   * ä¼ä¸ IT æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æ - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * éæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n * æç¨\n   * system-design-primer\n\n\n# ðª ä¼ é\n\nâ¾ ð¯ æçåå®¢ â¾",normalizedContent:"# å¾®æå¡\n\n\n# ð åå®¹\n\n * å¾®æå¡åºæ¬åç - å³é®è¯ï¼å¾®æå¡ãåºååãå¨æä»£çãéä¿¡ãæå¡æ³¨ååç°ãå¥åº·æ£æ¥ãè·¯ç±ãè´è½½åè¡¡ãå®¹éå¤çãä¼éä¸çº¿ä¸çº¿ãéæµãçæ­ãä¸å¡åç»\n * rpc - å³é®è¯ï¼å¾®æå¡ãåºååãå¨æä»£çãéä¿¡ãæå¡æ³¨ååç°ãå¥åº·æ£æ¥ãè·¯ç±ãè´è½½åè¡¡ãå®¹éå¤çãä¼éä¸çº¿ä¸çº¿ãéæµãçæ­ãä¸å¡åç»\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * å¤§åç½ç«ç³»ç»ä¸ java ä¸­é´ä»¶å®è·µ\n   * äº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»\n   * ä¼ä¸ it æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æ - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * éæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n * æç¨\n   * system-design-primer\n\n\n# ðª ä¼ é\n\nâ¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åå¸å¼",frontmatter:{title:"åå¸å¼",categories:["åå¸å¼"],tags:["åå¸å¼"],abbrlink:"fe3c2cd2",date:"2019-03-08T13:16:53.000Z",permalink:"/pages/3cb60a/"},regularPath:"/02.%E5%88%86%E5%B8%83%E5%BC%8F/",relativePath:"02.åå¸å¼/README.md",key:"v-12aaaa7d",path:"/pages/3cb60a/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:70},{level:3,title:"åå¸å¼ç»¼å",slug:"åå¸å¼ç»¼å",normalizedTitle:"åå¸å¼ç»¼å",charIndex:80},{level:3,title:"åå¸å¼çè®º",slug:"åå¸å¼çè®º",normalizedTitle:"åå¸å¼çè®º",charIndex:102},{level:3,title:"åå¸å¼å³é®ææ¯",slug:"åå¸å¼å³é®ææ¯",normalizedTitle:"åå¸å¼å³é®ææ¯",charIndex:232},{level:4,title:"æµéè°åº¦",slug:"æµéè°åº¦",normalizedTitle:"æµéè°åº¦",charIndex:268},{level:4,title:"æ°æ®è°åº¦",slug:"æ°æ®è°åº¦",normalizedTitle:"æ°æ®è°åº¦",charIndex:463},{level:4,title:"èµæºè°åº¦",slug:"èµæºè°åº¦",normalizedTitle:"èµæºè°åº¦",charIndex:700},{level:4,title:"éä¿¡",slug:"éä¿¡",normalizedTitle:"éä¿¡",charIndex:717},{level:4,title:"æå¡æ²»ç",slug:"æå¡æ²»ç",normalizedTitle:"æå¡æ²»ç",charIndex:759},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:970},{level:3,title:"åå¸å¼çè®º",slug:"åå¸å¼çè®º-2",normalizedTitle:"åå¸å¼çè®º",charIndex:102},{level:3,title:"åå¸å¼ç®æ³",slug:"åå¸å¼ç®æ³",normalizedTitle:"åå¸å¼ç®æ³",charIndex:151},{level:3,title:"åå¸å¼æ¶æ",slug:"åå¸å¼æ¶æ",normalizedTitle:"åå¸å¼æ¶æ",charIndex:2016},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:2146}],headersStr:"ð åå®¹ åå¸å¼ç»¼å åå¸å¼çè®º åå¸å¼å³é®ææ¯ æµéè°åº¦ æ°æ®è°åº¦ èµæºè°åº¦ éä¿¡ æå¡æ²»ç ð èµæ åå¸å¼çè®º åå¸å¼ç®æ³ åå¸å¼æ¶æ ðª ä¼ é",content:"# åå¸å¼\n\n> å¤§åè½¯ä»¶ä¸ºäºåºå¯¹æµ·éæ°æ®ãé«å¹¶åï¼ä¸è¬é½ä¼è¢«è®¾è®¡ä¸ºåå¸å¼ç³»ç»ã\n> \n> åå¸å¼ç³»ç»éè¦è§£å³å¾å¤ä¸åé¢åçé®é¢ã\n\n\n# ð åå®¹\n\n\n# åå¸å¼ç»¼å\n\n * åå¸å¼é¢è¯æ»ç»\n\n\n# åå¸å¼çè®º\n\n * åå¸å¼çè®º - å³é®è¯ï¼æå åº­å°åãCAPãBASEãéè¯¯çåå¸å¼åè®¾\n * åå¸å¼ç®æ³ Paxos - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ Raft - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ Gossip - å³é®è¯ï¼æ°æ®ä¼ æ­\n\n\n# åå¸å¼å³é®ææ¯\n\n * éç¾¤\n * å¤å¶\n * ååº\n * éä¸»\n\n# æµéè°åº¦\n\n * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n * æå¡ç½å³\n * åå¸å¼ä¼è¯ - å³é®è¯ï¼ç²æ§ SessionãSession å¤å¶å±äº«ãåºäºç¼å­ç session å±äº«\n\n# æ°æ®è°åº¦\n\n * æ°æ®ç¼å­ - å³é®è¯ï¼è¿ç¨åç¼å­ãåå¸å¼ç¼å­ãç¼å­éªå´©ãç¼å­ç©¿éãç¼å­å»ç©¿ãç¼å­æ´æ°ãç¼å­é¢ç­ãç¼å­éçº§\n * è¯»ååç¦»\n * ååºåè¡¨ - å³é®è¯ï¼åçãè·¯ç±ãè¿ç§»ãæ©å®¹ãååãèå\n * åå¸å¼ ID - å³é®è¯ï¼UUIDãèªå¢åºåãéªè±ç®æ³ãLeaf\n * åå¸å¼äºå¡ - å³é®è¯ï¼2PCã3PCãTCCãæ¬å°æ¶æ¯è¡¨ãMQ æ¶æ¯ãSAGA\n * åå¸å¼é - å³é®è¯ï¼æ°æ®åºãRedisãZooKeeperãäºæ¥ãå¯éå¥ãæ­»éãå®¹éãèªæå°è¯\n\n# èµæºè°åº¦\n\n * å¼¹æ§ä¼¸ç¼©\n\n# éä¿¡\n\n * æ¶æ¯éå - å³é®è¯ï¼éå¤æ¶è´¹ãæ¶æ¯ä¸¢å¤±ãæ¶æ¯é¡ºåºæ§ãæ¶æ¯ç§¯å\n\n# æå¡æ²»ç\n\n * æå¡æ³¨åååç°\n * æå¡çæ§\n * æå¡é¾è·¯çæ§\n * æå¡å®¹é\n * æå¡ç¼æ\n * æå¡çæ¬ç®¡ç\n * æµéè°åº¦\n   * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n   * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n   * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n   * æå¡ç½å³\n\n\n# ð èµæ\n\n\n# åå¸å¼çè®º\n\n * The Google File Systemï¼Google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * Bigtable: A Distributed Storage System for Structured Dataï¼Google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * MapReduce: Simplifed Data Processing on Large Clustersï¼Google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * åå¸å¼ç³»ç»åçä¸èåï¼ä¹¦åå Distributed Systems Principles and Paradigmsãç»å¸åå¸å¼æç¨ï¼ä»ç»äºåå¸å¼ç³»ç»çä¸å¤§æ ¸å¿åçï¼å¹¶ç»åºäºå¤§éçä¾å­ï¼ç³»ç»è®²è¿°äºåå¸å¼ç³»ç»çæ¦å¿µåææ¯ï¼åæ¬éä¿¡ãè¿ç¨ãå½åãåæ­¥åãä¸è´æ§åå¤å¶ãå®¹éä»¥åå®å¨ç­ã\n * The fallacies of distributed computing\n * Distributed Systems for fun and profitï¼å¨ä¹¦åä¸ºäºç« ï¼è®²è¿°äºæ©å±æ§ãå¯ç¨æ§ãæ§è½åå®¹éç­åºç¡ç¥è¯ï¼FLP ä¸å¯è½æ§å CAP å®çï¼æ¢è®¨äºå¤§éçä¸è´æ§æ¨¡åï¼è®¨è®ºäºæ¶é´åé¡ºåºï¼åæ¶éçåç§ç¨æ³ãéåï¼æ¢è®¨äºå¤å¶é®é¢ï¼å¦ä½é²æ­¢å·®å¼ï¼ä»¥åå¦ä½æ¥åå·®å¼ãæ­¤å¤ï¼æ¯ç« æ«å°¾é½ç»åºäºéå¯¹æ¬ç« åå®¹çæ©å±éè¯»èµæºåè¡¨ï¼è¿äºèµææ¯å¯¹æ¬ä¹¦åå®¹çå¾å¥½è¡¥åã\n\n\n# åå¸å¼ç®æ³\n\n * Paxos\n   * Part-time Parliament è®ºæ - Lamport ç Paxos è®ºæãè¿ç¯è®ºæå¾æå¨ï¼ä½è¾ä¸ºæ¦æ¶©é¾æã\n   * Paxos Made Simple è®ºæ\n   * Paxos ç®æ³è¯¦è§£\n   * Neat Algorithms - Paxos\n   * Wiki - Paxos ç®æ³\n   * ä¸è´æ§ç®æ³ï¼PaxosãRaftãZabï¼\n   * Raft ä½èè®²è§£ Paxos è§é¢\n   * Paxos ç®æ³è®²è§£è§é¢\n * Raft\n   * Raft ä¸è´æ§ç®æ³è®ºæåæ\n   * Raft ä¸è´æ§ç®æ³è®ºæè¯æ\n   * Raft ä½èè®²è§£è§é¢\n   * Raft ä½èè®²è§£è§é¢å¯¹åºç PPT\n   * Raft ç®æ³è¯¦è§£\n   * Raft: Understandable Distributed Consensus - ä¸ä¸ªå¨ç»æç¨\n   * The Raft Consensus Algorithm - ä¸ä¸ªäº¤äºå¼å¨ç»æç¨\n\n\n# åå¸å¼æ¶æ\n\n * An introduction to distributed systems - è¿æ¯ä¸ä»½åå¸å¼ç³»ç»çæçº²æé¢çä»ç»ï¼å ä¹æ¶µçäºææç¥è¯ç¹ï¼å¹¶è¾ä»¥ç®æ´å¹¶åä¸­è¦å®³çè¯´ææå­ï¼éååå­¦èäºè§£ç¥è¯å¨è²ï¼å¿«éä¸ç°æç¥è¯ç»åï¼å½¢æç¥è¯ä½ç³»ã\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# åå¸å¼\n\n> å¤§åè½¯ä»¶ä¸ºäºåºå¯¹æµ·éæ°æ®ãé«å¹¶åï¼ä¸è¬é½ä¼è¢«è®¾è®¡ä¸ºåå¸å¼ç³»ç»ã\n> \n> åå¸å¼ç³»ç»éè¦è§£å³å¾å¤ä¸åé¢åçé®é¢ã\n\n\n# ð åå®¹\n\n\n# åå¸å¼ç»¼å\n\n * åå¸å¼é¢è¯æ»ç»\n\n\n# åå¸å¼çè®º\n\n * åå¸å¼çè®º - å³é®è¯ï¼æå åº­å°åãcapãbaseãéè¯¯çåå¸å¼åè®¾\n * åå¸å¼ç®æ³ paxos - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ raft - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ gossip - å³é®è¯ï¼æ°æ®ä¼ æ­\n\n\n# åå¸å¼å³é®ææ¯\n\n * éç¾¤\n * å¤å¶\n * ååº\n * éä¸»\n\n# æµéè°åº¦\n\n * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n * æå¡ç½å³\n * åå¸å¼ä¼è¯ - å³é®è¯ï¼ç²æ§ sessionãsession å¤å¶å±äº«ãåºäºç¼å­ç session å±äº«\n\n# æ°æ®è°åº¦\n\n * æ°æ®ç¼å­ - å³é®è¯ï¼è¿ç¨åç¼å­ãåå¸å¼ç¼å­ãç¼å­éªå´©ãç¼å­ç©¿éãç¼å­å»ç©¿ãç¼å­æ´æ°ãç¼å­é¢ç­ãç¼å­éçº§\n * è¯»ååç¦»\n * ååºåè¡¨ - å³é®è¯ï¼åçãè·¯ç±ãè¿ç§»ãæ©å®¹ãååãèå\n * åå¸å¼ id - å³é®è¯ï¼uuidãèªå¢åºåãéªè±ç®æ³ãleaf\n * åå¸å¼äºå¡ - å³é®è¯ï¼2pcã3pcãtccãæ¬å°æ¶æ¯è¡¨ãmq æ¶æ¯ãsaga\n * åå¸å¼é - å³é®è¯ï¼æ°æ®åºãredisãzookeeperãäºæ¥ãå¯éå¥ãæ­»éãå®¹éãèªæå°è¯\n\n# èµæºè°åº¦\n\n * å¼¹æ§ä¼¸ç¼©\n\n# éä¿¡\n\n * æ¶æ¯éå - å³é®è¯ï¼éå¤æ¶è´¹ãæ¶æ¯ä¸¢å¤±ãæ¶æ¯é¡ºåºæ§ãæ¶æ¯ç§¯å\n\n# æå¡æ²»ç\n\n * æå¡æ³¨åååç°\n * æå¡çæ§\n * æå¡é¾è·¯çæ§\n * æå¡å®¹é\n * æå¡ç¼æ\n * æå¡çæ¬ç®¡ç\n * æµéè°åº¦\n   * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n   * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n   * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n   * æå¡ç½å³\n\n\n# ð èµæ\n\n\n# åå¸å¼çè®º\n\n * the google file systemï¼google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * bigtable: a distributed storage system for structured dataï¼google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * mapreduce: simplifed data processing on large clustersï¼google ä¸å¤§ç»å¸è®ºæä¹ä¸\n * åå¸å¼ç³»ç»åçä¸èåï¼ä¹¦åå distributed systems principles and paradigmsãç»å¸åå¸å¼æç¨ï¼ä»ç»äºåå¸å¼ç³»ç»çä¸å¤§æ ¸å¿åçï¼å¹¶ç»åºäºå¤§éçä¾å­ï¼ç³»ç»è®²è¿°äºåå¸å¼ç³»ç»çæ¦å¿µåææ¯ï¼åæ¬éä¿¡ãè¿ç¨ãå½åãåæ­¥åãä¸è´æ§åå¤å¶ãå®¹éä»¥åå®å¨ç­ã\n * the fallacies of distributed computing\n * distributed systems for fun and profitï¼å¨ä¹¦åä¸ºäºç« ï¼è®²è¿°äºæ©å±æ§ãå¯ç¨æ§ãæ§è½åå®¹éç­åºç¡ç¥è¯ï¼flp ä¸å¯è½æ§å cap å®çï¼æ¢è®¨äºå¤§éçä¸è´æ§æ¨¡åï¼è®¨è®ºäºæ¶é´åé¡ºåºï¼åæ¶éçåç§ç¨æ³ãéåï¼æ¢è®¨äºå¤å¶é®é¢ï¼å¦ä½é²æ­¢å·®å¼ï¼ä»¥åå¦ä½æ¥åå·®å¼ãæ­¤å¤ï¼æ¯ç« æ«å°¾é½ç»åºäºéå¯¹æ¬ç« åå®¹çæ©å±éè¯»èµæºåè¡¨ï¼è¿äºèµææ¯å¯¹æ¬ä¹¦åå®¹çå¾å¥½è¡¥åã\n\n\n# åå¸å¼ç®æ³\n\n * paxos\n   * part-time parliament è®ºæ - lamport ç paxos è®ºæãè¿ç¯è®ºæå¾æå¨ï¼ä½è¾ä¸ºæ¦æ¶©é¾æã\n   * paxos made simple è®ºæ\n   * paxos ç®æ³è¯¦è§£\n   * neat algorithms - paxos\n   * wiki - paxos ç®æ³\n   * ä¸è´æ§ç®æ³ï¼paxosãraftãzabï¼\n   * raft ä½èè®²è§£ paxos è§é¢\n   * paxos ç®æ³è®²è§£è§é¢\n * raft\n   * raft ä¸è´æ§ç®æ³è®ºæåæ\n   * raft ä¸è´æ§ç®æ³è®ºæè¯æ\n   * raft ä½èè®²è§£è§é¢\n   * raft ä½èè®²è§£è§é¢å¯¹åºç ppt\n   * raft ç®æ³è¯¦è§£\n   * raft: understandable distributed consensus - ä¸ä¸ªå¨ç»æç¨\n   * the raft consensus algorithm - ä¸ä¸ªäº¤äºå¼å¨ç»æç¨\n\n\n# åå¸å¼æ¶æ\n\n * an introduction to distributed systems - è¿æ¯ä¸ä»½åå¸å¼ç³»ç»çæçº²æé¢çä»ç»ï¼å ä¹æ¶µçäºææç¥è¯ç¹ï¼å¹¶è¾ä»¥ç®æ´å¹¶åä¸­è¦å®³çè¯´ææå­ï¼éååå­¦èäºè§£ç¥è¯å¨è²ï¼å¿«éä¸ç°æç¥è¯ç»åï¼å½¢æç¥è¯ä½ç³»ã\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"UML å¿«éå¥é¨",frontmatter:{title:"UML å¿«éå¥é¨",date:"2019-03-06T00:00:00.000Z",categories:["è®¾è®¡","UML"],tags:["è®¾è®¡","UML"],permalink:"/pages/eae6a0/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/01.UML/01.UML%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html",relativePath:"03.è®¾è®¡/01.UML/01.UMLå¿«éå¥é¨.md",key:"v-6dbfe670",path:"/pages/eae6a0/",headers:[{level:2,title:"UML ç®ä»",slug:"uml-ç®ä»",normalizedTitle:"uml ç®ä»",charIndex:15},{level:3,title:"UML å¾ç±»å",slug:"uml-å¾ç±»å",normalizedTitle:"uml å¾ç±»å",charIndex:26},{level:4,title:"ç»æå¼å»ºæ¨¡å¾",slug:"ç»æå¼å»ºæ¨¡å¾",normalizedTitle:"ç»æå¼å»ºæ¨¡å¾",charIndex:54},{level:4,title:"è¡ä¸ºå¼å»ºæ¨¡å¾",slug:"è¡ä¸ºå¼å»ºæ¨¡å¾",normalizedTitle:"è¡ä¸ºå¼å»ºæ¨¡å¾",charIndex:227},{level:3,title:"UML æ¦å¿µ",slug:"uml-æ¦å¿µ",normalizedTitle:"uml æ¦å¿µ",charIndex:410},{level:2,title:"UML å·¥å·",slug:"uml-å·¥å·",normalizedTitle:"uml å·¥å·",charIndex:680},{level:3,title:"äº¿å¾",slug:"äº¿å¾",normalizedTitle:"äº¿å¾",charIndex:742},{level:3,title:"Visio",slug:"visio",normalizedTitle:"visio",charIndex:816},{level:3,title:"StarUML",slug:"staruml",normalizedTitle:"staruml",charIndex:868},{level:3,title:"Astah",slug:"astah",normalizedTitle:"astah",charIndex:920},{level:3,title:"ArgoUML",slug:"argouml",normalizedTitle:"argouml",charIndex:965},{level:3,title:"ProcessOn",slug:"processon",normalizedTitle:"processon",charIndex:1006},{level:3,title:"drawio",slug:"drawio",normalizedTitle:"drawio",charIndex:1058},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:1107}],headersStr:"UML ç®ä» UML å¾ç±»å ç»æå¼å»ºæ¨¡å¾ è¡ä¸ºå¼å»ºæ¨¡å¾ UML æ¦å¿µ UML å·¥å· äº¿å¾ Visio StarUML Astah ArgoUML ProcessOn drawio åèèµæ",content:"# UML å¿«éå¥é¨\n\n\n# UML ç®ä»\n\n\n# UML å¾ç±»å\n\nUML å¾ç±»åå¦ä¸å¾æç¤ºï¼\n\n\n\n# ç»æå¼å»ºæ¨¡å¾\n\n> ç»æå¼å»ºæ¨¡å¾ï¼Structure diagramsï¼å¼ºè°çæ¯ç³»ç»å¼çå»ºæ¨¡ãç»æå¾å®ä¹äºä¸ä¸ªæ¨¡åçéææ¶æãå®ä»¬éå¸¸è¢«ç¨æ¥å¯¹é£äºæææ¨¡åçâè¦ç´ 'å»ºæ¨¡ï¼è¯¸å¦ï¼ç±»ï¼å¯¹è±¡ï¼æ¥å£åç©çç»ä»¶ãå¦å¤ï¼å®ä»¬ä¹è¢«ç¨æ¥å¯¹åç´ é´å³èåä¾èµå³ç³»è¿è¡å»ºæ¨¡ã\n\n * ç±»å¾\n * å¯¹è±¡å¾\n * åå¾\n * ç»ä»¶å¾\n * é¨ç½²å¾\n * å¤åç»æå¾\n\n# è¡ä¸ºå¼å»ºæ¨¡å¾\n\n> è¡ä¸ºå¼å»ºæ¨¡å¾ï¼Behavior diagramsï¼å¼ºè°ç³»ç»æ¨¡åä¸­è§¦åçäºãè¡ä¸ºå¾ç¨æ¥è®°å½å¨ä¸ä¸ªæ¨¡ååé¨ï¼éæ¶é´çååï¼æ¨¡åæ§è¡çäº¤äºåååç¬é´çç¶æï¼å¹¶è·è¸ªç³»ç»å¨çå®ç¯å¢ä¸å¦ä½è¡¨ç°ï¼ä»¥åè§å¯ç³»ç»å¯¹ä¸ä¸ªæä½æäºä»¶çååºï¼ä»¥åå®çç»æã\n\n * æ´»å¨å¾\n * ç¶æå¾\n * ç¨ä¾å¾\n * éä¿¡å¾\n * äº¤äºæ¦è¿°å¾\n * æ¶åºå¾\n * æ¶é´å¾\n\n\n# UML æ¦å¿µ\n\nUML ä»æ¥æºä¸­ä½¿ç¨ç¸å½å¤çæ¦å¿µãæä»¬å°ä¹å®ä¹äºç»ä¸å»ºæ¨¡è¯­è¨æ¯è¯­æ±è¡¨ãä¸é¢ä»åä»£è¡¨æ§çæ¦å¿µã\n\n * å¯¹äºç»æèè¨ - æ§è¡èï¼å±æ§ï¼ç±»ï¼åä»¶ï¼æ¥å£ï¼å¯¹è±¡ï¼åã\n * å¯¹äºè¡ä¸ºèè¨ - æ´»å¨ï¼UMLï¼ï¼äºä»¶ï¼UMLï¼ï¼æ¶æ¯ï¼UMLï¼ï¼æ¹æ³ï¼UMLï¼ï¼æä½ï¼UMLï¼ï¼ç¶æï¼UMLï¼ï¼ç¨ä¾ï¼UMLï¼ã\n * å¯¹äºå³ç³»èè¨ - èåï¼å³èï¼ç»åï¼ç¸ä¾ï¼å¹¿ä¹åï¼or ç»§æ¿ï¼ã\n * å¶ä»æ¦å¿µ\n   * æé åâè¿è§èç¬¦å·åºç¨å°çæ¨¡å\n   * å¤éæ§âå¤éæ§æ è®°æ³ä¸èµæåºå»ºæ¨¡åºæ°å¯¹åºï¼ä¾å¦ï¼1, 0..1, 1..*\n\n\n# UML å·¥å·\n\nUML å·¥å·éå¸¸å¤ï¼å°åºåªç§å·¥å·å¥½ï¼ççæ¯ä»èè§ä»æºèè§æºãè¿éåä¸¾ä¸äºææ¥è§¦è¿ç UML å·¥å·ï¼\n\n\n# äº¿å¾\n\n> å½åå¼åçãæ¶è´¹çç»å¾å·¥å·ãå¾å½¢æ¨¡æ¿ãç´ æéå¸¸å¨é¢ï¼æ ·å¼ä¹å¾ç²¾ç¾ï¼å¯ä»¥å¯¼åºä¸º wordãpdfãå¾çã\n> \n> äº¿å¾å®ç½\n\n\n\n\n# Visio\n\n> Office çç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®åãæ¸æ°ã\n> \n> Visio å®ç½\n\n\n\n\n# StarUML\n\n> æ ·å¼ç²¾ç¾ï¼åè½å¨é¢ç UML å·¥å·ã\n> \n> StarUML å®ç½\n\n\n\n\n# Astah\n\n> æ ·å¼ä¸éï¼åè½å¨é¢çç»å¾å·¥å·ã\n> \n> Astah å®ç½\n\n\n\n\n# ArgoUML\n\n> UML å·¥å·ã\n> \n> ArgoUML å®ç½\n\n\n\n\n# ProcessOn\n\n> å¨çº¿ç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®æ´ãæ¸æ°ã\n> \n> ProcessOn å®ç½\n\n\n# drawio\n\n> å¼æºçå¨çº¿ç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®æ´ãæ¸æ°ã\n> \n> drawio å®ç½\n\n\n# åèèµæ\n\n * Wiki-UML\n * Sparx UML æç¨\n * OMG UML\n * UML Tutorial\n * W3Cschool UML æç¨\n * UML å­¦ä¹ å¥é¨å°±è¿ä¸ç¯æç« \n * http://www.cnblogs.com/ywqu/category/223486.html",normalizedContent:"# uml å¿«éå¥é¨\n\n\n# uml ç®ä»\n\n\n# uml å¾ç±»å\n\numl å¾ç±»åå¦ä¸å¾æç¤ºï¼\n\n\n\n# ç»æå¼å»ºæ¨¡å¾\n\n> ç»æå¼å»ºæ¨¡å¾ï¼structure diagramsï¼å¼ºè°çæ¯ç³»ç»å¼çå»ºæ¨¡ãç»æå¾å®ä¹äºä¸ä¸ªæ¨¡åçéææ¶æãå®ä»¬éå¸¸è¢«ç¨æ¥å¯¹é£äºæææ¨¡åçâè¦ç´ 'å»ºæ¨¡ï¼è¯¸å¦ï¼ç±»ï¼å¯¹è±¡ï¼æ¥å£åç©çç»ä»¶ãå¦å¤ï¼å®ä»¬ä¹è¢«ç¨æ¥å¯¹åç´ é´å³èåä¾èµå³ç³»è¿è¡å»ºæ¨¡ã\n\n * ç±»å¾\n * å¯¹è±¡å¾\n * åå¾\n * ç»ä»¶å¾\n * é¨ç½²å¾\n * å¤åç»æå¾\n\n# è¡ä¸ºå¼å»ºæ¨¡å¾\n\n> è¡ä¸ºå¼å»ºæ¨¡å¾ï¼behavior diagramsï¼å¼ºè°ç³»ç»æ¨¡åä¸­è§¦åçäºãè¡ä¸ºå¾ç¨æ¥è®°å½å¨ä¸ä¸ªæ¨¡ååé¨ï¼éæ¶é´çååï¼æ¨¡åæ§è¡çäº¤äºåååç¬é´çç¶æï¼å¹¶è·è¸ªç³»ç»å¨çå®ç¯å¢ä¸å¦ä½è¡¨ç°ï¼ä»¥åè§å¯ç³»ç»å¯¹ä¸ä¸ªæä½æäºä»¶çååºï¼ä»¥åå®çç»æã\n\n * æ´»å¨å¾\n * ç¶æå¾\n * ç¨ä¾å¾\n * éä¿¡å¾\n * äº¤äºæ¦è¿°å¾\n * æ¶åºå¾\n * æ¶é´å¾\n\n\n# uml æ¦å¿µ\n\numl ä»æ¥æºä¸­ä½¿ç¨ç¸å½å¤çæ¦å¿µãæä»¬å°ä¹å®ä¹äºç»ä¸å»ºæ¨¡è¯­è¨æ¯è¯­æ±è¡¨ãä¸é¢ä»åä»£è¡¨æ§çæ¦å¿µã\n\n * å¯¹äºç»æèè¨ - æ§è¡èï¼å±æ§ï¼ç±»ï¼åä»¶ï¼æ¥å£ï¼å¯¹è±¡ï¼åã\n * å¯¹äºè¡ä¸ºèè¨ - æ´»å¨ï¼umlï¼ï¼äºä»¶ï¼umlï¼ï¼æ¶æ¯ï¼umlï¼ï¼æ¹æ³ï¼umlï¼ï¼æä½ï¼umlï¼ï¼ç¶æï¼umlï¼ï¼ç¨ä¾ï¼umlï¼ã\n * å¯¹äºå³ç³»èè¨ - èåï¼å³èï¼ç»åï¼ç¸ä¾ï¼å¹¿ä¹åï¼or ç»§æ¿ï¼ã\n * å¶ä»æ¦å¿µ\n   * æé åâè¿è§èç¬¦å·åºç¨å°çæ¨¡å\n   * å¤éæ§âå¤éæ§æ è®°æ³ä¸èµæåºå»ºæ¨¡åºæ°å¯¹åºï¼ä¾å¦ï¼1, 0..1, 1..*\n\n\n# uml å·¥å·\n\numl å·¥å·éå¸¸å¤ï¼å°åºåªç§å·¥å·å¥½ï¼ççæ¯ä»èè§ä»æºèè§æºãè¿éåä¸¾ä¸äºææ¥è§¦è¿ç uml å·¥å·ï¼\n\n\n# äº¿å¾\n\n> å½åå¼åçãæ¶è´¹çç»å¾å·¥å·ãå¾å½¢æ¨¡æ¿ãç´ æéå¸¸å¨é¢ï¼æ ·å¼ä¹å¾ç²¾ç¾ï¼å¯ä»¥å¯¼åºä¸º wordãpdfãå¾çã\n> \n> äº¿å¾å®ç½\n\n\n\n\n# visio\n\n> office çç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®åãæ¸æ°ã\n> \n> visio å®ç½\n\n\n\n\n# staruml\n\n> æ ·å¼ç²¾ç¾ï¼åè½å¨é¢ç uml å·¥å·ã\n> \n> staruml å®ç½\n\n\n\n\n# astah\n\n> æ ·å¼ä¸éï¼åè½å¨é¢çç»å¾å·¥å·ã\n> \n> astah å®ç½\n\n\n\n\n# argouml\n\n> uml å·¥å·ã\n> \n> argouml å®ç½\n\n\n\n\n# processon\n\n> å¨çº¿ç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®æ´ãæ¸æ°ã\n> \n> processon å®ç½\n\n\n# drawio\n\n> å¼æºçå¨çº¿ç»å¾å·¥å·ï¼ç¹ç¹æ¯ç®æ´ãæ¸æ°ã\n> \n> drawio å®ç½\n\n\n# åèèµæ\n\n * wiki-uml\n * sparx uml æç¨\n * omg uml\n * uml tutorial\n * w3cschool uml æç¨\n * uml å­¦ä¹ å¥é¨å°±è¿ä¸ç¯æç« \n * http://www.cnblogs.com/ywqu/category/223486.html",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"UML ç»æå»ºæ¨¡å¾",frontmatter:{title:"UML ç»æå»ºæ¨¡å¾",date:"2018-10-26T17:39:34.000Z",categories:["è®¾è®¡","UML"],tags:["è®¾è®¡","UML"],permalink:"/pages/97f796/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/01.UML/02.UML%E7%BB%93%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9B%BE.html",relativePath:"03.è®¾è®¡/01.UML/02.UMLç»æå»ºæ¨¡å¾.md",key:"v-43c755b4",path:"/pages/97f796/",headers:[{level:2,title:"é¨ç½²å¾",slug:"é¨ç½²å¾",normalizedTitle:"é¨ç½²å¾",charIndex:104},{level:3,title:"èç¹",slug:"èç¹",normalizedTitle:"èç¹",charIndex:223},{level:3,title:"èç¹å®ä¾",slug:"èç¹å®ä¾",normalizedTitle:"èç¹å®ä¾",charIndex:270},{level:3,title:"èç¹æé å",slug:"èç¹æé å",normalizedTitle:"èç¹æé å",charIndex:365},{level:3,title:"å·¥ä»¶",slug:"å·¥ä»¶",normalizedTitle:"å·¥ä»¶",charIndex:552},{level:3,title:"å³è",slug:"å³è",normalizedTitle:"å³è",charIndex:82},{level:3,title:"ä½ä¸ºå®¹å¨çèç¹",slug:"ä½ä¸ºå®¹å¨çèç¹",normalizedTitle:"ä½ä¸ºå®¹å¨çèç¹",charIndex:740},{level:2,title:"ç»ä»¶å¾",slug:"ç»ä»¶å¾",normalizedTitle:"ç»ä»¶å¾",charIndex:109},{level:3,title:"è¡¨ç°ç»ä»¶",slug:"è¡¨ç°ç»ä»¶",normalizedTitle:"è¡¨ç°ç»ä»¶",charIndex:1168},{level:3,title:"è£éè¿æ¥å¨",slug:"è£éè¿æ¥å¨",normalizedTitle:"è£éè¿æ¥å¨",charIndex:949},{level:3,title:"å¸¦ç«¯å£ç»ä»¶",slug:"å¸¦ç«¯å£ç»ä»¶",normalizedTitle:"å¸¦ç«¯å£ç»ä»¶",charIndex:1323},{level:2,title:"åå¾",slug:"åå¾",normalizedTitle:"åå¾",charIndex:114},{level:2,title:"ç±»å¾",slug:"ç±»å¾",normalizedTitle:"ç±»å¾",charIndex:118},{level:3,title:"ç±»ï¼Classesï¼",slug:"ç±»-classes",normalizedTitle:"ç±»ï¼classesï¼",charIndex:2371},{level:3,title:"ç±»çæ æ±ï¼Class Notationï¼",slug:"ç±»çæ æ±-class-notation",normalizedTitle:"ç±»çæ æ±ï¼class notationï¼",charIndex:2452},{level:3,title:"æ¥å£ï¼Interfacesï¼",slug:"æ¥å£-interfaces",normalizedTitle:"æ¥å£ï¼interfacesï¼",charIndex:2746},{level:3,title:"è¡¨ï¼Tablesï¼",slug:"è¡¨-tables",normalizedTitle:"è¡¨ï¼tablesï¼",charIndex:2918},{level:3,title:"å³èï¼Associationsï¼",slug:"å³è-associations",normalizedTitle:"å³èï¼associationsï¼",charIndex:3119},{level:3,title:"æ³åï¼Generalizationsï¼",slug:"æ³å-generalizations",normalizedTitle:"æ³åï¼generalizationsï¼",charIndex:2143},{level:3,title:"èåï¼Aggregationsï¼",slug:"èå-aggregations",normalizedTitle:"èåï¼aggregationsï¼",charIndex:3518},{level:3,title:"å³èç±»ï¼Association Classesï¼",slug:"å³èç±»-association-classes",normalizedTitle:"å³èç±»ï¼association classesï¼",charIndex:3963},{level:3,title:"ä¾èµï¼Dependenciesï¼",slug:"ä¾èµ-dependencies",normalizedTitle:"ä¾èµï¼dependenciesï¼",charIndex:4169},{level:3,title:"è·è¸ªï¼Tracesï¼",slug:"è·è¸ª-traces",normalizedTitle:"è·è¸ªï¼tracesï¼",charIndex:4352},{level:3,title:"å®ç°ï¼Realizationsï¼",slug:"å®ç°-realizations",normalizedTitle:"å®ç°ï¼realizationsï¼",charIndex:4490},{level:3,title:"åµå¥ï¼Nestingsï¼",slug:"åµå¥-nestings",normalizedTitle:"åµå¥ï¼nestingsï¼",charIndex:4667},{level:2,title:"å¤åç»æå¾",slug:"å¤åç»æå¾",normalizedTitle:"å¤åç»æå¾",charIndex:122},{level:3,title:"é¨ä»¶",slug:"é¨ä»¶",normalizedTitle:"é¨ä»¶",charIndex:3667},{level:3,title:"ç«¯å£",slug:"ç«¯å£",normalizedTitle:"ç«¯å£",charIndex:1324},{level:3,title:"æ¥å£",slug:"æ¥å£",normalizedTitle:"æ¥å£",charIndex:61},{level:3,title:"å§æ",slug:"å§æ",normalizedTitle:"å§æ",charIndex:5559},{level:3,title:"åä½",slug:"åä½",normalizedTitle:"åä½",charIndex:1703},{level:3,title:"è§è²ç»å®",slug:"è§è²ç»å®",normalizedTitle:"è§è²ç»å®",charIndex:5773},{level:3,title:"è¡¨ç°",slug:"è¡¨ç°",normalizedTitle:"è¡¨ç°",charIndex:1168},{level:2,title:"å¯¹è±¡å¾",slug:"å¯¹è±¡å¾",normalizedTitle:"å¯¹è±¡å¾",charIndex:129},{level:3,title:"ç±»åå¯¹è±¡åç´ ",slug:"ç±»åå¯¹è±¡åç´ ",normalizedTitle:"ç±»åå¯¹è±¡åç´ ",charIndex:6074},{level:3,title:"è¿è¡ç¶æ",slug:"è¿è¡ç¶æ",normalizedTitle:"è¿è¡ç¶æ",charIndex:6188},{level:3,title:"ç±»åå¯¹è±¡å¾ç¤ºä¾",slug:"ç±»åå¯¹è±¡å¾ç¤ºä¾",normalizedTitle:"ç±»åå¯¹è±¡å¾ç¤ºä¾",charIndex:6259},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:6392}],headersStr:"é¨ç½²å¾ èç¹ èç¹å®ä¾ èç¹æé å å·¥ä»¶ å³è ä½ä¸ºå®¹å¨çèç¹ ç»ä»¶å¾ è¡¨ç°ç»ä»¶ è£éè¿æ¥å¨ å¸¦ç«¯å£ç»ä»¶ åå¾ ç±»å¾ ç±»ï¼Classesï¼ ç±»çæ æ±ï¼Class Notationï¼ æ¥å£ï¼Interfacesï¼ è¡¨ï¼Tablesï¼ å³èï¼Associationsï¼ æ³åï¼Generalizationsï¼ èåï¼Aggregationsï¼ å³èç±»ï¼Association Classesï¼ ä¾èµï¼Dependenciesï¼ è·è¸ªï¼Tracesï¼ å®ç°ï¼Realizationsï¼ åµå¥ï¼Nestingsï¼ å¤åç»æå¾ é¨ä»¶ ç«¯å£ æ¥å£ å§æ åä½ è§è²ç»å® è¡¨ç° å¯¹è±¡å¾ ç±»åå¯¹è±¡åç´  è¿è¡ç¶æ ç±»åå¯¹è±¡å¾ç¤ºä¾ åèèµæ",content:'# UML ç»æå»ºæ¨¡å¾\n\n> ç»æå¾å®ä¹äºä¸ä¸ªæ¨¡åçéææ¶æãå®ä»¬éå¸¸è¢«ç¨æ¥å¯¹é£äºæææ¨¡åçâè¦ç´ \'å»ºæ¨¡ï¼è¯¸å¦ï¼ç±»ï¼å¯¹è±¡ï¼æ¥å£åç©çç»ä»¶ãå¦å¤ï¼å®ä»¬ä¹è¢«ç¨æ¥å¯¹åç´ é´å³èåä¾èµå³ç³»è¿è¡å»ºæ¨¡ã\n> \n> å³é®è¯ï¼é¨ç½²å¾, ç»ä»¶å¾, åå¾, ç±»å¾, å¤åç»æå¾, å¯¹è±¡å¾\n\n\n# é¨ç½²å¾\n\n> é¨ç½²å¾ï¼Deployment Diagramï¼ç¨äºå¯¹ç³»ç»çç©çç»æå»ºæ¨¡ãé¨ç½²å¾å°æ¾ç¤ºç³»ç»ä¸­çè½¯ä»¶ç»ä»¶åç¡¬ä»¶ç»ä»¶ä¹é´çå³ç³»ä»¥åå¤çå·¥ä½çç©çåå¸ã\n\n\n\n\n# èç¹\n\nèç¹æ¢å¯ä»¥æ¯ç¡¬ä»¶åç´ ï¼ä¹å¯ä»¥æ¯è½¯ä»¶åç´ ãå®æ¾ç¤ºä¸ºä¸ä¸ªç«æ¹ä½ï¼å¦ä¸å¾æç¤ºã\n\n\n\n\n# èç¹å®ä¾\n\nå¾å¯ä»¥æ¾ç¤ºèç¹å®ä¾ï¼å®ä¾ä¸èç¹çåºåæ¯ï¼å®ä¾çåç§°å¸¦ä¸åçº¿ï¼åå·æ¾å¨å®çåºæ¬èç¹ç±»åä¹åãå®ä¾å¨åå·ä¹åå¯ä»¥æåç§°ï¼ä¹å¯ä»¥æ²¡æåç§°ãä¸å¾æ¾ç¤ºäºä¸ä¸ªå·åçè®¡ç®æºå®ä¾ã\n\n\n\n\n# èç¹æé å\n\nä¸ºèç¹æä¾äºè®¸å¤æ åçæé åï¼åå«å½åä¸º Â«cdromÂ»ï¼ Â«cd-romÂ»ï¼ Â«computerÂ»ï¼ Â«disk arrayÂ»ï¼ Â«pcÂ»ï¼ Â«pc clientÂ»ï¼ Â«pc serverÂ»ï¼ Â«secureÂ»ï¼ Â«serverÂ»ï¼ Â«storageÂ»ï¼ Â«unix serverÂ»ï¼ Â«user pcÂ»ã å¹¶å¨èç¹ç¬¦å·çå³ä¸è§æ¾ç¤ºéå½çå¾æ ã\n\n\n\n\n# å·¥ä»¶\n\nå·¥ä»¶æ¯è½¯ä»¶å¼åè¿ç¨ä¸­çäº§åãåæ¬è¿ç¨æ¨¡åï¼å¦ï¼ç¨ä¾æ¨¡åï¼è®¾è®¡æ¨¡åç­ï¼ï¼æºæä»¶ï¼æ§è¡æä»¶ï¼è®¾è®¡ææ¡£ï¼æµè¯æ¥åï¼æé åï¼ç¨æ·æåç­ç­ã\n\nå·¥ä»¶è¡¨ç¤ºä¸ºå¸¦æå·¥ä»¶åç§°çç©å½¢ï¼å¹¶æ¾ç¤ºÂ«artifactÂ»å³é®å­åææ¡£ç¬¦å·ã\n\n\n\n\n# å³è\n\nå¨é¨ç½²å¾çä¸ä¸æèç³»ä¸­ï¼å³èä»£è¡¨èç¹é´çèç³»ééãä¸å¾æ¾ç¤ºäºä¸ä¸ªç½ç»ç³»ç»çé¨ç½²å¾ï¼æè¿°äºç½ç»åè®®ä¸ºæé ååå³èç»ç«¯çå¤éæ§ï¼\n\n\n\n\n# ä½ä¸ºå®¹å¨çèç¹\n\nèç¹å¯ä»¥åå«å¶ä»åç´ ï¼å¦ç»ä»¶åå·¥ä»¶ãä¸å¾æ¾ç¤ºäºä¸ä¸ªåµå¥å¼ç³»ç»æä¸ªé¨åçé¨ç½²å¾ãæåäºä¸ä¸ªè¢«ä¸»æ¿èç¹åå«çå¯æ§è¡å·¥ä»¶ã\n\n\n\n\n# ç»ä»¶å¾\n\n> ç»ä»¶å¾ï¼Component Diagramï¼æç»äºç»æä¸ä¸ªè½¯ä»¶ç³»ç»çæ¨¡åååµå¥æ§ä»¶ãç»ä»¶å¾æ¯ç±»å¾å·ææ´é«å±æ¬¡çæ½è±¡ï¼éå¸¸è¿è¡æ¶ä¸ä¸ªç»ä»¶è¢«ä¸ä¸ªæå¤ä¸ªç±»ï¼æå¯¹è±¡ï¼å®ç°ãå®ä»¬è±¡ç§¯æ¨é£æ ·ä½¿å¾ç»ä»¶è½æç»ææç³»ç»çç»å¤§é¨åã\n\n\n\nä¸å¾æ¼ç¤ºäºä¸äºç»ä»¶åå®ä»¬çåé¨å³ç³»ãè£éè¿æ¥å¨ï¼Assembly connectorsï¼âè¿æ¥âç±"Product"å"Customer"çæä¾æ¥å£å°ç± "Order"æå®çéæ±æ¥å£ã ä¸ä¸ªä¾èµå³ç³»æ å°äºå®¢æ·ç¸å³çå¸æ·ä¿¡æ¯å°âOrderâéè¦ç "Payment"éæ±æ¥å£ã\n\nå®éä¸ï¼ç»ä»¶å¾ååå¾å¾ç¸ä¼¼ï¼å®ä»¬é½ææç¡®ççéï¼æåç´ åç»å°é»è¾ç»æä¸­ãä»ä»¬ä¹é´çä¸åæ¯ï¼ç»ä»¶å¾æä¾äºè¯­ä¹æ´ä¸°å¯çåç»æºå¶ï¼å¨ç»ä»¶å¾ä¸­ï¼ææçæ¨¡ååç´ é½æ¯ç§æçï¼èåå¾åªæ¾ç¤ºå¬æçæåã\n\n\n# è¡¨ç°ç»ä»¶\n\nç»ä»¶å¯è¡¨ç¤ºä¸ºå¸¦å³é®å­ Â«componentÂ»çç©å½¢ç±»åï¼ä¹å¯ç¨å³ä¸è§æç»ä»¶å¾æ çç©å½¢è¡¨ç¤ºã\n\n\n\n\n# è£éè¿æ¥å¨\n\nè£éè¿æ¥å¨å¨ç»ä»¶ âComponent1âçéæ±æ¥å£åå¦ä¸ä¸ªç»ä»¶ âComponent2âçæä¾æ¥å£ä¹é´å»ºç«æ¡¥æ¢; è¿ä¸ªæ¡¥æ¢ä½¿å¾ä¸ä¸ªç»ä»¶è½æä¾å¦ä¸ä¸ªç»ä»¶æéè¦çæå¡ã\n\n\n\n\n# å¸¦ç«¯å£ç»ä»¶\n\nä½¿ç¨ç«¯å£çç»ä»¶å¾åè®¸å¨å®çç¯å¢æå®ä¸ä¸ªæå¡åè¡ä¸ºï¼åæ¶è¿ä¸ªæå¡åè¡ä¸ºä¹æ¯ç»ä»¶éè¦çãå½ç«¯å£è¿è¡ååæä½çæ¶åï¼å®å¯ä»¥æå®è¾å¥åè¾åºãä¸å¾è¯¦è¿°äºç¨äºå¨çº¿æå¡çå¸¦ç«¯å£ç»ä»¶ï¼å®æä¸¤ä¸ªæä¾æ¥å£ âorder entryâå âtrackingâï¼ä¹æ âpaymentâ éæ±æ¥å£ã\n\n\n\n\n# åå¾\n\n> åå¾ï¼Package Diagramï¼ç¨æ¥è¡¨ç°ååå®æåå«åç´ çç»ç»ãå½ç¨æ¥ä»£è¡¨ç±»åç´ æ¶ï¼åå¾æä¾äºå½åç©ºé´çå¯è§åãåå¾æå¸¸ç¨çç¨éæ¯ç¨æ¥ç»ç»ç¨ä¾å¾åç±»å¾ï¼å°½ç®¡å®ä¸å±éäºè¿äº UML åç´ ã\n\nä¸é¢æ¯ä¸ä¸ªåå¾çä¾å­ã\n\n\n\nåä¸­çåç´ å±äº«ç¸åçå½åç©ºé´ï¼å æ­¤ï¼ä¸ä¸ªæå®å½åç©ºé´çåç´ å¿é¡»æå¯ä¸çåç§°ã\n\nåå¯ä»¥ç¨æ¥ä»£è¡¨ç©çæé»è¾å³ç³»ãéæ©æç±»åæ¬å¨æå®çåéï¼æå©äºå¨åä¸ä¸ªåéèµäºè¿äºç±»ç¸åç»§æ¿å±æ¬¡ãéå¸¸è®¤ä¸ºæéè¿å¤åç¸å³èçç±»ï¼ä»¥åä¸å®ä»¬ç¸åä½çç±»æ¾å¨åä¸ä¸ªåéã\n\n\n\nå¨ UML2.5 ä¸­ï¼åç¨æä»¶å¤¹æ¥è¡¨ç¤ºï¼åä¸­çåç´ å±äº«åä¸ä¸ªå½åç©ºé´ï¼å¹¶ä¸å¿é¡»æ¯å¯è¯å«çï¼å æ­¤è¦æå¯ä¸çåç§°æç±»åãåå¿é¡»æ¾ç¤ºååï¼å¨éå±æ¹æ¡é¨åæéæ©çæ¾ç¤ºååçåç´ ã\n\n * åçåå¹¶ - åä¹é´çåå¹¶è¿æ¥ç¬¦Â«mergeÂ»å®ä¹äºæºååç´ ä¸ç®æ ååååç´ ä¹é´çæ³åå³ç³»ãæºååç´ çå®ä¹è¢«æ©å±æ¥åå«ç®æ ååç´ å®ä¹ãå½æºååç´ ä¸ç®æ ååæ²¡æåååç´ æ¶ï¼ç®æ ååç´ çå®ä¹ä¸åå½±åã\n * åçå¯¼å¥ - å¯¼å¥è¿æ¥ç¬¦ Â«importÂ»è¡¨æç®æ åçåç´ ï¼å¨è¯¥ä¾ä¸­æ¯ä¸ä¸ªç±» ï¼å¨æºåä¸­è¢«å¼ç¨è¦ç¨ééå®ä¿®é¥°åãæºåçå½åç©ºé´è·å¾ç®æ ç±»çæ¥å£ï¼ç®æ åçå½åç©ºé´åä¸åå½±åã\n * åµå¥è¿æ¥ç¬¦ - æºååç®æ åé´çåµå¥è¿æ¥ç¬¦è¯´æç®æ åå®å¨åå«æºåã\n\n\n# ç±»å¾\n\n> ç±»å¾ï¼Class Diagramï¼å±ç¤ºäºé¢åå¯¹è±¡ç³»ç»çæé æ¨¡åãæç»äºæ¨¡åæé¨åæ¨¡åçéæè§å¾ï¼æ¾ç¤ºå®åå«çå±æ§åè¡ä¸ºï¼èä¸æ¯è¯¦ç»æè¿°æä½çåè½æå®åæ¹æ³ãç±»å¾æå¸¸ç¨æ¥è¡¨è¾¾å¤ä¸ªç±»åæ¥å£ä¹é´çå³ç³»ãæ³åï¼Generalizationsï¼ï¼èåï¼aggregationsï¼åå³èï¼associationsï¼åå«æ¯ç±»ä¹é´ç»§æ¿ï¼å¤åæåºç¨ï¼åè¿æ¥çè¡¨ç°ã\n\nä¸é¢çå¾æ¾ç¤ºäºç±»ä¹é´çèåå³ç³»ãå¼±èåï¼æµè²ç®­å¤´ï¼è¡¨ç°å¨ç±» "Account" ä½¿ç¨ "AddressBook"ï¼ä½æ¯ä¸å¿è¦åå«å®çä¸ä¸ªå®ä¾ãå¼ºèåï¼å¾ä¸­çé»è²ç®­å¤´ï¼è¡¨ç¤ºäºç®æ ç±»åå«æºç±»ï¼ä¾å¦ï¼"Contact" å "ContactGroup"å¼è¢«åå«å¨ "AddressBook"ä¸­ã\n\n\n\n\n# ç±»ï¼Classesï¼\n\nç±»æ¯å®ä¹å¯¹è±¡æå·æçå±æ§åè¡ä¸ºçåç´ ãè¡ä¸ºç¨ç±»è½çè§£çåéæ¶æ¯åéåæ¯æ¡æ¶æ¯çæä½æ¥æè¿°ã ç±»ä¸­ä¹å¯è½å®ä¹çº¦æï¼æ è®°å¼ï¼æé åã\n\n\n# ç±»çæ æ±ï¼Class Notationï¼\n\nç±»ç¨ç©å½¢è¡¨ç¤ºãé¤ç±»çåç§°å¤ï¼è¿å¯ä»¥éæ©æ§å°æ¾ç¤ºå±æ§åæä½ã åæ åå«ç¨æ¥æ¾ç¤ºç±»çåç§°ï¼å±æ§åæä½ã\n\nå¨ä¸é¢å¾ä¸­ï¼ç±»çç±»åæ¾ç¤ºå¨æä¸é¢çåæ ï¼å®ä¸é¢çåæ æ¾ç¤ºè¯¦ç»å±æ§ï¼å¦ï¼"center" å±æ§æ¾ç¤ºåå§åçå¼ãæåé¢çåæ æ¾ç¤ºæä½ï¼å¦ï¼ setWidthï¼setLength å setPosition ä»¥åä»ä»¬çåæ°ã å±æ§åæä½ååçæ æ³¨è¡¨ç¤ºäºè¯¥å±æ§ææä½çå¯è§æ§: å¦æä½¿ç¨ "+"å·ï¼è¿ä¸ªå±æ§ææä½æ¯å¬å±ç ; "-" å·åä»£è¡¨è¿ä¸ªå±æ§ææä½æ¯ç§æçã "#"å·æ¯è¿ä¸ªå±æ§ææä½è¢«å®ä¹ä¸ºä¿æ¤çï¼" ~" å·ä»£è¡¨åçå¯è§æ§ã\n\n\n\n\n# æ¥å£ï¼Interfacesï¼\n\næ¥å£æ¯å®æ½èåææ»¡è¶³çè¡ä¸ºè§èï¼æ¯ä¸ç§çº¦å®ãå®ç°ä¸ä¸ªæ¥å£ï¼ç±»å¿éæ¯æå¶è¦æ±çè¡ä¸ºï¼ä½¿ç³»ç»æç§åæ ·çæ¹å¼ï¼å³å¬å±çæ¥å£ï¼å¤çä¸ç¸å³çåç´ ã\n\n\n\næ¥å£æç¸ä¼¼äºç±»çå¤å½¢é£æ ¼ï¼å«ææå®çæä½ï¼å¦ä¸å¾æç¤ºãå¦ææ²¡ææç¡®çè¯¦ç»æä½ï¼ä¹å¯ä»¥ç»æä¸ä¸ªåç¯ãå½ç»æåç¯çæ¶åï¼å°è¿ä¸ªç¯å½¢æ æ±çå®ç°è¿æ¥æ²¡æç®æ ç®­å¤´ã\n\n\n\n\n# è¡¨ï¼Tablesï¼\n\nè¡¨å°½ç®¡ä¸æ¯åºæ¬ UML çä¸é¨åï¼ä»ç¶æ¯âå¾åâè½å®æçå®ä¾ç¨ãå¨å³ä¸è§ç»ä¸ä¸ªè¡¨çå°å¾æ æ¥è¡¨ç¤ºãè¡¨å±æ§ç¨âå¾åâ Â«columnÂ»è¡¨ç¤ºã ç»å¤§å¤æ°è¡¨åæä¸ä¸ªä¸»é®ï¼æ¯ç±ä¸ä¸ªæå ä¸ªå­æ®µç»æçä¸ä¸ªå¯ä¸çå­ç ç»åå ä¸»é®æä½æ¥è®¿é®è¡¨æ ¼ï¼ä¸»é®æä½âå¾åâä¸ºÂ«PKÂ»ã ä¸äºè¡¨æä¸ä¸ªæå¤ä¸ªå¤é®ï¼ä½¿ç¨ä¸ä¸ªæå¤ä¸ªå­æ®µå ä¸ä¸ªå¤é®æä½ï¼æ å°å°ç¸å³è¡¨çä¸»é®ä¸å»ï¼å¤é®æä½âå¾åâä¸ºÂ«FKÂ»ã\n\n\n\n\n# å³èï¼Associationsï¼\n\nå³èè¡¨æä¸¤ä¸ªæ¨¡ååç´ ä¹é´æå³ç³»ï¼éå¸¸ç¨å¨ä¸ä¸ªç±»ä¸­è¢«å®ç°ä¸ºä¸ä¸ªå®ä¾åéãè¿æ¥ç¬¦å¯ä»¥åå«ä¸¤ç«¯çå½åçè§è²ï¼åºæ°æ§ï¼æ¹ååçº¦æãå³èæ¯åç´ ä¹é´æ®éçå³ç³»ãå¦æå¤äºä¸¤ä¸ªåç´ ï¼ä¹å¯ä»¥ä½¿ç¨è±å½¢çå³èå³ç³»ãå½ä»ç±»å¾çæä»£ç æ¶ï¼å³èæ«ç«¯çå¯¹è±¡å°åæç®æ ç±»ä¸­å®ä¾åéãè§ä¸å¾ç¤ºä¾ "playsFor" å°åæ"Player"ç±»ä¸­çå®ä¾åéã\n\n\n\n\n# æ³åï¼Generalizationsï¼\n\næ³åè¢«ç¨æ¥è¯´æç»§æ¿å³ç³»ãè¿æ¥ä»ç¹å®ç±»åå°ä¸è¬ç±»åãæ³åçå«ä¹æ¯æºç±»ç»§æ¿äºç®æ ç±»çç¹æ§ãä¸å¾çå¾æ¾ç¤ºäºä¸ä¸ªç¶ç±»æ³åä¸ä¸ªå­ç±»ï¼ ç±»âCircleâçä¸ä¸ªå®ä¾å°ä¼æå±æ§ â x_positionâï¼â y_positionâ ï¼ âradiusâ å æ¹æ³ âdisplay()âã æ³¨æï¼ç±» "Shape" æ¯æ½è±¡çï¼ç±»åæ¾ç¤ºä¸ºæä½ã\n\n\n\nä¸å¾æ¾ç¤ºäºä¸ä¸å¾ç¸åä¿¡æ¯çè§å¾ã\n\n\n\n\n# èåï¼Aggregationsï¼\n\nèåéå¸¸è¢«ç¨æ¥æè¿°ç±æ´å°çç»ä»¶æææçåç´ ãèåå³ç³»è¡¨ç¤ºä¸ºç½è²è±å½¢ç®­å¤´æåç®æ ç±»æç¶ç±»ã\n\nèåçæ´å¼ºå½¢å¼ -ç»åèåï¼å¼ºèåï¼ - æ¾ç¤ºä¸ºé»è²è±å½¢ç®­å¤´ï¼ç¨æ¥ç»åæ¯æ¬¡æå¤§åçåå«ç»ä»¶ãå¦æä¸ä¸ªç»åèåçç¶ç±»è¢«å é¤ï¼éå¸¸ä¸ä»ç¸å³çææé¨åé½ä¼è¢«å é¤ï¼ä½æ¯ï¼å¦æä¸ä¸ªé¨ä»¶ä»ç»åä¸­å»æï¼å°ä¸ç¨å é¤æ´ä¸ªç»åãç»åæ¯å¯è¿ï¼éå¯¹ç§°çå³ç³»åéå½çã\n\nä¸é¢çå¾ç¤ºï¼æ¾ç¤ºäºå¼±èååå¼ºèåçä¸åãâ address bookâ ç±è®¸å¤ âcontactsâ å âcontact groupsâç»æã âcontact groupâ æ¯ä¸ä¸ªâcontactsâçèåç»; âcontactâå¯ä»¥è¢«åå«å¨ä¸æ­¢ä¸ä¸ª â contact groupâã å¦æä½ å é¤ä¸ä¸ªâ address bookâï¼ææç âcontactsâ å âcontact groupsâ ä¹å°ä¼è¢«å é¤ï¼å¦æä½ å é¤â contact groupâï¼ æ²¡æ âcontactsâä¼è¢«å é¤ã\n\n\n\n\n# å³èç±»ï¼Association Classesï¼\n\nå³èç±»æ¯ä¸ä¸ªåè®¸å³èè¿æ¥æå±æ§åæä½çæé ãä¸é¢çç¤ºä¾ï¼æ¾ç¤ºäºè¿ä¸æ­¢ç®åè¿æ¥ä¸¤ä¸ªç±»çè¿æ¥ï¼å¦ç»âemployeeâåéé¡¹ç®ãâ employeeâå¨é¡¹ç®ä¸­æèµ·çä½ç¨æ¯ä¸ä¸ªå¤æçå®ä½ï¼æ¢æèªèº«çä¹æä¸å±äºâemployeeâ æ âprojectâ ç±»çç»èã ä¾å¦ï¼â employeeâå¯ä»¥åæ¶ä¸ºå ä¸ªé¡¹ç®å·¥ä½ï¼æä¸åçèå¡å¤´è¡åå¯¹åºçå®å¨æéã\n\n\n\n\n# ä¾èµï¼Dependenciesï¼\n\nä¾èµè¢«ç¨æ¥æè¿°æ¨¡ååç´ é´å¹¿æ³çä¾èµå³ç³»ãéå¸¸å¨è®¾è®¡è¿ç¨æ©ææ¾ç¤ºä¸¤ä¸ªåç´ ä¹é´å­å¨æç§å³ç³»ï¼å ä¸ºæ¯åæèä¸è½ç¡®å®å·ä½æ¯ä»ä¹å³ç³»ï¼å¨è®¾è®¡è¿ç¨æ«æï¼è¯¥ç»§æ¿å³ç³»ä¼è¢«å½å¥å·²ææé å (æé å å¯ä»¥æ¯å®ä¾å Â«instantiateÂ»ï¼è·è¸ª Â«traceÂ»ï¼å¯¼å¥ Â«importÂ»ï¼ åå¶å®çå³ç³»)ï¼æè¢«æ¿æ¢æä¸ä¸ªæ´æç¡®ç±»åçè¿æ¥ç¬¦ã\n\n\n# è·è¸ªï¼Tracesï¼\n\nè·è¸ªå³ç³»æ¯ä¸ç§ç¹æ®åçä¾èµå³ç³»ãè¿æ¥æ¨¡ååç´ æè·¨æ¨¡åä½æ¯å·æç¸åæ¦å¿µçæ¨¡ååç´ éãè·è¸ªè¢«ç»å¸¸ç¨æ¥è¿½è¸ªéæ±åæ¨¡åçååãç±äºååæ¯ååçï¼è¿ç§ä¾èµå³ç³»çé¡ºåºéå¸¸è¢«å¿½ç¥ãè¿ç§å³ç³»çå±æ§å¯ä»¥è¢«æå®ä¸ºååæ å°ï¼ä½è·è¸ªæ¯ååçï¼éæ­£å¼çåå¾å°å¯è®¡ç®çã\n\n\n# å®ç°ï¼Realizationsï¼\n\næ¯æºå¯¹è±¡æ§è¡æå®ç°ç®æ ï¼å®ç°è¢«ç¨æ¥è¡¨è¾¾æ¨¡åçå¯è·è¸ªæ§åå®æ´æ§ï¼ä¸å¡æ¨¡åæéæ±è¢«ä¸ä¸ªæå¤ä¸ªç¨ä¾å®ç°ï¼ç¨ä¾åè¢«ç±»å®ç°ï¼ç±»è¢«ç»ä»¶å®ç°ï¼ç­ç­ãè¿ç§å®ç°è´¯ç©¿äºç³»ç»è®¾è®¡çæ å°éæ±åç±»ç­ï¼ç´è³æ½è±¡å»ºæ¨¡æ°´å¹³çº§ãä»èç¡®ä¿æ´ä¸ªç³»ç»çä¸å¼ å®å¾ï¼å®ä¹åæ ç³»ç»çææå¾®å°ç»æï¼ä»¥åçº¦æåå®ä¹å®çç»èãå®ç°å³ç³»ç¨å¸¦èçº¿çå®ç®­å¤´è¡¨ç¤ºã\n\n\n\n\n# åµå¥ï¼Nestingsï¼\n\nåµå¥è¿æ¥ç¬¦ç¨æ¥è¡¨ç¤ºæºåç´ åµå¥å¨ç®æ åç´ ä¸­ãä¸å¾æ¾ç¤ºâ inner classâçå®ä¹ï¼å°½ç®¡å¨ EA ä¸­ï¼æ´å¤å°æç§çä»ä»¬å¨é¡¹ç®å±æ¬¡è§å¾ä¸­çä½ç½®æ¥æ¾ç¤ºè¿ç§å³ç³»ã\n\n\n\n\n# å¤åç»æå¾\n\n> å¤åç»æå¾æ¾ç¤ºç±»çåé¨ç»æï¼åæ¬å®ä¸ç³»ç»å¶ä»é¨åçäº¤äºç¹ãä¹æ¾ç¤ºåé¨åçéç½®ä¸å³ç³»ï¼è¿äºé¨åä¸èµ·æ§è¡ç±»åçè¡ä¸ºã\n\nç±»åç´ å·²ç»å¨ç±»å¾é¨åè¢«è¯¦ç»å°éè¿°ï¼è¿é¨åç¨æ¥è¯´æç±»è¡¨ç°å¤ååç´ çæ¹å¼ï¼å¦ï¼æ´é²æ¥å£ï¼åå«ç«¯å£åé¨ä»¶ã\n\n\n\n\n# é¨ä»¶\n\né¨ä»¶æ¯ä»£è¡¨ä¸ç»ï¼ä¸ä¸ªæå¤ä¸ªï¼å®ä¾çåç´ ï¼è¿ç»å®ä¾çæ¥æèæ¯ä¸ç±»åå®ä¾ï¼ä¾å¦ï¼å¦æä¸ä¸ªå¾çå®ä¾æä¸ç»å¾å½¢åç´ ï¼åè¿äºå¾å½¢åç´ å¯ä»¥è¢«è¡¨ç¤ºä¸ºé¨ä»¶ï¼å¹¶å¯ä»¥å¯¹ä»ä»¬ä¹é´çæç§å³ç³»å»ºæ¨¡ãæ³¨æï¼ä¸ä¸ªé¨ä»¶å¯ä»¥å¨å®çç¶ç±»è¢«å é¤ä¹åä»ç¶ç±»ä¸­è¢«å»æï¼è¿æ ·é¨ä»¶å°±ä¸ä¼è¢«åæ¶å é¤äºã é¨ä»¶å¨ç±»æç»ä»¶åé¨æ¾ç¤ºä¸ºä¸å ä¿®é¥°çæ¹æ¡ã\n\n\n\n\n# ç«¯å£\n\nç«¯å£æ¯ç±»ååçåç´ ï¼ä»£è¡¨ä¸ä¸ªåå«ç±»åå®ä¾çå¤é¨å¯è§çé¨åãç«¯å£å®ä¹äºç±»ååå®çç¯å¢ä¹é´çäº¤äºãç«¯å£æ¾ç¤ºå¨åå«å®çé¨ä»¶ï¼ç±»æç»åç»æçè¾¹ç¼ä¸ãç«¯å£æå®äºç±»åæä¾çæå¡ï¼ä»¥åç±»åè¦æ±ç¯å¢æä¾çæå¡ã ç«¯å£æ¾ç¤ºä¸ºæå±ç±»åè¾¹çæå®çæ¹æ¡ã\n\n\n\n\n# æ¥å£\n\næ¥å£ä¸ç±»ç¸ä¼¼ï¼ä½æ¯æä¸äºéå¶ï¼ææçæ¥å£æä½é½æ¯å¬å±åæ½è±¡çï¼ä¸æä¾ä»»ä½é»è®¤çå®ç°ãææçæ¥å£å±æ§é½å¿é¡»æ¯å¸¸éãç¶èï¼å½ä¸ä¸ªç±»ä»ä¸ä¸ªåç¬çè¶çº§ç±»ç»§æ¿èæ¥ï¼å®å¯ä»¥å®ç°å¤ä¸ªæ¥å£ã å½ä¸ä¸ªæ¥å£å¨å¾ä¸­åååºæ¥ï¼å®æ¢å¯ä»¥æ¾ç¤ºä¸ºç±»åç´ çæ¹æ¡ï¼å¸¦ Â«interfaceÂ» å³é®å­åè¡¨æå®æ¯æ½è±¡çæä½åç§°ï¼ä¹å¯ä»¥æ¾ç¤ºä¸ºåç¯ã\n\n\n\næ³¨æï¼åç¯æ æ³¨ä¸æ¾ç¤ºæ¥å£æä½ãå½æ¥å£æ¾ç¤ºä¸ºç±»ææçæ¥å£ï¼å®ä»¬ä¼è¢«å½ä½æ´é²æ¥å£å¼ç¨ãæ´é²æ¥å£å¯ä»¥å®ä¹ä¸ºæ¯æä¾çï¼è¿æ¯éæ±çãæä¾æ¥å£ç¡®è®¤åå«å®çç±»åæä¾æå®æ¥å£åç´ å®ä¹çæä½ï¼å¯éè¿ç±»åæ¥å£é´å®ç°çè¿æ¥æ¥å®ä¹ãéæ±æ¥å£è¯´æè¯¥ç±»åè½ä¸å¶ä»ç±»åè¿è¡éä¿¡ï¼è¿äºç±»åæä¾äºæå®æ¥å£åç´ æå®ä¹çæä½ãéæ±æ¥å£å¯éè¿å¨ç±»åæ¥å£é´å»ºç«ä¾èµè¿æ¥æ¥å®ä¹ã æä¾æ¥å£æ¾ç¤ºä¸ºâå¸¦æ£çä½âï¼ä¾éå¨ç±»åè¾¹ç¼ãéæ±æ¥å£æ¾ç¤ºä¸ºâå¸¦æ£æ¯ä½âï¼ä¹æ¯ä¾éå¨ç±»åè¾¹ç¼ã\n\n\n\n\n# å§æ\n\nå§æè¿æ¥å¨ç¨æ¥å®ä¹ç»ä»¶å¤é¨ç«¯å£åæ¥å£çåé¨å·¥ä½æ¹å¼ãå§æè¿æ¥å¨è¡¨ç¤ºä¸ºå¸¦æ Â«delegateÂ» å³é®å­çç®­å¤´ãå®è¿æ¥ç»ä»¶çå¤é¨çº¦å®ï¼è¡¨ç°ä¸ºå®çç«¯å£ï¼å°ç»ä»¶é¨ä»¶è¡ä¸ºçåé¨å®ç°ã\n\n\n\n\n# åä½\n\nåä½å®ä¹äºä¸ç³»åå±ååä½çè§è²ï¼å®ä»¬éä½å±ç¤ºä¸ä¸ªæå®çè®¾è®¡åè½ãåä½å¾åºä»ä»æ¾ç¤ºå®ææå®ä»»å¡æåè½çè§è²ä¸å±æ§ãéç¦»ä¸»è¦è§è²æ¯ç¨æ¥ç®åç»æåæ¾æ¸è¡ä¸ºï¼ä¹ç¨äºéç¨ãä¸ä¸ªåä½éå¸¸å®ç°ä¸ä¸ªæ¨¡å¼ã åä½åç´ æ¾ç¤ºä¸ºæ¤­åã\n\n\n\n\n# è§è²ç»å®\n\nè§è²ç»å®è¿æ¥å¨æ¯ä¸æ¡ä»è¿æ¥åä½å°æè¦å®æè¯¥ä»»å¡ç±»åçè¿çº¿ãå®æ¾ç¤ºä¸ºèçº¿ï¼å¹¶å¨ç±»åç«¯æ¾ç¤ºä½ç¨åã\n\n\n\n\n# è¡¨ç°\n\nè¡¨ç°è¿æ¥å¨ç¨äºè¿æ¥åä½å°ç±»åæ¥è¡¨ç¤ºæ­¤ç±»åä¸­ä½¿ç¨äºè¯¥åä½ãæ¾ç¤ºä¸ºå¸¦å³é®å­ Â«representsÂ»çèçº¿ç®­å¤´ã\n\n\n\nåç åçè¿æ¥å¨ç¨äºè¿æ¥åä½å°ç±»åæ¥è¡¨ç¤ºæ­¤åä½è¡¨ç°äºï¼ååæï¼è¯¥ç±»åï¼æ¾ç¤ºä¸ºå¸¦å³é®å­Â«occurrenceÂ»çèçº¿ç®­å¤´ã\n\n\n\n\n# å¯¹è±¡å¾\n\n> å¯¹è±¡å¾ï¼Object Diagramï¼å¯ä»¥è®¤ä¸ºæ¯ç±»å¾çç¹æ®æå½¢ï¼æ¯ç±»å¾åç´ å­éï¼è¢«ç¨æ¥åæ¶å¼ºè°å¨æäºç¹ï¼ç±»çå®ä¾é´çå³ç³»ãè¿å¯¹çè§£ç±»å¾å¾æå¸®å©ãä»ä»¬å¨æé ä¸ä¸ç±»å¾æ¾ç¤ºæ²¡æä¸åï¼ä½æ¯åæ åºå¤æ ·æ§åä½ç¨ã\n\n\n# ç±»åå¯¹è±¡åç´ \n\nä¸é¢çå¾æ¾ç¤ºäºç±»åç´ åå¯¹è±¡åç´ å¤è§ä¸çä¸åãæ³¨æï¼ç±»åç´ åæ¬ä¸ä¸ªé¨åï¼åå«æ¯åå­æ ï¼å±æ§æ åæä½æ ï¼å¯¹è±¡åç´ é»è®¤ä¸ºæ²¡æåæ ãåç§°æ¾ç¤ºä¹æä¸åï¼å¯¹è±¡åç§°æä¸åçº¿ï¼å¹¶å¯è½æ¾ç¤ºè¯¥å¯¹è±¡å®ä¾åæç¨ç±»åçåç§°ã\n\n\n\n\n# è¿è¡ç¶æ\n\nç±»ååç´ å¯ä»¥æä»»ææ°éçå±æ§åæä½ãå¨å¯¹è±¡å®ä¾ä¸­ä¸ä¼è¢«æ¾ç¤ºåºæ¥ãä½å¯è½å®ä¹å¯¹è±¡çè¿è¡ç¶æï¼æ¾ç¤ºç¹æ®å®ä¾çå±æ§è®¾ç½®å¼ã\n\n\n\n\n# ç±»åå¯¹è±¡å¾ç¤ºä¾\n\nä¸å¾æ¯ä¸ä¸ªå¯¹è±¡å¾ï¼å¶ä¸­æå¥äºç±»å®ä¹å¾ãå®ä¾ç¤ºå¦ä½ç¨å¯¹è±¡å¾æ¥æµè¯ç±»å¾ä¸­ä»»å¡å¤éæ§çæ¹æ³ãâcarâ ç±»å¯¹ âwheelâ ç±»æâ1 å¯¹å¤â çå¤éæ§ï¼ä½æ¯å¦æå·²ç»éæ©ç¨â1 å¯¹ 4â æ¥æ¿ä»£ï¼é£æ ·å°±ä¸ä¼å¨å¯¹è±¡å¾æ¾ç¤ºâ3 ä¸ªè½®å­âçæ±½è½¦ã\n\n\n\n\n# åèèµæ\n\n * https://sparxsystems.cn/resources/uml2_tutorial/index.html\n * http://www.cnblogs.com/ywqu/category/223486.html',normalizedContent:'# uml ç»æå»ºæ¨¡å¾\n\n> ç»æå¾å®ä¹äºä¸ä¸ªæ¨¡åçéææ¶æãå®ä»¬éå¸¸è¢«ç¨æ¥å¯¹é£äºæææ¨¡åçâè¦ç´ \'å»ºæ¨¡ï¼è¯¸å¦ï¼ç±»ï¼å¯¹è±¡ï¼æ¥å£åç©çç»ä»¶ãå¦å¤ï¼å®ä»¬ä¹è¢«ç¨æ¥å¯¹åç´ é´å³èåä¾èµå³ç³»è¿è¡å»ºæ¨¡ã\n> \n> å³é®è¯ï¼é¨ç½²å¾, ç»ä»¶å¾, åå¾, ç±»å¾, å¤åç»æå¾, å¯¹è±¡å¾\n\n\n# é¨ç½²å¾\n\n> é¨ç½²å¾ï¼deployment diagramï¼ç¨äºå¯¹ç³»ç»çç©çç»æå»ºæ¨¡ãé¨ç½²å¾å°æ¾ç¤ºç³»ç»ä¸­çè½¯ä»¶ç»ä»¶åç¡¬ä»¶ç»ä»¶ä¹é´çå³ç³»ä»¥åå¤çå·¥ä½çç©çåå¸ã\n\n\n\n\n# èç¹\n\nèç¹æ¢å¯ä»¥æ¯ç¡¬ä»¶åç´ ï¼ä¹å¯ä»¥æ¯è½¯ä»¶åç´ ãå®æ¾ç¤ºä¸ºä¸ä¸ªç«æ¹ä½ï¼å¦ä¸å¾æç¤ºã\n\n\n\n\n# èç¹å®ä¾\n\nå¾å¯ä»¥æ¾ç¤ºèç¹å®ä¾ï¼å®ä¾ä¸èç¹çåºåæ¯ï¼å®ä¾çåç§°å¸¦ä¸åçº¿ï¼åå·æ¾å¨å®çåºæ¬èç¹ç±»åä¹åãå®ä¾å¨åå·ä¹åå¯ä»¥æåç§°ï¼ä¹å¯ä»¥æ²¡æåç§°ãä¸å¾æ¾ç¤ºäºä¸ä¸ªå·åçè®¡ç®æºå®ä¾ã\n\n\n\n\n# èç¹æé å\n\nä¸ºèç¹æä¾äºè®¸å¤æ åçæé åï¼åå«å½åä¸º Â«cdromÂ»ï¼ Â«cd-romÂ»ï¼ Â«computerÂ»ï¼ Â«disk arrayÂ»ï¼ Â«pcÂ»ï¼ Â«pc clientÂ»ï¼ Â«pc serverÂ»ï¼ Â«secureÂ»ï¼ Â«serverÂ»ï¼ Â«storageÂ»ï¼ Â«unix serverÂ»ï¼ Â«user pcÂ»ã å¹¶å¨èç¹ç¬¦å·çå³ä¸è§æ¾ç¤ºéå½çå¾æ ã\n\n\n\n\n# å·¥ä»¶\n\nå·¥ä»¶æ¯è½¯ä»¶å¼åè¿ç¨ä¸­çäº§åãåæ¬è¿ç¨æ¨¡åï¼å¦ï¼ç¨ä¾æ¨¡åï¼è®¾è®¡æ¨¡åç­ï¼ï¼æºæä»¶ï¼æ§è¡æä»¶ï¼è®¾è®¡ææ¡£ï¼æµè¯æ¥åï¼æé åï¼ç¨æ·æåç­ç­ã\n\nå·¥ä»¶è¡¨ç¤ºä¸ºå¸¦æå·¥ä»¶åç§°çç©å½¢ï¼å¹¶æ¾ç¤ºÂ«artifactÂ»å³é®å­åææ¡£ç¬¦å·ã\n\n\n\n\n# å³è\n\nå¨é¨ç½²å¾çä¸ä¸æèç³»ä¸­ï¼å³èä»£è¡¨èç¹é´çèç³»ééãä¸å¾æ¾ç¤ºäºä¸ä¸ªç½ç»ç³»ç»çé¨ç½²å¾ï¼æè¿°äºç½ç»åè®®ä¸ºæé ååå³èç»ç«¯çå¤éæ§ï¼\n\n\n\n\n# ä½ä¸ºå®¹å¨çèç¹\n\nèç¹å¯ä»¥åå«å¶ä»åç´ ï¼å¦ç»ä»¶åå·¥ä»¶ãä¸å¾æ¾ç¤ºäºä¸ä¸ªåµå¥å¼ç³»ç»æä¸ªé¨åçé¨ç½²å¾ãæåäºä¸ä¸ªè¢«ä¸»æ¿èç¹åå«çå¯æ§è¡å·¥ä»¶ã\n\n\n\n\n# ç»ä»¶å¾\n\n> ç»ä»¶å¾ï¼component diagramï¼æç»äºç»æä¸ä¸ªè½¯ä»¶ç³»ç»çæ¨¡åååµå¥æ§ä»¶ãç»ä»¶å¾æ¯ç±»å¾å·ææ´é«å±æ¬¡çæ½è±¡ï¼éå¸¸è¿è¡æ¶ä¸ä¸ªç»ä»¶è¢«ä¸ä¸ªæå¤ä¸ªç±»ï¼æå¯¹è±¡ï¼å®ç°ãå®ä»¬è±¡ç§¯æ¨é£æ ·ä½¿å¾ç»ä»¶è½æç»ææç³»ç»çç»å¤§é¨åã\n\n\n\nä¸å¾æ¼ç¤ºäºä¸äºç»ä»¶åå®ä»¬çåé¨å³ç³»ãè£éè¿æ¥å¨ï¼assembly connectorsï¼âè¿æ¥âç±"product"å"customer"çæä¾æ¥å£å°ç± "order"æå®çéæ±æ¥å£ã ä¸ä¸ªä¾èµå³ç³»æ å°äºå®¢æ·ç¸å³çå¸æ·ä¿¡æ¯å°âorderâéè¦ç "payment"éæ±æ¥å£ã\n\nå®éä¸ï¼ç»ä»¶å¾ååå¾å¾ç¸ä¼¼ï¼å®ä»¬é½ææç¡®ççéï¼æåç´ åç»å°é»è¾ç»æä¸­ãä»ä»¬ä¹é´çä¸åæ¯ï¼ç»ä»¶å¾æä¾äºè¯­ä¹æ´ä¸°å¯çåç»æºå¶ï¼å¨ç»ä»¶å¾ä¸­ï¼ææçæ¨¡ååç´ é½æ¯ç§æçï¼èåå¾åªæ¾ç¤ºå¬æçæåã\n\n\n# è¡¨ç°ç»ä»¶\n\nç»ä»¶å¯è¡¨ç¤ºä¸ºå¸¦å³é®å­ Â«componentÂ»çç©å½¢ç±»åï¼ä¹å¯ç¨å³ä¸è§æç»ä»¶å¾æ çç©å½¢è¡¨ç¤ºã\n\n\n\n\n# è£éè¿æ¥å¨\n\nè£éè¿æ¥å¨å¨ç»ä»¶ âcomponent1âçéæ±æ¥å£åå¦ä¸ä¸ªç»ä»¶ âcomponent2âçæä¾æ¥å£ä¹é´å»ºç«æ¡¥æ¢; è¿ä¸ªæ¡¥æ¢ä½¿å¾ä¸ä¸ªç»ä»¶è½æä¾å¦ä¸ä¸ªç»ä»¶æéè¦çæå¡ã\n\n\n\n\n# å¸¦ç«¯å£ç»ä»¶\n\nä½¿ç¨ç«¯å£çç»ä»¶å¾åè®¸å¨å®çç¯å¢æå®ä¸ä¸ªæå¡åè¡ä¸ºï¼åæ¶è¿ä¸ªæå¡åè¡ä¸ºä¹æ¯ç»ä»¶éè¦çãå½ç«¯å£è¿è¡ååæä½çæ¶åï¼å®å¯ä»¥æå®è¾å¥åè¾åºãä¸å¾è¯¦è¿°äºç¨äºå¨çº¿æå¡çå¸¦ç«¯å£ç»ä»¶ï¼å®æä¸¤ä¸ªæä¾æ¥å£ âorder entryâå âtrackingâï¼ä¹æ âpaymentâ éæ±æ¥å£ã\n\n\n\n\n# åå¾\n\n> åå¾ï¼package diagramï¼ç¨æ¥è¡¨ç°ååå®æåå«åç´ çç»ç»ãå½ç¨æ¥ä»£è¡¨ç±»åç´ æ¶ï¼åå¾æä¾äºå½åç©ºé´çå¯è§åãåå¾æå¸¸ç¨çç¨éæ¯ç¨æ¥ç»ç»ç¨ä¾å¾åç±»å¾ï¼å°½ç®¡å®ä¸å±éäºè¿äº uml åç´ ã\n\nä¸é¢æ¯ä¸ä¸ªåå¾çä¾å­ã\n\n\n\nåä¸­çåç´ å±äº«ç¸åçå½åç©ºé´ï¼å æ­¤ï¼ä¸ä¸ªæå®å½åç©ºé´çåç´ å¿é¡»æå¯ä¸çåç§°ã\n\nåå¯ä»¥ç¨æ¥ä»£è¡¨ç©çæé»è¾å³ç³»ãéæ©æç±»åæ¬å¨æå®çåéï¼æå©äºå¨åä¸ä¸ªåéèµäºè¿äºç±»ç¸åç»§æ¿å±æ¬¡ãéå¸¸è®¤ä¸ºæéè¿å¤åç¸å³èçç±»ï¼ä»¥åä¸å®ä»¬ç¸åä½çç±»æ¾å¨åä¸ä¸ªåéã\n\n\n\nå¨ uml2.5 ä¸­ï¼åç¨æä»¶å¤¹æ¥è¡¨ç¤ºï¼åä¸­çåç´ å±äº«åä¸ä¸ªå½åç©ºé´ï¼å¹¶ä¸å¿é¡»æ¯å¯è¯å«çï¼å æ­¤è¦æå¯ä¸çåç§°æç±»åãåå¿é¡»æ¾ç¤ºååï¼å¨éå±æ¹æ¡é¨åæéæ©çæ¾ç¤ºååçåç´ ã\n\n * åçåå¹¶ - åä¹é´çåå¹¶è¿æ¥ç¬¦Â«mergeÂ»å®ä¹äºæºååç´ ä¸ç®æ ååååç´ ä¹é´çæ³åå³ç³»ãæºååç´ çå®ä¹è¢«æ©å±æ¥åå«ç®æ ååç´ å®ä¹ãå½æºååç´ ä¸ç®æ ååæ²¡æåååç´ æ¶ï¼ç®æ ååç´ çå®ä¹ä¸åå½±åã\n * åçå¯¼å¥ - å¯¼å¥è¿æ¥ç¬¦ Â«importÂ»è¡¨æç®æ åçåç´ ï¼å¨è¯¥ä¾ä¸­æ¯ä¸ä¸ªç±» ï¼å¨æºåä¸­è¢«å¼ç¨è¦ç¨ééå®ä¿®é¥°åãæºåçå½åç©ºé´è·å¾ç®æ ç±»çæ¥å£ï¼ç®æ åçå½åç©ºé´åä¸åå½±åã\n * åµå¥è¿æ¥ç¬¦ - æºååç®æ åé´çåµå¥è¿æ¥ç¬¦è¯´æç®æ åå®å¨åå«æºåã\n\n\n# ç±»å¾\n\n> ç±»å¾ï¼class diagramï¼å±ç¤ºäºé¢åå¯¹è±¡ç³»ç»çæé æ¨¡åãæç»äºæ¨¡åæé¨åæ¨¡åçéæè§å¾ï¼æ¾ç¤ºå®åå«çå±æ§åè¡ä¸ºï¼èä¸æ¯è¯¦ç»æè¿°æä½çåè½æå®åæ¹æ³ãç±»å¾æå¸¸ç¨æ¥è¡¨è¾¾å¤ä¸ªç±»åæ¥å£ä¹é´çå³ç³»ãæ³åï¼generalizationsï¼ï¼èåï¼aggregationsï¼åå³èï¼associationsï¼åå«æ¯ç±»ä¹é´ç»§æ¿ï¼å¤åæåºç¨ï¼åè¿æ¥çè¡¨ç°ã\n\nä¸é¢çå¾æ¾ç¤ºäºç±»ä¹é´çèåå³ç³»ãå¼±èåï¼æµè²ç®­å¤´ï¼è¡¨ç°å¨ç±» "account" ä½¿ç¨ "addressbook"ï¼ä½æ¯ä¸å¿è¦åå«å®çä¸ä¸ªå®ä¾ãå¼ºèåï¼å¾ä¸­çé»è²ç®­å¤´ï¼è¡¨ç¤ºäºç®æ ç±»åå«æºç±»ï¼ä¾å¦ï¼"contact" å "contactgroup"å¼è¢«åå«å¨ "addressbook"ä¸­ã\n\n\n\n\n# ç±»ï¼classesï¼\n\nç±»æ¯å®ä¹å¯¹è±¡æå·æçå±æ§åè¡ä¸ºçåç´ ãè¡ä¸ºç¨ç±»è½çè§£çåéæ¶æ¯åéåæ¯æ¡æ¶æ¯çæä½æ¥æè¿°ã ç±»ä¸­ä¹å¯è½å®ä¹çº¦æï¼æ è®°å¼ï¼æé åã\n\n\n# ç±»çæ æ±ï¼class notationï¼\n\nç±»ç¨ç©å½¢è¡¨ç¤ºãé¤ç±»çåç§°å¤ï¼è¿å¯ä»¥éæ©æ§å°æ¾ç¤ºå±æ§åæä½ã åæ åå«ç¨æ¥æ¾ç¤ºç±»çåç§°ï¼å±æ§åæä½ã\n\nå¨ä¸é¢å¾ä¸­ï¼ç±»çç±»åæ¾ç¤ºå¨æä¸é¢çåæ ï¼å®ä¸é¢çåæ æ¾ç¤ºè¯¦ç»å±æ§ï¼å¦ï¼"center" å±æ§æ¾ç¤ºåå§åçå¼ãæåé¢çåæ æ¾ç¤ºæä½ï¼å¦ï¼ setwidthï¼setlength å setposition ä»¥åä»ä»¬çåæ°ã å±æ§åæä½ååçæ æ³¨è¡¨ç¤ºäºè¯¥å±æ§ææä½çå¯è§æ§: å¦æä½¿ç¨ "+"å·ï¼è¿ä¸ªå±æ§ææä½æ¯å¬å±ç ; "-" å·åä»£è¡¨è¿ä¸ªå±æ§ææä½æ¯ç§æçã "#"å·æ¯è¿ä¸ªå±æ§ææä½è¢«å®ä¹ä¸ºä¿æ¤çï¼" ~" å·ä»£è¡¨åçå¯è§æ§ã\n\n\n\n\n# æ¥å£ï¼interfacesï¼\n\næ¥å£æ¯å®æ½èåææ»¡è¶³çè¡ä¸ºè§èï¼æ¯ä¸ç§çº¦å®ãå®ç°ä¸ä¸ªæ¥å£ï¼ç±»å¿éæ¯æå¶è¦æ±çè¡ä¸ºï¼ä½¿ç³»ç»æç§åæ ·çæ¹å¼ï¼å³å¬å±çæ¥å£ï¼å¤çä¸ç¸å³çåç´ ã\n\n\n\næ¥å£æç¸ä¼¼äºç±»çå¤å½¢é£æ ¼ï¼å«ææå®çæä½ï¼å¦ä¸å¾æç¤ºãå¦ææ²¡ææç¡®çè¯¦ç»æä½ï¼ä¹å¯ä»¥ç»æä¸ä¸ªåç¯ãå½ç»æåç¯çæ¶åï¼å°è¿ä¸ªç¯å½¢æ æ±çå®ç°è¿æ¥æ²¡æç®æ ç®­å¤´ã\n\n\n\n\n# è¡¨ï¼tablesï¼\n\nè¡¨å°½ç®¡ä¸æ¯åºæ¬ uml çä¸é¨åï¼ä»ç¶æ¯âå¾åâè½å®æçå®ä¾ç¨ãå¨å³ä¸è§ç»ä¸ä¸ªè¡¨çå°å¾æ æ¥è¡¨ç¤ºãè¡¨å±æ§ç¨âå¾åâ Â«columnÂ»è¡¨ç¤ºã ç»å¤§å¤æ°è¡¨åæä¸ä¸ªä¸»é®ï¼æ¯ç±ä¸ä¸ªæå ä¸ªå­æ®µç»æçä¸ä¸ªå¯ä¸çå­ç ç»åå ä¸»é®æä½æ¥è®¿é®è¡¨æ ¼ï¼ä¸»é®æä½âå¾åâä¸ºÂ«pkÂ»ã ä¸äºè¡¨æä¸ä¸ªæå¤ä¸ªå¤é®ï¼ä½¿ç¨ä¸ä¸ªæå¤ä¸ªå­æ®µå ä¸ä¸ªå¤é®æä½ï¼æ å°å°ç¸å³è¡¨çä¸»é®ä¸å»ï¼å¤é®æä½âå¾åâä¸ºÂ«fkÂ»ã\n\n\n\n\n# å³èï¼associationsï¼\n\nå³èè¡¨æä¸¤ä¸ªæ¨¡ååç´ ä¹é´æå³ç³»ï¼éå¸¸ç¨å¨ä¸ä¸ªç±»ä¸­è¢«å®ç°ä¸ºä¸ä¸ªå®ä¾åéãè¿æ¥ç¬¦å¯ä»¥åå«ä¸¤ç«¯çå½åçè§è²ï¼åºæ°æ§ï¼æ¹ååçº¦æãå³èæ¯åç´ ä¹é´æ®éçå³ç³»ãå¦æå¤äºä¸¤ä¸ªåç´ ï¼ä¹å¯ä»¥ä½¿ç¨è±å½¢çå³èå³ç³»ãå½ä»ç±»å¾çæä»£ç æ¶ï¼å³èæ«ç«¯çå¯¹è±¡å°åæç®æ ç±»ä¸­å®ä¾åéãè§ä¸å¾ç¤ºä¾ "playsfor" å°åæ"player"ç±»ä¸­çå®ä¾åéã\n\n\n\n\n# æ³åï¼generalizationsï¼\n\næ³åè¢«ç¨æ¥è¯´æç»§æ¿å³ç³»ãè¿æ¥ä»ç¹å®ç±»åå°ä¸è¬ç±»åãæ³åçå«ä¹æ¯æºç±»ç»§æ¿äºç®æ ç±»çç¹æ§ãä¸å¾çå¾æ¾ç¤ºäºä¸ä¸ªç¶ç±»æ³åä¸ä¸ªå­ç±»ï¼ ç±»âcircleâçä¸ä¸ªå®ä¾å°ä¼æå±æ§ â x_positionâï¼â y_positionâ ï¼ âradiusâ å æ¹æ³ âdisplay()âã æ³¨æï¼ç±» "shape" æ¯æ½è±¡çï¼ç±»åæ¾ç¤ºä¸ºæä½ã\n\n\n\nä¸å¾æ¾ç¤ºäºä¸ä¸å¾ç¸åä¿¡æ¯çè§å¾ã\n\n\n\n\n# èåï¼aggregationsï¼\n\nèåéå¸¸è¢«ç¨æ¥æè¿°ç±æ´å°çç»ä»¶æææçåç´ ãèåå³ç³»è¡¨ç¤ºä¸ºç½è²è±å½¢ç®­å¤´æåç®æ ç±»æç¶ç±»ã\n\nèåçæ´å¼ºå½¢å¼ -ç»åèåï¼å¼ºèåï¼ - æ¾ç¤ºä¸ºé»è²è±å½¢ç®­å¤´ï¼ç¨æ¥ç»åæ¯æ¬¡æå¤§åçåå«ç»ä»¶ãå¦æä¸ä¸ªç»åèåçç¶ç±»è¢«å é¤ï¼éå¸¸ä¸ä»ç¸å³çææé¨åé½ä¼è¢«å é¤ï¼ä½æ¯ï¼å¦æä¸ä¸ªé¨ä»¶ä»ç»åä¸­å»æï¼å°ä¸ç¨å é¤æ´ä¸ªç»åãç»åæ¯å¯è¿ï¼éå¯¹ç§°çå³ç³»åéå½çã\n\nä¸é¢çå¾ç¤ºï¼æ¾ç¤ºäºå¼±èååå¼ºèåçä¸åãâ address bookâ ç±è®¸å¤ âcontactsâ å âcontact groupsâç»æã âcontact groupâ æ¯ä¸ä¸ªâcontactsâçèåç»; âcontactâå¯ä»¥è¢«åå«å¨ä¸æ­¢ä¸ä¸ª â contact groupâã å¦æä½ å é¤ä¸ä¸ªâ address bookâï¼ææç âcontactsâ å âcontact groupsâ ä¹å°ä¼è¢«å é¤ï¼å¦æä½ å é¤â contact groupâï¼ æ²¡æ âcontactsâä¼è¢«å é¤ã\n\n\n\n\n# å³èç±»ï¼association classesï¼\n\nå³èç±»æ¯ä¸ä¸ªåè®¸å³èè¿æ¥æå±æ§åæä½çæé ãä¸é¢çç¤ºä¾ï¼æ¾ç¤ºäºè¿ä¸æ­¢ç®åè¿æ¥ä¸¤ä¸ªç±»çè¿æ¥ï¼å¦ç»âemployeeâåéé¡¹ç®ãâ employeeâå¨é¡¹ç®ä¸­æèµ·çä½ç¨æ¯ä¸ä¸ªå¤æçå®ä½ï¼æ¢æèªèº«çä¹æä¸å±äºâemployeeâ æ âprojectâ ç±»çç»èã ä¾å¦ï¼â employeeâå¯ä»¥åæ¶ä¸ºå ä¸ªé¡¹ç®å·¥ä½ï¼æä¸åçèå¡å¤´è¡åå¯¹åºçå®å¨æéã\n\n\n\n\n# ä¾èµï¼dependenciesï¼\n\nä¾èµè¢«ç¨æ¥æè¿°æ¨¡ååç´ é´å¹¿æ³çä¾èµå³ç³»ãéå¸¸å¨è®¾è®¡è¿ç¨æ©ææ¾ç¤ºä¸¤ä¸ªåç´ ä¹é´å­å¨æç§å³ç³»ï¼å ä¸ºæ¯åæèä¸è½ç¡®å®å·ä½æ¯ä»ä¹å³ç³»ï¼å¨è®¾è®¡è¿ç¨æ«æï¼è¯¥ç»§æ¿å³ç³»ä¼è¢«å½å¥å·²ææé å (æé å å¯ä»¥æ¯å®ä¾å Â«instantiateÂ»ï¼è·è¸ª Â«traceÂ»ï¼å¯¼å¥ Â«importÂ»ï¼ åå¶å®çå³ç³»)ï¼æè¢«æ¿æ¢æä¸ä¸ªæ´æç¡®ç±»åçè¿æ¥ç¬¦ã\n\n\n# è·è¸ªï¼tracesï¼\n\nè·è¸ªå³ç³»æ¯ä¸ç§ç¹æ®åçä¾èµå³ç³»ãè¿æ¥æ¨¡ååç´ æè·¨æ¨¡åä½æ¯å·æç¸åæ¦å¿µçæ¨¡ååç´ éãè·è¸ªè¢«ç»å¸¸ç¨æ¥è¿½è¸ªéæ±åæ¨¡åçååãç±äºååæ¯ååçï¼è¿ç§ä¾èµå³ç³»çé¡ºåºéå¸¸è¢«å¿½ç¥ãè¿ç§å³ç³»çå±æ§å¯ä»¥è¢«æå®ä¸ºååæ å°ï¼ä½è·è¸ªæ¯ååçï¼éæ­£å¼çåå¾å°å¯è®¡ç®çã\n\n\n# å®ç°ï¼realizationsï¼\n\næ¯æºå¯¹è±¡æ§è¡æå®ç°ç®æ ï¼å®ç°è¢«ç¨æ¥è¡¨è¾¾æ¨¡åçå¯è·è¸ªæ§åå®æ´æ§ï¼ä¸å¡æ¨¡åæéæ±è¢«ä¸ä¸ªæå¤ä¸ªç¨ä¾å®ç°ï¼ç¨ä¾åè¢«ç±»å®ç°ï¼ç±»è¢«ç»ä»¶å®ç°ï¼ç­ç­ãè¿ç§å®ç°è´¯ç©¿äºç³»ç»è®¾è®¡çæ å°éæ±åç±»ç­ï¼ç´è³æ½è±¡å»ºæ¨¡æ°´å¹³çº§ãä»èç¡®ä¿æ´ä¸ªç³»ç»çä¸å¼ å®å¾ï¼å®ä¹åæ ç³»ç»çææå¾®å°ç»æï¼ä»¥åçº¦æåå®ä¹å®çç»èãå®ç°å³ç³»ç¨å¸¦èçº¿çå®ç®­å¤´è¡¨ç¤ºã\n\n\n\n\n# åµå¥ï¼nestingsï¼\n\nåµå¥è¿æ¥ç¬¦ç¨æ¥è¡¨ç¤ºæºåç´ åµå¥å¨ç®æ åç´ ä¸­ãä¸å¾æ¾ç¤ºâ inner classâçå®ä¹ï¼å°½ç®¡å¨ ea ä¸­ï¼æ´å¤å°æç§çä»ä»¬å¨é¡¹ç®å±æ¬¡è§å¾ä¸­çä½ç½®æ¥æ¾ç¤ºè¿ç§å³ç³»ã\n\n\n\n\n# å¤åç»æå¾\n\n> å¤åç»æå¾æ¾ç¤ºç±»çåé¨ç»æï¼åæ¬å®ä¸ç³»ç»å¶ä»é¨åçäº¤äºç¹ãä¹æ¾ç¤ºåé¨åçéç½®ä¸å³ç³»ï¼è¿äºé¨åä¸èµ·æ§è¡ç±»åçè¡ä¸ºã\n\nç±»åç´ å·²ç»å¨ç±»å¾é¨åè¢«è¯¦ç»å°éè¿°ï¼è¿é¨åç¨æ¥è¯´æç±»è¡¨ç°å¤ååç´ çæ¹å¼ï¼å¦ï¼æ´é²æ¥å£ï¼åå«ç«¯å£åé¨ä»¶ã\n\n\n\n\n# é¨ä»¶\n\né¨ä»¶æ¯ä»£è¡¨ä¸ç»ï¼ä¸ä¸ªæå¤ä¸ªï¼å®ä¾çåç´ ï¼è¿ç»å®ä¾çæ¥æèæ¯ä¸ç±»åå®ä¾ï¼ä¾å¦ï¼å¦æä¸ä¸ªå¾çå®ä¾æä¸ç»å¾å½¢åç´ ï¼åè¿äºå¾å½¢åç´ å¯ä»¥è¢«è¡¨ç¤ºä¸ºé¨ä»¶ï¼å¹¶å¯ä»¥å¯¹ä»ä»¬ä¹é´çæç§å³ç³»å»ºæ¨¡ãæ³¨æï¼ä¸ä¸ªé¨ä»¶å¯ä»¥å¨å®çç¶ç±»è¢«å é¤ä¹åä»ç¶ç±»ä¸­è¢«å»æï¼è¿æ ·é¨ä»¶å°±ä¸ä¼è¢«åæ¶å é¤äºã é¨ä»¶å¨ç±»æç»ä»¶åé¨æ¾ç¤ºä¸ºä¸å ä¿®é¥°çæ¹æ¡ã\n\n\n\n\n# ç«¯å£\n\nç«¯å£æ¯ç±»ååçåç´ ï¼ä»£è¡¨ä¸ä¸ªåå«ç±»åå®ä¾çå¤é¨å¯è§çé¨åãç«¯å£å®ä¹äºç±»ååå®çç¯å¢ä¹é´çäº¤äºãç«¯å£æ¾ç¤ºå¨åå«å®çé¨ä»¶ï¼ç±»æç»åç»æçè¾¹ç¼ä¸ãç«¯å£æå®äºç±»åæä¾çæå¡ï¼ä»¥åç±»åè¦æ±ç¯å¢æä¾çæå¡ã ç«¯å£æ¾ç¤ºä¸ºæå±ç±»åè¾¹çæå®çæ¹æ¡ã\n\n\n\n\n# æ¥å£\n\næ¥å£ä¸ç±»ç¸ä¼¼ï¼ä½æ¯æä¸äºéå¶ï¼ææçæ¥å£æä½é½æ¯å¬å±åæ½è±¡çï¼ä¸æä¾ä»»ä½é»è®¤çå®ç°ãææçæ¥å£å±æ§é½å¿é¡»æ¯å¸¸éãç¶èï¼å½ä¸ä¸ªç±»ä»ä¸ä¸ªåç¬çè¶çº§ç±»ç»§æ¿èæ¥ï¼å®å¯ä»¥å®ç°å¤ä¸ªæ¥å£ã å½ä¸ä¸ªæ¥å£å¨å¾ä¸­åååºæ¥ï¼å®æ¢å¯ä»¥æ¾ç¤ºä¸ºç±»åç´ çæ¹æ¡ï¼å¸¦ Â«interfaceÂ» å³é®å­åè¡¨æå®æ¯æ½è±¡çæä½åç§°ï¼ä¹å¯ä»¥æ¾ç¤ºä¸ºåç¯ã\n\n\n\næ³¨æï¼åç¯æ æ³¨ä¸æ¾ç¤ºæ¥å£æä½ãå½æ¥å£æ¾ç¤ºä¸ºç±»ææçæ¥å£ï¼å®ä»¬ä¼è¢«å½ä½æ´é²æ¥å£å¼ç¨ãæ´é²æ¥å£å¯ä»¥å®ä¹ä¸ºæ¯æä¾çï¼è¿æ¯éæ±çãæä¾æ¥å£ç¡®è®¤åå«å®çç±»åæä¾æå®æ¥å£åç´ å®ä¹çæä½ï¼å¯éè¿ç±»åæ¥å£é´å®ç°çè¿æ¥æ¥å®ä¹ãéæ±æ¥å£è¯´æè¯¥ç±»åè½ä¸å¶ä»ç±»åè¿è¡éä¿¡ï¼è¿äºç±»åæä¾äºæå®æ¥å£åç´ æå®ä¹çæä½ãéæ±æ¥å£å¯éè¿å¨ç±»åæ¥å£é´å»ºç«ä¾èµè¿æ¥æ¥å®ä¹ã æä¾æ¥å£æ¾ç¤ºä¸ºâå¸¦æ£çä½âï¼ä¾éå¨ç±»åè¾¹ç¼ãéæ±æ¥å£æ¾ç¤ºä¸ºâå¸¦æ£æ¯ä½âï¼ä¹æ¯ä¾éå¨ç±»åè¾¹ç¼ã\n\n\n\n\n# å§æ\n\nå§æè¿æ¥å¨ç¨æ¥å®ä¹ç»ä»¶å¤é¨ç«¯å£åæ¥å£çåé¨å·¥ä½æ¹å¼ãå§æè¿æ¥å¨è¡¨ç¤ºä¸ºå¸¦æ Â«delegateÂ» å³é®å­çç®­å¤´ãå®è¿æ¥ç»ä»¶çå¤é¨çº¦å®ï¼è¡¨ç°ä¸ºå®çç«¯å£ï¼å°ç»ä»¶é¨ä»¶è¡ä¸ºçåé¨å®ç°ã\n\n\n\n\n# åä½\n\nåä½å®ä¹äºä¸ç³»åå±ååä½çè§è²ï¼å®ä»¬éä½å±ç¤ºä¸ä¸ªæå®çè®¾è®¡åè½ãåä½å¾åºä»ä»æ¾ç¤ºå®ææå®ä»»å¡æåè½çè§è²ä¸å±æ§ãéç¦»ä¸»è¦è§è²æ¯ç¨æ¥ç®åç»æåæ¾æ¸è¡ä¸ºï¼ä¹ç¨äºéç¨ãä¸ä¸ªåä½éå¸¸å®ç°ä¸ä¸ªæ¨¡å¼ã åä½åç´ æ¾ç¤ºä¸ºæ¤­åã\n\n\n\n\n# è§è²ç»å®\n\nè§è²ç»å®è¿æ¥å¨æ¯ä¸æ¡ä»è¿æ¥åä½å°æè¦å®æè¯¥ä»»å¡ç±»åçè¿çº¿ãå®æ¾ç¤ºä¸ºèçº¿ï¼å¹¶å¨ç±»åç«¯æ¾ç¤ºä½ç¨åã\n\n\n\n\n# è¡¨ç°\n\nè¡¨ç°è¿æ¥å¨ç¨äºè¿æ¥åä½å°ç±»åæ¥è¡¨ç¤ºæ­¤ç±»åä¸­ä½¿ç¨äºè¯¥åä½ãæ¾ç¤ºä¸ºå¸¦å³é®å­ Â«representsÂ»çèçº¿ç®­å¤´ã\n\n\n\nåç åçè¿æ¥å¨ç¨äºè¿æ¥åä½å°ç±»åæ¥è¡¨ç¤ºæ­¤åä½è¡¨ç°äºï¼ååæï¼è¯¥ç±»åï¼æ¾ç¤ºä¸ºå¸¦å³é®å­Â«occurrenceÂ»çèçº¿ç®­å¤´ã\n\n\n\n\n# å¯¹è±¡å¾\n\n> å¯¹è±¡å¾ï¼object diagramï¼å¯ä»¥è®¤ä¸ºæ¯ç±»å¾çç¹æ®æå½¢ï¼æ¯ç±»å¾åç´ å­éï¼è¢«ç¨æ¥åæ¶å¼ºè°å¨æäºç¹ï¼ç±»çå®ä¾é´çå³ç³»ãè¿å¯¹çè§£ç±»å¾å¾æå¸®å©ãä»ä»¬å¨æé ä¸ä¸ç±»å¾æ¾ç¤ºæ²¡æä¸åï¼ä½æ¯åæ åºå¤æ ·æ§åä½ç¨ã\n\n\n# ç±»åå¯¹è±¡åç´ \n\nä¸é¢çå¾æ¾ç¤ºäºç±»åç´ åå¯¹è±¡åç´ å¤è§ä¸çä¸åãæ³¨æï¼ç±»åç´ åæ¬ä¸ä¸ªé¨åï¼åå«æ¯åå­æ ï¼å±æ§æ åæä½æ ï¼å¯¹è±¡åç´ é»è®¤ä¸ºæ²¡æåæ ãåç§°æ¾ç¤ºä¹æä¸åï¼å¯¹è±¡åç§°æä¸åçº¿ï¼å¹¶å¯è½æ¾ç¤ºè¯¥å¯¹è±¡å®ä¾åæç¨ç±»åçåç§°ã\n\n\n\n\n# è¿è¡ç¶æ\n\nç±»ååç´ å¯ä»¥æä»»ææ°éçå±æ§åæä½ãå¨å¯¹è±¡å®ä¾ä¸­ä¸ä¼è¢«æ¾ç¤ºåºæ¥ãä½å¯è½å®ä¹å¯¹è±¡çè¿è¡ç¶æï¼æ¾ç¤ºç¹æ®å®ä¾çå±æ§è®¾ç½®å¼ã\n\n\n\n\n# ç±»åå¯¹è±¡å¾ç¤ºä¾\n\nä¸å¾æ¯ä¸ä¸ªå¯¹è±¡å¾ï¼å¶ä¸­æå¥äºç±»å®ä¹å¾ãå®ä¾ç¤ºå¦ä½ç¨å¯¹è±¡å¾æ¥æµè¯ç±»å¾ä¸­ä»»å¡å¤éæ§çæ¹æ³ãâcarâ ç±»å¯¹ âwheelâ ç±»æâ1 å¯¹å¤â çå¤éæ§ï¼ä½æ¯å¦æå·²ç»éæ©ç¨â1 å¯¹ 4â æ¥æ¿ä»£ï¼é£æ ·å°±ä¸ä¼å¨å¯¹è±¡å¾æ¾ç¤ºâ3 ä¸ªè½®å­âçæ±½è½¦ã\n\n\n\n\n# åèèµæ\n\n * https://sparxsystems.cn/resources/uml2_tutorial/index.html\n * http://www.cnblogs.com/ywqu/category/223486.html',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"UMLè¡ä¸ºå»ºæ¨¡å¾",frontmatter:{title:"UMLè¡ä¸ºå»ºæ¨¡å¾",date:"2018-10-17T13:25:36.000Z",categories:["è®¾è®¡","UML"],tags:["è®¾è®¡","UML"],permalink:"/pages/dba425/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/01.UML/03.UML%E8%A1%8C%E4%B8%BA%E5%BB%BA%E6%A8%A1%E5%9B%BE.html",relativePath:"03.è®¾è®¡/01.UML/03.UMLè¡ä¸ºå»ºæ¨¡å¾.md",key:"v-2b866fe8",path:"/pages/dba425/",headers:[{level:2,title:"æ´»å¨å¾",slug:"æ´»å¨å¾",normalizedTitle:"æ´»å¨å¾",charIndex:100},{level:3,title:"æ´»å¨",slug:"æ´»å¨",normalizedTitle:"æ´»å¨",charIndex:100},{level:3,title:"å¨ä½",slug:"å¨ä½",normalizedTitle:"å¨ä½",charIndex:332},{level:3,title:"å¨ä½çº¦æ",slug:"å¨ä½çº¦æ",normalizedTitle:"å¨ä½çº¦æ",charIndex:392},{level:3,title:"æ§å¶æµ",slug:"æ§å¶æµ",normalizedTitle:"æ§å¶æµ",charIndex:435},{level:3,title:"åå§èç¹",slug:"åå§èç¹",normalizedTitle:"åå§èç¹",charIndex:473},{level:3,title:"ç»æèç¹",slug:"ç»æèç¹",normalizedTitle:"ç»æèç¹",charIndex:506},{level:3,title:"å¯¹è±¡åå¯¹è±¡æµ",slug:"å¯¹è±¡åå¯¹è±¡æµ",normalizedTitle:"å¯¹è±¡åå¯¹è±¡æµ",charIndex:634},{level:3,title:"å¤æ­èç¹ååå¹¶èç¹",slug:"å¤æ­èç¹ååå¹¶èç¹",normalizedTitle:"å¤æ­èç¹ååå¹¶èç¹",charIndex:781},{level:3,title:"åååç»åèç¹",slug:"åååç»åèç¹",normalizedTitle:"åååç»åèç¹",charIndex:876},{level:3,title:"æ©å±å",slug:"æ©å±å",normalizedTitle:"æ©å±å",charIndex:1087},{level:3,title:"å¼å¸¸å¤çå¨",slug:"å¼å¸¸å¤çå¨",normalizedTitle:"å¼å¸¸å¤çå¨",charIndex:1190},{level:3,title:"å¯ä¸­æ­æ´»å¨åº",slug:"å¯ä¸­æ­æ´»å¨åº",normalizedTitle:"å¯ä¸­æ­æ´»å¨åº",charIndex:1219},{level:3,title:"åå²",slug:"åå²",normalizedTitle:"åå²",charIndex:1377},{level:2,title:"ç¶ææºå¾",slug:"ç¶ææºå¾",normalizedTitle:"ç¶ææºå¾",charIndex:105},{level:3,title:"ç¶æ",slug:"ç¶æ",normalizedTitle:"ç¶æ",charIndex:46},{level:3,title:"èµ·å§åç»æç¶æ",slug:"èµ·å§åç»æç¶æ",normalizedTitle:"èµ·å§åç»æç¶æ",charIndex:1878},{level:3,title:"è½¬ç§»",slug:"è½¬ç§»",normalizedTitle:"è½¬ç§»",charIndex:1758},{level:3,title:"ç¶ææ´»å¨",slug:"ç¶ææ´»å¨",normalizedTitle:"ç¶ææ´»å¨",charIndex:2151},{level:3,title:"èªè½¬ç§»",slug:"èªè½¬ç§»",normalizedTitle:"èªè½¬ç§»",charIndex:2331},{level:3,title:"å¤åç¶æ",slug:"å¤åç¶æ",normalizedTitle:"å¤åç¶æ",charIndex:2379},{level:3,title:"å¥å£ç¹",slug:"å¥å£ç¹",normalizedTitle:"å¥å£ç¹",charIndex:2474},{level:3,title:"åºå£ç¹",slug:"åºå£ç¹",normalizedTitle:"åºå£ç¹",charIndex:2596},{level:3,title:"éæ©ä¼ªç¶æ",slug:"éæ©ä¼ªç¶æ",normalizedTitle:"éæ©ä¼ªç¶æ",charIndex:2673},{level:3,title:"è¿æ¥ä¼ªç¶æ",slug:"è¿æ¥ä¼ªç¶æ",normalizedTitle:"è¿æ¥ä¼ªç¶æ",charIndex:2760},{level:3,title:"ç»æ­¢ä¼ªç¶æ",slug:"ç»æ­¢ä¼ªç¶æ",normalizedTitle:"ç»æ­¢ä¼ªç¶æ",charIndex:2896},{level:3,title:"åå²ç¶æ",slug:"åå²ç¶æ",normalizedTitle:"åå²ç¶æ",charIndex:2941},{level:3,title:"å¹¶ååº",slug:"å¹¶ååº",normalizedTitle:"å¹¶ååº",charIndex:3146},{level:2,title:"ç¨ä¾å¾",slug:"ç¨ä¾å¾",normalizedTitle:"ç¨ä¾å¾",charIndex:111},{level:3,title:"æ§è¡è",slug:"æ§è¡è",normalizedTitle:"æ§è¡è",charIndex:3339},{level:3,title:"ç¨ä¾",slug:"ç¨ä¾",normalizedTitle:"ç¨ä¾",charIndex:111},{level:3,title:"ç¨ä¾å®ä¹",slug:"ç¨ä¾å®ä¹",normalizedTitle:"ç¨ä¾å®ä¹",charIndex:3686},{level:3,title:"åå«ç¨ä¾",slug:"åå«ç¨ä¾",normalizedTitle:"åå«ç¨ä¾",charIndex:4049},{level:3,title:"æ©å±ç¨ä¾",slug:"æ©å±ç¨ä¾",normalizedTitle:"æ©å±ç¨ä¾",charIndex:4208},{level:2,title:"éä¿¡å¾",slug:"éä¿¡å¾",normalizedTitle:"éä¿¡å¾",charIndex:116},{level:2,title:"äº¤äºæ¦è¿°å¾",slug:"äº¤äºæ¦è¿°å¾",normalizedTitle:"äº¤äºæ¦è¿°å¾",charIndex:121},{level:3,title:"äº¤äºåç",slug:"äº¤äºåç",normalizedTitle:"äº¤äºåç",charIndex:4704},{level:3,title:"äº¤äºåç´ ",slug:"äº¤äºåç´ ",normalizedTitle:"äº¤äºåç´ ",charIndex:4709},{level:3,title:"å°å®ä»¬æ¾å¨ä¸èµ·",slug:"å°å®ä»¬æ¾å¨ä¸èµ·",normalizedTitle:"å°å®ä»¬æ¾å¨ä¸èµ·",charIndex:4847},{level:2,title:"æ¶åºå¾",slug:"æ¶åºå¾",normalizedTitle:"æ¶åºå¾",charIndex:128},{level:3,title:"çå½çº¿",slug:"çå½çº¿",normalizedTitle:"çå½çº¿",charIndex:2915},{level:3,title:"æ¶æ¯",slug:"æ¶æ¯",normalizedTitle:"æ¶æ¯",charIndex:2748},{level:3,title:"æ§è¡åç",slug:"æ§è¡åç",normalizedTitle:"æ§è¡åç",charIndex:5353},{level:3,title:"åé¨éä¿¡",slug:"åé¨éä¿¡",normalizedTitle:"åé¨éä¿¡",charIndex:5470},{level:3,title:"è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯",slug:"è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯",normalizedTitle:"è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯",charIndex:5539},{level:3,title:"çå½çº¿å¼å§ä¸ç»æ",slug:"çå½çº¿å¼å§ä¸ç»æ",normalizedTitle:"çå½çº¿å¼å§ä¸ç»æ",charIndex:5649},{level:3,title:"æ¶é´åæéçº¦æ",slug:"æ¶é´åæéçº¦æ",normalizedTitle:"æ¶é´åæéçº¦æ",charIndex:5776},{level:3,title:"å¤åçæ®µ",slug:"å¤åçæ®µ",normalizedTitle:"å¤åçæ®µ",charIndex:5894},{level:3,title:"é¨",slug:"é¨",normalizedTitle:"é¨",charIndex:1573},{level:3,title:"é¨ååè§£",slug:"é¨ååè§£",normalizedTitle:"é¨ååè§£",charIndex:6700},{level:3,title:"ç¶æå¸¸é/å»¶ç»­",slug:"ç¶æå¸¸é-å»¶ç»­",normalizedTitle:"ç¶æå¸¸é/å»¶ç»­",charIndex:6749},{level:2,title:"æ¶é´å¾",slug:"æ¶é´å¾",normalizedTitle:"æ¶é´å¾",charIndex:133},{level:3,title:"ç¶æçå½çº¿",slug:"ç¶æçå½çº¿",normalizedTitle:"ç¶æçå½çº¿",charIndex:6914},{level:3,title:"å¼çå½çº¿",slug:"å¼çå½çº¿",normalizedTitle:"å¼çå½çº¿",charIndex:6997},{level:3,title:"å°å®ä»¬æ¾å¨ä¸èµ·",slug:"å°å®ä»¬æ¾å¨ä¸èµ·-2",normalizedTitle:"å°å®ä»¬æ¾å¨ä¸èµ·",charIndex:4847},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:7230}],headersStr:"æ´»å¨å¾ æ´»å¨ å¨ä½ å¨ä½çº¦æ æ§å¶æµ åå§èç¹ ç»æèç¹ å¯¹è±¡åå¯¹è±¡æµ å¤æ­èç¹ååå¹¶èç¹ åååç»åèç¹ æ©å±å å¼å¸¸å¤çå¨ å¯ä¸­æ­æ´»å¨åº åå² ç¶ææºå¾ ç¶æ èµ·å§åç»æç¶æ è½¬ç§» ç¶ææ´»å¨ èªè½¬ç§» å¤åç¶æ å¥å£ç¹ åºå£ç¹ éæ©ä¼ªç¶æ è¿æ¥ä¼ªç¶æ ç»æ­¢ä¼ªç¶æ åå²ç¶æ å¹¶ååº ç¨ä¾å¾ æ§è¡è ç¨ä¾ ç¨ä¾å®ä¹ åå«ç¨ä¾ æ©å±ç¨ä¾ éä¿¡å¾ äº¤äºæ¦è¿°å¾ äº¤äºåç äº¤äºåç´  å°å®ä»¬æ¾å¨ä¸èµ· æ¶åºå¾ çå½çº¿ æ¶æ¯ æ§è¡åç åé¨éä¿¡ è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯ çå½çº¿å¼å§ä¸ç»æ æ¶é´åæéçº¦æ å¤åçæ®µ é¨ é¨ååè§£ ç¶æå¸¸é/å»¶ç»­ æ¶é´å¾ ç¶æçå½çº¿ å¼çå½çº¿ å°å®ä»¬æ¾å¨ä¸èµ· åèèµæ",content:'# è¡ä¸ºå»ºæ¨¡å¾\n\n> è¡ä¸ºå¾ç¨æ¥è®°å½å¨ä¸ä¸ªæ¨¡ååé¨ï¼éæ¶é´çååï¼æ¨¡åæ§è¡çäº¤äºåååç¬é´çç¶æï¼å¹¶è·è¸ªç³»ç»å¨çå®ç¯å¢ä¸å¦ä½è¡¨ç°ï¼ä»¥åè§å¯ç³»ç»å¯¹ä¸ä¸ªæä½æäºä»¶çååºï¼ä»¥åå®çç»æã\n> \n> å³é®è¯ï¼æ´»å¨å¾, ç¶ææºå¾, ç¨ä¾å¾, éä¿¡å¾, äº¤äºæ¦è¿°å¾, æ¶åºå¾, æ¶é´å¾\n\n\n# æ´»å¨å¾\n\n> UML ä¸­ï¼æ´»å¨å¾ç¨æ¥å±ç¤ºæ´»å¨çé¡ºåºãæ¾ç¤ºäºä»èµ·å§ç¹å°ç»ç¹çå·¥ä½æµï¼æè¿°äºæ´»å¨å¾ä¸­å­å¨äºäºä»¶è¿ç¨çå¤æ­è·¯å¾ãæ´»å¨å¾å¯ä»¥ç¨æ¥è¯¦ç»éè¿°æäºæ´»å¨æ§è¡ä¸­åçå¹¶è¡å¤ççæåµãæ´»å¨å¾å¯¹ä¸å¡å»ºæ¨¡ä¹æ¯è¾æç¨ï¼ç¨æ¥è¯¦ç»æè¿°åçå¨ä¸å¡æ´»å¨ä¸­çè¿ç¨ã ä¸ä¸ªæ´»å¨å¾çç¤ºä¾å¦ä¸æç¤ºã\n\n\n\nä¸é¢æè¿°ç»ææ´»å¨å¾çåç´ ã\n\n\n# æ´»å¨\n\næ´»å¨æ¯è¡ä¸ºåæ°åé¡ºåºçè§èãæ´»å¨è¢«è¡¨ç¤ºä¸ºåè§ç©å½¢ï¼åå«å¨é¨çå¨ä½ï¼å·¥ä½æµåå¶ä»ç»ææ´»å¨çåç´ ã\n\n\n\n\n# å¨ä½\n\nä¸ä¸ªå¨ä½ä»£è¡¨æ´»å¨ä¸­çä¸ä¸ªæ­¥éª¤ãå¨ä½ç¨åè§ç©å½¢è¡¨ç¤ºã\n\n\n\n\n# å¨ä½çº¦æ\n\nå¨ä½å¯ä»¥éå¸¦çº¦æï¼ä¸å¾æ¾ç¤ºäºä¸ä¸ªå¸¦åç½®æ¡ä»¶ååç½®æ¡ä»¶çå¨ä½ã\n\n\n\n\n# æ§å¶æµ\n\næ§å¶æµæ¾ç¤ºä¸ä¸ªå¨ä½å°ä¸ä¸ä¸ªå¨ä½çæµãè¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿\n\n\n\n\n# åå§èç¹\n\nä¸ä¸ªå¼å§æèµ·å§ç¹ç¨å¤§é»åç¹è¡¨ç¤ºï¼å¦ä¸å¾ã\n\n\n\n\n# ç»æèç¹\n\nç»æèç¹æä¸¤ç§ç±»åï¼æ´»å¨ç»æèç¹åæµç»æèç¹ãæ´»å¨ç»æèç¹è¡¨ç¤ºä¸ºä¸­å¿å¸¦é»ç¹çåç¯ã\n\n\n\næµç»æèç¹è¡¨ç¤ºä¸ºåé¨ä¸ºåå·çåç¯ã\n\n\n\nè¿ä¸¤ç§ä¸åç±»åèç¹çåºå«ä¸ºï¼æµç»æèç¹è¡¨æåç¬çæ§å¶æµçç»ç¹ãæ´»å¨ç»æç»ç¹æ¯æ´»å¨å¾åæææ§å¶æµçç»æã\n\n\n# å¯¹è±¡åå¯¹è±¡æµ\n\nå¯¹è±¡æµæ¯å¯¹è±¡åæ°æ®è½¬éçééãå¯¹è±¡æ¾ç¤ºä¸ºç©å½¢ã\n\n\n\nå¯¹è±¡æµæ¾ç¤ºä¸ºå¸¦ç®­å¤´çè¿æ¥å¨ï¼è¡¨ææ¹ååéè¿çå¯¹è±¡ã\n\n\n\nä¸ä¸ªå¯¹è±¡æµå¨å®çè³å°ä¸ä¸ªç»ç«¯æä¸ä¸ªå¯¹è±¡ãå¨ä¸å¾ä¸­ï¼å¯ä»¥éç¨å¸¦è¾å¥è¾åºå¼èçéè®°æ æ±è¡¨ç¤ºã\n\n\n\næ°æ®å­å¨æ¾ç¤ºä¸ºå¸¦ Â«datastoreÂ» å³é®å­çå¯¹è±¡ã\n\n\n\n\n# å¤æ­èç¹ååå¹¶èç¹\n\nå¤æ­èç¹ååå¹¶èç¹æ¯ç¸åæ æ³¨ï¼è±å½¢ãå®ä»¬å¯ä»¥è¢«å½åãä»å¤æ­èç¹åºæ¥çæ§å¶æµæçæ¤æ¡ä»¶ï¼å½çæ¤æ¡ä»¶æ»¡è¶³æ¶ï¼å¯ä»¥å¯¹æµæ§å¶ãä¸å¾æ¾ç¤ºäºå¤æ­èç¹ååå¹¶èç¹çä½¿ç¨ã\n\n\n\n\n# åååç»åèç¹\n\nåååç»åèç¹æåæ ·çæ æ±ï¼åç´ææ°´å¹³æ¡ï¼æ¹ååå³äºå·¥ä½æµä»å·¦å°å³ï¼è¿æ¯ä»ä¸å°ä¸ï¼ãå®ä»¬è¯´æäºæ§å¶çå¹¶åçº¿ç¨çèµ·å§åç»ç¹ï¼ä¸å¾æ¾ç¤ºä»ä»¬çä½¿ç¨ç¤ºä¾ã\n\n\n\nç»åèç¹ä¸åå¹¶èç¹ä¸åä¹å¤å¨äºï¼ç»åèç¹åæ­¥ä¸¤ä¸ªè¾å¥éï¼äº§çä¸ä¸ªåç¬çè¾åºéãæ¥èªç»åèç¹çè¾åºéè¦æ¥æ¶å°ææçè¾å¥éåæè½æ§è¡ãåå¹¶èç¹ç´æ¥å°æ§å¶æµä¼ ééè¿ãå¦æä¸¤ä¸ªææ´å¤çè¾å¥éå°è¾¾åå¹¶èç¹ãåå®çè¾åºæµæå®çå¨ä½ä¼è¢«æ§è¡ä¸¤æ¬¡ææ´å¤æ¬¡ã\n\n\n# æ©å±å\n\næ©å±åæ¯ä¼æ§è¡å¤æ¬¡çç»ææ´»å¨åãè¾å¥è¾åºæ©å±èç¹è¡¨ç¤ºä¸ºä¸ç»â3 å¢â ï¼ä»£è¡¨å¤ä¸ªéæ©é¡¹ãå³é®è¯ "iterative"ï¼ "parallel" æ "stream"æ¾ç¤ºå¨åºåçå·¦ä¸è§\n\n\n\n\n# å¼å¸¸å¤çå¨\n\nå¼å¸¸å¤çå¨å¨æ´»å¨å¾ä¸­å¯ä»¥å»ºæ¨¡ã\n\n\n\n\n# å¯ä¸­æ­æ´»å¨åº\n\nå¯ä¸­æ­æ´»å¨åºç¯ç»ä¸ç»å¯ä»¥ä¸­æ­çå¨ä½ãå¨ä¸é¢éå¸¸ç®åçä¾å­ä¸­ï¼ å½æ§å¶è¢«ä¼ éå°ç»æè®¢å "Close Order" å¨ä½ï¼å®åå¤ç"Process Order" å¨ä½ä¼æ§è¡ç´å°å®æï¼é¤é"Cancel Request"åæ¶è¯·æ±ä¸­æ­è¢«æ¥åï¼è¿ä¼å°æ§å¶ä¼ éç»"Cancel Order"å¨ä½ã\n\n\n\n\n# åå²\n\nä¸ä¸ªæ´»å¨åå²æ¾ç¤ºä¸ºåç´ææ°´å¹³æ³³éãå¨ä¸å¾ä¸­ï¼åå²è¢«ç¨æ¥å¨æ´»å¨å¾ä¸­åéå¨ä½ï¼æå¨ "accounting department"ä¸­æ§è¡çï¼æå¨ "customer"ä¸­æ§è¡çã\n\n\n\n\n# ç¶ææºå¾\n\n> ç¶ææºå¾ï¼state-machine-diagramï¼å¯¹ä¸ä¸ªåç¬å¯¹è±¡çè¡ä¸ºå»ºæ¨¡ï¼ææå¯¹è±¡å¨å®çæ´ä¸ªçå½å¨æéï¼ååºä¸åäºä»¶æ¶ï¼æ§è¡ç¸å³äºä»¶çé¡ºåºã\n\nå¦ä¸ç¤ºä¾ï¼ ä¸åçç¶ææºå¾æ¾ç¤ºäºé¨å¨å®çæ´ä¸ªçå½å¨æéå¦ä½è¿ä½ã\n\n\n\né¨å¯ä»¥å¤äºä»¥ä¸çä¸ç§ç¶æä¹ä¸ï¼ "Opened"æå¼ç¶æï¼ "Closed"å³é­ç¶æï¼æè"Locked"éå®ç¶æã å®åå«ååºäºä»¶ï¼âOpenâå¼é¨ï¼ âCloseâå³é¨ï¼ âLockâéé¨ å âUnlockâè§£éã æ³¨æï¼ä¸æ¯ææçäºä»¶ï¼å¨ææçç¶æä¸é½æ¯ææçãå¦ï¼ä¸ä¸ªé¨æå¼çæ¶åæ¯ä¸å¯è½éå®çï¼é¤éä½ å³ä¸é¨ãå¹¶ä¸ï¼ç¶æè½¬ç§»å¯è½æéå çæ¤æ¡ä»¶ï¼åè®¾é¨æ¯å¼çï¼å¦æâdoorWay->isEmptyâï¼é¨æ¯ç©ºçï¼è¢«æ»¡è¶³ï¼é£ä¹å®åªè½ååºå³é¨äºä»¶ãç¶ææºå¾ä½¿ç¨çè¯­æ³åçº¦å®å°å¨ä¸é¢çé¨åè¿è¡è®¨è®ºã\n\n\n# ç¶æ\n\nç¶æè¢«è¡¨ç¤ºä¸ºåè§ç©å½¢ï¼ç¶æååå¨éé¢ã\n\n\n\n\n# èµ·å§åç»æç¶æ\n\nåå§ç¶æè¡¨ç¤ºä¸ºå®å¿é»åç¯ï¼å¯ä»¥æ æ³¨åç§°ãç»æç¶æè¡¨ç¤ºä¸ºä¸­å¿å¸¦é»ç¹åç¯ï¼ä¹å¯ä»¥è¢«æ æ³¨åç§°ã\n\n\n\n\n# è½¬ç§»\n\nä¸ä¸ªç¶æå°ä¸ä¸ä¸ªç¶æçè½¬ç§»è¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿ãè½¬ç§»å¯ä»¥æä¸ä¸ªâTriggerâè§¦åå¨ï¼ä¸ä¸ªâGuardâçæ¤æ¡ä»¶åä¸ä¸ªâeffectâææãå¦ä¸æç¤ºï¼\n\n\n\n"Trigger"è§¦åå¨æ¯è½¬ç§»çèµ·å ï¼å®å¯ä»¥æ¯æä¸ªæ¡ä»¶ä¸çä¸ä¸ªä¿¡å·ï¼ä¸ä¸ªäºä»¶ï¼ä¸ä¸ªååæä¸ä¸ªæ¶é´éè·¯ã"Guard"çæ¤æ¯ä¸ä¸ªæ¡ä»¶ï¼èä¸å¿é¡»ä¸ºçï¼ä»¥ä¾¿äºè®©è§¦åå¨å¼èµ·è½¬ç§»ãææ"Effect"æ¯ç´æ¥ä½ç¨å°å¯¹è±¡ä¸çä¸ä¸ªå¨ä½ï¼è¯¥å¯¹è±¡å·æåä¸ºè½¬ç§»ç»æçç¶ææºã\n\n\n# ç¶ææ´»å¨\n\nå¨ä¸é¢çç¶æè½¬ç§»ç¤ºä¾ä¸­ï¼ä¸ä¸ªææä¸è¯¥è½¬ç§»ç¸å³èãå¦æç®æ ç¶ææå¤ä¸ªè½¬ç§»å°è¾¾ï¼å¹¶ä¸æ¯ä¸ä¸ªè½¬ç§»é½æç¸åçææä¸å®ç¸å³èï¼é£æå¥½å°è¯¥ææä¸ç®æ ç¶æç¸å³èï¼èä¸ä¸è½¬ç§»ç¸å³èãä½ å¯ä»¥éè¿ä¸ºè¿ä¸ªç¶æå®ä¹åå§å¨ä½æ¥å®ç°ãä¸å¾æ¾ç¤ºäºä¸ä¸ªå¸¦å¥å£å¨ä½ååºå£å¨ä½çç¶æã\n\n\n\nå¯ä»¥å®ä¹åçå¨äºä»¶ä¸çå¨ä½æä¸ç´åççå¨ä½ãæ¯ä¸ç§ç±»åçå¨ä½æ¯å¯ä»¥å®ä¹ä»»ææ°éçã\n\n\n# èªè½¬ç§»\n\nä¸ä¸ªç¶æå¯è½æä¸ä¸ªè¿åå°èªèº«çè½¬ç§»ï¼å¦ä¸å¾ãææä¸è½¬ç§»å³èæ¯ååæå¸®å©ã\n\n\n\n\n# å¤åç¶æ\n\nä¸ä¸ªç¶ææºå¾å¯ä»¥æå­ç¶ææºå¾ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\nå¯éæ©ä¸åæ¹å¼æ¾ç¤ºç¸åä¿¡æ¯ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\nä¸é¢çæ¬çæ æ³¨è¯´æ"Check PIN"çå­ç¶ææºå¾æ¾ç¤ºå¨åç¬çå¾ä¸­ã\n\n\n# å¥å£ç¹\n\nææ¶ï¼ä½ ä¸æ³å¨æ­£å¸¸çåå§ç¶æè¿å¥å­ç¶ææºãä¾å¦ä¸é¢çå­ç¶ææºï¼å®éå¸¸ä»"åå§å"ç¶æå¼å§ï¼ä½æ¯å¦æå ä¸ºæäºåå ï¼å®ä¸å¿æ§è¡åå§åï¼å¯è½é è½¬ç§»å°æå®çå¥å£ç¹æ¥ä» "Ready" ç¶æå¼å§ã\n\n\n\nä¸å¾æ¾ç¤ºäºç¶ææºçä¸ä¸å±ã\n\n\n\n\n# åºå£ç¹\n\næä¸å¥å£ç¹ç¸ç±»ä¼¼çæ¹å¼ï¼å®å¯è½ä¹æå®å¯éæ©çåºå£ç¹ãä¸å¾ç»åºäºä¸»å¤çç¶ææ§è¡åï¼ææ§è¡ç¶æçå»åå°åå³äºè¯¥ç¶æè½¬ç§»æ¶æä½¿ç¨çè·¯å¾ã\n\n\n\n\n# éæ©ä¼ªç¶æ\n\néæ©ä¼ªç¶ææ¾ç¤ºä¸ºè±å½¢ï¼æä¸ä¸ªè½¬ç§»è¾å¥ï¼ä¸¤ä¸ªæå¤ä¸ªè¾åºãä¸å¾æ¾ç¤ºä¸ç®¡å°è¾¾åªä¸ä¸ªç¶æï¼ç»è¿éæ©ä¼ªç¶æåçå»åï¼åå³äºå¨ä¼ªç¶æä¸­æ§è¡æ¶æéæ©çæ¶æ¯æ ¼å¼ã\n\n\n\n\n# è¿æ¥ä¼ªç¶æ\n\nè¿æ¥ä¼ªç¶æç¨æ¥å°å¤ä¸ªç¶æè½¬ç§»é¾æ¥å¨ä¸èµ·ãä¸ä¸ªåç¬çè¿æ¥ä¼ªç¶æå¯ä»¥æä¸ä¸ªæå¤ä¸ªè¾å¥åä¸ä¸ªæå¤ä¸ªè¾åºï¼çæ¤å¯è½åºç¨äºæ¯ä¸ä¸ªè½¬ç§»ï¼è¿æ¥æ¯æ²¡æè¯­ä¹çãè¿æ¥å¯ä»¥æä¸ä¸ªè¾å¥è½¬ç§»åæå¤ä¸ªè¾åºè½¬ç§»æ¥å®ç°ä¸ä¸ªéæåæ¯ãä¸ä¹å¯¹ç§çæ¯éæ©ä¼ªç¶æå®ç°ä¸ä¸ªå¨ææ¡ä»¶åæ¯ã\n\n\n\n\n# ç»æ­¢ä¼ªç¶æ\n\nè¿å¥ç»æ­¢ä¼ªç¶ææ¯æç¶ææºçå½çº¿å·²ç»ç»æ­¢ãç»æ­¢ä¼ªç¶æè¡¨ç¤ºä¸ºåå·ã\n\n\n\n\n# åå²ç¶æ\n\nåå²ç¶æç¨æ¥å½ç¶ææºä¸­æ­æ¶ï¼æ¢å¤ç¶ææºä¹åç¶æãä¸é¢ä¾å¾è¯´æäºåå²ç¶æçä½¿ç¨ãè¿ä¸ªä¾å­æ¯å³äºæ´è¡£æºçç¶ææºã\n\nå¨è¿ä¸ªç¶ææºä¸­ï¼å½æ´è¡£æºè¿è¡æ¶ï¼å®ä¼æç§"Washing" å° Rinsing"åå°"Spinning"æ¥è¿è¡ãå¦æçµæºè¢«åæ­ ï¼æ´è¡£æºä¼åæ­¢è¿è¡å¹¶è¿å¥"Power Off" ç¶æãå½çµæºæ¢å¤ï¼è¿è¡ç¶æå¨"History State"ç¬¦å·å¤è¿å¥ï¼è¡¨ç¤ºå®ä¼ä»ä¸æ¬¡ç¦»å¼çå°æ¹æ¢å¤ã\n\n\n# å¹¶ååº\n\nä¸ä¸ªç¶æå¯ä»¥è¢«åæå ä¸ªä¸åçåºï¼åå«åæ¶å­å¨åæ§è¡çå­ç¶æãä¸é¢çä¾å­æ¾ç¤ºç¶æ "Applying Brakes"ï¼ "front brake"å"rear brakes" å°åæ¶ç¬ç«è¿ä½ãæ³¨æä½¿ç¨äºåååç»åä¼ªç¶æèä¸æ¯éæ©ååå¹¶ä¼ªç¶æãè¿äºç¬¦å·ç¨æ¥åæ­¥å¹¶åççº¿ç¨ã\n\n\n\n\n# ç¨ä¾å¾\n\n> ç¨ä¾å¾ç¨æ¥è®°å½ç³»ç»çéæ±ï¼å®æä¾ç³»ç»ä¸ç¨æ·åå¶ä»åä¸èçä¸ç§éä¿¡ææ®µã\n\n\n# æ§è¡è\n\nç¨ä¾å¾æ¾ç¤ºäºç³»ç»åç³»ç»å¤å®ä½ä¹é´çäº¤äºãè¿äºå®ä½è¢«å¼ç¨ä¸ºæ§è¡èãæ§è¡èä»£è¡¨è§è²ï¼å¯ä»¥åæ¬ï¼ç¨æ·ï¼å¤é¨ç¡¬ä»¶åå¶ä»ç³»ç»ãæ§è¡èå¾å¾è¢«ç»æç®ç¬ç»å°äººãä¹å¯ä»¥ç¨å¸¦Â«actorÂ»å³é®å­çç±»ç©å½¢è¡¨ç¤ºã\n\n\n\nå¨ä¸å¾ä¸­ï¼æ§è¡èå¯ä»¥è¯¦ç»çæ³åå¶ä»æ§è¡è:\n\n\n\n\n# ç¨ä¾\n\nç¨ä¾æ¯ææä¹çåç¬å·¥ä½ååãå®åç³»ç»å¤é¨çäººæäºæä¾ä¸ä¸ªæäºè§å¯çé«å±æ¬¡è¡ä¸ºè§å¾ã ç¨ä¾çæ æ³¨ç¬¦å·æ¯ä¸ä¸ªæ¤­åã\n\n\n\nä½¿ç¨ç¨ä¾çç¬¦å·æ¯å¸¦å¯éæ©ç®­å¤´çè¿æ¥çº¿ï¼ç®­å¤´æ¾ç¤ºæ§å¶çæ¹åãä¸å¾è¯´ææ§è¡è "Customer"ä½¿ç¨ "Withdraw"ç¨ä¾ã\n\n\n\nç¨éè¿æ¥å¨ï¼uses connectorï¼å¯ä»¥æéæ©æ§çå¨æ¯ä¸ä¸ªç«¯ç¹æå¤éæ§å¼ï¼å¦ä¸å¾ï¼æ¾ç¤ºå®¢æ·ä¸æ¬¡å¯è½åªæ§è¡ä¸æ¬¡åæ¬¾äº¤æãä½æ¯é¶è¡å¯ä»¥åæ¶æ§è¡è®¸å¤åæ¬¾äº¤æã\n\n\n\n\n# ç¨ä¾å®ä¹\n\nä¸ä¸ªå¸åçç¨ä¾åæ¬:\n\n * åç§°åæè¿° - ç¨ä¾éå¸¸ç¨ä¸ä¸ªå¨è¯è¯ç»å®ä¹ï¼èä¸æä¸ä¸ªç®ç­çæå­è¯´æã\n * éæ± - éæ±å®ä¹äºä¸ä¸ªç¨ä¾å¿é¡»æä¾ç»ç»ç«¯ç¨æ·çæ­£å¼åè½æ§éæ±ãå®ä»¬ç¬¦åæé æ¹æ³å»ºç«çåè½æ§è§èãä¸ä¸ªéæ±æ¯ç¨ä¾å°æ§è¡ä¸ä¸ªå¨ä½ææä¾å¤ä¸ªå¼ç»ç³»ç»ççº¦å®ææ¿è¯ºã\n * çº¦æ - ä¸ä¸ªçº¦ææ¯ä¸ä¸ªç¨ä¾è¿è¡çæ¡ä»¶æéå¶ãå®åæ¬ï¼åç½®æ¡ä»¶ï¼åç½®æ¡ä»¶åä¸ååæ¡ä»¶ ãåç½®æ¡ä»¶ææäºç¨ä¾å¨åçä¹åéè¦ç¬¦åçæ¡ä»¶ãåç½®æ¡ä»¶ç¨æ¥è¯´æå¨ç¨ä¾æ§è¡ä¹åä¸äºæ¡ä»¶å¿é¡»ä¸º"ç"ãä¸ååæ¡ä»¶è¯´æç¨ä¾æ´ä¸ªæ§è¡è¿ç¨ä¸­è¯¥æ¡ä»¶å§ç»ä¸º"ç"ã\n * æå½¢ - æå½¢æ¯ç¨ä¾çå®ä¾å¨æ§è¡è¿ç¨ä¸­ï¼äºä»¶åçæµç¨çå½¢å¼æè¿°ãå®å®ä¹äºç³»ç»åå¤é¨æ§è¡èä¹é´çäºä»¶æå®é¡ºåºãéå¸¸ç¨ææ¬æ¹å¼æ¥è¡¨ç¤ºï¼å¹¶å¯¹åºæ¶åºå¾ä¸­çæå­æè¿°ã\n * æå½¢å¾\n * éå ä¿¡æ¯\n\n\n# åå«ç¨ä¾\n\nç¨ä¾å¯è½åå«å¶ä»ç¨ä¾çåè½æ¥ä½ä¸ºå®æ­£å¸¸å¤ççä¸é¨åãéå¸¸å®åè®¾ï¼ä»»ä½è¢«åå«çç¨ä¾å¨åºæ¬ç¨åºè¿è¡æ¶æ¯ä¸æ¬¡é½ä¼è¢«è°ç¨ãä¸é¢ä¾å­ï¼ç¨ä¾âå¡çç¡®è®¤â å¨è¿è¡æ¶ï¼è¢«ç¨ä¾âåé±âå½ä½ä¸ä¸ªå­é¨åã\n\n\n\nç¨ä¾å¯ä»¥è¢«ä¸ä¸ªæå¤ä¸ªç¨ä¾åå«ãéè¿æç¼éç¨çè¡ä¸ºï¼å°å®åæå¯ä»¥å¤æ¬¡éå¤ä½¿ç¨çç¨ä¾ãæå©äºéä½åè½éå¤çº§å«ã\n\n\n# æ©å±ç¨ä¾\n\nä¸ä¸ªç¨ä¾å¯ä»¥è¢«ç¨æ¥æ©å±å¦ä¸ä¸ªç¨ä¾çè¡ä¸ºï¼éå¸¸ä½¿ç¨å¨ç¹å«æåµä¸ãä¾å¦ï¼åè®¾å¨ä¿®æ¹ä¸ä¸ªç¹å«ç±»åçå®¢æ·è®¢åä¹åï¼ç¨æ·å¿é¡»å¾å°æç§æ´é«çº§å«çè®¸å¯ï¼ç¶åâè·å¾è®¸å¯âç¨ä¾å°æéæ©çæ©å±å¸¸è§çâä¿®æ¹è®¢åâç¨ä¾ã\n\n\n\næ©å±ç¹ - æ©å±ç¨ä¾çå å¥ç¹è¢«å®ä¹ä¸ºæ©å±ç¹ã\n\n\n\nç³»ç»è¾¹ç - å®ç¨æ¥æ¾ç¤ºç¨ä¾å¨ç³»ç»åé¨ï¼æ§è¡èå¨ç³»ç»çå¤é¨ã\n\n\n\n\n# éä¿¡å¾\n\n> éä¿¡å¾ï¼ä»¥åç§°ä¹ä¸ºåä½å¾ï¼æ¯ä¸ç§äº¤äºå¾ï¼ææ¾ç¤ºæ¶æ¯ä¸æ¶åºå¾ç¸ä¼¼ï¼ä½æ¯å®æ´ä¾§éäºå¯¹è±¡é´çèç³»ã\n\nå¨éä¿¡å¾ä¸­ï¼å¯¹è±¡ä¹é´æ¾ç¤ºå³èè¿æ¥å¨ãæ¶æ¯éå å°è¿äºå³èä¸ï¼æ¾ç¤ºç­ç®­å¤´æåæ¶æ¯æµçæ¹åãæ¶æ¯çé¡ºåºéè¿ç¼å·ç æ¾ç¤ºã\n\nä¸é¢çä¸¤ä¸ªå¾ç¨éä¿¡å¾åæ¶åºå¾åå«æ¾ç¤ºç¸åçä¿¡æ¯ãå°½ç®¡æä»¬å¯è½ä»éä¿¡å¾çç¼å·ç å¾å°æ¶æ¯é¡ºåºï¼ä½å®ä¸æ¯ç«å³å¯è§çãéä¿¡å¾ååæ¸æ¥çæ¾ç¤ºäºé»è¿å¯¹è±¡é´å¨é¨å®æ´çæ¶æ¯ä¼ éã\n\n\n\n\n\n# äº¤äºæ¦è¿°å¾\n\n> ä¸ä¸ªäº¤äºæ¦è§å¾æ¯æ´»å¨å¾çä¸ç§å½¢å¼ï¼å®çèç¹ä»£è¡¨äº¤äºå¾ãäº¤äºå¾åå«æ¶åºå¾ï¼éä¿¡å¾ï¼äº¤äºæ¦è§å¾åæ¶é´å¾ã å¤§å¤æ°äº¤äºæ¦è§å¾æ æ³¨ä¸æ´»å¨å¾ä¸æ ·ãä¾å¦ï¼èµ·å§ï¼ç»æï¼å¤æ­ï¼åå¹¶ï¼åååç»åèç¹æ¯å®å¨ç¸åãå¹¶ä¸ï¼äº¤äºæ¦è§å¾ä»ç»äºä¸¤ç§æ°çåç´ ï¼äº¤äºåçåäº¤äºåç´ ã\n\n\n# äº¤äºåç\n\näº¤äºåçå¼ç¨ç°æçäº¤äºå¾ãæ¾ç¤ºä¸ºä¸ä¸ªå¼ç¨æ¡ï¼å·¦ä¸è§æ¾ç¤º "ref" ãè¢«å¼ç¨çå¾åæ¾ç¤ºå¨æ¡çä¸­å¤®ã\n\n\n\n\n# äº¤äºåç´ \n\näº¤äºåç´ ä¸äº¤äºåçç¸ä¼¼ä¹å¤å¨äºé½æ¯å¨ä¸ä¸ªç©å½¢æ¡ä¸­æ¾ç¤ºä¸ä¸ªç°æçäº¤äºå¾ãä¸åä¹å¤å¨åé¨æ¾ç¤ºåèå¾çåå®¹ä¸åã\n\n\n\n\n# å°å®ä»¬æ¾å¨ä¸èµ·\n\nææçæ´»å¨å¾æ§ä»¶ï¼é½å¯ä»¥ç¸åå°è¢«ä½¿ç¨äºäº¤äºæ¦è§å¾ï¼å¦ï¼ååï¼ç»åï¼åå¹¶ç­ç­ãå®ææ§å¶é»è¾æ¾å¥è¾ä½ä¸çº§çå¾ä¸­ãä¸é¢çä¾å­å°±è¯´æäºä¸ä¸ªå¸åçéå®è¿ç¨ãå­è¿ç¨æ¯ä»äº¤äºåçæ½è±¡èæ¥ã\n\n\n\n\n# æ¶åºå¾\n\n> æ¶åºå¾æ¯äº¤äºå¾çä¸ç§å½¢å¼ï¼å®æ¾ç¤ºå¯¹è±¡æ²¿çå½çº¿åå±ï¼å¯¹è±¡ä¹é´éæ¶é´çäº¤äºè¡¨ç¤ºä¸ºä»æºçå½çº¿æåç®æ çå½çº¿çæ¶æ¯ãæ¶åºå¾è½å¾å¥½å°æ¾ç¤ºé£äºå¯¹è±¡ä¸å¶å®é£äºå¯¹è±¡éä¿¡ï¼ä»ä¹æ¶æ¯è§¦åäºè¿äºéä¿¡ï¼æ¶åºå¾ä¸è½å¾å¥½æ¾ç¤ºå¤æè¿ç¨çé»è¾ã\n\n\n# çå½çº¿\n\nä¸æ¡çå½çº¿å¨æ¶åºå¾ä¸­ä»£è¡¨ä¸ä¸ªç¬ç«çåä¸èãè¡¨ç¤ºä¸ºåå«å¯¹è±¡åçç©å½¢ï¼å¦æå®çåå­æ¯"self"ï¼åè¯´æè¯¥çå½çº¿ä»£è¡¨æ§å¶å¸¦æ¶åºå¾çç±»åã\n\n\n\nææ¶ï¼æ¶åºå¾ä¼åå«ä¸ä¸ªé¡¶ç«¯æ¯æ§è¡èççå½çº¿ãè¿æåµè¯´æææ¡è¿ä¸ªæ¶åºå¾çæ¯ç¨ä¾ãå¥å£®å¾ä¸­çè¾¹çï¼æ§å¶åå®ä½åç´ ä¹å¯ä»¥æçå½çº¿ã\n\n\n\n\n# æ¶æ¯\n\næ¶æ¯æ¾ç¤ºä¸ºç®­å¤´ãæ¶æ¯å¯ä»¥å®æä¼ è¾ï¼ä¹å¯è½ä¸¢å¤±åæ¾åï¼å®å¯ä»¥æ¯åæ­¥çï¼ä¹å¯ä»¥æ¯å¼æ­¥çï¼å³å¯ä»¥æ¯è°ç¨ï¼ä¹å¯ä»¥æ¯ä¿¡å·ãå¨ä¸å¾ä¸­ï¼ç¬¬ä¸æ¡æ¶æ¯æ¯åæ­¥æ¶æ¯(æ ä¸ºå®ç®­å¤´)å®æä¼ è¾ï¼å¹¶éå«ä¸æ¡è¿åæ¶æ¯ãç¬¬äºæ¡æ¶æ¯æ¯å¼æ­¥æ¶æ¯ (æ ä¸ºå®çº¿ç®­å¤´)ï¼ç¬¬ä¸æ¡æ¯å¼æ­¥è¿åæ¶æ¯(æ ä¸ºèçº¿)ã\n\n\n\n\n# æ§è¡åç\n\nåä¸å»¶ä¼¸çç»æ¡ç¶ç©å½¢è¡¨ç¤ºæ§è¡äºä»¶ææ§å¶ç¦ç¹çæ¿æ´»ãå¨ä¸å¾ä¸­æä¸ä¸ªæ§è¡äºä»¶ãç¬¬ä¸ä¸ªæ¯æºå¯¹è±¡åéä¸¤æ¡æ¶æ¯åæ¶å°ä¸¤æ¡åå¤ãç¬¬äºä¸ªæ¯ç®æ å¯¹è±¡æ¶å°ä¸æ¡åæ­¥æ¶æ¯å¹¶è¿åä¸æ¡åå¤ãç¬¬ä¸ä¸ªæ¯ç®æ å¯¹è±¡æ¶å°ä¸æ¡å¼æ­¥æ¶æ¯å¹¶è¿åä¸æ¡åå¤ã\n\n\n# åé¨éä¿¡\n\nåé¨æ¶æ¯è¡¨ç°ä¸ºä¸ä¸ªæä½çéå½è°ç¨ï¼æä¸ä¸ªæ¹æ³è°ç¨å±äºåä¸ä¸ªå¯¹è±¡çå¶ä»æ¹æ³ãæ¾ç¤ºä¸ºçå½çº¿ä¸æ§è¡äºä»¶çåµå¥æ§å¶ç¦ç¹ã\n\n\n\n\n# è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯\n\nè¿·è·¯æ¶æ¯æ¯é£äºåéäºå´æ²¡æå°è¾¾æå®æ¥æ¶èï¼æèå°è¾¾çæ¥æ¶èä¸åå½åå¾ä¸­ãæ¾åæ¶æ¯æ¯æ¶å°æ¥èªé£äºæªç¥çåéèï¼æèæ¥èªæ²¡ææ¾ç¤ºå¨å½åå¾çåéèçæ¶æ¯ãå®ä»¬é½è¡¨ææ¯å»å¾ææ¥èªä¸ä¸ªç»ç¹åç´ ã\n\n\n\n\n# çå½çº¿å¼å§ä¸ç»æ\n\nçå½çº¿å¯ä»¥å¨æ¶åºå¾æ¶é´å»åº¦èå´ååå»ºåéæ¯ï¼å¨ä¸é¢çä¾å­ä¸­ï¼çå½çº¿è¢«åæ­¢ç¬¦å·ï¼åå·ï¼ç»æ­¢ãå¨åé¢çä¾å­ä¸­ï¼çå½çº¿é¡¶ç«¯çç¬¦å·ï¼Childï¼æ¾ç¤ºå¨æ¯åå»ºå®çå¯¹è±¡ç¬¦å·ï¼parentï¼æ²¿é¡µé¢è¦ä½çä½ç½®ä¸ãä¸å¾æ¾ç¤ºåå»ºåç»æ­¢å¯¹è±¡ã\n\n\n\n\n# æ¶é´åæéçº¦æ\n\næ¶æ¯é»è®¤æ¾ç¤ºä¸ºæ°´å¹³çº¿ãå ä¸ºçå½çº¿æ¾ç¤ºä¸ºæ²¿å±å¹åä¸çæ¶é´ééï¼æä»¥å½ç»å®æ¶ç³»ç»å»ºæ¨¡ï¼ææ¯ææ¶é´çº¦æçä¸å¡è¿ç¨å»ºæ¨¡ï¼èèæ§è¡å¨ä½æéæ¶é´é¿åº¦æ¯å¾éè¦çãå æ­¤å¯ä»¥ç»æ¶æ¯è®¾ç½®ä¸ä¸ªæéçº¦æï¼è¿æ ·çæ¶æ¯æ¾ç¤ºä¸ºä¸æçº¿ã\n\n\n\n\n# å¤åçæ®µ\n\nå¦åé¢æè¯´ï¼æ¶åºå¾ä¸éåè¡¨è¾¾å¤æçè¿ç¨é»è¾ãå¨ä¸ç§æåµä¸ï¼æè®¸å¤æºå¶åè®¸æä¸å®ç¨åº¦çè¿ç¨é»è¾å å¥å°å¾ä¸­ï¼å¹¶æå®ä»¬æ¾å°å¤åçæ®µçæ é¢ä¸ãå¤åçæ®µæ¯ä¸ä¸ªæå¤ä¸ªå¤çé¡ºåºè¢«åå«å¨ä¸ä¸ªæ¡æ¶ä¸­ï¼å¹¶å¨æå®åç§°çç¯å¢ä¸æ§è¡ãçæ®µå¯ä»¥æ¯:\n\n * éæ©æ§çæ®µ (æ¾ç¤º âaltâ) ä¸º ifâ¦thenâ¦else ç»æå»ºæ¨¡ã\n * éé¡¹çæ®µ (æ¾ç¤º âoptâ) ä¸º "switch"(å¼å³) ç»æå»ºæ¨¡ã\n * ä¸­æ­çæ®µå¯¹è¢«å¤çäºä»¶çå¯éæ©é¡ºåºå»ºæ¨¡ï¼èä¸æ¯è¯¥å¾çå¶ä»é¨åã\n * å¹¶è¡çæ®µ(æ¾ç¤º âparâ) ä¸ºå¹¶åå¤çå»ºæ¨¡ã\n * å¼±é¡ºåºçæ®µ (æ¾ç¤º âseqâ) åå«äºä¸ç»æ¶æ¯ï¼è¿ç»æ¶æ¯å¿é¡»å¨åç»§çæ®µå¼å§ä¹åè¢«å¤çãä½ä¸ä¼æçæ®µåæ¶æ¯çååé¡ºåºå¼ºå å°ä¸å±äº«åä¸æ¡çå½çº¿çæ¶æ¯ä¸ã\n * ä¸¥æ ¼é¡ºåºçæ®µ (æ¾ç¤º âstrictâ) åå«äºä¸ç³»åéè¦æç§ç»å®é¡ºåºå¤ççæ¶æ¯ã\n * éçæ®µ (æ¾ç¤º ânegâ) åå«äºä¸ç³»åä¸å¯ç¨çæ¶æ¯ã\n * å³é®çæ®µ å·æå³é®é¨åã\n * å¿½ç¥çæ®µ å£°æä¸ä¸ªæ²¡ææä¹çæ¶æ¯ï¼å¦æå®åºç°å¨å½åä¸ä¸æä¸­ã\n * èèçæ®µä¸å¿½ç¥çæ®µç¸åï¼ä¸åå«å¨èèçæ®µåçæ¶æ¯é½åºè¯¥è¢«å¿½ç¥ã\n * æ­è¨çæ®µ (æ¾ç¤º âassertâ)æ æä»»ä½æ²¡ææ¾ç¤ºä¸ºå£°ææä½æ°çé¡ºåºé½æ¯æ æçã\n * å¾ªç¯çæ®µ åå«ä¸ç³»åè¢«éå¤çæ¶æ¯ã\n\nä¸å¾æ¾ç¤ºçæ¯å¾ªç¯çæ®µï¼\n\n\n\nè¿ä¹æ¯ä¸ä¸ªç±»ä¼¼äºå¤åçæ®µçäº¤äºåçã äº¤äºåçè¢«å¶ä»å¾åèï¼æ¾ç¤ºä¸ºå·¦ä¸è§å¸¦"ref"ï¼å°è¢«åèå¾åæ¾ç¤ºå¨æ¹æ¡çä¸­é´ã\n\n\n# é¨\n\né¨æ¯è¿æ¥çæ®µåæ¶æ¯åçæ®µå¤æ¶æ¯çè¿æ¥ç¹ã å¨ EA ä¸­ï¼é¨æ¾ç¤ºä¸ºçæ®µæ¡æ¶ä¸çå°æ­£æ¹å½¢ãä½ç¨ä¸ºæ¶åºå¾ä¸é¡µé¢å¤çè¿æ¥å¨ã ç¨æ¥è¡¨ç¤ºè¿æ¥çæ¶æ¯æºï¼æèåºå»æ¶æ¯çç»ç¹ãä¸é¢ä¸¤ä¸ªå¾æ¾ç¤ºå®ä»¬å¨å®è·µä¸­çä½¿ç¨ãæ³¨æï¼" top level diagram"ä¸­çé¨ç¨æ¶æ¯ç®­å¤´æååèçæ®µï¼å¨è¿éæ²¡æå¿è¦æå®ç»ææ¹åã\n\n\n\n\n\n# é¨ååè§£\n\nä¸ä¸ªå¯¹è±¡å¯ä»¥å¼åºå¤æ¡çå½çº¿ï¼ä½¿å¾å¯¹è±¡åé¨åå¯¹è±¡ä¹é´çæ¶æ¯æ¾ç¤ºå¨åä¸å¾ä¸ã\n\n\n\n\n# ç¶æå¸¸é/å»¶ç»­\n\nç¶æå¸¸éæ¯çå½çº¿ççº¦æï¼è¿è¡æ¶å§ç»ä¸º"ç"ãæ¾ç¤ºä¸ºä¸¤ä¾§ååçç©å½¢ï¼å¦ä¸å¾ï¼\n\n\n\nå»¶ç»­è½ä¸ç¶æå¸¸éæåæ ·çæ æ³¨ï¼ä½æ¯è¢«ç¨äºå¤åçæ®µï¼å¹¶å¯ä»¥å»¶ä¼¸è·¨è¶å¤æ¡çå½çº¿ã\n\n\n# æ¶é´å¾\n\n> UML æ¶é´å¾è¢«ç¨æ¥æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªæå¤ä¸ªåç´ çå¼æç¶æçæ´æ¹ãä¹æ¾ç¤ºæ¶æ§äºä»¶ä¹é´çäº¤äºåç®¡çå®ä»¬çæ¶é´åæéçº¦æã\n\n\n# ç¶æçå½çº¿\n\nç¶æçå½çº¿æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªåé¡¹ç¶æçæ¹åãä¸è®ºæ¶é´åä½å¦ä½éæ©ï¼X è½´æ¾ç¤ºç»è¿çæ¶é´ï¼Y è½´è¢«æ ä¸ºç»åºç¶æçåè¡¨ãç¶æçå½çº¿å¦ä¸æç¤ºï¼\n\n\n\n\n# å¼çå½çº¿\n\nå¼çå½çº¿æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªåé¡¹çå¼çååãX è½´æ¾ç¤ºç»è¿çæ¶é´ï¼æ¶é´åä½ä¸ºä»»æï¼åç¶æçå½çº¿ä¸æ ·ãå¹³è¡çº¿ä¹é´æ¾ç¤ºå¼ï¼æ¯æ¬¡å¼ååï¼å¹³è¡çº¿äº¤åãå¦ä¸å¾æç¤ºã\n\n\n\n\n# å°å®ä»¬æ¾å¨ä¸èµ·\n\nç¶æåå¼ççå½çº¿è½å å ç»åãå®ä»¬å¿é¡»æç¸åç X è½´ã æ¶æ¯å¯ä»¥ä»ä¸ä¸ªçå½çº¿ä¼ éå°å¦ä¸ä¸ªãæ¯ä¸ä¸ªç¶æåå¼çåæ¢è½æä¸ä¸ªå®ä¹çäºä»¶ï¼ä¸ä¸ªæ¶é´éå¶æ¯æä¸ä¸ªäºä»¶ä½æ¶å¿é¡»åçï¼åä¸ä¸ªæééå¶è¯´æç¶ææå¼å¤é¿æ¶é´å¿é¡»ææãä¸æ¦è¿äºå·²ç»è¢«åºç¨ï¼å¶æ¶é´å¾å¯è½æ¾ç¤ºå¦ä¸ã\n\n\n\n\n# åèèµæ\n\n * https://sparxsystems.cn/resources/uml2_tutorial/index.html',normalizedContent:'# è¡ä¸ºå»ºæ¨¡å¾\n\n> è¡ä¸ºå¾ç¨æ¥è®°å½å¨ä¸ä¸ªæ¨¡ååé¨ï¼éæ¶é´çååï¼æ¨¡åæ§è¡çäº¤äºåååç¬é´çç¶æï¼å¹¶è·è¸ªç³»ç»å¨çå®ç¯å¢ä¸å¦ä½è¡¨ç°ï¼ä»¥åè§å¯ç³»ç»å¯¹ä¸ä¸ªæä½æäºä»¶çååºï¼ä»¥åå®çç»æã\n> \n> å³é®è¯ï¼æ´»å¨å¾, ç¶ææºå¾, ç¨ä¾å¾, éä¿¡å¾, äº¤äºæ¦è¿°å¾, æ¶åºå¾, æ¶é´å¾\n\n\n# æ´»å¨å¾\n\n> uml ä¸­ï¼æ´»å¨å¾ç¨æ¥å±ç¤ºæ´»å¨çé¡ºåºãæ¾ç¤ºäºä»èµ·å§ç¹å°ç»ç¹çå·¥ä½æµï¼æè¿°äºæ´»å¨å¾ä¸­å­å¨äºäºä»¶è¿ç¨çå¤æ­è·¯å¾ãæ´»å¨å¾å¯ä»¥ç¨æ¥è¯¦ç»éè¿°æäºæ´»å¨æ§è¡ä¸­åçå¹¶è¡å¤ççæåµãæ´»å¨å¾å¯¹ä¸å¡å»ºæ¨¡ä¹æ¯è¾æç¨ï¼ç¨æ¥è¯¦ç»æè¿°åçå¨ä¸å¡æ´»å¨ä¸­çè¿ç¨ã ä¸ä¸ªæ´»å¨å¾çç¤ºä¾å¦ä¸æç¤ºã\n\n\n\nä¸é¢æè¿°ç»ææ´»å¨å¾çåç´ ã\n\n\n# æ´»å¨\n\næ´»å¨æ¯è¡ä¸ºåæ°åé¡ºåºçè§èãæ´»å¨è¢«è¡¨ç¤ºä¸ºåè§ç©å½¢ï¼åå«å¨é¨çå¨ä½ï¼å·¥ä½æµåå¶ä»ç»ææ´»å¨çåç´ ã\n\n\n\n\n# å¨ä½\n\nä¸ä¸ªå¨ä½ä»£è¡¨æ´»å¨ä¸­çä¸ä¸ªæ­¥éª¤ãå¨ä½ç¨åè§ç©å½¢è¡¨ç¤ºã\n\n\n\n\n# å¨ä½çº¦æ\n\nå¨ä½å¯ä»¥éå¸¦çº¦æï¼ä¸å¾æ¾ç¤ºäºä¸ä¸ªå¸¦åç½®æ¡ä»¶ååç½®æ¡ä»¶çå¨ä½ã\n\n\n\n\n# æ§å¶æµ\n\næ§å¶æµæ¾ç¤ºä¸ä¸ªå¨ä½å°ä¸ä¸ä¸ªå¨ä½çæµãè¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿\n\n\n\n\n# åå§èç¹\n\nä¸ä¸ªå¼å§æèµ·å§ç¹ç¨å¤§é»åç¹è¡¨ç¤ºï¼å¦ä¸å¾ã\n\n\n\n\n# ç»æèç¹\n\nç»æèç¹æä¸¤ç§ç±»åï¼æ´»å¨ç»æèç¹åæµç»æèç¹ãæ´»å¨ç»æèç¹è¡¨ç¤ºä¸ºä¸­å¿å¸¦é»ç¹çåç¯ã\n\n\n\næµç»æèç¹è¡¨ç¤ºä¸ºåé¨ä¸ºåå·çåç¯ã\n\n\n\nè¿ä¸¤ç§ä¸åç±»åèç¹çåºå«ä¸ºï¼æµç»æèç¹è¡¨æåç¬çæ§å¶æµçç»ç¹ãæ´»å¨ç»æç»ç¹æ¯æ´»å¨å¾åæææ§å¶æµçç»æã\n\n\n# å¯¹è±¡åå¯¹è±¡æµ\n\nå¯¹è±¡æµæ¯å¯¹è±¡åæ°æ®è½¬éçééãå¯¹è±¡æ¾ç¤ºä¸ºç©å½¢ã\n\n\n\nå¯¹è±¡æµæ¾ç¤ºä¸ºå¸¦ç®­å¤´çè¿æ¥å¨ï¼è¡¨ææ¹ååéè¿çå¯¹è±¡ã\n\n\n\nä¸ä¸ªå¯¹è±¡æµå¨å®çè³å°ä¸ä¸ªç»ç«¯æä¸ä¸ªå¯¹è±¡ãå¨ä¸å¾ä¸­ï¼å¯ä»¥éç¨å¸¦è¾å¥è¾åºå¼èçéè®°æ æ±è¡¨ç¤ºã\n\n\n\næ°æ®å­å¨æ¾ç¤ºä¸ºå¸¦ Â«datastoreÂ» å³é®å­çå¯¹è±¡ã\n\n\n\n\n# å¤æ­èç¹ååå¹¶èç¹\n\nå¤æ­èç¹ååå¹¶èç¹æ¯ç¸åæ æ³¨ï¼è±å½¢ãå®ä»¬å¯ä»¥è¢«å½åãä»å¤æ­èç¹åºæ¥çæ§å¶æµæçæ¤æ¡ä»¶ï¼å½çæ¤æ¡ä»¶æ»¡è¶³æ¶ï¼å¯ä»¥å¯¹æµæ§å¶ãä¸å¾æ¾ç¤ºäºå¤æ­èç¹ååå¹¶èç¹çä½¿ç¨ã\n\n\n\n\n# åååç»åèç¹\n\nåååç»åèç¹æåæ ·çæ æ±ï¼åç´ææ°´å¹³æ¡ï¼æ¹ååå³äºå·¥ä½æµä»å·¦å°å³ï¼è¿æ¯ä»ä¸å°ä¸ï¼ãå®ä»¬è¯´æäºæ§å¶çå¹¶åçº¿ç¨çèµ·å§åç»ç¹ï¼ä¸å¾æ¾ç¤ºä»ä»¬çä½¿ç¨ç¤ºä¾ã\n\n\n\nç»åèç¹ä¸åå¹¶èç¹ä¸åä¹å¤å¨äºï¼ç»åèç¹åæ­¥ä¸¤ä¸ªè¾å¥éï¼äº§çä¸ä¸ªåç¬çè¾åºéãæ¥èªç»åèç¹çè¾åºéè¦æ¥æ¶å°ææçè¾å¥éåæè½æ§è¡ãåå¹¶èç¹ç´æ¥å°æ§å¶æµä¼ ééè¿ãå¦æä¸¤ä¸ªææ´å¤çè¾å¥éå°è¾¾åå¹¶èç¹ãåå®çè¾åºæµæå®çå¨ä½ä¼è¢«æ§è¡ä¸¤æ¬¡ææ´å¤æ¬¡ã\n\n\n# æ©å±å\n\næ©å±åæ¯ä¼æ§è¡å¤æ¬¡çç»ææ´»å¨åãè¾å¥è¾åºæ©å±èç¹è¡¨ç¤ºä¸ºä¸ç»â3 å¢â ï¼ä»£è¡¨å¤ä¸ªéæ©é¡¹ãå³é®è¯ "iterative"ï¼ "parallel" æ "stream"æ¾ç¤ºå¨åºåçå·¦ä¸è§\n\n\n\n\n# å¼å¸¸å¤çå¨\n\nå¼å¸¸å¤çå¨å¨æ´»å¨å¾ä¸­å¯ä»¥å»ºæ¨¡ã\n\n\n\n\n# å¯ä¸­æ­æ´»å¨åº\n\nå¯ä¸­æ­æ´»å¨åºç¯ç»ä¸ç»å¯ä»¥ä¸­æ­çå¨ä½ãå¨ä¸é¢éå¸¸ç®åçä¾å­ä¸­ï¼ å½æ§å¶è¢«ä¼ éå°ç»æè®¢å "close order" å¨ä½ï¼å®åå¤ç"process order" å¨ä½ä¼æ§è¡ç´å°å®æï¼é¤é"cancel request"åæ¶è¯·æ±ä¸­æ­è¢«æ¥åï¼è¿ä¼å°æ§å¶ä¼ éç»"cancel order"å¨ä½ã\n\n\n\n\n# åå²\n\nä¸ä¸ªæ´»å¨åå²æ¾ç¤ºä¸ºåç´ææ°´å¹³æ³³éãå¨ä¸å¾ä¸­ï¼åå²è¢«ç¨æ¥å¨æ´»å¨å¾ä¸­åéå¨ä½ï¼æå¨ "accounting department"ä¸­æ§è¡çï¼æå¨ "customer"ä¸­æ§è¡çã\n\n\n\n\n# ç¶ææºå¾\n\n> ç¶ææºå¾ï¼state-machine-diagramï¼å¯¹ä¸ä¸ªåç¬å¯¹è±¡çè¡ä¸ºå»ºæ¨¡ï¼ææå¯¹è±¡å¨å®çæ´ä¸ªçå½å¨æéï¼ååºä¸åäºä»¶æ¶ï¼æ§è¡ç¸å³äºä»¶çé¡ºåºã\n\nå¦ä¸ç¤ºä¾ï¼ ä¸åçç¶ææºå¾æ¾ç¤ºäºé¨å¨å®çæ´ä¸ªçå½å¨æéå¦ä½è¿ä½ã\n\n\n\né¨å¯ä»¥å¤äºä»¥ä¸çä¸ç§ç¶æä¹ä¸ï¼ "opened"æå¼ç¶æï¼ "closed"å³é­ç¶æï¼æè"locked"éå®ç¶æã å®åå«ååºäºä»¶ï¼âopenâå¼é¨ï¼ âcloseâå³é¨ï¼ âlockâéé¨ å âunlockâè§£éã æ³¨æï¼ä¸æ¯ææçäºä»¶ï¼å¨ææçç¶æä¸é½æ¯ææçãå¦ï¼ä¸ä¸ªé¨æå¼çæ¶åæ¯ä¸å¯è½éå®çï¼é¤éä½ å³ä¸é¨ãå¹¶ä¸ï¼ç¶æè½¬ç§»å¯è½æéå çæ¤æ¡ä»¶ï¼åè®¾é¨æ¯å¼çï¼å¦æâdoorway->isemptyâï¼é¨æ¯ç©ºçï¼è¢«æ»¡è¶³ï¼é£ä¹å®åªè½ååºå³é¨äºä»¶ãç¶ææºå¾ä½¿ç¨çè¯­æ³åçº¦å®å°å¨ä¸é¢çé¨åè¿è¡è®¨è®ºã\n\n\n# ç¶æ\n\nç¶æè¢«è¡¨ç¤ºä¸ºåè§ç©å½¢ï¼ç¶æååå¨éé¢ã\n\n\n\n\n# èµ·å§åç»æç¶æ\n\nåå§ç¶æè¡¨ç¤ºä¸ºå®å¿é»åç¯ï¼å¯ä»¥æ æ³¨åç§°ãç»æç¶æè¡¨ç¤ºä¸ºä¸­å¿å¸¦é»ç¹åç¯ï¼ä¹å¯ä»¥è¢«æ æ³¨åç§°ã\n\n\n\n\n# è½¬ç§»\n\nä¸ä¸ªç¶æå°ä¸ä¸ä¸ªç¶æçè½¬ç§»è¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿ãè½¬ç§»å¯ä»¥æä¸ä¸ªâtriggerâè§¦åå¨ï¼ä¸ä¸ªâguardâçæ¤æ¡ä»¶åä¸ä¸ªâeffectâææãå¦ä¸æç¤ºï¼\n\n\n\n"trigger"è§¦åå¨æ¯è½¬ç§»çèµ·å ï¼å®å¯ä»¥æ¯æä¸ªæ¡ä»¶ä¸çä¸ä¸ªä¿¡å·ï¼ä¸ä¸ªäºä»¶ï¼ä¸ä¸ªååæä¸ä¸ªæ¶é´éè·¯ã"guard"çæ¤æ¯ä¸ä¸ªæ¡ä»¶ï¼èä¸å¿é¡»ä¸ºçï¼ä»¥ä¾¿äºè®©è§¦åå¨å¼èµ·è½¬ç§»ãææ"effect"æ¯ç´æ¥ä½ç¨å°å¯¹è±¡ä¸çä¸ä¸ªå¨ä½ï¼è¯¥å¯¹è±¡å·æåä¸ºè½¬ç§»ç»æçç¶ææºã\n\n\n# ç¶ææ´»å¨\n\nå¨ä¸é¢çç¶æè½¬ç§»ç¤ºä¾ä¸­ï¼ä¸ä¸ªææä¸è¯¥è½¬ç§»ç¸å³èãå¦æç®æ ç¶ææå¤ä¸ªè½¬ç§»å°è¾¾ï¼å¹¶ä¸æ¯ä¸ä¸ªè½¬ç§»é½æç¸åçææä¸å®ç¸å³èï¼é£æå¥½å°è¯¥ææä¸ç®æ ç¶æç¸å³èï¼èä¸ä¸è½¬ç§»ç¸å³èãä½ å¯ä»¥éè¿ä¸ºè¿ä¸ªç¶æå®ä¹åå§å¨ä½æ¥å®ç°ãä¸å¾æ¾ç¤ºäºä¸ä¸ªå¸¦å¥å£å¨ä½ååºå£å¨ä½çç¶æã\n\n\n\nå¯ä»¥å®ä¹åçå¨äºä»¶ä¸çå¨ä½æä¸ç´åççå¨ä½ãæ¯ä¸ç§ç±»åçå¨ä½æ¯å¯ä»¥å®ä¹ä»»ææ°éçã\n\n\n# èªè½¬ç§»\n\nä¸ä¸ªç¶æå¯è½æä¸ä¸ªè¿åå°èªèº«çè½¬ç§»ï¼å¦ä¸å¾ãææä¸è½¬ç§»å³èæ¯ååæå¸®å©ã\n\n\n\n\n# å¤åç¶æ\n\nä¸ä¸ªç¶ææºå¾å¯ä»¥æå­ç¶ææºå¾ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\nå¯éæ©ä¸åæ¹å¼æ¾ç¤ºç¸åä¿¡æ¯ï¼å¦ä¸å¾æç¤ºï¼\n\n\n\nä¸é¢çæ¬çæ æ³¨è¯´æ"check pin"çå­ç¶ææºå¾æ¾ç¤ºå¨åç¬çå¾ä¸­ã\n\n\n# å¥å£ç¹\n\nææ¶ï¼ä½ ä¸æ³å¨æ­£å¸¸çåå§ç¶æè¿å¥å­ç¶ææºãä¾å¦ä¸é¢çå­ç¶ææºï¼å®éå¸¸ä»"åå§å"ç¶æå¼å§ï¼ä½æ¯å¦æå ä¸ºæäºåå ï¼å®ä¸å¿æ§è¡åå§åï¼å¯è½é è½¬ç§»å°æå®çå¥å£ç¹æ¥ä» "ready" ç¶æå¼å§ã\n\n\n\nä¸å¾æ¾ç¤ºäºç¶ææºçä¸ä¸å±ã\n\n\n\n\n# åºå£ç¹\n\næä¸å¥å£ç¹ç¸ç±»ä¼¼çæ¹å¼ï¼å®å¯è½ä¹æå®å¯éæ©çåºå£ç¹ãä¸å¾ç»åºäºä¸»å¤çç¶ææ§è¡åï¼ææ§è¡ç¶æçå»åå°åå³äºè¯¥ç¶æè½¬ç§»æ¶æä½¿ç¨çè·¯å¾ã\n\n\n\n\n# éæ©ä¼ªç¶æ\n\néæ©ä¼ªç¶ææ¾ç¤ºä¸ºè±å½¢ï¼æä¸ä¸ªè½¬ç§»è¾å¥ï¼ä¸¤ä¸ªæå¤ä¸ªè¾åºãä¸å¾æ¾ç¤ºä¸ç®¡å°è¾¾åªä¸ä¸ªç¶æï¼ç»è¿éæ©ä¼ªç¶æåçå»åï¼åå³äºå¨ä¼ªç¶æä¸­æ§è¡æ¶æéæ©çæ¶æ¯æ ¼å¼ã\n\n\n\n\n# è¿æ¥ä¼ªç¶æ\n\nè¿æ¥ä¼ªç¶æç¨æ¥å°å¤ä¸ªç¶æè½¬ç§»é¾æ¥å¨ä¸èµ·ãä¸ä¸ªåç¬çè¿æ¥ä¼ªç¶æå¯ä»¥æä¸ä¸ªæå¤ä¸ªè¾å¥åä¸ä¸ªæå¤ä¸ªè¾åºï¼çæ¤å¯è½åºç¨äºæ¯ä¸ä¸ªè½¬ç§»ï¼è¿æ¥æ¯æ²¡æè¯­ä¹çãè¿æ¥å¯ä»¥æä¸ä¸ªè¾å¥è½¬ç§»åæå¤ä¸ªè¾åºè½¬ç§»æ¥å®ç°ä¸ä¸ªéæåæ¯ãä¸ä¹å¯¹ç§çæ¯éæ©ä¼ªç¶æå®ç°ä¸ä¸ªå¨ææ¡ä»¶åæ¯ã\n\n\n\n\n# ç»æ­¢ä¼ªç¶æ\n\nè¿å¥ç»æ­¢ä¼ªç¶ææ¯æç¶ææºçå½çº¿å·²ç»ç»æ­¢ãç»æ­¢ä¼ªç¶æè¡¨ç¤ºä¸ºåå·ã\n\n\n\n\n# åå²ç¶æ\n\nåå²ç¶æç¨æ¥å½ç¶ææºä¸­æ­æ¶ï¼æ¢å¤ç¶ææºä¹åç¶æãä¸é¢ä¾å¾è¯´æäºåå²ç¶æçä½¿ç¨ãè¿ä¸ªä¾å­æ¯å³äºæ´è¡£æºçç¶ææºã\n\nå¨è¿ä¸ªç¶ææºä¸­ï¼å½æ´è¡£æºè¿è¡æ¶ï¼å®ä¼æç§"washing" å° rinsing"åå°"spinning"æ¥è¿è¡ãå¦æçµæºè¢«åæ­ ï¼æ´è¡£æºä¼åæ­¢è¿è¡å¹¶è¿å¥"power off" ç¶æãå½çµæºæ¢å¤ï¼è¿è¡ç¶æå¨"history state"ç¬¦å·å¤è¿å¥ï¼è¡¨ç¤ºå®ä¼ä»ä¸æ¬¡ç¦»å¼çå°æ¹æ¢å¤ã\n\n\n# å¹¶ååº\n\nä¸ä¸ªç¶æå¯ä»¥è¢«åæå ä¸ªä¸åçåºï¼åå«åæ¶å­å¨åæ§è¡çå­ç¶æãä¸é¢çä¾å­æ¾ç¤ºç¶æ "applying brakes"ï¼ "front brake"å"rear brakes" å°åæ¶ç¬ç«è¿ä½ãæ³¨æä½¿ç¨äºåååç»åä¼ªç¶æèä¸æ¯éæ©ååå¹¶ä¼ªç¶æãè¿äºç¬¦å·ç¨æ¥åæ­¥å¹¶åççº¿ç¨ã\n\n\n\n\n# ç¨ä¾å¾\n\n> ç¨ä¾å¾ç¨æ¥è®°å½ç³»ç»çéæ±ï¼å®æä¾ç³»ç»ä¸ç¨æ·åå¶ä»åä¸èçä¸ç§éä¿¡ææ®µã\n\n\n# æ§è¡è\n\nç¨ä¾å¾æ¾ç¤ºäºç³»ç»åç³»ç»å¤å®ä½ä¹é´çäº¤äºãè¿äºå®ä½è¢«å¼ç¨ä¸ºæ§è¡èãæ§è¡èä»£è¡¨è§è²ï¼å¯ä»¥åæ¬ï¼ç¨æ·ï¼å¤é¨ç¡¬ä»¶åå¶ä»ç³»ç»ãæ§è¡èå¾å¾è¢«ç»æç®ç¬ç»å°äººãä¹å¯ä»¥ç¨å¸¦Â«actorÂ»å³é®å­çç±»ç©å½¢è¡¨ç¤ºã\n\n\n\nå¨ä¸å¾ä¸­ï¼æ§è¡èå¯ä»¥è¯¦ç»çæ³åå¶ä»æ§è¡è:\n\n\n\n\n# ç¨ä¾\n\nç¨ä¾æ¯ææä¹çåç¬å·¥ä½ååãå®åç³»ç»å¤é¨çäººæäºæä¾ä¸ä¸ªæäºè§å¯çé«å±æ¬¡è¡ä¸ºè§å¾ã ç¨ä¾çæ æ³¨ç¬¦å·æ¯ä¸ä¸ªæ¤­åã\n\n\n\nä½¿ç¨ç¨ä¾çç¬¦å·æ¯å¸¦å¯éæ©ç®­å¤´çè¿æ¥çº¿ï¼ç®­å¤´æ¾ç¤ºæ§å¶çæ¹åãä¸å¾è¯´ææ§è¡è "customer"ä½¿ç¨ "withdraw"ç¨ä¾ã\n\n\n\nç¨éè¿æ¥å¨ï¼uses connectorï¼å¯ä»¥æéæ©æ§çå¨æ¯ä¸ä¸ªç«¯ç¹æå¤éæ§å¼ï¼å¦ä¸å¾ï¼æ¾ç¤ºå®¢æ·ä¸æ¬¡å¯è½åªæ§è¡ä¸æ¬¡åæ¬¾äº¤æãä½æ¯é¶è¡å¯ä»¥åæ¶æ§è¡è®¸å¤åæ¬¾äº¤æã\n\n\n\n\n# ç¨ä¾å®ä¹\n\nä¸ä¸ªå¸åçç¨ä¾åæ¬:\n\n * åç§°åæè¿° - ç¨ä¾éå¸¸ç¨ä¸ä¸ªå¨è¯è¯ç»å®ä¹ï¼èä¸æä¸ä¸ªç®ç­çæå­è¯´æã\n * éæ± - éæ±å®ä¹äºä¸ä¸ªç¨ä¾å¿é¡»æä¾ç»ç»ç«¯ç¨æ·çæ­£å¼åè½æ§éæ±ãå®ä»¬ç¬¦åæé æ¹æ³å»ºç«çåè½æ§è§èãä¸ä¸ªéæ±æ¯ç¨ä¾å°æ§è¡ä¸ä¸ªå¨ä½ææä¾å¤ä¸ªå¼ç»ç³»ç»ççº¦å®ææ¿è¯ºã\n * çº¦æ - ä¸ä¸ªçº¦ææ¯ä¸ä¸ªç¨ä¾è¿è¡çæ¡ä»¶æéå¶ãå®åæ¬ï¼åç½®æ¡ä»¶ï¼åç½®æ¡ä»¶åä¸ååæ¡ä»¶ ãåç½®æ¡ä»¶ææäºç¨ä¾å¨åçä¹åéè¦ç¬¦åçæ¡ä»¶ãåç½®æ¡ä»¶ç¨æ¥è¯´æå¨ç¨ä¾æ§è¡ä¹åä¸äºæ¡ä»¶å¿é¡»ä¸º"ç"ãä¸ååæ¡ä»¶è¯´æç¨ä¾æ´ä¸ªæ§è¡è¿ç¨ä¸­è¯¥æ¡ä»¶å§ç»ä¸º"ç"ã\n * æå½¢ - æå½¢æ¯ç¨ä¾çå®ä¾å¨æ§è¡è¿ç¨ä¸­ï¼äºä»¶åçæµç¨çå½¢å¼æè¿°ãå®å®ä¹äºç³»ç»åå¤é¨æ§è¡èä¹é´çäºä»¶æå®é¡ºåºãéå¸¸ç¨ææ¬æ¹å¼æ¥è¡¨ç¤ºï¼å¹¶å¯¹åºæ¶åºå¾ä¸­çæå­æè¿°ã\n * æå½¢å¾\n * éå ä¿¡æ¯\n\n\n# åå«ç¨ä¾\n\nç¨ä¾å¯è½åå«å¶ä»ç¨ä¾çåè½æ¥ä½ä¸ºå®æ­£å¸¸å¤ççä¸é¨åãéå¸¸å®åè®¾ï¼ä»»ä½è¢«åå«çç¨ä¾å¨åºæ¬ç¨åºè¿è¡æ¶æ¯ä¸æ¬¡é½ä¼è¢«è°ç¨ãä¸é¢ä¾å­ï¼ç¨ä¾âå¡çç¡®è®¤â å¨è¿è¡æ¶ï¼è¢«ç¨ä¾âåé±âå½ä½ä¸ä¸ªå­é¨åã\n\n\n\nç¨ä¾å¯ä»¥è¢«ä¸ä¸ªæå¤ä¸ªç¨ä¾åå«ãéè¿æç¼éç¨çè¡ä¸ºï¼å°å®åæå¯ä»¥å¤æ¬¡éå¤ä½¿ç¨çç¨ä¾ãæå©äºéä½åè½éå¤çº§å«ã\n\n\n# æ©å±ç¨ä¾\n\nä¸ä¸ªç¨ä¾å¯ä»¥è¢«ç¨æ¥æ©å±å¦ä¸ä¸ªç¨ä¾çè¡ä¸ºï¼éå¸¸ä½¿ç¨å¨ç¹å«æåµä¸ãä¾å¦ï¼åè®¾å¨ä¿®æ¹ä¸ä¸ªç¹å«ç±»åçå®¢æ·è®¢åä¹åï¼ç¨æ·å¿é¡»å¾å°æç§æ´é«çº§å«çè®¸å¯ï¼ç¶åâè·å¾è®¸å¯âç¨ä¾å°æéæ©çæ©å±å¸¸è§çâä¿®æ¹è®¢åâç¨ä¾ã\n\n\n\næ©å±ç¹ - æ©å±ç¨ä¾çå å¥ç¹è¢«å®ä¹ä¸ºæ©å±ç¹ã\n\n\n\nç³»ç»è¾¹ç - å®ç¨æ¥æ¾ç¤ºç¨ä¾å¨ç³»ç»åé¨ï¼æ§è¡èå¨ç³»ç»çå¤é¨ã\n\n\n\n\n# éä¿¡å¾\n\n> éä¿¡å¾ï¼ä»¥åç§°ä¹ä¸ºåä½å¾ï¼æ¯ä¸ç§äº¤äºå¾ï¼ææ¾ç¤ºæ¶æ¯ä¸æ¶åºå¾ç¸ä¼¼ï¼ä½æ¯å®æ´ä¾§éäºå¯¹è±¡é´çèç³»ã\n\nå¨éä¿¡å¾ä¸­ï¼å¯¹è±¡ä¹é´æ¾ç¤ºå³èè¿æ¥å¨ãæ¶æ¯éå å°è¿äºå³èä¸ï¼æ¾ç¤ºç­ç®­å¤´æåæ¶æ¯æµçæ¹åãæ¶æ¯çé¡ºåºéè¿ç¼å·ç æ¾ç¤ºã\n\nä¸é¢çä¸¤ä¸ªå¾ç¨éä¿¡å¾åæ¶åºå¾åå«æ¾ç¤ºç¸åçä¿¡æ¯ãå°½ç®¡æä»¬å¯è½ä»éä¿¡å¾çç¼å·ç å¾å°æ¶æ¯é¡ºåºï¼ä½å®ä¸æ¯ç«å³å¯è§çãéä¿¡å¾ååæ¸æ¥çæ¾ç¤ºäºé»è¿å¯¹è±¡é´å¨é¨å®æ´çæ¶æ¯ä¼ éã\n\n\n\n\n\n# äº¤äºæ¦è¿°å¾\n\n> ä¸ä¸ªäº¤äºæ¦è§å¾æ¯æ´»å¨å¾çä¸ç§å½¢å¼ï¼å®çèç¹ä»£è¡¨äº¤äºå¾ãäº¤äºå¾åå«æ¶åºå¾ï¼éä¿¡å¾ï¼äº¤äºæ¦è§å¾åæ¶é´å¾ã å¤§å¤æ°äº¤äºæ¦è§å¾æ æ³¨ä¸æ´»å¨å¾ä¸æ ·ãä¾å¦ï¼èµ·å§ï¼ç»æï¼å¤æ­ï¼åå¹¶ï¼åååç»åèç¹æ¯å®å¨ç¸åãå¹¶ä¸ï¼äº¤äºæ¦è§å¾ä»ç»äºä¸¤ç§æ°çåç´ ï¼äº¤äºåçåäº¤äºåç´ ã\n\n\n# äº¤äºåç\n\näº¤äºåçå¼ç¨ç°æçäº¤äºå¾ãæ¾ç¤ºä¸ºä¸ä¸ªå¼ç¨æ¡ï¼å·¦ä¸è§æ¾ç¤º "ref" ãè¢«å¼ç¨çå¾åæ¾ç¤ºå¨æ¡çä¸­å¤®ã\n\n\n\n\n# äº¤äºåç´ \n\näº¤äºåç´ ä¸äº¤äºåçç¸ä¼¼ä¹å¤å¨äºé½æ¯å¨ä¸ä¸ªç©å½¢æ¡ä¸­æ¾ç¤ºä¸ä¸ªç°æçäº¤äºå¾ãä¸åä¹å¤å¨åé¨æ¾ç¤ºåèå¾çåå®¹ä¸åã\n\n\n\n\n# å°å®ä»¬æ¾å¨ä¸èµ·\n\nææçæ´»å¨å¾æ§ä»¶ï¼é½å¯ä»¥ç¸åå°è¢«ä½¿ç¨äºäº¤äºæ¦è§å¾ï¼å¦ï¼ååï¼ç»åï¼åå¹¶ç­ç­ãå®ææ§å¶é»è¾æ¾å¥è¾ä½ä¸çº§çå¾ä¸­ãä¸é¢çä¾å­å°±è¯´æäºä¸ä¸ªå¸åçéå®è¿ç¨ãå­è¿ç¨æ¯ä»äº¤äºåçæ½è±¡èæ¥ã\n\n\n\n\n# æ¶åºå¾\n\n> æ¶åºå¾æ¯äº¤äºå¾çä¸ç§å½¢å¼ï¼å®æ¾ç¤ºå¯¹è±¡æ²¿çå½çº¿åå±ï¼å¯¹è±¡ä¹é´éæ¶é´çäº¤äºè¡¨ç¤ºä¸ºä»æºçå½çº¿æåç®æ çå½çº¿çæ¶æ¯ãæ¶åºå¾è½å¾å¥½å°æ¾ç¤ºé£äºå¯¹è±¡ä¸å¶å®é£äºå¯¹è±¡éä¿¡ï¼ä»ä¹æ¶æ¯è§¦åäºè¿äºéä¿¡ï¼æ¶åºå¾ä¸è½å¾å¥½æ¾ç¤ºå¤æè¿ç¨çé»è¾ã\n\n\n# çå½çº¿\n\nä¸æ¡çå½çº¿å¨æ¶åºå¾ä¸­ä»£è¡¨ä¸ä¸ªç¬ç«çåä¸èãè¡¨ç¤ºä¸ºåå«å¯¹è±¡åçç©å½¢ï¼å¦æå®çåå­æ¯"self"ï¼åè¯´æè¯¥çå½çº¿ä»£è¡¨æ§å¶å¸¦æ¶åºå¾çç±»åã\n\n\n\nææ¶ï¼æ¶åºå¾ä¼åå«ä¸ä¸ªé¡¶ç«¯æ¯æ§è¡èççå½çº¿ãè¿æåµè¯´æææ¡è¿ä¸ªæ¶åºå¾çæ¯ç¨ä¾ãå¥å£®å¾ä¸­çè¾¹çï¼æ§å¶åå®ä½åç´ ä¹å¯ä»¥æçå½çº¿ã\n\n\n\n\n# æ¶æ¯\n\næ¶æ¯æ¾ç¤ºä¸ºç®­å¤´ãæ¶æ¯å¯ä»¥å®æä¼ è¾ï¼ä¹å¯è½ä¸¢å¤±åæ¾åï¼å®å¯ä»¥æ¯åæ­¥çï¼ä¹å¯ä»¥æ¯å¼æ­¥çï¼å³å¯ä»¥æ¯è°ç¨ï¼ä¹å¯ä»¥æ¯ä¿¡å·ãå¨ä¸å¾ä¸­ï¼ç¬¬ä¸æ¡æ¶æ¯æ¯åæ­¥æ¶æ¯(æ ä¸ºå®ç®­å¤´)å®æä¼ è¾ï¼å¹¶éå«ä¸æ¡è¿åæ¶æ¯ãç¬¬äºæ¡æ¶æ¯æ¯å¼æ­¥æ¶æ¯ (æ ä¸ºå®çº¿ç®­å¤´)ï¼ç¬¬ä¸æ¡æ¯å¼æ­¥è¿åæ¶æ¯(æ ä¸ºèçº¿)ã\n\n\n\n\n# æ§è¡åç\n\nåä¸å»¶ä¼¸çç»æ¡ç¶ç©å½¢è¡¨ç¤ºæ§è¡äºä»¶ææ§å¶ç¦ç¹çæ¿æ´»ãå¨ä¸å¾ä¸­æä¸ä¸ªæ§è¡äºä»¶ãç¬¬ä¸ä¸ªæ¯æºå¯¹è±¡åéä¸¤æ¡æ¶æ¯åæ¶å°ä¸¤æ¡åå¤ãç¬¬äºä¸ªæ¯ç®æ å¯¹è±¡æ¶å°ä¸æ¡åæ­¥æ¶æ¯å¹¶è¿åä¸æ¡åå¤ãç¬¬ä¸ä¸ªæ¯ç®æ å¯¹è±¡æ¶å°ä¸æ¡å¼æ­¥æ¶æ¯å¹¶è¿åä¸æ¡åå¤ã\n\n\n# åé¨éä¿¡\n\nåé¨æ¶æ¯è¡¨ç°ä¸ºä¸ä¸ªæä½çéå½è°ç¨ï¼æä¸ä¸ªæ¹æ³è°ç¨å±äºåä¸ä¸ªå¯¹è±¡çå¶ä»æ¹æ³ãæ¾ç¤ºä¸ºçå½çº¿ä¸æ§è¡äºä»¶çåµå¥æ§å¶ç¦ç¹ã\n\n\n\n\n# è¿·è·¯æ¶æ¯åæ¾åæ¶æ¯\n\nè¿·è·¯æ¶æ¯æ¯é£äºåéäºå´æ²¡æå°è¾¾æå®æ¥æ¶èï¼æèå°è¾¾çæ¥æ¶èä¸åå½åå¾ä¸­ãæ¾åæ¶æ¯æ¯æ¶å°æ¥èªé£äºæªç¥çåéèï¼æèæ¥èªæ²¡ææ¾ç¤ºå¨å½åå¾çåéèçæ¶æ¯ãå®ä»¬é½è¡¨ææ¯å»å¾ææ¥èªä¸ä¸ªç»ç¹åç´ ã\n\n\n\n\n# çå½çº¿å¼å§ä¸ç»æ\n\nçå½çº¿å¯ä»¥å¨æ¶åºå¾æ¶é´å»åº¦èå´ååå»ºåéæ¯ï¼å¨ä¸é¢çä¾å­ä¸­ï¼çå½çº¿è¢«åæ­¢ç¬¦å·ï¼åå·ï¼ç»æ­¢ãå¨åé¢çä¾å­ä¸­ï¼çå½çº¿é¡¶ç«¯çç¬¦å·ï¼childï¼æ¾ç¤ºå¨æ¯åå»ºå®çå¯¹è±¡ç¬¦å·ï¼parentï¼æ²¿é¡µé¢è¦ä½çä½ç½®ä¸ãä¸å¾æ¾ç¤ºåå»ºåç»æ­¢å¯¹è±¡ã\n\n\n\n\n# æ¶é´åæéçº¦æ\n\næ¶æ¯é»è®¤æ¾ç¤ºä¸ºæ°´å¹³çº¿ãå ä¸ºçå½çº¿æ¾ç¤ºä¸ºæ²¿å±å¹åä¸çæ¶é´ééï¼æä»¥å½ç»å®æ¶ç³»ç»å»ºæ¨¡ï¼ææ¯ææ¶é´çº¦æçä¸å¡è¿ç¨å»ºæ¨¡ï¼èèæ§è¡å¨ä½æéæ¶é´é¿åº¦æ¯å¾éè¦çãå æ­¤å¯ä»¥ç»æ¶æ¯è®¾ç½®ä¸ä¸ªæéçº¦æï¼è¿æ ·çæ¶æ¯æ¾ç¤ºä¸ºä¸æçº¿ã\n\n\n\n\n# å¤åçæ®µ\n\nå¦åé¢æè¯´ï¼æ¶åºå¾ä¸éåè¡¨è¾¾å¤æçè¿ç¨é»è¾ãå¨ä¸ç§æåµä¸ï¼æè®¸å¤æºå¶åè®¸æä¸å®ç¨åº¦çè¿ç¨é»è¾å å¥å°å¾ä¸­ï¼å¹¶æå®ä»¬æ¾å°å¤åçæ®µçæ é¢ä¸ãå¤åçæ®µæ¯ä¸ä¸ªæå¤ä¸ªå¤çé¡ºåºè¢«åå«å¨ä¸ä¸ªæ¡æ¶ä¸­ï¼å¹¶å¨æå®åç§°çç¯å¢ä¸æ§è¡ãçæ®µå¯ä»¥æ¯:\n\n * éæ©æ§çæ®µ (æ¾ç¤º âaltâ) ä¸º ifâ¦thenâ¦else ç»æå»ºæ¨¡ã\n * éé¡¹çæ®µ (æ¾ç¤º âoptâ) ä¸º "switch"(å¼å³) ç»æå»ºæ¨¡ã\n * ä¸­æ­çæ®µå¯¹è¢«å¤çäºä»¶çå¯éæ©é¡ºåºå»ºæ¨¡ï¼èä¸æ¯è¯¥å¾çå¶ä»é¨åã\n * å¹¶è¡çæ®µ(æ¾ç¤º âparâ) ä¸ºå¹¶åå¤çå»ºæ¨¡ã\n * å¼±é¡ºåºçæ®µ (æ¾ç¤º âseqâ) åå«äºä¸ç»æ¶æ¯ï¼è¿ç»æ¶æ¯å¿é¡»å¨åç»§çæ®µå¼å§ä¹åè¢«å¤çãä½ä¸ä¼æçæ®µåæ¶æ¯çååé¡ºåºå¼ºå å°ä¸å±äº«åä¸æ¡çå½çº¿çæ¶æ¯ä¸ã\n * ä¸¥æ ¼é¡ºåºçæ®µ (æ¾ç¤º âstrictâ) åå«äºä¸ç³»åéè¦æç§ç»å®é¡ºåºå¤ççæ¶æ¯ã\n * éçæ®µ (æ¾ç¤º ânegâ) åå«äºä¸ç³»åä¸å¯ç¨çæ¶æ¯ã\n * å³é®çæ®µ å·æå³é®é¨åã\n * å¿½ç¥çæ®µ å£°æä¸ä¸ªæ²¡ææä¹çæ¶æ¯ï¼å¦æå®åºç°å¨å½åä¸ä¸æä¸­ã\n * èèçæ®µä¸å¿½ç¥çæ®µç¸åï¼ä¸åå«å¨èèçæ®µåçæ¶æ¯é½åºè¯¥è¢«å¿½ç¥ã\n * æ­è¨çæ®µ (æ¾ç¤º âassertâ)æ æä»»ä½æ²¡ææ¾ç¤ºä¸ºå£°ææä½æ°çé¡ºåºé½æ¯æ æçã\n * å¾ªç¯çæ®µ åå«ä¸ç³»åè¢«éå¤çæ¶æ¯ã\n\nä¸å¾æ¾ç¤ºçæ¯å¾ªç¯çæ®µï¼\n\n\n\nè¿ä¹æ¯ä¸ä¸ªç±»ä¼¼äºå¤åçæ®µçäº¤äºåçã äº¤äºåçè¢«å¶ä»å¾åèï¼æ¾ç¤ºä¸ºå·¦ä¸è§å¸¦"ref"ï¼å°è¢«åèå¾åæ¾ç¤ºå¨æ¹æ¡çä¸­é´ã\n\n\n# é¨\n\né¨æ¯è¿æ¥çæ®µåæ¶æ¯åçæ®µå¤æ¶æ¯çè¿æ¥ç¹ã å¨ ea ä¸­ï¼é¨æ¾ç¤ºä¸ºçæ®µæ¡æ¶ä¸çå°æ­£æ¹å½¢ãä½ç¨ä¸ºæ¶åºå¾ä¸é¡µé¢å¤çè¿æ¥å¨ã ç¨æ¥è¡¨ç¤ºè¿æ¥çæ¶æ¯æºï¼æèåºå»æ¶æ¯çç»ç¹ãä¸é¢ä¸¤ä¸ªå¾æ¾ç¤ºå®ä»¬å¨å®è·µä¸­çä½¿ç¨ãæ³¨æï¼" top level diagram"ä¸­çé¨ç¨æ¶æ¯ç®­å¤´æååèçæ®µï¼å¨è¿éæ²¡æå¿è¦æå®ç»ææ¹åã\n\n\n\n\n\n# é¨ååè§£\n\nä¸ä¸ªå¯¹è±¡å¯ä»¥å¼åºå¤æ¡çå½çº¿ï¼ä½¿å¾å¯¹è±¡åé¨åå¯¹è±¡ä¹é´çæ¶æ¯æ¾ç¤ºå¨åä¸å¾ä¸ã\n\n\n\n\n# ç¶æå¸¸é/å»¶ç»­\n\nç¶æå¸¸éæ¯çå½çº¿ççº¦æï¼è¿è¡æ¶å§ç»ä¸º"ç"ãæ¾ç¤ºä¸ºä¸¤ä¾§ååçç©å½¢ï¼å¦ä¸å¾ï¼\n\n\n\nå»¶ç»­è½ä¸ç¶æå¸¸éæåæ ·çæ æ³¨ï¼ä½æ¯è¢«ç¨äºå¤åçæ®µï¼å¹¶å¯ä»¥å»¶ä¼¸è·¨è¶å¤æ¡çå½çº¿ã\n\n\n# æ¶é´å¾\n\n> uml æ¶é´å¾è¢«ç¨æ¥æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªæå¤ä¸ªåç´ çå¼æç¶æçæ´æ¹ãä¹æ¾ç¤ºæ¶æ§äºä»¶ä¹é´çäº¤äºåç®¡çå®ä»¬çæ¶é´åæéçº¦æã\n\n\n# ç¶æçå½çº¿\n\nç¶æçå½çº¿æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªåé¡¹ç¶æçæ¹åãä¸è®ºæ¶é´åä½å¦ä½éæ©ï¼x è½´æ¾ç¤ºç»è¿çæ¶é´ï¼y è½´è¢«æ ä¸ºç»åºç¶æçåè¡¨ãç¶æçå½çº¿å¦ä¸æç¤ºï¼\n\n\n\n\n# å¼çå½çº¿\n\nå¼çå½çº¿æ¾ç¤ºéæ¶é´ååï¼ä¸ä¸ªåé¡¹çå¼çååãx è½´æ¾ç¤ºç»è¿çæ¶é´ï¼æ¶é´åä½ä¸ºä»»æï¼åç¶æçå½çº¿ä¸æ ·ãå¹³è¡çº¿ä¹é´æ¾ç¤ºå¼ï¼æ¯æ¬¡å¼ååï¼å¹³è¡çº¿äº¤åãå¦ä¸å¾æç¤ºã\n\n\n\n\n# å°å®ä»¬æ¾å¨ä¸èµ·\n\nç¶æåå¼ççå½çº¿è½å å ç»åãå®ä»¬å¿é¡»æç¸åç x è½´ã æ¶æ¯å¯ä»¥ä»ä¸ä¸ªçå½çº¿ä¼ éå°å¦ä¸ä¸ªãæ¯ä¸ä¸ªç¶æåå¼çåæ¢è½æä¸ä¸ªå®ä¹çäºä»¶ï¼ä¸ä¸ªæ¶é´éå¶æ¯æä¸ä¸ªäºä»¶ä½æ¶å¿é¡»åçï¼åä¸ä¸ªæééå¶è¯´æç¶ææå¼å¤é¿æ¶é´å¿é¡»ææãä¸æ¦è¿äºå·²ç»è¢«åºç¨ï¼å¶æ¶é´å¾å¯è½æ¾ç¤ºå¦ä¸ã\n\n\n\n\n# åèèµæ\n\n * https://sparxsystems.cn/resources/uml2_tutorial/index.html',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"README",frontmatter:{title:"README",date:"2020-08-10T10:59:18.000Z",categories:["è®¾è®¡","UML"],tags:["è®¾è®¡","UML"],permalink:"/pages/8f04b3/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/01.UML/",relativePath:"03.è®¾è®¡/01.UML/README.md",key:"v-bad396a0",path:"/pages/8f04b3/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:192},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:241},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:345}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# UML æç¨\n\n> ç»ä¸å»ºæ¨¡è¯­è¨ï¼è±è¯­ - Unified Modeling Languageï¼ç¼©å UMLï¼æ¯éä¸å©çç¬¬ä¸ä»£å»ºæ¨¡åè§çº¦è¯­è¨ãUML æ¯ä¸ç§å¼æ¾çæ¹æ³ï¼ç¨äºè¯´æãå¯è§åãæå»ºåç¼åä¸ä¸ªæ­£å¨å¼åçãé¢åå¯¹è±¡çãè½¯ä»¶å¯éç³»ç»çå¶åçå¼æ¾æ¹æ³ãUML å±ç°äºä¸ç³»åæä½³å·¥ç¨å®è·µï¼è¿äºæä½³å®è·µå¨å¯¹å¤§è§æ¨¡ï¼å¤æç³»ç»è¿è¡å»ºæ¨¡æ¹é¢ï¼ç¹å«æ¯å¨è½¯ä»¶æ¶æå±æ¬¡å·²ç»è¢«éªè¯ææã\n\n\n# ð åå®¹\n\n * UML å¿«éå¥é¨\n * UML ç»æå»ºæ¨¡å¾\n * UML è¡ä¸ºå»ºæ¨¡å¾\n\n\n# ð èµæ\n\n * Wiki-UML\n * Sparx UML æç¨\n * OMG UML\n * UML Tutorial\n * W3Cschool UML æç¨\n * UML å­¦ä¹ å¥é¨å°±è¿ä¸ç¯æç« \n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# uml æç¨\n\n> ç»ä¸å»ºæ¨¡è¯­è¨ï¼è±è¯­ - unified modeling languageï¼ç¼©å umlï¼æ¯éä¸å©çç¬¬ä¸ä»£å»ºæ¨¡åè§çº¦è¯­è¨ãuml æ¯ä¸ç§å¼æ¾çæ¹æ³ï¼ç¨äºè¯´æãå¯è§åãæå»ºåç¼åä¸ä¸ªæ­£å¨å¼åçãé¢åå¯¹è±¡çãè½¯ä»¶å¯éç³»ç»çå¶åçå¼æ¾æ¹æ³ãuml å±ç°äºä¸ç³»åæä½³å·¥ç¨å®è·µï¼è¿äºæä½³å®è·µå¨å¯¹å¤§è§æ¨¡ï¼å¤æç³»ç»è¿è¡å»ºæ¨¡æ¹é¢ï¼ç¹å«æ¯å¨è½¯ä»¶æ¶æå±æ¬¡å·²ç»è¢«éªè¯ææã\n\n\n# ð åå®¹\n\n * uml å¿«éå¥é¨\n * uml ç»æå»ºæ¨¡å¾\n * uml è¡ä¸ºå»ºæ¨¡å¾\n\n\n# ð èµæ\n\n * wiki-uml\n * sparx uml æç¨\n * omg uml\n * uml tutorial\n * w3cschool uml æç¨\n * uml å­¦ä¹ å¥é¨å°±è¿ä¸ç¯æç« \n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼æ¦è¿°",frontmatter:{title:"è®¾è®¡æ¨¡å¼æ¦è¿°",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-27T16:50:00.000Z",permalink:"/pages/dad9fd/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/00.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%BF%B0.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/00.è®¾è®¡æ¨¡å¼æ¦è¿°.md",key:"v-33b23c84",path:"/pages/dad9fd/",headers:[{level:2,title:"1. åå»ºåæ¨¡å¼",slug:"_1-åå»ºåæ¨¡å¼",normalizedTitle:"1. åå»ºåæ¨¡å¼",charIndex:137},{level:3,title:"1.1. åå»ºåæ¨¡å¼ç®ä»",slug:"_1-1-åå»ºåæ¨¡å¼ç®ä»",normalizedTitle:"1.1. åå»ºåæ¨¡å¼ç®ä»",charIndex:150},{level:3,title:"1.2. åå»ºåæ¨¡å¼åºç¨",slug:"_1-2-åå»ºåæ¨¡å¼åºç¨",normalizedTitle:"1.2. åå»ºåæ¨¡å¼åºç¨",charIndex:549},{level:3,title:"1.3. åå»ºåæ¨¡å¼ä»£è¡¨",slug:"_1-3-åå»ºåæ¨¡å¼ä»£è¡¨",normalizedTitle:"1.3. åå»ºåæ¨¡å¼ä»£è¡¨",charIndex:990},{level:3,title:"1.4. ç»æåæ¨¡å¼",slug:"_1-4-ç»æåæ¨¡å¼",normalizedTitle:"1.4. ç»æåæ¨¡å¼",charIndex:1150},{level:3,title:"1.5. è¡ä¸ºåæ¨¡å¼",slug:"_1-5-è¡ä¸ºåæ¨¡å¼",normalizedTitle:"1.5. è¡ä¸ºåæ¨¡å¼",charIndex:1295},{level:2,title:"2. ð èµæ",slug:"_2-ð-èµæ",normalizedTitle:"2. ð èµæ",charIndex:1548},{level:2,title:"3. ðª ä¼ é",slug:"_3-ðª-ä¼ é",normalizedTitle:"3. ðª ä¼ é",charIndex:1595}],headersStr:"1. åå»ºåæ¨¡å¼ 1.1. åå»ºåæ¨¡å¼ç®ä» 1.2. åå»ºåæ¨¡å¼åºç¨ 1.3. åå»ºåæ¨¡å¼ä»£è¡¨ 1.4. ç»æåæ¨¡å¼ 1.5. è¡ä¸ºåæ¨¡å¼ 2. ð èµæ 3. ðª ä¼ é",content:"# è®¾è®¡æ¨¡å¼æ¦è¿°\n\n> è®¾è®¡æ¨¡å¼ï¼Design patternï¼ä»£è¡¨äºæä½³çå®è·µï¼éå¸¸è¢«æç»éªçé¢åå¯¹è±¡çè½¯ä»¶å¼åäººåæéç¨ãè®¾è®¡æ¨¡å¼æ¯è½¯ä»¶å¼åäººåå¨è½¯ä»¶å¼åè¿ç¨ä¸­é¢ä¸´çä¸è¬é®é¢çè§£å³æ¹æ¡ãè¿äºè§£å³æ¹æ¡æ¯ä¼å¤è½¯ä»¶å¼åäººåç»è¿ç¸å½é¿çä¸æ®µæ¶é´çè¯éªåéè¯¯æ»ç»åºæ¥çã\n\n\n# 1. åå»ºåæ¨¡å¼\n\n\n# 1.1. åå»ºåæ¨¡å¼ç®ä»\n\nåå»ºåæ¨¡å¼æ½è±¡äºå®ä¾åçè¿ç¨ãå®å°ç³»ç»ä¸å®çå¯¹è±¡åå»ºãç»åãè¡¨ç¤ºçæ¹å¼åç¦»ã\n\nåå»ºåæ¨¡å¼é½ä¼å°å³äºè¯¥ç³»ç»ä½¿ç¨åªäºå·ä½çç±»çä¿¡æ¯å°è£èµ·æ¥ã\n\nå¨è½¯ä»¶å·¥ç¨ä¸­ï¼åå»ºåæ¨¡å¼æ¯å¤çå¯¹è±¡åå»ºçè®¾è®¡æ¨¡å¼ï¼è¯å¾æ ¹æ®å®éæåµä½¿ç¨åéçæ¹å¼åå»ºå¯¹è±¡ã\n\nåºæ¬çå¯¹è±¡åå»ºæ¹å¼å¯è½ä¼å¯¼è´è®¾è®¡ä¸çé®é¢ï¼æå¢å è®¾è®¡çå¤æåº¦ãåå»ºåæ¨¡å¼éè¿ä»¥æç§æ¹å¼æ§å¶å¯¹è±¡çåå»ºæ¥è§£å³é®é¢ã\n\nåå»ºåæ¨¡å¼çæå¯¼ææ³æ¯ï¼\n\n * å°ç³»ç»ä½¿ç¨çå·ä½ç±»å°è£èµ·æ¥ã\n * éèè¿äºå·ä½ç±»çå®ä¾åå»ºåç»åçæ¹å¼ã\n\nåå»ºåæ¨¡å¼ååä¸ºå¯¹è±¡åå»ºåæ¨¡å¼åç±»åå»ºåæ¨¡å¼ãå¯¹è±¡åå»ºåæ¨¡å¼å¤çå¯¹è±¡çåå»ºï¼ç±»åå»ºåæ¨¡å¼å¤çç±»çåå»ºã\n\n * å¯¹è±¡åå»ºåæ¨¡å¼æå¯¹è±¡åå»ºçä¸é¨åæ¨è¿å°å¦ä¸ä¸ªå¯¹è±¡ä¸­ãï¼ä»£è¡¨æ¨¡å¼ï¼åä¾æ¨¡å¼ãå»ºé èæ¨¡å¼ãååæ¨¡å¼ãæ½è±¡å·¥åæ¨¡å¼ï¼\n * ç±»åå»ºåæ¨¡å¼å°å®å¯¹è±¡çåå»ºæ¨è¿å°å­ç±»ä¸­ãï¼ä»£è¡¨æ¨¡å¼ï¼å·¥åæ¹æ³æ¨¡å¼ï¼\n\n\n# 1.2. åå»ºåæ¨¡å¼åºç¨\n\nç°ä»£è½¯ä»¶å·¥ç¨æ´å ä¾èµå¯¹è±¡çç»åï¼èä¸æ¯ç±»çç»§æ¿ï¼å¼ºè°ä»ç¡¬ç¼ç çè¡ä¸ºè½¬åå°å®ä¹ä¸ç»åºæ¬è¡ä¸ºæ¥ç»åæå¤æçè¡ä¸ºã\n\nç¡¬ç¼ç çè¡ä¸ºä¸å¤çµæ´»ï¼å ä¸ºå¦ææ³è¦æ¹åè®¾è®¡çä¸é¨åï¼éè¦éè¿éåæèéæ°å®ç°æè½å®æã\n\nå¦å¤ï¼ç¡¬ç¼ç æ²¡ææé«éç¨æ§ï¼èä¸é¾ä»¥è·è¸ªéè¯¯ãç±äºè¿äºåå ï¼åå»ºåæ¨¡å¼æ¯ç¡¬ç¼ç çè¡ä¸ºæ´æç¨ã\n\nåå»ºåæ¨¡å¼ä½¿è®¾è®¡åå¾æ´çµæ´»ï¼æä¾äºä¸åçæ¹å¼ï¼ä»ä»£ç ä¸­ç§»é¤äºå¯¹éè¦å®ä¾åçå·ä½ç±»çå¼ç¨ãæ¢å¥è¯è¯´ï¼è¿äºæ¨¡å¼å¢å¼ºäºå¯¹è±¡åç±»ä¹é´çç¬ç«æ§ã\n\nå¨ä»¥ä¸æåµä¸­ï¼å¯ä»¥èèåºç¨åå»ºåæ¨¡å¼ï¼\n\n * ä¸ä¸ªç³»ç»éè¦åå®çå¯¹è±¡åäº§åçåå»ºç¸äºç¬ç«ã\n * ä¸ç»ç¸å³çå¯¹è±¡è¢«è®¾è®¡ä¸ºä¸èµ·ä½¿ç¨ã\n * éèä¸ä¸ªç±»åºçå·ä½å®ç°ï¼ä»æ´é²å®ä»¬çæ¥å£ã\n * åå»ºç¬ç«å¤æå¯¹è±¡çä¸åè¡¨ç¤ºã\n * ä¸ä¸ªç±»å¸æå®çå­ç±»å®ç°å®æåå»ºçå¯¹è±¡ã\n * ç±»çå®ä¾åå¨è¿è¡æ¶ææå®ã\n * ä¸ä¸ªç±»åªè½æä¸ä¸ªå®ä¾ï¼èä¸è¿ä¸ªå®ä¾è½å¨ä»»ä½æ¶åè®¿é®å°ã\n * å®ä¾åºè¯¥è½å¨ä¸ä¿®æ¹çæåµä¸å·æå¯æ©å±æ§ã\n\n\n# 1.3. åå»ºåæ¨¡å¼ä»£è¡¨\n\n * åä¾æ¨¡å¼ (Singleton)\n * ç®åå·¥åæ¨¡å¼ (Simple Factory)\n * å·¥åæ¹æ³æ¨¡å¼ (Factory Method)\n * æ½è±¡å·¥åæ¨¡å¼ (Abstract Factory)\n * å»ºé èæ¨¡å¼ (Builder)\n * ååæ¨¡å¼ (Prototype)\n\n\n# 1.4. ç»æåæ¨¡å¼\n\n * ééå¨æ¨¡å¼ (Adapter)\n * æ¡¥æ¥æ¨¡å¼ (Bridge)\n * è£é¥°æ¨¡å¼ (Decorator)\n * ç»åæ¨¡å¼ (Composite)\n * å¤è§æ¨¡å¼ (Facade)\n * äº«åæ¨¡å¼ (Flyweight)\n * ä»£çæ¨¡å¼ (Proxy)\n\n\n# 1.5. è¡ä¸ºåæ¨¡å¼\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (Template Method)\n * å½ä»¤æ¨¡å¼ (Command)\n * è¿­ä»£å¨æ¨¡å¼ (Iterator)\n * è§å¯èæ¨¡å¼ (Observer)\n * è§£éå¨æ¨¡å¼ (Interpreter)\n * ä¸­ä»èæ¨¡å¼ (Mediator)\n * èè´£é¾æ¨¡å¼ (Chain of Responsibility)\n * å¤å¿å½æ¨¡å¼ (Memento)\n * ç­ç¥æ¨¡å¼ (Strategy)\n * è®¿é®èæ¨¡å¼ (Visitor)\n * ç¶ææ¨¡å¼ (State)\n\n\n# 2. ð èµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n\n\n# 3. ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# è®¾è®¡æ¨¡å¼æ¦è¿°\n\n> è®¾è®¡æ¨¡å¼ï¼design patternï¼ä»£è¡¨äºæä½³çå®è·µï¼éå¸¸è¢«æç»éªçé¢åå¯¹è±¡çè½¯ä»¶å¼åäººåæéç¨ãè®¾è®¡æ¨¡å¼æ¯è½¯ä»¶å¼åäººåå¨è½¯ä»¶å¼åè¿ç¨ä¸­é¢ä¸´çä¸è¬é®é¢çè§£å³æ¹æ¡ãè¿äºè§£å³æ¹æ¡æ¯ä¼å¤è½¯ä»¶å¼åäººåç»è¿ç¸å½é¿çä¸æ®µæ¶é´çè¯éªåéè¯¯æ»ç»åºæ¥çã\n\n\n# 1. åå»ºåæ¨¡å¼\n\n\n# 1.1. åå»ºåæ¨¡å¼ç®ä»\n\nåå»ºåæ¨¡å¼æ½è±¡äºå®ä¾åçè¿ç¨ãå®å°ç³»ç»ä¸å®çå¯¹è±¡åå»ºãç»åãè¡¨ç¤ºçæ¹å¼åç¦»ã\n\nåå»ºåæ¨¡å¼é½ä¼å°å³äºè¯¥ç³»ç»ä½¿ç¨åªäºå·ä½çç±»çä¿¡æ¯å°è£èµ·æ¥ã\n\nå¨è½¯ä»¶å·¥ç¨ä¸­ï¼åå»ºåæ¨¡å¼æ¯å¤çå¯¹è±¡åå»ºçè®¾è®¡æ¨¡å¼ï¼è¯å¾æ ¹æ®å®éæåµä½¿ç¨åéçæ¹å¼åå»ºå¯¹è±¡ã\n\nåºæ¬çå¯¹è±¡åå»ºæ¹å¼å¯è½ä¼å¯¼è´è®¾è®¡ä¸çé®é¢ï¼æå¢å è®¾è®¡çå¤æåº¦ãåå»ºåæ¨¡å¼éè¿ä»¥æç§æ¹å¼æ§å¶å¯¹è±¡çåå»ºæ¥è§£å³é®é¢ã\n\nåå»ºåæ¨¡å¼çæå¯¼ææ³æ¯ï¼\n\n * å°ç³»ç»ä½¿ç¨çå·ä½ç±»å°è£èµ·æ¥ã\n * éèè¿äºå·ä½ç±»çå®ä¾åå»ºåç»åçæ¹å¼ã\n\nåå»ºåæ¨¡å¼ååä¸ºå¯¹è±¡åå»ºåæ¨¡å¼åç±»åå»ºåæ¨¡å¼ãå¯¹è±¡åå»ºåæ¨¡å¼å¤çå¯¹è±¡çåå»ºï¼ç±»åå»ºåæ¨¡å¼å¤çç±»çåå»ºã\n\n * å¯¹è±¡åå»ºåæ¨¡å¼æå¯¹è±¡åå»ºçä¸é¨åæ¨è¿å°å¦ä¸ä¸ªå¯¹è±¡ä¸­ãï¼ä»£è¡¨æ¨¡å¼ï¼åä¾æ¨¡å¼ãå»ºé èæ¨¡å¼ãååæ¨¡å¼ãæ½è±¡å·¥åæ¨¡å¼ï¼\n * ç±»åå»ºåæ¨¡å¼å°å®å¯¹è±¡çåå»ºæ¨è¿å°å­ç±»ä¸­ãï¼ä»£è¡¨æ¨¡å¼ï¼å·¥åæ¹æ³æ¨¡å¼ï¼\n\n\n# 1.2. åå»ºåæ¨¡å¼åºç¨\n\nç°ä»£è½¯ä»¶å·¥ç¨æ´å ä¾èµå¯¹è±¡çç»åï¼èä¸æ¯ç±»çç»§æ¿ï¼å¼ºè°ä»ç¡¬ç¼ç çè¡ä¸ºè½¬åå°å®ä¹ä¸ç»åºæ¬è¡ä¸ºæ¥ç»åæå¤æçè¡ä¸ºã\n\nç¡¬ç¼ç çè¡ä¸ºä¸å¤çµæ´»ï¼å ä¸ºå¦ææ³è¦æ¹åè®¾è®¡çä¸é¨åï¼éè¦éè¿éåæèéæ°å®ç°æè½å®æã\n\nå¦å¤ï¼ç¡¬ç¼ç æ²¡ææé«éç¨æ§ï¼èä¸é¾ä»¥è·è¸ªéè¯¯ãç±äºè¿äºåå ï¼åå»ºåæ¨¡å¼æ¯ç¡¬ç¼ç çè¡ä¸ºæ´æç¨ã\n\nåå»ºåæ¨¡å¼ä½¿è®¾è®¡åå¾æ´çµæ´»ï¼æä¾äºä¸åçæ¹å¼ï¼ä»ä»£ç ä¸­ç§»é¤äºå¯¹éè¦å®ä¾åçå·ä½ç±»çå¼ç¨ãæ¢å¥è¯è¯´ï¼è¿äºæ¨¡å¼å¢å¼ºäºå¯¹è±¡åç±»ä¹é´çç¬ç«æ§ã\n\nå¨ä»¥ä¸æåµä¸­ï¼å¯ä»¥èèåºç¨åå»ºåæ¨¡å¼ï¼\n\n * ä¸ä¸ªç³»ç»éè¦åå®çå¯¹è±¡åäº§åçåå»ºç¸äºç¬ç«ã\n * ä¸ç»ç¸å³çå¯¹è±¡è¢«è®¾è®¡ä¸ºä¸èµ·ä½¿ç¨ã\n * éèä¸ä¸ªç±»åºçå·ä½å®ç°ï¼ä»æ´é²å®ä»¬çæ¥å£ã\n * åå»ºç¬ç«å¤æå¯¹è±¡çä¸åè¡¨ç¤ºã\n * ä¸ä¸ªç±»å¸æå®çå­ç±»å®ç°å®æåå»ºçå¯¹è±¡ã\n * ç±»çå®ä¾åå¨è¿è¡æ¶ææå®ã\n * ä¸ä¸ªç±»åªè½æä¸ä¸ªå®ä¾ï¼èä¸è¿ä¸ªå®ä¾è½å¨ä»»ä½æ¶åè®¿é®å°ã\n * å®ä¾åºè¯¥è½å¨ä¸ä¿®æ¹çæåµä¸å·æå¯æ©å±æ§ã\n\n\n# 1.3. åå»ºåæ¨¡å¼ä»£è¡¨\n\n * åä¾æ¨¡å¼ (singleton)\n * ç®åå·¥åæ¨¡å¼ (simple factory)\n * å·¥åæ¹æ³æ¨¡å¼ (factory method)\n * æ½è±¡å·¥åæ¨¡å¼ (abstract factory)\n * å»ºé èæ¨¡å¼ (builder)\n * ååæ¨¡å¼ (prototype)\n\n\n# 1.4. ç»æåæ¨¡å¼\n\n * ééå¨æ¨¡å¼ (adapter)\n * æ¡¥æ¥æ¨¡å¼ (bridge)\n * è£é¥°æ¨¡å¼ (decorator)\n * ç»åæ¨¡å¼ (composite)\n * å¤è§æ¨¡å¼ (facade)\n * äº«åæ¨¡å¼ (flyweight)\n * ä»£çæ¨¡å¼ (proxy)\n\n\n# 1.5. è¡ä¸ºåæ¨¡å¼\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (template method)\n * å½ä»¤æ¨¡å¼ (command)\n * è¿­ä»£å¨æ¨¡å¼ (iterator)\n * è§å¯èæ¨¡å¼ (observer)\n * è§£éå¨æ¨¡å¼ (interpreter)\n * ä¸­ä»èæ¨¡å¼ (mediator)\n * èè´£é¾æ¨¡å¼ (chain of responsibility)\n * å¤å¿å½æ¨¡å¼ (memento)\n * ç­ç¥æ¨¡å¼ (strategy)\n * è®¿é®èæ¨¡å¼ (visitor)\n * ç¶ææ¨¡å¼ (state)\n\n\n# 2. ð èµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n\n\n# 3. ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ç®åå·¥åæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ç®åå·¥åæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T09:41:00.000Z",permalink:"/pages/4244b2/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/01.%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/01.ç®åå·¥åæ¨¡å¼.md",key:"v-13d9f031",path:"/pages/4244b2/",headers:[{level:2,title:"1. ç®ä»",slug:"_1-ç®ä»",normalizedTitle:"1. ç®ä»",charIndex:18},{level:3,title:"1.1. ç®åå·¥åæ¨¡å¼ææ³",slug:"_1-1-ç®åå·¥åæ¨¡å¼ææ³",normalizedTitle:"1.1. ç®åå·¥åæ¨¡å¼ææ³",charIndex:28},{level:3,title:"1.2. ç®åå·¥åæ¨¡å¼è¦ç¹",slug:"_1-2-ç®åå·¥åæ¨¡å¼è¦ç¹",normalizedTitle:"1.2. ç®åå·¥åæ¨¡å¼è¦ç¹",charIndex:193},{level:2,title:"2. å®ä¾",slug:"_2-å®ä¾",normalizedTitle:"2. å®ä¾",charIndex:432},{level:2,title:"3. åèèµæ",slug:"_3-åèèµæ",normalizedTitle:"3. åèèµæ",charIndex:2540}],headersStr:"1. ç®ä» 1.1. ç®åå·¥åæ¨¡å¼ææ³ 1.2. ç®åå·¥åæ¨¡å¼è¦ç¹ 2. å®ä¾ 3. åèèµæ",content:"# è®¾è®¡æ¨¡å¼ä¹ç®åå·¥åæ¨¡å¼\n\n\n# 1. ç®ä»\n\n\n# 1.1. ç®åå·¥åæ¨¡å¼ææ³\n\nç®åå·¥åæ¨¡å¼ (Simple Factory) åå«éæå·¥åæ¹æ³ï¼Static Factory Methodï¼æ¨¡å¼ã\n\nç®åå·¥åæ¨¡å¼éå¸¸æ¯å®ä¹ä¸ä¸ªå·¥åç±»ï¼è¿ä¸ªç±»å¯ä»¥æ ¹æ®ä¸ååéè¿åä¸åç±»çäº§åå®ä¾ã\n\nç®åå·¥åæ¨¡å¼æ¯ä¸ç§å¯¹è±¡åå»ºåæ¨¡å¼ãä½æ¯ç®åå·¥åæ¨¡å¼ä¸å±äº23 ç§ Gof è®¾è®¡æ¨¡å¼ä¹ä¸ã\n\n\n# 1.2. ç®åå·¥åæ¨¡å¼è¦ç¹\n\nä¼ç¹ï¼ç®åå·¥åæ¨¡å¼çå·¥åç±»æ¯æ´ä¸ªæ¨¡å¼çå³é®ãå¶ä¸­åå«äºå¿è¦çé»è¾å¤æ­ï¼æ ¹æ®å¤é¨ä¿¡æ¯ï¼å³å®ç©¶ç«åºè¯¥åå»ºåªä¸ªå·ä½ç±»çå¯¹è±¡ãéè¿ä½¿ç¨ç®åå·¥åæ¨¡å¼ï¼ç¨æ·æ éäºè§£å¯¹è±¡å¦ä½åå»ºçï¼åªè¦ä¼ å¥å¿è¦ä¿¡æ¯å°±å¯ä»¥äºã\n\nç¼ºç¹ï¼å·¥åç±»éä¸­äºææå®ä¾çåå»ºé»è¾ï¼è¿èäºé«åèè´£ä»»åéååãéçç³»ç»ä¸­å·ä½äº§åç±»ä¸æ­å¢å¤ï¼å¿å¿è¦ä¸æ­ä¿®æ¹å·¥åç±»ï¼ä¸æç»´æ¤åæ©å±ãåæ¶ï¼è¿ä¹è¿èäºå¼æ¾å°é­ååã\n\n> å¼æ¾å°é­ååï¼ä¸ä¸ªè½¯ä»¶å®ä½å¦ç±»ãæ¨¡ååå½æ°åºè¯¥å¯¹æ©å±å¼æ¾ï¼å¯¹ä¿®æ¹å³é­ã\n\n\n# 2. å®ä¾\n\nå¦ä½å®ç°ä¸ä¸ªå·æå åä¹é¤åºæ¬åè½çè®¡ç®å¨ï¼\n\nå¯¹äºè¿åç§è¿ç®æ¥è¯´ï¼é½éè¦ä¸¤ä¸ªæä½æ°ï¼å·®å«ä»å¨äºè¿åçç»æä¸åã\n\nç±æ­¤ï¼æä»¬å¯ä»¥æ½è±¡åå®ä»¬çå±æ§ï¼æç¼åºä¸ä¸ªç¶ç±»ãè¿ä¸ªç±»ä¸­åå«ä¸¤ä¸ªæä½æ°ï¼ä¸ä¸ªè¿åç»ææ¹æ³ï¼è¿ä¸ªæ¹æ³ææå¨å­ç±»ä¸­å¾ä»¥å®ç°ã\n\nä»¥ä¸éè¿å·ä½ä»£ç æ¥è¯´æã\n\n\n\nãProduct (Operation) ã\n\näº§åè§è²ï¼ç®åå·¥åæ¨¡å¼æåå»ºçææå¯¹è±¡çç¶ç±»ï¼å®è´è´£æè¿°ææå®ä¾æå±æçå¬å±æ¥å£ã\n\n// Productè§è²ï¼ææå®ä¾æå±æçå¬å±æ¥å£\nabstract class Operation {\n    public int numA;\n    public int numB;\n    public abstract int GetResult();\n}\n\n\nãConcreteProduct ç»ã\n\nå·ä½äº§åè§è²ï¼å®ç° Product ä¸­çæ¥å£ã\n\n// ConcreteProduct è§è²ï¼å®ç° Product ä¸­çæ¥å£\nclass Add extends Operation {\n    @Override\n    public int GetResult() {\n        return numA + numB;\n    }\n}\n\n//ConcreteProduct è§è²ï¼å®ç° Product ä¸­çæ¥å£\nclass Sub extends Operation {\n    @Override\n    public int GetResult() {\n        return numA - numB;\n    }\n}\n\n//ConcreteProduct è§è²ï¼å®ç° Product ä¸­çæ¥å£\nclass Mul extends Operation {\n    @Override\n    public int GetResult() {\n        return numA * numB;\n    }\n}\n\n//ConcreteProduct è§è²ï¼å®ç° Product ä¸­çæ¥å£\nclass Div extends Operation {\n    @Override\n    public int GetResult() {\n        if (numB == 0) {\n            System.out.println(\"ERROR!\");\n            return -1;\n        }\n        return numA / numB;\n    }\n}\n\n\nãFactory (OperationFactory) ã\n\nå·¥åè§è²ï¼ç®åå·¥åæ¨¡å¼çæ ¸å¿ï¼å®è´è´£å®ç°åå»ºææå®ä¾çåé¨é»è¾ãå·¥åç±»çåå»ºäº§åç±»çæ¹æ³å¯ä»¥è¢«å¤çç´æ¥è°ç¨ï¼åå»ºæéçäº§åå¯¹è±¡ã\n\n// å·¥åè§è²ï¼ç®åå·¥åæ¨¡å¼çæ ¸å¿ï¼å®è´è´£å®ç°åå»ºææå®ä¾çåé¨é»è¾\nclass OperationFactory {\n    public static Operation CreateOperation (char operate) {\n        Operation oper = null;\n        switch(operate) {\n        case '+':\n            oper = new Add();\n            break;\n        case '-':\n            oper = new Sub();\n            break;\n        case '*':\n            oper = new Mul();\n            break;\n        case '/':\n            oper = new Div();\n            break;\n        default:\n            break;\n        }\n        return oper;\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class SimpleFactoryPattern {\n    public static void main(String[] args) {\n        int numA = 10;\n        int numB = 3;\n        int result = 0;\n        Operation oper = OperationFactory.CreateOperation('+');\n        oper.numA = numA;\n        oper.numB = numB;\n        result = oper.GetResult();\n        System.out.println(numA + \" + \" + numB + \" = \" + result);\n    }\n}\n\n\nãè¾åºã\n\n10 + 3 = 13\n\n\n\n# 3. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã",normalizedContent:"# è®¾è®¡æ¨¡å¼ä¹ç®åå·¥åæ¨¡å¼\n\n\n# 1. ç®ä»\n\n\n# 1.1. ç®åå·¥åæ¨¡å¼ææ³\n\nç®åå·¥åæ¨¡å¼ (simple factory) åå«éæå·¥åæ¹æ³ï¼static factory methodï¼æ¨¡å¼ã\n\nç®åå·¥åæ¨¡å¼éå¸¸æ¯å®ä¹ä¸ä¸ªå·¥åç±»ï¼è¿ä¸ªç±»å¯ä»¥æ ¹æ®ä¸ååéè¿åä¸åç±»çäº§åå®ä¾ã\n\nç®åå·¥åæ¨¡å¼æ¯ä¸ç§å¯¹è±¡åå»ºåæ¨¡å¼ãä½æ¯ç®åå·¥åæ¨¡å¼ä¸å±äº23 ç§ gof è®¾è®¡æ¨¡å¼ä¹ä¸ã\n\n\n# 1.2. ç®åå·¥åæ¨¡å¼è¦ç¹\n\nä¼ç¹ï¼ç®åå·¥åæ¨¡å¼çå·¥åç±»æ¯æ´ä¸ªæ¨¡å¼çå³é®ãå¶ä¸­åå«äºå¿è¦çé»è¾å¤æ­ï¼æ ¹æ®å¤é¨ä¿¡æ¯ï¼å³å®ç©¶ç«åºè¯¥åå»ºåªä¸ªå·ä½ç±»çå¯¹è±¡ãéè¿ä½¿ç¨ç®åå·¥åæ¨¡å¼ï¼ç¨æ·æ éäºè§£å¯¹è±¡å¦ä½åå»ºçï¼åªè¦ä¼ å¥å¿è¦ä¿¡æ¯å°±å¯ä»¥äºã\n\nç¼ºç¹ï¼å·¥åç±»éä¸­äºææå®ä¾çåå»ºé»è¾ï¼è¿èäºé«åèè´£ä»»åéååãéçç³»ç»ä¸­å·ä½äº§åç±»ä¸æ­å¢å¤ï¼å¿å¿è¦ä¸æ­ä¿®æ¹å·¥åç±»ï¼ä¸æç»´æ¤åæ©å±ãåæ¶ï¼è¿ä¹è¿èäºå¼æ¾å°é­ååã\n\n> å¼æ¾å°é­ååï¼ä¸ä¸ªè½¯ä»¶å®ä½å¦ç±»ãæ¨¡ååå½æ°åºè¯¥å¯¹æ©å±å¼æ¾ï¼å¯¹ä¿®æ¹å³é­ã\n\n\n# 2. å®ä¾\n\nå¦ä½å®ç°ä¸ä¸ªå·æå åä¹é¤åºæ¬åè½çè®¡ç®å¨ï¼\n\nå¯¹äºè¿åç§è¿ç®æ¥è¯´ï¼é½éè¦ä¸¤ä¸ªæä½æ°ï¼å·®å«ä»å¨äºè¿åçç»æä¸åã\n\nç±æ­¤ï¼æä»¬å¯ä»¥æ½è±¡åå®ä»¬çå±æ§ï¼æç¼åºä¸ä¸ªç¶ç±»ãè¿ä¸ªç±»ä¸­åå«ä¸¤ä¸ªæä½æ°ï¼ä¸ä¸ªè¿åç»ææ¹æ³ï¼è¿ä¸ªæ¹æ³ææå¨å­ç±»ä¸­å¾ä»¥å®ç°ã\n\nä»¥ä¸éè¿å·ä½ä»£ç æ¥è¯´æã\n\n\n\nãproduct (operation) ã\n\näº§åè§è²ï¼ç®åå·¥åæ¨¡å¼æåå»ºçææå¯¹è±¡çç¶ç±»ï¼å®è´è´£æè¿°ææå®ä¾æå±æçå¬å±æ¥å£ã\n\n// productè§è²ï¼ææå®ä¾æå±æçå¬å±æ¥å£\nabstract class operation {\n    public int numa;\n    public int numb;\n    public abstract int getresult();\n}\n\n\nãconcreteproduct ç»ã\n\nå·ä½äº§åè§è²ï¼å®ç° product ä¸­çæ¥å£ã\n\n// concreteproduct è§è²ï¼å®ç° product ä¸­çæ¥å£\nclass add extends operation {\n    @override\n    public int getresult() {\n        return numa + numb;\n    }\n}\n\n//concreteproduct è§è²ï¼å®ç° product ä¸­çæ¥å£\nclass sub extends operation {\n    @override\n    public int getresult() {\n        return numa - numb;\n    }\n}\n\n//concreteproduct è§è²ï¼å®ç° product ä¸­çæ¥å£\nclass mul extends operation {\n    @override\n    public int getresult() {\n        return numa * numb;\n    }\n}\n\n//concreteproduct è§è²ï¼å®ç° product ä¸­çæ¥å£\nclass div extends operation {\n    @override\n    public int getresult() {\n        if (numb == 0) {\n            system.out.println(\"error!\");\n            return -1;\n        }\n        return numa / numb;\n    }\n}\n\n\nãfactory (operationfactory) ã\n\nå·¥åè§è²ï¼ç®åå·¥åæ¨¡å¼çæ ¸å¿ï¼å®è´è´£å®ç°åå»ºææå®ä¾çåé¨é»è¾ãå·¥åç±»çåå»ºäº§åç±»çæ¹æ³å¯ä»¥è¢«å¤çç´æ¥è°ç¨ï¼åå»ºæéçäº§åå¯¹è±¡ã\n\n// å·¥åè§è²ï¼ç®åå·¥åæ¨¡å¼çæ ¸å¿ï¼å®è´è´£å®ç°åå»ºææå®ä¾çåé¨é»è¾\nclass operationfactory {\n    public static operation createoperation (char operate) {\n        operation oper = null;\n        switch(operate) {\n        case '+':\n            oper = new add();\n            break;\n        case '-':\n            oper = new sub();\n            break;\n        case '*':\n            oper = new mul();\n            break;\n        case '/':\n            oper = new div();\n            break;\n        default:\n            break;\n        }\n        return oper;\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class simplefactorypattern {\n    public static void main(string[] args) {\n        int numa = 10;\n        int numb = 3;\n        int result = 0;\n        operation oper = operationfactory.createoperation('+');\n        oper.numa = numa;\n        oper.numb = numb;\n        result = oper.getresult();\n        system.out.println(numa + \" + \" + numb + \" = \" + result);\n    }\n}\n\n\nãè¾åºã\n\n10 + 3 = 13\n\n\n\n# 3. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹å·¥åæ¹æ³æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹å·¥åæ¹æ³æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T10:03:00.000Z",permalink:"/pages/58cd12/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/02.%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/02.å·¥åæ¹æ³æ¨¡å¼.md",key:"v-a097a3be",path:"/pages/58cd12/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:18},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:361},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:502},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:514},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:1004},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1992},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:4077},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5977},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6301}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹å·¥åæ¹æ³æ¨¡å¼\n\n\n# 1. æå¾\n\nå·¥åæ¹æ³æ¨¡å¼ (Factory Method)æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ å¶å¨ç¶ç±»ä¸­æä¾ä¸ä¸ªåå»ºå¯¹è±¡çæ¹æ³ï¼ è®©å­ç±»å³å®å®ä¾åå¯¹è±¡çç±»åã\n\n * å·¥åæ¨¡å¼ä¸­ï¼å¢å ä¸ç§äº§åç±»ï¼å°±è¦å¢å ä¸ä¸ªå·¥åç±»ï¼å ä¸ºæ¯ä¸ªå·¥åç±»åªè½åå»ºä¸ç§äº§åçå®ä¾ã\n * å·¥åæ¨¡å¼éµå¾ªâå¼æ¾-å°é­ååâï¼å·¥åæ¨¡å¼ä¸­ï¼æ°å¢ä¸ç§äº§åå¹¶ä¸éè¦ä¿®æ¹åæç±»ï¼ä»ä»æ¯æ©å±ã\n\nç®åå·¥åæ¨¡å¼ç¸æ¯äºå·¥åæ¹æ³æ¨¡å¼\n\nä¼ç¹ï¼å·¥åç±»ä¸­åå«å¿è¦çé»è¾å¤æ­ï¼å¯æ ¹æ®å®¢æ·ç«¯çéæ©æ¡ä»¶å¨æå®ä¾åéè¦çç±»ãå¯¹äºå®¢æ·ç«¯æ¥è¯´ï¼å»é¤äºå¯¹å·ä½äº§åçä¾èµã\n\nç¼ºç¹ï¼è¿èäºå¼æ¾å°é­ååã æ¯æ·»å ä¸ä¸ªæ°çäº§åï¼é½éè¦å¯¹åæç±»è¿è¡ä¿®æ¹ãå¢å ç»´æ¤ææ¬ï¼ä¸ä¸æäºç»´æ¤ã\n\n> å¼æ¾å°é­ååï¼ä¸ä¸ªè½¯ä»¶å®ä½å¦ç±»ãæ¨¡ååå½æ°åºè¯¥å¯¹æ©å±å¼æ¾ï¼å¯¹ä¿®æ¹å³é­ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ å¨ç¼åä»£ç çè¿ç¨ä¸­ï¼ å¦ææ æ³é¢ç¥å¯¹è±¡ç¡®åç±»å«åå¶ä¾èµå³ç³»æ¶ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n * å¦æä½ å¸æç¨æ·è½æ©å±ä½ è½¯ä»¶åºææ¡æ¶çåé¨ç»ä»¶ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n * å¦æä½ å¸æå¤ç¨ç°æå¯¹è±¡æ¥èçç³»ç»èµæºï¼ èä¸æ¯æ¯æ¬¡é½éæ°åå»ºå¯¹è±¡ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. äº§å ï¼Productï¼ å°ä¼å¯¹æ¥å£è¿è¡å£°æã å¯¹äºææç±åå»ºèåå¶å­ç±»æå»ºçå¯¹è±¡ï¼ è¿äºæ¥å£é½æ¯éç¨çã\n 2. å·ä½äº§å ï¼Concrete Productsï¼ æ¯äº§åæ¥å£çä¸åå®ç°ã\n 3. åå»ºè ï¼Creatorï¼ ç±»å£°æè¿åäº§åå¯¹è±¡çå·¥åæ¹æ³ã è¯¥æ¹æ³çè¿åå¯¹è±¡ç±»åå¿é¡»ä¸äº§åæ¥å£ç¸å¹éã\n\n * ä½ å¯ä»¥å°å·¥åæ¹æ³å£°æä¸ºæ½è±¡æ¹æ³ï¼ å¼ºå¶è¦æ±æ¯ä¸ªå­ç±»ä»¥ä¸åæ¹å¼å®ç°è¯¥æ¹æ³ã æèï¼ ä½ ä¹å¯ä»¥å¨åºç¡å·¥åæ¹æ³ä¸­è¿åé»è®¤äº§åç±»åã\n * æ³¨æï¼ å°½ç®¡å®çåå­æ¯åå»ºèï¼ ä½ä»æä¸»è¦çèè´£å¹¶ä¸æ¯åå»ºäº§åã ä¸è¬æ¥è¯´ï¼ åå»ºèç±»åå«ä¸äºä¸äº§åç¸å³çæ ¸å¿ä¸å¡é»è¾ã å·¥åæ¹æ³å°è¿äºé»è¾å¤çä»å·ä½äº§åç±»ä¸­åç¦»åºæ¥ã æä¸ªæ¯æ¹ï¼ å¤§åè½¯ä»¶å¼åå¬å¸æ¥æç¨åºåå¹è®­é¨é¨ã ä½æ¯ï¼ è¿äºå¬å¸çä¸»è¦å·¥ä½è¿æ¯ç¼åä»£ç ï¼ èéçäº§ç¨åºåã\n\n 4. å·ä½åå»ºè ï¼Concrete Creatorsï¼ å°ä¼éååºç¡å·¥åæ¹æ³ï¼ ä½¿å¶è¿åä¸åç±»åçäº§åã æ³¨æï¼ å¹¶ä¸ä¸å®æ¯æ¬¡è°ç¨å·¥åæ¹æ³é½ä¼åå»ºæ°çå®ä¾ã å·¥åæ¹æ³ä¹å¯ä»¥è¿åç¼å­ã å¯¹è±¡æ± æå¶ä»æ¥æºçå·²æå¯¹è±¡ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãProductã\n\nå®ä¹äº§åå¯¹è±¡çæ¥å£ã\n\nabstract class Product {\n    public abstract void use();\n}\n\n\nãConcreteProductã\n\nå®ç° Product æ¥å£ã\n\nclass ConcreteProduct extends Product {\n    public ConcreteProduct() {\n        System.out.println("åå»º ConcreteProduct äº§å");\n    }\n\n    @Override\n    public void Use() {\n        System.out.println("ä½¿ç¨ ConcreteProduct äº§å");\n    }\n}\n\n\nãCreatorã\n\nå£°æå·¥åæ¹æ³ï¼å®ä¼è¿åä¸ä¸ªäº§åç±»åçå¯¹è±¡ã Creator ä¹å¯ä»¥å®ç°ä¸ä¸ªé»è®¤çå·¥åæ¹æ³ factoryMethod() ï¼ä»¥è¿åä¸ä¸ªé»è®¤çå·ä½äº§åç±»åã\n\ninterface Creator {\n    public Product factoryMethod();\n}\n\n\nãConcreteCreatorã\n\nè¦å Creator ä¸­çå·¥åæ¹æ³ factoryMethod() ã\n\nclass ConcreteCreator implements Creator {\n    @Override\n    public Product factoryMethod() {\n        return new ConcreteProduct();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class factoryMethodPattern {\n    public static void main(String[] args) {\n        Creator factory = new ConcreteCreator();\n        Product product = factory.factoryMethod();\n        product.Use();\n    }\n}\n\n\nãè¾åºã\n\nåå»º ConcreteProduct äº§å\nä½¿ç¨ ConcreteProduct äº§å\n\n\n\n# 4. ä¼ªä»£ç \n\nä»¥ä¸ç¤ºä¾æ¼ç¤ºäºå¦ä½ä½¿ç¨å·¥åæ¹æ³å¼åè·¨å¹³å° UI ï¼ç¨æ·çé¢ï¼ ç»ä»¶ï¼ å¹¶åæ¶é¿åå®¢æ·ä»£ç ä¸å·ä½ UI ç±»ä¹é´çè¦åã\n\n\n\nåºç¡å¯¹è¯æ¡ç±»ä½¿ç¨ä¸åç UI ç»ä»¶æ¸²æçªå£ã å¨ä¸åçæä½ç³»ç»ä¸ï¼ è¿äºç»ä»¶å¤è§æè®¸ç¥æä¸åï¼ ä½å¶åè½ä¿æä¸è´ã Windows ç³»ç»ä¸­çæé®å¨ Linux ç³»ç»ä¸­ä»ç¶æ¯æé®ã\n\nå¦æä½¿ç¨å·¥åæ¹æ³ï¼ å°±ä¸éè¦ä¸ºæ¯ç§æä½ç³»ç»éåå¯¹è¯æ¡é»è¾ã å¦ææä»¬å£°æäºä¸ä¸ªå¨åºæ¬å¯¹è¯æ¡ç±»ä¸­çææé®çå·¥åæ¹æ³ï¼ é£ä¹æä»¬å°±å¯ä»¥åå»ºä¸ä¸ªå¯¹è¯æ¡å­ç±»ï¼ å¹¶ä½¿å¶éè¿å·¥åæ¹æ³è¿å Windows æ ·å¼æé®ã å­ç±»å°ç»§æ¿å¯¹è¯æ¡åºç¡ç±»çå¤§é¨åä»£ç ï¼ åæ¶å¨å±å¹ä¸æ ¹æ® Windows æ ·å¼æ¸²ææé®ã\n\nå¦éè¯¥æ¨¡å¼æ­£å¸¸å·¥ä½ï¼ åºç¡å¯¹è¯æ¡ç±»å¿é¡»ä½¿ç¨æ½è±¡æé® ï¼ä¾å¦åºç±»ææ¥å£ï¼ï¼ ä»¥ä¾¿å°å¶æ©å±ä¸ºå·ä½æé®ã è¿æ ·ä¸æ¥ï¼ æ è®ºå¯¹è¯æ¡ä¸­ä½¿ç¨ä½ç§ç±»åçæé®ï¼ å¶ä»£ç é½å¯ä»¥æ­£å¸¸å·¥ä½ã\n\nä½ å¯ä»¥ä½¿ç¨æ­¤æ¹æ³å¼åå¶ä» UI ç»ä»¶ã ä¸è¿ï¼ æ¯åå¯¹è¯æ¡ä¸­æ·»å ä¸ä¸ªæ°çå·¥åæ¹æ³ï¼ ä½ å°±ç¦»æ½è±¡å·¥åæ¨¡å¼æ´è¿ä¸æ­¥ã æä»¬å°å¨ç¨åè°å°è¿ä¸ªæ¨¡å¼ã\n\n// åå»ºèç±»å£°æçå·¥åæ¹æ³å¿é¡»è¿åä¸ä¸ªäº§åç±»çå¯¹è±¡ãåå»ºèçå­ç±»éå¸¸ä¼æä¾\n// è¯¥æ¹æ³çå®ç°ã\nclass Dialog is\n    // åå»ºèè¿å¯æä¾ä¸äºå·¥åæ¹æ³çé»è®¤å®ç°ã\n    abstract method createButton():Button\n\n    // è¯·æ³¨æï¼åå»ºèçä¸»è¦èè´£å¹¶éæ¯åå»ºäº§åãå¶ä¸­éå¸¸ä¼åå«ä¸äºæ ¸å¿ä¸å¡\n    // é»è¾ï¼è¿äºé»è¾ä¾èµäºç±å·¥åæ¹æ³è¿åçäº§åå¯¹è±¡ãå­ç±»å¯éè¿éåå·¥åæ¹\n    // æ³å¹¶ä½¿å¶è¿åä¸åç±»åçäº§åæ¥é´æ¥ä¿®æ¹ä¸å¡é»è¾ã\n    method render() is\n        // è°ç¨å·¥åæ¹æ³åå»ºä¸ä¸ªäº§åå¯¹è±¡ã\n        Button okButton = createButton()\n        // ç°å¨ä½¿ç¨äº§åã\n        okButton.onClick(closeDialog)\n        okButton.render()\n\n\n// å·ä½åå»ºèå°éåå·¥åæ¹æ³ä»¥æ¹åå¶æè¿åçäº§åç±»åã\nclass WindowsDialog extends Dialog is\n    method createButton():Button is\n        return new WindowsButton()\n\nclass WebDialog extends Dialog is\n    method createButton():Button is\n        return new HTMLButton()\n\n\n// äº§åæ¥å£ä¸­å°å£°æææå·ä½äº§åé½å¿é¡»å®ç°çæä½ã\ninterface Button is\n    method render()\n    method onClick(f)\n\n// å·ä½äº§åéæä¾äº§åæ¥å£çåç§å®ç°ã\nclass WindowsButton implements Button is\n    method render(a, b) is\n        // æ ¹æ® Windows æ ·å¼æ¸²ææé®ã\n    method onClick(f) is\n        // ç»å®æ¬å°æä½ç³»ç»ç¹å»äºä»¶ã\n\nclass HTMLButton implements Button is\n    method render(a, b) is\n        // è¿åä¸ä¸ªæé®ç HTML è¡¨è¿°ã\n    method onClick(f) is\n        // ç»å®ç½ç»æµè§å¨çç¹å»äºä»¶ã\n\n\nclass Application is\n    field dialog: Dialog\n\n    // ç¨åºæ ¹æ®å½åéç½®æç¯å¢è®¾å®éæ©åå»ºèçç±»åã\n    method initialize() is\n        config = readApplicationConfigFile()\n\n        if (config.OS == "Windows") then\n            dialog = new WindowsDialog()\n        else if (config.OS == "Web") then\n            dialog = new WebDialog()\n        else\n            throw new Exception("éè¯¯ï¼æªç¥çæä½ç³»ç»ã")\n\n    // å½åå®¢æ·ç«¯ä»£ç ä¼ä¸å·ä½åå»ºèçå®ä¾è¿è¡äº¤äºï¼ä½æ¯å¿é¡»éè¿å¶åºæ¬æ¥å£\n    // è¿è¡ãåªè¦å®¢æ·ç«¯éè¿åºæ¬æ¥å£ä¸åå»ºèè¿è¡äº¤äºï¼ä½ å°±å¯å°ä»»ä½åå»ºèå­\n    // ç±»ä¼ éç»å®¢æ·ç«¯ã\n    method main() is\n        this.initialize()\n        dialog.render()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å·¥åæ¹æ³æ¨¡å¼å¨ Java ä»£ç ä¸­å¾å°äºå¹¿æ³ä½¿ç¨ã å½ä½ éè¦å¨ä»£ç ä¸­æä¾é«å±æ¬¡ççµæ´»æ§æ¶ï¼ è¯¥æ¨¡å¼ä¼éå¸¸å®ç¨ã\n\næ ¸å¿ Java ç¨åºåºä¸­æè¯¥æ¨¡å¼çåºç¨ï¼\n\n * java.util.Calendar#getInstance()\n * java.util.ResourceBundle#getBundle()\n * java.text.NumberFormat#getInstance()\n * java.nio.charset.Charset#forName()\n * java.net.URLStreamHandlerFactory#createURLStreamHandler(String) ï¼æ ¹æ®åè®®è¿åä¸åçåä¾å¯¹è±¡ï¼\n * java.util.EnumSet#of()\n * javax.xml.bind.JAXBContext#createMarshaller() åå¶ä»ç±»ä¼¼çæ¹æ³ã\n\nè¯å«æ¹æ³ï¼ å·¥åæ¹æ³å¯éè¿æå»ºæ¹æ³æ¥è¯å«ï¼ å®ä¼åå»ºå·ä½ç±»çå¯¹è±¡ï¼ ä½ä»¥æ½è±¡ç±»åææ¥å£çå½¢å¼è¿åè¿äºå¯¹è±¡ã\n\nè¿æ¯ä»¥ ç®åå·¥åæ¨¡å¼ éçä¾å­æ¥è¿è¡è¯´æã\n\nå¦ä½å®ç°ä¸ä¸ªå·æå åä¹é¤åºæ¬åè½çè®¡ç®å¨ï¼\n\nä¸¤ç§æ¨¡å¼ç Product å ConcreteProduct è§è²ä»£ç æ²¡æåºå«ï¼ä¸åèµè¿°ã\n\nå·®å¼å¨äº Factory è§è²é¨åï¼ä»¥åå®¢æ·ç«¯é¨åï¼è¯·å¨ä»£ç ä¸­ä½ä¼ã\n\nãCreator è§è²ã\n\n// Creator è§è²ï¼å®ä¹è¿åäº§åå®ä¾çå¬å±å·¥åæ¹æ³\ninterface OperationFactory {\n    public Operation factoryMethod();\n}\n\n\nãConcreteCreator è§è²ã\n\nåç®åå·¥åæ¨¡å¼ç¸æ¯ï¼æ¯ä¸ç§äº§åé½ä¼æä¸ä¸ªå·ä½çå·¥åç±»è´è´£çäº§å®ä¾ã\n\n// ConcreteCreator è§è²ï¼å·ä½å®ç° Creator ä¸­çæ¹æ³\nclass AddFactory implements OperationFactory {\n    @Override\n    public Operation factoryMethod() {\n        return new Add();\n    }\n}\n\n// ConcreteCreator è§è²ï¼å·ä½å®ç° Creator ä¸­çæ¹æ³\nclass SubFactory implements OperationFactory {\n    @Override\n    public Operation factoryMethod() {\n        return new Sub();\n    }\n}\n\n// ConcreteCreator è§è²ï¼å·ä½å®ç° Creator ä¸­çæ¹æ³\nclass MulFactory implements OperationFactory {\n    @Override\n    public Operation factoryMethod() {\n        return new Mul();\n    }\n}\n\n// ConcreteCreator è§è²ï¼å·ä½å®ç° Creator ä¸­çæ¹æ³\nclass DivFactory implements OperationFactory {\n    @Override\n    public Operation factoryMethod() {\n        return new Div();\n    }\n}\n\n\nãClient è§è²ã\n\nä¸ç®åå·¥åæ¨¡å¼ä¸­æ éå³æ³¨å·ä½åå»ºä¸åï¼å·¥åæ¨¡å¼ä¸­éè¦æå®å·ä½å·¥åï¼ä»¥è´è´£çäº§å·ä½å¯¹åºçäº§åã\n\n// Client è§è²ï¼éè¦æå®å·ä½å·¥åï¼ä»¥è´è´£çäº§å·ä½äº§å\npublic class factoryMethodPattern {\n    public static void main(String[] args) {\n        OperationFactory factory = new SubFactory();\n        Operation oper = factory.factoryMethod();\n        oper.numA = 3;\n        oper.numB = 2;\n        double result = oper.getResult();\n        System.out.println("result = " + result);\n    }\n}\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å·¥åæ¹æ³åè¿­ä»£å¨æ¨¡å¼æ¥è®©å­ç±»éåè¿åä¸åç±»åçè¿­ä»£å¨ï¼ å¹¶ä½¿å¾è¿­ä»£å¨ä¸éåç¸å¹éã\n * ååå¹¶ä¸åºäºç»§æ¿ï¼ å æ­¤æ²¡æç»§æ¿çç¼ºç¹ã å¦ä¸æ¹é¢ï¼ ååéè¦å¯¹è¢«å¤å¶å¯¹è±¡è¿è¡å¤æçåå§åã å·¥åæ¹æ³åºäºç»§æ¿ï¼ ä½æ¯å®ä¸éè¦åå§åæ­¥éª¤ã\n * å·¥åæ¹æ³æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼çä¸ç§ç¹æ®å½¢å¼ã åæ¶ï¼ å·¥åæ¹æ³å¯ä»¥ä½ä¸ºä¸ä¸ªå¤§åæ¨¡æ¿æ¹æ³ä¸­çä¸ä¸ªæ­¥éª¤ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹å·¥åæ¹æ³æ¨¡å¼\n\n\n# 1. æå¾\n\nå·¥åæ¹æ³æ¨¡å¼ (factory method)æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ å¶å¨ç¶ç±»ä¸­æä¾ä¸ä¸ªåå»ºå¯¹è±¡çæ¹æ³ï¼ è®©å­ç±»å³å®å®ä¾åå¯¹è±¡çç±»åã\n\n * å·¥åæ¨¡å¼ä¸­ï¼å¢å ä¸ç§äº§åç±»ï¼å°±è¦å¢å ä¸ä¸ªå·¥åç±»ï¼å ä¸ºæ¯ä¸ªå·¥åç±»åªè½åå»ºä¸ç§äº§åçå®ä¾ã\n * å·¥åæ¨¡å¼éµå¾ªâå¼æ¾-å°é­ååâï¼å·¥åæ¨¡å¼ä¸­ï¼æ°å¢ä¸ç§äº§åå¹¶ä¸éè¦ä¿®æ¹åæç±»ï¼ä»ä»æ¯æ©å±ã\n\nç®åå·¥åæ¨¡å¼ç¸æ¯äºå·¥åæ¹æ³æ¨¡å¼\n\nä¼ç¹ï¼å·¥åç±»ä¸­åå«å¿è¦çé»è¾å¤æ­ï¼å¯æ ¹æ®å®¢æ·ç«¯çéæ©æ¡ä»¶å¨æå®ä¾åéè¦çç±»ãå¯¹äºå®¢æ·ç«¯æ¥è¯´ï¼å»é¤äºå¯¹å·ä½äº§åçä¾èµã\n\nç¼ºç¹ï¼è¿èäºå¼æ¾å°é­ååã æ¯æ·»å ä¸ä¸ªæ°çäº§åï¼é½éè¦å¯¹åæç±»è¿è¡ä¿®æ¹ãå¢å ç»´æ¤ææ¬ï¼ä¸ä¸æäºç»´æ¤ã\n\n> å¼æ¾å°é­ååï¼ä¸ä¸ªè½¯ä»¶å®ä½å¦ç±»ãæ¨¡ååå½æ°åºè¯¥å¯¹æ©å±å¼æ¾ï¼å¯¹ä¿®æ¹å³é­ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ å¨ç¼åä»£ç çè¿ç¨ä¸­ï¼ å¦ææ æ³é¢ç¥å¯¹è±¡ç¡®åç±»å«åå¶ä¾èµå³ç³»æ¶ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n * å¦æä½ å¸æç¨æ·è½æ©å±ä½ è½¯ä»¶åºææ¡æ¶çåé¨ç»ä»¶ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n * å¦æä½ å¸æå¤ç¨ç°æå¯¹è±¡æ¥èçç³»ç»èµæºï¼ èä¸æ¯æ¯æ¬¡é½éæ°åå»ºå¯¹è±¡ï¼ å¯ä½¿ç¨å·¥åæ¹æ³ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. äº§å ï¼productï¼ å°ä¼å¯¹æ¥å£è¿è¡å£°æã å¯¹äºææç±åå»ºèåå¶å­ç±»æå»ºçå¯¹è±¡ï¼ è¿äºæ¥å£é½æ¯éç¨çã\n 2. å·ä½äº§å ï¼concrete productsï¼ æ¯äº§åæ¥å£çä¸åå®ç°ã\n 3. åå»ºè ï¼creatorï¼ ç±»å£°æè¿åäº§åå¯¹è±¡çå·¥åæ¹æ³ã è¯¥æ¹æ³çè¿åå¯¹è±¡ç±»åå¿é¡»ä¸äº§åæ¥å£ç¸å¹éã\n\n * ä½ å¯ä»¥å°å·¥åæ¹æ³å£°æä¸ºæ½è±¡æ¹æ³ï¼ å¼ºå¶è¦æ±æ¯ä¸ªå­ç±»ä»¥ä¸åæ¹å¼å®ç°è¯¥æ¹æ³ã æèï¼ ä½ ä¹å¯ä»¥å¨åºç¡å·¥åæ¹æ³ä¸­è¿åé»è®¤äº§åç±»åã\n * æ³¨æï¼ å°½ç®¡å®çåå­æ¯åå»ºèï¼ ä½ä»æä¸»è¦çèè´£å¹¶ä¸æ¯åå»ºäº§åã ä¸è¬æ¥è¯´ï¼ åå»ºèç±»åå«ä¸äºä¸äº§åç¸å³çæ ¸å¿ä¸å¡é»è¾ã å·¥åæ¹æ³å°è¿äºé»è¾å¤çä»å·ä½äº§åç±»ä¸­åç¦»åºæ¥ã æä¸ªæ¯æ¹ï¼ å¤§åè½¯ä»¶å¼åå¬å¸æ¥æç¨åºåå¹è®­é¨é¨ã ä½æ¯ï¼ è¿äºå¬å¸çä¸»è¦å·¥ä½è¿æ¯ç¼åä»£ç ï¼ èéçäº§ç¨åºåã\n\n 4. å·ä½åå»ºè ï¼concrete creatorsï¼ å°ä¼éååºç¡å·¥åæ¹æ³ï¼ ä½¿å¶è¿åä¸åç±»åçäº§åã æ³¨æï¼ å¹¶ä¸ä¸å®æ¯æ¬¡è°ç¨å·¥åæ¹æ³é½ä¼åå»ºæ°çå®ä¾ã å·¥åæ¹æ³ä¹å¯ä»¥è¿åç¼å­ã å¯¹è±¡æ± æå¶ä»æ¥æºçå·²æå¯¹è±¡ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãproductã\n\nå®ä¹äº§åå¯¹è±¡çæ¥å£ã\n\nabstract class product {\n    public abstract void use();\n}\n\n\nãconcreteproductã\n\nå®ç° product æ¥å£ã\n\nclass concreteproduct extends product {\n    public concreteproduct() {\n        system.out.println("åå»º concreteproduct äº§å");\n    }\n\n    @override\n    public void use() {\n        system.out.println("ä½¿ç¨ concreteproduct äº§å");\n    }\n}\n\n\nãcreatorã\n\nå£°æå·¥åæ¹æ³ï¼å®ä¼è¿åä¸ä¸ªäº§åç±»åçå¯¹è±¡ã creator ä¹å¯ä»¥å®ç°ä¸ä¸ªé»è®¤çå·¥åæ¹æ³ factorymethod() ï¼ä»¥è¿åä¸ä¸ªé»è®¤çå·ä½äº§åç±»åã\n\ninterface creator {\n    public product factorymethod();\n}\n\n\nãconcretecreatorã\n\nè¦å creator ä¸­çå·¥åæ¹æ³ factorymethod() ã\n\nclass concretecreator implements creator {\n    @override\n    public product factorymethod() {\n        return new concreteproduct();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class factorymethodpattern {\n    public static void main(string[] args) {\n        creator factory = new concretecreator();\n        product product = factory.factorymethod();\n        product.use();\n    }\n}\n\n\nãè¾åºã\n\nåå»º concreteproduct äº§å\nä½¿ç¨ concreteproduct äº§å\n\n\n\n# 4. ä¼ªä»£ç \n\nä»¥ä¸ç¤ºä¾æ¼ç¤ºäºå¦ä½ä½¿ç¨å·¥åæ¹æ³å¼åè·¨å¹³å° ui ï¼ç¨æ·çé¢ï¼ ç»ä»¶ï¼ å¹¶åæ¶é¿åå®¢æ·ä»£ç ä¸å·ä½ ui ç±»ä¹é´çè¦åã\n\n\n\nåºç¡å¯¹è¯æ¡ç±»ä½¿ç¨ä¸åç ui ç»ä»¶æ¸²æçªå£ã å¨ä¸åçæä½ç³»ç»ä¸ï¼ è¿äºç»ä»¶å¤è§æè®¸ç¥æä¸åï¼ ä½å¶åè½ä¿æä¸è´ã windows ç³»ç»ä¸­çæé®å¨ linux ç³»ç»ä¸­ä»ç¶æ¯æé®ã\n\nå¦æä½¿ç¨å·¥åæ¹æ³ï¼ å°±ä¸éè¦ä¸ºæ¯ç§æä½ç³»ç»éåå¯¹è¯æ¡é»è¾ã å¦ææä»¬å£°æäºä¸ä¸ªå¨åºæ¬å¯¹è¯æ¡ç±»ä¸­çææé®çå·¥åæ¹æ³ï¼ é£ä¹æä»¬å°±å¯ä»¥åå»ºä¸ä¸ªå¯¹è¯æ¡å­ç±»ï¼ å¹¶ä½¿å¶éè¿å·¥åæ¹æ³è¿å windows æ ·å¼æé®ã å­ç±»å°ç»§æ¿å¯¹è¯æ¡åºç¡ç±»çå¤§é¨åä»£ç ï¼ åæ¶å¨å±å¹ä¸æ ¹æ® windows æ ·å¼æ¸²ææé®ã\n\nå¦éè¯¥æ¨¡å¼æ­£å¸¸å·¥ä½ï¼ åºç¡å¯¹è¯æ¡ç±»å¿é¡»ä½¿ç¨æ½è±¡æé® ï¼ä¾å¦åºç±»ææ¥å£ï¼ï¼ ä»¥ä¾¿å°å¶æ©å±ä¸ºå·ä½æé®ã è¿æ ·ä¸æ¥ï¼ æ è®ºå¯¹è¯æ¡ä¸­ä½¿ç¨ä½ç§ç±»åçæé®ï¼ å¶ä»£ç é½å¯ä»¥æ­£å¸¸å·¥ä½ã\n\nä½ å¯ä»¥ä½¿ç¨æ­¤æ¹æ³å¼åå¶ä» ui ç»ä»¶ã ä¸è¿ï¼ æ¯åå¯¹è¯æ¡ä¸­æ·»å ä¸ä¸ªæ°çå·¥åæ¹æ³ï¼ ä½ å°±ç¦»æ½è±¡å·¥åæ¨¡å¼æ´è¿ä¸æ­¥ã æä»¬å°å¨ç¨åè°å°è¿ä¸ªæ¨¡å¼ã\n\n// åå»ºèç±»å£°æçå·¥åæ¹æ³å¿é¡»è¿åä¸ä¸ªäº§åç±»çå¯¹è±¡ãåå»ºèçå­ç±»éå¸¸ä¼æä¾\n// è¯¥æ¹æ³çå®ç°ã\nclass dialog is\n    // åå»ºèè¿å¯æä¾ä¸äºå·¥åæ¹æ³çé»è®¤å®ç°ã\n    abstract method createbutton():button\n\n    // è¯·æ³¨æï¼åå»ºèçä¸»è¦èè´£å¹¶éæ¯åå»ºäº§åãå¶ä¸­éå¸¸ä¼åå«ä¸äºæ ¸å¿ä¸å¡\n    // é»è¾ï¼è¿äºé»è¾ä¾èµäºç±å·¥åæ¹æ³è¿åçäº§åå¯¹è±¡ãå­ç±»å¯éè¿éåå·¥åæ¹\n    // æ³å¹¶ä½¿å¶è¿åä¸åç±»åçäº§åæ¥é´æ¥ä¿®æ¹ä¸å¡é»è¾ã\n    method render() is\n        // è°ç¨å·¥åæ¹æ³åå»ºä¸ä¸ªäº§åå¯¹è±¡ã\n        button okbutton = createbutton()\n        // ç°å¨ä½¿ç¨äº§åã\n        okbutton.onclick(closedialog)\n        okbutton.render()\n\n\n// å·ä½åå»ºèå°éåå·¥åæ¹æ³ä»¥æ¹åå¶æè¿åçäº§åç±»åã\nclass windowsdialog extends dialog is\n    method createbutton():button is\n        return new windowsbutton()\n\nclass webdialog extends dialog is\n    method createbutton():button is\n        return new htmlbutton()\n\n\n// äº§åæ¥å£ä¸­å°å£°æææå·ä½äº§åé½å¿é¡»å®ç°çæä½ã\ninterface button is\n    method render()\n    method onclick(f)\n\n// å·ä½äº§åéæä¾äº§åæ¥å£çåç§å®ç°ã\nclass windowsbutton implements button is\n    method render(a, b) is\n        // æ ¹æ® windows æ ·å¼æ¸²ææé®ã\n    method onclick(f) is\n        // ç»å®æ¬å°æä½ç³»ç»ç¹å»äºä»¶ã\n\nclass htmlbutton implements button is\n    method render(a, b) is\n        // è¿åä¸ä¸ªæé®ç html è¡¨è¿°ã\n    method onclick(f) is\n        // ç»å®ç½ç»æµè§å¨çç¹å»äºä»¶ã\n\n\nclass application is\n    field dialog: dialog\n\n    // ç¨åºæ ¹æ®å½åéç½®æç¯å¢è®¾å®éæ©åå»ºèçç±»åã\n    method initialize() is\n        config = readapplicationconfigfile()\n\n        if (config.os == "windows") then\n            dialog = new windowsdialog()\n        else if (config.os == "web") then\n            dialog = new webdialog()\n        else\n            throw new exception("éè¯¯ï¼æªç¥çæä½ç³»ç»ã")\n\n    // å½åå®¢æ·ç«¯ä»£ç ä¼ä¸å·ä½åå»ºèçå®ä¾è¿è¡äº¤äºï¼ä½æ¯å¿é¡»éè¿å¶åºæ¬æ¥å£\n    // è¿è¡ãåªè¦å®¢æ·ç«¯éè¿åºæ¬æ¥å£ä¸åå»ºèè¿è¡äº¤äºï¼ä½ å°±å¯å°ä»»ä½åå»ºèå­\n    // ç±»ä¼ éç»å®¢æ·ç«¯ã\n    method main() is\n        this.initialize()\n        dialog.render()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å·¥åæ¹æ³æ¨¡å¼å¨ java ä»£ç ä¸­å¾å°äºå¹¿æ³ä½¿ç¨ã å½ä½ éè¦å¨ä»£ç ä¸­æä¾é«å±æ¬¡ççµæ´»æ§æ¶ï¼ è¯¥æ¨¡å¼ä¼éå¸¸å®ç¨ã\n\næ ¸å¿ java ç¨åºåºä¸­æè¯¥æ¨¡å¼çåºç¨ï¼\n\n * java.util.calendar#getinstance()\n * java.util.resourcebundle#getbundle()\n * java.text.numberformat#getinstance()\n * java.nio.charset.charset#forname()\n * java.net.urlstreamhandlerfactory#createurlstreamhandler(string) ï¼æ ¹æ®åè®®è¿åä¸åçåä¾å¯¹è±¡ï¼\n * java.util.enumset#of()\n * javax.xml.bind.jaxbcontext#createmarshaller() åå¶ä»ç±»ä¼¼çæ¹æ³ã\n\nè¯å«æ¹æ³ï¼ å·¥åæ¹æ³å¯éè¿æå»ºæ¹æ³æ¥è¯å«ï¼ å®ä¼åå»ºå·ä½ç±»çå¯¹è±¡ï¼ ä½ä»¥æ½è±¡ç±»åææ¥å£çå½¢å¼è¿åè¿äºå¯¹è±¡ã\n\nè¿æ¯ä»¥ ç®åå·¥åæ¨¡å¼ éçä¾å­æ¥è¿è¡è¯´æã\n\nå¦ä½å®ç°ä¸ä¸ªå·æå åä¹é¤åºæ¬åè½çè®¡ç®å¨ï¼\n\nä¸¤ç§æ¨¡å¼ç product å concreteproduct è§è²ä»£ç æ²¡æåºå«ï¼ä¸åèµè¿°ã\n\nå·®å¼å¨äº factory è§è²é¨åï¼ä»¥åå®¢æ·ç«¯é¨åï¼è¯·å¨ä»£ç ä¸­ä½ä¼ã\n\nãcreator è§è²ã\n\n// creator è§è²ï¼å®ä¹è¿åäº§åå®ä¾çå¬å±å·¥åæ¹æ³\ninterface operationfactory {\n    public operation factorymethod();\n}\n\n\nãconcretecreator è§è²ã\n\nåç®åå·¥åæ¨¡å¼ç¸æ¯ï¼æ¯ä¸ç§äº§åé½ä¼æä¸ä¸ªå·ä½çå·¥åç±»è´è´£çäº§å®ä¾ã\n\n// concretecreator è§è²ï¼å·ä½å®ç° creator ä¸­çæ¹æ³\nclass addfactory implements operationfactory {\n    @override\n    public operation factorymethod() {\n        return new add();\n    }\n}\n\n// concretecreator è§è²ï¼å·ä½å®ç° creator ä¸­çæ¹æ³\nclass subfactory implements operationfactory {\n    @override\n    public operation factorymethod() {\n        return new sub();\n    }\n}\n\n// concretecreator è§è²ï¼å·ä½å®ç° creator ä¸­çæ¹æ³\nclass mulfactory implements operationfactory {\n    @override\n    public operation factorymethod() {\n        return new mul();\n    }\n}\n\n// concretecreator è§è²ï¼å·ä½å®ç° creator ä¸­çæ¹æ³\nclass divfactory implements operationfactory {\n    @override\n    public operation factorymethod() {\n        return new div();\n    }\n}\n\n\nãclient è§è²ã\n\nä¸ç®åå·¥åæ¨¡å¼ä¸­æ éå³æ³¨å·ä½åå»ºä¸åï¼å·¥åæ¨¡å¼ä¸­éè¦æå®å·ä½å·¥åï¼ä»¥è´è´£çäº§å·ä½å¯¹åºçäº§åã\n\n// client è§è²ï¼éè¦æå®å·ä½å·¥åï¼ä»¥è´è´£çäº§å·ä½äº§å\npublic class factorymethodpattern {\n    public static void main(string[] args) {\n        operationfactory factory = new subfactory();\n        operation oper = factory.factorymethod();\n        oper.numa = 3;\n        oper.numb = 2;\n        double result = oper.getresult();\n        system.out.println("result = " + result);\n    }\n}\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å·¥åæ¹æ³åè¿­ä»£å¨æ¨¡å¼æ¥è®©å­ç±»éåè¿åä¸åç±»åçè¿­ä»£å¨ï¼ å¹¶ä½¿å¾è¿­ä»£å¨ä¸éåç¸å¹éã\n * ååå¹¶ä¸åºäºç»§æ¿ï¼ å æ­¤æ²¡æç»§æ¿çç¼ºç¹ã å¦ä¸æ¹é¢ï¼ ååéè¦å¯¹è¢«å¤å¶å¯¹è±¡è¿è¡å¤æçåå§åã å·¥åæ¹æ³åºäºç»§æ¿ï¼ ä½æ¯å®ä¸éè¦åå§åæ­¥éª¤ã\n * å·¥åæ¹æ³æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼çä¸ç§ç¹æ®å½¢å¼ã åæ¶ï¼ å·¥åæ¹æ³å¯ä»¥ä½ä¸ºä¸ä¸ªå¤§åæ¨¡æ¿æ¹æ³ä¸­çä¸ä¸ªæ­¥éª¤ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹æ½è±¡å·¥åæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹æ½è±¡å·¥åæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T10:26:00.000Z",permalink:"/pages/d40cbb/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/03.%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/03.æ½è±¡å·¥åæ¨¡å¼.md",key:"v-3a239cb0",path:"/pages/d40cbb/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:18},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:517},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:650},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:662},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:1055},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:3369},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:5966},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:8039},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:8436}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹æ½è±¡å·¥åæ¨¡å¼\n\n\n# 1. æå¾\n\næ½è±¡å·¥åæ¨¡å¼ ï¼Abstract Factoryï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ å®è½åå»ºä¸ç³»åç¸å³çå¯¹è±¡ï¼ èæ éæå®å¶å·ä½ç±»ã\n\n**ä¼ç¹ **\n\n * æ½è±¡å·¥åæ¨¡å¼éç¦»äºå·ä½ç±»ççæï¼ç¨æ·å¹¶ä¸éè¦ç¥éä»ä¹è¢«åå»ºãç±äºè¿ç§éç¦»ï¼æ´æ¢ä¸ä¸ªå·ä½å·¥ååå¾ç¸å¯¹å®¹æãææçå·ä½å·¥åé½å®ç°äºæ½è±¡å·¥åä¸­å®ä¹çé£äºå¬å±æ¥å£ï¼å æ­¤åªéè¦æ¹åå·ä½å·¥åçå®ä¾ï¼å°±å¯ä»¥å¨æç§ç¨åº¦ä¸æ¹åæ´ä¸ªè½¯ä»¶ç³»ç»çè¡ä¸ºãå¦å¤ï¼åºç¨æ½è±¡å·¥åæ¨¡å¼å¯ä»¥å®ç°é«åèä½è¦åçè®¾è®¡ç®çï¼å æ­¤æ½è±¡å·¥åæ¨¡å¼å¾å°äºå¹¿æ³çåºç¨ã\n\n * å½ä¸ä¸ªäº§åæä¸­çå¤ä¸ªå¯¹è±¡è¢«è®¾è®¡æä¸èµ·å·¥ä½æ¶ï¼å®è½å¤ä¿è¯å®¢æ·ç«¯å§ç»åªä½¿ç¨åä¸ä¸ªäº§åæä¸­çå¯¹è±¡ãè¿å¯¹ä¸äºéè¦æ ¹æ®å½åç¯å¢æ¥å³å®å¶è¡ä¸ºçè½¯ä»¶ç³»ç»æ¥è¯´ï¼æ¯ä¸ç§éå¸¸å®ç¨çè®¾è®¡æ¨¡å¼ã\n\n * å¢å æ°çå·ä½å·¥ååäº§åæå¾æ¹ä¾¿ï¼æ é¡»ä¿®æ¹å·²æç³»ç»ï¼ç¬¦åâå¼æ¾å°é­ååâã\n\nç¼ºç¹\n\n * å¨æ·»å æ°çäº§åå¯¹è±¡æ¶ï¼é¾ä»¥æ©å±æ½è±¡å·¥åæ¥çäº§æ°ç§ç±»çäº§åï¼è¿æ¯å ä¸ºå¨æ½è±¡å·¥åè§è²ä¸­è§å®äºææå¯è½è¢«åå»ºçäº§åéåï¼è¦æ¯ææ°ç§ç±»çäº§åå°±æå³çè¦å¯¹è¯¥æ¥å£è¿è¡æ©å±ï¼èè¿å°æ¶åå°å¯¹æ½è±¡å·¥åè§è²åå¶ææå­ç±»çä¿®æ¹ï¼æ¾ç¶ä¼å¸¦æ¥è¾å¤§çä¸ä¾¿ã\n\n\n# 2. éç¨åºæ¯\n\næ½è±¡å·¥åæ¨¡å¼éç¨åºæ¯ï¼\n\nä¸ä¸ªç³»ç»è¦ç¬ç«äºå®çäº§åçåå»ºãç»ååè¡¨ç¤ºæ¶ã\n\nä¸ä¸ªç³»ç»è¦ç±å¤ä¸ªäº§åç³»åä¸­çä¸ä¸ªæ¥éç½®æ¶ã\n\nå½ä½ è¦å¼ºè°ä¸ç³»åç¸å³çäº§åå¯¹è±¡çè®¾è®¡ä»¥ä¾¿è¿è¡èåä½¿ç¨æ¶ã\n\nå½ä½ æä¾ä¸ä¸ªäº§åç±»åºï¼èåªæ³æ¾ç¤ºå®ä»¬çæ¥å£èä¸æ¯å®ç°æ¶ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡äº§å ï¼Abstract Productï¼ ä¸ºææç³»åäº§åçä¸ç»ä¸åä½ç¸å³çäº§åå£°ææ¥å£ã\n 2. å·ä½äº§å ï¼Concrete Productï¼ æ¯æ½è±¡äº§åçå¤ç§ä¸åç±»åå®ç°ã ææåä½ ï¼ç»´å¤å©äº/ç°ä»£ï¼ é½å¿é¡»å®ç°ç¸åºçæ½è±¡äº§å ï¼æ¤å­/æ²åï¼ã\n 3. æ½è±¡å·¥å ï¼Abstract Factoryï¼ æ¥å£å£°æäºä¸ç»åå»ºåç§æ½è±¡äº§åçæ¹æ³ã\n 4. å·ä½å·¥å ï¼Concrete Factoryï¼ å®ç°æ½è±¡å·¥åçæå»ºæ¹æ³ã æ¯ä¸ªå·ä½å·¥åé½å¯¹åºç¹å®äº§ååä½ï¼ ä¸ä»åå»ºæ­¤ç§äº§ååä½ã\n 5. å°½ç®¡å·ä½å·¥åä¼å¯¹å·ä½äº§åè¿è¡åå§åï¼ å¶æå»ºæ¹æ³ç­¾åå¿é¡»è¿åç¸åºçæ½è±¡äº§åã è¿æ ·ï¼ ä½¿ç¨å·¥åç±»çå®¢æ·ç«¯ä»£ç å°±ä¸ä¼ä¸å·¥ååå»ºçç¹å®äº§ååä½è¦åã å®¢æ·ç«¯ ï¼Clientï¼ åªééè¿æ½è±¡æ¥å£è°ç¨å·¥ååäº§åå¯¹è±¡ï¼ å°±è½ä¸ä»»ä½å·ä½å·¥å/äº§ååä½äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãAbstractProductã\n\nå£°æä¸ä¸ªæ¥å£ï¼è¿ä¸ªæ¥å£ä¸­åå«äº§åå¯¹è±¡ç±»åã\n\nabstract class AbstractProductA {\n    public abstract void show();\n}\n\nabstract class AbstractProductB {\n    public abstract void show();\n}\n\n\nãConcreteProductã\n\nå®ä¹ä¸ä¸ªäº§åå¯¹è±¡ï¼è¿ä¸ªäº§åå¯¹è±¡æ¯ç±ç¸å³çå·ä½å·¥ååå»ºçã\n\nclass ConcreteProductA1 extends AbstractProductA {\n    @Override\n    public void show() {\n        System.out.println("ConcreteProductA1");\n    }\n}\n\nclass ConcreteProductA2 extends AbstractProductA {\n    @Override\n    public void show() {\n        System.out.println("ConcreteProductA2");\n    }\n}\n\nclass ConcreteProductB1 extends AbstractProductB {\n    @Override\n    public void show() {\n        System.out.println("ConcreteProductB1");\n    }\n}\n\nclass ConcreteProductB2 extends AbstractProductB {\n    @Override\n    public void show() {\n        System.out.println("ConcreteProductB2");\n    }\n}\n\n\nãAbstractFactoryã\n\nå£°æä¸ä¸ªæ¥å£ï¼è¿ä¸ªæ¥å£ä¸­åå«åå»ºæ½è±¡äº§åå¯¹è±¡çæ¹æ³ã\n\nabstract class AbstractFactory {\n    public abstract AbstractProductA createProductA();\n    public abstract AbstractProductB createProductB();\n}\n\n\nãConcreteFactoryã\n\nå®ç°åå»ºå·ä½äº§åå¯¹è±¡çæ¹æ³ã\n\nclass ConcreteFactory1 extends AbstractFactory {\n    @Override\n    public AbstractProductA createProductA() {\n        return new ConcreteProductA1();\n    }\n\n    @Override\n    public AbstractProductB createProductB() {\n        return new ConcreteProductB1();\n    }\n}\n\nclass ConcreteFactory2 extends AbstractFactory {\n    @Override\n    public AbstractProductA createProductA() {\n        return new ConcreteProductA2();\n    }\n\n    @Override\n    public AbstractProductB createProductB() {\n        return new ConcreteProductB2();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\nåªä½¿ç¨ AbstractFactory å AbstractProduct å£°æçæ¥å£ã\n\npublic class AbstarctFactoryPattern {\n    public static void main(String[] args) {\n        AbstractFactory  factory1  = new ConcreteFactory1();\n        AbstractProductA productA1 = factory1.createProductA();\n        AbstractProductB productB1 = factory1.createProductB();\n        productA1.show();\n        productB1.show();\n\n        AbstractFactory  factory2  = new ConcreteFactory2();\n        AbstractProductA productA2 = factory2.createProductA();\n        AbstractProductB productB2 = factory2.createProductB();\n        productA2.show();\n        productB2.show();\n    }\n}\n\n\nãè¾åºã\n\nConcreteProductA1\nConcreteProductB1\nConcreteProductA2\nConcreteProductB2\n\n\n\n# 4. ä¼ªä»£ç \n\nä¸é¢ä¾å­éè¿åºç¨æ½è±¡å·¥åæ¨¡å¼ï¼ ä½¿å¾å®¢æ·ç«¯ä»£ç æ éä¸å·ä½ UI ç±»è¦åï¼ å°±è½åå»ºè·¨å¹³å°ç UI åç´ ï¼ åæ¶ç¡®ä¿æåå»ºçåç´ ä¸æå®çæä½ç³»ç»å¹éã\n\n\n\nè·¨å¹³å°åºç¨ä¸­çç¸å UI åç´ åè½ç±»ä¼¼ï¼ ä½æ¯å¨ä¸åæä½ç³»ç»ä¸çå¤è§æä¸å®å·®å¼ã æ­¤å¤ï¼ ä½ éè¦ç¡®ä¿ UI åç´ ä¸å½åæä½ç³»ç»é£æ ¼ä¸è´ã ä½ ä¸å®ä¸å¸æå¨ Windows ç³»ç»ä¸è¿è¡çåºç¨ç¨åºä¸­æ¾ç¤º macOS çæ§ä»¶ã\n\næ½è±¡å·¥åæ¥å£å£°æä¸ç³»åæå»ºæ¹æ³ï¼ å®¢æ·ç«¯ä»£ç å¯è°ç¨å®ä»¬çæä¸åé£æ ¼ç UI åç´ ã æ¯ä¸ªå·ä½å·¥åå¯¹åºç¹å®æä½ç³»ç»ï¼ å¹¶è´è´£çæç¬¦åè¯¥æä½ç³»ç»é£æ ¼ç UI åç´ ã\n\nå¶è¿ä½æ¹å¼å¦ä¸ï¼ åºç¨ç¨åºå¯å¨åæ£æµå½åæä½ç³»ç»ã æ ¹æ®è¯¥ä¿¡æ¯ï¼ åºç¨ç¨åºéè¿ä¸è¯¥æä½ç³»ç»å¯¹åºçç±»åå»ºå·¥åå¯¹è±¡ã å¶ä½ä»£ç ä½¿ç¨è¯¥å·¥åå¯¹è±¡åå»º UI åç´ ã è¿æ ·å¯ä»¥é¿åçæéè¯¯ç±»åçåç´ ã\n\nä½¿ç¨è¿ç§æ¹æ³ï¼ å®¢æ·ç«¯ä»£ç åªéè°ç¨æ½è±¡æ¥å£ï¼ èæ éäºè§£å·ä½å·¥åç±»å UI åç´ ã æ­¤å¤ï¼ å®¢æ·ç«¯ä»£ç è¿æ¯ææªæ¥æ·»å æ°çå·¥åæ UI åç´ ã\n\nè¿æ ·ä¸æ¥ï¼ æ¯æ¬¡å¨åºç¨ç¨åºä¸­æ·»å æ°ç UI åç´ åä½æ¶ï¼ ä½ é½æ éä¿®æ¹å®¢æ·ç«¯ä»£ç ã ä½ åªéåå»ºä¸ä¸ªè½å¤çæè¿äº UI åç´ çå·¥åç±»ï¼ ç¶åç¨å¾®ä¿®æ¹åºç¨ç¨åºçåå§ä»£ç ï¼ ä½¿å¶è½å¤éæ©åéçå·¥åç±»å³å¯ã\n\n// æ½è±¡å·¥åæ¥å£å£°æäºä¸ç»è½è¿åä¸åæ½è±¡äº§åçæ¹æ³ãè¿äºäº§åå±äºåä¸ä¸ªç³»å\n// ä¸å¨é«å±ä¸»é¢ææ¦å¿µä¸å·æç¸å³æ§ãåç³»åçäº§åéå¸¸è½ç¸äºæ­éä½¿ç¨ãç³»åäº§\n// åå¯æå¤ä¸ªåä½ï¼ä½ä¸ååä½çäº§åä¸è½æ­éä½¿ç¨ã\ninterface GUIFactory is\n    method createButton():Button\n    method createCheckbox():Checkbox\n\n\n// å·ä½å·¥åå¯çæå±äºåä¸åä½çç³»åäº§åãå·¥åä¼ç¡®ä¿å¶åå»ºçäº§åè½ç¸äºæ­é\n// ä½¿ç¨ãå·ä½å·¥åæ¹æ³ç­¾åä¼è¿åä¸ä¸ªæ½è±¡äº§åï¼ä½å¨æ¹æ³åé¨åä¼å¯¹å·ä½äº§åè¿\n// è¡å®ä¾åã\nclass WinFactory implements GUIFactory is\n    method createButton():Button is\n        return new WinButton()\n    method createCheckbox():Checkbox is\n        return new WinCheckbox()\n\n// æ¯ä¸ªå·ä½å·¥åä¸­é½ä¼åå«ä¸ä¸ªç¸åºçäº§ååä½ã\nclass MacFactory implements GUIFactory is\n    method createButton():Button is\n        return new MacButton()\n    method createCheckbox():Checkbox is\n        return new MacCheckbox()\n\n\n// ç³»åäº§åä¸­çç¹å®äº§åå¿é¡»æä¸ä¸ªåºç¡æ¥å£ãææäº§ååä½é½å¿é¡»å®ç°è¿ä¸ªæ¥å£ã\ninterface Button is\n    method paint()\n\n// å·ä½äº§åç±ç¸åºçå·ä½å·¥ååå»ºã\nclass WinButton implements Button is\n    method paint() is\n        // æ ¹æ® Windows æ ·å¼æ¸²ææé®ã\n\nclass MacButton implements Button is\n    method paint() is\n        // æ ¹æ® macOS æ ·å¼æ¸²ææé®\n\n// è¿æ¯å¦ä¸ä¸ªäº§åçåºç¡æ¥å£ãææäº§åé½å¯ä»¥äºå¨ï¼ä½æ¯åªæç¸åå·ä½åä½çäº§\n// åä¹é´æè½å¤æ­£ç¡®å°è¿è¡äº¤äºã\ninterface Checkbox is\n    method paint()\n\nclass WinCheckbox implements Checkbox is\n    method paint() is\n        // æ ¹æ® Windows æ ·å¼æ¸²æå¤éæ¡ã\n\nclass MacCheckbox implements Checkbox is\n    method paint() is\n        // æ ¹æ® macOS æ ·å¼æ¸²æå¤éæ¡ã\n\n// å®¢æ·ç«¯ä»£ç ä»éè¿æ½è±¡ç±»åï¼GUIFactoryãButton å Checkboxï¼ä½¿ç¨å·¥å\n// åäº§åãè¿è®©ä½ æ éä¿®æ¹ä»»ä½å·¥åæäº§åå­ç±»å°±è½å°å¶ä¼ éç»å®¢æ·ç«¯ä»£ç ã\nclass Application is\n    private field factory: GUIFactory\n    private field button: Button\n    constructor Application(factory: GUIFactory) is\n        this.factory = factory\n    method createUI() is\n        this.button = factory.createButton()\n    method paint() is\n        button.paint()\n\n\n// ç¨åºä¼æ ¹æ®å½åéç½®æç¯å¢è®¾å®éæ©å·¥åç±»åï¼å¹¶å¨è¿è¡æ¶åå»ºå·¥åï¼éå¸¸å¨å\n// å§åé¶æ®µï¼ã\nclass ApplicationConfigurator is\n    method main() is\n        config = readApplicationConfigFile()\n\n        if (config.OS == "Windows") then\n            factory = new WinFactory()\n        else if (config.OS == "Mac") then\n            factory = new MacFactory()\n        else\n            throw new Exception("éè¯¯ï¼æªç¥çæä½ç³»ç»ã")\n\n        Application app = new Application(factory)\n\n\n\n# 5. æ¡ä¾\n\nä¼æå¨ç¥ï¼è¹æåä¸æè¿ä¸¤å®¶ä¸ççº§ççµå­äº§åååé½çäº§ææºåçµèã\n\næä»¬ä»¥çäº§ææºåçµèä¸ºä¾ï¼æ¼ç¤ºä¸ä¸æ½è±¡å·¥åæ¨¡å¼çåºç¨\n\nãAbstractProduct è§è²ã\n\né¦åï¼å®ä¹ææºåçµèä¸¤ä¸ªæ½è±¡æ¥å£ï¼ä»ä»¬é½æåèªçäº§åä¿¡æ¯ã\n\ninterface Telephone {\n    public String getProductInfo();\n}\n\ninterface Computer {\n    public String getProductInfo();\n}\n\n\nãConcreteProduct è§è²ã\n\nConcreteProduct æ ¹æ® AbstractProduct æ¥å®ä¹å·ä½çäº§åå±æ§ãæ¹æ³ã\n\nå¨æä»¬çä¾å­ä¸­ï¼è¹æãä¸æä¸¤å®¶å¬å¸çææºåçµèé½æåèªçå·ä½äº§åä¿¡æ¯ã\n\nclass AppleTelephone implements Telephone {\n\n    @Override\n    public String getProductInfo() {\n        return "è¹æææºï¼éç¨iosç³»ç»";\n    }\n}\n\nclass SamsungTelephone implements Telephone {\n\n    @Override\n    public String getProductInfo() {\n        return "ä¸æææºï¼éç¨androidç³»ç»";\n    }\n}\n\nclass AppleComputer implements Computer {\n\n    @Override\n    public String getProductInfo() {\n        return "è¹æçµèï¼éç¨macç³»ç»";\n    }\n}\n\nclass SamsungComputer implements Computer {\n\n    @Override\n    public String getProductInfo() {\n        return "ä¸æçµèï¼éç¨windowsç³»ç»";\n    }\n}\n\n\nãAbstractFactory è§è²ã\n\nè¹æï¼ä¸æè¿ä¸¤ä¸ªååé½çäº§ææºåçµèãæä»¥å®ä»¬å¯ä»¥æä¸ä¸ªæ½è±¡ç¶ç±»æç¶æ¥å£ï¼æä¾çäº§ææºåçäº§çµèçæ¹æ³ã\n\ninterface ElectronicFactory {\n\n    public Telephone produceTelephone();\n\n    public Computer produceComputer();\n}\n\n\nãConcreteFactory è§è²ã\n\nè¹æãä¸æå·¥ååå«å®ç°ç¶æ¥å£ï¼çäº§ä¸åç±»åçäº§åã\n\nclass AppleFactory implements ElectronicFactory {\n\n    @Override\n    public Telephone produceTelephone() {\n        return new AppleTelephone();\n    }\n\n    @Override\n    public Computer produceComputer() {\n        return new AppleComputer();\n    }\n}\n\nclass SamsungFactory implements ElectronicFactory {\n\n    @Override\n    public Telephone produceTelephone() {\n        return new SamsungTelephone();\n    }\n\n    @Override\n    public Computer produceComputer() {\n        return new SamsungComputer();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class PhoneFactoryDemo {\n    public static void main(String[] args) {\n        ElectronicFactory appleFactory = new AppleFactory();\n        Telephone phone = appleFactory.produceTelephone();\n        System.out.println(phone.getProductInfo());\n        Computer computer = appleFactory.produceComputer();\n        System.out.println(computer.getProductInfo());\n    }\n}\n\n\nãè¾åºã\n\nè¹æææºï¼éç¨iosç³»ç»\nè¹æçµèï¼éç¨macç³»ç»\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * çæå¨éç¹å³æ³¨å¦ä½åæ­¥çæå¤æå¯¹è±¡ã æ½è±¡å·¥åä¸é¨ç¨äºçäº§ä¸ç³»åç¸å³å¯¹è±¡ã æ½è±¡å·¥åä¼é©¬ä¸è¿åäº§åï¼ çæå¨ååè®¸ä½ å¨è·åäº§ååæ§è¡ä¸äºé¢å¤æé æ­¥éª¤ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * å½åªéå¯¹å®¢æ·ç«¯ä»£ç éèå­ç³»ç»åå»ºå¯¹è±¡çæ¹å¼æ¶ï¼ ä½ å¯ä»¥ä½¿ç¨æ½è±¡å·¥åæ¥ä»£æ¿å¤è§æ¨¡å¼ã\n * ä½ å¯ä»¥å°æ½è±¡å·¥ååæ¡¥æ¥æ¨¡å¼æ­éä½¿ç¨ã å¦æç±æ¡¥æ¥å®ä¹çæ½è±¡åªè½ä¸ç¹å®å®ç°åä½ï¼ è¿ä¸æ¨¡å¼æ­éå°±éå¸¸æç¨ã å¨è¿ç§æåµä¸ï¼ æ½è±¡å·¥åå¯ä»¥å¯¹è¿äºå³ç³»è¿è¡å°è£ï¼ å¹¶ä¸å¯¹å®¢æ·ç«¯ä»£ç éèå¶å¤ææ§ã\n * æ½è±¡å·¥åã çæå¨åååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹æ½è±¡å·¥åæ¨¡å¼\n\n\n# 1. æå¾\n\næ½è±¡å·¥åæ¨¡å¼ ï¼abstract factoryï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ å®è½åå»ºä¸ç³»åç¸å³çå¯¹è±¡ï¼ èæ éæå®å¶å·ä½ç±»ã\n\n**ä¼ç¹ **\n\n * æ½è±¡å·¥åæ¨¡å¼éç¦»äºå·ä½ç±»ççæï¼ç¨æ·å¹¶ä¸éè¦ç¥éä»ä¹è¢«åå»ºãç±äºè¿ç§éç¦»ï¼æ´æ¢ä¸ä¸ªå·ä½å·¥ååå¾ç¸å¯¹å®¹æãææçå·ä½å·¥åé½å®ç°äºæ½è±¡å·¥åä¸­å®ä¹çé£äºå¬å±æ¥å£ï¼å æ­¤åªéè¦æ¹åå·ä½å·¥åçå®ä¾ï¼å°±å¯ä»¥å¨æç§ç¨åº¦ä¸æ¹åæ´ä¸ªè½¯ä»¶ç³»ç»çè¡ä¸ºãå¦å¤ï¼åºç¨æ½è±¡å·¥åæ¨¡å¼å¯ä»¥å®ç°é«åèä½è¦åçè®¾è®¡ç®çï¼å æ­¤æ½è±¡å·¥åæ¨¡å¼å¾å°äºå¹¿æ³çåºç¨ã\n\n * å½ä¸ä¸ªäº§åæä¸­çå¤ä¸ªå¯¹è±¡è¢«è®¾è®¡æä¸èµ·å·¥ä½æ¶ï¼å®è½å¤ä¿è¯å®¢æ·ç«¯å§ç»åªä½¿ç¨åä¸ä¸ªäº§åæä¸­çå¯¹è±¡ãè¿å¯¹ä¸äºéè¦æ ¹æ®å½åç¯å¢æ¥å³å®å¶è¡ä¸ºçè½¯ä»¶ç³»ç»æ¥è¯´ï¼æ¯ä¸ç§éå¸¸å®ç¨çè®¾è®¡æ¨¡å¼ã\n\n * å¢å æ°çå·ä½å·¥ååäº§åæå¾æ¹ä¾¿ï¼æ é¡»ä¿®æ¹å·²æç³»ç»ï¼ç¬¦åâå¼æ¾å°é­ååâã\n\nç¼ºç¹\n\n * å¨æ·»å æ°çäº§åå¯¹è±¡æ¶ï¼é¾ä»¥æ©å±æ½è±¡å·¥åæ¥çäº§æ°ç§ç±»çäº§åï¼è¿æ¯å ä¸ºå¨æ½è±¡å·¥åè§è²ä¸­è§å®äºææå¯è½è¢«åå»ºçäº§åéåï¼è¦æ¯ææ°ç§ç±»çäº§åå°±æå³çè¦å¯¹è¯¥æ¥å£è¿è¡æ©å±ï¼èè¿å°æ¶åå°å¯¹æ½è±¡å·¥åè§è²åå¶ææå­ç±»çä¿®æ¹ï¼æ¾ç¶ä¼å¸¦æ¥è¾å¤§çä¸ä¾¿ã\n\n\n# 2. éç¨åºæ¯\n\næ½è±¡å·¥åæ¨¡å¼éç¨åºæ¯ï¼\n\nä¸ä¸ªç³»ç»è¦ç¬ç«äºå®çäº§åçåå»ºãç»ååè¡¨ç¤ºæ¶ã\n\nä¸ä¸ªç³»ç»è¦ç±å¤ä¸ªäº§åç³»åä¸­çä¸ä¸ªæ¥éç½®æ¶ã\n\nå½ä½ è¦å¼ºè°ä¸ç³»åç¸å³çäº§åå¯¹è±¡çè®¾è®¡ä»¥ä¾¿è¿è¡èåä½¿ç¨æ¶ã\n\nå½ä½ æä¾ä¸ä¸ªäº§åç±»åºï¼èåªæ³æ¾ç¤ºå®ä»¬çæ¥å£èä¸æ¯å®ç°æ¶ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡äº§å ï¼abstract productï¼ ä¸ºææç³»åäº§åçä¸ç»ä¸åä½ç¸å³çäº§åå£°ææ¥å£ã\n 2. å·ä½äº§å ï¼concrete productï¼ æ¯æ½è±¡äº§åçå¤ç§ä¸åç±»åå®ç°ã ææåä½ ï¼ç»´å¤å©äº/ç°ä»£ï¼ é½å¿é¡»å®ç°ç¸åºçæ½è±¡äº§å ï¼æ¤å­/æ²åï¼ã\n 3. æ½è±¡å·¥å ï¼abstract factoryï¼ æ¥å£å£°æäºä¸ç»åå»ºåç§æ½è±¡äº§åçæ¹æ³ã\n 4. å·ä½å·¥å ï¼concrete factoryï¼ å®ç°æ½è±¡å·¥åçæå»ºæ¹æ³ã æ¯ä¸ªå·ä½å·¥åé½å¯¹åºç¹å®äº§ååä½ï¼ ä¸ä»åå»ºæ­¤ç§äº§ååä½ã\n 5. å°½ç®¡å·ä½å·¥åä¼å¯¹å·ä½äº§åè¿è¡åå§åï¼ å¶æå»ºæ¹æ³ç­¾åå¿é¡»è¿åç¸åºçæ½è±¡äº§åã è¿æ ·ï¼ ä½¿ç¨å·¥åç±»çå®¢æ·ç«¯ä»£ç å°±ä¸ä¼ä¸å·¥ååå»ºçç¹å®äº§ååä½è¦åã å®¢æ·ç«¯ ï¼clientï¼ åªééè¿æ½è±¡æ¥å£è°ç¨å·¥ååäº§åå¯¹è±¡ï¼ å°±è½ä¸ä»»ä½å·ä½å·¥å/äº§ååä½äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãabstractproductã\n\nå£°æä¸ä¸ªæ¥å£ï¼è¿ä¸ªæ¥å£ä¸­åå«äº§åå¯¹è±¡ç±»åã\n\nabstract class abstractproducta {\n    public abstract void show();\n}\n\nabstract class abstractproductb {\n    public abstract void show();\n}\n\n\nãconcreteproductã\n\nå®ä¹ä¸ä¸ªäº§åå¯¹è±¡ï¼è¿ä¸ªäº§åå¯¹è±¡æ¯ç±ç¸å³çå·ä½å·¥ååå»ºçã\n\nclass concreteproducta1 extends abstractproducta {\n    @override\n    public void show() {\n        system.out.println("concreteproducta1");\n    }\n}\n\nclass concreteproducta2 extends abstractproducta {\n    @override\n    public void show() {\n        system.out.println("concreteproducta2");\n    }\n}\n\nclass concreteproductb1 extends abstractproductb {\n    @override\n    public void show() {\n        system.out.println("concreteproductb1");\n    }\n}\n\nclass concreteproductb2 extends abstractproductb {\n    @override\n    public void show() {\n        system.out.println("concreteproductb2");\n    }\n}\n\n\nãabstractfactoryã\n\nå£°æä¸ä¸ªæ¥å£ï¼è¿ä¸ªæ¥å£ä¸­åå«åå»ºæ½è±¡äº§åå¯¹è±¡çæ¹æ³ã\n\nabstract class abstractfactory {\n    public abstract abstractproducta createproducta();\n    public abstract abstractproductb createproductb();\n}\n\n\nãconcretefactoryã\n\nå®ç°åå»ºå·ä½äº§åå¯¹è±¡çæ¹æ³ã\n\nclass concretefactory1 extends abstractfactory {\n    @override\n    public abstractproducta createproducta() {\n        return new concreteproducta1();\n    }\n\n    @override\n    public abstractproductb createproductb() {\n        return new concreteproductb1();\n    }\n}\n\nclass concretefactory2 extends abstractfactory {\n    @override\n    public abstractproducta createproducta() {\n        return new concreteproducta2();\n    }\n\n    @override\n    public abstractproductb createproductb() {\n        return new concreteproductb2();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\nåªä½¿ç¨ abstractfactory å abstractproduct å£°æçæ¥å£ã\n\npublic class abstarctfactorypattern {\n    public static void main(string[] args) {\n        abstractfactory  factory1  = new concretefactory1();\n        abstractproducta producta1 = factory1.createproducta();\n        abstractproductb productb1 = factory1.createproductb();\n        producta1.show();\n        productb1.show();\n\n        abstractfactory  factory2  = new concretefactory2();\n        abstractproducta producta2 = factory2.createproducta();\n        abstractproductb productb2 = factory2.createproductb();\n        producta2.show();\n        productb2.show();\n    }\n}\n\n\nãè¾åºã\n\nconcreteproducta1\nconcreteproductb1\nconcreteproducta2\nconcreteproductb2\n\n\n\n# 4. ä¼ªä»£ç \n\nä¸é¢ä¾å­éè¿åºç¨æ½è±¡å·¥åæ¨¡å¼ï¼ ä½¿å¾å®¢æ·ç«¯ä»£ç æ éä¸å·ä½ ui ç±»è¦åï¼ å°±è½åå»ºè·¨å¹³å°ç ui åç´ ï¼ åæ¶ç¡®ä¿æåå»ºçåç´ ä¸æå®çæä½ç³»ç»å¹éã\n\n\n\nè·¨å¹³å°åºç¨ä¸­çç¸å ui åç´ åè½ç±»ä¼¼ï¼ ä½æ¯å¨ä¸åæä½ç³»ç»ä¸çå¤è§æä¸å®å·®å¼ã æ­¤å¤ï¼ ä½ éè¦ç¡®ä¿ ui åç´ ä¸å½åæä½ç³»ç»é£æ ¼ä¸è´ã ä½ ä¸å®ä¸å¸æå¨ windows ç³»ç»ä¸è¿è¡çåºç¨ç¨åºä¸­æ¾ç¤º macos çæ§ä»¶ã\n\næ½è±¡å·¥åæ¥å£å£°æä¸ç³»åæå»ºæ¹æ³ï¼ å®¢æ·ç«¯ä»£ç å¯è°ç¨å®ä»¬çæä¸åé£æ ¼ç ui åç´ ã æ¯ä¸ªå·ä½å·¥åå¯¹åºç¹å®æä½ç³»ç»ï¼ å¹¶è´è´£çæç¬¦åè¯¥æä½ç³»ç»é£æ ¼ç ui åç´ ã\n\nå¶è¿ä½æ¹å¼å¦ä¸ï¼ åºç¨ç¨åºå¯å¨åæ£æµå½åæä½ç³»ç»ã æ ¹æ®è¯¥ä¿¡æ¯ï¼ åºç¨ç¨åºéè¿ä¸è¯¥æä½ç³»ç»å¯¹åºçç±»åå»ºå·¥åå¯¹è±¡ã å¶ä½ä»£ç ä½¿ç¨è¯¥å·¥åå¯¹è±¡åå»º ui åç´ ã è¿æ ·å¯ä»¥é¿åçæéè¯¯ç±»åçåç´ ã\n\nä½¿ç¨è¿ç§æ¹æ³ï¼ å®¢æ·ç«¯ä»£ç åªéè°ç¨æ½è±¡æ¥å£ï¼ èæ éäºè§£å·ä½å·¥åç±»å ui åç´ ã æ­¤å¤ï¼ å®¢æ·ç«¯ä»£ç è¿æ¯ææªæ¥æ·»å æ°çå·¥åæ ui åç´ ã\n\nè¿æ ·ä¸æ¥ï¼ æ¯æ¬¡å¨åºç¨ç¨åºä¸­æ·»å æ°ç ui åç´ åä½æ¶ï¼ ä½ é½æ éä¿®æ¹å®¢æ·ç«¯ä»£ç ã ä½ åªéåå»ºä¸ä¸ªè½å¤çæè¿äº ui åç´ çå·¥åç±»ï¼ ç¶åç¨å¾®ä¿®æ¹åºç¨ç¨åºçåå§ä»£ç ï¼ ä½¿å¶è½å¤éæ©åéçå·¥åç±»å³å¯ã\n\n// æ½è±¡å·¥åæ¥å£å£°æäºä¸ç»è½è¿åä¸åæ½è±¡äº§åçæ¹æ³ãè¿äºäº§åå±äºåä¸ä¸ªç³»å\n// ä¸å¨é«å±ä¸»é¢ææ¦å¿µä¸å·æç¸å³æ§ãåç³»åçäº§åéå¸¸è½ç¸äºæ­éä½¿ç¨ãç³»åäº§\n// åå¯æå¤ä¸ªåä½ï¼ä½ä¸ååä½çäº§åä¸è½æ­éä½¿ç¨ã\ninterface guifactory is\n    method createbutton():button\n    method createcheckbox():checkbox\n\n\n// å·ä½å·¥åå¯çæå±äºåä¸åä½çç³»åäº§åãå·¥åä¼ç¡®ä¿å¶åå»ºçäº§åè½ç¸äºæ­é\n// ä½¿ç¨ãå·ä½å·¥åæ¹æ³ç­¾åä¼è¿åä¸ä¸ªæ½è±¡äº§åï¼ä½å¨æ¹æ³åé¨åä¼å¯¹å·ä½äº§åè¿\n// è¡å®ä¾åã\nclass winfactory implements guifactory is\n    method createbutton():button is\n        return new winbutton()\n    method createcheckbox():checkbox is\n        return new wincheckbox()\n\n// æ¯ä¸ªå·ä½å·¥åä¸­é½ä¼åå«ä¸ä¸ªç¸åºçäº§ååä½ã\nclass macfactory implements guifactory is\n    method createbutton():button is\n        return new macbutton()\n    method createcheckbox():checkbox is\n        return new maccheckbox()\n\n\n// ç³»åäº§åä¸­çç¹å®äº§åå¿é¡»æä¸ä¸ªåºç¡æ¥å£ãææäº§ååä½é½å¿é¡»å®ç°è¿ä¸ªæ¥å£ã\ninterface button is\n    method paint()\n\n// å·ä½äº§åç±ç¸åºçå·ä½å·¥ååå»ºã\nclass winbutton implements button is\n    method paint() is\n        // æ ¹æ® windows æ ·å¼æ¸²ææé®ã\n\nclass macbutton implements button is\n    method paint() is\n        // æ ¹æ® macos æ ·å¼æ¸²ææé®\n\n// è¿æ¯å¦ä¸ä¸ªäº§åçåºç¡æ¥å£ãææäº§åé½å¯ä»¥äºå¨ï¼ä½æ¯åªæç¸åå·ä½åä½çäº§\n// åä¹é´æè½å¤æ­£ç¡®å°è¿è¡äº¤äºã\ninterface checkbox is\n    method paint()\n\nclass wincheckbox implements checkbox is\n    method paint() is\n        // æ ¹æ® windows æ ·å¼æ¸²æå¤éæ¡ã\n\nclass maccheckbox implements checkbox is\n    method paint() is\n        // æ ¹æ® macos æ ·å¼æ¸²æå¤éæ¡ã\n\n// å®¢æ·ç«¯ä»£ç ä»éè¿æ½è±¡ç±»åï¼guifactoryãbutton å checkboxï¼ä½¿ç¨å·¥å\n// åäº§åãè¿è®©ä½ æ éä¿®æ¹ä»»ä½å·¥åæäº§åå­ç±»å°±è½å°å¶ä¼ éç»å®¢æ·ç«¯ä»£ç ã\nclass application is\n    private field factory: guifactory\n    private field button: button\n    constructor application(factory: guifactory) is\n        this.factory = factory\n    method createui() is\n        this.button = factory.createbutton()\n    method paint() is\n        button.paint()\n\n\n// ç¨åºä¼æ ¹æ®å½åéç½®æç¯å¢è®¾å®éæ©å·¥åç±»åï¼å¹¶å¨è¿è¡æ¶åå»ºå·¥åï¼éå¸¸å¨å\n// å§åé¶æ®µï¼ã\nclass applicationconfigurator is\n    method main() is\n        config = readapplicationconfigfile()\n\n        if (config.os == "windows") then\n            factory = new winfactory()\n        else if (config.os == "mac") then\n            factory = new macfactory()\n        else\n            throw new exception("éè¯¯ï¼æªç¥çæä½ç³»ç»ã")\n\n        application app = new application(factory)\n\n\n\n# 5. æ¡ä¾\n\nä¼æå¨ç¥ï¼è¹æåä¸æè¿ä¸¤å®¶ä¸ççº§ççµå­äº§åååé½çäº§ææºåçµèã\n\næä»¬ä»¥çäº§ææºåçµèä¸ºä¾ï¼æ¼ç¤ºä¸ä¸æ½è±¡å·¥åæ¨¡å¼çåºç¨\n\nãabstractproduct è§è²ã\n\né¦åï¼å®ä¹ææºåçµèä¸¤ä¸ªæ½è±¡æ¥å£ï¼ä»ä»¬é½æåèªçäº§åä¿¡æ¯ã\n\ninterface telephone {\n    public string getproductinfo();\n}\n\ninterface computer {\n    public string getproductinfo();\n}\n\n\nãconcreteproduct è§è²ã\n\nconcreteproduct æ ¹æ® abstractproduct æ¥å®ä¹å·ä½çäº§åå±æ§ãæ¹æ³ã\n\nå¨æä»¬çä¾å­ä¸­ï¼è¹æãä¸æä¸¤å®¶å¬å¸çææºåçµèé½æåèªçå·ä½äº§åä¿¡æ¯ã\n\nclass appletelephone implements telephone {\n\n    @override\n    public string getproductinfo() {\n        return "è¹æææºï¼éç¨iosç³»ç»";\n    }\n}\n\nclass samsungtelephone implements telephone {\n\n    @override\n    public string getproductinfo() {\n        return "ä¸æææºï¼éç¨androidç³»ç»";\n    }\n}\n\nclass applecomputer implements computer {\n\n    @override\n    public string getproductinfo() {\n        return "è¹æçµèï¼éç¨macç³»ç»";\n    }\n}\n\nclass samsungcomputer implements computer {\n\n    @override\n    public string getproductinfo() {\n        return "ä¸æçµèï¼éç¨windowsç³»ç»";\n    }\n}\n\n\nãabstractfactory è§è²ã\n\nè¹æï¼ä¸æè¿ä¸¤ä¸ªååé½çäº§ææºåçµèãæä»¥å®ä»¬å¯ä»¥æä¸ä¸ªæ½è±¡ç¶ç±»æç¶æ¥å£ï¼æä¾çäº§ææºåçäº§çµèçæ¹æ³ã\n\ninterface electronicfactory {\n\n    public telephone producetelephone();\n\n    public computer producecomputer();\n}\n\n\nãconcretefactory è§è²ã\n\nè¹æãä¸æå·¥ååå«å®ç°ç¶æ¥å£ï¼çäº§ä¸åç±»åçäº§åã\n\nclass applefactory implements electronicfactory {\n\n    @override\n    public telephone producetelephone() {\n        return new appletelephone();\n    }\n\n    @override\n    public computer producecomputer() {\n        return new applecomputer();\n    }\n}\n\nclass samsungfactory implements electronicfactory {\n\n    @override\n    public telephone producetelephone() {\n        return new samsungtelephone();\n    }\n\n    @override\n    public computer producecomputer() {\n        return new samsungcomputer();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class phonefactorydemo {\n    public static void main(string[] args) {\n        electronicfactory applefactory = new applefactory();\n        telephone phone = applefactory.producetelephone();\n        system.out.println(phone.getproductinfo());\n        computer computer = applefactory.producecomputer();\n        system.out.println(computer.getproductinfo());\n    }\n}\n\n\nãè¾åºã\n\nè¹æææºï¼éç¨iosç³»ç»\nè¹æçµèï¼éç¨macç³»ç»\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * çæå¨éç¹å³æ³¨å¦ä½åæ­¥çæå¤æå¯¹è±¡ã æ½è±¡å·¥åä¸é¨ç¨äºçäº§ä¸ç³»åç¸å³å¯¹è±¡ã æ½è±¡å·¥åä¼é©¬ä¸è¿åäº§åï¼ çæå¨ååè®¸ä½ å¨è·åäº§ååæ§è¡ä¸äºé¢å¤æé æ­¥éª¤ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * å½åªéå¯¹å®¢æ·ç«¯ä»£ç éèå­ç³»ç»åå»ºå¯¹è±¡çæ¹å¼æ¶ï¼ ä½ å¯ä»¥ä½¿ç¨æ½è±¡å·¥åæ¥ä»£æ¿å¤è§æ¨¡å¼ã\n * ä½ å¯ä»¥å°æ½è±¡å·¥ååæ¡¥æ¥æ¨¡å¼æ­éä½¿ç¨ã å¦æç±æ¡¥æ¥å®ä¹çæ½è±¡åªè½ä¸ç¹å®å®ç°åä½ï¼ è¿ä¸æ¨¡å¼æ­éå°±éå¸¸æç¨ã å¨è¿ç§æåµä¸ï¼ æ½è±¡å·¥åå¯ä»¥å¯¹è¿äºå³ç³»è¿è¡å°è£ï¼ å¹¶ä¸å¯¹å®¢æ·ç«¯ä»£ç éèå¶å¤ææ§ã\n * æ½è±¡å·¥åã çæå¨åååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹å»ºé èæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹å»ºé èæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T10:32:00.000Z",permalink:"/pages/cb480c/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/04.%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/04.å»ºé èæ¨¡å¼.md",key:"v-1bdc9712",path:"/pages/cb480c/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:369},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:490},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2496},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:5481},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5927},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6230}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹å»ºé èæ¨¡å¼\n\n\n# 1. æå¾\n\nå»ºé èæ¨¡å¼ï¼Builderï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ ä½¿ä½ è½å¤åæ­¥éª¤åå»ºå¤æå¯¹è±¡ã è¯¥æ¨¡å¼åè®¸ä½ ä½¿ç¨ç¸åçåå»ºä»£ç çæä¸åç±»ååå½¢å¼çå¯¹è±¡ã\n\nä½¿ç¨å»ºé èæ¨¡å¼ï¼ç¨æ·å°±åªéè¦æå®éè¦å»ºé çç±»åï¼å·ä½çå»ºé è¿ç¨åç»èå¹¶ä¸éè¦ç¥éã\n\nå»ºé èæ¨¡å¼åè®¸ä¿®æ¹ä¸ä¸ªäº§åçåé¨è¡¨ç¤ºã\n\nå®å°æé åè¡¨ç¤ºä¸¤åä»£ç éç¦»å¼æ¥ã\n\nå®å¾å¥½çæ§å¶äºæå»ºè¿ç¨ã\n\n\n\nå»ºé èæ¨¡å¼æµç¨è¯´æï¼\n\n 1. å®¢æ·ç«¯åå»º Director å¯¹è±¡å¹¶éç½®å®æéè¦ç Builder å¯¹è±¡ã\n 2. Director è´è´£éç¥ builder ä½æ¶å»ºé  product çé¨ä»¶ã\n 3. Builder å¤ç director çè¯·æ±å¹¶æ·»å  product çé¨ä»¶ã\n 4. å®¢æ·ç«¯ä» builder å¤è·å¾ productã\n\n\n# 2. éç¨åºæ¯\n\n * ä½¿ç¨å»ºé èæ¨¡å¼å¯é¿å âéå æé å½æ° ï¼telescopic constructorï¼â çåºç°ã\n * å½ä½ å¸æä½¿ç¨ä»£ç åå»ºä¸åå½¢å¼çäº§åæ¶ï¼ å¯ä½¿ç¨å»ºé èæ¨¡å¼ã\n * ä½¿ç¨å»ºé èæé ç»åæ æå¶ä»å¤æå¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n 1. å»ºé è ï¼Builderï¼ æ¥å£å£°æå¨ææç±»åå»ºé èä¸­éç¨çäº§åæé æ­¥éª¤ã\n 2. å·ä½å»ºé è ï¼Concrete Buildersï¼ æä¾æé è¿ç¨çä¸åå®ç°ã å·ä½å»ºé èä¹å¯ä»¥æé ä¸éµå¾ªéç¨æ¥å£çäº§åã\n 3. äº§å ï¼Productsï¼ æ¯æç»çæçå¯¹è±¡ã ç±ä¸åå»ºé èæé çäº§åæ éå±äºåä¸ç±»å±æ¬¡ç»æææ¥å£ã\n 4. ä¸»ç®¡ ï¼Directorï¼ ç±»å®ä¹è°ç¨æé æ­¥éª¤çé¡ºåºï¼ è¿æ ·ä½ å°±å¯ä»¥åå»ºåå¤ç¨ç¹å®çäº§åéç½®ã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ å¿é¡»å°æä¸ªå»ºé èå¯¹è±¡ä¸ä¸»ç®¡ç±»å³èã ä¸è¬æåµä¸ï¼ ä½ åªééè¿ä¸»ç®¡ç±»æé å½æ°çåæ°è¿è¡ä¸æ¬¡æ§å³èå³å¯ã æ­¤åä¸»ç®¡ç±»å°±è½ä½¿ç¨å»ºé èå¯¹è±¡å®æåç»­ææçæé ä»»å¡ã ä½å¨å®¢æ·ç«¯å°å»ºé èå¯¹è±¡ä¼ éç»ä¸»ç®¡ç±»å¶é æ¹æ³æ¶è¿æå¦ä¸ç§æ¹å¼ã å¨è¿ç§æåµä¸ï¼ ä½ å¨ä½¿ç¨ä¸»ç®¡ç±»çäº§äº§åæ¶æ¯æ¬¡é½å¯ä»¥ä½¿ç¨ä¸åçå»ºé èã\n\nãProductãäº§åç±»ï¼ç±å¤ä¸ªé¨ä»¶ææã\n\nclass Product {\n    List<String> parts = new ArrayList<String>();\n\n    public void AddPart(String part) {\n        parts.add(part);\n    }\n\n    public void show() {\n        System.out.println("============== äº§ååå»º ==============");\n        for (String part : parts) {\n            System.out.println(part);\n        }\n    }\n}\n\n\nãBuilderã\n\næ½è±¡å»ºé èï¼ç¡®å®äº§åç± ABC ä¸ä¸ªé¨ä»¶ææï¼å¹¶å£°æä¸ä¸ªå¾å°äº§åå»ºé åç»æçæ¹æ³ getResultã\n\ninterface Builder {\n    public void buildPartA();\n    public void buildPartB();\n    public void buildPartC();\n    public Product getResult();\n}\n\n\nãConcreteBuilderã\n\nå®ç° Builder æ¥å£ä¸­çå·ä½æ¹æ³ã\n\nclass ConcreteBuilder implements Builder {\n    private Product product = new Product();\n\n    @Override\n    public void buildPartA() {\n        product.AddPart("é¨ä»¶A");\n    }\n\n    @Override\n    public void buildPartB() {\n        product.AddPart("é¨ä»¶B");\n    }\n\n    @Override\n    public void buildPartC() {\n        product.AddPart("é¨ä»¶C");\n    }\n\n    @Override\n    public Product getResult() {\n        return product;\n    }\n}\n\n\nãDirectorã\n\nææ¥èç±»ï¼ææ¥å»ºé  Product çè¿ç¨ï¼æ§å¶æå»ºåé¨åç»ä»¶çé¡ºåºï¼ã\n\nclass Director {\n    public void construct(Builder builder) {\n        builder.buildPartC();\n        builder.buildPartA();\n        builder.buildPartB();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\nç¨æ·å¹¶ä¸éè¦ç¥éå·ä½çå»ºé è¿ç¨ï¼åªéæå®å»ºé  Product å·ä½ç±»åã\n\npublic class BuilderPattern {\n    public static void main(String[] args) {\n        Director director = new Director();\n        Builder builder = new ConcreteBuilder();\n\n        director.construct(builder);\n        Product product = builder.getResult();\n        product.show();\n    }\n}\n\n\nãè¾åºã\n\n============== äº§ååå»º ==============\né¨ä»¶C\né¨ä»¶A\né¨ä»¶B\n\n\n\n# 4. ä¼ªä»£ç \n\nä¸é¢å³äºå»ºé èæ¨¡å¼çä¾å­æ¼ç¤ºäºä½ å¯ä»¥å¦ä½å¤ç¨ç¸åçå¯¹è±¡æé ä»£ç æ¥çæä¸åç±»åçäº§åââä¾å¦æ±½è½¦ ï¼Carï¼ââåå¶ç¸åºçä½¿ç¨æå ï¼Manualï¼ã\n\n\n\n// åªæå½äº§åè¾ä¸ºå¤æä¸éè¦è¯¦ç»éç½®æ¶ï¼ä½¿ç¨å»ºé èæ¨¡å¼æææä¹ãä¸é¢çä¸¤ä¸ª\n// äº§åå°½ç®¡æ²¡æåæ ·çæ¥å£ï¼ä½å´ç¸äºå³èã\nclass Car is\n    // ä¸è¾æ±½è½¦å¯è½éå¤æ GPS è®¾å¤ãè¡è½¦çµèåå ä¸ªåº§ä½ãä¸ååå·çæ±½è½¦ï¼\n    // è¿å¨åè½¿è½¦ãSUV åæç¯·è½¦ï¼å¯è½ä¼å®è£æå¯ç¨ä¸åçåè½ã\n\nclass Manual is\n    // ç¨æ·ä½¿ç¨æååºè¯¥æ ¹æ®æ±½è½¦éç½®è¿è¡ç¼å¶ï¼å¹¶ä»ç»æ±½è½¦çææåè½ã\n\n\n// å»ºé èæ¥å£å£°æäºåå»ºäº§åå¯¹è±¡ä¸åé¨ä»¶çæ¹æ³ã\ninterface Builder is\n    method reset()\n    method setSeats(...)\n    method setEngine(...)\n    method setTripComputer(...)\n    method setGPS(...)\n\n// å·ä½å»ºé èç±»å°éµå¾ªå»ºé èæ¥å£å¹¶æä¾çææ­¥éª¤çå·ä½å®ç°ãä½ çç¨åºä¸­å¯è½ä¼\n// æå¤ä¸ªä»¥ä¸åæ¹å¼å®ç°çå»ºé èåä½ã\nclass CarBuilder implements Builder is\n    private field car:Car\n\n    // ä¸ä¸ªæ°çå»ºé èå®ä¾å¿é¡»åå«ä¸ä¸ªå¨åç»­ç»è£è¿ç¨ä¸­ä½¿ç¨çç©ºäº§åå¯¹è±¡ã\n    constructor CarBuilder() is\n        this.reset()\n\n    // resetï¼éç½®ï¼æ¹æ³å¯æ¸é¤æ­£å¨çæçå¯¹è±¡ã\n    method reset() is\n        this.car = new Car()\n\n    // ææçææ­¥éª¤é½ä¼ä¸åä¸ä¸ªäº§åå®ä¾è¿è¡äº¤äºã\n    method setSeats(...) is\n        // è®¾ç½®æ±½è½¦åº§ä½çæ°éã\n\n    method setEngine(...) is\n        // å®è£æå®çå¼æã\n\n    method setTripComputer(...) is\n        // å®è£è¡è½¦çµèã\n\n    method setGPS(...) is\n        // å®è£å¨çå®ä½ç³»ç»ã\n\n    // å·ä½å»ºé èéè¦èªè¡æä¾è·åç»æçæ¹æ³ãè¿æ¯å ä¸ºä¸åç±»åçå»ºé èå¯è½\n    // ä¼åå»ºä¸éµå¾ªç¸åæ¥å£çãå®å¨ä¸åçäº§åãæä»¥ä¹å°±æ æ³å¨å»ºé èæ¥å£ä¸­\n    // å£°æè¿äºæ¹æ³ï¼è³å°å¨éæç±»åçç¼ç¨è¯­è¨ä¸­æ¯è¿æ ·çï¼ã\n    //\n    // éå¸¸å¨å»ºé èå®ä¾å°ç»æè¿åç»å®¢æ·ç«¯åï¼å®ä»¬åºè¯¥åå¥½çæå¦ä¸ä¸ªäº§åç\n    // åå¤ãå æ­¤å»ºé èå®ä¾éå¸¸ä¼å¨ `getProductï¼è·åäº§åï¼`æ¹æ³ä¸»ä½æ«å°¾\n    // è°ç¨éç½®æ¹æ³ãä½æ¯è¯¥è¡ä¸ºå¹¶ä¸æ¯å¿éçï¼ä½ ä¹å¯è®©å»ºé èç­å¾å®¢æ·ç«¯æç¡®\n    // è°ç¨éç½®æ¹æ³ååå»å¤çä¹åçç»æã\n    method getProduct():Car is\n        product = this.car\n        this.reset()\n        return product\n\n// å»ºé èä¸å¶ä»åå»ºåæ¨¡å¼çä¸åä¹å¤å¨äºï¼å®è®©ä½ è½åå»ºä¸éµå¾ªç¸åæ¥å£çäº§åã\nclass CarManualBuilder implements Builder is\n    private field manual:Manual\n\n    constructor CarManualBuilder() is\n        this.reset()\n\n    method reset() is\n        this.manual = new Manual()\n\n    method setSeats(...) is\n        // æ·»å å³äºæ±½è½¦åº§æ¤åè½çææ¡£ã\n\n    method setEngine(...) is\n        // æ·»å å³äºå¼æçä»ç»ã\n\n    method setTripComputer(...) is\n        // æ·»å å³äºè¡è½¦çµèçä»ç»ã\n\n    method setGPS(...) is\n        // æ·»å å³äº GPS çä»ç»ã\n\n    method getProduct():Manual is\n        // è¿åä½¿ç¨æåå¹¶éç½®å»ºé èã\n\n\n// ä¸»ç®¡åªè´è´£æç§ç¹å®é¡ºåºæ§è¡çææ­¥éª¤ãå¶å¨æ ¹æ®ç¹å®æ­¥éª¤æéç½®æ¥çæäº§åæ¶\n// ä¼å¾æå¸®å©ãç±äºå®¢æ·ç«¯å¯ä»¥ç´æ¥æ§å¶å»ºé èï¼æä»¥ä¸¥æ ¼æä¹ä¸æ¥è¯´ï¼ä¸»ç®¡ç±»å¹¶\n// ä¸æ¯å¿éçã\nclass Director is\n    private field builder:Builder\n\n    // ä¸»ç®¡å¯åç±å®¢æ·ç«¯ä»£ç ä¼ éç»èªèº«çä»»ä½å»ºé èå®ä¾è¿è¡äº¤äºãå®¢æ·ç«¯å¯é\n    // è¿è¿ç§æ¹å¼æ¹åææ°ç»è£å®æ¯çäº§åçæç»ç±»åã\n    method setBuilder(builder:Builder)\n        this.builder = builder\n\n    // ä¸»ç®¡å¯ä½¿ç¨åæ ·ççææ­¥éª¤åå»ºå¤ä¸ªäº§ååä½ã\n    method constructSportsCar(builder: Builder) is\n        builder.reset()\n        builder.setSeats(2)\n        builder.setEngine(new SportEngine())\n        builder.setTripComputer(true)\n        builder.setGPS(true)\n\n    method constructSUV(builder: Builder) is\n        // ...\n\n\n// å®¢æ·ç«¯ä»£ç ä¼åå»ºå»ºé èå¯¹è±¡å¹¶å°å¶ä¼ éç»ä¸»ç®¡ï¼ç¶åæ§è¡æé è¿ç¨ãæç»ç»æ\n// å°éè¦ä»å»ºé èå¯¹è±¡ä¸­è·åã\nclass Application is\n\n    method makeCar() is\n        director = new Director()\n\n        CarBuilder builder = new CarBuilder()\n        director.constructSportsCar(builder)\n        Car car = builder.getProduct()\n\n        CarManualBuilder builder = new CarManualBuilder()\n        director.constructSportsCar(builder)\n\n        // æç»äº§åéå¸¸éè¦ä»å»ºé èå¯¹è±¡ä¸­è·åï¼å ä¸ºä¸»ç®¡ä¸ç¥æå·ä½å»ºé èå\n        // äº§åçå­å¨ï¼ä¹ä¸ä¼å¯¹å¶äº§çä¾èµã\n        Manual manual = builder.getProduct()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å»ºé èæ¨¡å¼æ¯ Java ä¸çä¸­çä¸ä¸ªèåæ¨¡å¼ã å½ä½ éè¦åå»ºä¸ä¸ªå¯è½æè®¸å¤éç½®éé¡¹çå¯¹è±¡æ¶ï¼ è¯¥æ¨¡å¼ä¼ç¹å«æç¨ã\n\nå»ºé èå¨ Java æ ¸å¿ç¨åºåºä¸­å¾å°äºå¹¿æ³çåºç¨ï¼\n\n * java.lang.StringBuilder#append() ï¼ éåæ­¥ ï¼\n * java.lang.StringBuffer#append() ï¼ åæ­¥ ï¼\n * java.nio.ByteBuffer#put() ï¼è¿æ CharÂ­Bufferã ShortÂ­Bufferã IntÂ­Bufferã LongÂ­Bufferã FloatÂ­Buffer å DoubleÂ­Bufferï¼\n * java.lang.Appendableçææå®ç°\n\nè¯å«æ¹æ³ï¼ å»ºé èæ¨¡å¼å¯ä»¥éè¿ç±»æ¥è¯å«ï¼ å®æ¥æä¸ä¸ªæå»ºæ¹æ³åå¤ä¸ªéç½®ç»æå¯¹è±¡çæ¹æ³ã å»ºé èæ¹æ³éå¸¸æ¯ææ¹æ³é¾ ï¼ä¾å¦ someBuilder->setValueA(1)->setValueB(2)->create() ï¼\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æå»ºé èæ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * å»ºé èéç¹å³æ³¨å¦ä½åæ­¥çæå¤æå¯¹è±¡ã æ½è±¡å·¥åä¸é¨ç¨äºçäº§ä¸ç³»åç¸å³å¯¹è±¡ã æ½è±¡å·¥åä¼é©¬ä¸è¿åäº§åï¼ å»ºé èååè®¸ä½ å¨è·åäº§ååæ§è¡ä¸äºé¢å¤æé æ­¥éª¤ã\n * ä½ å¯ä»¥å¨åå»ºå¤æç»åæ¨¡å¼æ æ¶ä½¿ç¨å»ºé èï¼ å ä¸ºè¿å¯ä½¿å¶æé æ­¥éª¤ä»¥éå½çæ¹å¼è¿è¡ã\n * ä½ å¯ä»¥ç»åä½¿ç¨å»ºé èåæ¡¥æ¥æ¨¡å¼ï¼ ä¸»ç®¡ç±»è´è´£æ½è±¡å·¥ä½ï¼ åç§ä¸åçå»ºé èè´è´£å®ç°å·¥ä½ã\n * æ½è±¡å·¥åã å»ºé èåååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹å»ºé èæ¨¡å¼\n\n\n# 1. æå¾\n\nå»ºé èæ¨¡å¼ï¼builderï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ ä½¿ä½ è½å¤åæ­¥éª¤åå»ºå¤æå¯¹è±¡ã è¯¥æ¨¡å¼åè®¸ä½ ä½¿ç¨ç¸åçåå»ºä»£ç çæä¸åç±»ååå½¢å¼çå¯¹è±¡ã\n\nä½¿ç¨å»ºé èæ¨¡å¼ï¼ç¨æ·å°±åªéè¦æå®éè¦å»ºé çç±»åï¼å·ä½çå»ºé è¿ç¨åç»èå¹¶ä¸éè¦ç¥éã\n\nå»ºé èæ¨¡å¼åè®¸ä¿®æ¹ä¸ä¸ªäº§åçåé¨è¡¨ç¤ºã\n\nå®å°æé åè¡¨ç¤ºä¸¤åä»£ç éç¦»å¼æ¥ã\n\nå®å¾å¥½çæ§å¶äºæå»ºè¿ç¨ã\n\n\n\nå»ºé èæ¨¡å¼æµç¨è¯´æï¼\n\n 1. å®¢æ·ç«¯åå»º director å¯¹è±¡å¹¶éç½®å®æéè¦ç builder å¯¹è±¡ã\n 2. director è´è´£éç¥ builder ä½æ¶å»ºé  product çé¨ä»¶ã\n 3. builder å¤ç director çè¯·æ±å¹¶æ·»å  product çé¨ä»¶ã\n 4. å®¢æ·ç«¯ä» builder å¤è·å¾ productã\n\n\n# 2. éç¨åºæ¯\n\n * ä½¿ç¨å»ºé èæ¨¡å¼å¯é¿å âéå æé å½æ° ï¼telescopic constructorï¼â çåºç°ã\n * å½ä½ å¸æä½¿ç¨ä»£ç åå»ºä¸åå½¢å¼çäº§åæ¶ï¼ å¯ä½¿ç¨å»ºé èæ¨¡å¼ã\n * ä½¿ç¨å»ºé èæé ç»åæ æå¶ä»å¤æå¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n 1. å»ºé è ï¼builderï¼ æ¥å£å£°æå¨ææç±»åå»ºé èä¸­éç¨çäº§åæé æ­¥éª¤ã\n 2. å·ä½å»ºé è ï¼concrete buildersï¼ æä¾æé è¿ç¨çä¸åå®ç°ã å·ä½å»ºé èä¹å¯ä»¥æé ä¸éµå¾ªéç¨æ¥å£çäº§åã\n 3. äº§å ï¼productsï¼ æ¯æç»çæçå¯¹è±¡ã ç±ä¸åå»ºé èæé çäº§åæ éå±äºåä¸ç±»å±æ¬¡ç»æææ¥å£ã\n 4. ä¸»ç®¡ ï¼directorï¼ ç±»å®ä¹è°ç¨æé æ­¥éª¤çé¡ºåºï¼ è¿æ ·ä½ å°±å¯ä»¥åå»ºåå¤ç¨ç¹å®çäº§åéç½®ã\n 5. å®¢æ·ç«¯ ï¼clientï¼ å¿é¡»å°æä¸ªå»ºé èå¯¹è±¡ä¸ä¸»ç®¡ç±»å³èã ä¸è¬æåµä¸ï¼ ä½ åªééè¿ä¸»ç®¡ç±»æé å½æ°çåæ°è¿è¡ä¸æ¬¡æ§å³èå³å¯ã æ­¤åä¸»ç®¡ç±»å°±è½ä½¿ç¨å»ºé èå¯¹è±¡å®æåç»­ææçæé ä»»å¡ã ä½å¨å®¢æ·ç«¯å°å»ºé èå¯¹è±¡ä¼ éç»ä¸»ç®¡ç±»å¶é æ¹æ³æ¶è¿æå¦ä¸ç§æ¹å¼ã å¨è¿ç§æåµä¸ï¼ ä½ å¨ä½¿ç¨ä¸»ç®¡ç±»çäº§äº§åæ¶æ¯æ¬¡é½å¯ä»¥ä½¿ç¨ä¸åçå»ºé èã\n\nãproductãäº§åç±»ï¼ç±å¤ä¸ªé¨ä»¶ææã\n\nclass product {\n    list<string> parts = new arraylist<string>();\n\n    public void addpart(string part) {\n        parts.add(part);\n    }\n\n    public void show() {\n        system.out.println("============== äº§ååå»º ==============");\n        for (string part : parts) {\n            system.out.println(part);\n        }\n    }\n}\n\n\nãbuilderã\n\næ½è±¡å»ºé èï¼ç¡®å®äº§åç± abc ä¸ä¸ªé¨ä»¶ææï¼å¹¶å£°æä¸ä¸ªå¾å°äº§åå»ºé åç»æçæ¹æ³ getresultã\n\ninterface builder {\n    public void buildparta();\n    public void buildpartb();\n    public void buildpartc();\n    public product getresult();\n}\n\n\nãconcretebuilderã\n\nå®ç° builder æ¥å£ä¸­çå·ä½æ¹æ³ã\n\nclass concretebuilder implements builder {\n    private product product = new product();\n\n    @override\n    public void buildparta() {\n        product.addpart("é¨ä»¶a");\n    }\n\n    @override\n    public void buildpartb() {\n        product.addpart("é¨ä»¶b");\n    }\n\n    @override\n    public void buildpartc() {\n        product.addpart("é¨ä»¶c");\n    }\n\n    @override\n    public product getresult() {\n        return product;\n    }\n}\n\n\nãdirectorã\n\nææ¥èç±»ï¼ææ¥å»ºé  product çè¿ç¨ï¼æ§å¶æå»ºåé¨åç»ä»¶çé¡ºåºï¼ã\n\nclass director {\n    public void construct(builder builder) {\n        builder.buildpartc();\n        builder.buildparta();\n        builder.buildpartb();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\nç¨æ·å¹¶ä¸éè¦ç¥éå·ä½çå»ºé è¿ç¨ï¼åªéæå®å»ºé  product å·ä½ç±»åã\n\npublic class builderpattern {\n    public static void main(string[] args) {\n        director director = new director();\n        builder builder = new concretebuilder();\n\n        director.construct(builder);\n        product product = builder.getresult();\n        product.show();\n    }\n}\n\n\nãè¾åºã\n\n============== äº§ååå»º ==============\né¨ä»¶c\né¨ä»¶a\né¨ä»¶b\n\n\n\n# 4. ä¼ªä»£ç \n\nä¸é¢å³äºå»ºé èæ¨¡å¼çä¾å­æ¼ç¤ºäºä½ å¯ä»¥å¦ä½å¤ç¨ç¸åçå¯¹è±¡æé ä»£ç æ¥çæä¸åç±»åçäº§åââä¾å¦æ±½è½¦ ï¼carï¼ââåå¶ç¸åºçä½¿ç¨æå ï¼manualï¼ã\n\n\n\n// åªæå½äº§åè¾ä¸ºå¤æä¸éè¦è¯¦ç»éç½®æ¶ï¼ä½¿ç¨å»ºé èæ¨¡å¼æææä¹ãä¸é¢çä¸¤ä¸ª\n// äº§åå°½ç®¡æ²¡æåæ ·çæ¥å£ï¼ä½å´ç¸äºå³èã\nclass car is\n    // ä¸è¾æ±½è½¦å¯è½éå¤æ gps è®¾å¤ãè¡è½¦çµèåå ä¸ªåº§ä½ãä¸ååå·çæ±½è½¦ï¼\n    // è¿å¨åè½¿è½¦ãsuv åæç¯·è½¦ï¼å¯è½ä¼å®è£æå¯ç¨ä¸åçåè½ã\n\nclass manual is\n    // ç¨æ·ä½¿ç¨æååºè¯¥æ ¹æ®æ±½è½¦éç½®è¿è¡ç¼å¶ï¼å¹¶ä»ç»æ±½è½¦çææåè½ã\n\n\n// å»ºé èæ¥å£å£°æäºåå»ºäº§åå¯¹è±¡ä¸åé¨ä»¶çæ¹æ³ã\ninterface builder is\n    method reset()\n    method setseats(...)\n    method setengine(...)\n    method settripcomputer(...)\n    method setgps(...)\n\n// å·ä½å»ºé èç±»å°éµå¾ªå»ºé èæ¥å£å¹¶æä¾çææ­¥éª¤çå·ä½å®ç°ãä½ çç¨åºä¸­å¯è½ä¼\n// æå¤ä¸ªä»¥ä¸åæ¹å¼å®ç°çå»ºé èåä½ã\nclass carbuilder implements builder is\n    private field car:car\n\n    // ä¸ä¸ªæ°çå»ºé èå®ä¾å¿é¡»åå«ä¸ä¸ªå¨åç»­ç»è£è¿ç¨ä¸­ä½¿ç¨çç©ºäº§åå¯¹è±¡ã\n    constructor carbuilder() is\n        this.reset()\n\n    // resetï¼éç½®ï¼æ¹æ³å¯æ¸é¤æ­£å¨çæçå¯¹è±¡ã\n    method reset() is\n        this.car = new car()\n\n    // ææçææ­¥éª¤é½ä¼ä¸åä¸ä¸ªäº§åå®ä¾è¿è¡äº¤äºã\n    method setseats(...) is\n        // è®¾ç½®æ±½è½¦åº§ä½çæ°éã\n\n    method setengine(...) is\n        // å®è£æå®çå¼æã\n\n    method settripcomputer(...) is\n        // å®è£è¡è½¦çµèã\n\n    method setgps(...) is\n        // å®è£å¨çå®ä½ç³»ç»ã\n\n    // å·ä½å»ºé èéè¦èªè¡æä¾è·åç»æçæ¹æ³ãè¿æ¯å ä¸ºä¸åç±»åçå»ºé èå¯è½\n    // ä¼åå»ºä¸éµå¾ªç¸åæ¥å£çãå®å¨ä¸åçäº§åãæä»¥ä¹å°±æ æ³å¨å»ºé èæ¥å£ä¸­\n    // å£°æè¿äºæ¹æ³ï¼è³å°å¨éæç±»åçç¼ç¨è¯­è¨ä¸­æ¯è¿æ ·çï¼ã\n    //\n    // éå¸¸å¨å»ºé èå®ä¾å°ç»æè¿åç»å®¢æ·ç«¯åï¼å®ä»¬åºè¯¥åå¥½çæå¦ä¸ä¸ªäº§åç\n    // åå¤ãå æ­¤å»ºé èå®ä¾éå¸¸ä¼å¨ `getproductï¼è·åäº§åï¼`æ¹æ³ä¸»ä½æ«å°¾\n    // è°ç¨éç½®æ¹æ³ãä½æ¯è¯¥è¡ä¸ºå¹¶ä¸æ¯å¿éçï¼ä½ ä¹å¯è®©å»ºé èç­å¾å®¢æ·ç«¯æç¡®\n    // è°ç¨éç½®æ¹æ³ååå»å¤çä¹åçç»æã\n    method getproduct():car is\n        product = this.car\n        this.reset()\n        return product\n\n// å»ºé èä¸å¶ä»åå»ºåæ¨¡å¼çä¸åä¹å¤å¨äºï¼å®è®©ä½ è½åå»ºä¸éµå¾ªç¸åæ¥å£çäº§åã\nclass carmanualbuilder implements builder is\n    private field manual:manual\n\n    constructor carmanualbuilder() is\n        this.reset()\n\n    method reset() is\n        this.manual = new manual()\n\n    method setseats(...) is\n        // æ·»å å³äºæ±½è½¦åº§æ¤åè½çææ¡£ã\n\n    method setengine(...) is\n        // æ·»å å³äºå¼æçä»ç»ã\n\n    method settripcomputer(...) is\n        // æ·»å å³äºè¡è½¦çµèçä»ç»ã\n\n    method setgps(...) is\n        // æ·»å å³äº gps çä»ç»ã\n\n    method getproduct():manual is\n        // è¿åä½¿ç¨æåå¹¶éç½®å»ºé èã\n\n\n// ä¸»ç®¡åªè´è´£æç§ç¹å®é¡ºåºæ§è¡çææ­¥éª¤ãå¶å¨æ ¹æ®ç¹å®æ­¥éª¤æéç½®æ¥çæäº§åæ¶\n// ä¼å¾æå¸®å©ãç±äºå®¢æ·ç«¯å¯ä»¥ç´æ¥æ§å¶å»ºé èï¼æä»¥ä¸¥æ ¼æä¹ä¸æ¥è¯´ï¼ä¸»ç®¡ç±»å¹¶\n// ä¸æ¯å¿éçã\nclass director is\n    private field builder:builder\n\n    // ä¸»ç®¡å¯åç±å®¢æ·ç«¯ä»£ç ä¼ éç»èªèº«çä»»ä½å»ºé èå®ä¾è¿è¡äº¤äºãå®¢æ·ç«¯å¯é\n    // è¿è¿ç§æ¹å¼æ¹åææ°ç»è£å®æ¯çäº§åçæç»ç±»åã\n    method setbuilder(builder:builder)\n        this.builder = builder\n\n    // ä¸»ç®¡å¯ä½¿ç¨åæ ·ççææ­¥éª¤åå»ºå¤ä¸ªäº§ååä½ã\n    method constructsportscar(builder: builder) is\n        builder.reset()\n        builder.setseats(2)\n        builder.setengine(new sportengine())\n        builder.settripcomputer(true)\n        builder.setgps(true)\n\n    method constructsuv(builder: builder) is\n        // ...\n\n\n// å®¢æ·ç«¯ä»£ç ä¼åå»ºå»ºé èå¯¹è±¡å¹¶å°å¶ä¼ éç»ä¸»ç®¡ï¼ç¶åæ§è¡æé è¿ç¨ãæç»ç»æ\n// å°éè¦ä»å»ºé èå¯¹è±¡ä¸­è·åã\nclass application is\n\n    method makecar() is\n        director = new director()\n\n        carbuilder builder = new carbuilder()\n        director.constructsportscar(builder)\n        car car = builder.getproduct()\n\n        carmanualbuilder builder = new carmanualbuilder()\n        director.constructsportscar(builder)\n\n        // æç»äº§åéå¸¸éè¦ä»å»ºé èå¯¹è±¡ä¸­è·åï¼å ä¸ºä¸»ç®¡ä¸ç¥æå·ä½å»ºé èå\n        // äº§åçå­å¨ï¼ä¹ä¸ä¼å¯¹å¶äº§çä¾èµã\n        manual manual = builder.getproduct()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å»ºé èæ¨¡å¼æ¯ java ä¸çä¸­çä¸ä¸ªèåæ¨¡å¼ã å½ä½ éè¦åå»ºä¸ä¸ªå¯è½æè®¸å¤éç½®éé¡¹çå¯¹è±¡æ¶ï¼ è¯¥æ¨¡å¼ä¼ç¹å«æç¨ã\n\nå»ºé èå¨ java æ ¸å¿ç¨åºåºä¸­å¾å°äºå¹¿æ³çåºç¨ï¼\n\n * java.lang.stringbuilder#append() ï¼ éåæ­¥ ï¼\n * java.lang.stringbuffer#append() ï¼ åæ­¥ ï¼\n * java.nio.bytebuffer#put() ï¼è¿æ charÂ­bufferã shortÂ­bufferã intÂ­bufferã longÂ­bufferã floatÂ­buffer å doubleÂ­bufferï¼\n * java.lang.appendableçææå®ç°\n\nè¯å«æ¹æ³ï¼ å»ºé èæ¨¡å¼å¯ä»¥éè¿ç±»æ¥è¯å«ï¼ å®æ¥æä¸ä¸ªæå»ºæ¹æ³åå¤ä¸ªéç½®ç»æå¯¹è±¡çæ¹æ³ã å»ºé èæ¹æ³éå¸¸æ¯ææ¹æ³é¾ ï¼ä¾å¦ somebuilder->setvaluea(1)->setvalueb(2)->create() ï¼\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æå»ºé èæ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * å»ºé èéç¹å³æ³¨å¦ä½åæ­¥çæå¤æå¯¹è±¡ã æ½è±¡å·¥åä¸é¨ç¨äºçäº§ä¸ç³»åç¸å³å¯¹è±¡ã æ½è±¡å·¥åä¼é©¬ä¸è¿åäº§åï¼ å»ºé èååè®¸ä½ å¨è·åäº§ååæ§è¡ä¸äºé¢å¤æé æ­¥éª¤ã\n * ä½ å¯ä»¥å¨åå»ºå¤æç»åæ¨¡å¼æ æ¶ä½¿ç¨å»ºé èï¼ å ä¸ºè¿å¯ä½¿å¶æé æ­¥éª¤ä»¥éå½çæ¹å¼è¿è¡ã\n * ä½ å¯ä»¥ç»åä½¿ç¨å»ºé èåæ¡¥æ¥æ¨¡å¼ï¼ ä¸»ç®¡ç±»è´è´£æ½è±¡å·¥ä½ï¼ åç§ä¸åçå»ºé èè´è´£å®ç°å·¥ä½ã\n * æ½è±¡å·¥åã å»ºé èåååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ååæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ååæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T15:00:00.000Z",permalink:"/pages/c5ff69/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/05.%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/05.ååæ¨¡å¼.md",key:"v-68de8656",path:"/pages/c5ff69/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:3,title:"1.1. æµæ·è´ä¸æ·±æ·è´",slug:"_1-1-æµæ·è´ä¸æ·±æ·è´",normalizedTitle:"1.1. æµæ·è´ä¸æ·±æ·è´",charIndex:471},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:625},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:757},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:971},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3102},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:3278},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:3691}],headersStr:"1. æå¾ 1.1. æµæ·è´ä¸æ·±æ·è´ 2. éç¨åºæ¯ 3. ç»æ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:"# è®¾è®¡æ¨¡å¼ä¹ååæ¨¡å¼\n\n\n# 1. æå¾\n\nååæ¨¡å¼ï¼Prototypeï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ ä½¿ä½ è½å¤å¤å¶å·²æå¯¹è±¡ï¼ èåæ éä½¿ä»£ç ä¾èµå®ä»¬æå±çç±»ã\n\nååæ¨¡å¼ä¸»è¦ç¨äºå¯¹è±¡çå¤å¶ï¼å®çæ ¸å¿æ¯å°±æ¯ç±»å¾ä¸­çååç±» PrototypeãPrototype ç±»éè¦å·å¤ä»¥ä¸ä¸¤ä¸ªæ¡ä»¶ï¼\n\n * å®ç° Cloneable æ¥å£ãå¨ java è¯­è¨æä¸ä¸ª Cloneable æ¥å£ï¼å®çä½ç¨åªæä¸ä¸ªï¼å°±æ¯å¨è¿è¡æ¶éç¥èææºå¯ä»¥å®å¨å°å¨å®ç°äºæ­¤æ¥å£çç±»ä¸ä½¿ç¨ clone æ¹æ³ãå¨ java èææºä¸­ï¼åªæå®ç°äºè¿ä¸ªæ¥å£çç±»æå¯ä»¥è¢«æ·è´ï¼å¦åå¨è¿è¡æ¶ä¼æåº CloneNotSupportedException å¼å¸¸ã\n * éå Object ç±»ä¸­ç clone æ¹æ³ãJava ä¸­ï¼ææç±»çç¶ç±»é½æ¯ Object ç±»ï¼Object ç±»ä¸­æä¸ä¸ª clone æ¹æ³ï¼ä½ç¨æ¯è¿åå¯¹è±¡çä¸ä¸ªæ·è´ï¼ä½æ¯å¶ä½ç¨å protected ç±»åçï¼ä¸è¬çç±»æ æ³è°ç¨ï¼å æ­¤ï¼Prototype ç±»éè¦å° clone æ¹æ³çä½ç¨åä¿®æ¹ä¸º public ç±»åã\n\n\n# 1.1. æµæ·è´ä¸æ·±æ·è´\n\næµæ·è´æ¯æå½å¯¹è±¡çå­æ®µå¼è¢«å¤å¶æ¶ï¼å­æ®µå¼ç¨çå¯¹è±¡ä¸ä¼è¢«å¤å¶ã\n\nä¾å¦ï¼å¦æä¸ä¸ªå¯¹è±¡æä¸ä¸ªæåå­ç¬¦ä¸²çå­æ®µï¼å¹¶ä¸æä»¬å¯¹è¯¥å¯¹è±¡åäºä¸ä¸ªæµæ·è´ï¼é£éº½ä¸¤ä¸ªå¯¹è±¡å°å¼ç¨åä¸ä¸ªå­ç¬¦ä¸²ã\n\næ·±æ·è´æ¯æå½ä¸ä¸ªç±»æ¥æèµæºï¼å½è¿ä¸ªç±»çå¯¹è±¡åçå¤å¶è¿ç¨çæ¶åï¼èµæºéæ°åéï¼è¿ä¸ªè¿ç¨å°±æ¯æ·±æ·è´ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦å¤å¶ä¸äºå¯¹è±¡ï¼ åæ¶åå¸æä»£ç ç¬ç«äºè¿äºå¯¹è±¡æå±çå·ä½ç±»ï¼ å¯ä»¥ä½¿ç¨ååæ¨¡å¼ã\n * å¦æå­ç±»çåºå«ä»å¨äºå¶å¯¹è±¡çåå§åæ¹å¼ï¼ é£ä¹ä½ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼æ¥åå°å­ç±»çæ°éã å«äººåå»ºè¿äºå­ç±»çç®çå¯è½æ¯ä¸ºäºåå»ºç¹å®ç±»åçå¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n 1. åå ï¼Prototypeï¼ æ¥å£å°å¯¹åéæ¹æ³è¿è¡å£°æã å¨ç»å¤§å¤æ°æåµä¸ï¼ å¶ä¸­åªä¼æä¸ä¸ªåä¸º cloneåéçæ¹æ³ã\n 2. å·ä½åå ï¼Concrete Prototypeï¼ ç±»å°å®ç°åéæ¹æ³ã é¤äºå°åå§å¯¹è±¡çæ°æ®å¤å¶å°åéä½ä¸­ä¹å¤ï¼ è¯¥æ¹æ³ææ¶è¿éå¤çåéè¿ç¨ä¸­çæç«¯æåµï¼ ä¾å¦åéå³èå¯¹è±¡åæ¢³çéå½ä¾èµç­ç­ã\n 3. å®¢æ·ç«¯ ï¼Clientï¼ å¯ä»¥å¤å¶å®ç°äºååæ¥å£çä»»ä½å¯¹è±¡ã\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ååæ¨¡å¼è½è®©ä½ çæå®å¨ç¸åçå ä½å¯¹è±¡å¯æ¬ï¼ åæ¶æ éä»£ç ä¸å¯¹è±¡æå±ç±»è¦åã\n\n\n\nææå½¢ç¶ç±»é½éµå¾ªåä¸ä¸ªæä¾åéæ¹æ³çæ¥å£ã å¨å¤å¶èªèº«æååéå¼å°ç»æå¯¹è±¡åï¼ å­ç±»å¯è°ç¨å¶ç¶ç±»çåéæ¹æ³ã\n\n// åºç¡ååã\nabstract class Shape is\n    field X: int\n    field Y: int\n    field color: string\n\n    // å¸¸è§æé å½æ°ã\n    constructor Shape() is\n        // ...\n\n    // ååæé å½æ°ãä½¿ç¨å·²æå¯¹è±¡çæ°å¼æ¥åå§åä¸ä¸ªæ°å¯¹è±¡ã\n    constructor Shape(source: Shape) is\n        this()\n        this.X = source.X\n        this.Y = source.Y\n        this.color = source.color\n\n    // cloneï¼åéï¼æä½ä¼è¿åä¸ä¸ªå½¢ç¶å­ç±»ã\n    abstract method clone():Shape\n\n\n// å·ä½ååãåéæ¹æ³ä¼åå»ºä¸ä¸ªæ°å¯¹è±¡å¹¶å°å¶ä¼ éç»æé å½æ°ãç´å°æé å½æ°è¿\n// è¡å®æåï¼å®é½æ¥ææåæ°åéå¯¹è±¡çå¼ç¨ãå æ­¤ï¼ä»»ä½äººé½æ æ³è®¿é®æªå®å¨ç\n// æçåéå¯¹è±¡ãè¿å¯ä»¥ä¿æåéç»æçä¸è´ã\nclass Rectangle extends Shape is\n    field width: int\n    field height: int\n\n    constructor Rectangle(source: Rectangle) is\n        // éè¦è°ç¨ç¶æé å½æ°æ¥å¤å¶ç¶ç±»ä¸­å®ä¹çç§ææååéã\n        super(source)\n        this.width = source.width\n        this.height = source.height\n\n    method clone():Shape is\n        return new Rectangle(this)\n\n\nclass Circle extends Shape is\n    field radius: int\n\n    constructor Circle(source: Circle) is\n        super(source)\n        this.radius = source.radius\n\n    method clone():Shape is\n        return new Circle(this)\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\nclass Application is\n    field shapes: array of Shape\n\n    constructor Application() is\n        Circle circle = new Circle()\n        circle.X = 10\n        circle.Y = 10\n        circle.radius = 20\n        shapes.add(circle)\n\n        Circle anotherCircle = circle.clone()\n        shapes.add(anotherCircle)\n        // åé `anotherCircleï¼å¦ä¸ä¸ªåï¼`ä¸ `circleï¼åï¼`å¯¹è±¡çå\n        // å®¹å®å¨ä¸æ ·ã\n\n        Rectangle rectangle = new Rectangle()\n        rectangle.width = 10\n        rectangle.height = 20\n        shapes.add(rectangle)\n\n    method businessLogic() is\n        // ååæ¯å¾å¼ºå¤§çä¸è¥¿ï¼å ä¸ºå®è½å¨ä¸ç¥æå¯¹è±¡ç±»åçæåµä¸çæä¸ä¸ªä¸\n        // å¶å®å¨ç¸åçå¤å¶åã\n        Array shapesCopy = new Array of Shapes.\n\n        // ä¾å¦ï¼æä»¬ä¸ç¥æå½¢ç¶æ°ç»ä¸­åç´ çå·ä½ç±»åï¼åªç¥éå®ä»¬é½æ¯å½¢ç¶ã\n        // ä½å¨å¤ææºå¶çå¸®å©ä¸ï¼å½æä»¬å¨æä¸ªå½¢ç¶ä¸è°ç¨ `cloneï¼åéï¼`\n        // æ¹æ³æ¶ï¼ç¨åºä¼æ£æ¥å¶æå±çç±»å¹¶è°ç¨å¶ä¸­æå®ä¹çåéæ¹æ³ãè¿æ ·ï¼\n        // æä»¬å°è·å¾ä¸ä¸ªæ­£ç¡®çå¤å¶åï¼èä¸æ¯ä¸ç»ç®åçå½¢ç¶å¯¹è±¡ã\n        foreach (s in shapes) do\n            shapesCopy.add(s.clone())\n\n        // `shapesCopyï¼å½¢ç¶å¯æ¬ï¼`æ°ç»ä¸­åå« `shapeï¼å½¢ç¶ï¼`æ°ç»ææ\n        // å­åç´ çå¤å¶åã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ Java ç Cloneable ï¼å¯åéï¼ æ¥å£å°±æ¯ç«å³å¯ç¨çååæ¨¡å¼ã\n\nä»»ä½ç±»é½å¯éè¿å®ç°è¯¥æ¥å£æ¥å®ç°å¯è¢«åéçæ§è´¨ã\n\n * java.lang.Object#clone() ï¼ç±»å¿é¡»å®ç° java.lang.Cloneable æ¥å£ï¼\n\nè¯å«æ¹æ³ï¼ ååå¯ä»¥ç®åå°éè¿ cloneæ copyç­æ¹æ³æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * ååå¯ç¨äºä¿å­å½ä»¤æ¨¡å¼çåå²è®°å½ã\n * å¤§éä½¿ç¨ç»åæ¨¡å¼åè£é¥°æ¨¡å¼çè®¾è®¡éå¸¸å¯ä»å¯¹äºååçä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n * ååå¹¶ä¸åºäºç»§æ¿ï¼ å æ­¤æ²¡æç»§æ¿çç¼ºç¹ã å¦ä¸æ¹é¢ï¼ ååéè¦å¯¹è¢«å¤å¶å¯¹è±¡è¿è¡å¤æçåå§åã å·¥åæ¹æ³åºäºç»§æ¿ï¼ ä½æ¯å®ä¸éè¦åå§åæ­¥éª¤ã\n * ææ¶åååå¯ä»¥ä½ä¸ºå¤å¿å½æ¨¡å¼çä¸ä¸ªç®åçæ¬ï¼ å¶æ¡ä»¶æ¯ä½ éè¦å¨åå²è®°å½ä¸­å­å¨çå¯¹è±¡çç¶ææ¯è¾ç®åï¼ ä¸éè¦é¾æ¥å¶ä»å¤é¨èµæºï¼ æèé¾æ¥å¯ä»¥æ¹ä¾¿å°éå»ºã\n * æ½è±¡å·¥åã çæå¨åååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨",normalizedContent:"# è®¾è®¡æ¨¡å¼ä¹ååæ¨¡å¼\n\n\n# 1. æå¾\n\nååæ¨¡å¼ï¼prototypeï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ ä½¿ä½ è½å¤å¤å¶å·²æå¯¹è±¡ï¼ èåæ éä½¿ä»£ç ä¾èµå®ä»¬æå±çç±»ã\n\nååæ¨¡å¼ä¸»è¦ç¨äºå¯¹è±¡çå¤å¶ï¼å®çæ ¸å¿æ¯å°±æ¯ç±»å¾ä¸­çååç±» prototypeãprototype ç±»éè¦å·å¤ä»¥ä¸ä¸¤ä¸ªæ¡ä»¶ï¼\n\n * å®ç° cloneable æ¥å£ãå¨ java è¯­è¨æä¸ä¸ª cloneable æ¥å£ï¼å®çä½ç¨åªæä¸ä¸ªï¼å°±æ¯å¨è¿è¡æ¶éç¥èææºå¯ä»¥å®å¨å°å¨å®ç°äºæ­¤æ¥å£çç±»ä¸ä½¿ç¨ clone æ¹æ³ãå¨ java èææºä¸­ï¼åªæå®ç°äºè¿ä¸ªæ¥å£çç±»æå¯ä»¥è¢«æ·è´ï¼å¦åå¨è¿è¡æ¶ä¼æåº clonenotsupportedexception å¼å¸¸ã\n * éå object ç±»ä¸­ç clone æ¹æ³ãjava ä¸­ï¼ææç±»çç¶ç±»é½æ¯ object ç±»ï¼object ç±»ä¸­æä¸ä¸ª clone æ¹æ³ï¼ä½ç¨æ¯è¿åå¯¹è±¡çä¸ä¸ªæ·è´ï¼ä½æ¯å¶ä½ç¨å protected ç±»åçï¼ä¸è¬çç±»æ æ³è°ç¨ï¼å æ­¤ï¼prototype ç±»éè¦å° clone æ¹æ³çä½ç¨åä¿®æ¹ä¸º public ç±»åã\n\n\n# 1.1. æµæ·è´ä¸æ·±æ·è´\n\næµæ·è´æ¯æå½å¯¹è±¡çå­æ®µå¼è¢«å¤å¶æ¶ï¼å­æ®µå¼ç¨çå¯¹è±¡ä¸ä¼è¢«å¤å¶ã\n\nä¾å¦ï¼å¦æä¸ä¸ªå¯¹è±¡æä¸ä¸ªæåå­ç¬¦ä¸²çå­æ®µï¼å¹¶ä¸æä»¬å¯¹è¯¥å¯¹è±¡åäºä¸ä¸ªæµæ·è´ï¼é£éº½ä¸¤ä¸ªå¯¹è±¡å°å¼ç¨åä¸ä¸ªå­ç¬¦ä¸²ã\n\næ·±æ·è´æ¯æå½ä¸ä¸ªç±»æ¥æèµæºï¼å½è¿ä¸ªç±»çå¯¹è±¡åçå¤å¶è¿ç¨çæ¶åï¼èµæºéæ°åéï¼è¿ä¸ªè¿ç¨å°±æ¯æ·±æ·è´ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦å¤å¶ä¸äºå¯¹è±¡ï¼ åæ¶åå¸æä»£ç ç¬ç«äºè¿äºå¯¹è±¡æå±çå·ä½ç±»ï¼ å¯ä»¥ä½¿ç¨ååæ¨¡å¼ã\n * å¦æå­ç±»çåºå«ä»å¨äºå¶å¯¹è±¡çåå§åæ¹å¼ï¼ é£ä¹ä½ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼æ¥åå°å­ç±»çæ°éã å«äººåå»ºè¿äºå­ç±»çç®çå¯è½æ¯ä¸ºäºåå»ºç¹å®ç±»åçå¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n 1. åå ï¼prototypeï¼ æ¥å£å°å¯¹åéæ¹æ³è¿è¡å£°æã å¨ç»å¤§å¤æ°æåµä¸ï¼ å¶ä¸­åªä¼æä¸ä¸ªåä¸º cloneåéçæ¹æ³ã\n 2. å·ä½åå ï¼concrete prototypeï¼ ç±»å°å®ç°åéæ¹æ³ã é¤äºå°åå§å¯¹è±¡çæ°æ®å¤å¶å°åéä½ä¸­ä¹å¤ï¼ è¯¥æ¹æ³ææ¶è¿éå¤çåéè¿ç¨ä¸­çæç«¯æåµï¼ ä¾å¦åéå³èå¯¹è±¡åæ¢³çéå½ä¾èµç­ç­ã\n 3. å®¢æ·ç«¯ ï¼clientï¼ å¯ä»¥å¤å¶å®ç°äºååæ¥å£çä»»ä½å¯¹è±¡ã\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ååæ¨¡å¼è½è®©ä½ çæå®å¨ç¸åçå ä½å¯¹è±¡å¯æ¬ï¼ åæ¶æ éä»£ç ä¸å¯¹è±¡æå±ç±»è¦åã\n\n\n\nææå½¢ç¶ç±»é½éµå¾ªåä¸ä¸ªæä¾åéæ¹æ³çæ¥å£ã å¨å¤å¶èªèº«æååéå¼å°ç»æå¯¹è±¡åï¼ å­ç±»å¯è°ç¨å¶ç¶ç±»çåéæ¹æ³ã\n\n// åºç¡ååã\nabstract class shape is\n    field x: int\n    field y: int\n    field color: string\n\n    // å¸¸è§æé å½æ°ã\n    constructor shape() is\n        // ...\n\n    // ååæé å½æ°ãä½¿ç¨å·²æå¯¹è±¡çæ°å¼æ¥åå§åä¸ä¸ªæ°å¯¹è±¡ã\n    constructor shape(source: shape) is\n        this()\n        this.x = source.x\n        this.y = source.y\n        this.color = source.color\n\n    // cloneï¼åéï¼æä½ä¼è¿åä¸ä¸ªå½¢ç¶å­ç±»ã\n    abstract method clone():shape\n\n\n// å·ä½ååãåéæ¹æ³ä¼åå»ºä¸ä¸ªæ°å¯¹è±¡å¹¶å°å¶ä¼ éç»æé å½æ°ãç´å°æé å½æ°è¿\n// è¡å®æåï¼å®é½æ¥ææåæ°åéå¯¹è±¡çå¼ç¨ãå æ­¤ï¼ä»»ä½äººé½æ æ³è®¿é®æªå®å¨ç\n// æçåéå¯¹è±¡ãè¿å¯ä»¥ä¿æåéç»æçä¸è´ã\nclass rectangle extends shape is\n    field width: int\n    field height: int\n\n    constructor rectangle(source: rectangle) is\n        // éè¦è°ç¨ç¶æé å½æ°æ¥å¤å¶ç¶ç±»ä¸­å®ä¹çç§ææååéã\n        super(source)\n        this.width = source.width\n        this.height = source.height\n\n    method clone():shape is\n        return new rectangle(this)\n\n\nclass circle extends shape is\n    field radius: int\n\n    constructor circle(source: circle) is\n        super(source)\n        this.radius = source.radius\n\n    method clone():shape is\n        return new circle(this)\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\nclass application is\n    field shapes: array of shape\n\n    constructor application() is\n        circle circle = new circle()\n        circle.x = 10\n        circle.y = 10\n        circle.radius = 20\n        shapes.add(circle)\n\n        circle anothercircle = circle.clone()\n        shapes.add(anothercircle)\n        // åé `anothercircleï¼å¦ä¸ä¸ªåï¼`ä¸ `circleï¼åï¼`å¯¹è±¡çå\n        // å®¹å®å¨ä¸æ ·ã\n\n        rectangle rectangle = new rectangle()\n        rectangle.width = 10\n        rectangle.height = 20\n        shapes.add(rectangle)\n\n    method businesslogic() is\n        // ååæ¯å¾å¼ºå¤§çä¸è¥¿ï¼å ä¸ºå®è½å¨ä¸ç¥æå¯¹è±¡ç±»åçæåµä¸çæä¸ä¸ªä¸\n        // å¶å®å¨ç¸åçå¤å¶åã\n        array shapescopy = new array of shapes.\n\n        // ä¾å¦ï¼æä»¬ä¸ç¥æå½¢ç¶æ°ç»ä¸­åç´ çå·ä½ç±»åï¼åªç¥éå®ä»¬é½æ¯å½¢ç¶ã\n        // ä½å¨å¤ææºå¶çå¸®å©ä¸ï¼å½æä»¬å¨æä¸ªå½¢ç¶ä¸è°ç¨ `cloneï¼åéï¼`\n        // æ¹æ³æ¶ï¼ç¨åºä¼æ£æ¥å¶æå±çç±»å¹¶è°ç¨å¶ä¸­æå®ä¹çåéæ¹æ³ãè¿æ ·ï¼\n        // æä»¬å°è·å¾ä¸ä¸ªæ­£ç¡®çå¤å¶åï¼èä¸æ¯ä¸ç»ç®åçå½¢ç¶å¯¹è±¡ã\n        foreach (s in shapes) do\n            shapescopy.add(s.clone())\n\n        // `shapescopyï¼å½¢ç¶å¯æ¬ï¼`æ°ç»ä¸­åå« `shapeï¼å½¢ç¶ï¼`æ°ç»ææ\n        // å­åç´ çå¤å¶åã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ java ç cloneable ï¼å¯åéï¼ æ¥å£å°±æ¯ç«å³å¯ç¨çååæ¨¡å¼ã\n\nä»»ä½ç±»é½å¯éè¿å®ç°è¯¥æ¥å£æ¥å®ç°å¯è¢«åéçæ§è´¨ã\n\n * java.lang.object#clone() ï¼ç±»å¿é¡»å®ç° java.lang.cloneable æ¥å£ï¼\n\nè¯å«æ¹æ³ï¼ ååå¯ä»¥ç®åå°éè¿ cloneæ copyç­æ¹æ³æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¨è®¸å¤è®¾è®¡å·¥ä½çåæé½ä¼ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼ ï¼è¾ä¸ºç®åï¼ èä¸å¯ä»¥æ´æ¹ä¾¿å°éè¿å­ç±»è¿è¡å®å¶ï¼ï¼ éåæ¼åä¸ºä½¿ç¨æ½è±¡å·¥åæ¨¡å¼ã ååæ¨¡å¼æçæå¨æ¨¡å¼ ï¼æ´çµæ´»ä½æ´å å¤æï¼ã\n * æ½è±¡å·¥åæ¨¡å¼éå¸¸åºäºä¸ç»å·¥åæ¹æ³ï¼ ä½ä½ ä¹å¯ä»¥ä½¿ç¨ååæ¨¡å¼æ¥çæè¿äºç±»çæ¹æ³ã\n * ååå¯ç¨äºä¿å­å½ä»¤æ¨¡å¼çåå²è®°å½ã\n * å¤§éä½¿ç¨ç»åæ¨¡å¼åè£é¥°æ¨¡å¼çè®¾è®¡éå¸¸å¯ä»å¯¹äºååçä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n * ååå¹¶ä¸åºäºç»§æ¿ï¼ å æ­¤æ²¡æç»§æ¿çç¼ºç¹ã å¦ä¸æ¹é¢ï¼ ååéè¦å¯¹è¢«å¤å¶å¯¹è±¡è¿è¡å¤æçåå§åã å·¥åæ¹æ³åºäºç»§æ¿ï¼ ä½æ¯å®ä¸éè¦åå§åæ­¥éª¤ã\n * ææ¶åååå¯ä»¥ä½ä¸ºå¤å¿å½æ¨¡å¼çä¸ä¸ªç®åçæ¬ï¼ å¶æ¡ä»¶æ¯ä½ éè¦å¨åå²è®°å½ä¸­å­å¨çå¯¹è±¡çç¶ææ¯è¾ç®åï¼ ä¸éè¦é¾æ¥å¶ä»å¤é¨èµæºï¼ æèé¾æ¥å¯ä»¥æ¹ä¾¿å°éå»ºã\n * æ½è±¡å·¥åã çæå¨åååé½å¯ä»¥ç¨åä¾æ¨¡å¼æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹åä¾æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹åä¾æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-06-03T09:24:00.000Z",permalink:"/pages/b271ff/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/06.%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/06.åä¾æ¨¡å¼.md",key:"v-72ea5972",path:"/pages/b271ff/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:747},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:1210},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1348},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:2497},{level:3,title:"5.1. æ°æ®åºè¿æ¥ç±»",slug:"_5-1-æ°æ®åºè¿æ¥ç±»",normalizedTitle:"5.1. æ°æ®åºè¿æ¥ç±»",charIndex:2731},{level:3,title:"5.2. ææ±å¼",slug:"_5-2-ææ±å¼",normalizedTitle:"5.2. ææ±å¼",charIndex:3879},{level:3,title:"5.3. é¥¿æ±å¼",slug:"_5-3-é¥¿æ±å¼",normalizedTitle:"5.3. é¥¿æ±å¼",charIndex:4412},{level:3,title:"5.4. åééçå½¢å¼",slug:"_5-4-åééçå½¢å¼",normalizedTitle:"5.4. åééçå½¢å¼",charIndex:4846},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5589},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:5816}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 4. ä¼ªä»£ç  5. æ¡ä¾ 5.1. æ°æ®åºè¿æ¥ç±» 5.2. ææ±å¼ 5.3. é¥¿æ±å¼ 5.4. åééçå½¢å¼ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹åä¾æ¨¡å¼\n\n\n# 1. æå¾\n\nåä¾æ¨¡å¼ï¼Singletonï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¤ä¿è¯ä¸ä¸ªç±»åªæä¸ä¸ªå®ä¾ï¼ å¹¶æä¾ä¸ä¸ªè®¿é®è¯¥å®ä¾çå¨å±èç¹ã\n\nåä¾ ï¼Singletonï¼ ç±»å£°æäºä¸ä¸ªåä¸º getÂ­Instance è·åå®ä¾çéææ¹æ³æ¥è¿åå¶æå±ç±»çä¸ä¸ªç¸åå®ä¾ã\n\nåä¾çæé å½æ°å¿é¡»å¯¹å®¢æ·ç«¯ ï¼Clientï¼ ä»£ç éèã è°ç¨ getÂ­Instance æ¹æ³å¿é¡»æ¯è·ååä¾å¯¹è±¡çå¯ä¸æ¹å¼ã\n\nææåä¾çå®ç°é½åå«ä»¥ä¸ä¸¤ä¸ªç¸åçæ­¥éª¤ï¼\n\n * å°é»è®¤æé å½æ°è®¾ä¸ºç§æï¼ é²æ­¢å¶ä»å¯¹è±¡ä½¿ç¨åä¾ç±»ç newè¿ç®ç¬¦ã\n * æ°å»ºä¸ä¸ªéææå»ºæ¹æ³ä½ä¸ºæé å½æ°ã è¯¥å½æ°ä¼ âå·å·â è°ç¨ç§ææé å½æ°æ¥åå»ºå¯¹è±¡ï¼ å¹¶å°å¶ä¿å­å¨ä¸ä¸ªéææååéä¸­ã æ­¤åææå¯¹äºè¯¥å½æ°çè°ç¨é½å°è¿åè¿ä¸ç¼å­å¯¹è±¡ã\n\nå¦æä½ çä»£ç è½å¤è®¿é®åä¾ç±»ï¼ é£å®å°±è½è°ç¨åä¾ç±»çéææ¹æ³ã æ è®ºä½æ¶è°ç¨è¯¥æ¹æ³ï¼ å®æ»æ¯ä¼è¿åç¸åçå¯¹è±¡ã\n\nåä¾æ¨¡å¼çä¼ç¹ï¼\n\n * â ä½ å¯ä»¥ä¿è¯ä¸ä¸ªç±»åªæä¸ä¸ªå®ä¾ã\n * â ä½ è·å¾äºä¸ä¸ªæåè¯¥å®ä¾çå¨å±è®¿é®èç¹ã\n * â ä»å¨é¦æ¬¡è¯·æ±åä¾å¯¹è±¡æ¶å¯¹å¶è¿è¡åå§åã\n\nåä¾æ¨¡å¼çç¼ºç¹ï¼\n\n * â è¿åäºåä¸èè´£ååã è¯¥æ¨¡å¼åæ¶è§£å³äºä¸¤ä¸ªé®é¢ã\n * â åä¾æ¨¡å¼å¯è½æ©çä¸è¯è®¾è®¡ï¼ æ¯å¦ç¨åºåç»ä»¶ä¹é´ç¸äºäºè§£è¿å¤ç­ã\n * â è¯¥æ¨¡å¼å¨å¤çº¿ç¨ç¯å¢ä¸éè¦è¿è¡ç¹æ®å¤çï¼ é¿åå¤ä¸ªçº¿ç¨å¤æ¬¡åå»ºåä¾å¯¹è±¡ã\n * â åä¾çå®¢æ·ç«¯ä»£ç ååæµè¯å¯è½ä¼æ¯è¾å°é¾ï¼ å ä¸ºè®¸å¤æµè¯æ¡æ¶ä»¥åºäºç»§æ¿çæ¹å¼åå»ºæ¨¡æå¯¹è±¡ã ç±äºåä¾ç±»çæé å½æ°æ¯ç§æçï¼ èä¸ç»å¤§é¨åè¯­è¨æ æ³éåéææ¹æ³ï¼ æä»¥ä½ éè¦æ³åºä»ç»èèæ¨¡æåä¾çæ¹æ³ã è¦ä¹å¹²èä¸ç¼åæµè¯ä»£ç ï¼ æèä¸ä½¿ç¨åä¾æ¨¡å¼ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æç¨åºä¸­çæä¸ªç±»å¯¹äºææå®¢æ·ç«¯åªæä¸ä¸ªå¯ç¨çå®ä¾ï¼ å¯ä»¥ä½¿ç¨åä¾æ¨¡å¼ã â¡ åä¾æ¨¡å¼ç¦æ­¢éè¿é¤ç¹æ®æå»ºæ¹æ³ä»¥å¤çä»»ä½æ¹å¼æ¥åå»ºèªèº«ç±»çå¯¹è±¡ã è¯¥æ¹æ³å¯ä»¥åå»ºä¸ä¸ªæ°å¯¹è±¡ï¼ ä½å¦æè¯¥å¯¹è±¡å·²ç»è¢«åå»ºï¼ åè¿åå·²æçå¯¹è±¡ã\n * å¦æä½ éè¦æ´å ä¸¥æ ¼å°æ§å¶å¨å±åéï¼ å¯ä»¥ä½¿ç¨åä¾æ¨¡å¼ã â¡ åä¾æ¨¡å¼ä¸å¨å±åéä¸åï¼ å®ä¿è¯ç±»åªå­å¨ä¸ä¸ªå®ä¾ã é¤äºåä¾ç±»èªå·±ä»¥å¤ï¼ æ æ³éè¿ä»»ä½æ¹å¼æ¿æ¢ç¼å­çå®ä¾ã\n\nè¯·æ³¨æï¼ ä½ å¯ä»¥éæ¶è°æ´éå¶å¹¶è®¾å®çæåä¾å®ä¾çæ°éï¼ åªéä¿®æ¹ è·åå®ä¾ æ¹æ³ï¼ å³ getInstance ä¸­çä»£ç å³å¯å®ç°ã\n\nä¸¾ä¾æ¥è¯´ï¼ä¸äºèµæºç®¡çå¨å¸¸å¸¸è®¾è®¡æåä¾æ¨¡å¼ã\n\nå¨è®¡ç®æºç³»ç»ä¸­ï¼éè¦ç®¡ççèµæºåæ¬è½¯ä»¶å¤é¨èµæºï¼è­¬å¦æ¯å°è®¡ç®æºå¯ä»¥æè¥å¹²ä¸ªæå°æºï¼ä½åªè½æä¸ä¸ª Printer Spoolerï¼ ä»¥é¿åä¸¤ä¸ªæå°ä½ä¸åæ¶è¾åºå°æå°æºä¸­ã\n\næ¯å°è®¡ç®æºå¯ä»¥æè¥å¹²éä¿¡ç«¯å£ï¼ç³»ç»åºå½éä¸­ç®¡çè¿äºéä¿¡ç«¯å£ï¼ä»¥é¿åä¸ä¸ªéä¿¡ç«¯å£åæ¶è¢«ä¸¤ä¸ªè¯·æ±åæ¶è°ç¨ãä»»å¡ç®¡çå¨ä¸­é¾ä»¥å¯å¨ä¸¤ä¸ªç¸åç taskã\n\n\n# 3. ç»æ\n\n\n\n 1. åä¾ ï¼Singletonï¼ ç±»å£°æäºä¸ä¸ªåä¸º getÂ­Instanceè·åå®ä¾çéææ¹æ³æ¥è¿åå¶æå±ç±»çä¸ä¸ªç¸åå®ä¾ã\n    * åä¾çæé å½æ°å¿é¡»å¯¹å®¢æ·ç«¯ ï¼Clientï¼ ä»£ç éèã è°ç¨ è·åå®ä¾æ¹æ³å¿é¡»æ¯è·ååä¾å¯¹è±¡çå¯ä¸æ¹å¼ã\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ æ°æ®åºè¿æ¥ç±»å³æ¯ä¸ä¸ªåä¾ã\n\nè¯¥ç±»ä¸æä¾å¬ææé å½æ°ï¼ å æ­¤è·åè¯¥å¯¹è±¡çå¯ä¸æ¹å¼æ¯è°ç¨ è·åå®ä¾æ¹æ³ã è¯¥æ¹æ³å°ç¼å­é¦æ¬¡çæçå¯¹è±¡ï¼ å¹¶ä¸ºææåç»­è°ç¨è¿åè¯¥å¯¹è±¡ã\n\n// æ°æ®åºç±»ä¼å¯¹`getInstanceï¼è·åå®ä¾ï¼`æ¹æ³è¿è¡å®ä¹ä»¥è®©å®¢æ·ç«¯å¨ç¨åºåå¤\n// é½è½è®¿é®ç¸åçæ°æ®åºè¿æ¥å®ä¾ã\nclass Database is\n    // ä¿å­åä¾å®ä¾çæååéå¿é¡»è¢«å£°æä¸ºéæç±»åã\n    private static field instance: Database\n\n    // åä¾çæé å½æ°å¿é¡»æ°¸è¿æ¯ç§æç±»åï¼ä»¥é²æ­¢ä½¿ç¨`new`è¿ç®ç¬¦ç´æ¥è°ç¨æ\n    // é æ¹æ³ã\n    private constructor Database() is\n        // é¨ååå§åä»£ç ï¼ä¾å¦å°æ°æ®åºæå¡å¨çå®éè¿æ¥ï¼ã\n        // ...\n\n    // ç¨äºæ§å¶å¯¹åä¾å®ä¾çè®¿é®æéçéææ¹æ³ã\n    public static method getInstance() is\n        if (Database.instance == null) then\n            acquireThreadLock() and then\n                // ç¡®ä¿å¨è¯¥çº¿ç¨ç­å¾è§£éæ¶ï¼å¶ä»çº¿ç¨æ²¡æåå§åè¯¥å®ä¾ã\n                if (Database.instance == null) then\n                    Database.instance = new Database()\n        return Database.instance\n\n    // æåï¼ä»»ä½åä¾é½å¿é¡»å®ä¹ä¸äºå¯å¨å¶å®ä¾ä¸æ§è¡çä¸å¡é»è¾ã\n    public method query(sql) is\n        // æ¯å¦åºç¨çæææ°æ®åºæ¥è¯¢è¯·æ±é½éè¦éè¿è¯¥æ¹æ³è¿è¡ãå æ­¤ï¼ä½ å¯ä»¥\n        // å¨è¿éæ·»å éæµæç¼å²é»è¾ã\n        // ...\n\nclass Application is\n    method main() is\n        Database foo = Database.getInstance()\n        foo.query("SELECT ...")\n        // ...\n        Database bar = Database.getInstance()\n        bar.query("SELECT ...")\n        // åé `bar` å `foo` ä¸­å°åå«åä¸ä¸ªå¯¹è±¡ã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è®¸å¤å¼åèå°åä¾æ¨¡å¼è§ä¸ºä¸ç§åæ¨¡å¼ã å æ­¤å®å¨ Java ä»£ç ä¸­çä½¿ç¨é¢çæ­£å¨éæ­¥åå°ã\n\nå°½ç®¡å¦æ­¤ï¼ Java æ ¸å¿ç¨åºåºä¸­ä»æç¸å½å¤çåä¾ç¤ºä¾ï¼\n\n * java.lang.Runtime#getRuntime()\n * java.awt.Desktop#getDesktop()\n * java.lang.System#getSecurityManager()\n\nè¯å«æ¹æ³ï¼ åä¾å¯ä»¥éè¿è¿åç¸åç¼å­å¯¹è±¡çéææå»ºæ¹æ³æ¥è¯å«ã\n\n\n# 5.1. æ°æ®åºè¿æ¥ç±»\n\næ°æ®åºè¿æ¥ç±»å³æ¯ä¸ä¸ªåä¾ã\n\nè¯¥ç±»ä¸æä¾å¬ææé å½æ°ï¼ å æ­¤è·åè¯¥å¯¹è±¡çå¯ä¸æ¹å¼æ¯è°ç¨ è·åå®ä¾æ¹æ³ã è¯¥æ¹æ³å°ç¼å­é¦æ¬¡çæçå¯¹è±¡ï¼ å¹¶ä¸ºææåç»­è°ç¨è¿åè¯¥å¯¹è±¡ã\n\n// æ°æ®åºç±»ä¼å¯¹`getInstanceï¼è·åå®ä¾ï¼`æ¹æ³è¿è¡å®ä¹ä»¥è®©å®¢æ·ç«¯å¨ç¨åºåå¤\n// é½è½è®¿é®ç¸åçæ°æ®åºè¿æ¥å®ä¾ã\nclass Database is\n    // ä¿å­åä¾å®ä¾çæååéå¿é¡»è¢«å£°æä¸ºéæç±»åã\n    private static field instance: Database\n\n    // åä¾çæé å½æ°å¿é¡»æ°¸è¿æ¯ç§æç±»åï¼ä»¥é²æ­¢ä½¿ç¨`new`è¿ç®ç¬¦ç´æ¥è°ç¨æ\n    // é æ¹æ³ã\n    private constructor Database() is\n        // é¨ååå§åä»£ç ï¼ä¾å¦å°æ°æ®åºæå¡å¨çå®éè¿æ¥ï¼ã\n        // ...\n\n    // ç¨äºæ§å¶å¯¹åä¾å®ä¾çè®¿é®æéçéææ¹æ³ã\n    public static method getInstance() is\n        if (Database.instance == null) then\n            acquireThreadLock() and then\n                // ç¡®ä¿å¨è¯¥çº¿ç¨ç­å¾è§£éæ¶ï¼å¶ä»çº¿ç¨æ²¡æåå§åè¯¥å®ä¾ã\n                if (Database.instance == null) then\n                    Database.instance = new Database()\n        return Database.instance\n\n    // æåï¼ä»»ä½åä¾é½å¿é¡»å®ä¹ä¸äºå¯å¨å¶å®ä¾ä¸æ§è¡çä¸å¡é»è¾ã\n    public method query(sql) is\n        // æ¯å¦åºç¨çæææ°æ®åºæ¥è¯¢è¯·æ±é½éè¦éè¿è¯¥æ¹æ³è¿è¡ãå æ­¤ï¼ä½ å¯ä»¥\n        // å¨è¿éæ·»å éæµæç¼å²é»è¾ã\n        // ...\n\nclass Application is\n    method main() is\n        Database foo = Database.getInstance()\n        foo.query("SELECT ...")\n        // ...\n        Database bar = Database.getInstance()\n        bar.query("SELECT ...")\n        // åé `bar` å `foo` ä¸­å°åå«åä¸ä¸ªå¯¹è±¡ã\n\n\n\n# 5.2. ææ±å¼\n\nææ±å¼çå®ç°æè·¯æ¯ï¼ä½ ä¸æ¾ææ±ï¼ææ±æ ¹æ¬å°±æå¾å»åå§åèªå·±ã\n\ninstance åå§æ¶æ²¡æåå§åï¼åªæå½ç¬¬ä¸æ¬¡è° getInstance() æ¶æåå»ºå®ä¾ã\n\nç¼ºç¹ï¼å½æä¸¤ä¸ªçº¿ç¨è° getInstance() æ¹æ³ï¼å½å®ä»¬åæ¶æ§è¡å° if (null == instance) è¿è¡ä»£ç ï¼instance ä¸º nullã\n\nç»§ç»­åä¸æ§è¡ï¼ä¼çæä¸¤ä¸ªå®ä¾ï¼è¿èäºåä¾æ¨¡å¼çåè¡·ã\n\npublic class LazySingleton {\n    private LazySingleton() {\n        System.out.println("Singleton()");\n    }\n\n    private static LazySingleton instance = null;\n\n    public static LazySingleton getInstance() {\n        if (null == instance) {\n            instance = new LazySingleton();\n        }\n        return instance;\n    }\n}\n\n\n\n# 5.3. é¥¿æ±å¼\n\nææ±å¼çå®ç°æè·¯æ¯ï¼é¥¿æ±æ ¹æ¬ç­ä¸åå«äººæ¥æ¾ä»ï¼ä¸ç®¡ä¸ä¸äºåä¸ååå§åäºèªèº«çå®ä¾ï¼çæèªå·±é¥¿çäºã\n\nç±»é»è®¤åç´æ¥åå§åä¸ä¸ªå®ä¾ï¼ä»¥åè°ç¨ getInstance() æ»æ¯è¿åè¿ä¸ªå·²åå»ºå¥½çå®ä¾ã\n\nç¼ºç¹ï¼å¨æ²¡æå¿è¦è·åå®ä¾æ¶ï¼å·²ç»é¢åäº§çäºå¼éã\n\nä¼ç¹ï¼è§é¿äºææ±å¼æ¹æ³ççº¿ç¨é®é¢ï¼ä¸ç¨æ¾ç¤ºç¼åçº¿ç¨å®å¨ä»£ç ã\n\npublic class HungerSinleton {\n    private HungerSinleton() {\n        System.out.println("Singleton()");\n    }\n\n    private static HungerSinleton instance = new HungerSinleton();\n\n    public static HungerSinleton getInstance() {\n        return instance;\n    }\n}\n\n\n\n# 5.4. åééçå½¢å¼\n\nå¦ææ¢ä¸æ³å¨æ²¡æè°ç¨ getInstance() æ¹æ³æ¶äº§çå¼éï¼åä¸æ³åççº¿ç¨å®å¨é®é¢ï¼å°±å¯ä»¥éç¨åééçå½¢å¼ã\n\npublic class SyncSingleton {\n    private SyncSingleton() {\n        System.out.println("Singleton()");\n    }\n\n    private static SyncSingleton instance = null;\n\n    public static SyncSingleton getInstance() {\n        if (null == instance) {\n            synchronized(SyncSingleton.class) {\n                if (null == instance) {\n                    instance = new SyncSingleton();\n                }\n            }\n        }\n        return instance;\n    }\n}\n\n\n> æ³¨ï¼å¨å¤é¢å¤æ­äº instance å®ä¾æ¯å¦å­å¨ï¼ä¸ºä»ä¹å¨éå®ååè¦å¨åé¨åå¤æ­ä¸æ¬¡ï¼\n> \n> è¿æ¯å ä¸ºï¼å¦æ instance ä¸º null æ¶æä¸¤ä¸ªçº¿ç¨åæ¶è°ç¨ getInstance()ï¼ç±äº synchronized æºå¶ï¼åªåè®¸ä¸ä¸ªçº¿ç¨è¿å¥ï¼å¦ä¸ä¸ªéè¦ç­å¾ã\n> \n> è¿æ¶å¦ææ²¡æç¬¬äºé instance æ¯å¦ä¸º null çå¤æ­ï¼å°±å¯è½åçç¬¬ä¸ä¸ªçº¿ç¨åå»ºä¸ä¸ªå®ä¾ï¼èç¬¬äºä¸ªçº¿ç¨ååå»ºä¸ä¸ªå®ä¾çæåµã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¤è§æ¨¡å¼ç±»éå¸¸å¯ä»¥è½¬æ¢ä¸ºåä¾æ¨¡å¼ç±»ï¼ å ä¸ºå¨å¤§é¨åæåµä¸ä¸ä¸ªå¤è§å¯¹è±¡å°±è¶³å¤äºã\n * å¦æä½ è½å°å¯¹è±¡çææå±äº«ç¶æç®åä¸ºä¸ä¸ªäº«åå¯¹è±¡ï¼ é£ä¹äº«åæ¨¡å¼å°±ååä¾ç±»ä¼¼äºã ä½è¿ä¸¤ä¸ªæ¨¡å¼æä¸¤ä¸ªæ ¹æ¬æ§çä¸åã\n   1. åªä¼æä¸ä¸ªåä¾å®ä½ï¼ ä½æ¯äº«åç±»å¯ä»¥æå¤ä¸ªå®ä½ï¼ åå®ä½çåå¨ç¶æä¹å¯ä»¥ä¸åã\n   2. åä¾å¯¹è±¡å¯ä»¥æ¯å¯åçã äº«åå¯¹è±¡æ¯ä¸å¯åçã\n * æ½è±¡å·¥åæ¨¡å¼ã çæå¨æ¨¡å¼åååæ¨¡å¼é½å¯ä»¥ç¨åä¾æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹åä¾æ¨¡å¼\n\n\n# 1. æå¾\n\nåä¾æ¨¡å¼ï¼singletonï¼æ¯ä¸ç§åå»ºåè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¤ä¿è¯ä¸ä¸ªç±»åªæä¸ä¸ªå®ä¾ï¼ å¹¶æä¾ä¸ä¸ªè®¿é®è¯¥å®ä¾çå¨å±èç¹ã\n\nåä¾ ï¼singletonï¼ ç±»å£°æäºä¸ä¸ªåä¸º getÂ­instance è·åå®ä¾çéææ¹æ³æ¥è¿åå¶æå±ç±»çä¸ä¸ªç¸åå®ä¾ã\n\nåä¾çæé å½æ°å¿é¡»å¯¹å®¢æ·ç«¯ ï¼clientï¼ ä»£ç éèã è°ç¨ getÂ­instance æ¹æ³å¿é¡»æ¯è·ååä¾å¯¹è±¡çå¯ä¸æ¹å¼ã\n\nææåä¾çå®ç°é½åå«ä»¥ä¸ä¸¤ä¸ªç¸åçæ­¥éª¤ï¼\n\n * å°é»è®¤æé å½æ°è®¾ä¸ºç§æï¼ é²æ­¢å¶ä»å¯¹è±¡ä½¿ç¨åä¾ç±»ç newè¿ç®ç¬¦ã\n * æ°å»ºä¸ä¸ªéææå»ºæ¹æ³ä½ä¸ºæé å½æ°ã è¯¥å½æ°ä¼ âå·å·â è°ç¨ç§ææé å½æ°æ¥åå»ºå¯¹è±¡ï¼ å¹¶å°å¶ä¿å­å¨ä¸ä¸ªéææååéä¸­ã æ­¤åææå¯¹äºè¯¥å½æ°çè°ç¨é½å°è¿åè¿ä¸ç¼å­å¯¹è±¡ã\n\nå¦æä½ çä»£ç è½å¤è®¿é®åä¾ç±»ï¼ é£å®å°±è½è°ç¨åä¾ç±»çéææ¹æ³ã æ è®ºä½æ¶è°ç¨è¯¥æ¹æ³ï¼ å®æ»æ¯ä¼è¿åç¸åçå¯¹è±¡ã\n\nåä¾æ¨¡å¼çä¼ç¹ï¼\n\n * â ä½ å¯ä»¥ä¿è¯ä¸ä¸ªç±»åªæä¸ä¸ªå®ä¾ã\n * â ä½ è·å¾äºä¸ä¸ªæåè¯¥å®ä¾çå¨å±è®¿é®èç¹ã\n * â ä»å¨é¦æ¬¡è¯·æ±åä¾å¯¹è±¡æ¶å¯¹å¶è¿è¡åå§åã\n\nåä¾æ¨¡å¼çç¼ºç¹ï¼\n\n * â è¿åäºåä¸èè´£ååã è¯¥æ¨¡å¼åæ¶è§£å³äºä¸¤ä¸ªé®é¢ã\n * â åä¾æ¨¡å¼å¯è½æ©çä¸è¯è®¾è®¡ï¼ æ¯å¦ç¨åºåç»ä»¶ä¹é´ç¸äºäºè§£è¿å¤ç­ã\n * â è¯¥æ¨¡å¼å¨å¤çº¿ç¨ç¯å¢ä¸éè¦è¿è¡ç¹æ®å¤çï¼ é¿åå¤ä¸ªçº¿ç¨å¤æ¬¡åå»ºåä¾å¯¹è±¡ã\n * â åä¾çå®¢æ·ç«¯ä»£ç ååæµè¯å¯è½ä¼æ¯è¾å°é¾ï¼ å ä¸ºè®¸å¤æµè¯æ¡æ¶ä»¥åºäºç»§æ¿çæ¹å¼åå»ºæ¨¡æå¯¹è±¡ã ç±äºåä¾ç±»çæé å½æ°æ¯ç§æçï¼ èä¸ç»å¤§é¨åè¯­è¨æ æ³éåéææ¹æ³ï¼ æä»¥ä½ éè¦æ³åºä»ç»èèæ¨¡æåä¾çæ¹æ³ã è¦ä¹å¹²èä¸ç¼åæµè¯ä»£ç ï¼ æèä¸ä½¿ç¨åä¾æ¨¡å¼ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æç¨åºä¸­çæä¸ªç±»å¯¹äºææå®¢æ·ç«¯åªæä¸ä¸ªå¯ç¨çå®ä¾ï¼ å¯ä»¥ä½¿ç¨åä¾æ¨¡å¼ã â¡ åä¾æ¨¡å¼ç¦æ­¢éè¿é¤ç¹æ®æå»ºæ¹æ³ä»¥å¤çä»»ä½æ¹å¼æ¥åå»ºèªèº«ç±»çå¯¹è±¡ã è¯¥æ¹æ³å¯ä»¥åå»ºä¸ä¸ªæ°å¯¹è±¡ï¼ ä½å¦æè¯¥å¯¹è±¡å·²ç»è¢«åå»ºï¼ åè¿åå·²æçå¯¹è±¡ã\n * å¦æä½ éè¦æ´å ä¸¥æ ¼å°æ§å¶å¨å±åéï¼ å¯ä»¥ä½¿ç¨åä¾æ¨¡å¼ã â¡ åä¾æ¨¡å¼ä¸å¨å±åéä¸åï¼ å®ä¿è¯ç±»åªå­å¨ä¸ä¸ªå®ä¾ã é¤äºåä¾ç±»èªå·±ä»¥å¤ï¼ æ æ³éè¿ä»»ä½æ¹å¼æ¿æ¢ç¼å­çå®ä¾ã\n\nè¯·æ³¨æï¼ ä½ å¯ä»¥éæ¶è°æ´éå¶å¹¶è®¾å®çæåä¾å®ä¾çæ°éï¼ åªéä¿®æ¹ è·åå®ä¾ æ¹æ³ï¼ å³ getinstance ä¸­çä»£ç å³å¯å®ç°ã\n\nä¸¾ä¾æ¥è¯´ï¼ä¸äºèµæºç®¡çå¨å¸¸å¸¸è®¾è®¡æåä¾æ¨¡å¼ã\n\nå¨è®¡ç®æºç³»ç»ä¸­ï¼éè¦ç®¡ççèµæºåæ¬è½¯ä»¶å¤é¨èµæºï¼è­¬å¦æ¯å°è®¡ç®æºå¯ä»¥æè¥å¹²ä¸ªæå°æºï¼ä½åªè½æä¸ä¸ª printer spoolerï¼ ä»¥é¿åä¸¤ä¸ªæå°ä½ä¸åæ¶è¾åºå°æå°æºä¸­ã\n\næ¯å°è®¡ç®æºå¯ä»¥æè¥å¹²éä¿¡ç«¯å£ï¼ç³»ç»åºå½éä¸­ç®¡çè¿äºéä¿¡ç«¯å£ï¼ä»¥é¿åä¸ä¸ªéä¿¡ç«¯å£åæ¶è¢«ä¸¤ä¸ªè¯·æ±åæ¶è°ç¨ãä»»å¡ç®¡çå¨ä¸­é¾ä»¥å¯å¨ä¸¤ä¸ªç¸åç taskã\n\n\n# 3. ç»æ\n\n\n\n 1. åä¾ ï¼singletonï¼ ç±»å£°æäºä¸ä¸ªåä¸º getÂ­instanceè·åå®ä¾çéææ¹æ³æ¥è¿åå¶æå±ç±»çä¸ä¸ªç¸åå®ä¾ã\n    * åä¾çæé å½æ°å¿é¡»å¯¹å®¢æ·ç«¯ ï¼clientï¼ ä»£ç éèã è°ç¨ è·åå®ä¾æ¹æ³å¿é¡»æ¯è·ååä¾å¯¹è±¡çå¯ä¸æ¹å¼ã\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ æ°æ®åºè¿æ¥ç±»å³æ¯ä¸ä¸ªåä¾ã\n\nè¯¥ç±»ä¸æä¾å¬ææé å½æ°ï¼ å æ­¤è·åè¯¥å¯¹è±¡çå¯ä¸æ¹å¼æ¯è°ç¨ è·åå®ä¾æ¹æ³ã è¯¥æ¹æ³å°ç¼å­é¦æ¬¡çæçå¯¹è±¡ï¼ å¹¶ä¸ºææåç»­è°ç¨è¿åè¯¥å¯¹è±¡ã\n\n// æ°æ®åºç±»ä¼å¯¹`getinstanceï¼è·åå®ä¾ï¼`æ¹æ³è¿è¡å®ä¹ä»¥è®©å®¢æ·ç«¯å¨ç¨åºåå¤\n// é½è½è®¿é®ç¸åçæ°æ®åºè¿æ¥å®ä¾ã\nclass database is\n    // ä¿å­åä¾å®ä¾çæååéå¿é¡»è¢«å£°æä¸ºéæç±»åã\n    private static field instance: database\n\n    // åä¾çæé å½æ°å¿é¡»æ°¸è¿æ¯ç§æç±»åï¼ä»¥é²æ­¢ä½¿ç¨`new`è¿ç®ç¬¦ç´æ¥è°ç¨æ\n    // é æ¹æ³ã\n    private constructor database() is\n        // é¨ååå§åä»£ç ï¼ä¾å¦å°æ°æ®åºæå¡å¨çå®éè¿æ¥ï¼ã\n        // ...\n\n    // ç¨äºæ§å¶å¯¹åä¾å®ä¾çè®¿é®æéçéææ¹æ³ã\n    public static method getinstance() is\n        if (database.instance == null) then\n            acquirethreadlock() and then\n                // ç¡®ä¿å¨è¯¥çº¿ç¨ç­å¾è§£éæ¶ï¼å¶ä»çº¿ç¨æ²¡æåå§åè¯¥å®ä¾ã\n                if (database.instance == null) then\n                    database.instance = new database()\n        return database.instance\n\n    // æåï¼ä»»ä½åä¾é½å¿é¡»å®ä¹ä¸äºå¯å¨å¶å®ä¾ä¸æ§è¡çä¸å¡é»è¾ã\n    public method query(sql) is\n        // æ¯å¦åºç¨çæææ°æ®åºæ¥è¯¢è¯·æ±é½éè¦éè¿è¯¥æ¹æ³è¿è¡ãå æ­¤ï¼ä½ å¯ä»¥\n        // å¨è¿éæ·»å éæµæç¼å²é»è¾ã\n        // ...\n\nclass application is\n    method main() is\n        database foo = database.getinstance()\n        foo.query("select ...")\n        // ...\n        database bar = database.getinstance()\n        bar.query("select ...")\n        // åé `bar` å `foo` ä¸­å°åå«åä¸ä¸ªå¯¹è±¡ã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è®¸å¤å¼åèå°åä¾æ¨¡å¼è§ä¸ºä¸ç§åæ¨¡å¼ã å æ­¤å®å¨ java ä»£ç ä¸­çä½¿ç¨é¢çæ­£å¨éæ­¥åå°ã\n\nå°½ç®¡å¦æ­¤ï¼ java æ ¸å¿ç¨åºåºä¸­ä»æç¸å½å¤çåä¾ç¤ºä¾ï¼\n\n * java.lang.runtime#getruntime()\n * java.awt.desktop#getdesktop()\n * java.lang.system#getsecuritymanager()\n\nè¯å«æ¹æ³ï¼ åä¾å¯ä»¥éè¿è¿åç¸åç¼å­å¯¹è±¡çéææå»ºæ¹æ³æ¥è¯å«ã\n\n\n# 5.1. æ°æ®åºè¿æ¥ç±»\n\næ°æ®åºè¿æ¥ç±»å³æ¯ä¸ä¸ªåä¾ã\n\nè¯¥ç±»ä¸æä¾å¬ææé å½æ°ï¼ å æ­¤è·åè¯¥å¯¹è±¡çå¯ä¸æ¹å¼æ¯è°ç¨ è·åå®ä¾æ¹æ³ã è¯¥æ¹æ³å°ç¼å­é¦æ¬¡çæçå¯¹è±¡ï¼ å¹¶ä¸ºææåç»­è°ç¨è¿åè¯¥å¯¹è±¡ã\n\n// æ°æ®åºç±»ä¼å¯¹`getinstanceï¼è·åå®ä¾ï¼`æ¹æ³è¿è¡å®ä¹ä»¥è®©å®¢æ·ç«¯å¨ç¨åºåå¤\n// é½è½è®¿é®ç¸åçæ°æ®åºè¿æ¥å®ä¾ã\nclass database is\n    // ä¿å­åä¾å®ä¾çæååéå¿é¡»è¢«å£°æä¸ºéæç±»åã\n    private static field instance: database\n\n    // åä¾çæé å½æ°å¿é¡»æ°¸è¿æ¯ç§æç±»åï¼ä»¥é²æ­¢ä½¿ç¨`new`è¿ç®ç¬¦ç´æ¥è°ç¨æ\n    // é æ¹æ³ã\n    private constructor database() is\n        // é¨ååå§åä»£ç ï¼ä¾å¦å°æ°æ®åºæå¡å¨çå®éè¿æ¥ï¼ã\n        // ...\n\n    // ç¨äºæ§å¶å¯¹åä¾å®ä¾çè®¿é®æéçéææ¹æ³ã\n    public static method getinstance() is\n        if (database.instance == null) then\n            acquirethreadlock() and then\n                // ç¡®ä¿å¨è¯¥çº¿ç¨ç­å¾è§£éæ¶ï¼å¶ä»çº¿ç¨æ²¡æåå§åè¯¥å®ä¾ã\n                if (database.instance == null) then\n                    database.instance = new database()\n        return database.instance\n\n    // æåï¼ä»»ä½åä¾é½å¿é¡»å®ä¹ä¸äºå¯å¨å¶å®ä¾ä¸æ§è¡çä¸å¡é»è¾ã\n    public method query(sql) is\n        // æ¯å¦åºç¨çæææ°æ®åºæ¥è¯¢è¯·æ±é½éè¦éè¿è¯¥æ¹æ³è¿è¡ãå æ­¤ï¼ä½ å¯ä»¥\n        // å¨è¿éæ·»å éæµæç¼å²é»è¾ã\n        // ...\n\nclass application is\n    method main() is\n        database foo = database.getinstance()\n        foo.query("select ...")\n        // ...\n        database bar = database.getinstance()\n        bar.query("select ...")\n        // åé `bar` å `foo` ä¸­å°åå«åä¸ä¸ªå¯¹è±¡ã\n\n\n\n# 5.2. ææ±å¼\n\nææ±å¼çå®ç°æè·¯æ¯ï¼ä½ ä¸æ¾ææ±ï¼ææ±æ ¹æ¬å°±æå¾å»åå§åèªå·±ã\n\ninstance åå§æ¶æ²¡æåå§åï¼åªæå½ç¬¬ä¸æ¬¡è° getinstance() æ¶æåå»ºå®ä¾ã\n\nç¼ºç¹ï¼å½æä¸¤ä¸ªçº¿ç¨è° getinstance() æ¹æ³ï¼å½å®ä»¬åæ¶æ§è¡å° if (null == instance) è¿è¡ä»£ç ï¼instance ä¸º nullã\n\nç»§ç»­åä¸æ§è¡ï¼ä¼çæä¸¤ä¸ªå®ä¾ï¼è¿èäºåä¾æ¨¡å¼çåè¡·ã\n\npublic class lazysingleton {\n    private lazysingleton() {\n        system.out.println("singleton()");\n    }\n\n    private static lazysingleton instance = null;\n\n    public static lazysingleton getinstance() {\n        if (null == instance) {\n            instance = new lazysingleton();\n        }\n        return instance;\n    }\n}\n\n\n\n# 5.3. é¥¿æ±å¼\n\nææ±å¼çå®ç°æè·¯æ¯ï¼é¥¿æ±æ ¹æ¬ç­ä¸åå«äººæ¥æ¾ä»ï¼ä¸ç®¡ä¸ä¸äºåä¸ååå§åäºèªèº«çå®ä¾ï¼çæèªå·±é¥¿çäºã\n\nç±»é»è®¤åç´æ¥åå§åä¸ä¸ªå®ä¾ï¼ä»¥åè°ç¨ getinstance() æ»æ¯è¿åè¿ä¸ªå·²åå»ºå¥½çå®ä¾ã\n\nç¼ºç¹ï¼å¨æ²¡æå¿è¦è·åå®ä¾æ¶ï¼å·²ç»é¢åäº§çäºå¼éã\n\nä¼ç¹ï¼è§é¿äºææ±å¼æ¹æ³ççº¿ç¨é®é¢ï¼ä¸ç¨æ¾ç¤ºç¼åçº¿ç¨å®å¨ä»£ç ã\n\npublic class hungersinleton {\n    private hungersinleton() {\n        system.out.println("singleton()");\n    }\n\n    private static hungersinleton instance = new hungersinleton();\n\n    public static hungersinleton getinstance() {\n        return instance;\n    }\n}\n\n\n\n# 5.4. åééçå½¢å¼\n\nå¦ææ¢ä¸æ³å¨æ²¡æè°ç¨ getinstance() æ¹æ³æ¶äº§çå¼éï¼åä¸æ³åççº¿ç¨å®å¨é®é¢ï¼å°±å¯ä»¥éç¨åééçå½¢å¼ã\n\npublic class syncsingleton {\n    private syncsingleton() {\n        system.out.println("singleton()");\n    }\n\n    private static syncsingleton instance = null;\n\n    public static syncsingleton getinstance() {\n        if (null == instance) {\n            synchronized(syncsingleton.class) {\n                if (null == instance) {\n                    instance = new syncsingleton();\n                }\n            }\n        }\n        return instance;\n    }\n}\n\n\n> æ³¨ï¼å¨å¤é¢å¤æ­äº instance å®ä¾æ¯å¦å­å¨ï¼ä¸ºä»ä¹å¨éå®ååè¦å¨åé¨åå¤æ­ä¸æ¬¡ï¼\n> \n> è¿æ¯å ä¸ºï¼å¦æ instance ä¸º null æ¶æä¸¤ä¸ªçº¿ç¨åæ¶è°ç¨ getinstance()ï¼ç±äº synchronized æºå¶ï¼åªåè®¸ä¸ä¸ªçº¿ç¨è¿å¥ï¼å¦ä¸ä¸ªéè¦ç­å¾ã\n> \n> è¿æ¶å¦ææ²¡æç¬¬äºé instance æ¯å¦ä¸º null çå¤æ­ï¼å°±å¯è½åçç¬¬ä¸ä¸ªçº¿ç¨åå»ºä¸ä¸ªå®ä¾ï¼èç¬¬äºä¸ªçº¿ç¨ååå»ºä¸ä¸ªå®ä¾çæåµã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¤è§æ¨¡å¼ç±»éå¸¸å¯ä»¥è½¬æ¢ä¸ºåä¾æ¨¡å¼ç±»ï¼ å ä¸ºå¨å¤§é¨åæåµä¸ä¸ä¸ªå¤è§å¯¹è±¡å°±è¶³å¤äºã\n * å¦æä½ è½å°å¯¹è±¡çææå±äº«ç¶æç®åä¸ºä¸ä¸ªäº«åå¯¹è±¡ï¼ é£ä¹äº«åæ¨¡å¼å°±ååä¾ç±»ä¼¼äºã ä½è¿ä¸¤ä¸ªæ¨¡å¼æä¸¤ä¸ªæ ¹æ¬æ§çä¸åã\n   1. åªä¼æä¸ä¸ªåä¾å®ä½ï¼ ä½æ¯äº«åç±»å¯ä»¥æå¤ä¸ªå®ä½ï¼ åå®ä½çåå¨ç¶æä¹å¯ä»¥ä¸åã\n   2. åä¾å¯¹è±¡å¯ä»¥æ¯å¯åçã äº«åå¯¹è±¡æ¯ä¸å¯åçã\n * æ½è±¡å·¥åæ¨¡å¼ã çæå¨æ¨¡å¼åååæ¨¡å¼é½å¯ä»¥ç¨åä¾æ¥å®ç°ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ééå¨æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ééå¨æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-14T18:31:00.000Z",permalink:"/pages/2c4733/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/07.%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/07.ééå¨æ¨¡å¼.md",key:"v-b5457c16",path:"/pages/2c4733/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:258},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:392},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:435},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:816},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1423},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:2771},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:3207},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:3637}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ééå¨æ¨¡å¼\n\n\n# 1. æå¾\n\nééå¨æ¨¡å¼ (Adapter)æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ å®è½ä½¿ä¸å¼å®¹çå¯¹è±¡è½å¤ç¸äºåä½ã\n\nééå¨æ¨¡å¼éè¿å°è£å¯¹è±¡å°å¤æçè½¬æ¢è¿ç¨éèäºå¹åã è¢«å°è£çå¯¹è±¡çè³å¯è§ä¸å°ééå¨çå­å¨ã\n\nééå¨ä¸ä»å¯ä»¥è½¬æ¢ä¸åæ ¼å¼çæ°æ®ï¼ å¶è¿æå©äºéç¨ä¸åæ¥å£çå¯¹è±¡ä¹é´çåä½ã å®çè¿ä½æ¹å¼å¦ä¸ï¼\n\n * ééå¨å®ç°ä¸å¶ä¸­ä¸ä¸ªç°æå¯¹è±¡å¼å®¹çæ¥å£ã\n * ç°æå¯¹è±¡å¯ä»¥ä½¿ç¨è¯¥æ¥å£å®å¨å°è°ç¨ééå¨æ¹æ³ã\n * ééå¨æ¹æ³è¢«è°ç¨åå°ä»¥å¦ä¸ä¸ªå¯¹è±¡å¼å®¹çæ ¼å¼åé¡ºåºå°è¯·æ±ä¼ éç»è¯¥å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ å¸æä½¿ç¨æä¸ªç±»ï¼ ä½æ¯å¶æ¥å£ä¸å¶ä»ä»£ç ä¸å¼å®¹æ¶ï¼ å¯ä»¥ä½¿ç¨ééå¨ç±»ã\n * å¦ææ¨éè¦å¤ç¨è¿æ ·ä¸äºç±»ï¼ ä»ä»¬å¤äºåä¸ä¸ªç»§æ¿ä½ç³»ï¼ å¹¶ä¸ä»ä»¬åæäºé¢å¤çä¸äºå±åçæ¹æ³ï¼ ä½æ¯è¿äºå±åçæ¹æ³ä¸æ¯ææå¨è¿ä¸ç»§æ¿ä½ç³»ä¸­çå­ç±»æå·æçå±æ§ã\n\n\n# 3. ç»æ\n\nééå¨å®ç°äºå¶ä¸­ä¸ä¸ªå¯¹è±¡çæ¥å£ï¼ å¹¶å¯¹å¦ä¸ä¸ªå¯¹è±¡è¿è¡å°è£ã\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. å®¢æ·ç«¯ ï¼Clientï¼ æ¯åå«å½åç¨åºä¸å¡é»è¾çç±»ã\n 2. å®¢æ·ç«¯æ¥å£ ï¼Client Interfaceï¼ æè¿°äºå¶ä»ç±»ä¸å®¢æ·ç«¯ä»£ç åä½æ¶å¿é¡»éµå¾ªçåè®®ã\n 3. æå¡ ï¼Serviceï¼ ä¸­æä¸äºåè½ç±» ï¼éå¸¸æ¥èªç¬¬ä¸æ¹æéçç³»ç»ï¼ã å®¢æ·ç«¯ä¸å¶æ¥å£ä¸å¼å®¹ï¼ å æ­¤æ æ³ç´æ¥è°ç¨å¶åè½ã\n 4. ééå¨ ï¼Adapterï¼ æ¯ä¸ä¸ªå¯ä»¥åæ¶ä¸å®¢æ·ç«¯åæå¡äº¤äºçç±»ï¼ å®å¨å®ç°å®¢æ·ç«¯æ¥å£çåæ¶å°è£äºæå¡å¯¹è±¡ã ééå¨æ¥åå®¢æ·ç«¯éè¿ééå¨æ¥å£åèµ·çè°ç¨ï¼ å¹¶å°å¶è½¬æ¢ä¸ºéç¨äºè¢«å°è£æå¡å¯¹è±¡çè°ç¨ã\n 5. å®¢æ·ç«¯ä»£ç åªééè¿æ¥å£ä¸ééå¨äº¤äºå³å¯ï¼ æ éä¸å·ä½çééå¨ç±»è¦åã å æ­¤ï¼ ä½ å¯ä»¥åç¨åºä¸­æ·»å æ°ç±»åçééå¨èæ éä¿®æ¹å·²æä»£ç ã è¿å¨æå¡ç±»çæ¥å£è¢«æ´æ¹ææ¿æ¢æ¶å¾æç¨ï¼ ä½ æ éä¿®æ¹å®¢æ·ç«¯ä»£ç å°±å¯ä»¥åå»ºæ°çééå¨ç±»ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãTargetã\n\nå®ä¹ç¨æ·å®ééè¦çæ¥å£ã\n\nabstract class Target {\n    public abstract void Request();\n}\n\n\nãAdapteeã\n\nå®ä¹ä¸ä¸ªéè¦ééçæ¥å£ã\n\nclass Adaptee {\n    public void SpecificRequest() {\n        System.out.println("ç¹æ®è¯·æ±");\n    }\n}\n\n\nãAdapterã\n\néè¿å¨åé¨åè£ä¸ä¸ª Adaptee å¯¹è±¡ï¼ææºæ¥å£è½¬æ¢æç®æ æ¥å£ã\n\nclass Adapter extends Target {\n    private Adaptee adaptee = new Adaptee();\n\n    @Override\n    public void Request() {\n        adaptee.SpecificRequest();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class AdapterPattern {\n    public static void main(String[] args) {\n        Target target = new Adapter();\n        target.Request();\n    }\n}\n\n\nãè¾åºã\n\nç¹æ®è¯·æ±\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nééå¨åæ®æä¸ä¸ªåé ï¼RoundÂ­Pegï¼ï¼ å¶åå¾ç­äºæ¹é ï¼SquareÂ­Pegï¼ æ¨ªæªé¢å¯¹è§çº¿çä¸å ï¼å³è½å¤å®¹çº³æ¹éçæå°å¤æ¥åçåå¾ï¼ã\n\n// åè®¾ä½ æä¸¤ä¸ªæ¥å£ç¸äºå¼å®¹çç±»ï¼åå­ï¼RoundÂ­Holeï¼ååéï¼RoundÂ­Pegï¼ã\nclass RoundHole is\n    constructor RoundHole(radius) { ... }\n\n    method getRadius() is\n        // è¿åå­çåå¾ã\n\n    method fits(peg: RoundPeg) is\n        return this.getRadius() >= peg.getRadius()\n\nclass RoundPeg is\n    constructor RoundPeg(radius) { ... }\n\n    method getRadius() is\n        // è¿åéå­çåå¾ã\n\n\n// ä½è¿æä¸ä¸ªä¸å¼å®¹çç±»ï¼æ¹éï¼SquareÂ­Pegï¼ã\nclass SquarePeg is\n    constructor SquarePeg(width) { ... }\n\n    method getWidth() is\n        // è¿åæ¹éçå®½åº¦ã\n\n\n// ééå¨ç±»è®©ä½ è½å¤å°æ¹éæ¾å¥åå­ä¸­ãå®ä¼å¯¹ RoundPeg ç±»è¿è¡æ©å±ï¼ä»¥æ¥æ¶é\n// éå¨å¯¹è±¡ä½ä¸ºåéã\nclass SquarePegAdapter extends RoundPeg is\n    // å¨å®éæåµä¸­ï¼ééå¨ä¸­ä¼åå«ä¸ä¸ª SquarePeg ç±»çå®ä¾ã\n    private field peg: SquarePeg\n\n    constructor SquarePegAdapter(peg: SquarePeg) is\n        this.peg = peg\n\n    method getRadius() is\n        // ééå¨ä¼åæ®ä¸ºä¸ä¸ªåéï¼\n        // å¶åå¾åå¥½è½ä¸ééå¨å®éå°è£çæ¹éæ­éèµ·æ¥ã\n        return peg.getWidth() * Math.sqrt(2) / 2\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\nhole = new RoundHole(5)\nrpeg = new RoundPeg(5)\nhole.fits(rpeg) // true\n\nsmall_sqpeg = new SquarePeg(5)\nlarge_sqpeg = new SquarePeg(10)\nhole.fits(small_sqpeg) // æ­¤å¤æ æ³ç¼è¯ï¼ç±»åä¸ä¸è´ï¼ã\n\nsmall_sqpeg_adapter = new SquarePegAdapter(small_sqpeg)\nlarge_sqpeg_adapter = new SquarePegAdapter(large_sqpeg)\nhole.fits(small_sqpeg_adapter) // true\nhole.fits(large_sqpeg_adapter) // false\n\n\n\n# 5. æ¡ä¾\n\nééå¨æ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§ã\n\nJava æ ¸å¿ç¨åºåºä¸­æä¸äºæ åçééå¨ï¼\n\n * java.util.Arrays#asList()\n * java.util.Collections#list()\n * java.util.Collections#enumeration()\n * java.io.InputStreamReader(InputStream) ï¼è¿å Readerå¯¹è±¡ï¼\n * java.io.OutputStreamWriter(OutputStream) ï¼è¿å Writerå¯¹è±¡ï¼\n * javax.xml.bind.annotation.adapters.XmlAdapter#marshal() å #unmarshal()\n\nè¯å«æ¹æ³ï¼ ééå¨å¯ä»¥éè¿ä»¥ä¸åæ½è±¡ææ¥å£ç±»åå®ä¾ä¸ºåæ°çæé å½æ°æ¥è¯å«ã å½ééå¨çä»»ä½æ¹æ³è¢«è°ç¨æ¶ï¼ å®ä¼å°åæ°è½¬æ¢ä¸ºåéçæ ¼å¼ï¼ ç¶åå°è°ç¨å®åå°å¶å°è£å¯¹è±¡ä¸­çä¸ä¸ªæå¤ä¸ªæ¹æ³ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼éå¸¸ä¼äºå¼ååæè¿è¡è®¾è®¡ï¼ ä½¿ä½ è½å¤å°ç¨åºçåä¸ªé¨åç¬ç«å¼æ¥ä»¥ä¾¿å¼åã å¦ä¸æ¹é¢ï¼ ééå¨æ¨¡å¼éå¸¸å¨å·²æç¨åºä¸­ä½¿ç¨ï¼ è®©ç¸äºä¸å¼å®¹çç±»è½å¾å¥½å°åä½ã\n * ééå¨å¯ä»¥å¯¹å·²æå¯¹è±¡çæ¥å£è¿è¡ä¿®æ¹ï¼ è£é¥°æ¨¡å¼åè½å¨ä¸æ¹åå¯¹è±¡æ¥å£çåæä¸å¼ºåå¯¹è±¡åè½ã æ­¤å¤ï¼ è£é¥°è¿æ¯æéå½ç»åï¼ ééå¨åæ æ³å®ç°ã\n * ééå¨è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * å¤è§æ¨¡å¼ä¸ºç°æå¯¹è±¡å®ä¹äºä¸ä¸ªæ°æ¥å£ï¼ ééå¨åä¼è¯å¾è¿ç¨å·²æçæ¥å£ã ééå¨éå¸¸åªå°è£ä¸ä¸ªå¯¹è±¡ï¼ å¤è§éå¸¸ä¼ä½ç¨äºæ´ä¸ªå¯¹è±¡å­ç³»ç»ä¸ã\n * æ¡¥æ¥ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ééå¨æ¨¡å¼\n\n\n# 1. æå¾\n\nééå¨æ¨¡å¼ (adapter)æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ å®è½ä½¿ä¸å¼å®¹çå¯¹è±¡è½å¤ç¸äºåä½ã\n\nééå¨æ¨¡å¼éè¿å°è£å¯¹è±¡å°å¤æçè½¬æ¢è¿ç¨éèäºå¹åã è¢«å°è£çå¯¹è±¡çè³å¯è§ä¸å°ééå¨çå­å¨ã\n\nééå¨ä¸ä»å¯ä»¥è½¬æ¢ä¸åæ ¼å¼çæ°æ®ï¼ å¶è¿æå©äºéç¨ä¸åæ¥å£çå¯¹è±¡ä¹é´çåä½ã å®çè¿ä½æ¹å¼å¦ä¸ï¼\n\n * ééå¨å®ç°ä¸å¶ä¸­ä¸ä¸ªç°æå¯¹è±¡å¼å®¹çæ¥å£ã\n * ç°æå¯¹è±¡å¯ä»¥ä½¿ç¨è¯¥æ¥å£å®å¨å°è°ç¨ééå¨æ¹æ³ã\n * ééå¨æ¹æ³è¢«è°ç¨åå°ä»¥å¦ä¸ä¸ªå¯¹è±¡å¼å®¹çæ ¼å¼åé¡ºåºå°è¯·æ±ä¼ éç»è¯¥å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ å¸æä½¿ç¨æä¸ªç±»ï¼ ä½æ¯å¶æ¥å£ä¸å¶ä»ä»£ç ä¸å¼å®¹æ¶ï¼ å¯ä»¥ä½¿ç¨ééå¨ç±»ã\n * å¦ææ¨éè¦å¤ç¨è¿æ ·ä¸äºç±»ï¼ ä»ä»¬å¤äºåä¸ä¸ªç»§æ¿ä½ç³»ï¼ å¹¶ä¸ä»ä»¬åæäºé¢å¤çä¸äºå±åçæ¹æ³ï¼ ä½æ¯è¿äºå±åçæ¹æ³ä¸æ¯ææå¨è¿ä¸ç»§æ¿ä½ç³»ä¸­çå­ç±»æå·æçå±æ§ã\n\n\n# 3. ç»æ\n\nééå¨å®ç°äºå¶ä¸­ä¸ä¸ªå¯¹è±¡çæ¥å£ï¼ å¹¶å¯¹å¦ä¸ä¸ªå¯¹è±¡è¿è¡å°è£ã\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. å®¢æ·ç«¯ ï¼clientï¼ æ¯åå«å½åç¨åºä¸å¡é»è¾çç±»ã\n 2. å®¢æ·ç«¯æ¥å£ ï¼client interfaceï¼ æè¿°äºå¶ä»ç±»ä¸å®¢æ·ç«¯ä»£ç åä½æ¶å¿é¡»éµå¾ªçåè®®ã\n 3. æå¡ ï¼serviceï¼ ä¸­æä¸äºåè½ç±» ï¼éå¸¸æ¥èªç¬¬ä¸æ¹æéçç³»ç»ï¼ã å®¢æ·ç«¯ä¸å¶æ¥å£ä¸å¼å®¹ï¼ å æ­¤æ æ³ç´æ¥è°ç¨å¶åè½ã\n 4. ééå¨ ï¼adapterï¼ æ¯ä¸ä¸ªå¯ä»¥åæ¶ä¸å®¢æ·ç«¯åæå¡äº¤äºçç±»ï¼ å®å¨å®ç°å®¢æ·ç«¯æ¥å£çåæ¶å°è£äºæå¡å¯¹è±¡ã ééå¨æ¥åå®¢æ·ç«¯éè¿ééå¨æ¥å£åèµ·çè°ç¨ï¼ å¹¶å°å¶è½¬æ¢ä¸ºéç¨äºè¢«å°è£æå¡å¯¹è±¡çè°ç¨ã\n 5. å®¢æ·ç«¯ä»£ç åªééè¿æ¥å£ä¸ééå¨äº¤äºå³å¯ï¼ æ éä¸å·ä½çééå¨ç±»è¦åã å æ­¤ï¼ ä½ å¯ä»¥åç¨åºä¸­æ·»å æ°ç±»åçééå¨èæ éä¿®æ¹å·²æä»£ç ã è¿å¨æå¡ç±»çæ¥å£è¢«æ´æ¹ææ¿æ¢æ¶å¾æç¨ï¼ ä½ æ éä¿®æ¹å®¢æ·ç«¯ä»£ç å°±å¯ä»¥åå»ºæ°çééå¨ç±»ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãtargetã\n\nå®ä¹ç¨æ·å®ééè¦çæ¥å£ã\n\nabstract class target {\n    public abstract void request();\n}\n\n\nãadapteeã\n\nå®ä¹ä¸ä¸ªéè¦ééçæ¥å£ã\n\nclass adaptee {\n    public void specificrequest() {\n        system.out.println("ç¹æ®è¯·æ±");\n    }\n}\n\n\nãadapterã\n\néè¿å¨åé¨åè£ä¸ä¸ª adaptee å¯¹è±¡ï¼ææºæ¥å£è½¬æ¢æç®æ æ¥å£ã\n\nclass adapter extends target {\n    private adaptee adaptee = new adaptee();\n\n    @override\n    public void request() {\n        adaptee.specificrequest();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class adapterpattern {\n    public static void main(string[] args) {\n        target target = new adapter();\n        target.request();\n    }\n}\n\n\nãè¾åºã\n\nç¹æ®è¯·æ±\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nééå¨åæ®æä¸ä¸ªåé ï¼roundÂ­pegï¼ï¼ å¶åå¾ç­äºæ¹é ï¼squareÂ­pegï¼ æ¨ªæªé¢å¯¹è§çº¿çä¸å ï¼å³è½å¤å®¹çº³æ¹éçæå°å¤æ¥åçåå¾ï¼ã\n\n// åè®¾ä½ æä¸¤ä¸ªæ¥å£ç¸äºå¼å®¹çç±»ï¼åå­ï¼roundÂ­holeï¼ååéï¼roundÂ­pegï¼ã\nclass roundhole is\n    constructor roundhole(radius) { ... }\n\n    method getradius() is\n        // è¿åå­çåå¾ã\n\n    method fits(peg: roundpeg) is\n        return this.getradius() >= peg.getradius()\n\nclass roundpeg is\n    constructor roundpeg(radius) { ... }\n\n    method getradius() is\n        // è¿åéå­çåå¾ã\n\n\n// ä½è¿æä¸ä¸ªä¸å¼å®¹çç±»ï¼æ¹éï¼squareÂ­pegï¼ã\nclass squarepeg is\n    constructor squarepeg(width) { ... }\n\n    method getwidth() is\n        // è¿åæ¹éçå®½åº¦ã\n\n\n// ééå¨ç±»è®©ä½ è½å¤å°æ¹éæ¾å¥åå­ä¸­ãå®ä¼å¯¹ roundpeg ç±»è¿è¡æ©å±ï¼ä»¥æ¥æ¶é\n// éå¨å¯¹è±¡ä½ä¸ºåéã\nclass squarepegadapter extends roundpeg is\n    // å¨å®éæåµä¸­ï¼ééå¨ä¸­ä¼åå«ä¸ä¸ª squarepeg ç±»çå®ä¾ã\n    private field peg: squarepeg\n\n    constructor squarepegadapter(peg: squarepeg) is\n        this.peg = peg\n\n    method getradius() is\n        // ééå¨ä¼åæ®ä¸ºä¸ä¸ªåéï¼\n        // å¶åå¾åå¥½è½ä¸ééå¨å®éå°è£çæ¹éæ­éèµ·æ¥ã\n        return peg.getwidth() * math.sqrt(2) / 2\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\nhole = new roundhole(5)\nrpeg = new roundpeg(5)\nhole.fits(rpeg) // true\n\nsmall_sqpeg = new squarepeg(5)\nlarge_sqpeg = new squarepeg(10)\nhole.fits(small_sqpeg) // æ­¤å¤æ æ³ç¼è¯ï¼ç±»åä¸ä¸è´ï¼ã\n\nsmall_sqpeg_adapter = new squarepegadapter(small_sqpeg)\nlarge_sqpeg_adapter = new squarepegadapter(large_sqpeg)\nhole.fits(small_sqpeg_adapter) // true\nhole.fits(large_sqpeg_adapter) // false\n\n\n\n# 5. æ¡ä¾\n\nééå¨æ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§ã\n\njava æ ¸å¿ç¨åºåºä¸­æä¸äºæ åçééå¨ï¼\n\n * java.util.arrays#aslist()\n * java.util.collections#list()\n * java.util.collections#enumeration()\n * java.io.inputstreamreader(inputstream) ï¼è¿å readerå¯¹è±¡ï¼\n * java.io.outputstreamwriter(outputstream) ï¼è¿å writerå¯¹è±¡ï¼\n * javax.xml.bind.annotation.adapters.xmladapter#marshal() å #unmarshal()\n\nè¯å«æ¹æ³ï¼ ééå¨å¯ä»¥éè¿ä»¥ä¸åæ½è±¡ææ¥å£ç±»åå®ä¾ä¸ºåæ°çæé å½æ°æ¥è¯å«ã å½ééå¨çä»»ä½æ¹æ³è¢«è°ç¨æ¶ï¼ å®ä¼å°åæ°è½¬æ¢ä¸ºåéçæ ¼å¼ï¼ ç¶åå°è°ç¨å®åå°å¶å°è£å¯¹è±¡ä¸­çä¸ä¸ªæå¤ä¸ªæ¹æ³ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼éå¸¸ä¼äºå¼ååæè¿è¡è®¾è®¡ï¼ ä½¿ä½ è½å¤å°ç¨åºçåä¸ªé¨åç¬ç«å¼æ¥ä»¥ä¾¿å¼åã å¦ä¸æ¹é¢ï¼ ééå¨æ¨¡å¼éå¸¸å¨å·²æç¨åºä¸­ä½¿ç¨ï¼ è®©ç¸äºä¸å¼å®¹çç±»è½å¾å¥½å°åä½ã\n * ééå¨å¯ä»¥å¯¹å·²æå¯¹è±¡çæ¥å£è¿è¡ä¿®æ¹ï¼ è£é¥°æ¨¡å¼åè½å¨ä¸æ¹åå¯¹è±¡æ¥å£çåæä¸å¼ºåå¯¹è±¡åè½ã æ­¤å¤ï¼ è£é¥°è¿æ¯æéå½ç»åï¼ ééå¨åæ æ³å®ç°ã\n * ééå¨è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * å¤è§æ¨¡å¼ä¸ºç°æå¯¹è±¡å®ä¹äºä¸ä¸ªæ°æ¥å£ï¼ ééå¨åä¼è¯å¾è¿ç¨å·²æçæ¥å£ã ééå¨éå¸¸åªå°è£ä¸ä¸ªå¯¹è±¡ï¼ å¤è§éå¸¸ä¼ä½ç¨äºæ´ä¸ªå¯¹è±¡å­ç³»ç»ä¸ã\n * æ¡¥æ¥ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹æ¡¥æ¥æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹æ¡¥æ¥æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-16T10:32:00.000Z",permalink:"/pages/9f520d/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/08.%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/08.æ¡¥æ¥æ¨¡å¼.md",key:"v-0569b6f8",path:"/pages/9f520d/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:243},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:374},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:386},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:771},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2260},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3799},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:4125},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:4503}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹æ¡¥æ¥æ¨¡å¼\n\n\n# 1. æå¾\n\næ¡¥æ¥æ¨¡å¼ (Bridge) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ å¯å°æ½è±¡é¨åä¸å®ç°é¨ååç¦»ï¼ä½¿å®ä»¬é½å¯ä»¥ç¬ç«çååã\n\nå¦æä¸ä¸ªç³»ç»éè¦å¨æä»¶çæ½è±¡åè§è²åå·ä½åè§è²ä¹é´å¢å æ´å¤ççµæ´»æ§ï¼é¿åå¨ä¸¤ä¸ªå±æ¬¡ä¹é´å»ºç«éæçèç³»ãæ½è±¡åè§è²åå·ä½åè§è²é½åºè¯¥å¯ä»¥è¢«å­ç±»æ©å±ãå¨è¿ç§æåµä¸ï¼æ¡¥æ¥æ¨¡å¼å¯ä»¥çµæ´»å°ç»åä¸åçæ½è±¡åè§è²åå·ä½åè§è²ï¼å¹¶ç¬ç«åå°æ©å±ã\n\nè®¾è®¡è¦æ±å®ç°åè§è²çä»»ä½æ¹åä¸åºå½å½±åå®¢æ·ç«¯ï¼æèè¯´å®ç°åè§è²çæ¹åå¯¹å®¢æ·ç«¯æ¯å®å¨éæçã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ æ³è¦æåæéç»ä¸ä¸ªå·æå¤éåè½çåºæç±»ï¼ä¾å¦è½ä¸å¤ä¸ªæ°æ®åºæå¡å¨è¿è¡äº¤äºçç±»ï¼ï¼å¯ä»¥ä½¿ç¨æ¡¥æ¥æ¨¡å¼ã\n * å¦æä½ å¸æå¨å ä¸ªç¬ç«ç»´åº¦ä¸æ©å±ä¸ä¸ªç±»ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n * å¦æä½ éè¦å¨è¿è¡æ¶åæ¢ä¸åå®ç°æ¹æ³ï¼ å¯ä½¿ç¨æ¡¥æ¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡é¨å ï¼Abstractionï¼ æä¾é«å±æ§å¶é»è¾ï¼ ä¾èµäºå®æåºå±å®éå·¥ä½çå®ç°å¯¹è±¡ã\n 2. å®ç°é¨å ï¼Implementationï¼ ä¸ºææå·ä½å®ç°å£°æéç¨æ¥å£ã æ½è±¡é¨åä»è½éè¿å¨è¿éå£°æçæ¹æ³ä¸å®ç°å¯¹è±¡äº¤äºã\n    * æ½è±¡é¨åå¯ä»¥ååºåå®ç°é¨åä¸æ ·çæ¹æ³ï¼ ä½æ¯æ½è±¡é¨åéå¸¸å£°æä¸äºå¤æè¡ä¸ºï¼ è¿äºè¡ä¸ºä¾èµäºå¤ç§ç±å®ç°é¨åå£°æçåè¯­æä½ã\n 3. å·ä½å®ç° ï¼Concrete Implementationsï¼ ä¸­åæ¬ç¹å®äºå¹³å°çä»£ç ã\n 4. ç²¾ç¡®æ½è±¡ ï¼Refined Abstractionï¼ æä¾æ§å¶é»è¾çåä½ã ä¸å¶ç¶ç±»ä¸æ ·ï¼ å®ä»¬éè¿éç¨å®ç°æ¥å£ä¸ä¸åçå®ç°è¿è¡äº¤äºã\n 5. éå¸¸æåµä¸ï¼ å®¢æ·ç«¯ ï¼Clientï¼ ä»å³å¿å¦ä½ä¸æ½è±¡é¨ååä½ã ä½æ¯ï¼ å®¢æ·ç«¯éè¦å°æ½è±¡å¯¹è±¡ä¸ä¸ä¸ªå®ç°å¯¹è±¡è¿æ¥èµ·æ¥ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãImplementorãå®ä¹å®ç°æ¥å£ã\n\ninterface Implementor {\n    // å®ç°æ½è±¡é¨åéè¦çæäºå·ä½åè½\n    public void operationImpl();\n}\n\n\nãAbstractionãå®ä¹æ½è±¡æ¥å£ã\n\nabstract class Abstraction {\n    // ææä¸ä¸ª Implementor å¯¹è±¡ï¼å½¢æèåå³ç³»\n    protected Implementor implementor;\n\n    public Abstraction(Implementor implementor) {\n        this.implementor = implementor;\n    }\n\n    // å¯è½éè¦è½¬è°å®ç°é¨åçå·ä½å®ç°\n    public void operation() {\n        implementor.operationImpl();\n    }\n}\n\n\nãConcreteImplementorãå®ç° Implementor ä¸­å®ä¹çæ¥å£ã\n\nclass ConcreteImplementorA implements Implementor {\n    @Override\n    public void operationImpl() {\n        // çæ­£çå®ç°\n        System.out.println("å·ä½å®ç°A");\n    }\n}\n\nclass ConcreteImplementorB implements Implementor {\n    @Override\n    public void operationImpl() {\n        // çæ­£çå®ç°\n        System.out.println("å·ä½å®ç°B");\n    }\n}\n\n\nãRefinedAbstractionãæ©å± Abstraction ç±»ã\n\nclass RefinedAbstraction extends Abstraction {\n\n    public RefinedAbstraction(Implementor implementor) {\n        super(implementor);\n    }\n\n    public void otherOperation() {\n        // å®ç°ä¸å®çåè½ï¼å¯è½ä¼ä½¿ç¨å·ä½å®ç°é¨åçå®ç°æ¹æ³,\n        // ä½æ¯æ¬æ¹æ³æ´å¤§çå¯è½æ¯ä½¿ç¨ Abstraction ä¸­å®ä¹çæ¹æ³ï¼\n        // éè¿ç»åä½¿ç¨ Abstraction ä¸­å®ä¹çæ¹æ³æ¥å®ææ´å¤çåè½ã\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class BridgePattern {\n    public static void main(String[] args) {\n        Implementor implementor = new ConcreteImplementorA();\n        RefinedAbstraction abstraction = new RefinedAbstraction(implementor);\n        abstraction.operation();\n        abstraction.otherOperation();\n    }\n}\n\n\nãè¾åºã\n\nå·ä½å®ç°A\nå¶ä»æä½\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\né¥æ§å¨åºç±»å£°æäºä¸ä¸ªæåè®¾å¤å¯¹è±¡çå¼ç¨æååéã ææé¥æ§å¨éè¿éç¨è®¾å¤æ¥å£ä¸è®¾å¤è¿è¡äº¤äºï¼ ä½¿å¾åä¸ä¸ªé¥æ§å¨å¯ä»¥æ¯æä¸åç±»åçè®¾å¤ã\n\nä½ å¯ä»¥å¼åç¬ç«äºè®¾å¤ç±»çé¥æ§å¨ç±»ï¼ åªéæ°å»ºä¸ä¸ªé¥æ§å¨å­ç±»å³å¯ã ä¾å¦ï¼ åºç¡é¥æ§å¨å¯è½åªæä¸¤ä¸ªæé®ï¼ ä½ä½ å¯å¨å¶åºç¡ä¸æ©å±æ°åè½ï¼ æ¯å¦é¢å¤çä¸èçµæ± æä¸åè§¦æ¸å±ã\n\nå®¢æ·ç«¯ä»£ç éè¿é¥æ§å¨æé å½æ°å°ç¹å®ç§ç±»çé¥æ§å¨ä¸è®¾å¤å¯¹è±¡è¿æ¥èµ·æ¥ã\n\n// âæ½è±¡é¨åâå®ä¹äºä¸¤ä¸ªç±»å±æ¬¡ç»æä¸­âæ§å¶âé¨åçæ¥å£ãå®ç®¡ççä¸ä¸ªæåâå®\n// ç°é¨åâå±æ¬¡ç»æä¸­å¯¹è±¡çå¼ç¨ï¼å¹¶ä¼å°ææçå®å·¥ä½å§æ´¾ç»è¯¥å¯¹è±¡ã\nclass RemoteControl is\n    protected field device: Device\n    constructor RemoteControl(device: Device) is\n        this.device = device\n    method togglePower() is\n        if (device.isEnabled()) then\n            device.disable()\n        else\n            device.enable()\n    method volumeDown() is\n        device.setVolume(device.getVolume() - 10)\n    method volumeUp() is\n        device.setVolume(device.getVolume() + 10)\n    method channelDown() is\n        device.setChannel(device.getChannel() - 1)\n    method channelUp() is\n        device.setChannel(device.getChannel() + 1)\n\n\n// ä½ å¯ä»¥ç¬ç«äºè®¾å¤ç±»çæ¹å¼ä»æ½è±¡å±ä¸­æ©å±ç±»ã\nclass AdvancedRemoteControl extends RemoteControl is\n    method mute() is\n        device.setVolume(0)\n\n\n// âå®ç°é¨åâæ¥å£å£°æäºå¨ææå·ä½å®ç°ç±»ä¸­éç¨çæ¹æ³ãå®ä¸éè¦ä¸æ½è±¡æ¥å£ç¸\n// å¹éãå®éä¸ï¼è¿ä¸¤ä¸ªæ¥å£å¯ä»¥å®å¨ä¸ä¸æ ·ãéå¸¸å®ç°æ¥å£åªæä¾åè¯­æä½ï¼è\n// æ½è±¡æ¥å£åä¼åºäºè¿äºæä½å®ä¹è¾é«å±æ¬¡çæä½ã\ninterface Device is\n    method isEnabled()\n    method enable()\n    method disable()\n    method getVolume()\n    method setVolume(percent)\n    method getChannel()\n    method setChannel(channel)\n\n\n// ææè®¾å¤é½éµå¾ªç¸åçæ¥å£ã\nclass Tv implements Device is\n    // ...\n\nclass Radio implements Device is\n    // ...\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\ntv = new Tv()\nremote = new RemoteControl(tv)\nremote.togglePower()\n\nradio = new Radio()\nremote = new AdvancedRemoteControl(radio)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ æ¡¥æ¥æ¨¡å¼å¨å¤çè·¨å¹³å°åºç¨ã æ¯æå¤ç§ç±»åçæ°æ®åºæå¡å¨æä¸å¤ä¸ªç¹å®ç§ç±» ï¼ä¾å¦äºå¹³å°åç¤¾äº¤ç½ç»ç­ï¼ ç API ä¾åºååä½æ¶ä¼ç¹å«æç¨ã\n\nè¯å«æ¹æ³ï¼ æ¡¥æ¥å¯ä»¥éè¿ä¸äºæ§å¶å®ä½åå¶æä¾èµçå¤ä¸ªä¸åå¹³å°ä¹é´çæç¡®åºå«æ¥è¿è¡è¯å«ã\n\nJava ä¸­æ¡¥æ¥æ¨¡å¼åºç¨æç»å¸çä»£è¡¨æ çæ¯æ¥å¿ç»ä»¶ slf4j çæ¡¥æ¥ jar åã\n\nåå¦ï¼ä½ æ­£å¨å¼ååºç¨ç¨åºæè°ç¨çç»ä»¶å½ä¸­å·²ç»ä½¿ç¨äº common-loggingï¼è¿æ¶ä½ éè¦ jcl-over-slf4j.jar ææ¥å¿ä¿¡æ¯è¾åºéå®åå° slf4j-apiï¼slf4j-api åå»è°ç¨ slf4j å®éä¾èµçæ¥å¿ç»ä»¶ãè¿ä¸ªè¿ç¨ç§°ä¸ºæ¡¥æ¥ãä¸å¾æ¯å®æ¹ç slf4j æ¡¥æ¥ç­ç¥å¾ï¼\n\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼éå¸¸ä¼äºå¼ååæè¿è¡è®¾è®¡ï¼ ä½¿ä½ è½å¤å°ç¨åºçåä¸ªé¨åç¬ç«å¼æ¥ä»¥ä¾¿å¼åã å¦ä¸æ¹é¢ï¼ ééå¨æ¨¡å¼éå¸¸å¨å·²æç¨åºä¸­ä½¿ç¨ï¼ è®©ç¸äºä¸å¼å®¹çç±»è½å¾å¥½å°åä½ã\n * æ¡¥æ¥ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ä½ å¯ä»¥å°æ½è±¡å·¥åæ¨¡å¼åæ¡¥æ¥æ­éä½¿ç¨ã å¦æç±æ¡¥æ¥å®ä¹çæ½è±¡åªè½ä¸ç¹å®å®ç°åä½ï¼ è¿ä¸æ¨¡å¼æ­éå°±éå¸¸æç¨ã å¨è¿ç§æåµä¸ï¼ æ½è±¡å·¥åå¯ä»¥å¯¹è¿äºå³ç³»è¿è¡å°è£ï¼ å¹¶ä¸å¯¹å®¢æ·ç«¯ä»£ç éèå¶å¤ææ§ã\n * ä½ å¯ä»¥ç»åä½¿ç¨çæå¨æ¨¡å¼åæ¡¥æ¥æ¨¡å¼ï¼ ä¸»ç®¡ç±»è´è´£æ½è±¡å·¥ä½ï¼ åç§ä¸åççæå¨è´è´£å®ç°å·¥ä½ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹æ¡¥æ¥æ¨¡å¼\n\n\n# 1. æå¾\n\næ¡¥æ¥æ¨¡å¼ (bridge) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ å¯å°æ½è±¡é¨åä¸å®ç°é¨ååç¦»ï¼ä½¿å®ä»¬é½å¯ä»¥ç¬ç«çååã\n\nå¦æä¸ä¸ªç³»ç»éè¦å¨æä»¶çæ½è±¡åè§è²åå·ä½åè§è²ä¹é´å¢å æ´å¤ççµæ´»æ§ï¼é¿åå¨ä¸¤ä¸ªå±æ¬¡ä¹é´å»ºç«éæçèç³»ãæ½è±¡åè§è²åå·ä½åè§è²é½åºè¯¥å¯ä»¥è¢«å­ç±»æ©å±ãå¨è¿ç§æåµä¸ï¼æ¡¥æ¥æ¨¡å¼å¯ä»¥çµæ´»å°ç»åä¸åçæ½è±¡åè§è²åå·ä½åè§è²ï¼å¹¶ç¬ç«åå°æ©å±ã\n\nè®¾è®¡è¦æ±å®ç°åè§è²çä»»ä½æ¹åä¸åºå½å½±åå®¢æ·ç«¯ï¼æèè¯´å®ç°åè§è²çæ¹åå¯¹å®¢æ·ç«¯æ¯å®å¨éæçã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ æ³è¦æåæéç»ä¸ä¸ªå·æå¤éåè½çåºæç±»ï¼ä¾å¦è½ä¸å¤ä¸ªæ°æ®åºæå¡å¨è¿è¡äº¤äºçç±»ï¼ï¼å¯ä»¥ä½¿ç¨æ¡¥æ¥æ¨¡å¼ã\n * å¦æä½ å¸æå¨å ä¸ªç¬ç«ç»´åº¦ä¸æ©å±ä¸ä¸ªç±»ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n * å¦æä½ éè¦å¨è¿è¡æ¶åæ¢ä¸åå®ç°æ¹æ³ï¼ å¯ä½¿ç¨æ¡¥æ¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡é¨å ï¼abstractionï¼ æä¾é«å±æ§å¶é»è¾ï¼ ä¾èµäºå®æåºå±å®éå·¥ä½çå®ç°å¯¹è±¡ã\n 2. å®ç°é¨å ï¼implementationï¼ ä¸ºææå·ä½å®ç°å£°æéç¨æ¥å£ã æ½è±¡é¨åä»è½éè¿å¨è¿éå£°æçæ¹æ³ä¸å®ç°å¯¹è±¡äº¤äºã\n    * æ½è±¡é¨åå¯ä»¥ååºåå®ç°é¨åä¸æ ·çæ¹æ³ï¼ ä½æ¯æ½è±¡é¨åéå¸¸å£°æä¸äºå¤æè¡ä¸ºï¼ è¿äºè¡ä¸ºä¾èµäºå¤ç§ç±å®ç°é¨åå£°æçåè¯­æä½ã\n 3. å·ä½å®ç° ï¼concrete implementationsï¼ ä¸­åæ¬ç¹å®äºå¹³å°çä»£ç ã\n 4. ç²¾ç¡®æ½è±¡ ï¼refined abstractionï¼ æä¾æ§å¶é»è¾çåä½ã ä¸å¶ç¶ç±»ä¸æ ·ï¼ å®ä»¬éè¿éç¨å®ç°æ¥å£ä¸ä¸åçå®ç°è¿è¡äº¤äºã\n 5. éå¸¸æåµä¸ï¼ å®¢æ·ç«¯ ï¼clientï¼ ä»å³å¿å¦ä½ä¸æ½è±¡é¨ååä½ã ä½æ¯ï¼ å®¢æ·ç«¯éè¦å°æ½è±¡å¯¹è±¡ä¸ä¸ä¸ªå®ç°å¯¹è±¡è¿æ¥èµ·æ¥ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nãimplementorãå®ä¹å®ç°æ¥å£ã\n\ninterface implementor {\n    // å®ç°æ½è±¡é¨åéè¦çæäºå·ä½åè½\n    public void operationimpl();\n}\n\n\nãabstractionãå®ä¹æ½è±¡æ¥å£ã\n\nabstract class abstraction {\n    // ææä¸ä¸ª implementor å¯¹è±¡ï¼å½¢æèåå³ç³»\n    protected implementor implementor;\n\n    public abstraction(implementor implementor) {\n        this.implementor = implementor;\n    }\n\n    // å¯è½éè¦è½¬è°å®ç°é¨åçå·ä½å®ç°\n    public void operation() {\n        implementor.operationimpl();\n    }\n}\n\n\nãconcreteimplementorãå®ç° implementor ä¸­å®ä¹çæ¥å£ã\n\nclass concreteimplementora implements implementor {\n    @override\n    public void operationimpl() {\n        // çæ­£çå®ç°\n        system.out.println("å·ä½å®ç°a");\n    }\n}\n\nclass concreteimplementorb implements implementor {\n    @override\n    public void operationimpl() {\n        // çæ­£çå®ç°\n        system.out.println("å·ä½å®ç°b");\n    }\n}\n\n\nãrefinedabstractionãæ©å± abstraction ç±»ã\n\nclass refinedabstraction extends abstraction {\n\n    public refinedabstraction(implementor implementor) {\n        super(implementor);\n    }\n\n    public void otheroperation() {\n        // å®ç°ä¸å®çåè½ï¼å¯è½ä¼ä½¿ç¨å·ä½å®ç°é¨åçå®ç°æ¹æ³,\n        // ä½æ¯æ¬æ¹æ³æ´å¤§çå¯è½æ¯ä½¿ç¨ abstraction ä¸­å®ä¹çæ¹æ³ï¼\n        // éè¿ç»åä½¿ç¨ abstraction ä¸­å®ä¹çæ¹æ³æ¥å®ææ´å¤çåè½ã\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class bridgepattern {\n    public static void main(string[] args) {\n        implementor implementor = new concreteimplementora();\n        refinedabstraction abstraction = new refinedabstraction(implementor);\n        abstraction.operation();\n        abstraction.otheroperation();\n    }\n}\n\n\nãè¾åºã\n\nå·ä½å®ç°a\nå¶ä»æä½\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\né¥æ§å¨åºç±»å£°æäºä¸ä¸ªæåè®¾å¤å¯¹è±¡çå¼ç¨æååéã ææé¥æ§å¨éè¿éç¨è®¾å¤æ¥å£ä¸è®¾å¤è¿è¡äº¤äºï¼ ä½¿å¾åä¸ä¸ªé¥æ§å¨å¯ä»¥æ¯æä¸åç±»åçè®¾å¤ã\n\nä½ å¯ä»¥å¼åç¬ç«äºè®¾å¤ç±»çé¥æ§å¨ç±»ï¼ åªéæ°å»ºä¸ä¸ªé¥æ§å¨å­ç±»å³å¯ã ä¾å¦ï¼ åºç¡é¥æ§å¨å¯è½åªæä¸¤ä¸ªæé®ï¼ ä½ä½ å¯å¨å¶åºç¡ä¸æ©å±æ°åè½ï¼ æ¯å¦é¢å¤çä¸èçµæ± æä¸åè§¦æ¸å±ã\n\nå®¢æ·ç«¯ä»£ç éè¿é¥æ§å¨æé å½æ°å°ç¹å®ç§ç±»çé¥æ§å¨ä¸è®¾å¤å¯¹è±¡è¿æ¥èµ·æ¥ã\n\n// âæ½è±¡é¨åâå®ä¹äºä¸¤ä¸ªç±»å±æ¬¡ç»æä¸­âæ§å¶âé¨åçæ¥å£ãå®ç®¡ççä¸ä¸ªæåâå®\n// ç°é¨åâå±æ¬¡ç»æä¸­å¯¹è±¡çå¼ç¨ï¼å¹¶ä¼å°ææçå®å·¥ä½å§æ´¾ç»è¯¥å¯¹è±¡ã\nclass remotecontrol is\n    protected field device: device\n    constructor remotecontrol(device: device) is\n        this.device = device\n    method togglepower() is\n        if (device.isenabled()) then\n            device.disable()\n        else\n            device.enable()\n    method volumedown() is\n        device.setvolume(device.getvolume() - 10)\n    method volumeup() is\n        device.setvolume(device.getvolume() + 10)\n    method channeldown() is\n        device.setchannel(device.getchannel() - 1)\n    method channelup() is\n        device.setchannel(device.getchannel() + 1)\n\n\n// ä½ å¯ä»¥ç¬ç«äºè®¾å¤ç±»çæ¹å¼ä»æ½è±¡å±ä¸­æ©å±ç±»ã\nclass advancedremotecontrol extends remotecontrol is\n    method mute() is\n        device.setvolume(0)\n\n\n// âå®ç°é¨åâæ¥å£å£°æäºå¨ææå·ä½å®ç°ç±»ä¸­éç¨çæ¹æ³ãå®ä¸éè¦ä¸æ½è±¡æ¥å£ç¸\n// å¹éãå®éä¸ï¼è¿ä¸¤ä¸ªæ¥å£å¯ä»¥å®å¨ä¸ä¸æ ·ãéå¸¸å®ç°æ¥å£åªæä¾åè¯­æä½ï¼è\n// æ½è±¡æ¥å£åä¼åºäºè¿äºæä½å®ä¹è¾é«å±æ¬¡çæä½ã\ninterface device is\n    method isenabled()\n    method enable()\n    method disable()\n    method getvolume()\n    method setvolume(percent)\n    method getchannel()\n    method setchannel(channel)\n\n\n// ææè®¾å¤é½éµå¾ªç¸åçæ¥å£ã\nclass tv implements device is\n    // ...\n\nclass radio implements device is\n    // ...\n\n\n// å®¢æ·ç«¯ä»£ç ä¸­çæä¸ªä½ç½®ã\ntv = new tv()\nremote = new remotecontrol(tv)\nremote.togglepower()\n\nradio = new radio()\nremote = new advancedremotecontrol(radio)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ æ¡¥æ¥æ¨¡å¼å¨å¤çè·¨å¹³å°åºç¨ã æ¯æå¤ç§ç±»åçæ°æ®åºæå¡å¨æä¸å¤ä¸ªç¹å®ç§ç±» ï¼ä¾å¦äºå¹³å°åç¤¾äº¤ç½ç»ç­ï¼ ç api ä¾åºååä½æ¶ä¼ç¹å«æç¨ã\n\nè¯å«æ¹æ³ï¼ æ¡¥æ¥å¯ä»¥éè¿ä¸äºæ§å¶å®ä½åå¶æä¾èµçå¤ä¸ªä¸åå¹³å°ä¹é´çæç¡®åºå«æ¥è¿è¡è¯å«ã\n\njava ä¸­æ¡¥æ¥æ¨¡å¼åºç¨æç»å¸çä»£è¡¨æ çæ¯æ¥å¿ç»ä»¶ slf4j çæ¡¥æ¥ jar åã\n\nåå¦ï¼ä½ æ­£å¨å¼ååºç¨ç¨åºæè°ç¨çç»ä»¶å½ä¸­å·²ç»ä½¿ç¨äº common-loggingï¼è¿æ¶ä½ éè¦ jcl-over-slf4j.jar ææ¥å¿ä¿¡æ¯è¾åºéå®åå° slf4j-apiï¼slf4j-api åå»è°ç¨ slf4j å®éä¾èµçæ¥å¿ç»ä»¶ãè¿ä¸ªè¿ç¨ç§°ä¸ºæ¡¥æ¥ãä¸å¾æ¯å®æ¹ç slf4j æ¡¥æ¥ç­ç¥å¾ï¼\n\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼éå¸¸ä¼äºå¼ååæè¿è¡è®¾è®¡ï¼ ä½¿ä½ è½å¤å°ç¨åºçåä¸ªé¨åç¬ç«å¼æ¥ä»¥ä¾¿å¼åã å¦ä¸æ¹é¢ï¼ ééå¨æ¨¡å¼éå¸¸å¨å·²æç¨åºä¸­ä½¿ç¨ï¼ è®©ç¸äºä¸å¼å®¹çç±»è½å¾å¥½å°åä½ã\n * æ¡¥æ¥ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ä½ å¯ä»¥å°æ½è±¡å·¥åæ¨¡å¼åæ¡¥æ¥æ­éä½¿ç¨ã å¦æç±æ¡¥æ¥å®ä¹çæ½è±¡åªè½ä¸ç¹å®å®ç°åä½ï¼ è¿ä¸æ¨¡å¼æ­éå°±éå¸¸æç¨ã å¨è¿ç§æåµä¸ï¼ æ½è±¡å·¥åå¯ä»¥å¯¹è¿äºå³ç³»è¿è¡å°è£ï¼ å¹¶ä¸å¯¹å®¢æ·ç«¯ä»£ç éèå¶å¤ææ§ã\n * ä½ å¯ä»¥ç»åä½¿ç¨çæå¨æ¨¡å¼åæ¡¥æ¥æ¨¡å¼ï¼ ä¸»ç®¡ç±»è´è´£æ½è±¡å·¥ä½ï¼ åç§ä¸åççæå¨è´è´£å®ç°å·¥ä½ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ç»åæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ç»åæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-14T15:33:00.000Z",permalink:"/pages/b18a73/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/09.%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/09.ç»åæ¨¡å¼.md",key:"v-4e6d8200",path:"/pages/b18a73/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:111},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:340},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:352},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:691},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2878},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:4858},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5122},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:5687}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ç»åæ¨¡å¼\n\n\n# 1. æå¾\n\nç»åæ¨¡å¼ (Component) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å°å¯¹è±¡ç»åææ å½¢ç»æä»¥è¡¨ç¤ºâé¨å-æ´ä½âçå±æ¬¡ç»æã\n\nç»åæ¨¡å¼ä½¿å¾ç¨æ·å¯¹åä¸ªå¯¹è±¡åç»åå¯¹è±¡çä½¿ç¨å·æå¯ä¸æ§ã\n\n\n# 2. éç¨åºæ¯\n\nç»åæ¨¡å¼çéç¨åºæ¯ï¼\n\n * æ³è¦è¡¨ç¤ºå¯¹è±¡çé¨å-æ´ä½å±æ¬¡ç»æã\n * æ³è¦å®¢æ·ç«¯å¿½ç¥ç»åå¯¹è±¡ä¸åä¸ªå¯¹è±¡çå·®å¼ï¼å®¢æ·ç«¯å°ç»ä¸å°ä½¿ç¨ç»åç»æä¸­çææå¯¹è±¡ã\n\nå³äºåçº§æ°æ®ç»æçä¸ä¸ªæ®éæ§çä¾å­æ¯ä½ æ¯æ¬¡ä½¿ç¨çµèæ¶æéå°ç æä»¶ç³»ç»ã\n\næä»¶ç³»ç»ç±ç®å½åæä»¶ç»æãæ¯ä¸ªç®å½é½å¯ä»¥è£åå®¹ãç®å½çåå®¹å¯ä»¥æ¯æä»¶ï¼ä¹ å¯ä»¥æ¯ç®å½ã\n\næç§è¿ç§æ¹å¼ï¼è®¡ç®æºçæä»¶ç³»ç»å°±æ¯ä»¥éå½ç»ææ¥ç»ç»çãå¦æä½ æ³è¦æè¿°è¿æ ·çæ°æ®ç»æï¼é£ä¹ä½ å¯ä»¥ä½¿ç¨ç»åæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. ç»ä»¶ ï¼Componentï¼ æ¥å£æè¿°äºæ ä¸­ç®åé¡¹ç®åå¤æé¡¹ç®æå±æçæä½ã\n 2. å¶èç¹ ï¼Leafï¼ æ¯æ çåºæ¬ç»æï¼ å®ä¸åå«å­é¡¹ç®ãä¸è¬æåµä¸ï¼ å¶èç¹æç»ä¼å®æå¤§é¨åçå®éå·¥ä½ï¼ å ä¸ºå®ä»¬æ æ³å°å·¥ä½ææ´¾ç»å¶ä»é¨åã\n 3. å®¹å¨ ï¼Containerï¼ââåå âç»å ï¼Compositeï¼âââæ¯åå«å¶èç¹æå¶ä»å®¹å¨ç­å­é¡¹ç®çåä½ã å®¹å¨ä¸ç¥éå¶å­é¡¹ç®æå±çå·ä½ç±»ï¼ å®åªéè¿éç¨çç»ä»¶æ¥å£ä¸å¶å­é¡¹ç®äº¤äºãå®¹å¨æ¥æ¶å°è¯·æ±åä¼å°å·¥ä½åéç»èªå·±çå­é¡¹ç®ï¼ å¤çä¸­é´ç»æï¼ ç¶åå°æç»ç»æè¿åç»å®¢æ·ç«¯ã\n 4. å®¢æ·ç«¯ ï¼Clientï¼ éè¿ç»ä»¶æ¥å£ä¸ææé¡¹ç®äº¤äºã å æ­¤ï¼ å®¢æ·ç«¯è½ä»¥ç¸åæ¹å¼ä¸æ ç¶ç»æä¸­çç®åæå¤æé¡¹ç®äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nComponent : ç»åä¸­çå¯¹è±¡å£°ææ¥å£ï¼å¨éå½çæåµä¸ï¼å®ç°ææç±»å±ææ¥å£çé»è®¤è¡ä¸ºãå£°æä¸ä¸ªæ¥å£ç¨äºè®¿é®åç®¡ç Component çå­é¨ä»¶ã\n\nabstract class Component {\n    protected String name;\n\n    public Component(String name) {\n        this.name = name;\n    }\n\n    public abstract void Add(Component c);\n    public abstract void Remove(Component c);\n    public abstract void Display(int depth);\n}\n\n\nLeaf : è¡¨ç¤ºå¶èç¹å¯¹è±¡ãå¶å­èç¹æ²¡æå­èç¹ã\n\nclass Leaf extends Component {\n\n    public Leaf(String name) {\n        super(name);\n    }\n\n    @Override\n    public void Add(Component c) {\n        System.out.println("Can not add to a leaf");\n    }\n\n    @Override\n    public void Remove(Component c) {\n        System.out.println("Can not remove from a leaf");\n    }\n\n    @Override\n    public void Display(int depth) {\n        String temp = "";\n        for (int i = 0; i < depth; i++)\n            temp += \'-\';\n        System.out.println(temp + name);\n    }\n\n}\n\n\nComposite : å®ä¹æèç¹è¡ä¸ºï¼ç¨æ¥å­å¨å­é¨ä»¶ï¼å¨ Component æ¥å£ä¸­å®ç°ä¸å­é¨ä»¶ç¸å³çæä½ãä¾å¦ Add å Removeã\n\nclass Composite extends Component {\n\n    private List<Component> children = new ArrayList<Component>();\n\n    public Composite(String name) {\n        super(name);\n    }\n\n    @Override\n    public void Add(Component c) {\n        children.add(c);\n    }\n\n    @Override\n    public void Remove(Component c) {\n        children.remove(c);\n    }\n\n    @Override\n    public void Display(int depth) {\n        String temp = "";\n        for (int i = 0; i < depth; i++)\n            temp += \'-\';\n        System.out.println(temp + name);\n\n        for (Component c : children) {\n            c.Display(depth + 2);\n        }\n    }\n\n}\n\n\nClient : éè¿ Component æ¥å£æä½ç»æä¸­çå¯¹è±¡ã\n\npublic class CompositePattern {\n\n    public static void main(String[] args) {\n        Composite root = new Composite("root");\n        root.Add(new Leaf("Leaf A"));\n        root.Add(new Leaf("Leaf B"));\n\n        Composite compX = new Composite("Composite X");\n        compX.Add(new Leaf("Leaf XA"));\n        compX.Add(new Leaf("Leaf XB"));\n        root.Add(compX);\n\n        Composite compXY = new Composite("Composite XY");\n        compXY.Add(new Leaf("Leaf XYA"));\n        compXY.Add(new Leaf("Leaf XYB"));\n        compX.Add(compXY);\n\n        root.Display(1);\n    }\n\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ æä»¬å°åå©ç»åæ¨¡å¼å¸®å©ä½ å¨å¾å½¢ç¼è¾å¨ä¸­å®ç°ä¸ç³»åçå ä½å¾å½¢ã\n\n\n\nç»åå¾å½¢CompoundÂ­Graphic æ¯ä¸ä¸ªå®¹å¨ï¼ å®å¯ä»¥ç±å¤ä¸ªåæ¬å®¹å¨å¨åçå­å¾å½¢ææã ç»åå¾å½¢ä¸ç®åå¾å½¢æ¥æç¸åçæ¹æ³ã ä½æ¯ï¼ ç»åå¾å½¢èªèº«å¹¶ä¸å®æå·ä½å·¥ä½ï¼ èæ¯å°è¯·æ±éå½å°ä¼ éç»èªå·±çå­é¡¹ç®ï¼ ç¶å âæ±æ»â ç»æã\n\néè¿ææå¾å½¢ç±»æå±æçæ¥å£ï¼ å®¢æ·ç«¯ä»£ç å¯ä»¥ä¸ææå¾å½¢äºå¨ã å æ­¤ï¼ å®¢æ·ç«¯ä¸ç¥éä¸å¶äº¤äºçæ¯ç®åå¾å½¢è¿æ¯ç»åå¾å½¢ã å®¢æ·ç«¯å¯ä»¥ä¸éå¸¸å¤æçå¯¹è±¡ç»æè¿è¡äº¤äºï¼ èæ éä¸ç»æè¯¥ç»æçå®ä½ç±»ç´§å¯è¦åã\n\n// ç»ä»¶æ¥å£ä¼å£°æç»åä¸­ç®ååå¤æå¯¹è±¡çéç¨æä½ã\ninterface Graphic is\n    method move(x, y)\n    method draw()\n\n// å¶èç¹ç±»ä»£è¡¨ç»åçç»ç«¯å¯¹è±¡ãå¶èç¹å¯¹è±¡ä¸­ä¸è½åå«ä»»ä½å­å¯¹è±¡ãå¶èç¹å¯¹è±¡\n// éå¸¸ä¼å®æå®éçå·¥ä½ï¼ç»åå¯¹è±¡åä»ä¼å°å·¥ä½å§æ´¾ç»èªå·±çå­é¨ä»¶ã\nclass Dot implements Graphic is\n    field x, y\n\n    constructor Dot(x, y) { ... }\n\n    method move(x, y) is\n        this.x += x, this.y += y\n\n    method draw() is\n        // å¨åæ ä½ç½®(X,Y)å¤ç»å¶ä¸ä¸ªç¹ã\n\n// ææç»ä»¶ç±»é½å¯ä»¥æ©å±å¶ä»ç»ä»¶ã\nclass Circle extends Dot is\n    field radius\n\n    constructor Circle(x, y, radius) { ... }\n\n    method draw() is\n        // å¨åæ ä½ç½®(X,Y)å¤ç»å¶ä¸ä¸ªåå¾ä¸º R çåã\n\n// ç»åç±»è¡¨ç¤ºå¯è½åå«å­é¡¹ç®çå¤æç»ä»¶ãç»åå¯¹è±¡éå¸¸ä¼å°å®éå·¥ä½å§æ´¾ç»å­é¡¹\n// ç®ï¼ç¶åâæ±æ»âç»æã\nclass CompoundGraphic implements Graphic is\n    field children: array of Graphic\n\n    // ç»åå¯¹è±¡å¯å¨å¶é¡¹ç®åè¡¨ä¸­æ·»å æç§»é¤å¶ä»ç»ä»¶ï¼ç®åçæå¤æççå¯ï¼ã\n    method add(child: Graphic) is\n        // å¨å­é¡¹ç®æ°ç»ä¸­æ·»å ä¸ä¸ªå­é¡¹ç®ã\n\n    method remove(child: Graphic) is\n        // ä»å­é¡¹ç®æ°ç»ä¸­ç§»é¤ä¸ä¸ªå­é¡¹ç®ã\n\n    method move(x, y) is\n        foreach (child in children) do\n            child.move(x, y)\n\n    // ç»åä¼ä»¥ç¹å®çæ¹å¼æ§è¡å¶ä¸»è¦é»è¾ãå®ä¼éå½éåææå­é¡¹ç®ï¼å¹¶æ¶éå\n    // æ±æ»å¶ç»æãç±äºç»åçå­é¡¹ç®ä¹ä¼å°è°ç¨ä¼ éç»èªå·±çå­é¡¹ç®ï¼ä»¥æ­¤ç±»æ¨ï¼\n    // æåç»åå°ä¼å®ææ´ä¸ªå¯¹è±¡æ çéåå·¥ä½ã\n    method draw() is\n        // 1. å¯¹äºæ¯ä¸ªå­é¨ä»¶ï¼\n        //     - ç»å¶è¯¥é¨ä»¶ã\n        //     - æ´æ°è¾¹æ¡åæ ã\n        // 2. æ ¹æ®è¾¹æ¡åæ ç»å¶ä¸ä¸ªèçº¿é¿æ¹å½¢ã\n\n\n// å®¢æ·ç«¯ä»£ç ä¼éè¿åºç¡æ¥å£ä¸ææç»ä»¶è¿è¡äº¤äºãè¿æ ·ä¸æ¥ï¼å®¢æ·ç«¯ä»£ç ä¾¿å¯å\n// æ¶æ¯æç®åå¶èç¹ç»ä»¶åå¤æç»ä»¶ã\nclass ImageEditor is\n    field all: CompoundGraphic\n\n    method load() is\n        all = new CompoundGraphic()\n        all.add(new Dot(1, 2))\n        all.add(new Circle(5, 3, 10))\n        // ...\n\n    // å°æéç»ä»¶ç»åä¸ºå¤æçç»åç»ä»¶ã\n    method groupSelected(components: array of Graphic) is\n        group = new CompoundGraphic()\n        foreach (component in components) do\n            group.add(component)\n            all.remove(component)\n        all.add(group)\n        // ææç»ä»¶é½å°è¢«ç»å¶ã\n        all.draw()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨å®ä¾ï¼ ç»åæ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§,å¸¸ç¨äºè¡¨ç¤ºä¸å¾å½¢æäº¤éçç¨æ·çé¢ç»ä»¶æä»£ç çå±æ¬¡ç»æã\n\nä¸é¢æ¯ä¸äºæ¥èª Java æ åç¨åºåºä¸­çç»åç¤ºä¾ï¼\n\n * java.awt.Container#add(Component) ï¼å ä¹å¹¿æ³å­å¨äº Swing ç»ä»¶ä¸­ï¼\n * javax.faces.component.UIComponent#getChildren() ï¼å ä¹å¹¿æ³å­å¨äº JSF UI ç»ä»¶ä¸­ï¼\n\nè¯å«æ¹æ³ï¼ ç»åå¯ä»¥éè¿å°åä¸æ½è±¡ææ¥å£ç±»åçå®ä¾æ¾å¥æ ç¶ç»æçè¡ä¸ºæ¹æ³æ¥è½»æ¾è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ä½ å¯ä»¥å¨åå»ºå¤æç»åæ æ¶ä½¿ç¨çæå¨æ¨¡å¼ï¼ å ä¸ºè¿å¯ä½¿å¶æé æ­¥éª¤ä»¥éå½çæ¹å¼è¿è¡ã\n * è´£ä»»é¾æ¨¡å¼éå¸¸åç»åæ¨¡å¼ç»åä½¿ç¨ã å¨è¿ç§æåµä¸ï¼ å¶ç»ä»¶æ¥æ¶å°è¯·æ±åï¼ å¯ä»¥å°è¯·æ±æ²¿åå«å¨ä½ç¶ç»ä»¶çé¾ä¸ç´ä¼ éè³å¯¹è±¡æ çåºé¨ã\n * ä½ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼æ¥éåç»åæ ã\n * ä½ å¯ä»¥ä½¿ç¨è®¿é®èæ¨¡å¼å¯¹æ´ä¸ªç»åæ æ§è¡æä½ã\n * ä½ å¯ä»¥ä½¿ç¨äº«åæ¨¡å¼å®ç°ç»åæ çå±äº«å¶èç¹ä»¥èçåå­ã\n * ç»ååè£é¥°æ¨¡å¼çç»æå¾å¾ç¸ä¼¼ï¼ å ä¸ºä¸¤èé½ä¾èµéå½ç»åæ¥ç»ç»æ éæ°éçå¯¹è±¡ã\n   * è£é¥°ç±»ä¼¼äºç»åï¼ ä½å¶åªæä¸ä¸ªå­ç»ä»¶ã æ­¤å¤è¿æä¸ä¸ªææ¾ä¸åï¼ è£é¥°ä¸ºè¢«å°è£å¯¹è±¡æ·»å äºé¢å¤çèè´£ï¼ ç»åä»å¯¹å¶å­èç¹çç»æè¿è¡äº âæ±åâã\n   * ä½æ¯ï¼ æ¨¡å¼ä¹å¯ä»¥ç¸äºåä½ï¼ ä½ å¯ä»¥ä½¿ç¨è£é¥°æ¥æ©å±ç»åæ ä¸­ç¹å®å¯¹è±¡çè¡ä¸ºã\n * å¤§éä½¿ç¨ç»ååè£é¥°çè®¾è®¡éå¸¸å¯ä»å¯¹äºååæ¨¡å¼çä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ç»åæ¨¡å¼\n\n\n# 1. æå¾\n\nç»åæ¨¡å¼ (component) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å°å¯¹è±¡ç»åææ å½¢ç»æä»¥è¡¨ç¤ºâé¨å-æ´ä½âçå±æ¬¡ç»æã\n\nç»åæ¨¡å¼ä½¿å¾ç¨æ·å¯¹åä¸ªå¯¹è±¡åç»åå¯¹è±¡çä½¿ç¨å·æå¯ä¸æ§ã\n\n\n# 2. éç¨åºæ¯\n\nç»åæ¨¡å¼çéç¨åºæ¯ï¼\n\n * æ³è¦è¡¨ç¤ºå¯¹è±¡çé¨å-æ´ä½å±æ¬¡ç»æã\n * æ³è¦å®¢æ·ç«¯å¿½ç¥ç»åå¯¹è±¡ä¸åä¸ªå¯¹è±¡çå·®å¼ï¼å®¢æ·ç«¯å°ç»ä¸å°ä½¿ç¨ç»åç»æä¸­çææå¯¹è±¡ã\n\nå³äºåçº§æ°æ®ç»æçä¸ä¸ªæ®éæ§çä¾å­æ¯ä½ æ¯æ¬¡ä½¿ç¨çµèæ¶æéå°ç æä»¶ç³»ç»ã\n\næä»¶ç³»ç»ç±ç®å½åæä»¶ç»æãæ¯ä¸ªç®å½é½å¯ä»¥è£åå®¹ãç®å½çåå®¹å¯ä»¥æ¯æä»¶ï¼ä¹ å¯ä»¥æ¯ç®å½ã\n\næç§è¿ç§æ¹å¼ï¼è®¡ç®æºçæä»¶ç³»ç»å°±æ¯ä»¥éå½ç»ææ¥ç»ç»çãå¦æä½ æ³è¦æè¿°è¿æ ·çæ°æ®ç»æï¼é£ä¹ä½ å¯ä»¥ä½¿ç¨ç»åæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. ç»ä»¶ ï¼componentï¼ æ¥å£æè¿°äºæ ä¸­ç®åé¡¹ç®åå¤æé¡¹ç®æå±æçæä½ã\n 2. å¶èç¹ ï¼leafï¼ æ¯æ çåºæ¬ç»æï¼ å®ä¸åå«å­é¡¹ç®ãä¸è¬æåµä¸ï¼ å¶èç¹æç»ä¼å®æå¤§é¨åçå®éå·¥ä½ï¼ å ä¸ºå®ä»¬æ æ³å°å·¥ä½ææ´¾ç»å¶ä»é¨åã\n 3. å®¹å¨ ï¼containerï¼ââåå âç»å ï¼compositeï¼âââæ¯åå«å¶èç¹æå¶ä»å®¹å¨ç­å­é¡¹ç®çåä½ã å®¹å¨ä¸ç¥éå¶å­é¡¹ç®æå±çå·ä½ç±»ï¼ å®åªéè¿éç¨çç»ä»¶æ¥å£ä¸å¶å­é¡¹ç®äº¤äºãå®¹å¨æ¥æ¶å°è¯·æ±åä¼å°å·¥ä½åéç»èªå·±çå­é¡¹ç®ï¼ å¤çä¸­é´ç»æï¼ ç¶åå°æç»ç»æè¿åç»å®¢æ·ç«¯ã\n 4. å®¢æ·ç«¯ ï¼clientï¼ éè¿ç»ä»¶æ¥å£ä¸ææé¡¹ç®äº¤äºã å æ­¤ï¼ å®¢æ·ç«¯è½ä»¥ç¸åæ¹å¼ä¸æ ç¶ç»æä¸­çç®åæå¤æé¡¹ç®äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\ncomponent : ç»åä¸­çå¯¹è±¡å£°ææ¥å£ï¼å¨éå½çæåµä¸ï¼å®ç°ææç±»å±ææ¥å£çé»è®¤è¡ä¸ºãå£°æä¸ä¸ªæ¥å£ç¨äºè®¿é®åç®¡ç component çå­é¨ä»¶ã\n\nabstract class component {\n    protected string name;\n\n    public component(string name) {\n        this.name = name;\n    }\n\n    public abstract void add(component c);\n    public abstract void remove(component c);\n    public abstract void display(int depth);\n}\n\n\nleaf : è¡¨ç¤ºå¶èç¹å¯¹è±¡ãå¶å­èç¹æ²¡æå­èç¹ã\n\nclass leaf extends component {\n\n    public leaf(string name) {\n        super(name);\n    }\n\n    @override\n    public void add(component c) {\n        system.out.println("can not add to a leaf");\n    }\n\n    @override\n    public void remove(component c) {\n        system.out.println("can not remove from a leaf");\n    }\n\n    @override\n    public void display(int depth) {\n        string temp = "";\n        for (int i = 0; i < depth; i++)\n            temp += \'-\';\n        system.out.println(temp + name);\n    }\n\n}\n\n\ncomposite : å®ä¹æèç¹è¡ä¸ºï¼ç¨æ¥å­å¨å­é¨ä»¶ï¼å¨ component æ¥å£ä¸­å®ç°ä¸å­é¨ä»¶ç¸å³çæä½ãä¾å¦ add å removeã\n\nclass composite extends component {\n\n    private list<component> children = new arraylist<component>();\n\n    public composite(string name) {\n        super(name);\n    }\n\n    @override\n    public void add(component c) {\n        children.add(c);\n    }\n\n    @override\n    public void remove(component c) {\n        children.remove(c);\n    }\n\n    @override\n    public void display(int depth) {\n        string temp = "";\n        for (int i = 0; i < depth; i++)\n            temp += \'-\';\n        system.out.println(temp + name);\n\n        for (component c : children) {\n            c.display(depth + 2);\n        }\n    }\n\n}\n\n\nclient : éè¿ component æ¥å£æä½ç»æä¸­çå¯¹è±¡ã\n\npublic class compositepattern {\n\n    public static void main(string[] args) {\n        composite root = new composite("root");\n        root.add(new leaf("leaf a"));\n        root.add(new leaf("leaf b"));\n\n        composite compx = new composite("composite x");\n        compx.add(new leaf("leaf xa"));\n        compx.add(new leaf("leaf xb"));\n        root.add(compx);\n\n        composite compxy = new composite("composite xy");\n        compxy.add(new leaf("leaf xya"));\n        compxy.add(new leaf("leaf xyb"));\n        compx.add(compxy);\n\n        root.display(1);\n    }\n\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ æä»¬å°åå©ç»åæ¨¡å¼å¸®å©ä½ å¨å¾å½¢ç¼è¾å¨ä¸­å®ç°ä¸ç³»åçå ä½å¾å½¢ã\n\n\n\nç»åå¾å½¢compoundÂ­graphic æ¯ä¸ä¸ªå®¹å¨ï¼ å®å¯ä»¥ç±å¤ä¸ªåæ¬å®¹å¨å¨åçå­å¾å½¢ææã ç»åå¾å½¢ä¸ç®åå¾å½¢æ¥æç¸åçæ¹æ³ã ä½æ¯ï¼ ç»åå¾å½¢èªèº«å¹¶ä¸å®æå·ä½å·¥ä½ï¼ èæ¯å°è¯·æ±éå½å°ä¼ éç»èªå·±çå­é¡¹ç®ï¼ ç¶å âæ±æ»â ç»æã\n\néè¿ææå¾å½¢ç±»æå±æçæ¥å£ï¼ å®¢æ·ç«¯ä»£ç å¯ä»¥ä¸ææå¾å½¢äºå¨ã å æ­¤ï¼ å®¢æ·ç«¯ä¸ç¥éä¸å¶äº¤äºçæ¯ç®åå¾å½¢è¿æ¯ç»åå¾å½¢ã å®¢æ·ç«¯å¯ä»¥ä¸éå¸¸å¤æçå¯¹è±¡ç»æè¿è¡äº¤äºï¼ èæ éä¸ç»æè¯¥ç»æçå®ä½ç±»ç´§å¯è¦åã\n\n// ç»ä»¶æ¥å£ä¼å£°æç»åä¸­ç®ååå¤æå¯¹è±¡çéç¨æä½ã\ninterface graphic is\n    method move(x, y)\n    method draw()\n\n// å¶èç¹ç±»ä»£è¡¨ç»åçç»ç«¯å¯¹è±¡ãå¶èç¹å¯¹è±¡ä¸­ä¸è½åå«ä»»ä½å­å¯¹è±¡ãå¶èç¹å¯¹è±¡\n// éå¸¸ä¼å®æå®éçå·¥ä½ï¼ç»åå¯¹è±¡åä»ä¼å°å·¥ä½å§æ´¾ç»èªå·±çå­é¨ä»¶ã\nclass dot implements graphic is\n    field x, y\n\n    constructor dot(x, y) { ... }\n\n    method move(x, y) is\n        this.x += x, this.y += y\n\n    method draw() is\n        // å¨åæ ä½ç½®(x,y)å¤ç»å¶ä¸ä¸ªç¹ã\n\n// ææç»ä»¶ç±»é½å¯ä»¥æ©å±å¶ä»ç»ä»¶ã\nclass circle extends dot is\n    field radius\n\n    constructor circle(x, y, radius) { ... }\n\n    method draw() is\n        // å¨åæ ä½ç½®(x,y)å¤ç»å¶ä¸ä¸ªåå¾ä¸º r çåã\n\n// ç»åç±»è¡¨ç¤ºå¯è½åå«å­é¡¹ç®çå¤æç»ä»¶ãç»åå¯¹è±¡éå¸¸ä¼å°å®éå·¥ä½å§æ´¾ç»å­é¡¹\n// ç®ï¼ç¶åâæ±æ»âç»æã\nclass compoundgraphic implements graphic is\n    field children: array of graphic\n\n    // ç»åå¯¹è±¡å¯å¨å¶é¡¹ç®åè¡¨ä¸­æ·»å æç§»é¤å¶ä»ç»ä»¶ï¼ç®åçæå¤æççå¯ï¼ã\n    method add(child: graphic) is\n        // å¨å­é¡¹ç®æ°ç»ä¸­æ·»å ä¸ä¸ªå­é¡¹ç®ã\n\n    method remove(child: graphic) is\n        // ä»å­é¡¹ç®æ°ç»ä¸­ç§»é¤ä¸ä¸ªå­é¡¹ç®ã\n\n    method move(x, y) is\n        foreach (child in children) do\n            child.move(x, y)\n\n    // ç»åä¼ä»¥ç¹å®çæ¹å¼æ§è¡å¶ä¸»è¦é»è¾ãå®ä¼éå½éåææå­é¡¹ç®ï¼å¹¶æ¶éå\n    // æ±æ»å¶ç»æãç±äºç»åçå­é¡¹ç®ä¹ä¼å°è°ç¨ä¼ éç»èªå·±çå­é¡¹ç®ï¼ä»¥æ­¤ç±»æ¨ï¼\n    // æåç»åå°ä¼å®ææ´ä¸ªå¯¹è±¡æ çéåå·¥ä½ã\n    method draw() is\n        // 1. å¯¹äºæ¯ä¸ªå­é¨ä»¶ï¼\n        //     - ç»å¶è¯¥é¨ä»¶ã\n        //     - æ´æ°è¾¹æ¡åæ ã\n        // 2. æ ¹æ®è¾¹æ¡åæ ç»å¶ä¸ä¸ªèçº¿é¿æ¹å½¢ã\n\n\n// å®¢æ·ç«¯ä»£ç ä¼éè¿åºç¡æ¥å£ä¸ææç»ä»¶è¿è¡äº¤äºãè¿æ ·ä¸æ¥ï¼å®¢æ·ç«¯ä»£ç ä¾¿å¯å\n// æ¶æ¯æç®åå¶èç¹ç»ä»¶åå¤æç»ä»¶ã\nclass imageeditor is\n    field all: compoundgraphic\n\n    method load() is\n        all = new compoundgraphic()\n        all.add(new dot(1, 2))\n        all.add(new circle(5, 3, 10))\n        // ...\n\n    // å°æéç»ä»¶ç»åä¸ºå¤æçç»åç»ä»¶ã\n    method groupselected(components: array of graphic) is\n        group = new compoundgraphic()\n        foreach (component in components) do\n            group.add(component)\n            all.remove(component)\n        all.add(group)\n        // ææç»ä»¶é½å°è¢«ç»å¶ã\n        all.draw()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨å®ä¾ï¼ ç»åæ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§,å¸¸ç¨äºè¡¨ç¤ºä¸å¾å½¢æäº¤éçç¨æ·çé¢ç»ä»¶æä»£ç çå±æ¬¡ç»æã\n\nä¸é¢æ¯ä¸äºæ¥èª java æ åç¨åºåºä¸­çç»åç¤ºä¾ï¼\n\n * java.awt.container#add(component) ï¼å ä¹å¹¿æ³å­å¨äº swing ç»ä»¶ä¸­ï¼\n * javax.faces.component.uicomponent#getchildren() ï¼å ä¹å¹¿æ³å­å¨äº jsf ui ç»ä»¶ä¸­ï¼\n\nè¯å«æ¹æ³ï¼ ç»åå¯ä»¥éè¿å°åä¸æ½è±¡ææ¥å£ç±»åçå®ä¾æ¾å¥æ ç¶ç»æçè¡ä¸ºæ¹æ³æ¥è½»æ¾è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ä½ å¯ä»¥å¨åå»ºå¤æç»åæ æ¶ä½¿ç¨çæå¨æ¨¡å¼ï¼ å ä¸ºè¿å¯ä½¿å¶æé æ­¥éª¤ä»¥éå½çæ¹å¼è¿è¡ã\n * è´£ä»»é¾æ¨¡å¼éå¸¸åç»åæ¨¡å¼ç»åä½¿ç¨ã å¨è¿ç§æåµä¸ï¼ å¶ç»ä»¶æ¥æ¶å°è¯·æ±åï¼ å¯ä»¥å°è¯·æ±æ²¿åå«å¨ä½ç¶ç»ä»¶çé¾ä¸ç´ä¼ éè³å¯¹è±¡æ çåºé¨ã\n * ä½ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼æ¥éåç»åæ ã\n * ä½ å¯ä»¥ä½¿ç¨è®¿é®èæ¨¡å¼å¯¹æ´ä¸ªç»åæ æ§è¡æä½ã\n * ä½ å¯ä»¥ä½¿ç¨äº«åæ¨¡å¼å®ç°ç»åæ çå±äº«å¶èç¹ä»¥èçåå­ã\n * ç»ååè£é¥°æ¨¡å¼çç»æå¾å¾ç¸ä¼¼ï¼ å ä¸ºä¸¤èé½ä¾èµéå½ç»åæ¥ç»ç»æ éæ°éçå¯¹è±¡ã\n   * è£é¥°ç±»ä¼¼äºç»åï¼ ä½å¶åªæä¸ä¸ªå­ç»ä»¶ã æ­¤å¤è¿æä¸ä¸ªææ¾ä¸åï¼ è£é¥°ä¸ºè¢«å°è£å¯¹è±¡æ·»å äºé¢å¤çèè´£ï¼ ç»åä»å¯¹å¶å­èç¹çç»æè¿è¡äº âæ±åâã\n   * ä½æ¯ï¼ æ¨¡å¼ä¹å¯ä»¥ç¸äºåä½ï¼ ä½ å¯ä»¥ä½¿ç¨è£é¥°æ¥æ©å±ç»åæ ä¸­ç¹å®å¯¹è±¡çè¡ä¸ºã\n * å¤§éä½¿ç¨ç»ååè£é¥°çè®¾è®¡éå¸¸å¯ä»å¯¹äºååæ¨¡å¼çä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹è£é¥°æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹è£é¥°æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-15T15:41:00.000Z",permalink:"/pages/12897e/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/10.%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/10.è£é¥°æ¨¡å¼.md",key:"v-2c19e87c",path:"/pages/12897e/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éååºæ¯",slug:"_2-éååºæ¯",normalizedTitle:"2. éååºæ¯",charIndex:318},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:428},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:440},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:807},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2806},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:5789},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:6154},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6835}],headersStr:"1. æå¾ 2. éååºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹è£é¥°æ¨¡å¼\n\n\n# 1. æå¾\n\nè£é¥°æ¨¡å¼ (Decorator) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å¨æå°ç»ä¸ä¸ªå¯¹è±¡æ·»å ä¸äºé¢å¤çèè´£ãå°±å¢å åè½æ¥è¯´ï¼Decorator æ¨¡å¼ç¸æ¯çæå­ç±»æ´ä¸ºçµæ´»ã\n\n * è£é¥°å¯¹è±¡åçå®å¯¹è±¡æç¸åçæ¥å£ãè¿æ ·å®¢æ·ç«¯å¯¹è±¡å°±è½ä»¥åçå®å¯¹è±¡ç¸åçæ¹å¼åè£é¥°å¯¹è±¡äº¤äºã\n * è£é¥°å¯¹è±¡åå«ä¸ä¸ªçå®å¯¹è±¡çå¼ç¨ï¼referenceï¼ã\n * è£é¥°å¯¹è±¡æ¥åæææ¥èªå®¢æ·ç«¯çè¯·æ±ãå®æè¿äºè¯·æ±è½¬åç»çå®çå¯¹è±¡ã\n * è£é¥°å¯¹è±¡å¯ä»¥å¨è½¬åè¿äºè¯·æ±ä»¥åæä»¥åå¢å ä¸äºéå åè½ãè¿æ ·å°±ç¡®ä¿äºå¨è¿è¡æ¶ï¼ä¸ç¨ä¿®æ¹ç»å®å¯¹è±¡çç»æå°±å¯ä»¥å¨å¤é¨å¢å éå çåè½ãå¨é¢åå¯¹è±¡çè®¾è®¡ä¸­ï¼éå¸¸æ¯éè¿ç»§æ¿æ¥å®ç°å¯¹ç»å®ç±»çåè½æ©å±ã\n\n\n# 2. éååºæ¯\n\n * å¦æä½ å¸æå¨æ éä¿®æ¹ä»£ç çæåµä¸å³å¯ä½¿ç¨å¯¹è±¡ï¼ ä¸å¸æå¨è¿è¡æ¶ä¸ºå¯¹è±¡æ°å¢é¢å¤çè¡ä¸ºï¼ å¯ä»¥ä½¿ç¨è£é¥°æ¨¡å¼ã\n * å¦æç¨ç»§æ¿æ¥æ©å±å¯¹è±¡è¡ä¸ºçæ¹æ¡é¾ä»¥å®ç°æèæ ¹æ¬ä¸å¯è¡ï¼ ä½ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. é¨ä»¶ ï¼Componentï¼ å£°æå°è£å¨åè¢«å°è£å¯¹è±¡çå¬ç¨æ¥å£ã\n 2. å·ä½é¨ä»¶ ï¼Concrete Componentï¼ ç±»æ¯è¢«å°è£å¯¹è±¡æå±çç±»ã å®å®ä¹äºåºç¡è¡ä¸ºï¼ ä½è£é¥°ç±»å¯ä»¥æ¹åè¿äºè¡ä¸ºã\n 3. åºç¡è£é¥° ï¼Base Decoratorï¼ ç±»æ¥æä¸ä¸ªæåè¢«å°è£å¯¹è±¡çå¼ç¨æååéã è¯¥åéçç±»ååºå½è¢«å£°æä¸ºéç¨é¨ä»¶æ¥å£ï¼ è¿æ ·å®å°±å¯ä»¥å¼ç¨å·ä½çé¨ä»¶åè£é¥°ã è£é¥°åºç±»ä¼å°æææä½å§æ´¾ç»è¢«å°è£çå¯¹è±¡ã\n 4. å·ä½è£é¥°ç±» ï¼Concrete Decoratorsï¼ å®ä¹äºå¯å¨ææ·»å å°é¨ä»¶çé¢å¤è¡ä¸ºã å·ä½è£é¥°ç±»ä¼éåè£é¥°åºç±»çæ¹æ³ï¼ å¹¶å¨è°ç¨ç¶ç±»æ¹æ³ä¹åæä¹åè¿è¡é¢å¤çè¡ä¸ºã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ å¯ä»¥ä½¿ç¨å¤å±è£é¥°æ¥å°è£é¨ä»¶ï¼ åªè¦å®è½ä½¿ç¨éç¨æ¥å£ä¸ææå¯¹è±¡äºå¨å³å¯ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nComponent : å®ä¹ä¸ä¸ªå¯¹è±¡æ¥å£ï¼å¯ä»¥ç»è¿äºå¯¹è±¡å¨æå°æ·»å èè´£ã\n\ninterface Component {\n    public void operation();\n}\n\n\nConcreteComponent : å®ç° Component å®ä¹çæ¥å£ã\n\nclass ConcreteComponent implements Component {\n    @Override\n    public void operation() {\n        System.out.println("åå§è¡ä¸º");\n    }\n}\n\n\nDecorator : è£é¥°æ½è±¡ç±»ï¼ç»§æ¿äº Componentï¼ ä»å¤ç±»æ¥æ©å± Component ç±»çåè½ï¼ä½å¯¹äº Component æ¥è¯´ï¼æ¯æ éç¥é Decorator çå­å¨çã\n\nclass Decorator implements Component {\n    // ææä¸ä¸ª Component å¯¹è±¡ï¼å Component å½¢æèåå³ç³»\n    protected Component component;\n\n    // ä¼ å¥è¦è¿ä¸æ­¥ä¿®é¥°çå¯¹è±¡\n    public Decorator(Component component) {\n        this.component = component;\n    }\n\n    @Override\n    // è°ç¨è¦ä¿®é¥°å¯¹è±¡çåæ¹æ³\n    public void operation() {\n        component.operation();\n    }\n}\n\n\nConcreteDecorator : å·ä½çè£é¥°å¯¹è±¡ï¼èµ·å°ç» Component æ·»å èè´£çåè½ã\n\nclass ConcreteDecoratorA extends Decorator {\n    private String addedState = "æ°å±æ§1";\n\n    public ConcreteDecoratorA(Component component) {\n        super(component);\n    }\n\n    public void operation() {\n        super.operation();\n        System.out.println("æ·»å å±æ§: " + addedState);\n    }\n}\n\nclass ConcreteDecoratorB extends Decorator {\n    public ConcreteDecoratorB(Component component) {\n        super(component);\n    }\n\n    public void operation() {\n        super.operation();\n        AddedBehavior();\n    }\n\n    public void AddedBehavior() {\n        System.out.println("æ·»å è¡ä¸º");\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class DecoratorPattern {\n    public static void main(String[] args) {\n        Component component = new ConcreteComponent();\n        component.operation();\n\n        System.out.println("======================================");\n        Decorator decoratorA = new ConcreteDecoratorA(component);\n        decoratorA.operation();\n\n        System.out.println("======================================");\n        Decorator decoratorB = new ConcreteDecoratorB(decoratorA);\n        decoratorB.operation();\n    }\n}\n\n\nãè¾åºã\n\nåå§è¡ä¸º\n======================================\nåå§è¡ä¸º\næ·»å å±æ§: æ°å±æ§1\n======================================\nåå§è¡ä¸º\næ·»å å±æ§: æ°å±æ§1\næ·»å è¡ä¸º\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nå¨æ¬ä¾ä¸­ï¼ è£é¥°æ¨¡å¼è½å¤å¯¹æææ°æ®è¿è¡åç¼©åå å¯ï¼ ä»èå°æ°æ®ä»ä½¿ç¨æ°æ®çä»£ç ä¸­ç¬ç«åºæ¥ã\n\nç¨åºä½¿ç¨ä¸å¯¹è£é¥°æ¥å°è£æ°æ®æºå¯¹è±¡ã è¿ä¸¤ä¸ªå°è£å¨é½æ¹åäºä»ç£çè¯»åæ°æ®çæ¹å¼ï¼\n\n * å½æ°æ®å³å°è¢«åå¥ç£çåï¼ è£é¥°å¯¹æ°æ®è¿è¡å å¯ååç¼©ã å¨åå§ç±»å¯¹æ¹åæ¯«æ å¯è§çæåµä¸ï¼ å°å å¯åçåä¿æ¤æ°æ®åå¥æä»¶ã\n * å½æ°æ®åä»ç£çè¯»åºåï¼ åæ ·éè¿è£é¥°å¯¹æ°æ®è¿è¡è§£ååè§£å¯ã è£é¥°åæ°æ®æºç±»å®ç°åä¸æ¥å£ï¼ ä»èè½å¨å®¢æ·ç«¯ä»£ç ä¸­ç¸äºæ¿æ¢ã\n\n// è£é¥°å¯ä»¥æ¹åç»ä»¶æ¥å£æå®ä¹çæä½ã\ninterface DataSource is\n    method writeData(data)\n    method readData():data\n\n// å·ä½ç»ä»¶æä¾æä½çé»è®¤å®ç°ãè¿äºç±»å¨ç¨åºä¸­å¯è½ä¼æå ä¸ªåä½ã\nclass FileDataSource implements DataSource is\n    constructor FileDataSource(filename) { ... }\n\n    method writeData(data) is\n        // å°æ°æ®åå¥æä»¶ã\n\n    method readData():data is\n        // ä»æä»¶è¯»åæ°æ®ã\n\n// è£é¥°åºç±»åå¶ä»ç»ä»¶éµå¾ªç¸åçæ¥å£ãè¯¥ç±»çä¸»è¦ä»»å¡æ¯å®ä¹ææå·ä½è£é¥°çå°\n// è£æ¥å£ãå°è£çé»è®¤å®ç°ä»£ç ä¸­å¯è½ä¼åå«ä¸ä¸ªä¿å­è¢«å°è£ç»ä»¶çæååéï¼å¹¶\n// ä¸è´è´£å¯¹å¶è¿è¡åå§åã\nclass DataSourceDecorator implements DataSource is\n    protected field wrappee: DataSource\n\n    constructor DataSourceDecorator(source: DataSource) is\n        wrappee = source\n\n    // è£é¥°åºç±»ä¼ç´æ¥å°ææå·¥ä½åæ´¾ç»è¢«å°è£ç»ä»¶ãå·ä½è£é¥°ä¸­åå¯ä»¥æ°å¢ä¸äº\n    // é¢å¤çè¡ä¸ºã\n    method writeData(data) is\n        wrappee.writeData(data)\n\n    // å·ä½è£é¥°å¯è°ç¨å¶ç¶ç±»çæä½å®ç°ï¼èä¸æ¯ç´æ¥è°ç¨è¢«å°è£å¯¹è±¡ãè¿ç§æ¹å¼\n    // å¯ç®åè£é¥°ç±»çæ©å±å·¥ä½ã\n    method readData():data is\n        return wrappee.readData()\n\n// å·ä½è£é¥°å¿é¡»å¨è¢«å°è£å¯¹è±¡ä¸è°ç¨æ¹æ³ï¼ä¸è¿ä¹å¯ä»¥èªè¡å¨ç»æä¸­æ·»å ä¸äºåå®¹ã\n// è£é¥°å¿é¡»å¨è°ç¨å°è£å¯¹è±¡ä¹åæä¹åæ§è¡é¢å¤çè¡ä¸ºã\nclass EncryptionDecorator extends DataSourceDecorator is\n    method writeData(data) is\n        // 1. å¯¹ä¼ éæ°æ®è¿è¡å å¯ã\n        // 2. å°å å¯åæ°æ®ä¼ éç»è¢«å°è£å¯¹è±¡ writeDataï¼åå¥æ°æ®ï¼æ¹æ³ã\n\n    method readData():data is\n        // 1. éè¿è¢«å°è£å¯¹è±¡ç readDataï¼è¯»åæ°æ®ï¼æ¹æ³è·åæ°æ®ã\n        // 2. å¦ææ°æ®è¢«å å¯å°±å°è¯è§£å¯ã\n        // 3. è¿åç»æã\n\n// ä½ å¯ä»¥å°å¯¹è±¡å°è£å¨å¤å±è£é¥°ä¸­ã\nclass CompressionDecorator extends DataSourceDecorator is\n    method writeData(data) is\n        // 1. åç¼©ä¼ éæ°æ®ã\n        // 2. å°åç¼©åæ°æ®ä¼ éç»è¢«å°è£å¯¹è±¡ writeDataï¼åå¥æ°æ®ï¼æ¹æ³ã\n\n    method readData():data is\n        // 1. éè¿è¢«å°è£å¯¹è±¡ç readDataï¼è¯»åæ°æ®ï¼æ¹æ³è·åæ°æ®ã\n        // 2. å¦ææ°æ®è¢«åç¼©å°±å°è¯è§£åã\n        // 3. è¿åç»æã\n\n\n// éé¡¹ 1ï¼è£é¥°ç»ä»¶çç®åç¤ºä¾\nclass Application is\n    method dumbUsageExample() is\n        source = new FileDataSource("somefile.dat")\n        source.writeData(salaryRecords)\n        // å·²å°æç æ°æ®åå¥ç®æ æä»¶ã\n\n        source = new CompressionDecorator(source)\n        source.writeData(salaryRecords)\n        // å·²å°åç¼©æ°æ®åå¥ç®æ æä»¶ã\n\n        source = new EncryptionDecorator(source)\n        // æºåéä¸­ç°å¨åå«ï¼\n        // Encryption > Compression > FileDataSource\n        source.writeData(salaryRecords)\n        // å·²å°åç¼©ä¸å å¯çæ°æ®åå¥ç®æ æä»¶ã\n\n\n// éé¡¹ 2ï¼å®¢æ·ç«¯ä½¿ç¨å¤é¨æ°æ®æºãSalaryManagerï¼å·¥èµç®¡çå¨ï¼å¯¹è±¡å¹¶ä¸å³å¿\n// æ°æ®å¦ä½å­å¨ãå®ä»¬ä¼ä¸æåéç½®å¥½çæ°æ®æºè¿è¡äº¤äºï¼æ°æ®æºåæ¯éè¿ç¨åºé\n// ç½®å¨è·åçã\nclass SalaryManager is\n    field source: DataSource\n\n    constructor SalaryManager(source: DataSource) { ... }\n\n    method load() is\n        return source.readData()\n\n    method save() is\n        source.writeData(salaryRecords)\n    // ...å¶ä»æç¨çæ¹æ³...\n\n\n// ç¨åºå¯å¨è¿è¡æ¶æ ¹æ®éç½®æç¯å¢ç»è£ä¸åçè£é¥°å æ¡ã\nclass ApplicationConfigurator is\n    method configurationExample() is\n        source = new FileDataSource("salary.dat")\n        if (enabledEncryption)\n            source = new EncryptionDecorator(source)\n        if (enabledCompression)\n            source = new CompressionDecorator(source)\n\n        logger = new SalaryManager(source)\n        salary = logger.load()\n    // ...\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è£é¥°æ¨¡å¼å¨ Java ä»£ç ä¸­å¯è°æ¯æ åéç½®ï¼ å°¤å¶æ¯å¨ä¸æµå¼å è½½ç¸å³çä»£ç ä¸­ã\n\nJava æ ¸å¿ç¨åºåºä¸­æä¸äºå³äºè£é¥°çç¤ºä¾ï¼\n\n * java.io.InputStreamã OutputÂ­Streamã Reader å Writer çææä»£ç é½æä»¥èªèº«ç±»åçå¯¹è±¡ä½ä¸ºåæ°çæé å½æ°ã\n * java.util.Collectionsï¼ checkedÂ­XXX()ã synchronizedÂ­XXX() å unmodifiableÂ­XXX() æ¹æ³ã\n * javax.servlet.http.HttpServletRequestWrapper å HttpÂ­ServletÂ­ResponseÂ­Wrapper\n\nè¯å«æ¹æ³ï¼ è£é¥°å¯éè¿ä»¥å½åç±»æå¯¹è±¡ä¸ºåæ°çåå»ºæ¹æ³ææé å½æ°æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ééå¨æ¨¡å¼å¯ä»¥å¯¹å·²æå¯¹è±¡çæ¥å£è¿è¡ä¿®æ¹ï¼ è£é¥°æ¨¡å¼åè½å¨ä¸æ¹åå¯¹è±¡æ¥å£çåæä¸å¼ºåå¯¹è±¡åè½ã æ­¤å¤ï¼ è£é¥°è¿æ¯æéå½ç»åï¼ ééå¨åæ æ³å®ç°ã\n * ééå¨è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * è´£ä»»é¾æ¨¡å¼åè£é¥°æ¨¡å¼çç±»ç»æéå¸¸ç¸ä¼¼ã ä¸¤èé½ä¾èµéå½ç»åå°éè¦æ§è¡çæä½ä¼ éç»ä¸ç³»åå¯¹è±¡ã ä½æ¯ï¼ ä¸¤èæå ç¹éè¦çä¸åä¹å¤ã\n   * è´£ä»»é¾çç®¡çèå¯ä»¥ç¸äºç¬ç«å°æ§è¡ä¸åæä½ï¼ è¿å¯ä»¥éæ¶åæ­¢ä¼ éè¯·æ±ã å¦ä¸æ¹é¢ï¼ åç§è£é¥°å¯ä»¥å¨éµå¾ªåºæ¬æ¥å£çæåµä¸æ©å±å¯¹è±¡çè¡ä¸ºã æ­¤å¤ï¼ è£é¥°æ æ³ä¸­æ­è¯·æ±çä¼ éã\n * ç»åæ¨¡å¼åè£é¥°çç»æå¾å¾ç¸ä¼¼ï¼ å ä¸ºä¸¤èé½ä¾èµéå½ç»åæ¥ç»ç»æ éæ°éçå¯¹è±¡ã\n   * è£é¥°ç±»ä¼¼äºç»åï¼ ä½å¶åªæä¸ä¸ªå­ç»ä»¶ã æ­¤å¤è¿æä¸ä¸ªææ¾ä¸åï¼ è£é¥°ä¸ºè¢«å°è£å¯¹è±¡æ·»å äºé¢å¤çèè´£ï¼ ç»åä»å¯¹å¶å­èç¹çç»æè¿è¡äº âæ±åâã\n   * ä½æ¯ï¼ æ¨¡å¼ä¹å¯ä»¥ç¸äºåä½ï¼ ä½ å¯ä»¥ä½¿ç¨è£é¥°æ¥æ©å±ç»åæ ä¸­ç¹å®å¯¹è±¡çè¡ä¸ºã\n * å¤§éä½¿ç¨ç»ååè£é¥°çè®¾è®¡éå¸¸å¯ä»å¯¹äºååæ¨¡å¼çä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n * è£é¥°å¯è®©ä½ æ´æ¹å¯¹è±¡çå¤è¡¨ï¼ ç­ç¥æ¨¡å¼åè®©ä½ è½å¤æ¹åå¶æ¬è´¨ã\n * è£é¥°åä»£çæçç¸ä¼¼çç»æï¼ ä½æ¯å¶æå¾å´éå¸¸ä¸åã è¿ä¸¤ä¸ªæ¨¡å¼çæå»ºé½åºäºç»åååï¼ ä¹å°±æ¯è¯´ä¸ä¸ªå¯¹è±¡åºè¯¥å°é¨åå·¥ä½å§æ´¾ç»å¦ä¸ä¸ªå¯¹è±¡ã ä¸¤èä¹é´çä¸åä¹å¤å¨äºä»£çéå¸¸èªè¡ç®¡çå¶æå¡å¯¹è±¡ççå½å¨æï¼ èè£é¥°ççæåæ»æ¯ç±å®¢æ·ç«¯è¿è¡æ§å¶ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹è£é¥°æ¨¡å¼\n\n\n# 1. æå¾\n\nè£é¥°æ¨¡å¼ (decorator) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å¨æå°ç»ä¸ä¸ªå¯¹è±¡æ·»å ä¸äºé¢å¤çèè´£ãå°±å¢å åè½æ¥è¯´ï¼decorator æ¨¡å¼ç¸æ¯çæå­ç±»æ´ä¸ºçµæ´»ã\n\n * è£é¥°å¯¹è±¡åçå®å¯¹è±¡æç¸åçæ¥å£ãè¿æ ·å®¢æ·ç«¯å¯¹è±¡å°±è½ä»¥åçå®å¯¹è±¡ç¸åçæ¹å¼åè£é¥°å¯¹è±¡äº¤äºã\n * è£é¥°å¯¹è±¡åå«ä¸ä¸ªçå®å¯¹è±¡çå¼ç¨ï¼referenceï¼ã\n * è£é¥°å¯¹è±¡æ¥åæææ¥èªå®¢æ·ç«¯çè¯·æ±ãå®æè¿äºè¯·æ±è½¬åç»çå®çå¯¹è±¡ã\n * è£é¥°å¯¹è±¡å¯ä»¥å¨è½¬åè¿äºè¯·æ±ä»¥åæä»¥åå¢å ä¸äºéå åè½ãè¿æ ·å°±ç¡®ä¿äºå¨è¿è¡æ¶ï¼ä¸ç¨ä¿®æ¹ç»å®å¯¹è±¡çç»æå°±å¯ä»¥å¨å¤é¨å¢å éå çåè½ãå¨é¢åå¯¹è±¡çè®¾è®¡ä¸­ï¼éå¸¸æ¯éè¿ç»§æ¿æ¥å®ç°å¯¹ç»å®ç±»çåè½æ©å±ã\n\n\n# 2. éååºæ¯\n\n * å¦æä½ å¸æå¨æ éä¿®æ¹ä»£ç çæåµä¸å³å¯ä½¿ç¨å¯¹è±¡ï¼ ä¸å¸æå¨è¿è¡æ¶ä¸ºå¯¹è±¡æ°å¢é¢å¤çè¡ä¸ºï¼ å¯ä»¥ä½¿ç¨è£é¥°æ¨¡å¼ã\n * å¦æç¨ç»§æ¿æ¥æ©å±å¯¹è±¡è¡ä¸ºçæ¹æ¡é¾ä»¥å®ç°æèæ ¹æ¬ä¸å¯è¡ï¼ ä½ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. é¨ä»¶ ï¼componentï¼ å£°æå°è£å¨åè¢«å°è£å¯¹è±¡çå¬ç¨æ¥å£ã\n 2. å·ä½é¨ä»¶ ï¼concrete componentï¼ ç±»æ¯è¢«å°è£å¯¹è±¡æå±çç±»ã å®å®ä¹äºåºç¡è¡ä¸ºï¼ ä½è£é¥°ç±»å¯ä»¥æ¹åè¿äºè¡ä¸ºã\n 3. åºç¡è£é¥° ï¼base decoratorï¼ ç±»æ¥æä¸ä¸ªæåè¢«å°è£å¯¹è±¡çå¼ç¨æååéã è¯¥åéçç±»ååºå½è¢«å£°æä¸ºéç¨é¨ä»¶æ¥å£ï¼ è¿æ ·å®å°±å¯ä»¥å¼ç¨å·ä½çé¨ä»¶åè£é¥°ã è£é¥°åºç±»ä¼å°æææä½å§æ´¾ç»è¢«å°è£çå¯¹è±¡ã\n 4. å·ä½è£é¥°ç±» ï¼concrete decoratorsï¼ å®ä¹äºå¯å¨ææ·»å å°é¨ä»¶çé¢å¤è¡ä¸ºã å·ä½è£é¥°ç±»ä¼éåè£é¥°åºç±»çæ¹æ³ï¼ å¹¶å¨è°ç¨ç¶ç±»æ¹æ³ä¹åæä¹åè¿è¡é¢å¤çè¡ä¸ºã\n 5. å®¢æ·ç«¯ ï¼clientï¼ å¯ä»¥ä½¿ç¨å¤å±è£é¥°æ¥å°è£é¨ä»¶ï¼ åªè¦å®è½ä½¿ç¨éç¨æ¥å£ä¸ææå¯¹è±¡äºå¨å³å¯ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\ncomponent : å®ä¹ä¸ä¸ªå¯¹è±¡æ¥å£ï¼å¯ä»¥ç»è¿äºå¯¹è±¡å¨æå°æ·»å èè´£ã\n\ninterface component {\n    public void operation();\n}\n\n\nconcretecomponent : å®ç° component å®ä¹çæ¥å£ã\n\nclass concretecomponent implements component {\n    @override\n    public void operation() {\n        system.out.println("åå§è¡ä¸º");\n    }\n}\n\n\ndecorator : è£é¥°æ½è±¡ç±»ï¼ç»§æ¿äº componentï¼ ä»å¤ç±»æ¥æ©å± component ç±»çåè½ï¼ä½å¯¹äº component æ¥è¯´ï¼æ¯æ éç¥é decorator çå­å¨çã\n\nclass decorator implements component {\n    // ææä¸ä¸ª component å¯¹è±¡ï¼å component å½¢æèåå³ç³»\n    protected component component;\n\n    // ä¼ å¥è¦è¿ä¸æ­¥ä¿®é¥°çå¯¹è±¡\n    public decorator(component component) {\n        this.component = component;\n    }\n\n    @override\n    // è°ç¨è¦ä¿®é¥°å¯¹è±¡çåæ¹æ³\n    public void operation() {\n        component.operation();\n    }\n}\n\n\nconcretedecorator : å·ä½çè£é¥°å¯¹è±¡ï¼èµ·å°ç» component æ·»å èè´£çåè½ã\n\nclass concretedecoratora extends decorator {\n    private string addedstate = "æ°å±æ§1";\n\n    public concretedecoratora(component component) {\n        super(component);\n    }\n\n    public void operation() {\n        super.operation();\n        system.out.println("æ·»å å±æ§: " + addedstate);\n    }\n}\n\nclass concretedecoratorb extends decorator {\n    public concretedecoratorb(component component) {\n        super(component);\n    }\n\n    public void operation() {\n        super.operation();\n        addedbehavior();\n    }\n\n    public void addedbehavior() {\n        system.out.println("æ·»å è¡ä¸º");\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class decoratorpattern {\n    public static void main(string[] args) {\n        component component = new concretecomponent();\n        component.operation();\n\n        system.out.println("======================================");\n        decorator decoratora = new concretedecoratora(component);\n        decoratora.operation();\n\n        system.out.println("======================================");\n        decorator decoratorb = new concretedecoratorb(decoratora);\n        decoratorb.operation();\n    }\n}\n\n\nãè¾åºã\n\nåå§è¡ä¸º\n======================================\nåå§è¡ä¸º\næ·»å å±æ§: æ°å±æ§1\n======================================\nåå§è¡ä¸º\næ·»å å±æ§: æ°å±æ§1\næ·»å è¡ä¸º\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nå¨æ¬ä¾ä¸­ï¼ è£é¥°æ¨¡å¼è½å¤å¯¹æææ°æ®è¿è¡åç¼©åå å¯ï¼ ä»èå°æ°æ®ä»ä½¿ç¨æ°æ®çä»£ç ä¸­ç¬ç«åºæ¥ã\n\nç¨åºä½¿ç¨ä¸å¯¹è£é¥°æ¥å°è£æ°æ®æºå¯¹è±¡ã è¿ä¸¤ä¸ªå°è£å¨é½æ¹åäºä»ç£çè¯»åæ°æ®çæ¹å¼ï¼\n\n * å½æ°æ®å³å°è¢«åå¥ç£çåï¼ è£é¥°å¯¹æ°æ®è¿è¡å å¯ååç¼©ã å¨åå§ç±»å¯¹æ¹åæ¯«æ å¯è§çæåµä¸ï¼ å°å å¯åçåä¿æ¤æ°æ®åå¥æä»¶ã\n * å½æ°æ®åä»ç£çè¯»åºåï¼ åæ ·éè¿è£é¥°å¯¹æ°æ®è¿è¡è§£ååè§£å¯ã è£é¥°åæ°æ®æºç±»å®ç°åä¸æ¥å£ï¼ ä»èè½å¨å®¢æ·ç«¯ä»£ç ä¸­ç¸äºæ¿æ¢ã\n\n// è£é¥°å¯ä»¥æ¹åç»ä»¶æ¥å£æå®ä¹çæä½ã\ninterface datasource is\n    method writedata(data)\n    method readdata():data\n\n// å·ä½ç»ä»¶æä¾æä½çé»è®¤å®ç°ãè¿äºç±»å¨ç¨åºä¸­å¯è½ä¼æå ä¸ªåä½ã\nclass filedatasource implements datasource is\n    constructor filedatasource(filename) { ... }\n\n    method writedata(data) is\n        // å°æ°æ®åå¥æä»¶ã\n\n    method readdata():data is\n        // ä»æä»¶è¯»åæ°æ®ã\n\n// è£é¥°åºç±»åå¶ä»ç»ä»¶éµå¾ªç¸åçæ¥å£ãè¯¥ç±»çä¸»è¦ä»»å¡æ¯å®ä¹ææå·ä½è£é¥°çå°\n// è£æ¥å£ãå°è£çé»è®¤å®ç°ä»£ç ä¸­å¯è½ä¼åå«ä¸ä¸ªä¿å­è¢«å°è£ç»ä»¶çæååéï¼å¹¶\n// ä¸è´è´£å¯¹å¶è¿è¡åå§åã\nclass datasourcedecorator implements datasource is\n    protected field wrappee: datasource\n\n    constructor datasourcedecorator(source: datasource) is\n        wrappee = source\n\n    // è£é¥°åºç±»ä¼ç´æ¥å°ææå·¥ä½åæ´¾ç»è¢«å°è£ç»ä»¶ãå·ä½è£é¥°ä¸­åå¯ä»¥æ°å¢ä¸äº\n    // é¢å¤çè¡ä¸ºã\n    method writedata(data) is\n        wrappee.writedata(data)\n\n    // å·ä½è£é¥°å¯è°ç¨å¶ç¶ç±»çæä½å®ç°ï¼èä¸æ¯ç´æ¥è°ç¨è¢«å°è£å¯¹è±¡ãè¿ç§æ¹å¼\n    // å¯ç®åè£é¥°ç±»çæ©å±å·¥ä½ã\n    method readdata():data is\n        return wrappee.readdata()\n\n// å·ä½è£é¥°å¿é¡»å¨è¢«å°è£å¯¹è±¡ä¸è°ç¨æ¹æ³ï¼ä¸è¿ä¹å¯ä»¥èªè¡å¨ç»æä¸­æ·»å ä¸äºåå®¹ã\n// è£é¥°å¿é¡»å¨è°ç¨å°è£å¯¹è±¡ä¹åæä¹åæ§è¡é¢å¤çè¡ä¸ºã\nclass encryptiondecorator extends datasourcedecorator is\n    method writedata(data) is\n        // 1. å¯¹ä¼ éæ°æ®è¿è¡å å¯ã\n        // 2. å°å å¯åæ°æ®ä¼ éç»è¢«å°è£å¯¹è±¡ writedataï¼åå¥æ°æ®ï¼æ¹æ³ã\n\n    method readdata():data is\n        // 1. éè¿è¢«å°è£å¯¹è±¡ç readdataï¼è¯»åæ°æ®ï¼æ¹æ³è·åæ°æ®ã\n        // 2. å¦ææ°æ®è¢«å å¯å°±å°è¯è§£å¯ã\n        // 3. è¿åç»æã\n\n// ä½ å¯ä»¥å°å¯¹è±¡å°è£å¨å¤å±è£é¥°ä¸­ã\nclass compressiondecorator extends datasourcedecorator is\n    method writedata(data) is\n        // 1. åç¼©ä¼ éæ°æ®ã\n        // 2. å°åç¼©åæ°æ®ä¼ éç»è¢«å°è£å¯¹è±¡ writedataï¼åå¥æ°æ®ï¼æ¹æ³ã\n\n    method readdata():data is\n        // 1. éè¿è¢«å°è£å¯¹è±¡ç readdataï¼è¯»åæ°æ®ï¼æ¹æ³è·åæ°æ®ã\n        // 2. å¦ææ°æ®è¢«åç¼©å°±å°è¯è§£åã\n        // 3. è¿åç»æã\n\n\n// éé¡¹ 1ï¼è£é¥°ç»ä»¶çç®åç¤ºä¾\nclass application is\n    method dumbusageexample() is\n        source = new filedatasource("somefile.dat")\n        source.writedata(salaryrecords)\n        // å·²å°æç æ°æ®åå¥ç®æ æä»¶ã\n\n        source = new compressiondecorator(source)\n        source.writedata(salaryrecords)\n        // å·²å°åç¼©æ°æ®åå¥ç®æ æä»¶ã\n\n        source = new encryptiondecorator(source)\n        // æºåéä¸­ç°å¨åå«ï¼\n        // encryption > compression > filedatasource\n        source.writedata(salaryrecords)\n        // å·²å°åç¼©ä¸å å¯çæ°æ®åå¥ç®æ æä»¶ã\n\n\n// éé¡¹ 2ï¼å®¢æ·ç«¯ä½¿ç¨å¤é¨æ°æ®æºãsalarymanagerï¼å·¥èµç®¡çå¨ï¼å¯¹è±¡å¹¶ä¸å³å¿\n// æ°æ®å¦ä½å­å¨ãå®ä»¬ä¼ä¸æåéç½®å¥½çæ°æ®æºè¿è¡äº¤äºï¼æ°æ®æºåæ¯éè¿ç¨åºé\n// ç½®å¨è·åçã\nclass salarymanager is\n    field source: datasource\n\n    constructor salarymanager(source: datasource) { ... }\n\n    method load() is\n        return source.readdata()\n\n    method save() is\n        source.writedata(salaryrecords)\n    // ...å¶ä»æç¨çæ¹æ³...\n\n\n// ç¨åºå¯å¨è¿è¡æ¶æ ¹æ®éç½®æç¯å¢ç»è£ä¸åçè£é¥°å æ¡ã\nclass applicationconfigurator is\n    method configurationexample() is\n        source = new filedatasource("salary.dat")\n        if (enabledencryption)\n            source = new encryptiondecorator(source)\n        if (enabledcompression)\n            source = new compressiondecorator(source)\n\n        logger = new salarymanager(source)\n        salary = logger.load()\n    // ...\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è£é¥°æ¨¡å¼å¨ java ä»£ç ä¸­å¯è°æ¯æ åéç½®ï¼ å°¤å¶æ¯å¨ä¸æµå¼å è½½ç¸å³çä»£ç ä¸­ã\n\njava æ ¸å¿ç¨åºåºä¸­æä¸äºå³äºè£é¥°çç¤ºä¾ï¼\n\n * java.io.inputstreamã outputÂ­streamã reader å writer çææä»£ç é½æä»¥èªèº«ç±»åçå¯¹è±¡ä½ä¸ºåæ°çæé å½æ°ã\n * java.util.collectionsï¼ checkedÂ­xxx()ã synchronizedÂ­xxx() å unmodifiableÂ­xxx() æ¹æ³ã\n * javax.servlet.http.httpservletrequestwrapper å httpÂ­servletÂ­responseÂ­wrapper\n\nè¯å«æ¹æ³ï¼ è£é¥°å¯éè¿ä»¥å½åç±»æå¯¹è±¡ä¸ºåæ°çåå»ºæ¹æ³ææé å½æ°æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ééå¨æ¨¡å¼å¯ä»¥å¯¹å·²æå¯¹è±¡çæ¥å£è¿è¡ä¿®æ¹ï¼ è£é¥°æ¨¡å¼åè½å¨ä¸æ¹åå¯¹è±¡æ¥å£çåæä¸å¼ºåå¯¹è±¡åè½ã æ­¤å¤ï¼ è£é¥°è¿æ¯æéå½ç»åï¼ ééå¨åæ æ³å®ç°ã\n * ééå¨è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * è´£ä»»é¾æ¨¡å¼åè£é¥°æ¨¡å¼çç±»ç»æéå¸¸ç¸ä¼¼ã ä¸¤èé½ä¾èµéå½ç»åå°éè¦æ§è¡çæä½ä¼ éç»ä¸ç³»åå¯¹è±¡ã ä½æ¯ï¼ ä¸¤èæå ç¹éè¦çä¸åä¹å¤ã\n   * è´£ä»»é¾çç®¡çèå¯ä»¥ç¸äºç¬ç«å°æ§è¡ä¸åæä½ï¼ è¿å¯ä»¥éæ¶åæ­¢ä¼ éè¯·æ±ã å¦ä¸æ¹é¢ï¼ åç§è£é¥°å¯ä»¥å¨éµå¾ªåºæ¬æ¥å£çæåµä¸æ©å±å¯¹è±¡çè¡ä¸ºã æ­¤å¤ï¼ è£é¥°æ æ³ä¸­æ­è¯·æ±çä¼ éã\n * ç»åæ¨¡å¼åè£é¥°çç»æå¾å¾ç¸ä¼¼ï¼ å ä¸ºä¸¤èé½ä¾èµéå½ç»åæ¥ç»ç»æ éæ°éçå¯¹è±¡ã\n   * è£é¥°ç±»ä¼¼äºç»åï¼ ä½å¶åªæä¸ä¸ªå­ç»ä»¶ã æ­¤å¤è¿æä¸ä¸ªææ¾ä¸åï¼ è£é¥°ä¸ºè¢«å°è£å¯¹è±¡æ·»å äºé¢å¤çèè´£ï¼ ç»åä»å¯¹å¶å­èç¹çç»æè¿è¡äº âæ±åâã\n   * ä½æ¯ï¼ æ¨¡å¼ä¹å¯ä»¥ç¸äºåä½ï¼ ä½ å¯ä»¥ä½¿ç¨è£é¥°æ¥æ©å±ç»åæ ä¸­ç¹å®å¯¹è±¡çè¡ä¸ºã\n * å¤§éä½¿ç¨ç»ååè£é¥°çè®¾è®¡éå¸¸å¯ä»å¯¹äºååæ¨¡å¼çä½¿ç¨ä¸­è·çã ä½ å¯ä»¥éè¿è¯¥æ¨¡å¼æ¥å¤å¶å¤æç»æï¼ èéä»é¶å¼å§éæ°æé ã\n * è£é¥°å¯è®©ä½ æ´æ¹å¯¹è±¡çå¤è¡¨ï¼ ç­ç¥æ¨¡å¼åè®©ä½ è½å¤æ¹åå¶æ¬è´¨ã\n * è£é¥°åä»£çæçç¸ä¼¼çç»æï¼ ä½æ¯å¶æå¾å´éå¸¸ä¸åã è¿ä¸¤ä¸ªæ¨¡å¼çæå»ºé½åºäºç»åååï¼ ä¹å°±æ¯è¯´ä¸ä¸ªå¯¹è±¡åºè¯¥å°é¨åå·¥ä½å§æ´¾ç»å¦ä¸ä¸ªå¯¹è±¡ã ä¸¤èä¹é´çä¸åä¹å¤å¨äºä»£çéå¸¸èªè¡ç®¡çå¶æå¡å¯¹è±¡ççå½å¨æï¼ èè£é¥°ççæåæ»æ¯ç±å®¢æ·ç«¯è¿è¡æ§å¶ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹å¤è§æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹å¤è§æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-19T15:15:00.000Z",permalink:"/pages/427347/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/11.%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/11.å¤è§æ¨¡å¼.md",key:"v-25c50554",path:"/pages/427347/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:289},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:376},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:388},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:743},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1909},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3083},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:3481},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:3949}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹å¤è§æ¨¡å¼\n\n\n# 1. æå¾\n\nå¤è§æ¨¡å¼ (Facade) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ ä¸ºå­ç³»ç»ä¸­çä¸ç»æ¥å£æä¾ä¸ä¸ªä¸è´ççé¢ï¼æ­¤æ¨¡å¼å®ä¹äºä¸ä¸ªé«å±æ¥å£ï¼è¿ä¸ªæ¥å£ä½¿å¾è¿ä¸å­ç³»ç»æ´å å®¹æä½¿ç¨ã\n\n * å¤è§æ¨¡å¼ä¸ºå¤æå­ç³»ç»æä¾äºä¸ä¸ªç®åæ¥å£ï¼å¹¶ä¸ä¸ºå­ç³»ç»æ·»å æ°çåè½åè¡ä¸ºã\n * å¤è§æ¨¡å¼å®ç°äºå­ç³»ç»ä¸å®¢æ·ä¹é´çæ¾è¦åå³ç³»ã\n * å¤è§æ¨¡å¼æ²¡æå°è£å­ç³»ç»çç±»ï¼åªæ¯æä¾äºç®åçæ¥å£ã å¦æåºç¨éè¦ï¼å®å¹¶ä¸éå¶å®¢æ·ä½¿ç¨å­ç³»ç»ç±»ãå æ­¤å¯ä»¥åç³»ç»æç¨æ§ä¸éç¨æ§ä¹é´éæ©ã\n * å¤è§æ¨¡å¼æ³¨éçæ¯ç®åæ¥å£ï¼å®æ´å¤çæ¶åæ¯ä»æ¶æçå±æ¬¡å»çæ´ä¸ªç³»ç»ï¼èå¹¶éåä¸ªç±»çå±æ¬¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦ä¸ä¸ªæåå¤æå­ç³»ç»çç´æ¥æ¥å£ï¼ ä¸è¯¥æ¥å£çåè½æéï¼ åå¯ä»¥ä½¿ç¨å¤è§æ¨¡å¼ã\n * å¦æéè¦å°å­ç³»ç»ç»ç»ä¸ºå¤å±ç»æï¼ å¯ä»¥ä½¿ç¨å¤è§ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. å¤è§ ï¼Facadeï¼ æä¾äºä¸ç§è®¿é®ç¹å®å­ç³»ç»åè½çä¾¿æ·æ¹å¼ï¼ å¶äºè§£å¦ä½éå®åå®¢æ·ç«¯è¯·æ±ï¼ ç¥æå¦ä½æä½ä¸åæ´»å¨é¨ä»¶ã\n\n 2. åå»ºéå å¤è§ ï¼Additional Facadeï¼ ç±»å¯ä»¥é¿åå¤ç§ä¸ç¸å³çåè½æ±¡æåä¸å¤è§ï¼ ä½¿å¶åæåä¸ä¸ªå¤æç»æã å®¢æ·ç«¯åå¶ä»å¤è§é½å¯ä½¿ç¨éå å¤è§ã\n\n 3. å¤æå­ç³»ç» ï¼Complex Subsystemï¼ ç±æ°åä¸ªä¸åå¯¹è±¡ææã å¦æè¦ç¨è¿äºå¯¹è±¡å®æææä¹çå·¥ä½ï¼ ä½ å¿é¡»æ·±å¥äºè§£å­ç³»ç»çå®ç°ç»èï¼ æ¯å¦æç§æ­£ç¡®é¡ºåºåå§åå¯¹è±¡åä¸ºå¶æä¾æ­£ç¡®æ ¼å¼çæ°æ®ã\n    \n    å­ç³»ç»ç±»ä¸ä¼æè¯å°å¤è§çå­å¨ï¼ å®ä»¬å¨ç³»ç»åè¿ä½å¹¶ä¸ç¸äºä¹é´å¯ç´æ¥è¿è¡äº¤äºã\n\n 4. å®¢æ·ç«¯ ï¼Clientï¼ ä½¿ç¨å¤è§ä»£æ¿å¯¹å­ç³»ç»å¯¹è±¡çç´æ¥è°ç¨ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nFacade : äºè§£æ¯ä¸ªå­ç³»ç»ç±»çåè½ï¼è´è´£ååå®¢æ·ç«¯çè¯·æ±ç»åä¸ªå­ç³»ç»å»å¤çã\n\nclass Class1 {\n    public void op1() {\n        System.out.println("æ¹æ³1");\n    }\n}\n\nclass Class2 {\n    public void op2() {\n        System.out.println("æ¹æ³2");\n    }\n}\n\nclass Class3 {\n    public void op3() {\n        System.out.println("æ¹æ³3");\n    }\n}\n\n\nSubsystem Classes : å®ç°å­ç³»ç»åè½ãå¨ä¸æç¥ Facade çæåµä¸ï¼å¤ç Facade å¯¹è±¡åéçå·¥ä½ï¼\n\nclass Facade {\n    private Class1 one = new Class1();\n    private Class2 two = new Class2();\n    private Class3 three = new Class3();\n\n    public void op1() {\n        System.out.println("Facade op1()");\n        one.op1();\n    }\n\n    public void op2() {\n        System.out.println("Facade op2()");\n        two.op2();\n    }\n\n    public void op3() {\n        System.out.println("Facade op3()");\n        three.op3();\n    }\n\n    public void Method() {\n        System.out.println("Facade Method()");\n        three.op3();\n        two.op2();\n        one.op1();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class FacadePattern {\n    public static void main(String[] args) {\n        Facade facade = new Facade();\n        facade.Method();\n\n        facade.op1();\n    }\n}\n\n\nãè¾åºã\n\nFacade Method()\næ¹æ³3\næ¹æ³2\næ¹æ³1\nFacade op1()\næ¹æ³1\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ å¤è§æ¨¡å¼ç®åäºå®¢æ·ç«¯ä¸å¤æè§é¢è½¬æ¢æ¡æ¶ä¹é´çäº¤äºã\n\n\n\nä½ å¯ä»¥åå»ºä¸ä¸ªå°è£æéåè½å¹¶éèå¶ä»ä»£ç çå¤è§ç±»ï¼ ä»èæ éä½¿å¨é¨ä»£ç ç´æ¥ä¸æ°åä¸ªæ¡æ¶ç±»è¿è¡äº¤äºã è¯¥ç»æè¿è½å°æªæ¥æ¡æ¶åçº§ææ´æ¢æé æçå½±åæå°åï¼ å ä¸ºä½ åªéä¿®æ¹ç¨åºä¸­å¤è§æ¹æ³çå®ç°å³å¯ã\n\n// è¿éæå¤æç¬¬ä¸æ¹è§é¢è½¬æ¢æ¡æ¶ä¸­çä¸äºç±»ãæä»¬ä¸ç¥æå¶ä¸­çä»£ç ï¼å æ­¤æ æ³\n// å¯¹å¶è¿è¡ç®åã\n\nclass VideoFile\n// ...\n\nclass OggCompressionCodec\n// ...\n\nclass MPEG4CompressionCodec\n// ...\n\nclass CodecFactory\n// ...\n\nclass BitrateReader\n// ...\n\nclass AudioMixer\n// ...\n\n\n// ä¸ºäºå°æ¡æ¶çå¤ææ§éèå¨ä¸ä¸ªç®åæ¥å£èåï¼æä»¬åå»ºäºä¸ä¸ªå¤è§ç±»ãå®æ¯å¨\n// åè½æ§åç®æ´æ§ä¹é´ååºçæè¡¡ã\nclass VideoConverter is\n    method convert(filename, format):File is\n        file = new VideoFile(filename)\n        sourceCodec = new CodecFactory.extract(file)\n        if (format == "mp4")\n            destinationCodec = new MPEG4CompressionCodec()\n        else\n            destinationCodec = new OggCompressionCodec()\n        buffer = BitrateReader.read(filename, sourceCodec)\n        result = BitrateReader.convert(buffer, destinationCodec)\n        result = (new AudioMixer()).fix(result)\n        return new File(result)\n\n// åºç¨ç¨åºçç±»å¹¶ä¸ä¾èµäºå¤ææ¡æ¶ä¸­æåä¸ä¸çç±»ãåæ ·ï¼å¦æä½ å³å®æ´æ¢æ¡æ¶ï¼\n// é£åªééåå¤è§ç±»å³å¯ã\nclass Application is\n    method main() is\n        convertor = new VideoConverter()\n        mp4 = convertor.convert("funny-cats-video.ogg", "mp4")\n        mp4.save()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ä½¿ç¨ Java å¼åçç¨åºä¸­ç»å¸¸ä¼ä½¿ç¨å¤è§æ¨¡å¼ã å®å¨ä¸å¤æç¨åºåºå API åä½æ¶ç¹å«æç¨ã\n\nä¸é¢æ¯ä¸äºæ ¸å¿ Java ç¨åºåºä¸­çå¤è§ç¤ºä¾ï¼\n\n * javax.faces.context.FacesContext å¨åºå±ä½¿ç¨äº LifeÂ­Cycleã ViewÂ­Handler å NavigationÂ­Handler è¿å ä¸ªç±»ï¼ ä½ç»å¤§å¤æ°å®¢æ·ç«¯ä¸ç¥éã\n * javax.faces.context.ExternalContext å¨åé¨ä½¿ç¨äº ServletÂ­Contextã HttpÂ­Sessionã HttpÂ­ServletÂ­Requestã HttpÂ­ServletÂ­Response åå¶ä»ä¸äºç±»ã\n\nè¯å«æ¹æ³ï¼ å¤è§å¯ä»¥éè¿ä½¿ç¨ç®åæ¥å£ï¼ ä½å°ç»å¤§é¨åå·¥ä½å§æ´¾ç»å¶ä»ç±»çç±»æ¥è¯å«ã éå¸¸æåµä¸ï¼ å¤è§ç®¡ççå¶æä½¿ç¨çå¯¹è±¡çå®æ´çå½å¨æã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¤è§æ¨¡å¼ä¸ºç°æå¯¹è±¡å®ä¹äºä¸ä¸ªæ°æ¥å£ï¼ ééå¨æ¨¡å¼åä¼è¯å¾è¿ç¨å·²æçæ¥å£ã ééå¨éå¸¸åªå°è£ä¸ä¸ªå¯¹è±¡ï¼ å¤è§éå¸¸ä¼ä½ç¨äºæ´ä¸ªå¯¹è±¡å­ç³»ç»ä¸ã\n * å½åªéå¯¹å®¢æ·ç«¯ä»£ç éèå­ç³»ç»åå»ºå¯¹è±¡çæ¹å¼æ¶ï¼ ä½ å¯ä»¥ä½¿ç¨æ½è±¡å·¥åæ¨¡å¼æ¥ä»£æ¿å¤è§ã\n * äº«åæ¨¡å¼å±ç¤ºäºå¦ä½çæå¤§éçå°åå¯¹è±¡ï¼ å¤è§åå±ç¤ºäºå¦ä½ç¨ä¸ä¸ªå¯¹è±¡æ¥ä»£è¡¨æ´ä¸ªå­ç³»ç»ã\n * å¤è§åä¸­ä»èæ¨¡å¼çèè´£ç±»ä¼¼ï¼ å®ä»¬é½å°è¯å¨å¤§éç´§å¯è¦åçç±»ä¸­ç»ç»èµ·åä½ã\n   * å¤è§ä¸ºå­ç³»ç»ä¸­çææå¯¹è±¡å®ä¹äºä¸ä¸ªç®åæ¥å£ï¼ ä½æ¯å®ä¸æä¾ä»»ä½æ°åè½ã å­ç³»ç»æ¬èº«ä¸ä¼æè¯å°å¤è§çå­å¨ã å­ç³»ç»ä¸­çå¯¹è±¡å¯ä»¥ç´æ¥è¿è¡äº¤æµã\n   * ä¸­ä»èå°ç³»ç»ä¸­ç»ä»¶çæ²éè¡ä¸ºä¸­å¿åã åç»ä»¶åªç¥éä¸­ä»èå¯¹è±¡ï¼ æ æ³ç´æ¥ç¸äºäº¤æµã\n * å¤è§ç±»éå¸¸å¯ä»¥è½¬æ¢ä¸ºåä¾æ¨¡å¼ç±»ï¼ å ä¸ºå¨å¤§é¨åæåµä¸ä¸ä¸ªå¤è§å¯¹è±¡å°±è¶³å¤äºã\n * å¤è§ä¸ä»£çæ¨¡å¼çç¸ä¼¼ä¹å¤å¨äºå®ä»¬é½ç¼å­äºä¸ä¸ªå¤æå®ä½å¹¶èªè¡å¯¹å¶è¿è¡åå§åã ä»£çä¸å¶æå¡å¯¹è±¡éµå¾ªåä¸æ¥å£ï¼ ä½¿å¾èªå·±åæå¡å¯¹è±¡å¯ä»¥äºæ¢ï¼ å¨è¿ä¸ç¹ä¸å®ä¸å¤è§ä¸åã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹å¤è§æ¨¡å¼\n\n\n# 1. æå¾\n\nå¤è§æ¨¡å¼ (facade) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ ä¸ºå­ç³»ç»ä¸­çä¸ç»æ¥å£æä¾ä¸ä¸ªä¸è´ççé¢ï¼æ­¤æ¨¡å¼å®ä¹äºä¸ä¸ªé«å±æ¥å£ï¼è¿ä¸ªæ¥å£ä½¿å¾è¿ä¸å­ç³»ç»æ´å å®¹æä½¿ç¨ã\n\n * å¤è§æ¨¡å¼ä¸ºå¤æå­ç³»ç»æä¾äºä¸ä¸ªç®åæ¥å£ï¼å¹¶ä¸ä¸ºå­ç³»ç»æ·»å æ°çåè½åè¡ä¸ºã\n * å¤è§æ¨¡å¼å®ç°äºå­ç³»ç»ä¸å®¢æ·ä¹é´çæ¾è¦åå³ç³»ã\n * å¤è§æ¨¡å¼æ²¡æå°è£å­ç³»ç»çç±»ï¼åªæ¯æä¾äºç®åçæ¥å£ã å¦æåºç¨éè¦ï¼å®å¹¶ä¸éå¶å®¢æ·ä½¿ç¨å­ç³»ç»ç±»ãå æ­¤å¯ä»¥åç³»ç»æç¨æ§ä¸éç¨æ§ä¹é´éæ©ã\n * å¤è§æ¨¡å¼æ³¨éçæ¯ç®åæ¥å£ï¼å®æ´å¤çæ¶åæ¯ä»æ¶æçå±æ¬¡å»çæ´ä¸ªç³»ç»ï¼èå¹¶éåä¸ªç±»çå±æ¬¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦ä¸ä¸ªæåå¤æå­ç³»ç»çç´æ¥æ¥å£ï¼ ä¸è¯¥æ¥å£çåè½æéï¼ åå¯ä»¥ä½¿ç¨å¤è§æ¨¡å¼ã\n * å¦æéè¦å°å­ç³»ç»ç»ç»ä¸ºå¤å±ç»æï¼ å¯ä»¥ä½¿ç¨å¤è§ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. å¤è§ ï¼facadeï¼ æä¾äºä¸ç§è®¿é®ç¹å®å­ç³»ç»åè½çä¾¿æ·æ¹å¼ï¼ å¶äºè§£å¦ä½éå®åå®¢æ·ç«¯è¯·æ±ï¼ ç¥æå¦ä½æä½ä¸åæ´»å¨é¨ä»¶ã\n\n 2. åå»ºéå å¤è§ ï¼additional facadeï¼ ç±»å¯ä»¥é¿åå¤ç§ä¸ç¸å³çåè½æ±¡æåä¸å¤è§ï¼ ä½¿å¶åæåä¸ä¸ªå¤æç»æã å®¢æ·ç«¯åå¶ä»å¤è§é½å¯ä½¿ç¨éå å¤è§ã\n\n 3. å¤æå­ç³»ç» ï¼complex subsystemï¼ ç±æ°åä¸ªä¸åå¯¹è±¡ææã å¦æè¦ç¨è¿äºå¯¹è±¡å®æææä¹çå·¥ä½ï¼ ä½ å¿é¡»æ·±å¥äºè§£å­ç³»ç»çå®ç°ç»èï¼ æ¯å¦æç§æ­£ç¡®é¡ºåºåå§åå¯¹è±¡åä¸ºå¶æä¾æ­£ç¡®æ ¼å¼çæ°æ®ã\n    \n    å­ç³»ç»ç±»ä¸ä¼æè¯å°å¤è§çå­å¨ï¼ å®ä»¬å¨ç³»ç»åè¿ä½å¹¶ä¸ç¸äºä¹é´å¯ç´æ¥è¿è¡äº¤äºã\n\n 4. å®¢æ·ç«¯ ï¼clientï¼ ä½¿ç¨å¤è§ä»£æ¿å¯¹å­ç³»ç»å¯¹è±¡çç´æ¥è°ç¨ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nfacade : äºè§£æ¯ä¸ªå­ç³»ç»ç±»çåè½ï¼è´è´£ååå®¢æ·ç«¯çè¯·æ±ç»åä¸ªå­ç³»ç»å»å¤çã\n\nclass class1 {\n    public void op1() {\n        system.out.println("æ¹æ³1");\n    }\n}\n\nclass class2 {\n    public void op2() {\n        system.out.println("æ¹æ³2");\n    }\n}\n\nclass class3 {\n    public void op3() {\n        system.out.println("æ¹æ³3");\n    }\n}\n\n\nsubsystem classes : å®ç°å­ç³»ç»åè½ãå¨ä¸æç¥ facade çæåµä¸ï¼å¤ç facade å¯¹è±¡åéçå·¥ä½ï¼\n\nclass facade {\n    private class1 one = new class1();\n    private class2 two = new class2();\n    private class3 three = new class3();\n\n    public void op1() {\n        system.out.println("facade op1()");\n        one.op1();\n    }\n\n    public void op2() {\n        system.out.println("facade op2()");\n        two.op2();\n    }\n\n    public void op3() {\n        system.out.println("facade op3()");\n        three.op3();\n    }\n\n    public void method() {\n        system.out.println("facade method()");\n        three.op3();\n        two.op2();\n        one.op1();\n    }\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic class facadepattern {\n    public static void main(string[] args) {\n        facade facade = new facade();\n        facade.method();\n\n        facade.op1();\n    }\n}\n\n\nãè¾åºã\n\nfacade method()\næ¹æ³3\næ¹æ³2\næ¹æ³1\nfacade op1()\næ¹æ³1\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ å¤è§æ¨¡å¼ç®åäºå®¢æ·ç«¯ä¸å¤æè§é¢è½¬æ¢æ¡æ¶ä¹é´çäº¤äºã\n\n\n\nä½ å¯ä»¥åå»ºä¸ä¸ªå°è£æéåè½å¹¶éèå¶ä»ä»£ç çå¤è§ç±»ï¼ ä»èæ éä½¿å¨é¨ä»£ç ç´æ¥ä¸æ°åä¸ªæ¡æ¶ç±»è¿è¡äº¤äºã è¯¥ç»æè¿è½å°æªæ¥æ¡æ¶åçº§ææ´æ¢æé æçå½±åæå°åï¼ å ä¸ºä½ åªéä¿®æ¹ç¨åºä¸­å¤è§æ¹æ³çå®ç°å³å¯ã\n\n// è¿éæå¤æç¬¬ä¸æ¹è§é¢è½¬æ¢æ¡æ¶ä¸­çä¸äºç±»ãæä»¬ä¸ç¥æå¶ä¸­çä»£ç ï¼å æ­¤æ æ³\n// å¯¹å¶è¿è¡ç®åã\n\nclass videofile\n// ...\n\nclass oggcompressioncodec\n// ...\n\nclass mpeg4compressioncodec\n// ...\n\nclass codecfactory\n// ...\n\nclass bitratereader\n// ...\n\nclass audiomixer\n// ...\n\n\n// ä¸ºäºå°æ¡æ¶çå¤ææ§éèå¨ä¸ä¸ªç®åæ¥å£èåï¼æä»¬åå»ºäºä¸ä¸ªå¤è§ç±»ãå®æ¯å¨\n// åè½æ§åç®æ´æ§ä¹é´ååºçæè¡¡ã\nclass videoconverter is\n    method convert(filename, format):file is\n        file = new videofile(filename)\n        sourcecodec = new codecfactory.extract(file)\n        if (format == "mp4")\n            destinationcodec = new mpeg4compressioncodec()\n        else\n            destinationcodec = new oggcompressioncodec()\n        buffer = bitratereader.read(filename, sourcecodec)\n        result = bitratereader.convert(buffer, destinationcodec)\n        result = (new audiomixer()).fix(result)\n        return new file(result)\n\n// åºç¨ç¨åºçç±»å¹¶ä¸ä¾èµäºå¤ææ¡æ¶ä¸­æåä¸ä¸çç±»ãåæ ·ï¼å¦æä½ å³å®æ´æ¢æ¡æ¶ï¼\n// é£åªééåå¤è§ç±»å³å¯ã\nclass application is\n    method main() is\n        convertor = new videoconverter()\n        mp4 = convertor.convert("funny-cats-video.ogg", "mp4")\n        mp4.save()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ä½¿ç¨ java å¼åçç¨åºä¸­ç»å¸¸ä¼ä½¿ç¨å¤è§æ¨¡å¼ã å®å¨ä¸å¤æç¨åºåºå api åä½æ¶ç¹å«æç¨ã\n\nä¸é¢æ¯ä¸äºæ ¸å¿ java ç¨åºåºä¸­çå¤è§ç¤ºä¾ï¼\n\n * javax.faces.context.facescontext å¨åºå±ä½¿ç¨äº lifeÂ­cycleã viewÂ­handler å navigationÂ­handler è¿å ä¸ªç±»ï¼ ä½ç»å¤§å¤æ°å®¢æ·ç«¯ä¸ç¥éã\n * javax.faces.context.externalcontext å¨åé¨ä½¿ç¨äº servletÂ­contextã httpÂ­sessionã httpÂ­servletÂ­requestã httpÂ­servletÂ­response åå¶ä»ä¸äºç±»ã\n\nè¯å«æ¹æ³ï¼ å¤è§å¯ä»¥éè¿ä½¿ç¨ç®åæ¥å£ï¼ ä½å°ç»å¤§é¨åå·¥ä½å§æ´¾ç»å¶ä»ç±»çç±»æ¥è¯å«ã éå¸¸æåµä¸ï¼ å¤è§ç®¡ççå¶æä½¿ç¨çå¯¹è±¡çå®æ´çå½å¨æã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å¤è§æ¨¡å¼ä¸ºç°æå¯¹è±¡å®ä¹äºä¸ä¸ªæ°æ¥å£ï¼ ééå¨æ¨¡å¼åä¼è¯å¾è¿ç¨å·²æçæ¥å£ã ééå¨éå¸¸åªå°è£ä¸ä¸ªå¯¹è±¡ï¼ å¤è§éå¸¸ä¼ä½ç¨äºæ´ä¸ªå¯¹è±¡å­ç³»ç»ä¸ã\n * å½åªéå¯¹å®¢æ·ç«¯ä»£ç éèå­ç³»ç»åå»ºå¯¹è±¡çæ¹å¼æ¶ï¼ ä½ å¯ä»¥ä½¿ç¨æ½è±¡å·¥åæ¨¡å¼æ¥ä»£æ¿å¤è§ã\n * äº«åæ¨¡å¼å±ç¤ºäºå¦ä½çæå¤§éçå°åå¯¹è±¡ï¼ å¤è§åå±ç¤ºäºå¦ä½ç¨ä¸ä¸ªå¯¹è±¡æ¥ä»£è¡¨æ´ä¸ªå­ç³»ç»ã\n * å¤è§åä¸­ä»èæ¨¡å¼çèè´£ç±»ä¼¼ï¼ å®ä»¬é½å°è¯å¨å¤§éç´§å¯è¦åçç±»ä¸­ç»ç»èµ·åä½ã\n   * å¤è§ä¸ºå­ç³»ç»ä¸­çææå¯¹è±¡å®ä¹äºä¸ä¸ªç®åæ¥å£ï¼ ä½æ¯å®ä¸æä¾ä»»ä½æ°åè½ã å­ç³»ç»æ¬èº«ä¸ä¼æè¯å°å¤è§çå­å¨ã å­ç³»ç»ä¸­çå¯¹è±¡å¯ä»¥ç´æ¥è¿è¡äº¤æµã\n   * ä¸­ä»èå°ç³»ç»ä¸­ç»ä»¶çæ²éè¡ä¸ºä¸­å¿åã åç»ä»¶åªç¥éä¸­ä»èå¯¹è±¡ï¼ æ æ³ç´æ¥ç¸äºäº¤æµã\n * å¤è§ç±»éå¸¸å¯ä»¥è½¬æ¢ä¸ºåä¾æ¨¡å¼ç±»ï¼ å ä¸ºå¨å¤§é¨åæåµä¸ä¸ä¸ªå¤è§å¯¹è±¡å°±è¶³å¤äºã\n * å¤è§ä¸ä»£çæ¨¡å¼çç¸ä¼¼ä¹å¤å¨äºå®ä»¬é½ç¼å­äºä¸ä¸ªå¤æå®ä½å¹¶èªè¡å¯¹å¶è¿è¡åå§åã ä»£çä¸å¶æå¡å¯¹è±¡éµå¾ªåä¸æ¥å£ï¼ ä½¿å¾èªå·±åæå¡å¯¹è±¡å¯ä»¥äºæ¢ï¼ å¨è¿ä¸ç¹ä¸å®ä¸å¤è§ä¸åã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹äº«åæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹äº«åæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-19T09:48:00.000Z",permalink:"/pages/265866/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/12.%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/12.äº«åæ¨¡å¼.md",key:"v-6e2d857c",path:"/pages/265866/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:25},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:36},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:47},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:62},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:77},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:87},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:96},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:111}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹äº«åæ¨¡å¼\n\n * 1. æå¾\n * 2. éç¨åºæ¯\n * 3. ç»æ\n   * 3.1. ç»æè¯´æ\n   * 3.2. ç»æä»£ç èå¼\n * 4. ä¼ªä»£ç \n * 5. æ¡ä¾\n * 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n * 7. åèèµæ\n\n\n# 1. æå¾\n\näº«åæ¨¡å¼ (Flyweight) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å®æå¼äºå¨æ¯ä¸ªå¯¹è±¡ä¸­ä¿å­æææ°æ®çæ¹å¼ï¼ éè¿å±äº«å¤ä¸ªå¯¹è±¡æå±æçç¸åç¶æï¼ è®©ä½ è½å¨æéçåå­å®¹éä¸­è½½å¥æ´å¤å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * ä»å¨ç¨åºå¿é¡»æ¯æå¤§éå¯¹è±¡ä¸æ²¡æè¶³å¤çåå­å®¹éæ¶ä½¿ç¨äº«åæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. äº«åæ¨¡å¼åªæ¯ä¸ç§ä¼åã å¨åºç¨è¯¥æ¨¡å¼ä¹åï¼ ä½ è¦ç¡®å®ç¨åºä¸­å­å¨ä¸å¤§éç±»ä¼¼å¯¹è±¡åæ¶å ç¨åå­ç¸å³çåå­æ¶èé®é¢ï¼ å¹¶ä¸ç¡®ä¿è¯¥é®é¢æ æ³ä½¿ç¨å¶ä»æ´å¥½çæ¹å¼æ¥è§£å³ã\n 2. äº«å ï¼Flyweightï¼ ç±»åå«åå§å¯¹è±¡ä¸­é¨åè½å¨å¤ä¸ªå¯¹è±¡ä¸­å±äº«çç¶æã åä¸äº«åå¯¹è±¡å¯å¨è®¸å¤ä¸åææ¯ä¸­ä½¿ç¨ã äº«åä¸­å­å¨çç¶æè¢«ç§°ä¸º âåå¨ç¶æâã ä¼ éç»äº«åæ¹æ³çç¶æè¢«ç§°ä¸º âå¤å¨ç¶æâã\n 3. ææ¯ ï¼Contextï¼ ç±»åå«åå§å¯¹è±¡ä¸­åä¸ç¸åçå¤å¨ç¶æã ææ¯ä¸äº«åå¯¹è±¡ç»åå¨ä¸èµ·å°±è½è¡¨ç¤ºåå§å¯¹è±¡çå¨é¨ç¶æã\n 4. éå¸¸æåµä¸ï¼ åå§å¯¹è±¡çè¡ä¸ºä¼ä¿çå¨äº«åç±»ä¸­ã å æ­¤è°ç¨äº«åæ¹æ³å¿é¡»æä¾é¨åå¤å¨ç¶æä½ä¸ºåæ°ã ä½ä½ ä¹å¯å°è¡ä¸ºç§»å¨å°ææ¯ç±»ä¸­ï¼ ç¶åå°è¿å¥çäº«åä½ä¸ºåçº¯çæ°æ®å¯¹è±¡ã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ è´è´£è®¡ç®æå­å¨äº«åçå¤å¨ç¶æã å¨å®¢æ·ç«¯çæ¥ï¼ äº«åæ¯ä¸ç§å¯å¨è¿è¡æ¶è¿è¡éç½®çæ¨¡æ¿å¯¹è±¡ï¼ å·ä½çéç½®æ¹å¼ä¸ºåå¶æ¹æ³ä¸­ä¼ å¥ä¸äºææ¯æ°æ®åæ°ã\n 6. äº«åå·¥å ï¼Flyweight Factoryï¼ ä¼å¯¹å·²æäº«åçç¼å­æ± è¿è¡ç®¡çã æäºå·¥ååï¼ å®¢æ·ç«¯å°±æ éç´æ¥åå»ºäº«åï¼ å®ä»¬åªéè°ç¨å·¥åå¹¶åå¶ä¼ éç®æ äº«åçä¸äºåå¨ç¶æå³å¯ã å·¥åä¼æ ¹æ®åæ°å¨ä¹åå·²åå»ºçäº«åä¸­è¿è¡æ¥æ¾ï¼ å¦ææ¾å°æ»¡è¶³æ¡ä»¶çäº«åå°±å°å¶è¿åï¼ å¦ææ²¡ææ¾å°å°±æ ¹æ®åæ°æ°å»ºäº«åã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nFlyweight : å®æ¯ææå·ä½äº«åç±»çè¶ç±»ææ¥å£ï¼éè¿è¿ä¸ªæ¥å£ï¼Flyweight å¯ä»¥æ¥åå¹¶ä½ç¨äºå¤é¨ç¶æã\n\nabstract class Flyweight {\n    public abstract void operation(int extrinsicstates);\n}\n\n\nConcreteFlyweight : æ¯ç»§æ¿ Flyweight è¶ç±»æå®ç° Flyweight æ¥å£ï¼å¹¶ä¸ºåé¨ç¶æå¢å å­å¨ç©ºé´ã\n\nclass ConcreteFlyweight extends Flyweight {\n    @Override\n    public void operation(int extrinsicstates) {\n        System.out.println("å±äº«çFlyweight : " + extrinsicstates);\n    }\n}\n\n\nUnsharedConcreteFlyweight : æé£äºä¸éè¦å±äº«ç Flyweight å­ç±»ï¼å ä¸º Flyweight æ¥å£å±äº«æä¸ºå¯è½ï¼ä½å®å¹¶ä¸å¼ºå¶å±äº«ã\n\nclass UnsharedConcreteFlyweight extends Flyweight {\n    @Override\n    public void operation(int extrinsicstates) {\n        System.out.println("ä¸å±äº«çFlyweight : " + extrinsicstates);\n    }\n}\n\n\nFlywightFactory :æ¯ä¸ä¸ªäº«åå·¥åï¼ç¨æ¥åå»ºå¹¶ç®¡ç Flyweight å¯¹è±¡ãå®ä¸»è¦æ¯ç¨æ¥ç¡®ä¿åçå°å±äº« Flyweight ï¼å½ç¨æ·è¯·æ±ä¸ä¸ª Flyweight æ¶ï¼ FlyweightFactory å¯¹è±¡æä¾ä¸ä¸ªå·²åå»ºçå®ä¾æåå»ºä¸ä¸ªï¼å¦æå¯¹è±¡ä¸å­å¨çè¯ï¼ã\n\nclass FlywightFactory {\n    private Hashtable<String, Flyweight> flyweights = new Hashtable<String, Flyweight>();\n\n    public FlywightFactory() {\n        flyweights.put("X", new ConcreteFlyweight());\n        flyweights.put("Y", new ConcreteFlyweight());\n        flyweights.put("Z", new ConcreteFlyweight());\n    }\n\n    public Flyweight getFlyweight(String key) {\n        return ((Flyweight)flyweights.get(key));\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class FlyweightPattern {\n    public static void main(String[] args) {\n        int extrinsicstates = 1;\n        FlywightFactory factory = new FlywightFactory();\n\n        Flyweight fx = factory.getFlyweight("X");\n        fx.operation(extrinsicstates);\n\n        Flyweight fy = factory.getFlyweight("Y");\n        fy.operation(++extrinsicstates);\n\n        Flyweight fz = factory.getFlyweight("Z");\n        fz.operation(++extrinsicstates);\n\n        Flyweight uf = new UnsharedConcreteFlyweight();\n        uf.operation(++extrinsicstates);\n    }\n}\n\n\nè¾åº\n\nå±äº«çFlyweight : 1\nå±äº«çFlyweight : 2\nå±äº«çFlyweight : 3\nä¸å±äº«çFlyweight : 4\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nå¨æ¬ä¾ä¸­ï¼ äº«åæ¨¡å¼è½ææåå°å¨ç»å¸ä¸æ¸²ææ°ç¾ä¸ä¸ªæ ç¶å¯¹è±¡æ¶æéçåå­ã\n\nè¯¥æ¨¡å¼ä»ä¸»è¦ç æ Tree ç±»ä¸­æ½ååå¨ç¶æï¼ å¹¶å°å¶ç§»å¨å°äº«åç±» æ ç§ç±»TreeÂ­Type ä¹ä¸­ã\n\næåç¨åºéè¦å¨å¤ä¸ªå¯¹è±¡ä¸­å­å¨ç¸åæ°æ®ï¼ èç°å¨ä»éå¨å ä¸ªäº«åå¯¹è±¡ä¸­ä¿å­æ°æ®ï¼ ç¶åå¨ä½ä¸ºææ¯ç æ å¯¹è±¡ä¸­è¿å¥äº«åå³å¯ã å®¢æ·ç«¯ä»£ç ä½¿ç¨äº«åå·¥ååå»ºæ å¯¹è±¡å¹¶å°è£æç´¢æå®å¯¹è±¡çå¤æè¡ä¸ºï¼ å¹¶è½å¨éè¦æ¶å¤ç¨å¯¹è±¡ã\n\n// äº«åç±»åå«ä¸ä¸ªæ çé¨åç¶æãè¿äºæååéä¿å­çæ°å¼å¯¹äºç¹å®æ èè¨æ¯å¯ä¸\n// çãä¾å¦ï¼ä½ å¨è¿éæ¾ä¸å°æ çåæ ãä½è¿éæå¾å¤æ æ¨ä¹é´æå±æççº¹çåé¢\n// è²ãç±äºè¿äºæ°æ®çä½ç§¯éå¸¸éå¸¸å¤§ï¼æä»¥å¦æè®©æ¯æ£µæ é½å¶è¿è¡ä¿å­çè¯å°è\n// è´¹å¤§éåå­ãå æ­¤ï¼æä»¬å¯å°çº¹çãé¢è²åå¶ä»éå¤æ°æ®å¯¼åºå°ä¸ä¸ªåç¬çå¯¹è±¡\n// ä¸­ï¼ç¶åè®©ä¼å¤çåä¸ªæ å¯¹è±¡å»å¼ç¨å®ã\nclass TreeType is\n    field name\n    field color\n    field texture\n    constructor TreeType(name, color, texture) { ... }\n    method draw(canvas, x, y) is\n        // 1. åå»ºç¹å®ç±»åãé¢è²åçº¹ççä½å¾ã\n        // 2. å¨ç»å¸åæ  (X,Y) å¤ç»å¶ä½å¾ã\n\n// äº«åå·¥åå³å®æ¯å¦å¤ç¨å·²æäº«åæèåå»ºä¸ä¸ªæ°çå¯¹è±¡ã\nclass TreeFactory is\n    static field treeTypes: collection of tree types\n    static method getTreeType(name, color, texture) is\n        type = treeTypes.find(name, color, texture)\n        if (type == null)\n            type = new TreeType(name, color, texture)\n            treeTypes.add(type)\n        return type\n\n// ææ¯å¯¹è±¡åå«æ ç¶æçå¤å¨é¨åãç¨åºä¸­å¯ä»¥åå»ºæ°åäº¿ä¸ªæ­¤ç±»å¯¹è±¡ï¼å ä¸ºå®ä»¬\n// ä½ç§¯å¾å°ï¼ä»æä¸¤ä¸ªæ´ååæ åä¸ä¸ªå¼ç¨æååéã\nclass Tree is\n    field x,y\n    field type: TreeType\n    constructor Tree(x, y, type) { ... }\n    method draw(canvas) is\n        type.draw(canvas, this.x, this.y)\n\n// æ ï¼Treeï¼åæ£®æï¼Forestï¼ç±»æ¯äº«åçå®¢æ·ç«¯ãå¦æä¸æç®ç»§ç»­å¯¹æ ç±»è¿è¡å¼\n// åï¼ä½ å¯ä»¥å°å®ä»¬åå¹¶ã\nclass Forest is\n    field trees: collection of Trees\n\n    method plantTree(x, y, name, color, texture) is\n        type = TreeFactory.getTreeType(name, color, texture)\n        tree = new Tree(x, y, type)\n        trees.add(tree)\n\n    method draw(canvas) is\n        foreach (tree in trees) do\n            tree.draw(canvas)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ äº«åæ¨¡å¼åªæä¸ä¸ªç®çï¼ å°åå­æ¶èæå°åã å¦æä½ çç¨åºæ²¡æéå°åå­å®¹éä¸è¶³çé®é¢ï¼ åå¯ä»¥ææ¶å¿½ç¥è¯¥æ¨¡å¼ã\n\näº«åæ¨¡å¼å¨æ ¸å¿ Java ç¨åºåºä¸­çç¤ºä¾ï¼\n\n * java.lang.Integer#valueOf(int) ï¼ä»¥å Booleanã Byteã Characterã Shortã Long å BigÂ­Decimalï¼\n\nè¯å«æ¹æ³ï¼ äº«åå¯ä»¥éè¿æå»ºæ¹æ³æ¥è¯å«ï¼ å®ä¼è¿åç¼å­å¯¹è±¡èä¸æ¯åå»ºæ°çå¯¹è±¡ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥ä½¿ç¨äº«åæ¨¡å¼å®ç°ç»åæ¨¡å¼æ çå±äº«å¶èç¹ä»¥èçåå­ã\n * äº«åå±ç¤ºäºå¦ä½çæå¤§éçå°åå¯¹è±¡ï¼ å¤è§æ¨¡å¼åå±ç¤ºäºå¦ä½ç¨ä¸ä¸ªå¯¹è±¡æ¥ä»£è¡¨æ´ä¸ªå­ç³»ç»ã\n * å¦æä½ è½å°å¯¹è±¡çææå±äº«ç¶æç®åä¸ºä¸ä¸ªäº«åå¯¹è±¡ï¼ é£ä¹äº«åå°±ååä¾æ¨¡å¼ç±»ä¼¼äºã ä½è¿ä¸¤ä¸ªæ¨¡å¼æä¸¤ä¸ªæ ¹æ¬æ§çä¸åã\n   1. åªä¼æä¸ä¸ªåä¾å®ä½ï¼ ä½æ¯äº«åç±»å¯ä»¥æå¤ä¸ªå®ä½ï¼ åå®ä½çåå¨ç¶æä¹å¯ä»¥ä¸åã\n   2. åä¾å¯¹è±¡å¯ä»¥æ¯å¯åçã äº«åå¯¹è±¡æ¯ä¸å¯åçã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹äº«åæ¨¡å¼\n\n * 1. æå¾\n * 2. éç¨åºæ¯\n * 3. ç»æ\n   * 3.1. ç»æè¯´æ\n   * 3.2. ç»æä»£ç èå¼\n * 4. ä¼ªä»£ç \n * 5. æ¡ä¾\n * 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n * 7. åèèµæ\n\n\n# 1. æå¾\n\näº«åæ¨¡å¼ (flyweight) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼å®æå¼äºå¨æ¯ä¸ªå¯¹è±¡ä¸­ä¿å­æææ°æ®çæ¹å¼ï¼ éè¿å±äº«å¤ä¸ªå¯¹è±¡æå±æçç¸åç¶æï¼ è®©ä½ è½å¨æéçåå­å®¹éä¸­è½½å¥æ´å¤å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * ä»å¨ç¨åºå¿é¡»æ¯æå¤§éå¯¹è±¡ä¸æ²¡æè¶³å¤çåå­å®¹éæ¶ä½¿ç¨äº«åæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. äº«åæ¨¡å¼åªæ¯ä¸ç§ä¼åã å¨åºç¨è¯¥æ¨¡å¼ä¹åï¼ ä½ è¦ç¡®å®ç¨åºä¸­å­å¨ä¸å¤§éç±»ä¼¼å¯¹è±¡åæ¶å ç¨åå­ç¸å³çåå­æ¶èé®é¢ï¼ å¹¶ä¸ç¡®ä¿è¯¥é®é¢æ æ³ä½¿ç¨å¶ä»æ´å¥½çæ¹å¼æ¥è§£å³ã\n 2. äº«å ï¼flyweightï¼ ç±»åå«åå§å¯¹è±¡ä¸­é¨åè½å¨å¤ä¸ªå¯¹è±¡ä¸­å±äº«çç¶æã åä¸äº«åå¯¹è±¡å¯å¨è®¸å¤ä¸åææ¯ä¸­ä½¿ç¨ã äº«åä¸­å­å¨çç¶æè¢«ç§°ä¸º âåå¨ç¶æâã ä¼ éç»äº«åæ¹æ³çç¶æè¢«ç§°ä¸º âå¤å¨ç¶æâã\n 3. ææ¯ ï¼contextï¼ ç±»åå«åå§å¯¹è±¡ä¸­åä¸ç¸åçå¤å¨ç¶æã ææ¯ä¸äº«åå¯¹è±¡ç»åå¨ä¸èµ·å°±è½è¡¨ç¤ºåå§å¯¹è±¡çå¨é¨ç¶æã\n 4. éå¸¸æåµä¸ï¼ åå§å¯¹è±¡çè¡ä¸ºä¼ä¿çå¨äº«åç±»ä¸­ã å æ­¤è°ç¨äº«åæ¹æ³å¿é¡»æä¾é¨åå¤å¨ç¶æä½ä¸ºåæ°ã ä½ä½ ä¹å¯å°è¡ä¸ºç§»å¨å°ææ¯ç±»ä¸­ï¼ ç¶åå°è¿å¥çäº«åä½ä¸ºåçº¯çæ°æ®å¯¹è±¡ã\n 5. å®¢æ·ç«¯ ï¼clientï¼ è´è´£è®¡ç®æå­å¨äº«åçå¤å¨ç¶æã å¨å®¢æ·ç«¯çæ¥ï¼ äº«åæ¯ä¸ç§å¯å¨è¿è¡æ¶è¿è¡éç½®çæ¨¡æ¿å¯¹è±¡ï¼ å·ä½çéç½®æ¹å¼ä¸ºåå¶æ¹æ³ä¸­ä¼ å¥ä¸äºææ¯æ°æ®åæ°ã\n 6. äº«åå·¥å ï¼flyweight factoryï¼ ä¼å¯¹å·²æäº«åçç¼å­æ± è¿è¡ç®¡çã æäºå·¥ååï¼ å®¢æ·ç«¯å°±æ éç´æ¥åå»ºäº«åï¼ å®ä»¬åªéè°ç¨å·¥åå¹¶åå¶ä¼ éç®æ äº«åçä¸äºåå¨ç¶æå³å¯ã å·¥åä¼æ ¹æ®åæ°å¨ä¹åå·²åå»ºçäº«åä¸­è¿è¡æ¥æ¾ï¼ å¦ææ¾å°æ»¡è¶³æ¡ä»¶çäº«åå°±å°å¶è¿åï¼ å¦ææ²¡ææ¾å°å°±æ ¹æ®åæ°æ°å»ºäº«åã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nflyweight : å®æ¯ææå·ä½äº«åç±»çè¶ç±»ææ¥å£ï¼éè¿è¿ä¸ªæ¥å£ï¼flyweight å¯ä»¥æ¥åå¹¶ä½ç¨äºå¤é¨ç¶æã\n\nabstract class flyweight {\n    public abstract void operation(int extrinsicstates);\n}\n\n\nconcreteflyweight : æ¯ç»§æ¿ flyweight è¶ç±»æå®ç° flyweight æ¥å£ï¼å¹¶ä¸ºåé¨ç¶æå¢å å­å¨ç©ºé´ã\n\nclass concreteflyweight extends flyweight {\n    @override\n    public void operation(int extrinsicstates) {\n        system.out.println("å±äº«çflyweight : " + extrinsicstates);\n    }\n}\n\n\nunsharedconcreteflyweight : æé£äºä¸éè¦å±äº«ç flyweight å­ç±»ï¼å ä¸º flyweight æ¥å£å±äº«æä¸ºå¯è½ï¼ä½å®å¹¶ä¸å¼ºå¶å±äº«ã\n\nclass unsharedconcreteflyweight extends flyweight {\n    @override\n    public void operation(int extrinsicstates) {\n        system.out.println("ä¸å±äº«çflyweight : " + extrinsicstates);\n    }\n}\n\n\nflywightfactory :æ¯ä¸ä¸ªäº«åå·¥åï¼ç¨æ¥åå»ºå¹¶ç®¡ç flyweight å¯¹è±¡ãå®ä¸»è¦æ¯ç¨æ¥ç¡®ä¿åçå°å±äº« flyweight ï¼å½ç¨æ·è¯·æ±ä¸ä¸ª flyweight æ¶ï¼ flyweightfactory å¯¹è±¡æä¾ä¸ä¸ªå·²åå»ºçå®ä¾æåå»ºä¸ä¸ªï¼å¦æå¯¹è±¡ä¸å­å¨çè¯ï¼ã\n\nclass flywightfactory {\n    private hashtable<string, flyweight> flyweights = new hashtable<string, flyweight>();\n\n    public flywightfactory() {\n        flyweights.put("x", new concreteflyweight());\n        flyweights.put("y", new concreteflyweight());\n        flyweights.put("z", new concreteflyweight());\n    }\n\n    public flyweight getflyweight(string key) {\n        return ((flyweight)flyweights.get(key));\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class flyweightpattern {\n    public static void main(string[] args) {\n        int extrinsicstates = 1;\n        flywightfactory factory = new flywightfactory();\n\n        flyweight fx = factory.getflyweight("x");\n        fx.operation(extrinsicstates);\n\n        flyweight fy = factory.getflyweight("y");\n        fy.operation(++extrinsicstates);\n\n        flyweight fz = factory.getflyweight("z");\n        fz.operation(++extrinsicstates);\n\n        flyweight uf = new unsharedconcreteflyweight();\n        uf.operation(++extrinsicstates);\n    }\n}\n\n\nè¾åº\n\nå±äº«çflyweight : 1\nå±äº«çflyweight : 2\nå±äº«çflyweight : 3\nä¸å±äº«çflyweight : 4\n\n\n\n# 4. ä¼ªä»£ç \n\n\n\nå¨æ¬ä¾ä¸­ï¼ äº«åæ¨¡å¼è½ææåå°å¨ç»å¸ä¸æ¸²ææ°ç¾ä¸ä¸ªæ ç¶å¯¹è±¡æ¶æéçåå­ã\n\nè¯¥æ¨¡å¼ä»ä¸»è¦ç æ tree ç±»ä¸­æ½ååå¨ç¶æï¼ å¹¶å°å¶ç§»å¨å°äº«åç±» æ ç§ç±»treeÂ­type ä¹ä¸­ã\n\næåç¨åºéè¦å¨å¤ä¸ªå¯¹è±¡ä¸­å­å¨ç¸åæ°æ®ï¼ èç°å¨ä»éå¨å ä¸ªäº«åå¯¹è±¡ä¸­ä¿å­æ°æ®ï¼ ç¶åå¨ä½ä¸ºææ¯ç æ å¯¹è±¡ä¸­è¿å¥äº«åå³å¯ã å®¢æ·ç«¯ä»£ç ä½¿ç¨äº«åå·¥ååå»ºæ å¯¹è±¡å¹¶å°è£æç´¢æå®å¯¹è±¡çå¤æè¡ä¸ºï¼ å¹¶è½å¨éè¦æ¶å¤ç¨å¯¹è±¡ã\n\n// äº«åç±»åå«ä¸ä¸ªæ çé¨åç¶æãè¿äºæååéä¿å­çæ°å¼å¯¹äºç¹å®æ èè¨æ¯å¯ä¸\n// çãä¾å¦ï¼ä½ å¨è¿éæ¾ä¸å°æ çåæ ãä½è¿éæå¾å¤æ æ¨ä¹é´æå±æççº¹çåé¢\n// è²ãç±äºè¿äºæ°æ®çä½ç§¯éå¸¸éå¸¸å¤§ï¼æä»¥å¦æè®©æ¯æ£µæ é½å¶è¿è¡ä¿å­çè¯å°è\n// è´¹å¤§éåå­ãå æ­¤ï¼æä»¬å¯å°çº¹çãé¢è²åå¶ä»éå¤æ°æ®å¯¼åºå°ä¸ä¸ªåç¬çå¯¹è±¡\n// ä¸­ï¼ç¶åè®©ä¼å¤çåä¸ªæ å¯¹è±¡å»å¼ç¨å®ã\nclass treetype is\n    field name\n    field color\n    field texture\n    constructor treetype(name, color, texture) { ... }\n    method draw(canvas, x, y) is\n        // 1. åå»ºç¹å®ç±»åãé¢è²åçº¹ççä½å¾ã\n        // 2. å¨ç»å¸åæ  (x,y) å¤ç»å¶ä½å¾ã\n\n// äº«åå·¥åå³å®æ¯å¦å¤ç¨å·²æäº«åæèåå»ºä¸ä¸ªæ°çå¯¹è±¡ã\nclass treefactory is\n    static field treetypes: collection of tree types\n    static method gettreetype(name, color, texture) is\n        type = treetypes.find(name, color, texture)\n        if (type == null)\n            type = new treetype(name, color, texture)\n            treetypes.add(type)\n        return type\n\n// ææ¯å¯¹è±¡åå«æ ç¶æçå¤å¨é¨åãç¨åºä¸­å¯ä»¥åå»ºæ°åäº¿ä¸ªæ­¤ç±»å¯¹è±¡ï¼å ä¸ºå®ä»¬\n// ä½ç§¯å¾å°ï¼ä»æä¸¤ä¸ªæ´ååæ åä¸ä¸ªå¼ç¨æååéã\nclass tree is\n    field x,y\n    field type: treetype\n    constructor tree(x, y, type) { ... }\n    method draw(canvas) is\n        type.draw(canvas, this.x, this.y)\n\n// æ ï¼treeï¼åæ£®æï¼forestï¼ç±»æ¯äº«åçå®¢æ·ç«¯ãå¦æä¸æç®ç»§ç»­å¯¹æ ç±»è¿è¡å¼\n// åï¼ä½ å¯ä»¥å°å®ä»¬åå¹¶ã\nclass forest is\n    field trees: collection of trees\n\n    method planttree(x, y, name, color, texture) is\n        type = treefactory.gettreetype(name, color, texture)\n        tree = new tree(x, y, type)\n        trees.add(tree)\n\n    method draw(canvas) is\n        foreach (tree in trees) do\n            tree.draw(canvas)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ äº«åæ¨¡å¼åªæä¸ä¸ªç®çï¼ å°åå­æ¶èæå°åã å¦æä½ çç¨åºæ²¡æéå°åå­å®¹éä¸è¶³çé®é¢ï¼ åå¯ä»¥ææ¶å¿½ç¥è¯¥æ¨¡å¼ã\n\näº«åæ¨¡å¼å¨æ ¸å¿ java ç¨åºåºä¸­çç¤ºä¾ï¼\n\n * java.lang.integer#valueof(int) ï¼ä»¥å booleanã byteã characterã shortã long å bigÂ­decimalï¼\n\nè¯å«æ¹æ³ï¼ äº«åå¯ä»¥éè¿æå»ºæ¹æ³æ¥è¯å«ï¼ å®ä¼è¿åç¼å­å¯¹è±¡èä¸æ¯åå»ºæ°çå¯¹è±¡ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥ä½¿ç¨äº«åæ¨¡å¼å®ç°ç»åæ¨¡å¼æ çå±äº«å¶èç¹ä»¥èçåå­ã\n * äº«åå±ç¤ºäºå¦ä½çæå¤§éçå°åå¯¹è±¡ï¼ å¤è§æ¨¡å¼åå±ç¤ºäºå¦ä½ç¨ä¸ä¸ªå¯¹è±¡æ¥ä»£è¡¨æ´ä¸ªå­ç³»ç»ã\n * å¦æä½ è½å°å¯¹è±¡çææå±äº«ç¶æç®åä¸ºä¸ä¸ªäº«åå¯¹è±¡ï¼ é£ä¹äº«åå°±ååä¾æ¨¡å¼ç±»ä¼¼äºã ä½è¿ä¸¤ä¸ªæ¨¡å¼æä¸¤ä¸ªæ ¹æ¬æ§çä¸åã\n   1. åªä¼æä¸ä¸ªåä¾å®ä½ï¼ ä½æ¯äº«åç±»å¯ä»¥æå¤ä¸ªå®ä½ï¼ åå®ä½çåå¨ç¶æä¹å¯ä»¥ä¸åã\n   2. åä¾å¯¹è±¡å¯ä»¥æ¯å¯åçã äº«åå¯¹è±¡æ¯ä¸å¯åçã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ä»£çæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ä»£çæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-19T11:38:00.000Z",permalink:"/pages/2937c1/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/13.%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/13.ä»£çæ¨¡å¼.md",key:"v-51d6ac9c",path:"/pages/2937c1/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:187},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:497},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:509},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:785},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1382},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3619},{level:3,title:"5.1. æ³¨è§£+åå°+ä»£çæ¶é¤éå¤ä»£ç ",slug:"_5-1-æ³¨è§£-åå°-ä»£çæ¶é¤éå¤ä»£ç ",normalizedTitle:"5.1. æ³¨è§£+åå°+ä»£çæ¶é¤éå¤ä»£ç ",charIndex:3952},{level:4,title:"é®é¢çæ¬",slug:"é®é¢çæ¬",normalizedTitle:"é®é¢çæ¬",charIndex:4280},{level:4,title:"ä¼åçæ¬",slug:"ä¼åçæ¬",normalizedTitle:"ä¼åçæ¬",charIndex:6344},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:11181},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:11463}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 5.1. æ³¨è§£+åå°+ä»£çæ¶é¤éå¤ä»£ç  é®é¢çæ¬ ä¼åçæ¬ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ä»£çæ¨¡å¼\n\n\n# 1. æå¾\n\nä»£çæ¨¡å¼ (Proxy) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ ä¸ºå¶ä»å¯¹è±¡æä¾ä¸ç§ä»£çä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n\n * ä»£çæ¨¡å¼ä»ç»äºä¸ç§è®¿é®å¯¹è±¡çé´æ¥ç­çº§ã\n * ä¸ä¸ªè¿ç¨ä»£çå¯ä»¥éèä¸ä¸ªå¯¹è±¡å¨ä¸åå°åç©ºé´çç»èã\n * ä¸ä¸ªèæä»£çå¯ä»¥æ ¹æ®éè¦æä¼ååå»ºå¯¹è±¡çå¼éã\n * èå®å¨ä»£çåæºè½æå¼é½åè®¸è®¿é®å¯¹è±¡çåæ¶å¤çå¶ä»äºå¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å»¶è¿åå§å ï¼èæä»£çï¼ã å¦æä½ æä¸ä¸ªå¶å°ä½¿ç¨çééçº§æå¡å¯¹è±¡ï¼ ä¸ç´ä¿æè¯¥å¯¹è±¡è¿è¡ä¼æ¶èç³»ç»èµæºæ¶ï¼ å¯ä½¿ç¨ä»£çæ¨¡å¼ã\n * è®¿é®æ§å¶ ï¼ä¿æ¤ä»£çï¼ã å¦æä½ åªå¸æç¹å®å®¢æ·ç«¯ä½¿ç¨æå¡å¯¹è±¡ï¼ è¿éçå¯¹è±¡å¯ä»¥æ¯æä½ç³»ç»ä¸­éå¸¸éè¦çé¨åï¼ èå®¢æ·ç«¯åæ¯åç§å·²å¯å¨çç¨åº ï¼åæ¬æ¶æç¨åºï¼ï¼ æ­¤æ¶å¯ä½¿ç¨ä»£çæ¨¡å¼ã\n * æ¬å°æ§è¡è¿ç¨æå¡ ï¼è¿ç¨ä»£çï¼ã éç¨äºæå¡å¯¹è±¡ä½äºè¿ç¨æå¡å¨ä¸çæå½¢ã\n * è®°å½æ¥å¿è¯·æ± ï¼æ¥å¿è®°å½ä»£çï¼ã éç¨äºå½ä½ éè¦ä¿å­å¯¹äºæå¡å¯¹è±¡çè¯·æ±åå²è®°å½æ¶ã ä»£çå¯ä»¥å¨åæå¡ä¼ éè¯·æ±åè¿è¡è®°å½ã\n * æºè½å¼ç¨ã å¯å¨æ²¡æå®¢æ·ç«¯ä½¿ç¨æä¸ªééçº§å¯¹è±¡æ¶ç«å³éæ¯è¯¥å¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æå¡æ¥å£ ï¼Service Interfaceï¼ å£°æäºæå¡æ¥å£ã ä»£çå¿é¡»éµå¾ªè¯¥æ¥å£æè½ä¼ªè£ææå¡å¯¹è±¡ã\n 2. æå¡ ï¼Serviceï¼ ç±»æä¾äºä¸äºå®ç¨çä¸å¡é»è¾ã\n 3. ä»£ç ï¼Proxyï¼ ç±»åå«ä¸ä¸ªæåæå¡å¯¹è±¡çå¼ç¨æååéã ä»£çå®æå¶ä»»å¡ ï¼ä¾å¦å»¶è¿åå§åã è®°å½æ¥å¿ã è®¿é®æ§å¶åç¼å­ç­ï¼ åä¼å°è¯·æ±ä¼ éç»æå¡å¯¹è±¡ã éå¸¸æåµä¸ï¼ ä»£çä¼å¯¹å¶æå¡å¯¹è±¡çæ´ä¸ªçå½å¨æè¿è¡ç®¡çã\n 4. å®¢æ·ç«¯ ï¼Clientï¼ è½éè¿åä¸æ¥å£ä¸æå¡æä»£çè¿è¡äº¤äºï¼ æä»¥ä½ å¯å¨ä¸åéè¦æå¡å¯¹è±¡çä»£ç ä¸­ä½¿ç¨ä»£çã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nSubject : å®ä¹äº RealSubject å Proxy çå¬å±æ¥å£ï¼è¿æ ·å°±å¨ä»»ä½ä½¿ç¨ RealSubject çå°æ¹é½å¯ä»¥ä½¿ç¨ Proxy ã\n\nabstract class Subject {\n    public abstract void Request();\n}\n\n\nRealSubject : å®ä¹ Proxy æä»£è¡¨ççå®å®ä½ã\n\nclass RealSubject extends Subject {\n    @Override\n    public void Request() {\n        System.out.println("çå®çè¯·æ±");\n    }\n}\n\n\nProxy : ä¿å­ä¸ä¸ªå¼ç¨ä½¿å¾ä»£çå¯ä»¥è®¿é®å®ä½ï¼å¹¶æä¾ä¸ä¸ªä¸ Subject çæ¥å£ç¸åçæ¥å£ï¼è¿æ ·ä»£çå°±å¯ä»¥ç¨æ¥æ¿ä»£å®ä½ã\n\nclass Proxy extends Subject {\n    private RealSubject real;\n\n    @Override\n    public void Request() {\n        if (null == real) {\n            real = new RealSubject();\n        }\n        real.Request();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾æ¼ç¤ºå¦ä½ä½¿ç¨ä»£çæ¨¡å¼å¨ç¬¬ä¸æ¹è¾è®¯è§é¢ ï¼TencentVideoï¼ ä»£ç ç¤ºä¾ä¸­è®°ä¸º TVï¼ ç¨åºåºä¸­æ·»å å»¶è¿åå§ååç¼å­ã\n\n\n\nç¨åºåºæä¾äºè§é¢ä¸è½½ç±»ã ä½æ¯è¯¥ç±»çæçéå¸¸ä½ã å¦æå®¢æ·ç«¯ç¨åºå¤æ¬¡è¯·æ±åä¸è§é¢ï¼ ç¨åºåºä¼åå¤ä¸è½½è¯¥è§é¢ï¼ èä¸ä¼å°é¦æ¬¡ä¸è½½çæä»¶ç¼å­ä¸æ¥å¤ç¨ã\n\nä»£çç±»å®ç°ååä¸è½½å¨ç¸åçæ¥å£ï¼ å¹¶å°ææå·¥ä½å§æ´¾ç»åä¸è½½å¨ã ä¸è¿ï¼ ä»£çç±»ä¼ä¿å­ææçæä»¶ä¸è½½è®°å½ï¼ å¦æç¨åºå¤æ¬¡è¯·æ±åä¸æä»¶ï¼ å®ä¼è¿åç¼å­çæä»¶ã\n\n// è¿ç¨æå¡æ¥å£ã\ninterface ThirdPartyTVLib is\n    method listVideos()\n    method getVideoInfo(id)\n    method downloadVideo(id)\n\n// æå¡è¿æ¥å¨çå·ä½å®ç°ãè¯¥ç±»çæ¹æ³å¯ä»¥åè¾è®¯è§é¢è¯·æ±ä¿¡æ¯ãè¯·æ±éåº¦åå³äº\n// ç¨æ·åè¾è®¯è§é¢çäºèç½è¿æ¥æåµãå¦æåæ¶åéå¤§éè¯·æ±ï¼å³ä½¿æè¯·æ±çä¿¡æ¯\n// ä¸æ¨¡ä¸æ ·ï¼ç¨åºçéåº¦ä¾ç¶ä¼åæ¢ã\nclass ThirdPartyTVClass implements ThirdPartyTVLib is\n    method listVideos() is\n        // åè¾è®¯è§é¢åéä¸ä¸ª API è¯·æ±ã\n\n    method getVideoInfo(id) is\n        // è·åæä¸ªè§é¢çåæ°æ®ã\n\n    method downloadVideo(id) is\n        // ä»è¾è®¯è§é¢ä¸è½½ä¸ä¸ªè§é¢æä»¶ã\n\n// ä¸ºäºèçç½ç»å¸¦å®½ï¼æä»¬å¯ä»¥å°è¯·æ±ç»æç¼å­ä¸æ¥å¹¶ä¿å­ä¸æ®µæ¶é´ãä½ä½ å¯è½æ \n// æ³ç´æ¥å°è¿äºä»£ç æ¾å¥æå¡ç±»ä¸­ãæ¯å¦è¯¥ç±»å¯è½æ¯ç¬¬ä¸æ¹ç¨åºåºçä¸é¨åæå¶ç­¾\n// åæ¯`finalï¼æç»ï¼`ãå æ­¤æä»¬ä¼å¨ä¸ä¸ªå®ç°äºæå¡ç±»æ¥å£çæ°ä»£çç±»ä¸­æ¾å¥\n// ç¼å­ä»£ç ãå½ä»£çç±»æ¥æ¶å°çå®è¯·æ±åï¼æä¼å°å¶å§æ´¾ç»æå¡å¯¹è±¡ã\nclass CachedTVClass implements ThirdPartyTVLib is\n    private field service: ThirdPartyTVLib\n    private field listCache, videoCache\n    field needReset\n\n    constructor CachedTVClass(service: ThirdPartyTVLib) is\n        this.service = service\n\n    method listVideos() is\n        if (listCache == null || needReset)\n            listCache = service.listVideos()\n        return listCache\n\n    method getVideoInfo(id) is\n        if (videoCache == null || needReset)\n            videoCache = service.getVideoInfo(id)\n        return videoCache\n\n    method downloadVideo(id) is\n        if (!downloadExists(id) || needReset)\n            service.downloadVideo(id)\n\n// ä¹åç´æ¥ä¸æå¡å¯¹è±¡äº¤äºç GUI ç±»ä¸éè¦æ¹åï¼åææ¯å®ä»éè¿æ¥å£ä¸æå¡å¯¹\n// è±¡äº¤äºãæä»¬å¯ä»¥å®å¨å°ä¼ éä¸ä¸ªä»£çå¯¹è±¡æ¥ä»£æ¿çå®æå¡å¯¹è±¡ï¼å ä¸ºå®ä»¬é½å®\n// ç°äºç¸åçæ¥å£ã\nclass TVManager is\n    protected field service: ThirdPartyTVLib\n\n    constructor TVManager(service: ThirdPartyTVLib) is\n        this.service = service\n\n    method renderVideoPage(id) is\n        info = service.getVideoInfo(id)\n        // æ¸²æè§é¢é¡µé¢ã\n\n    method renderListPanel() is\n        list = service.listVideos()\n        // æ¸²æè§é¢ç¼©ç¥å¾åè¡¨ã\n\n    method reactOnUserInput() is\n        renderVideoPage()\n        renderListPanel()\n\n// ç¨åºå¯å¨è¿è¡æ¶å¯¹ä»£çè¿è¡éç½®ã\nclass Application is\n    method init() is\n        aTVService = new ThirdPartyTVClass()\n        aTVProxy = new CachedTVClass(aTVService)\n        manager = new TVManager(aTVProxy)\n        manager.reactOnUserInput()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å°½ç®¡ä»£çæ¨¡å¼å¨ç»å¤§å¤æ° Java ç¨åºä¸­å¹¶ä¸å¸¸è§ï¼ ä½å®å¨ä¸äºç¹æ®æåµä¸ä»ç¶éå¸¸æ¹ä¾¿ã å½ä½ å¸æå¨æ éä¿®æ¹å®¢æ·ä»£ç çåæä¸äºå·²æç±»çå¯¹è±¡ä¸å¢å é¢å¤è¡ä¸ºæ¶ï¼ è¯¥æ¨¡å¼æ¯æ å¯æ¿ä»£çã\n\nJava æ åç¨åºåºä¸­çä¸äºä»£çæ¨¡å¼çç¤ºä¾ï¼\n\n * java.lang.reflect.Proxy\n * java.rmi.*\n * javax.ejb.EJB ï¼æ¥çè¯è®ºï¼\n * javax.inject.Inject ï¼æ¥çè¯è®ºï¼\n * javax.persistence.PersistenceContext\n\nè¯å«æ¹æ³ï¼ ä»£çæ¨¡å¼ä¼å°ææå®éå·¥ä½å§æ´¾ç»ä¸äºå¶ä»å¯¹è±¡ã é¤éä»£çæ¯æä¸ªæå¡çå­ç±»ï¼ å¦åæ¯ä¸ªä»£çæ¹æ³æåé½åºè¯¥å¼ç¨ä¸ä¸ªæå¡å¯¹è±¡ã\n\n\n# 5.1. æ³¨è§£+åå°+ä»£çæ¶é¤éå¤ä»£ç \n\nåè®¾é¶è¡æä¾äºä¸äº API æ¥å£ï¼å¯¹åæ°çåºååæç¹ç¹æ®ï¼ä¸ä½¿ç¨ JSONï¼èæ¯éè¦æä»¬æåæ°ä¾æ¬¡æ¼å¨ä¸èµ·ææä¸ä¸ªå¤§å­ç¬¦ä¸²ã\n\næç§é¶è¡æä¾ç API ææ¡£çé¡ºåºï¼æææåæ°ææå®é¿çæ°æ®ï¼ç¶åæ¼æ¥å¨ä¸èµ·ä½ä¸ºæ´ä¸ªå­ç¬¦ä¸²ãå ä¸ºæ¯ä¸ç§åæ°é½æåºå®é¿åº¦ï¼æªè¾¾å°é¿åº¦æ¶éè¦åå¡«åå¤çï¼\n\n * å­ç¬¦ä¸²ç±»åçåæ°ä¸æ»¡é¿åº¦é¨åéè¦ä»¥ä¸åçº¿å³å¡«åï¼ä¹å°±æ¯å­ç¬¦ä¸²åå®¹é å·¦ï¼\n * æ°å­ç±»åçåæ°ä¸æ»¡é¿åº¦é¨åä»¥ 0 å·¦å¡«åï¼ä¹å°±æ¯å®éæ°å­é å³ï¼\n * è´§å¸ç±»åçè¡¨ç¤ºéè¦æéé¢åä¸èå¥ 2 ä½å°åï¼ä»¥åä¸ºåä½ï¼ä½ä¸ºæ°å­ç±»ååæ ·è¿è¡ å·¦å¡«åã\n\nå¯¹ææåæ°å MD5 æä½ä½ä¸ºç­¾åï¼ä¸ºäºæ¹ä¾¿çè§£ï¼Demo ä¸­ä¸æ¶åå çå¤çï¼ã\n\n# é®é¢çæ¬\n\nimport org.apache.commons.codec.digest.DigestUtils;\nimport org.apache.http.client.fluent.Request;\nimport org.apache.http.entity.ContentType;\n\nimport java.io.IOException;\nimport java.math.BigDecimal;\nimport java.math.RoundingMode;\n\npublic class BankService {\n\n    public static String createUser(String name, String identity, String mobile, int age) throws IOException {\n        StringBuilder stringBuilder = new StringBuilder();\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringBuilder.append(String.format("%-10s", name).replace(\' \', \'_\'));\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringBuilder.append(String.format("%-18s", identity).replace(\' \', \'_\'));\n        //æ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringBuilder.append(String.format("%05d", age));\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringBuilder.append(String.format("%-11s", mobile).replace(\' \', \'_\'));\n        //æåå ä¸MD5ä½ä¸ºç­¾å\n        stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));\n        return Request.Post("http://localhost:45678/reflection/bank/createUser")\n                .bodyString(stringBuilder.toString(), ContentType.APPLICATION_JSON)\n                .execute().returnContent().asString();\n    }\n\n    public static String pay(long userId, BigDecimal amount) throws IOException {\n        StringBuilder stringBuilder = new StringBuilder();\n        //æ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringBuilder.append(String.format("%020d", userId));\n        //éé¢åä¸èå¥2ä½å°åï¼ä»¥åä¸ºåä½ï¼ä½ä¸ºæ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringBuilder.append(String.format("%010d", amount.setScale(2, RoundingMode.DOWN).multiply(new BigDecimal("100")).longValue()));\n        //æåå ä¸MD5ä½ä¸ºç­¾å\n        stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));\n        return Request.Post("http://localhost:45678/reflection/bank/pay")\n                .bodyString(stringBuilder.toString(), ContentType.APPLICATION_JSON)\n                .execute().returnContent().asString();\n    }\n}\n\n\nå¨ä»¥ä¸çä»£ç çæ¬ä¸­ï¼å­å¨ä»¥ä¸é®é¢ï¼\n\n * ä¸ç§æ åæ°æ®ç±»åçå¤çé»è¾æéå¤ï¼ç¨æä¸æå°±ä¼åºç° Bugï¼\n * å¤çæµç¨ä¸­å­ç¬¦ä¸²æ¼æ¥ãå ç­¾ååè¯·æ±çé»è¾ï¼å¨æææ¹æ³éå¤ï¼\n * å®éæ¹æ³çå¥åçåæ°ç±»ååé¡ºåºï¼ä¸ä¸å®åæ¥å£è¦æ±ä¸è´ï¼å®¹æåºéï¼\n * ä»£ç å±é¢éå¯¹æ¯ä¸ä¸ªåæ°ç¡¬ç¼ç ï¼æ æ³æ¸æ°å°è¿è¡æ ¸å¯¹ï¼å¦æåæ°è¾¾å°å åä¸ªãä¸ç¾ä¸ªï¼åºéçæ¦çæå¤§ã\n\n# ä¼åçæ¬\n\néå¯¹ä¸é¢ä»£ç çæ¬ä¸­çé®é¢ï¼å¯ä»¥ä½¿ç¨ æ³¨è§£+åå°+ä»£çæ¨¡å¼ è§£å³éå¤ä»£ç ã\n\nãæ³¨è§£ä¸ã\n\nimport java.lang.annotation.*;\n\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Inherited\npublic @interface BankAPI {\n\n    String desc() default "";\n\n    String url() default "";\n\n}\n\n\nãæ³¨è§£äºã\n\nimport java.lang.annotation.*;\n\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.FIELD)\n@Documented\n@Inherited\npublic @interface BankAPIField {\n\n    int order() default -1;\n\n    int length() default -1;\n\n    String type() default "";\n\n}\n\n\nãæ½è±¡ç±»ã\n\nabstract class AbstractAPI {}\n\n\nãä»£çç±»ã\n\n@Slf4j\npublic class BetterBankService {\n\n    public static String createUser(String name, String identity, String mobile, int age) throws IOException {\n        CreateUserAPI createUserAPI = new CreateUserAPI();\n        createUserAPI.setName(name);\n        createUserAPI.setIdentity(identity);\n        createUserAPI.setAge(age);\n        createUserAPI.setMobile(mobile);\n        return remoteCall(createUserAPI);\n    }\n\n    public static String pay(long userId, BigDecimal amount) throws IOException {\n        PayAPI payAPI = new PayAPI();\n        payAPI.setUserId(userId);\n        payAPI.setAmount(amount);\n        return remoteCall(payAPI);\n    }\n\n    private static String remoteCall(AbstractAPI api) throws IOException {\n        //ä»BankAPIæ³¨è§£è·åè¯·æ±å°å\n        BankAPI bankAPI = api.getClass().getAnnotation(BankAPI.class);\n        bankAPI.url();\n        StringBuilder stringBuilder = new StringBuilder();\n        Arrays.stream(api.getClass().getDeclaredFields()) //è·å¾ææå­æ®µ\n            .filter(field -> field.isAnnotationPresent(BankAPIField.class)) //æ¥æ¾æ è®°äºæ³¨è§£çå­æ®µ\n            .sorted(Comparator.comparingInt(a -> a.getAnnotation(BankAPIField.class).order())) //æ ¹æ®æ³¨è§£ä¸­çorderå¯¹å­æ®µæåº\n            .peek(field -> field.setAccessible(true)) //è®¾ç½®å¯ä»¥è®¿é®ç§æå­æ®µ\n            .forEach(field -> {\n                //è·å¾æ³¨è§£\n                BankAPIField bankAPIField = field.getAnnotation(BankAPIField.class);\n                Object value = "";\n                try {\n                    //åå°è·åå­æ®µå¼\n                    value = field.get(api);\n                } catch (IllegalAccessException e) {\n                    e.printStackTrace();\n                }\n                //æ ¹æ®å­æ®µç±»åä»¥æ­£ç¡®çå¡«åæ¹å¼æ ¼å¼åå­ç¬¦ä¸²\n                switch (bankAPIField.type()) {\n                    case "S": {\n                        stringBuilder.append(\n                            String.format("%-" + bankAPIField.length() + "s", value.toString()).replace(\' \', \'_\'));\n                        break;\n                    }\n                    case "N": {\n                        stringBuilder.append(\n                            String.format("%" + bankAPIField.length() + "s", value.toString()).replace(\' \', \'0\'));\n                        break;\n                    }\n                    case "M": {\n                        if (!(value instanceof BigDecimal)) {\n                            throw new RuntimeException(\n                                String.format("{} ç {} å¿é¡»æ¯BigDecimal", api, field));\n                        }\n                        stringBuilder.append(String.format("%0" + bankAPIField.length() + "d",\n                            ((BigDecimal) value).setScale(2, RoundingMode.DOWN)\n                                .multiply(new BigDecimal("100"))\n                                .longValue()));\n                        break;\n                    }\n                    default:\n                        break;\n                }\n            });\n        //ç­¾åé»è¾\n        stringBuilder.append(DigestUtils.md2Hex(stringBuilder.toString()));\n        String param = stringBuilder.toString();\n        long begin = System.currentTimeMillis();\n        //åè¯·æ±\n        String result = Request.Post("http://localhost:45678/reflection" + bankAPI.url())\n            .bodyString(param, ContentType.APPLICATION_JSON)\n            .execute().returnContent().asString();\n        log.info("è°ç¨é¶è¡API {} url:{} åæ°:{} èæ¶:{}ms", bankAPI.desc(), bankAPI.url(), param,\n            System.currentTimeMillis() - begin);\n        return result;\n    }\n\n}\n\n\nãæ³¨è§£ä¿®é¥°ç API æ¥å£ä¸ã\n\nimport lombok.Data;\n\n@BankAPI(url = "/bank/createUser", desc = "åå»ºç¨æ·æ¥å£")\n@Data\npublic class CreateUserAPI extends AbstractAPI {\n\n    @BankAPIField(order = 1, type = "S", length = 10)\n    private String name;\n    @BankAPIField(order = 2, type = "S", length = 18)\n    private String identity;\n    @BankAPIField(order = 4, type = "S", length = 11)\n    private String mobile;\n    @BankAPIField(order = 3, type = "N", length = 5)\n    private int age;\n\n}\n\n\nãæ³¨è§£ä¿®é¥°ç API æ¥å£äºã\n\nimport lombok.Data;\n\nimport java.math.BigDecimal;\n\n@BankAPI(url = "/bank/pay", desc = "æ¯ä»æ¥å£")\n@Data\npublic class PayAPI extends AbstractAPI {\n\n    @BankAPIField(order = 1, type = "N", length = 20)\n    private long userId;\n    @BankAPIField(order = 2, type = "M", length = 10)\n    private BigDecimal amount;\n\n}\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ééå¨æ¨¡å¼è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°æ¨¡å¼åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * å¤è§æ¨¡å¼ä¸ä»£ççç¸ä¼¼ä¹å¤å¨äºå®ä»¬é½ç¼å­äºä¸ä¸ªå¤æå®ä½å¹¶èªè¡å¯¹å¶è¿è¡åå§åã ä»£çä¸å¶æå¡å¯¹è±¡éµå¾ªåä¸æ¥å£ï¼ ä½¿å¾èªå·±åæå¡å¯¹è±¡å¯ä»¥äºæ¢ï¼ å¨è¿ä¸ç¹ä¸å®ä¸å¤è§ä¸åã\n * è£é¥°åä»£çæçç¸ä¼¼çç»æï¼ ä½æ¯å¶æå¾å´éå¸¸ä¸åã è¿ä¸¤ä¸ªæ¨¡å¼çæå»ºé½åºäºç»åååï¼ ä¹å°±æ¯è¯´ä¸ä¸ªå¯¹è±¡åºè¯¥å°é¨åå·¥ä½å§æ´¾ç»å¦ä¸ä¸ªå¯¹è±¡ã ä¸¤èä¹é´çä¸åä¹å¤å¨äºä»£çéå¸¸èªè¡ç®¡çå¶æå¡å¯¹è±¡ççå½å¨æï¼ èè£é¥°ççæåæ»æ¯ç±å®¢æ·ç«¯è¿è¡æ§å¶ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ä»£çæ¨¡å¼\n\n\n# 1. æå¾\n\nä»£çæ¨¡å¼ (proxy) æ¯ä¸ç§ç»æåè®¾è®¡æ¨¡å¼ï¼ ä¸ºå¶ä»å¯¹è±¡æä¾ä¸ç§ä»£çä»¥æ§å¶å¯¹è¿ä¸ªå¯¹è±¡çè®¿é®ã\n\n * ä»£çæ¨¡å¼ä»ç»äºä¸ç§è®¿é®å¯¹è±¡çé´æ¥ç­çº§ã\n * ä¸ä¸ªè¿ç¨ä»£çå¯ä»¥éèä¸ä¸ªå¯¹è±¡å¨ä¸åå°åç©ºé´çç»èã\n * ä¸ä¸ªèæä»£çå¯ä»¥æ ¹æ®éè¦æä¼ååå»ºå¯¹è±¡çå¼éã\n * èå®å¨ä»£çåæºè½æå¼é½åè®¸è®¿é®å¯¹è±¡çåæ¶å¤çå¶ä»äºå¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å»¶è¿åå§å ï¼èæä»£çï¼ã å¦æä½ æä¸ä¸ªå¶å°ä½¿ç¨çééçº§æå¡å¯¹è±¡ï¼ ä¸ç´ä¿æè¯¥å¯¹è±¡è¿è¡ä¼æ¶èç³»ç»èµæºæ¶ï¼ å¯ä½¿ç¨ä»£çæ¨¡å¼ã\n * è®¿é®æ§å¶ ï¼ä¿æ¤ä»£çï¼ã å¦æä½ åªå¸æç¹å®å®¢æ·ç«¯ä½¿ç¨æå¡å¯¹è±¡ï¼ è¿éçå¯¹è±¡å¯ä»¥æ¯æä½ç³»ç»ä¸­éå¸¸éè¦çé¨åï¼ èå®¢æ·ç«¯åæ¯åç§å·²å¯å¨çç¨åº ï¼åæ¬æ¶æç¨åºï¼ï¼ æ­¤æ¶å¯ä½¿ç¨ä»£çæ¨¡å¼ã\n * æ¬å°æ§è¡è¿ç¨æå¡ ï¼è¿ç¨ä»£çï¼ã éç¨äºæå¡å¯¹è±¡ä½äºè¿ç¨æå¡å¨ä¸çæå½¢ã\n * è®°å½æ¥å¿è¯·æ± ï¼æ¥å¿è®°å½ä»£çï¼ã éç¨äºå½ä½ éè¦ä¿å­å¯¹äºæå¡å¯¹è±¡çè¯·æ±åå²è®°å½æ¶ã ä»£çå¯ä»¥å¨åæå¡ä¼ éè¯·æ±åè¿è¡è®°å½ã\n * æºè½å¼ç¨ã å¯å¨æ²¡æå®¢æ·ç«¯ä½¿ç¨æä¸ªééçº§å¯¹è±¡æ¶ç«å³éæ¯è¯¥å¯¹è±¡ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æå¡æ¥å£ ï¼service interfaceï¼ å£°æäºæå¡æ¥å£ã ä»£çå¿é¡»éµå¾ªè¯¥æ¥å£æè½ä¼ªè£ææå¡å¯¹è±¡ã\n 2. æå¡ ï¼serviceï¼ ç±»æä¾äºä¸äºå®ç¨çä¸å¡é»è¾ã\n 3. ä»£ç ï¼proxyï¼ ç±»åå«ä¸ä¸ªæåæå¡å¯¹è±¡çå¼ç¨æååéã ä»£çå®æå¶ä»»å¡ ï¼ä¾å¦å»¶è¿åå§åã è®°å½æ¥å¿ã è®¿é®æ§å¶åç¼å­ç­ï¼ åä¼å°è¯·æ±ä¼ éç»æå¡å¯¹è±¡ã éå¸¸æåµä¸ï¼ ä»£çä¼å¯¹å¶æå¡å¯¹è±¡çæ´ä¸ªçå½å¨æè¿è¡ç®¡çã\n 4. å®¢æ·ç«¯ ï¼clientï¼ è½éè¿åä¸æ¥å£ä¸æå¡æä»£çè¿è¡äº¤äºï¼ æä»¥ä½ å¯å¨ä¸åéè¦æå¡å¯¹è±¡çä»£ç ä¸­ä½¿ç¨ä»£çã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nsubject : å®ä¹äº realsubject å proxy çå¬å±æ¥å£ï¼è¿æ ·å°±å¨ä»»ä½ä½¿ç¨ realsubject çå°æ¹é½å¯ä»¥ä½¿ç¨ proxy ã\n\nabstract class subject {\n    public abstract void request();\n}\n\n\nrealsubject : å®ä¹ proxy æä»£è¡¨ççå®å®ä½ã\n\nclass realsubject extends subject {\n    @override\n    public void request() {\n        system.out.println("çå®çè¯·æ±");\n    }\n}\n\n\nproxy : ä¿å­ä¸ä¸ªå¼ç¨ä½¿å¾ä»£çå¯ä»¥è®¿é®å®ä½ï¼å¹¶æä¾ä¸ä¸ªä¸ subject çæ¥å£ç¸åçæ¥å£ï¼è¿æ ·ä»£çå°±å¯ä»¥ç¨æ¥æ¿ä»£å®ä½ã\n\nclass proxy extends subject {\n    private realsubject real;\n\n    @override\n    public void request() {\n        if (null == real) {\n            real = new realsubject();\n        }\n        real.request();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾æ¼ç¤ºå¦ä½ä½¿ç¨ä»£çæ¨¡å¼å¨ç¬¬ä¸æ¹è¾è®¯è§é¢ ï¼tencentvideoï¼ ä»£ç ç¤ºä¾ä¸­è®°ä¸º tvï¼ ç¨åºåºä¸­æ·»å å»¶è¿åå§ååç¼å­ã\n\n\n\nç¨åºåºæä¾äºè§é¢ä¸è½½ç±»ã ä½æ¯è¯¥ç±»çæçéå¸¸ä½ã å¦æå®¢æ·ç«¯ç¨åºå¤æ¬¡è¯·æ±åä¸è§é¢ï¼ ç¨åºåºä¼åå¤ä¸è½½è¯¥è§é¢ï¼ èä¸ä¼å°é¦æ¬¡ä¸è½½çæä»¶ç¼å­ä¸æ¥å¤ç¨ã\n\nä»£çç±»å®ç°ååä¸è½½å¨ç¸åçæ¥å£ï¼ å¹¶å°ææå·¥ä½å§æ´¾ç»åä¸è½½å¨ã ä¸è¿ï¼ ä»£çç±»ä¼ä¿å­ææçæä»¶ä¸è½½è®°å½ï¼ å¦æç¨åºå¤æ¬¡è¯·æ±åä¸æä»¶ï¼ å®ä¼è¿åç¼å­çæä»¶ã\n\n// è¿ç¨æå¡æ¥å£ã\ninterface thirdpartytvlib is\n    method listvideos()\n    method getvideoinfo(id)\n    method downloadvideo(id)\n\n// æå¡è¿æ¥å¨çå·ä½å®ç°ãè¯¥ç±»çæ¹æ³å¯ä»¥åè¾è®¯è§é¢è¯·æ±ä¿¡æ¯ãè¯·æ±éåº¦åå³äº\n// ç¨æ·åè¾è®¯è§é¢çäºèç½è¿æ¥æåµãå¦æåæ¶åéå¤§éè¯·æ±ï¼å³ä½¿æè¯·æ±çä¿¡æ¯\n// ä¸æ¨¡ä¸æ ·ï¼ç¨åºçéåº¦ä¾ç¶ä¼åæ¢ã\nclass thirdpartytvclass implements thirdpartytvlib is\n    method listvideos() is\n        // åè¾è®¯è§é¢åéä¸ä¸ª api è¯·æ±ã\n\n    method getvideoinfo(id) is\n        // è·åæä¸ªè§é¢çåæ°æ®ã\n\n    method downloadvideo(id) is\n        // ä»è¾è®¯è§é¢ä¸è½½ä¸ä¸ªè§é¢æä»¶ã\n\n// ä¸ºäºèçç½ç»å¸¦å®½ï¼æä»¬å¯ä»¥å°è¯·æ±ç»æç¼å­ä¸æ¥å¹¶ä¿å­ä¸æ®µæ¶é´ãä½ä½ å¯è½æ \n// æ³ç´æ¥å°è¿äºä»£ç æ¾å¥æå¡ç±»ä¸­ãæ¯å¦è¯¥ç±»å¯è½æ¯ç¬¬ä¸æ¹ç¨åºåºçä¸é¨åæå¶ç­¾\n// åæ¯`finalï¼æç»ï¼`ãå æ­¤æä»¬ä¼å¨ä¸ä¸ªå®ç°äºæå¡ç±»æ¥å£çæ°ä»£çç±»ä¸­æ¾å¥\n// ç¼å­ä»£ç ãå½ä»£çç±»æ¥æ¶å°çå®è¯·æ±åï¼æä¼å°å¶å§æ´¾ç»æå¡å¯¹è±¡ã\nclass cachedtvclass implements thirdpartytvlib is\n    private field service: thirdpartytvlib\n    private field listcache, videocache\n    field needreset\n\n    constructor cachedtvclass(service: thirdpartytvlib) is\n        this.service = service\n\n    method listvideos() is\n        if (listcache == null || needreset)\n            listcache = service.listvideos()\n        return listcache\n\n    method getvideoinfo(id) is\n        if (videocache == null || needreset)\n            videocache = service.getvideoinfo(id)\n        return videocache\n\n    method downloadvideo(id) is\n        if (!downloadexists(id) || needreset)\n            service.downloadvideo(id)\n\n// ä¹åç´æ¥ä¸æå¡å¯¹è±¡äº¤äºç gui ç±»ä¸éè¦æ¹åï¼åææ¯å®ä»éè¿æ¥å£ä¸æå¡å¯¹\n// è±¡äº¤äºãæä»¬å¯ä»¥å®å¨å°ä¼ éä¸ä¸ªä»£çå¯¹è±¡æ¥ä»£æ¿çå®æå¡å¯¹è±¡ï¼å ä¸ºå®ä»¬é½å®\n// ç°äºç¸åçæ¥å£ã\nclass tvmanager is\n    protected field service: thirdpartytvlib\n\n    constructor tvmanager(service: thirdpartytvlib) is\n        this.service = service\n\n    method rendervideopage(id) is\n        info = service.getvideoinfo(id)\n        // æ¸²æè§é¢é¡µé¢ã\n\n    method renderlistpanel() is\n        list = service.listvideos()\n        // æ¸²æè§é¢ç¼©ç¥å¾åè¡¨ã\n\n    method reactonuserinput() is\n        rendervideopage()\n        renderlistpanel()\n\n// ç¨åºå¯å¨è¿è¡æ¶å¯¹ä»£çè¿è¡éç½®ã\nclass application is\n    method init() is\n        atvservice = new thirdpartytvclass()\n        atvproxy = new cachedtvclass(atvservice)\n        manager = new tvmanager(atvproxy)\n        manager.reactonuserinput()\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å°½ç®¡ä»£çæ¨¡å¼å¨ç»å¤§å¤æ° java ç¨åºä¸­å¹¶ä¸å¸¸è§ï¼ ä½å®å¨ä¸äºç¹æ®æåµä¸ä»ç¶éå¸¸æ¹ä¾¿ã å½ä½ å¸æå¨æ éä¿®æ¹å®¢æ·ä»£ç çåæä¸äºå·²æç±»çå¯¹è±¡ä¸å¢å é¢å¤è¡ä¸ºæ¶ï¼ è¯¥æ¨¡å¼æ¯æ å¯æ¿ä»£çã\n\njava æ åç¨åºåºä¸­çä¸äºä»£çæ¨¡å¼çç¤ºä¾ï¼\n\n * java.lang.reflect.proxy\n * java.rmi.*\n * javax.ejb.ejb ï¼æ¥çè¯è®ºï¼\n * javax.inject.inject ï¼æ¥çè¯è®ºï¼\n * javax.persistence.persistencecontext\n\nè¯å«æ¹æ³ï¼ ä»£çæ¨¡å¼ä¼å°ææå®éå·¥ä½å§æ´¾ç»ä¸äºå¶ä»å¯¹è±¡ã é¤éä»£çæ¯æä¸ªæå¡çå­ç±»ï¼ å¦åæ¯ä¸ªä»£çæ¹æ³æåé½åºè¯¥å¼ç¨ä¸ä¸ªæå¡å¯¹è±¡ã\n\n\n# 5.1. æ³¨è§£+åå°+ä»£çæ¶é¤éå¤ä»£ç \n\nåè®¾é¶è¡æä¾äºä¸äº api æ¥å£ï¼å¯¹åæ°çåºååæç¹ç¹æ®ï¼ä¸ä½¿ç¨ jsonï¼èæ¯éè¦æä»¬æåæ°ä¾æ¬¡æ¼å¨ä¸èµ·ææä¸ä¸ªå¤§å­ç¬¦ä¸²ã\n\næç§é¶è¡æä¾ç api ææ¡£çé¡ºåºï¼æææåæ°ææå®é¿çæ°æ®ï¼ç¶åæ¼æ¥å¨ä¸èµ·ä½ä¸ºæ´ä¸ªå­ç¬¦ä¸²ãå ä¸ºæ¯ä¸ç§åæ°é½æåºå®é¿åº¦ï¼æªè¾¾å°é¿åº¦æ¶éè¦åå¡«åå¤çï¼\n\n * å­ç¬¦ä¸²ç±»åçåæ°ä¸æ»¡é¿åº¦é¨åéè¦ä»¥ä¸åçº¿å³å¡«åï¼ä¹å°±æ¯å­ç¬¦ä¸²åå®¹é å·¦ï¼\n * æ°å­ç±»åçåæ°ä¸æ»¡é¿åº¦é¨åä»¥ 0 å·¦å¡«åï¼ä¹å°±æ¯å®éæ°å­é å³ï¼\n * è´§å¸ç±»åçè¡¨ç¤ºéè¦æéé¢åä¸èå¥ 2 ä½å°åï¼ä»¥åä¸ºåä½ï¼ä½ä¸ºæ°å­ç±»ååæ ·è¿è¡ å·¦å¡«åã\n\nå¯¹ææåæ°å md5 æä½ä½ä¸ºç­¾åï¼ä¸ºäºæ¹ä¾¿çè§£ï¼demo ä¸­ä¸æ¶åå çå¤çï¼ã\n\n# é®é¢çæ¬\n\nimport org.apache.commons.codec.digest.digestutils;\nimport org.apache.http.client.fluent.request;\nimport org.apache.http.entity.contenttype;\n\nimport java.io.ioexception;\nimport java.math.bigdecimal;\nimport java.math.roundingmode;\n\npublic class bankservice {\n\n    public static string createuser(string name, string identity, string mobile, int age) throws ioexception {\n        stringbuilder stringbuilder = new stringbuilder();\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringbuilder.append(string.format("%-10s", name).replace(\' \', \'_\'));\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringbuilder.append(string.format("%-18s", identity).replace(\' \', \'_\'));\n        //æ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringbuilder.append(string.format("%05d", age));\n        //å­ç¬¦ä¸²é å·¦ï¼å¤ä½çå°æ¹_å¡«å\n        stringbuilder.append(string.format("%-11s", mobile).replace(\' \', \'_\'));\n        //æåå ä¸md5ä½ä¸ºç­¾å\n        stringbuilder.append(digestutils.md2hex(stringbuilder.tostring()));\n        return request.post("http://localhost:45678/reflection/bank/createuser")\n                .bodystring(stringbuilder.tostring(), contenttype.application_json)\n                .execute().returncontent().asstring();\n    }\n\n    public static string pay(long userid, bigdecimal amount) throws ioexception {\n        stringbuilder stringbuilder = new stringbuilder();\n        //æ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringbuilder.append(string.format("%020d", userid));\n        //éé¢åä¸èå¥2ä½å°åï¼ä»¥åä¸ºåä½ï¼ä½ä¸ºæ°å­é å³ï¼å¤ä½çå°æ¹ç¨0å¡«å\n        stringbuilder.append(string.format("%010d", amount.setscale(2, roundingmode.down).multiply(new bigdecimal("100")).longvalue()));\n        //æåå ä¸md5ä½ä¸ºç­¾å\n        stringbuilder.append(digestutils.md2hex(stringbuilder.tostring()));\n        return request.post("http://localhost:45678/reflection/bank/pay")\n                .bodystring(stringbuilder.tostring(), contenttype.application_json)\n                .execute().returncontent().asstring();\n    }\n}\n\n\nå¨ä»¥ä¸çä»£ç çæ¬ä¸­ï¼å­å¨ä»¥ä¸é®é¢ï¼\n\n * ä¸ç§æ åæ°æ®ç±»åçå¤çé»è¾æéå¤ï¼ç¨æä¸æå°±ä¼åºç° bugï¼\n * å¤çæµç¨ä¸­å­ç¬¦ä¸²æ¼æ¥ãå ç­¾ååè¯·æ±çé»è¾ï¼å¨æææ¹æ³éå¤ï¼\n * å®éæ¹æ³çå¥åçåæ°ç±»ååé¡ºåºï¼ä¸ä¸å®åæ¥å£è¦æ±ä¸è´ï¼å®¹æåºéï¼\n * ä»£ç å±é¢éå¯¹æ¯ä¸ä¸ªåæ°ç¡¬ç¼ç ï¼æ æ³æ¸æ°å°è¿è¡æ ¸å¯¹ï¼å¦æåæ°è¾¾å°å åä¸ªãä¸ç¾ä¸ªï¼åºéçæ¦çæå¤§ã\n\n# ä¼åçæ¬\n\néå¯¹ä¸é¢ä»£ç çæ¬ä¸­çé®é¢ï¼å¯ä»¥ä½¿ç¨ æ³¨è§£+åå°+ä»£çæ¨¡å¼ è§£å³éå¤ä»£ç ã\n\nãæ³¨è§£ä¸ã\n\nimport java.lang.annotation.*;\n\n@retention(retentionpolicy.runtime)\n@target(elementtype.type)\n@documented\n@inherited\npublic @interface bankapi {\n\n    string desc() default "";\n\n    string url() default "";\n\n}\n\n\nãæ³¨è§£äºã\n\nimport java.lang.annotation.*;\n\n@retention(retentionpolicy.runtime)\n@target(elementtype.field)\n@documented\n@inherited\npublic @interface bankapifield {\n\n    int order() default -1;\n\n    int length() default -1;\n\n    string type() default "";\n\n}\n\n\nãæ½è±¡ç±»ã\n\nabstract class abstractapi {}\n\n\nãä»£çç±»ã\n\n@slf4j\npublic class betterbankservice {\n\n    public static string createuser(string name, string identity, string mobile, int age) throws ioexception {\n        createuserapi createuserapi = new createuserapi();\n        createuserapi.setname(name);\n        createuserapi.setidentity(identity);\n        createuserapi.setage(age);\n        createuserapi.setmobile(mobile);\n        return remotecall(createuserapi);\n    }\n\n    public static string pay(long userid, bigdecimal amount) throws ioexception {\n        payapi payapi = new payapi();\n        payapi.setuserid(userid);\n        payapi.setamount(amount);\n        return remotecall(payapi);\n    }\n\n    private static string remotecall(abstractapi api) throws ioexception {\n        //ä»bankapiæ³¨è§£è·åè¯·æ±å°å\n        bankapi bankapi = api.getclass().getannotation(bankapi.class);\n        bankapi.url();\n        stringbuilder stringbuilder = new stringbuilder();\n        arrays.stream(api.getclass().getdeclaredfields()) //è·å¾ææå­æ®µ\n            .filter(field -> field.isannotationpresent(bankapifield.class)) //æ¥æ¾æ è®°äºæ³¨è§£çå­æ®µ\n            .sorted(comparator.comparingint(a -> a.getannotation(bankapifield.class).order())) //æ ¹æ®æ³¨è§£ä¸­çorderå¯¹å­æ®µæåº\n            .peek(field -> field.setaccessible(true)) //è®¾ç½®å¯ä»¥è®¿é®ç§æå­æ®µ\n            .foreach(field -> {\n                //è·å¾æ³¨è§£\n                bankapifield bankapifield = field.getannotation(bankapifield.class);\n                object value = "";\n                try {\n                    //åå°è·åå­æ®µå¼\n                    value = field.get(api);\n                } catch (illegalaccessexception e) {\n                    e.printstacktrace();\n                }\n                //æ ¹æ®å­æ®µç±»åä»¥æ­£ç¡®çå¡«åæ¹å¼æ ¼å¼åå­ç¬¦ä¸²\n                switch (bankapifield.type()) {\n                    case "s": {\n                        stringbuilder.append(\n                            string.format("%-" + bankapifield.length() + "s", value.tostring()).replace(\' \', \'_\'));\n                        break;\n                    }\n                    case "n": {\n                        stringbuilder.append(\n                            string.format("%" + bankapifield.length() + "s", value.tostring()).replace(\' \', \'0\'));\n                        break;\n                    }\n                    case "m": {\n                        if (!(value instanceof bigdecimal)) {\n                            throw new runtimeexception(\n                                string.format("{} ç {} å¿é¡»æ¯bigdecimal", api, field));\n                        }\n                        stringbuilder.append(string.format("%0" + bankapifield.length() + "d",\n                            ((bigdecimal) value).setscale(2, roundingmode.down)\n                                .multiply(new bigdecimal("100"))\n                                .longvalue()));\n                        break;\n                    }\n                    default:\n                        break;\n                }\n            });\n        //ç­¾åé»è¾\n        stringbuilder.append(digestutils.md2hex(stringbuilder.tostring()));\n        string param = stringbuilder.tostring();\n        long begin = system.currenttimemillis();\n        //åè¯·æ±\n        string result = request.post("http://localhost:45678/reflection" + bankapi.url())\n            .bodystring(param, contenttype.application_json)\n            .execute().returncontent().asstring();\n        log.info("è°ç¨é¶è¡api {} url:{} åæ°:{} èæ¶:{}ms", bankapi.desc(), bankapi.url(), param,\n            system.currenttimemillis() - begin);\n        return result;\n    }\n\n}\n\n\nãæ³¨è§£ä¿®é¥°ç api æ¥å£ä¸ã\n\nimport lombok.data;\n\n@bankapi(url = "/bank/createuser", desc = "åå»ºç¨æ·æ¥å£")\n@data\npublic class createuserapi extends abstractapi {\n\n    @bankapifield(order = 1, type = "s", length = 10)\n    private string name;\n    @bankapifield(order = 2, type = "s", length = 18)\n    private string identity;\n    @bankapifield(order = 4, type = "s", length = 11)\n    private string mobile;\n    @bankapifield(order = 3, type = "n", length = 5)\n    private int age;\n\n}\n\n\nãæ³¨è§£ä¿®é¥°ç api æ¥å£äºã\n\nimport lombok.data;\n\nimport java.math.bigdecimal;\n\n@bankapi(url = "/bank/pay", desc = "æ¯ä»æ¥å£")\n@data\npublic class payapi extends abstractapi {\n\n    @bankapifield(order = 1, type = "n", length = 20)\n    private long userid;\n    @bankapifield(order = 2, type = "m", length = 10)\n    private bigdecimal amount;\n\n}\n\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ééå¨æ¨¡å¼è½ä¸ºè¢«å°è£å¯¹è±¡æä¾ä¸åçæ¥å£ï¼ ä»£çæ¨¡å¼è½ä¸ºå¯¹è±¡æä¾ç¸åçæ¥å£ï¼ è£é¥°æ¨¡å¼åè½ä¸ºå¯¹è±¡æä¾å å¼ºçæ¥å£ã\n * å¤è§æ¨¡å¼ä¸ä»£ççç¸ä¼¼ä¹å¤å¨äºå®ä»¬é½ç¼å­äºä¸ä¸ªå¤æå®ä½å¹¶èªè¡å¯¹å¶è¿è¡åå§åã ä»£çä¸å¶æå¡å¯¹è±¡éµå¾ªåä¸æ¥å£ï¼ ä½¿å¾èªå·±åæå¡å¯¹è±¡å¯ä»¥äºæ¢ï¼ å¨è¿ä¸ç¹ä¸å®ä¸å¤è§ä¸åã\n * è£é¥°åä»£çæçç¸ä¼¼çç»æï¼ ä½æ¯å¶æå¾å´éå¸¸ä¸åã è¿ä¸¤ä¸ªæ¨¡å¼çæå»ºé½åºäºç»åååï¼ ä¹å°±æ¯è¯´ä¸ä¸ªå¯¹è±¡åºè¯¥å°é¨åå·¥ä½å§æ´¾ç»å¦ä¸ä¸ªå¯¹è±¡ã ä¸¤èä¹é´çä¸åä¹å¤å¨äºä»£çéå¸¸èªè¡ç®¡çå¶æå¡å¯¹è±¡ççå½å¨æï¼ èè£é¥°ççæåæ»æ¯ç±å®¢æ·ç«¯è¿è¡æ§å¶ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹æ¨¡æ¿æ¹æ³æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹æ¨¡æ¿æ¹æ³æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-06T09:43:00.000Z",permalink:"/pages/604ebc/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/14.%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/14.æ¨¡æ¿æ¹æ³æ¨¡å¼.md",key:"v-f82d5ee0",path:"/pages/604ebc/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:18},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:489},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:619},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:631},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:780},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1918},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3675},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:5510},{level:3,title:"6.1. æ¶é¤ if ... else åéå¤ä»£ç ",slug:"_6-1-æ¶é¤-if-else-åéå¤ä»£ç ",normalizedTitle:"6.1. æ¶é¤ if ... else åéå¤ä»£ç ",charIndex:5925},{level:4,title:"é®é¢ 1.0 çæ¬",slug:"é®é¢-1-0-çæ¬",normalizedTitle:"é®é¢ 1.0 çæ¬",charIndex:6093},{level:4,title:"ä¿®æ­£çæ¬",slug:"ä¿®æ­£çæ¬",normalizedTitle:"ä¿®æ­£çæ¬",charIndex:11575},{level:2,title:"7. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_7-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"7. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:14843},{level:2,title:"8. åèèµæ",slug:"_8-åèèµæ",normalizedTitle:"8. åèèµæ",charIndex:15042}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. æ¡ä¾ 6.1. æ¶é¤ if ... else åéå¤ä»£ç  é®é¢ 1.0 çæ¬ ä¿®æ­£çæ¬ 7. ä¸å¶ä»æ¨¡å¼çå³ç³» 8. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹æ¨¡æ¿æ¹æ³æ¨¡å¼\n\n\n# 1. æå¾\n\næ¨¡æ¿æ¹æ³æ¨¡å¼ (Template Method) æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®å¨è¶ç±»ä¸­å®ä¹äºä¸ä¸ªç®æ³çæ¡æ¶ï¼ åè®¸å­ç±»å¨ä¸ä¿®æ¹ç»æçæåµä¸éåç®æ³çç¹å®æ­¥éª¤ã\n\næ¨¡æ¿æ¹æ³æ¨¡å¼æ¯æææ¨¡å¼ä¸­æä¸ºå¸¸è§çå ä¸ªæ¨¡å¼ä¹ä¸ï¼æ¯åºäºç»§æ¿çä»£ç å¤ç¨çåºæ¬ææ¯ãï¼æ²¡æå³èå³ç³»ã å æ­¤ï¼å¨æ¨¡æ¿æ¹æ³æ¨¡å¼çç±»ç»æå¾ä¸­ï¼åªæç»§æ¿å³ç³»ã\n\næ¨¡æ¿æ¹æ³æ¨¡å¼éè¦å¼åæ½è±¡ç±»åå·ä½å­ç±»çè®¾è®¡å¸ä¹é´çåä½ãä¸ä¸ªè®¾è®¡å¸è´è´£ç»åºä¸ä¸ªç®æ³çè½®å»åéª¨æ¶ï¼å¦ä¸äºè®¾è®¡å¸åè´è´£ç»åºè¿ä¸ªç®æ³çåä¸ªé»è¾æ­¥éª¤ã\n\nä»£è¡¨è¿äºå·ä½é»è¾æ­¥éª¤çæ¹æ³ç§°ååºæ¬æ¹æ³(primitive method)ï¼èå°è¿äºåºæ¬æ¹æ³æ±æ»èµ·æ¥çæ¹æ³å«åæ¨¡æ¿æ¹æ³(template method)ï¼è¿ä¸ªè®¾è®¡æ¨¡å¼çåå­å°±æ¯ä»æ­¤èæ¥ã\n\nå¨æ¨¡æ¿æ¹æ³æ¨¡å¼ä¸­ï¼é¦åç¶ç±»ä¼å®ä¹ä¸ä¸ªç®æ³çæ¡æ¶ï¼å³å®ç°ç®æ³æå¿é¡»çæææ¹æ³ã\n\n * å¶ä¸­ï¼å·æå±æ§çä»£ç æ¾å¨ç¶ç±»çå·ä½æ¹æ³ä¸­ã\n\n * åä¸ªå­ç±»ç¹æ®æ§çä»£ç æ¾å¨å­ç±»çå·ä½æ¹æ³ä¸­ãä½æ¯ç¶ç±»ä¸­éè¦æå¯¹åºæ½è±¡æ¹æ³å£°æã\n\n * é©å­æ¹æ³å¯ä»¥è®©å­ç±»å³å®æ¯å¦å¯¹ç®æ³çä¸åç¹è¿è¡æé©ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ åªå¸æå®¢æ·ç«¯æ©å±æä¸ªç¹å®ç®æ³æ­¥éª¤ï¼ èä¸æ¯æ´ä¸ªç®æ³æå¶ç»ææ¶ï¼ å¯ä½¿ç¨æ¨¡æ¿æ¹æ³æ¨¡å¼ã\n * å½å¤ä¸ªç±»çç®æ³é¤ä¸äºç»å¾®ä¸åä¹å¤å ä¹å®å¨ä¸æ ·æ¶ï¼ ä½ å¯ä½¿ç¨è¯¥æ¨¡å¼ã ä½å¶åæå°±æ¯ï¼ åªè¦ç®æ³åçååï¼ ä½ å°±å¯è½éè¦ä¿®æ¹ææçç±»ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡ç±» ï¼AbstractÂ­Classï¼ ä¼å£°æä½ä¸ºç®æ³æ­¥éª¤çæ¹æ³ï¼ ä»¥åä¾æ¬¡è°ç¨å®ä»¬çå®éæ¨¡æ¿æ¹æ³ã ç®æ³æ­¥éª¤å¯ä»¥è¢«å£°æä¸º æ½è±¡ç±»åï¼ ä¹å¯ä»¥æä¾ä¸äºé»è®¤å®ç°ã\n 2. å·ä½ç±» ï¼ConcreteÂ­Classï¼ å¯ä»¥éåæææ­¥éª¤ï¼ ä½ä¸è½éåæ¨¡æ¿æ¹æ³èªèº«ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nAbstractClass : æ½è±¡ç±»ï¼å®ä¹å¹¶å®ç°ä¸ä¸ªæ¨¡æ¿æ¹æ³ãè¿ä¸ªæ¨¡æ¿æ¹æ³å®ä¹äºç®æ³çéª¨æ¶ï¼èé»è¾çç»ææ­¥éª¤å¨ç¸åºçæ½è±¡æä½ä¸­ï¼æ¨è¿å°å­ç±»å»å®ç°ãé¡¶çº§é»è¾ä¹æå¯è½è°ç¨ä¸äºå·ä½æ¹æ³ã\n\nabstract class AbstractClass {\n    public abstract void PrimitiveOperation1();\n    public abstract void PrimitiveOperation2();\n\n    public void TemplateMethod() {\n        PrimitiveOperation1();\n        PrimitiveOperation2();\n    }\n}\n\n\nConcreteClass : å®ç°å®ç°ç¶ç±»æå®ä¹çä¸ä¸ªæå¤ä¸ªæ½è±¡æ¹æ³ã\n\nclass ConcreteClassA extends AbstractClass {\n    @Override\n    public void PrimitiveOperation1() {\n        System.out.println("å·ä½Aç±»æ¹æ³1");\n    }\n\n    @Override\n    public void PrimitiveOperation2() {\n        System.out.println("å·ä½Aç±»æ¹æ³2");\n    }\n}\n\nclass ConcreteClassB extends AbstractClass {\n    @Override\n    public void PrimitiveOperation1() {\n        System.out.println("å·ä½Bç±»æ¹æ³1");\n    }\n\n    @Override\n    public void PrimitiveOperation2() {\n        System.out.println("å·ä½Bç±»æ¹æ³2");\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class TemplateMethodPattern {\n    public static void main(String[] args) {\n        AbstractClass objA = new ConcreteClassA();\n        AbstractClass objB = new ConcreteClassB();\n        objA.TemplateMethod();\n        objB.TemplateMethod();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾ä¸­çæ¨¡æ¿æ¹æ³æ¨¡å¼ä¸ºä¸æ¬¾ç®åç­ç¥æ¸¸æä¸­äººå·¥æºè½çä¸ååæ¯æä¾ âæ¡æ¶âã\n\n\n\nä¸æ¬¾ç®åæ¸¸æç AI ç±»ã\n\næ¸¸æä¸­ææçç§æé½æå ä¹åç±»çåä½åå»ºç­ã å æ­¤ä½ å¯ä»¥å¨ä¸åçç§æä¸å¤ç¨ç¸åç AI ç»æï¼ åæ¶è¿éè¦å·å¤éåä¸äºç»èçè½åã éè¿è¿ç§æ¹å¼ï¼ ä½ å¯ä»¥éååå½äººç AI ä½¿å¶æ´å¯æ»å»æ§ï¼ ä¹å¯ä»¥è®©äººç±»ä¾§éé²å®ï¼ è¿å¯ä»¥ç¦æ­¢æªç©å»ºé å»ºç­ã å¨æ¸¸æä¸­æ°å¢ç§æéè¦åå»ºæ°ç AI å­ç±»ï¼ è¿éè¦éå AI åºç±»ä¸­æå£°æçé»è®¤æ¹æ³ã\n\n// æ½è±¡ç±»å®ä¹äºä¸ä¸ªæ¨¡æ¿æ¹æ³ï¼å¶ä¸­éå¸¸ä¼åå«æä¸ªç±æ½è±¡åè¯­æä½è°ç¨ç»æçç®\n// æ³æ¡æ¶ãå·ä½å­ç±»ä¼å®ç°è¿äºæä½ï¼ä½æ¯ä¸ä¼å¯¹æ¨¡æ¿æ¹æ³ååºä¿®æ¹ã\nclass GameAI is\n    // æ¨¡æ¿æ¹æ³å®ä¹äºæä¸ªç®æ³çæ¡æ¶ã\n    method turn() is\n        collectResources()\n        buildStructures()\n        buildUnits()\n        attack()\n\n    // æäºæ­¥éª¤å¯å¨åºç±»ä¸­ç´æ¥å®ç°ã\n    method collectResources() is\n        foreach (s in this.builtStructures) do\n            s.collect()\n\n    // æäºå¯å®ä¹ä¸ºæ½è±¡ç±»åã\n    abstract method buildStructures()\n    abstract method buildUnits()\n\n    // ä¸ä¸ªç±»å¯åå«å¤ä¸ªæ¨¡æ¿æ¹æ³ã\n    method attack() is\n        enemy = closestEnemy()\n        if (enemy == null)\n            sendScouts(map.center)\n        else\n            sendWarriors(enemy.position)\n\n    abstract method sendScouts(position)\n    abstract method sendWarriors(position)\n\n// å·ä½ç±»å¿é¡»å®ç°åºç±»ä¸­çæææ½è±¡æä½ï¼ä½æ¯å®ä»¬ä¸è½éåæ¨¡æ¿æ¹æ³èªèº«ã\nclass OrcsAI extends GameAI is\n    method buildStructures() is\n        if (there are some resources) then\n            // å»ºé ååºï¼æ¥çæ¯è°·ä»ï¼ç¶åæ¯è¦å¡ã\n\n    method buildUnits() is\n        if (there are plenty of resources) then\n            if (there are no scouts)\n                // å»ºé è¦å·¥ï¼å°å¶å å¥ä¾¦æ¥ç¼ç»ã\n            else\n                // å»ºé å½ææ­¥åµï¼å°å¶å å¥æå£«ç¼ç»ã\n\n    // ...\n\n    method sendScouts(position) is\n        if (scouts.length > 0) then\n            // å°ä¾¦æ¥ç¼ç»éå°æå®ä½ç½®ã\n\n    method sendWarriors(position) is\n        if (warriors.length > 5) then\n            // å°ææç¼ç»éå°æå®ä½ç½®ã\n\n// å­ç±»å¯ä»¥éåé¨åé»è®¤çæä½ã\nclass MonstersAI extends GameAI is\n    method collectResources() is\n        // æªç©ä¸ä¼ééèµæºã\n\n    method buildStructures() is\n        // æªç©ä¸ä¼å»ºé å»ºç­ã\n\n    method buildUnits() is\n        // æªç©ä¸ä¼å»ºé åä½ã\n\n\n\n# 5. æ¡ä¾\n\næ¨¡æ¿æ¹æ³æ¨¡å¼åºç¨åºæ¯ååå¹¿æ³ã\n\nå¨ãHead Firstãçæ¨¡æ¿æ¹æ³æ¨¡å¼ç« èéåä¸¾äºä¸ä¸ªååå·æä»£è¡¨æ§çä¾å­ã\n\nç°å®çæ´»ä¸­ï¼è¶ååå¡æ¯éå¤å¯è§çé¥®æãå²æ³¡ä¸æ¯è¶æå²æ³¡ä¸æ¯åå¡çè¿ç¨æ¯ææ ·çï¼\n\næä»¬æ¥æ´çä¸ä¸æµç¨ã\n\n * æ³¡è¶ï¼ ç§å¼æ°´ ==> å²æ³¡è¶å¶ ==> åå¥æ¯ä¸­ ==> æ·»å æ æª¬\n * æ³¡åå¡ï¼ ç§å¼æ°´ ==> å²æ³¡åå¡ ==> åå¥æ¯ä¸­ ==> æ·»å ç³åçå¥¶\n\nç±ä»¥ä¸å¤çæ­¥éª¤ä¸é¾åç°ï¼åå¤è¿ä¸¤ç§é¥®æçå¤çè¿ç¨éå¸¸ç¸ä¼¼ãæä»¬å¯ä»¥ä½¿ç¨æ¨¡æ¿ç±»æ¹æ³å»éå®å¶ä½é¥®æçç®æ³æ¡æ¶ã\n\nå¶ä¸­ç¸åçå·æå±æ§çæ­¥éª¤ï¼å¦ç§å¼æ°´ãåå¥æ¯ä¸­ï¼ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­ç»åºå·ä½å®ç°ã\n\nèå¯¹äºæå·®å¼æ§çæ­¥éª¤ï¼åå¨åèªçå·ä½ç±»ä¸­ç»åºå®ç°ã\n\nãæ½è±¡ç±»ã\n\nabstract class Beverage {\n\n    // æ¨¡æ¿æ¹æ³ï¼å³å®äºç®æ³éª¨æ¶ãç¸å½äºTemplateMethod()æ¹æ³\n    public void prepareBeverage() {\n        boilWater();\n        brew();\n        pourInCup();\n        if (customWantsCondiments())\n        {\n            addCondiments();\n        }\n    }\n\n    // å±æ§æä½ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­å®ä¹\n    public void boilWater() {\n        System.out.println("ç§å¼æ°´");\n    }\n\n    // å±æ§æä½ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­å®ä¹\n    public void pourInCup() {\n        System.out.println("åå¥æ¯ä¸­");\n    }\n\n    // é©å­æ¹æ³ï¼å³å®æäºç®æ³æ­¥éª¤æ¯å¦æé©å¨ç®æ³ä¸­\n    public boolean customWantsCondiments() {\n        return true;\n    }\n\n    // ç¹æ®æä½ï¼å¨å­ç±»ä¸­å·ä½å®ç°\n    public abstract void brew();\n\n    // ç¹æ®æä½ï¼å¨å­ç±»ä¸­å·ä½å®ç°\n    public abstract void addCondiments();\n\n}\n\n\nãå·ä½ç±»ã\n\nclass Tea extends Beverage {\n\n    @Override\n    public void brew() {\n        System.out.println("å²æ³¡è¶å¶");\n    }\n\n    @Override\n    public void addCondiments() {\n        System.out.println("æ·»å æ æª¬");\n    }\n\n}\n\nclass Coffee extends Beverage {\n\n    @Override\n    public void brew() {\n        System.out.println("å²æ³¡åå¡è±");\n    }\n\n    @Override\n    public void addCondiments() {\n        System.out.println("æ·»å ç³åçå¥¶");\n    }\n\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic static void main(String[] args) {\n\n    System.out.println("============= åå¤è¶ =============");\n    Beverage tea = new Tea();\n    tea.prepareBeverage();\n\n    System.out.println("============= åå¤åå¡ =============");\n    Beverage coffee = new Coffee();\n    coffee.prepareBeverage();\n\n}\n\n\nè¾åº\n\n============= åå¤è¶ =============\nç§å¼æ°´\nå²æ³¡è¶å¶\nåå¥æ¯ä¸­\næ·»å æ æª¬\n============= åå¤åå¡ =============\nç§å¼æ°´\nå²æ³¡åå¡è±\nåå¥æ¯ä¸­\næ·»å ç³åçå¥¶\n\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ æ¨¡çæ¹æ³æ¨¡å¼å¨ Java æ¡æ¶ä¸­å¾å¸¸è§ã å¼åèéå¸¸ä½¿ç¨å®æ¥åæ¡æ¶ç¨æ·æä¾éè¿ç»§æ¿å®ç°çã å¯¹æ ååè½è¿è¡æ©å±çç®åæ¹å¼ã\n\nè¿éæ¯ä¸äºæ ¸å¿ Java ç¨åºåºä¸­æ¨¡çæ¹æ³çç¤ºä¾ï¼\n\n * java.io.InputStreamã java.io.OutputStreamã java.io.Reader å java.io.Writer çææéæ½è±¡æ¹æ³ã\n * java.util.AbstractListã java.util.AbstractSet å java.util.AbstractMap çææéæ½è±¡æ¹æ³ã\n * javax.servlet.http.HttpServletï¼ ææé»è®¤åé HTTP 405 âæ¹æ³ä¸åè®¸â éè¯¯ååºç doÂ­XXX()æ¹æ³ã ä½ å¯éæ¶å¯¹å¶è¿è¡éåã\n\nè¯å«æ¹æ³ï¼ æ¨¡çæ¹æ³å¯ä»¥éè¿è¡ä¸ºæ¹æ³æ¥è¯å«ï¼ è¯¥æ¹æ³å·²æä¸ä¸ªå¨åºç±»ä¸­å®ä¹ç âé»è®¤â è¡ä¸ºã\n\n\n# 6.1. æ¶é¤ if ... else åéå¤ä»£ç \n\nåè®¾è¦å¼åä¸ä¸ªè´­ç©è½¦åè½ï¼éå¯¹ä¸åç¨æ·è¿è¡ä¸åçå¤çï¼\n\n * æ®éç¨æ·éè¦æ¶åè¿è´¹ï¼è¿è´¹æ¯ååä»·æ ¼ç 10%ï¼æ ååææ£ï¼\n * VIP ç¨æ·åæ ·éè¦æ¶åååä»·æ ¼ 10% çå¿«éè´¹ï¼ä½è´­ä¹°ä¸¤ä»¶ä»¥ä¸ç¸åååæ¶ï¼ç¬¬ä¸ä»¶å¼å§äº«åä¸å®ææ£ï¼\n * åé¨ç¨æ·å¯ä»¥åè¿è´¹ï¼æ ååææ£ã\n\n# é®é¢ 1.0 çæ¬\n\næ®éç¨æ·è´­ç©è½¦\n\npublic class NormalUserCart {\n\n    public Cart process(long userId, Map<Long, Integer> items) {\n        Cart cart = new Cart();\n\n        //æMapçè´­ç©è½¦è½¬æ¢ä¸ºItemåè¡¨\n        List<Item> itemList = new ArrayList<>();\n        items.entrySet().stream().forEach(entry -> {\n            Item item = new Item();\n            item.setId(entry.getKey());\n            item.setPrice(Db.getItemPrice(entry.getKey()));\n            item.setQuantity(entry.getValue());\n            itemList.add(item);\n        });\n        cart.setItems(itemList);\n\n        //å¤çè¿è´¹åååä¼æ \n        itemList.stream().forEach(item -> {\n            //è¿è´¹ä¸ºååæ»ä»·ç10%\n            item.setDeliveryPrice(\n                item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())).multiply(new BigDecimal("0.1")));\n            //æ ä¼æ \n            item.setCouponPrice(BigDecimal.ZERO);\n        });\n\n        //è®¡ç®çº¯ååæ»ä»·\n        cart.setTotalItemPrice(cart.getItems()\n            .stream()\n            .map(item -> item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add));\n        //è®¡ç®è¿è´¹æ»ä»·\n        cart.setTotalDeliveryPrice(\n            cart.getItems().stream().map(Item::getDeliveryPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        //è®¡ç®æ»ä¼æ \n        cart.setTotalDiscount(\n            cart.getItems().stream().map(Item::getCouponPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        //åºä»æ»ä»·=ååæ»ä»·+è¿è´¹æ»ä»·-æ»ä¼æ \n        cart.setPayPrice(cart.getTotalItemPrice().add(cart.getTotalDeliveryPrice()).subtract(cart.getTotalDiscount()));\n        return cart;\n    }\n\n}\n\n\nVIP ç¨æ·è´­ç©è½¦\n\npublic class VipUserCart {\n\n    public Cart process(long userId, Map<Long, Integer> items) {\n        Cart cart = new Cart();\n\n        List<Item> itemList = new ArrayList<>();\n        items.entrySet().stream().forEach(entry -> {\n            Item item = new Item();\n            item.setId(entry.getKey());\n            item.setPrice(Db.getItemPrice(entry.getKey()));\n            item.setQuantity(entry.getValue());\n            itemList.add(item);\n        });\n        cart.setItems(itemList);\n\n        itemList.stream().forEach(item -> {\n            //è¿è´¹ä¸ºååæ»ä»·ç10%\n            item.setDeliveryPrice(\n                item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())).multiply(new BigDecimal("0.1")));\n            //è´­ä¹°ä¸¤ä»¶ä»¥ä¸ç¸åååï¼ç¬¬ä¸ä»¶å¼å§äº«åä¸å®ææ£\n            if (item.getQuantity() > 2) {\n                item.setCouponPrice(item.getPrice()\n                    .multiply(BigDecimal.valueOf(100 - Db.getUserCouponPercent(userId)).divide(new BigDecimal("100")))\n                    .multiply(BigDecimal.valueOf(item.getQuantity() - 2)));\n            } else {\n                item.setCouponPrice(BigDecimal.ZERO);\n            }\n        });\n\n        cart.setTotalItemPrice(cart.getItems()\n            .stream()\n            .map(item -> item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDeliveryPrice(\n            cart.getItems().stream().map(Item::getDeliveryPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDiscount(\n            cart.getItems().stream().map(Item::getCouponPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setPayPrice(cart.getTotalItemPrice().add(cart.getTotalDeliveryPrice()).subtract(cart.getTotalDiscount()));\n        return cart;\n    }\n\n}\n\n\nåé¨ç¨æ·è´­ç©è½¦\n\npublic class InternalUserCart {\n\n    public Cart process(long userId, Map<Long, Integer> items) {\n        Cart cart = new Cart();\n\n        List<Item> itemList = new ArrayList<>();\n        items.entrySet().stream().forEach(entry -> {\n            Item item = new Item();\n            item.setId(entry.getKey());\n            item.setPrice(Db.getItemPrice(entry.getKey()));\n            item.setQuantity(entry.getValue());\n            itemList.add(item);\n        });\n        cart.setItems(itemList);\n\n        itemList.stream().forEach(item -> {\n            //åè¿è´¹\n            item.setDeliveryPrice(BigDecimal.ZERO);\n            //æ ä¼æ \n            item.setCouponPrice(BigDecimal.ZERO);\n        });\n\n        cart.setTotalItemPrice(cart.getItems()\n            .stream()\n            .map(item -> item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDeliveryPrice(\n            cart.getItems().stream().map(Item::getDeliveryPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDiscount(\n            cart.getItems().stream().map(Item::getCouponPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setPayPrice(cart.getTotalItemPrice().add(cart.getTotalDeliveryPrice()).subtract(cart.getTotalDiscount()));\n        return cart;\n    }\n\n}\n\n\nå®¢æ·ç«¯\n\n@GetMapping("wrong")\npublic Cart wrong(@RequestParam("userId") int userId) {\n    String userCategory = Db.getUserCategory(userId);\n\n    if (userCategory.equals("Normal")) {\n        NormalUserCart normalUserCart = new NormalUserCart();\n        return normalUserCart.process(userId, items);\n    }\n\n    if (userCategory.equals("Vip")) {\n        VipUserCart vipUserCart = new VipUserCart();\n        return vipUserCart.process(userId, items);\n    }\n\n    if (userCategory.equals("Internal")) {\n        InternalUserCart internalUserCart = new InternalUserCart();\n        return internalUserCart.process(userId, items);\n    }\n\n    return null;\n}\n\n\n> å¯¹æ¯ä¸ä¸ä»£ç éå¯ä»¥åç°ï¼ä¸ç§è´­ç©è½¦ 70% çä»£ç æ¯éå¤çãåå å¾ç®åï¼è½ç¶ä¸åç±»åç¨æ·è®¡ç®è¿è´¹åä¼æ çæ¹å¼ä¸åï¼ä½æ´ä¸ªè´­ç©è½¦çåå§åãç»è®¡æ»ä»·ãæ»è¿è´¹ãæ»ä¼æ åæ¯ä»ä»·æ ¼çé»è¾é½æ¯ä¸æ ·çã\n\n# ä¿®æ­£çæ¬\n\n1.0 çæ¬çé®é¢å¨äºï¼ç¸åçä»£ç åºè¯¥åªå¨ä¸å¤åºç°ã\n\nå¦ææä»¬çè®°æ½è±¡ç±»åæ½è±¡æ¹æ³çå®ä¹çè¯ï¼è¿æ¶æè®¸å°±ä¼æ³å°ï¼æ¯å¦å¯ä»¥æéå¤çé»è¾å®ä¹å¨æ½è±¡ç±»ä¸­ï¼ä¸ä¸ªè´­ç©è½¦åªè¦åå«å®ç°ä¸åçé£ä»½é»è¾å¢ï¼\n\nå¶å®ï¼è¿ä¸ªæ¨¡å¼å°±æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼ã\n\n> ä¸é¢å±ç¤ºåºäº å·¥åæ¨¡å¼+æ¨¡æ¿æ¹æ³æ¨¡å¼ ä¼åéå¤ä»£ç ã\n\nãæ½è±¡ç±»ã\n\npublic abstract class AbstractCart {\n\n    public Cart process(long userId, Map<Long, Integer> items) {\n\n        Cart cart = new Cart();\n\n        List<Item> itemList = new ArrayList<>();\n        items.entrySet().stream().forEach(entry -> {\n            Item item = new Item();\n            item.setId(entry.getKey());\n            item.setPrice(Db.getItemPrice(entry.getKey()));\n            item.setQuantity(entry.getValue());\n            itemList.add(item);\n        });\n        cart.setItems(itemList);\n\n        itemList.stream().forEach(item -> {\n            processCouponPrice(userId, item);\n            processDeliveryPrice(userId, item);\n        });\n\n        cart.setTotalItemPrice(cart.getItems()\n            .stream()\n            .map(item -> item.getPrice().multiply(BigDecimal.valueOf(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDeliveryPrice(\n            cart.getItems().stream().map(Item::getDeliveryPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setTotalDiscount(\n            cart.getItems().stream().map(Item::getCouponPrice).reduce(BigDecimal.ZERO, BigDecimal::add));\n        cart.setPayPrice(cart.getTotalItemPrice().add(cart.getTotalDeliveryPrice()).subtract(cart.getTotalDiscount()));\n        return cart;\n    }\n\n    protected abstract void processCouponPrice(long userId, Item item);\n\n    protected abstract void processDeliveryPrice(long userId, Item item);\n\n}\n\n\nãæ®éç¨æ·è´­ç©è½¦ã\n\n@Service(value = "NormalUserCart")\npublic class NormalUserCart extends AbstractCart {\n\n    @Override\n    protected void processCouponPrice(long userId, Item item) {\n        item.setCouponPrice(BigDecimal.ZERO);\n    }\n\n    @Override\n    protected void processDeliveryPrice(long userId, Item item) {\n        item.setDeliveryPrice(item.getPrice()\n            .multiply(BigDecimal.valueOf(item.getQuantity()))\n            .multiply(new BigDecimal("0.1")));\n    }\n\n}\n\n\nãVIP ç¨æ·è´­ç©è½¦ã\n\n@Service(value = "VipUserCart")\npublic class VipUserCart extends NormalUserCart {\n\n    @Override\n    protected void processCouponPrice(long userId, Item item) {\n        if (item.getQuantity() > 2) {\n            item.setCouponPrice(item.getPrice()\n                .multiply(BigDecimal.valueOf(100 - Db.getUserCouponPercent(userId)).divide(new BigDecimal("100")))\n                .multiply(BigDecimal.valueOf(item.getQuantity() - 2)));\n        } else {\n            item.setCouponPrice(BigDecimal.ZERO);\n        }\n    }\n\n}\n\n\nãåé¨ç¨æ·è´­ç©è½¦ã\n\n@Service(value = "InternalUserCart")\npublic class InternalUserCart extends AbstractCart {\n\n    @Override\n    protected void processCouponPrice(long userId, Item item) {\n        item.setCouponPrice(BigDecimal.ZERO);\n    }\n\n    @Override\n    protected void processDeliveryPrice(long userId, Item item) {\n        item.setDeliveryPrice(BigDecimal.ZERO);\n    }\n\n}\n\n\nãå®¢æ·ç«¯ã\n\n@GetMapping("right")\npublic Cart right(@RequestParam("userId") int userId) {\n    String userCategory = Db.getUserCategory(userId);\n    AbstractCart cart = (AbstractCart) applicationContext.getBean(userCategory + "UserCart");\n    return cart.process(userId, items);\n}\n\n\n\n# 7. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å·¥åæ¹æ³æ¨¡å¼æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼çä¸ç§ç¹æ®å½¢å¼ã åæ¶ï¼ å·¥åæ¹æ³å¯ä»¥ä½ä¸ºä¸ä¸ªå¤§åæ¨¡æ¿æ¹æ³ä¸­çä¸ä¸ªæ­¥éª¤ã\n * æ¨¡æ¿æ¹æ³åºäºç»§æ¿æºå¶ï¼ å®åè®¸ä½ éè¿æ©å±å­ç±»ä¸­çé¨ååå®¹æ¥æ¹åé¨åç®æ³ã ç­ç¥æ¨¡å¼åºäºç»åæºå¶ï¼ ä½ å¯ä»¥éè¿å¯¹ç¸åºè¡ä¸ºæä¾ä¸åçç­ç¥æ¥æ¹åå¯¹è±¡çé¨åè¡ä¸ºã æ¨¡æ¿æ¹æ³å¨ç±»å±æ¬¡ä¸è¿ä½ï¼ å æ­¤å®æ¯éæçã ç­ç¥å¨å¯¹è±¡å±æ¬¡ä¸è¿ä½ï¼ å æ­¤åè®¸å¨è¿è¡æ¶åæ¢è¡ä¸ºã\n\n\n# 8. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹æ¨¡æ¿æ¹æ³æ¨¡å¼\n\n\n# 1. æå¾\n\næ¨¡æ¿æ¹æ³æ¨¡å¼ (template method) æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®å¨è¶ç±»ä¸­å®ä¹äºä¸ä¸ªç®æ³çæ¡æ¶ï¼ åè®¸å­ç±»å¨ä¸ä¿®æ¹ç»æçæåµä¸éåç®æ³çç¹å®æ­¥éª¤ã\n\næ¨¡æ¿æ¹æ³æ¨¡å¼æ¯æææ¨¡å¼ä¸­æä¸ºå¸¸è§çå ä¸ªæ¨¡å¼ä¹ä¸ï¼æ¯åºäºç»§æ¿çä»£ç å¤ç¨çåºæ¬ææ¯ãï¼æ²¡æå³èå³ç³»ã å æ­¤ï¼å¨æ¨¡æ¿æ¹æ³æ¨¡å¼çç±»ç»æå¾ä¸­ï¼åªæç»§æ¿å³ç³»ã\n\næ¨¡æ¿æ¹æ³æ¨¡å¼éè¦å¼åæ½è±¡ç±»åå·ä½å­ç±»çè®¾è®¡å¸ä¹é´çåä½ãä¸ä¸ªè®¾è®¡å¸è´è´£ç»åºä¸ä¸ªç®æ³çè½®å»åéª¨æ¶ï¼å¦ä¸äºè®¾è®¡å¸åè´è´£ç»åºè¿ä¸ªç®æ³çåä¸ªé»è¾æ­¥éª¤ã\n\nä»£è¡¨è¿äºå·ä½é»è¾æ­¥éª¤çæ¹æ³ç§°ååºæ¬æ¹æ³(primitive method)ï¼èå°è¿äºåºæ¬æ¹æ³æ±æ»èµ·æ¥çæ¹æ³å«åæ¨¡æ¿æ¹æ³(template method)ï¼è¿ä¸ªè®¾è®¡æ¨¡å¼çåå­å°±æ¯ä»æ­¤èæ¥ã\n\nå¨æ¨¡æ¿æ¹æ³æ¨¡å¼ä¸­ï¼é¦åç¶ç±»ä¼å®ä¹ä¸ä¸ªç®æ³çæ¡æ¶ï¼å³å®ç°ç®æ³æå¿é¡»çæææ¹æ³ã\n\n * å¶ä¸­ï¼å·æå±æ§çä»£ç æ¾å¨ç¶ç±»çå·ä½æ¹æ³ä¸­ã\n\n * åä¸ªå­ç±»ç¹æ®æ§çä»£ç æ¾å¨å­ç±»çå·ä½æ¹æ³ä¸­ãä½æ¯ç¶ç±»ä¸­éè¦æå¯¹åºæ½è±¡æ¹æ³å£°æã\n\n * é©å­æ¹æ³å¯ä»¥è®©å­ç±»å³å®æ¯å¦å¯¹ç®æ³çä¸åç¹è¿è¡æé©ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ åªå¸æå®¢æ·ç«¯æ©å±æä¸ªç¹å®ç®æ³æ­¥éª¤ï¼ èä¸æ¯æ´ä¸ªç®æ³æå¶ç»ææ¶ï¼ å¯ä½¿ç¨æ¨¡æ¿æ¹æ³æ¨¡å¼ã\n * å½å¤ä¸ªç±»çç®æ³é¤ä¸äºç»å¾®ä¸åä¹å¤å ä¹å®å¨ä¸æ ·æ¶ï¼ ä½ å¯ä½¿ç¨è¯¥æ¨¡å¼ã ä½å¶åæå°±æ¯ï¼ åªè¦ç®æ³åçååï¼ ä½ å°±å¯è½éè¦ä¿®æ¹ææçç±»ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. æ½è±¡ç±» ï¼abstractÂ­classï¼ ä¼å£°æä½ä¸ºç®æ³æ­¥éª¤çæ¹æ³ï¼ ä»¥åä¾æ¬¡è°ç¨å®ä»¬çå®éæ¨¡æ¿æ¹æ³ã ç®æ³æ­¥éª¤å¯ä»¥è¢«å£°æä¸º æ½è±¡ç±»åï¼ ä¹å¯ä»¥æä¾ä¸äºé»è®¤å®ç°ã\n 2. å·ä½ç±» ï¼concreteÂ­classï¼ å¯ä»¥éåæææ­¥éª¤ï¼ ä½ä¸è½éåæ¨¡æ¿æ¹æ³èªèº«ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nabstractclass : æ½è±¡ç±»ï¼å®ä¹å¹¶å®ç°ä¸ä¸ªæ¨¡æ¿æ¹æ³ãè¿ä¸ªæ¨¡æ¿æ¹æ³å®ä¹äºç®æ³çéª¨æ¶ï¼èé»è¾çç»ææ­¥éª¤å¨ç¸åºçæ½è±¡æä½ä¸­ï¼æ¨è¿å°å­ç±»å»å®ç°ãé¡¶çº§é»è¾ä¹æå¯è½è°ç¨ä¸äºå·ä½æ¹æ³ã\n\nabstract class abstractclass {\n    public abstract void primitiveoperation1();\n    public abstract void primitiveoperation2();\n\n    public void templatemethod() {\n        primitiveoperation1();\n        primitiveoperation2();\n    }\n}\n\n\nconcreteclass : å®ç°å®ç°ç¶ç±»æå®ä¹çä¸ä¸ªæå¤ä¸ªæ½è±¡æ¹æ³ã\n\nclass concreteclassa extends abstractclass {\n    @override\n    public void primitiveoperation1() {\n        system.out.println("å·ä½aç±»æ¹æ³1");\n    }\n\n    @override\n    public void primitiveoperation2() {\n        system.out.println("å·ä½aç±»æ¹æ³2");\n    }\n}\n\nclass concreteclassb extends abstractclass {\n    @override\n    public void primitiveoperation1() {\n        system.out.println("å·ä½bç±»æ¹æ³1");\n    }\n\n    @override\n    public void primitiveoperation2() {\n        system.out.println("å·ä½bç±»æ¹æ³2");\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class templatemethodpattern {\n    public static void main(string[] args) {\n        abstractclass obja = new concreteclassa();\n        abstractclass objb = new concreteclassb();\n        obja.templatemethod();\n        objb.templatemethod();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾ä¸­çæ¨¡æ¿æ¹æ³æ¨¡å¼ä¸ºä¸æ¬¾ç®åç­ç¥æ¸¸æä¸­äººå·¥æºè½çä¸ååæ¯æä¾ âæ¡æ¶âã\n\n\n\nä¸æ¬¾ç®åæ¸¸æç ai ç±»ã\n\næ¸¸æä¸­ææçç§æé½æå ä¹åç±»çåä½åå»ºç­ã å æ­¤ä½ å¯ä»¥å¨ä¸åçç§æä¸å¤ç¨ç¸åç ai ç»æï¼ åæ¶è¿éè¦å·å¤éåä¸äºç»èçè½åã éè¿è¿ç§æ¹å¼ï¼ ä½ å¯ä»¥éååå½äººç ai ä½¿å¶æ´å¯æ»å»æ§ï¼ ä¹å¯ä»¥è®©äººç±»ä¾§éé²å®ï¼ è¿å¯ä»¥ç¦æ­¢æªç©å»ºé å»ºç­ã å¨æ¸¸æä¸­æ°å¢ç§æéè¦åå»ºæ°ç ai å­ç±»ï¼ è¿éè¦éå ai åºç±»ä¸­æå£°æçé»è®¤æ¹æ³ã\n\n// æ½è±¡ç±»å®ä¹äºä¸ä¸ªæ¨¡æ¿æ¹æ³ï¼å¶ä¸­éå¸¸ä¼åå«æä¸ªç±æ½è±¡åè¯­æä½è°ç¨ç»æçç®\n// æ³æ¡æ¶ãå·ä½å­ç±»ä¼å®ç°è¿äºæä½ï¼ä½æ¯ä¸ä¼å¯¹æ¨¡æ¿æ¹æ³ååºä¿®æ¹ã\nclass gameai is\n    // æ¨¡æ¿æ¹æ³å®ä¹äºæä¸ªç®æ³çæ¡æ¶ã\n    method turn() is\n        collectresources()\n        buildstructures()\n        buildunits()\n        attack()\n\n    // æäºæ­¥éª¤å¯å¨åºç±»ä¸­ç´æ¥å®ç°ã\n    method collectresources() is\n        foreach (s in this.builtstructures) do\n            s.collect()\n\n    // æäºå¯å®ä¹ä¸ºæ½è±¡ç±»åã\n    abstract method buildstructures()\n    abstract method buildunits()\n\n    // ä¸ä¸ªç±»å¯åå«å¤ä¸ªæ¨¡æ¿æ¹æ³ã\n    method attack() is\n        enemy = closestenemy()\n        if (enemy == null)\n            sendscouts(map.center)\n        else\n            sendwarriors(enemy.position)\n\n    abstract method sendscouts(position)\n    abstract method sendwarriors(position)\n\n// å·ä½ç±»å¿é¡»å®ç°åºç±»ä¸­çæææ½è±¡æä½ï¼ä½æ¯å®ä»¬ä¸è½éåæ¨¡æ¿æ¹æ³èªèº«ã\nclass orcsai extends gameai is\n    method buildstructures() is\n        if (there are some resources) then\n            // å»ºé ååºï¼æ¥çæ¯è°·ä»ï¼ç¶åæ¯è¦å¡ã\n\n    method buildunits() is\n        if (there are plenty of resources) then\n            if (there are no scouts)\n                // å»ºé è¦å·¥ï¼å°å¶å å¥ä¾¦æ¥ç¼ç»ã\n            else\n                // å»ºé å½ææ­¥åµï¼å°å¶å å¥æå£«ç¼ç»ã\n\n    // ...\n\n    method sendscouts(position) is\n        if (scouts.length > 0) then\n            // å°ä¾¦æ¥ç¼ç»éå°æå®ä½ç½®ã\n\n    method sendwarriors(position) is\n        if (warriors.length > 5) then\n            // å°ææç¼ç»éå°æå®ä½ç½®ã\n\n// å­ç±»å¯ä»¥éåé¨åé»è®¤çæä½ã\nclass monstersai extends gameai is\n    method collectresources() is\n        // æªç©ä¸ä¼ééèµæºã\n\n    method buildstructures() is\n        // æªç©ä¸ä¼å»ºé å»ºç­ã\n\n    method buildunits() is\n        // æªç©ä¸ä¼å»ºé åä½ã\n\n\n\n# 5. æ¡ä¾\n\næ¨¡æ¿æ¹æ³æ¨¡å¼åºç¨åºæ¯ååå¹¿æ³ã\n\nå¨ãhead firstãçæ¨¡æ¿æ¹æ³æ¨¡å¼ç« èéåä¸¾äºä¸ä¸ªååå·æä»£è¡¨æ§çä¾å­ã\n\nç°å®çæ´»ä¸­ï¼è¶ååå¡æ¯éå¤å¯è§çé¥®æãå²æ³¡ä¸æ¯è¶æå²æ³¡ä¸æ¯åå¡çè¿ç¨æ¯ææ ·çï¼\n\næä»¬æ¥æ´çä¸ä¸æµç¨ã\n\n * æ³¡è¶ï¼ ç§å¼æ°´ ==> å²æ³¡è¶å¶ ==> åå¥æ¯ä¸­ ==> æ·»å æ æª¬\n * æ³¡åå¡ï¼ ç§å¼æ°´ ==> å²æ³¡åå¡ ==> åå¥æ¯ä¸­ ==> æ·»å ç³åçå¥¶\n\nç±ä»¥ä¸å¤çæ­¥éª¤ä¸é¾åç°ï¼åå¤è¿ä¸¤ç§é¥®æçå¤çè¿ç¨éå¸¸ç¸ä¼¼ãæä»¬å¯ä»¥ä½¿ç¨æ¨¡æ¿ç±»æ¹æ³å»éå®å¶ä½é¥®æçç®æ³æ¡æ¶ã\n\nå¶ä¸­ç¸åçå·æå±æ§çæ­¥éª¤ï¼å¦ç§å¼æ°´ãåå¥æ¯ä¸­ï¼ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­ç»åºå·ä½å®ç°ã\n\nèå¯¹äºæå·®å¼æ§çæ­¥éª¤ï¼åå¨åèªçå·ä½ç±»ä¸­ç»åºå®ç°ã\n\nãæ½è±¡ç±»ã\n\nabstract class beverage {\n\n    // æ¨¡æ¿æ¹æ³ï¼å³å®äºç®æ³éª¨æ¶ãç¸å½äºtemplatemethod()æ¹æ³\n    public void preparebeverage() {\n        boilwater();\n        brew();\n        pourincup();\n        if (customwantscondiments())\n        {\n            addcondiments();\n        }\n    }\n\n    // å±æ§æä½ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­å®ä¹\n    public void boilwater() {\n        system.out.println("ç§å¼æ°´");\n    }\n\n    // å±æ§æä½ï¼ç´æ¥å¨æ½è±¡ç±»ä¸­å®ä¹\n    public void pourincup() {\n        system.out.println("åå¥æ¯ä¸­");\n    }\n\n    // é©å­æ¹æ³ï¼å³å®æäºç®æ³æ­¥éª¤æ¯å¦æé©å¨ç®æ³ä¸­\n    public boolean customwantscondiments() {\n        return true;\n    }\n\n    // ç¹æ®æä½ï¼å¨å­ç±»ä¸­å·ä½å®ç°\n    public abstract void brew();\n\n    // ç¹æ®æä½ï¼å¨å­ç±»ä¸­å·ä½å®ç°\n    public abstract void addcondiments();\n\n}\n\n\nãå·ä½ç±»ã\n\nclass tea extends beverage {\n\n    @override\n    public void brew() {\n        system.out.println("å²æ³¡è¶å¶");\n    }\n\n    @override\n    public void addcondiments() {\n        system.out.println("æ·»å æ æª¬");\n    }\n\n}\n\nclass coffee extends beverage {\n\n    @override\n    public void brew() {\n        system.out.println("å²æ³¡åå¡è±");\n    }\n\n    @override\n    public void addcondiments() {\n        system.out.println("æ·»å ç³åçå¥¶");\n    }\n\n}\n\n\nãå®¢æ·ç«¯ã\n\npublic static void main(string[] args) {\n\n    system.out.println("============= åå¤è¶ =============");\n    beverage tea = new tea();\n    tea.preparebeverage();\n\n    system.out.println("============= åå¤åå¡ =============");\n    beverage coffee = new coffee();\n    coffee.preparebeverage();\n\n}\n\n\nè¾åº\n\n============= åå¤è¶ =============\nç§å¼æ°´\nå²æ³¡è¶å¶\nåå¥æ¯ä¸­\næ·»å æ æª¬\n============= åå¤åå¡ =============\nç§å¼æ°´\nå²æ³¡åå¡è±\nåå¥æ¯ä¸­\næ·»å ç³åçå¥¶\n\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ æ¨¡çæ¹æ³æ¨¡å¼å¨ java æ¡æ¶ä¸­å¾å¸¸è§ã å¼åèéå¸¸ä½¿ç¨å®æ¥åæ¡æ¶ç¨æ·æä¾éè¿ç»§æ¿å®ç°çã å¯¹æ ååè½è¿è¡æ©å±çç®åæ¹å¼ã\n\nè¿éæ¯ä¸äºæ ¸å¿ java ç¨åºåºä¸­æ¨¡çæ¹æ³çç¤ºä¾ï¼\n\n * java.io.inputstreamã java.io.outputstreamã java.io.reader å java.io.writer çææéæ½è±¡æ¹æ³ã\n * java.util.abstractlistã java.util.abstractset å java.util.abstractmap çææéæ½è±¡æ¹æ³ã\n * javax.servlet.http.httpservletï¼ ææé»è®¤åé http 405 âæ¹æ³ä¸åè®¸â éè¯¯ååºç doÂ­xxx()æ¹æ³ã ä½ å¯éæ¶å¯¹å¶è¿è¡éåã\n\nè¯å«æ¹æ³ï¼ æ¨¡çæ¹æ³å¯ä»¥éè¿è¡ä¸ºæ¹æ³æ¥è¯å«ï¼ è¯¥æ¹æ³å·²æä¸ä¸ªå¨åºç±»ä¸­å®ä¹ç âé»è®¤â è¡ä¸ºã\n\n\n# 6.1. æ¶é¤ if ... else åéå¤ä»£ç \n\nåè®¾è¦å¼åä¸ä¸ªè´­ç©è½¦åè½ï¼éå¯¹ä¸åç¨æ·è¿è¡ä¸åçå¤çï¼\n\n * æ®éç¨æ·éè¦æ¶åè¿è´¹ï¼è¿è´¹æ¯ååä»·æ ¼ç 10%ï¼æ ååææ£ï¼\n * vip ç¨æ·åæ ·éè¦æ¶åååä»·æ ¼ 10% çå¿«éè´¹ï¼ä½è´­ä¹°ä¸¤ä»¶ä»¥ä¸ç¸åååæ¶ï¼ç¬¬ä¸ä»¶å¼å§äº«åä¸å®ææ£ï¼\n * åé¨ç¨æ·å¯ä»¥åè¿è´¹ï¼æ ååææ£ã\n\n# é®é¢ 1.0 çæ¬\n\næ®éç¨æ·è´­ç©è½¦\n\npublic class normalusercart {\n\n    public cart process(long userid, map<long, integer> items) {\n        cart cart = new cart();\n\n        //æmapçè´­ç©è½¦è½¬æ¢ä¸ºitemåè¡¨\n        list<item> itemlist = new arraylist<>();\n        items.entryset().stream().foreach(entry -> {\n            item item = new item();\n            item.setid(entry.getkey());\n            item.setprice(db.getitemprice(entry.getkey()));\n            item.setquantity(entry.getvalue());\n            itemlist.add(item);\n        });\n        cart.setitems(itemlist);\n\n        //å¤çè¿è´¹åååä¼æ \n        itemlist.stream().foreach(item -> {\n            //è¿è´¹ä¸ºååæ»ä»·ç10%\n            item.setdeliveryprice(\n                item.getprice().multiply(bigdecimal.valueof(item.getquantity())).multiply(new bigdecimal("0.1")));\n            //æ ä¼æ \n            item.setcouponprice(bigdecimal.zero);\n        });\n\n        //è®¡ç®çº¯ååæ»ä»·\n        cart.settotalitemprice(cart.getitems()\n            .stream()\n            .map(item -> item.getprice().multiply(bigdecimal.valueof(item.getquantity())))\n            .reduce(bigdecimal.zero, bigdecimal::add));\n        //è®¡ç®è¿è´¹æ»ä»·\n        cart.settotaldeliveryprice(\n            cart.getitems().stream().map(item::getdeliveryprice).reduce(bigdecimal.zero, bigdecimal::add));\n        //è®¡ç®æ»ä¼æ \n        cart.settotaldiscount(\n            cart.getitems().stream().map(item::getcouponprice).reduce(bigdecimal.zero, bigdecimal::add));\n        //åºä»æ»ä»·=ååæ»ä»·+è¿è´¹æ»ä»·-æ»ä¼æ \n        cart.setpayprice(cart.gettotalitemprice().add(cart.gettotaldeliveryprice()).subtract(cart.gettotaldiscount()));\n        return cart;\n    }\n\n}\n\n\nvip ç¨æ·è´­ç©è½¦\n\npublic class vipusercart {\n\n    public cart process(long userid, map<long, integer> items) {\n        cart cart = new cart();\n\n        list<item> itemlist = new arraylist<>();\n        items.entryset().stream().foreach(entry -> {\n            item item = new item();\n            item.setid(entry.getkey());\n            item.setprice(db.getitemprice(entry.getkey()));\n            item.setquantity(entry.getvalue());\n            itemlist.add(item);\n        });\n        cart.setitems(itemlist);\n\n        itemlist.stream().foreach(item -> {\n            //è¿è´¹ä¸ºååæ»ä»·ç10%\n            item.setdeliveryprice(\n                item.getprice().multiply(bigdecimal.valueof(item.getquantity())).multiply(new bigdecimal("0.1")));\n            //è´­ä¹°ä¸¤ä»¶ä»¥ä¸ç¸åååï¼ç¬¬ä¸ä»¶å¼å§äº«åä¸å®ææ£\n            if (item.getquantity() > 2) {\n                item.setcouponprice(item.getprice()\n                    .multiply(bigdecimal.valueof(100 - db.getusercouponpercent(userid)).divide(new bigdecimal("100")))\n                    .multiply(bigdecimal.valueof(item.getquantity() - 2)));\n            } else {\n                item.setcouponprice(bigdecimal.zero);\n            }\n        });\n\n        cart.settotalitemprice(cart.getitems()\n            .stream()\n            .map(item -> item.getprice().multiply(bigdecimal.valueof(item.getquantity())))\n            .reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldeliveryprice(\n            cart.getitems().stream().map(item::getdeliveryprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldiscount(\n            cart.getitems().stream().map(item::getcouponprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.setpayprice(cart.gettotalitemprice().add(cart.gettotaldeliveryprice()).subtract(cart.gettotaldiscount()));\n        return cart;\n    }\n\n}\n\n\nåé¨ç¨æ·è´­ç©è½¦\n\npublic class internalusercart {\n\n    public cart process(long userid, map<long, integer> items) {\n        cart cart = new cart();\n\n        list<item> itemlist = new arraylist<>();\n        items.entryset().stream().foreach(entry -> {\n            item item = new item();\n            item.setid(entry.getkey());\n            item.setprice(db.getitemprice(entry.getkey()));\n            item.setquantity(entry.getvalue());\n            itemlist.add(item);\n        });\n        cart.setitems(itemlist);\n\n        itemlist.stream().foreach(item -> {\n            //åè¿è´¹\n            item.setdeliveryprice(bigdecimal.zero);\n            //æ ä¼æ \n            item.setcouponprice(bigdecimal.zero);\n        });\n\n        cart.settotalitemprice(cart.getitems()\n            .stream()\n            .map(item -> item.getprice().multiply(bigdecimal.valueof(item.getquantity())))\n            .reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldeliveryprice(\n            cart.getitems().stream().map(item::getdeliveryprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldiscount(\n            cart.getitems().stream().map(item::getcouponprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.setpayprice(cart.gettotalitemprice().add(cart.gettotaldeliveryprice()).subtract(cart.gettotaldiscount()));\n        return cart;\n    }\n\n}\n\n\nå®¢æ·ç«¯\n\n@getmapping("wrong")\npublic cart wrong(@requestparam("userid") int userid) {\n    string usercategory = db.getusercategory(userid);\n\n    if (usercategory.equals("normal")) {\n        normalusercart normalusercart = new normalusercart();\n        return normalusercart.process(userid, items);\n    }\n\n    if (usercategory.equals("vip")) {\n        vipusercart vipusercart = new vipusercart();\n        return vipusercart.process(userid, items);\n    }\n\n    if (usercategory.equals("internal")) {\n        internalusercart internalusercart = new internalusercart();\n        return internalusercart.process(userid, items);\n    }\n\n    return null;\n}\n\n\n> å¯¹æ¯ä¸ä¸ä»£ç éå¯ä»¥åç°ï¼ä¸ç§è´­ç©è½¦ 70% çä»£ç æ¯éå¤çãåå å¾ç®åï¼è½ç¶ä¸åç±»åç¨æ·è®¡ç®è¿è´¹åä¼æ çæ¹å¼ä¸åï¼ä½æ´ä¸ªè´­ç©è½¦çåå§åãç»è®¡æ»ä»·ãæ»è¿è´¹ãæ»ä¼æ åæ¯ä»ä»·æ ¼çé»è¾é½æ¯ä¸æ ·çã\n\n# ä¿®æ­£çæ¬\n\n1.0 çæ¬çé®é¢å¨äºï¼ç¸åçä»£ç åºè¯¥åªå¨ä¸å¤åºç°ã\n\nå¦ææä»¬çè®°æ½è±¡ç±»åæ½è±¡æ¹æ³çå®ä¹çè¯ï¼è¿æ¶æè®¸å°±ä¼æ³å°ï¼æ¯å¦å¯ä»¥æéå¤çé»è¾å®ä¹å¨æ½è±¡ç±»ä¸­ï¼ä¸ä¸ªè´­ç©è½¦åªè¦åå«å®ç°ä¸åçé£ä»½é»è¾å¢ï¼\n\nå¶å®ï¼è¿ä¸ªæ¨¡å¼å°±æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼ã\n\n> ä¸é¢å±ç¤ºåºäº å·¥åæ¨¡å¼+æ¨¡æ¿æ¹æ³æ¨¡å¼ ä¼åéå¤ä»£ç ã\n\nãæ½è±¡ç±»ã\n\npublic abstract class abstractcart {\n\n    public cart process(long userid, map<long, integer> items) {\n\n        cart cart = new cart();\n\n        list<item> itemlist = new arraylist<>();\n        items.entryset().stream().foreach(entry -> {\n            item item = new item();\n            item.setid(entry.getkey());\n            item.setprice(db.getitemprice(entry.getkey()));\n            item.setquantity(entry.getvalue());\n            itemlist.add(item);\n        });\n        cart.setitems(itemlist);\n\n        itemlist.stream().foreach(item -> {\n            processcouponprice(userid, item);\n            processdeliveryprice(userid, item);\n        });\n\n        cart.settotalitemprice(cart.getitems()\n            .stream()\n            .map(item -> item.getprice().multiply(bigdecimal.valueof(item.getquantity())))\n            .reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldeliveryprice(\n            cart.getitems().stream().map(item::getdeliveryprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.settotaldiscount(\n            cart.getitems().stream().map(item::getcouponprice).reduce(bigdecimal.zero, bigdecimal::add));\n        cart.setpayprice(cart.gettotalitemprice().add(cart.gettotaldeliveryprice()).subtract(cart.gettotaldiscount()));\n        return cart;\n    }\n\n    protected abstract void processcouponprice(long userid, item item);\n\n    protected abstract void processdeliveryprice(long userid, item item);\n\n}\n\n\nãæ®éç¨æ·è´­ç©è½¦ã\n\n@service(value = "normalusercart")\npublic class normalusercart extends abstractcart {\n\n    @override\n    protected void processcouponprice(long userid, item item) {\n        item.setcouponprice(bigdecimal.zero);\n    }\n\n    @override\n    protected void processdeliveryprice(long userid, item item) {\n        item.setdeliveryprice(item.getprice()\n            .multiply(bigdecimal.valueof(item.getquantity()))\n            .multiply(new bigdecimal("0.1")));\n    }\n\n}\n\n\nãvip ç¨æ·è´­ç©è½¦ã\n\n@service(value = "vipusercart")\npublic class vipusercart extends normalusercart {\n\n    @override\n    protected void processcouponprice(long userid, item item) {\n        if (item.getquantity() > 2) {\n            item.setcouponprice(item.getprice()\n                .multiply(bigdecimal.valueof(100 - db.getusercouponpercent(userid)).divide(new bigdecimal("100")))\n                .multiply(bigdecimal.valueof(item.getquantity() - 2)));\n        } else {\n            item.setcouponprice(bigdecimal.zero);\n        }\n    }\n\n}\n\n\nãåé¨ç¨æ·è´­ç©è½¦ã\n\n@service(value = "internalusercart")\npublic class internalusercart extends abstractcart {\n\n    @override\n    protected void processcouponprice(long userid, item item) {\n        item.setcouponprice(bigdecimal.zero);\n    }\n\n    @override\n    protected void processdeliveryprice(long userid, item item) {\n        item.setdeliveryprice(bigdecimal.zero);\n    }\n\n}\n\n\nãå®¢æ·ç«¯ã\n\n@getmapping("right")\npublic cart right(@requestparam("userid") int userid) {\n    string usercategory = db.getusercategory(userid);\n    abstractcart cart = (abstractcart) applicationcontext.getbean(usercategory + "usercart");\n    return cart.process(userid, items);\n}\n\n\n\n# 7. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * å·¥åæ¹æ³æ¨¡å¼æ¯æ¨¡æ¿æ¹æ³æ¨¡å¼çä¸ç§ç¹æ®å½¢å¼ã åæ¶ï¼ å·¥åæ¹æ³å¯ä»¥ä½ä¸ºä¸ä¸ªå¤§åæ¨¡æ¿æ¹æ³ä¸­çä¸ä¸ªæ­¥éª¤ã\n * æ¨¡æ¿æ¹æ³åºäºç»§æ¿æºå¶ï¼ å®åè®¸ä½ éè¿æ©å±å­ç±»ä¸­çé¨ååå®¹æ¥æ¹åé¨åç®æ³ã ç­ç¥æ¨¡å¼åºäºç»åæºå¶ï¼ ä½ å¯ä»¥éè¿å¯¹ç¸åºè¡ä¸ºæä¾ä¸åçç­ç¥æ¥æ¹åå¯¹è±¡çé¨åè¡ä¸ºã æ¨¡æ¿æ¹æ³å¨ç±»å±æ¬¡ä¸è¿ä½ï¼ å æ­¤å®æ¯éæçã ç­ç¥å¨å¯¹è±¡å±æ¬¡ä¸è¿ä½ï¼ å æ­¤åè®¸å¨è¿è¡æ¶åæ¢è¡ä¸ºã\n\n\n# 8. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹å½ä»¤æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹å½ä»¤æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-19T17:20:00.000Z",permalink:"/pages/6389ed/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/15.%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/15.å½ä»¤æ¨¡å¼.md",key:"v-e65aab34",path:"/pages/6389ed/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:3,title:"1.1. å½ä»¤æ¨¡å¼çäº¤äº",slug:"_1-1-å½ä»¤æ¨¡å¼çäº¤äº",normalizedTitle:"1.1. å½ä»¤æ¨¡å¼çäº¤äº",charIndex:129},{level:3,title:"1.2. å½ä»¤æ¨¡å¼çè¦ç¹",slug:"_1-2-å½ä»¤æ¨¡å¼çè¦ç¹",normalizedTitle:"1.2. å½ä»¤æ¨¡å¼çè¦ç¹",charIndex:397},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:698},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:809},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:821},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:1368},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2490},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5804},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:6480},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6766}],headersStr:"1. æå¾ 1.1. å½ä»¤æ¨¡å¼çäº¤äº 1.2. å½ä»¤æ¨¡å¼çè¦ç¹ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹å½ä»¤æ¨¡å¼\n\n\n# 1. æå¾\n\nå½ä»¤æ¨¡å¼ï¼Commandï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®å¯å°è¯·æ±è½¬æ¢ä¸ºä¸ä¸ªåå«ä¸è¯·æ±ç¸å³çææä¿¡æ¯çç¬ç«å¯¹è±¡ã è¯¥è½¬æ¢è®©ä½ è½æ ¹æ®ä¸åçè¯·æ±å°æ¹æ³åæ°åã å»¶è¿è¯·æ±æ§è¡æå°å¶æ¾å¥éåä¸­ï¼ ä¸è½å®ç°å¯æ¤éæä½ã\n\n\n# 1.1. å½ä»¤æ¨¡å¼çäº¤äº\n\n\n\n * Client åå»ºä¸ä¸ª ConcreteCommand å¯¹è±¡å¹¶æå®ä»ç Receiver å¯¹è±¡ã\n * æä¸ª Invoker å¯¹è±¡å­å¨è¯¥ ConcreteCommand å¯¹è±¡ã\n * è¯¥ Invoker éè¿è°ç¨ Command å¯¹è±¡ç Execute æä½æ¥æäº¤ä¸ä¸ªè¯·æ±ãè¥è¯¥å½ä»¤æ¯å¯æ¤éçï¼ConcreteCommand å°±å¨æ§è¡ Execute æä½ä¹åå­å¨å½åç¶æä»¥ç¨äºåæ¶è¯¥å½ä»¤ã\n * ConcreteCommand å¯¹è±¡å¯¹è°ç¨å®ç Receiver çä¸äºæä½ä»¥æ§è¡è¯¥è¯·æ±ã\n\n\n# 1.2. å½ä»¤æ¨¡å¼çè¦ç¹\n\n * å½ä»¤æ¨¡å¼çæ¬è´¨æ¯å¯¹å½ä»¤è¿è¡å°è£ï¼å°ååºå½ä»¤çè´£ä»»åæ§è¡å½ä»¤çè´£ä»»åå²å¼ã\n * æ¯ä¸ä¸ªå½ä»¤é½æ¯ä¸ä¸ªæä½ï¼è¯·æ±çä¸æ¹ååºè¯·æ±ï¼è¦æ±æ§è¡ä¸ä¸ªæä½ï¼æ¥æ¶çä¸æ¹æ¶å°è¯·æ±ï¼å¹¶æ§è¡æä½ã\n * å½ä»¤æ¨¡å¼åè®¸è¯·æ±çä¸æ¹åæ¥æ¶çä¸æ¹ç¬ç«å¼æ¥ï¼ä½¿å¾è¯·æ±çä¸æ¹ä¸å¿ç¥éæ¥æ¶è¯·æ±çä¸æ¹çæ¥å£ï¼æ´ä¸å¿ç¥éè¯·æ±æ¯æä¹è¢«æ¥æ¶ï¼ä»¥åæä½æ¯å¦è¢«æ§è¡ãä½æ¶è¢«æ§è¡ï¼ä»¥åæ¯æä¹è¢«æ§è¡çã\n * å½ä»¤æ¨¡å¼ä½¿è¯·æ±æ¬èº«æä¸ºä¸ä¸ªå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡åå¶ä»å¯¹è±¡ä¸æ ·å¯ä»¥è¢«å­å¨åä¼ éã\n * å½ä»¤æ¨¡å¼çå³é®å¨äºå¼å¥äºæ½è±¡å½ä»¤æ¥å£ï¼ä¸åéèéå¯¹æ½è±¡å½ä»¤æ¥å£ç¼ç¨ï¼åªæå®ç°äºæ½è±¡å½ä»¤æ¥å£çå·ä½å½ä»¤æè½ä¸æ¥æ¶èç¸å³èã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦éè¿æä½æ¥åæ°åå¯¹è±¡ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n * å¦æä½ æ³è¦å°æä½æ¾å¥éåä¸­ã æä½çæ§è¡æèè¿ç¨æ§è¡æä½ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n * å¦æä½ æ³è¦å®ç°æä½åæ»åè½ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. åéè ï¼Senderï¼ââäº¦ç§° âè§¦åè ï¼Invokerï¼âââç±»è´è´£å¯¹è¯·æ±è¿è¡åå§åï¼ å¶ä¸­å¿é¡»åå«ä¸ä¸ªæååéæ¥å­å¨å¯¹äºå½ä»¤å¯¹è±¡çå¼ç¨ã åéèè§¦åå½ä»¤ï¼ èä¸åæ¥æ¶èç´æ¥åéè¯·æ±ã æ³¨æï¼ åéèå¹¶ä¸è´è´£åå»ºå½ä»¤å¯¹è±¡ï¼ å®éå¸¸ä¼éè¿æé å½æ°ä»å®¢æ·ç«¯å¤è·å¾é¢åçæçå½ä»¤ã\n\n 2. å½ä»¤ ï¼Commandï¼ æ¥å£éå¸¸ä»å£°æä¸ä¸ªæ§è¡å½ä»¤çæ¹æ³ã\n\n 3. å·ä½å½ä»¤ ï¼Concrete Commandsï¼ ä¼å®ç°åç§ç±»åçè¯·æ±ã å·ä½å½ä»¤èªèº«å¹¶ä¸å®æå·¥ä½ï¼ èæ¯ä¼å°è°ç¨å§æ´¾ç»ä¸ä¸ªä¸å¡é»è¾å¯¹è±¡ã ä½ä¸ºäºç®åä»£ç ï¼ è¿äºç±»å¯ä»¥è¿è¡åå¹¶ã\n    \n    æ¥æ¶å¯¹è±¡æ§è¡æ¹æ³æéçåæ°å¯ä»¥å£°æä¸ºå·ä½å½ä»¤çæååéã ä½ å¯ä»¥å°å½ä»¤å¯¹è±¡è®¾ä¸ºä¸å¯åï¼ ä»åè®¸éè¿æé å½æ°å¯¹è¿äºæååéè¿è¡åå§åã\n\n 4. æ¥æ¶è ï¼Receiverï¼ ç±»åå«é¨åä¸å¡é»è¾ã å ä¹ä»»ä½å¯¹è±¡é½å¯ä»¥ä½ä¸ºæ¥æ¶èã ç»å¤§é¨åå½ä»¤åªå¤çå¦ä½å°è¯·æ±ä¼ éå°æ¥æ¶èçç»èï¼ æ¥æ¶èèªå·±ä¼å®æå®éçå·¥ä½ã\n\n 5. å®¢æ·ç«¯ ï¼Clientï¼ ä¼åå»ºå¹¶éç½®å·ä½å½ä»¤å¯¹è±¡ã å®¢æ·ç«¯å¿é¡»å°åæ¬æ¥æ¶èå®ä½å¨åçææè¯·æ±åæ°ä¼ éç»å½ä»¤çæé å½æ°ã æ­¤åï¼ çæçå½ä»¤å°±å¯ä»¥ä¸ä¸ä¸ªæå¤ä¸ªåéèç¸å³èäºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nCommand : ç¨æ¥å£°ææ§è¡æä½çæ¥å£ã\n\nabstract class Command {\n    protected Receiver receiver;\n    public Command(Receiver receiver) {\n        this.receiver = receiver;\n    }\n\n    public abstract void Execute();\n}\n\n\nConcreteCommand : å°ä¸ä¸ªæ¥æ¶èå¯¹è±¡ç»å®ä¸ä¸ªå¨ä½ï¼è°ç¨æ¥æ¶èç¸åºçæä½ï¼ä»¥å®ç° Executeã\n\nclass ConcreteCommand extends Command {\n    public ConcreteCommand(Receiver receiver) {\n        super(receiver);\n    }\n\n    @Override\n    public void Execute() {\n        receiver.Action();\n    }\n}\n\n\nInvoker : è¦æ±è¯¥å½ä»¤æ§è¡è¿ä¸ªè¯·æ±ã\n\nclass Invoker {\n    private Command command;\n\n    public Invoker(Command command) {\n        this.command = command;\n    }\n\n    public void ExecuteCommand() {\n        command.Execute();\n    }\n}\n\n\nReceiver : ç¥éå¦ä½å®æ½ä¸æ§è¡ä¸ä¸ªä¸è¯·æ±ç¸å³çæä½ï¼ä»»ä½ç±»é½å¯è½ä½ä¸ºä¸ä¸ªæ¥æ¶èã\n\nclass Receiver {\n    public void Action() {\n        System.out.println("æ§è¡è¯·æ±");\n    }\n}\n\n\nClient : åå»ºä¸ä¸ªå·ä½å½ä»¤å¯¹è±¡å¹¶è®¾å®å®çæ¥åèã\n\npublic class CommandPattern {\n    public static void main(String[] args) {\n        Receiver receiver = new Receiver();\n        Command cmd = new ConcreteCommand(receiver);\n        Invoker invoker = new Invoker(cmd);\n        invoker.ExecuteCommand();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ å½ä»¤æ¨¡å¼ä¼è®°å½å·²æ§è¡æä½çåå²è®°å½ï¼ ä»¥å¨éè¦æ¶æ¤éæä½ã\n\n\n\næäºå½ä»¤ä¼æ¹åç¼è¾å¨çç¶æ ï¼ä¾å¦åªååç²è´´ï¼ï¼ å®ä»¬å¯å¨æ§è¡ç¸å³æä½åå¯¹ç¼è¾å¨çç¶æè¿è¡å¤ä»½ã å½ä»¤æ§è¡åä¼åå½åç¹å¤ä»½çç¼è¾å¨ç¶æä¸èµ·è¢«æ¾å¥å½ä»¤åå² ï¼å½ä»¤å¯¹è±¡æ ï¼ã æ­¤åï¼ å¦æç¨æ·éè¦è¿è¡åæ»æä½ï¼ ç¨åºå¯ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤ï¼ è¯»åç¸åºçç¼è¾å¨ç¶æå¤ä»½ï¼ ç¶åè¿è¡æ¢å¤ã\n\nå®¢æ·ç«¯ä»£ç  ï¼GUI åç´ åå½ä»¤åå²ç­ï¼ æ²¡æåå·ä½å½ä»¤ç±»ç¸è¦åï¼ å ä¸ºå®éè¿å½ä»¤æ¥å£æ¥ä½¿ç¨å½ä»¤ã è¿ä½¿å¾ä½ è½å¨æ éä¿®æ¹å·²æä»£ç çæåµä¸å¨ç¨åºä¸­å¢å æ°çå½ä»¤ã\n\n// å½ä»¤åºç±»ä¼ä¸ºææå·ä½å½ä»¤å®ä¹éç¨æ¥å£ã\nabstract class Command is\n    protected field app: Application\n    protected field editor: Editor\n    protected field backup: text\n\n    constructor Command(app: Application, editor: Editor) is\n        this.app = app\n        this.editor = editor\n\n    // å¤ä»½ç¼è¾å¨ç¶æã\n    method saveBackup() is\n        backup = editor.text\n\n    // æ¢å¤ç¼è¾å¨ç¶æã\n    method undo() is\n        editor.text = backup\n\n    // æ§è¡æ¹æ³è¢«å£°æä¸ºæ½è±¡ä»¥å¼ºå¶ææå·ä½å½ä»¤æä¾èªå·±çå®ç°ãè¯¥æ¹æ³å¿é¡»æ ¹\n    // æ®å½ä»¤æ¯å¦æ´æ¹ç¼è¾å¨çç¶æè¿å true æ falseã\n    abstract method execute()\n\n\n// è¿éæ¯å·ä½å½ä»¤ã\nclass CopyCommand extends Command is\n    // å¤å¶å½ä»¤ä¸ä¼è¢«ä¿å­å°åå²è®°å½ä¸­ï¼å ä¸ºå®æ²¡ææ¹åç¼è¾å¨çç¶æã\n    method execute() is\n        app.clipboard = editor.getSelection()\n        return false\n\nclass CutCommand extends Command is\n    // åªåå½ä»¤æ¹åäºç¼è¾å¨çç¶æï¼å æ­¤å®å¿é¡»è¢«ä¿å­å°åå²è®°å½ä¸­ãåªè¦æ¹æ³\n    // è¿å trueï¼å®å°±ä¼è¢«ä¿å­ã\n    method execute() is\n        saveBackup()\n        app.clipboard = editor.getSelection()\n        editor.deleteSelection()\n        return true\n\nclass PasteCommand extends Command is\n    method execute() is\n        saveBackup()\n        editor.replaceSelection(app.clipboard)\n        return true\n\n// æ¤éæä½ä¹æ¯ä¸ä¸ªå½ä»¤ã\nclass UndoCommand extends Command is\n    method execute() is\n        app.undo()\n        return false\n\n\n// å¨å±å½ä»¤åå²è®°å½å°±æ¯ä¸ä¸ªå æ¡ã\nclass CommandHistory is\n    private field history: array of Command\n\n    // åè¿...\n    method push(c: Command) is\n        // å°å½ä»¤åå¥åå²è®°å½æ°ç»çæ«å°¾ã\n\n    // ...ååº\n    method pop():Command is\n        // ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤ã\n\n\n// ç¼è¾å¨ç±»åå«å®éçææ¬ç¼è¾æä½ãå®ä¼æä»»æ¥æ¶èçè§è²ï¼æåææå½ä»¤é½ä¼\n// å°æ§è¡å·¥ä½å§æ´¾ç»ç¼è¾å¨çæ¹æ³ã\nclass Editor is\n    field text: string\n\n    method getSelection() is\n        // è¿åéä¸­çæå­ã\n\n    method deleteSelection() is\n        // å é¤éä¸­çæå­ã\n\n    method replaceSelection(text) is\n        // å¨å½åä½ç½®æå¥åªè´´æ¿ä¸­çåå®¹ã\n\n// åºç¨ç¨åºç±»ä¼è®¾ç½®å¯¹è±¡ä¹é´çå³ç³»ãå®ä¼æä»»åéèçè§è²ï¼å½éè¦å®ææäºå·¥\n// ä½æ¶ï¼å®ä¼åå»ºå¹¶æ§è¡ä¸ä¸ªå½ä»¤å¯¹è±¡ã\nclass Application is\n    field clipboard: string\n    field editors: array of Editors\n    field activeEditor: Editor\n    field history: CommandHistory\n\n    // å°å½ä»¤åæ´¾ç» UI å¯¹è±¡çä»£ç å¯è½ä¼æ¯è¿æ ·çã\n    method createUI() is\n        // ...\n        copy = function() { executeCommand(\n            new CopyCommand(this, activeEditor)) }\n        copyButton.setCommand(copy)\n        shortcuts.onKeyPress("Ctrl+C", copy)\n\n        cut = function() { executeCommand(\n            new CutCommand(this, activeEditor)) }\n        cutButton.setCommand(cut)\n        shortcuts.onKeyPress("Ctrl+X", cut)\n\n        paste = function() { executeCommand(\n            new PasteCommand(this, activeEditor)) }\n        pasteButton.setCommand(paste)\n        shortcuts.onKeyPress("Ctrl+V", paste)\n\n        undo = function() { executeCommand(\n            new UndoCommand(this, activeEditor)) }\n        undoButton.setCommand(undo)\n        shortcuts.onKeyPress("Ctrl+Z", undo)\n\n    // æ§è¡ä¸ä¸ªå½ä»¤å¹¶æ£æ¥å®æ¯å¦éè¦è¢«æ·»å å°åå²è®°å½ä¸­ã\n    method executeCommand(command) is\n        if (command.execute)\n            history.push(command)\n\n    // ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤å¹¶è¿è¡å¶ undoï¼æ¤éï¼æ¹æ³ãè¯·æ³¨æï¼ä½ å¹¶\n    // ä¸ç¥æè¯¥å½ä»¤æå±çç±»ãä½æ¯æä»¬ä¸éè¦ç¥æï¼å ä¸ºå½ä»¤èªå·±ç¥éå¦ä½æ¤é\n    // å¶å¨ä½ã\n    method undo() is\n        command = history.pop()\n        if (command != null)\n            command.undo()\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * è´£ä»»é¾çç®¡çèå¯ä½¿ç¨å½ä»¤æ¨¡å¼å®ç°ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±è¯·æ±ä»£è¡¨çåä¸ä¸ªä¸ä¸æå¯¹è±¡æ§è¡è®¸å¤ä¸åçæä½ã è¿æå¦å¤ä¸ç§å®ç°æ¹å¼ï¼ é£å°±æ¯è¯·æ±èªèº«å°±æ¯ä¸ä¸ªå½ä»¤å¯¹è±¡ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±ä¸ç³»åä¸åä¸ä¸æè¿æ¥èæçé¾æ§è¡ç¸åçæä½ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å½ä»¤åå¤å¿å½æ¨¡å¼æ¥å®ç° âæ¤éâã å¨è¿ç§æåµä¸ï¼ å½ä»¤ç¨äºå¯¹ç®æ å¯¹è±¡æ§è¡åç§ä¸åçæä½ï¼ å¤å¿å½ç¨æ¥ä¿å­ä¸æ¡å½ä»¤æ§è¡åè¯¥å¯¹è±¡çç¶æã\n * å½ä»¤åç­ç¥æ¨¡å¼çä¸å»å¾åï¼ å ä¸ºä¸¤èé½è½éè¿æäºè¡ä¸ºæ¥åæ°åå¯¹è±¡ã ä½æ¯ï¼ å®ä»¬çæå¾æéå¸¸å¤§çä¸åã\n   * ä½ å¯ä»¥ä½¿ç¨å½ä»¤æ¥å°ä»»ä½æä½è½¬æ¢ä¸ºå¯¹è±¡ã æä½çåæ°å°æä¸ºå¯¹è±¡çæååéã ä½ å¯ä»¥éè¿è½¬æ¢æ¥å»¶è¿æä½çæ§è¡ã å°æä½æ¾å¥éåã ä¿å­åå²å½ä»¤æèåè¿ç¨æå¡åéå½ä»¤ç­ã\n   * å¦ä¸æ¹é¢ï¼ ç­ç¥éå¸¸å¯ç¨äºæè¿°å®ææä»¶äºçä¸åæ¹å¼ï¼ è®©ä½ è½å¤å¨åä¸ä¸ªä¸ä¸æç±»ä¸­åæ¢ç®æ³ã\n * ååæ¨¡å¼å¯ç¨äºä¿å­å½ä»¤çåå²è®°å½ã\n * ä½ å¯ä»¥å°è®¿é®èæ¨¡å¼è§ä¸ºå½ä»¤æ¨¡å¼çå å¼ºçæ¬ï¼ å¶å¯¹è±¡å¯å¯¹ä¸åç±»çå¤ç§å¯¹è±¡æ§è¡æä½ã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼å½ä»¤æ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§ã å¤§é¨åæåµä¸ï¼ å®è¢«ç¨äºä»£æ¿åå«è¡ä¸ºçåæ°å UI åç´ çåè°å½æ°ï¼ æ­¤å¤è¿è¢«ç¨äºå¯¹ä»»å¡è¿è¡æåºåè®°å½æä½åå²è®°å½ç­ã\n\nä»¥ä¸æ¯å¨æ ¸å¿ Java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * java.lang.Runnable çææå®ç°\n * javax.swing.Action çææå®ç°\n\nè¯å«æ¹æ³ï¼ å½ä»¤æ¨¡å¼å¯ä»¥éè¿æ½è±¡ææ¥å£ç±»å ï¼åéèï¼ ä¸­çè¡ä¸ºæ¹æ³æ¥è¯å«ï¼ è¯¥ç±»åè°ç¨å¦ä¸ä¸ªä¸åçæ½è±¡ææ¥å£ç±»å ï¼æ¥æ¶èï¼ å®ç°ä¸­çæ¹æ³ï¼ è¯¥å®ç°åæ¯å¨åå»ºæ¶ç±å½ä»¤æ¨¡å¼çå®ç°å°è£ã å½ä»¤ç±»éå¸¸ä»éäºä¸äºç¹æ®è¡ä¸ºã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹å½ä»¤æ¨¡å¼\n\n\n# 1. æå¾\n\nå½ä»¤æ¨¡å¼ï¼commandï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®å¯å°è¯·æ±è½¬æ¢ä¸ºä¸ä¸ªåå«ä¸è¯·æ±ç¸å³çææä¿¡æ¯çç¬ç«å¯¹è±¡ã è¯¥è½¬æ¢è®©ä½ è½æ ¹æ®ä¸åçè¯·æ±å°æ¹æ³åæ°åã å»¶è¿è¯·æ±æ§è¡æå°å¶æ¾å¥éåä¸­ï¼ ä¸è½å®ç°å¯æ¤éæä½ã\n\n\n# 1.1. å½ä»¤æ¨¡å¼çäº¤äº\n\n\n\n * client åå»ºä¸ä¸ª concretecommand å¯¹è±¡å¹¶æå®ä»ç receiver å¯¹è±¡ã\n * æä¸ª invoker å¯¹è±¡å­å¨è¯¥ concretecommand å¯¹è±¡ã\n * è¯¥ invoker éè¿è°ç¨ command å¯¹è±¡ç execute æä½æ¥æäº¤ä¸ä¸ªè¯·æ±ãè¥è¯¥å½ä»¤æ¯å¯æ¤éçï¼concretecommand å°±å¨æ§è¡ execute æä½ä¹åå­å¨å½åç¶æä»¥ç¨äºåæ¶è¯¥å½ä»¤ã\n * concretecommand å¯¹è±¡å¯¹è°ç¨å®ç receiver çä¸äºæä½ä»¥æ§è¡è¯¥è¯·æ±ã\n\n\n# 1.2. å½ä»¤æ¨¡å¼çè¦ç¹\n\n * å½ä»¤æ¨¡å¼çæ¬è´¨æ¯å¯¹å½ä»¤è¿è¡å°è£ï¼å°ååºå½ä»¤çè´£ä»»åæ§è¡å½ä»¤çè´£ä»»åå²å¼ã\n * æ¯ä¸ä¸ªå½ä»¤é½æ¯ä¸ä¸ªæä½ï¼è¯·æ±çä¸æ¹ååºè¯·æ±ï¼è¦æ±æ§è¡ä¸ä¸ªæä½ï¼æ¥æ¶çä¸æ¹æ¶å°è¯·æ±ï¼å¹¶æ§è¡æä½ã\n * å½ä»¤æ¨¡å¼åè®¸è¯·æ±çä¸æ¹åæ¥æ¶çä¸æ¹ç¬ç«å¼æ¥ï¼ä½¿å¾è¯·æ±çä¸æ¹ä¸å¿ç¥éæ¥æ¶è¯·æ±çä¸æ¹çæ¥å£ï¼æ´ä¸å¿ç¥éè¯·æ±æ¯æä¹è¢«æ¥æ¶ï¼ä»¥åæä½æ¯å¦è¢«æ§è¡ãä½æ¶è¢«æ§è¡ï¼ä»¥åæ¯æä¹è¢«æ§è¡çã\n * å½ä»¤æ¨¡å¼ä½¿è¯·æ±æ¬èº«æä¸ºä¸ä¸ªå¯¹è±¡ï¼è¿ä¸ªå¯¹è±¡åå¶ä»å¯¹è±¡ä¸æ ·å¯ä»¥è¢«å­å¨åä¼ éã\n * å½ä»¤æ¨¡å¼çå³é®å¨äºå¼å¥äºæ½è±¡å½ä»¤æ¥å£ï¼ä¸åéèéå¯¹æ½è±¡å½ä»¤æ¥å£ç¼ç¨ï¼åªæå®ç°äºæ½è±¡å½ä»¤æ¥å£çå·ä½å½ä»¤æè½ä¸æ¥æ¶èç¸å³èã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦éè¿æä½æ¥åæ°åå¯¹è±¡ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n * å¦æä½ æ³è¦å°æä½æ¾å¥éåä¸­ã æä½çæ§è¡æèè¿ç¨æ§è¡æä½ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n * å¦æä½ æ³è¦å®ç°æä½åæ»åè½ï¼ å¯ä½¿ç¨å½ä»¤æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. åéè ï¼senderï¼ââäº¦ç§° âè§¦åè ï¼invokerï¼âââç±»è´è´£å¯¹è¯·æ±è¿è¡åå§åï¼ å¶ä¸­å¿é¡»åå«ä¸ä¸ªæååéæ¥å­å¨å¯¹äºå½ä»¤å¯¹è±¡çå¼ç¨ã åéèè§¦åå½ä»¤ï¼ èä¸åæ¥æ¶èç´æ¥åéè¯·æ±ã æ³¨æï¼ åéèå¹¶ä¸è´è´£åå»ºå½ä»¤å¯¹è±¡ï¼ å®éå¸¸ä¼éè¿æé å½æ°ä»å®¢æ·ç«¯å¤è·å¾é¢åçæçå½ä»¤ã\n\n 2. å½ä»¤ ï¼commandï¼ æ¥å£éå¸¸ä»å£°æä¸ä¸ªæ§è¡å½ä»¤çæ¹æ³ã\n\n 3. å·ä½å½ä»¤ ï¼concrete commandsï¼ ä¼å®ç°åç§ç±»åçè¯·æ±ã å·ä½å½ä»¤èªèº«å¹¶ä¸å®æå·¥ä½ï¼ èæ¯ä¼å°è°ç¨å§æ´¾ç»ä¸ä¸ªä¸å¡é»è¾å¯¹è±¡ã ä½ä¸ºäºç®åä»£ç ï¼ è¿äºç±»å¯ä»¥è¿è¡åå¹¶ã\n    \n    æ¥æ¶å¯¹è±¡æ§è¡æ¹æ³æéçåæ°å¯ä»¥å£°æä¸ºå·ä½å½ä»¤çæååéã ä½ å¯ä»¥å°å½ä»¤å¯¹è±¡è®¾ä¸ºä¸å¯åï¼ ä»åè®¸éè¿æé å½æ°å¯¹è¿äºæååéè¿è¡åå§åã\n\n 4. æ¥æ¶è ï¼receiverï¼ ç±»åå«é¨åä¸å¡é»è¾ã å ä¹ä»»ä½å¯¹è±¡é½å¯ä»¥ä½ä¸ºæ¥æ¶èã ç»å¤§é¨åå½ä»¤åªå¤çå¦ä½å°è¯·æ±ä¼ éå°æ¥æ¶èçç»èï¼ æ¥æ¶èèªå·±ä¼å®æå®éçå·¥ä½ã\n\n 5. å®¢æ·ç«¯ ï¼clientï¼ ä¼åå»ºå¹¶éç½®å·ä½å½ä»¤å¯¹è±¡ã å®¢æ·ç«¯å¿é¡»å°åæ¬æ¥æ¶èå®ä½å¨åçææè¯·æ±åæ°ä¼ éç»å½ä»¤çæé å½æ°ã æ­¤åï¼ çæçå½ä»¤å°±å¯ä»¥ä¸ä¸ä¸ªæå¤ä¸ªåéèç¸å³èäºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\ncommand : ç¨æ¥å£°ææ§è¡æä½çæ¥å£ã\n\nabstract class command {\n    protected receiver receiver;\n    public command(receiver receiver) {\n        this.receiver = receiver;\n    }\n\n    public abstract void execute();\n}\n\n\nconcretecommand : å°ä¸ä¸ªæ¥æ¶èå¯¹è±¡ç»å®ä¸ä¸ªå¨ä½ï¼è°ç¨æ¥æ¶èç¸åºçæä½ï¼ä»¥å®ç° executeã\n\nclass concretecommand extends command {\n    public concretecommand(receiver receiver) {\n        super(receiver);\n    }\n\n    @override\n    public void execute() {\n        receiver.action();\n    }\n}\n\n\ninvoker : è¦æ±è¯¥å½ä»¤æ§è¡è¿ä¸ªè¯·æ±ã\n\nclass invoker {\n    private command command;\n\n    public invoker(command command) {\n        this.command = command;\n    }\n\n    public void executecommand() {\n        command.execute();\n    }\n}\n\n\nreceiver : ç¥éå¦ä½å®æ½ä¸æ§è¡ä¸ä¸ªä¸è¯·æ±ç¸å³çæä½ï¼ä»»ä½ç±»é½å¯è½ä½ä¸ºä¸ä¸ªæ¥æ¶èã\n\nclass receiver {\n    public void action() {\n        system.out.println("æ§è¡è¯·æ±");\n    }\n}\n\n\nclient : åå»ºä¸ä¸ªå·ä½å½ä»¤å¯¹è±¡å¹¶è®¾å®å®çæ¥åèã\n\npublic class commandpattern {\n    public static void main(string[] args) {\n        receiver receiver = new receiver();\n        command cmd = new concretecommand(receiver);\n        invoker invoker = new invoker(cmd);\n        invoker.executecommand();\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ å½ä»¤æ¨¡å¼ä¼è®°å½å·²æ§è¡æä½çåå²è®°å½ï¼ ä»¥å¨éè¦æ¶æ¤éæä½ã\n\n\n\næäºå½ä»¤ä¼æ¹åç¼è¾å¨çç¶æ ï¼ä¾å¦åªååç²è´´ï¼ï¼ å®ä»¬å¯å¨æ§è¡ç¸å³æä½åå¯¹ç¼è¾å¨çç¶æè¿è¡å¤ä»½ã å½ä»¤æ§è¡åä¼åå½åç¹å¤ä»½çç¼è¾å¨ç¶æä¸èµ·è¢«æ¾å¥å½ä»¤åå² ï¼å½ä»¤å¯¹è±¡æ ï¼ã æ­¤åï¼ å¦æç¨æ·éè¦è¿è¡åæ»æä½ï¼ ç¨åºå¯ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤ï¼ è¯»åç¸åºçç¼è¾å¨ç¶æå¤ä»½ï¼ ç¶åè¿è¡æ¢å¤ã\n\nå®¢æ·ç«¯ä»£ç  ï¼gui åç´ åå½ä»¤åå²ç­ï¼ æ²¡æåå·ä½å½ä»¤ç±»ç¸è¦åï¼ å ä¸ºå®éè¿å½ä»¤æ¥å£æ¥ä½¿ç¨å½ä»¤ã è¿ä½¿å¾ä½ è½å¨æ éä¿®æ¹å·²æä»£ç çæåµä¸å¨ç¨åºä¸­å¢å æ°çå½ä»¤ã\n\n// å½ä»¤åºç±»ä¼ä¸ºææå·ä½å½ä»¤å®ä¹éç¨æ¥å£ã\nabstract class command is\n    protected field app: application\n    protected field editor: editor\n    protected field backup: text\n\n    constructor command(app: application, editor: editor) is\n        this.app = app\n        this.editor = editor\n\n    // å¤ä»½ç¼è¾å¨ç¶æã\n    method savebackup() is\n        backup = editor.text\n\n    // æ¢å¤ç¼è¾å¨ç¶æã\n    method undo() is\n        editor.text = backup\n\n    // æ§è¡æ¹æ³è¢«å£°æä¸ºæ½è±¡ä»¥å¼ºå¶ææå·ä½å½ä»¤æä¾èªå·±çå®ç°ãè¯¥æ¹æ³å¿é¡»æ ¹\n    // æ®å½ä»¤æ¯å¦æ´æ¹ç¼è¾å¨çç¶æè¿å true æ falseã\n    abstract method execute()\n\n\n// è¿éæ¯å·ä½å½ä»¤ã\nclass copycommand extends command is\n    // å¤å¶å½ä»¤ä¸ä¼è¢«ä¿å­å°åå²è®°å½ä¸­ï¼å ä¸ºå®æ²¡ææ¹åç¼è¾å¨çç¶æã\n    method execute() is\n        app.clipboard = editor.getselection()\n        return false\n\nclass cutcommand extends command is\n    // åªåå½ä»¤æ¹åäºç¼è¾å¨çç¶æï¼å æ­¤å®å¿é¡»è¢«ä¿å­å°åå²è®°å½ä¸­ãåªè¦æ¹æ³\n    // è¿å trueï¼å®å°±ä¼è¢«ä¿å­ã\n    method execute() is\n        savebackup()\n        app.clipboard = editor.getselection()\n        editor.deleteselection()\n        return true\n\nclass pastecommand extends command is\n    method execute() is\n        savebackup()\n        editor.replaceselection(app.clipboard)\n        return true\n\n// æ¤éæä½ä¹æ¯ä¸ä¸ªå½ä»¤ã\nclass undocommand extends command is\n    method execute() is\n        app.undo()\n        return false\n\n\n// å¨å±å½ä»¤åå²è®°å½å°±æ¯ä¸ä¸ªå æ¡ã\nclass commandhistory is\n    private field history: array of command\n\n    // åè¿...\n    method push(c: command) is\n        // å°å½ä»¤åå¥åå²è®°å½æ°ç»çæ«å°¾ã\n\n    // ...ååº\n    method pop():command is\n        // ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤ã\n\n\n// ç¼è¾å¨ç±»åå«å®éçææ¬ç¼è¾æä½ãå®ä¼æä»»æ¥æ¶èçè§è²ï¼æåææå½ä»¤é½ä¼\n// å°æ§è¡å·¥ä½å§æ´¾ç»ç¼è¾å¨çæ¹æ³ã\nclass editor is\n    field text: string\n\n    method getselection() is\n        // è¿åéä¸­çæå­ã\n\n    method deleteselection() is\n        // å é¤éä¸­çæå­ã\n\n    method replaceselection(text) is\n        // å¨å½åä½ç½®æå¥åªè´´æ¿ä¸­çåå®¹ã\n\n// åºç¨ç¨åºç±»ä¼è®¾ç½®å¯¹è±¡ä¹é´çå³ç³»ãå®ä¼æä»»åéèçè§è²ï¼å½éè¦å®ææäºå·¥\n// ä½æ¶ï¼å®ä¼åå»ºå¹¶æ§è¡ä¸ä¸ªå½ä»¤å¯¹è±¡ã\nclass application is\n    field clipboard: string\n    field editors: array of editors\n    field activeeditor: editor\n    field history: commandhistory\n\n    // å°å½ä»¤åæ´¾ç» ui å¯¹è±¡çä»£ç å¯è½ä¼æ¯è¿æ ·çã\n    method createui() is\n        // ...\n        copy = function() { executecommand(\n            new copycommand(this, activeeditor)) }\n        copybutton.setcommand(copy)\n        shortcuts.onkeypress("ctrl+c", copy)\n\n        cut = function() { executecommand(\n            new cutcommand(this, activeeditor)) }\n        cutbutton.setcommand(cut)\n        shortcuts.onkeypress("ctrl+x", cut)\n\n        paste = function() { executecommand(\n            new pastecommand(this, activeeditor)) }\n        pastebutton.setcommand(paste)\n        shortcuts.onkeypress("ctrl+v", paste)\n\n        undo = function() { executecommand(\n            new undocommand(this, activeeditor)) }\n        undobutton.setcommand(undo)\n        shortcuts.onkeypress("ctrl+z", undo)\n\n    // æ§è¡ä¸ä¸ªå½ä»¤å¹¶æ£æ¥å®æ¯å¦éè¦è¢«æ·»å å°åå²è®°å½ä¸­ã\n    method executecommand(command) is\n        if (command.execute)\n            history.push(command)\n\n    // ä»åå²è®°å½ä¸­ååºæè¿çå½ä»¤å¹¶è¿è¡å¶ undoï¼æ¤éï¼æ¹æ³ãè¯·æ³¨æï¼ä½ å¹¶\n    // ä¸ç¥æè¯¥å½ä»¤æå±çç±»ãä½æ¯æä»¬ä¸éè¦ç¥æï¼å ä¸ºå½ä»¤èªå·±ç¥éå¦ä½æ¤é\n    // å¶å¨ä½ã\n    method undo() is\n        command = history.pop()\n        if (command != null)\n            command.undo()\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * è´£ä»»é¾çç®¡çèå¯ä½¿ç¨å½ä»¤æ¨¡å¼å®ç°ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±è¯·æ±ä»£è¡¨çåä¸ä¸ªä¸ä¸æå¯¹è±¡æ§è¡è®¸å¤ä¸åçæä½ã è¿æå¦å¤ä¸ç§å®ç°æ¹å¼ï¼ é£å°±æ¯è¯·æ±èªèº«å°±æ¯ä¸ä¸ªå½ä»¤å¯¹è±¡ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±ä¸ç³»åä¸åä¸ä¸æè¿æ¥èæçé¾æ§è¡ç¸åçæä½ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å½ä»¤åå¤å¿å½æ¨¡å¼æ¥å®ç° âæ¤éâã å¨è¿ç§æåµä¸ï¼ å½ä»¤ç¨äºå¯¹ç®æ å¯¹è±¡æ§è¡åç§ä¸åçæä½ï¼ å¤å¿å½ç¨æ¥ä¿å­ä¸æ¡å½ä»¤æ§è¡åè¯¥å¯¹è±¡çç¶æã\n * å½ä»¤åç­ç¥æ¨¡å¼çä¸å»å¾åï¼ å ä¸ºä¸¤èé½è½éè¿æäºè¡ä¸ºæ¥åæ°åå¯¹è±¡ã ä½æ¯ï¼ å®ä»¬çæå¾æéå¸¸å¤§çä¸åã\n   * ä½ å¯ä»¥ä½¿ç¨å½ä»¤æ¥å°ä»»ä½æä½è½¬æ¢ä¸ºå¯¹è±¡ã æä½çåæ°å°æä¸ºå¯¹è±¡çæååéã ä½ å¯ä»¥éè¿è½¬æ¢æ¥å»¶è¿æä½çæ§è¡ã å°æä½æ¾å¥éåã ä¿å­åå²å½ä»¤æèåè¿ç¨æå¡åéå½ä»¤ç­ã\n   * å¦ä¸æ¹é¢ï¼ ç­ç¥éå¸¸å¯ç¨äºæè¿°å®ææä»¶äºçä¸åæ¹å¼ï¼ è®©ä½ è½å¤å¨åä¸ä¸ªä¸ä¸æç±»ä¸­åæ¢ç®æ³ã\n * ååæ¨¡å¼å¯ç¨äºä¿å­å½ä»¤çåå²è®°å½ã\n * ä½ å¯ä»¥å°è®¿é®èæ¨¡å¼è§ä¸ºå½ä»¤æ¨¡å¼çå å¼ºçæ¬ï¼ å¶å¯¹è±¡å¯å¯¹ä¸åç±»çå¤ç§å¯¹è±¡æ§è¡æä½ã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼å½ä»¤æ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§ã å¤§é¨åæåµä¸ï¼ å®è¢«ç¨äºä»£æ¿åå«è¡ä¸ºçåæ°å ui åç´ çåè°å½æ°ï¼ æ­¤å¤è¿è¢«ç¨äºå¯¹ä»»å¡è¿è¡æåºåè®°å½æä½åå²è®°å½ç­ã\n\nä»¥ä¸æ¯å¨æ ¸å¿ java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * java.lang.runnable çææå®ç°\n * javax.swing.action çææå®ç°\n\nè¯å«æ¹æ³ï¼ å½ä»¤æ¨¡å¼å¯ä»¥éè¿æ½è±¡ææ¥å£ç±»å ï¼åéèï¼ ä¸­çè¡ä¸ºæ¹æ³æ¥è¯å«ï¼ è¯¥ç±»åè°ç¨å¦ä¸ä¸ªä¸åçæ½è±¡ææ¥å£ç±»å ï¼æ¥æ¶èï¼ å®ç°ä¸­çæ¹æ³ï¼ è¯¥å®ç°åæ¯å¨åå»ºæ¶ç±å½ä»¤æ¨¡å¼çå®ç°å°è£ã å½ä»¤ç±»éå¸¸ä»éäºä¸äºç¹æ®è¡ä¸ºã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹è¿­ä»£å¨æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹è¿­ä»£å¨æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-19T17:20:00.000Z",permalink:"/pages/d2026d/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/16.%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/16.è¿­ä»£å¨æ¨¡å¼.md",key:"v-637f7ff4",path:"/pages/d2026d/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:98},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:240},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:252},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:797},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:3002},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5822},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:6020},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6270}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹è¿­ä»£å¨æ¨¡å¼\n\n\n# 1. æå¾\n\nè¿­ä»£å¨æ¨¡å¼ï¼Iteratorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¨ä¸æ´é²éååºå±è¡¨ç°å½¢å¼ ï¼åè¡¨ã æ åæ ç­ï¼ çæåµä¸éåéåä¸­ææçåç´ ã\n\n\n# 2. éç¨åºæ¯\n\n * å½éåèåä¸ºå¤æçæ°æ®ç»æï¼ ä¸ä½ å¸æå¯¹å®¢æ·ç«¯éèå¶å¤ææ§æ¶ ï¼åºäºä½¿ç¨ä¾¿å©æ§æå®å¨æ§çèèï¼ï¼ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼ã\n * ä½¿ç¨è¯¥æ¨¡å¼å¯ä»¥åå°ç¨åºä¸­éå¤çéåä»£ç ã\n * å¦æä½ å¸æä»£ç è½å¤éåä¸åççè³æ¯æ æ³é¢ç¥çæ°æ®ç»æï¼ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. è¿­ä»£å¨ ï¼Iteratorï¼ æ¥å£å£°æäºéåéåæéçæä½ï¼ è·åä¸ä¸ä¸ªåç´ ã è·åå½åä½ç½®åéæ°å¼å§è¿­ä»£ç­ã\n 2. å·ä½è¿­ä»£å¨ ï¼Concrete Iteratorsï¼ å®ç°éåéåçä¸ç§ç¹å®ç®æ³ã è¿­ä»£å¨å¯¹è±¡å¿é¡»è·è¸ªèªèº«éåçè¿åº¦ã è¿ä½¿å¾å¤ä¸ªè¿­ä»£å¨å¯ä»¥ç¸äºç¬ç«å°éååä¸éåã\n 3. éå ï¼Collectionï¼ æ¥å£å£°æä¸ä¸ªæå¤ä¸ªæ¹æ³æ¥è·åä¸éåå¼å®¹çè¿­ä»£å¨ã è¯·æ³¨æï¼ è¿åæ¹æ³çç±»åå¿é¡»è¢«å£°æä¸ºè¿­ä»£å¨æ¥å£ï¼ å æ­¤å·ä½éåå¯ä»¥è¿ååç§ä¸åç§ç±»çè¿­ä»£å¨ã\n 4. å·ä½éå ï¼Concrete Collectionsï¼ ä¼å¨å®¢æ·ç«¯è¯·æ±è¿­ä»£å¨æ¶è¿åä¸ä¸ªç¹å®çå·ä½è¿­ä»£å¨ç±»å®ä½ã ä½ å¯è½ä¼ç¢ç£¨ï¼ å©ä¸çéåä»£ç å¨ä»ä¹å°æ¹å¢ï¼ ä¸ç¨æå¿ï¼ å®ä¹ä¼å¨åä¸ä¸ªç±»ä¸­ã åªæ¯è¿äºç»èå¯¹äºå®éæ¨¡å¼æ¥è¯´å¹¶ä¸éè¦ï¼ æä»¥æä»¬å°å¶çç¥äºèå·²ã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ éè¿éååè¿­ä»£å¨çæ¥å£ä¸ä¸¤èè¿è¡äº¤äºã è¿æ ·ä¸æ¥å®¢æ·ç«¯æ éä¸å·ä½ç±»è¿è¡è¦åï¼ åè®¸åä¸å®¢æ·ç«¯ä»£ç ä½¿ç¨åç§ä¸åçéååè¿­ä»£å¨ã\n    * å®¢æ·ç«¯éå¸¸ä¸ä¼èªè¡åå»ºè¿­ä»£å¨ï¼ èæ¯ä¼ä»éåä¸­è·åã ä½å¨ç¹å®æåµä¸ï¼ å®¢æ·ç«¯å¯ä»¥ç´æ¥åå»ºä¸ä¸ªè¿­ä»£å¨ ï¼ä¾å¦å½å®¢æ·ç«¯éè¦èªå®ä¹ç¹æ®è¿­ä»£å¨æ¶ï¼ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nIterator : å®ä¹è®¿é®åç´ çæ¥å£ã\n\ninterface Iterator {\n    public Object first();\n    public Object next();\n    public boolean isDone();\n    public Object currentItem();\n}\n\n\nConcreteIterator : å®ç° Iterator æ¥å£ãè®°å½å½åè®¿é®çåç´ å¨éåä¸­çä½ç½®ä¿¡æ¯ã\n\nclass ConcreteIterator implements Iterator {\n    private int current = 0;\n    private ConcreteAggregate aggregate;\n\n    public ConcreteIterator(ConcreteAggregate aggregate) {\n        this.aggregate = aggregate;\n    }\n\n    @Override\n    public Object first() {\n        return aggregate.get(0);\n    }\n\n    @Override\n    public Object next() {\n        current++;\n        if (current < aggregate.size()) {\n            return aggregate.get(current);\n        }\n        return null;\n    }\n\n    @Override\n    public boolean isDone() {\n        return (current >= aggregate.size()) ? true : false;\n    }\n\n    @Override\n    public Object currentItem() {\n        return aggregate.get(current);\n    }\n}\n\n\nAggregate : å®ä¹åå»º Iterator å¯¹è±¡çæ¥å£ã\n\ninterface Aggregate {\n    public Iterator CreateIterator();\n}\n\n\nConcreteAggregate : å®ç° Iterator æ¥å£ï¼è¿åä¸ä¸ªåéç ConcreteIterator å®ä¾ã\n\nclass ConcreteAggregate implements Aggregate {\n    private List<Object> items = new ArrayList<Object>();\n\n    @Override\n    public Iterator CreateIterator() {\n        return new ConcreteIterator(this);\n    }\n\n    public int size() {\n        return items.size();\n    }\n\n    public Object get(int index) {\n        return items.get(index);\n    }\n\n    public void set(int index, Object element) {\n        items.set(index, element);\n    }\n\n    public void add(Object element) {\n        items.add(element);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class IteratorPattern {\n    public static void main(String[] args) {\n        ConcreteAggregate aggregate = new ConcreteAggregate();\n        aggregate.add("å¼ ä¸");\n        aggregate.add("æå");\n        aggregate.add("çäº");\n        aggregate.add("èµµå­");\n\n        Iterator iter = new ConcreteIterator(aggregate);\n        Object item = iter.first();\n        System.out.println("ç¬¬ä¸ä¸ªäººæ¯ï¼" + item);\n        System.out.println("ææäººçååæ¯ï¼");\n        while (!iter.isDone()) {\n            System.out.println(iter.currentItem());\n            iter.next();\n        }\n    }\n}\n\n\nè¾åº\n\nç¬¬ä¸ä¸ªäººæ¯ï¼å¼ ä¸\nææäººçååæ¯ï¼\nå¼ ä¸\næå\nçäº\nèµµå­\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è¿­ä»£å¨æ¨¡å¼ç¨äºéåä¸ä¸ªå°è£äºè®¿é®å¾®ä¿¡å¥½åå³ç³»åè½çç¹æ®éåã è¯¥éåæä¾ä½¿ç¨ä¸åæ¹å¼éåæ¡£æ¡èµæçå¤ä¸ªè¿­ä»£å¨ã\n\n\n\nâå¥½å ï¼friendsï¼â è¿­ä»£å¨å¯ç¨äºéåæå®æ¡£æ¡çå¥½åã âåäº ï¼colleaguesï¼â è¿­ä»£å¨ä¹æä¾åæ ·çåè½ï¼ ä½ä»åæ¬ä¸ç®æ ç¨æ·å¨åä¸å®¶å¬å¸å·¥ä½çå¥½åã è¿ä¸¤ä¸ªè¿­ä»£å¨é½å®ç°äºåä¸ä¸ªéç¨æ¥å£ï¼ å®¢æ·ç«¯è½å¨ä¸äºè§£è®¤è¯ååé REST è¯·æ±ç­å®ç°ç»èçæåµä¸è·åæ¡£æ¡ã\n\nå®¢æ·ç«¯ä»éè¿æ¥å£ä¸éååè¿­ä»£å¨äº¤äºï¼ ä¹å°±ä¸ä¼åå·ä½ç±»è¦åã å¦æä½ å³å®å°åºç¨è¿æ¥å°å¨æ°çç¤¾äº¤ç½ç»ï¼ åªéæä¾æ°çéååè¿­ä»£å¨ç±»å³å¯ï¼ æ éä¿®æ¹ç°æä»£ç ã\n\n// éåæ¥å£å¿é¡»å£°æä¸ä¸ªç¨äºçæè¿­ä»£å¨çå·¥åæ¹æ³ãå¦æç¨åºä¸­æä¸åç±»åçè¿­\n// ä»£å¨ï¼ä½ ä¹å¯ä»¥å£°æå¤ä¸ªæ¹æ³ã\ninterface SocialNetwork is\n    method createFriendsIterator(profileId):ProfileIterator\n    method createCoworkersIterator(profileId):ProfileIterator\n\n\n// æ¯ä¸ªå·ä½éåé½ä¸å¶è¿åçä¸ç»å·ä½è¿­ä»£å¨ç¸è¦åãä½å®¢æ·å¹¶ä¸æ¯è¿æ ·çï¼å ä¸º\n// è¿äºæ¹æ³çç­¾åå°ä¼è¿åè¿­ä»£å¨æ¥å£ã\nclass WeChat implements SocialNetwork is\n    // ...å¤§éçéåä»£ç åºè¯¥æ¾å¨è¿é...\n\n    // è¿­ä»£å¨åå»ºä»£ç ã\n    method createFriendsIterator(profileId) is\n        return new WeChatIterator(this, profileId, "friends")\n    method createCoworkersIterator(profileId) is\n        return new WeChatIterator(this, profileId, "coworkers")\n\n\n// ææè¿­ä»£å¨çéç¨æ¥å£ã\ninterface ProfileIterator is\n    method getNext():Profile\n    method hasMore():bool\n\n\n// å·ä½è¿­ä»£å¨ç±»ã\nclass WeChatIterator implements ProfileIterator is\n    // è¿­ä»£å¨éè¦ä¸ä¸ªæåå¶éåéåçå¼ç¨ã\n    private field weChat: WeChat\n    private field profileId, type: string\n\n    // è¿­ä»£å¨å¯¹è±¡ä¼ç¬ç«äºå¶ä»è¿­ä»£å¨æ¥å¯¹éåè¿è¡éåãå æ­¤å®å¿é¡»ä¿å­è¿­ä»£å¨\n    // çç¶æã\n    private field currentPosition\n    private field cache: array of Profile\n\n    constructor WeChatIterator(weChat, profileId, type) is\n        this.weChat = weChat\n        this.profileId = profileId\n        this.type = type\n\n    private method lazyInit() is\n        if (cache == null)\n            cache = weChat.socialGraphRequest(profileId, type)\n\n    // æ¯ä¸ªå·ä½è¿­ä»£å¨ç±»é½ä¼èªè¡å®ç°éç¨è¿­ä»£å¨æ¥å£ã\n    method getNext() is\n        if (hasMore())\n            currentPosition++\n            return cache[currentPosition]\n\n    method hasMore() is\n        lazyInit()\n        return currentPosition < cache.length\n\n\n// è¿éè¿æä¸ä¸ªæç¨çç»æï¼ä½ å¯å°è¿­ä»£å¨ä¼ éç»å®¢æ·ç«¯ç±»ï¼æ éè®©å¶æ¥æè®¿é®æ´\n// ä¸ªéåçæéãè¿æ ·ä¸æ¥ï¼ä½ å°±æ éå°éåæ´é²ç»å®¢æ·ç«¯äºã\n//\n// è¿æå¦ä¸ä¸ªå¥½å¤ï¼ä½ å¯å¨è¿è¡æ¶å°ä¸åçè¿­ä»£å¨ä¼ éç»å®¢æ·ç«¯ï¼ä»èæ¹åå®¢æ·ç«¯\n// ä¸éåäºå¨çæ¹å¼ãè¿ä¸æ¹æ³å¯è¡çåå æ¯å®¢æ·ç«¯ä»£ç å¹¶æ²¡æåå·ä½è¿­ä»£å¨ç±»ç¸\n// è¦åã\nclass SocialSpammer is\n    method send(iterator: ProfileIterator, message: string) is\n        while (iterator.hasMore())\n            profile = iterator.getNext()\n            System.sendEmail(profile.getEmail(), message)\n\n\n// åºç¨ç¨åºï¼Applicationï¼ç±»å¯å¯¹éååè¿­ä»£å¨è¿è¡éç½®ï¼ç¶åå°å¶ä¼ éç»å®¢æ·\n// ç«¯ä»£ç ã\nclass Application is\n    field network: SocialNetwork\n    field spammer: SocialSpammer\n\n    method config() is\n        if working with WeChat\n            this.network = new WeChat()\n        if working with LinkedIn\n            this.network = new LinkedIn()\n        this.spammer = new SocialSpammer()\n\n    method sendSpamToFriends(profile) is\n        iterator = network.createFriendsIterator(profile.getId())\n        spammer.send(iterator, "éå¸¸éè¦çæ¶æ¯")\n\n    method sendSpamToCoworkers(profile) is\n        iterator = network.createCoworkersIterator(profile.getId())\n        spammer.send(iterator, "éå¸¸éè¦çæ¶æ¯")\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼æ¥éåç»åæ¨¡å¼æ ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼åè¿­ä»£å¨æ¥è®©å­ç±»éåè¿åä¸åç±»åçè¿­ä»£å¨ï¼ å¹¶ä½¿å¾è¿­ä»£å¨ä¸éåç¸å¹éã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å¤å¿å½æ¨¡å¼åè¿­ä»£å¨æ¥è·åå½åè¿­ä»£å¨çç¶æï¼ å¹¶ä¸å¨éè¦çæ¶åè¿è¡åæ»ã\n * å¯ä»¥åæ¶ä½¿ç¨è®¿é®èæ¨¡å¼åè¿­ä»£å¨æ¥éåå¤ææ°æ®ç»æï¼ å¹¶å¯¹å¶ä¸­çåç´ æ§è¡æéæä½ï¼ å³ä½¿è¿äºåç´ æå±çç±»å®å¨ä¸åã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è¯¥æ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§ã è®¸å¤æ¡æ¶åç¨åºåºé½ä¼ä½¿ç¨å®æ¥æä¾éåå¶éåçæ åæ¹å¼ã\n\nä¸é¢æ¯è¯¥æ¨¡å¼å¨æ ¸å¿ Java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * java.util.Iteratorçææå®ç° ï¼è¿æ java.util.Scannerï¼ã\n * java.util.Enumerationçææå®ç°\n\nè¯å«æ¹æ³ï¼ è¿­ä»£å¨å¯ä»¥éè¿å¯¼èªæ¹æ³ ï¼ä¾å¦ nextå previousç­ï¼ æ¥è½»æ¾è¯å«ã ä½¿ç¨è¿­ä»£å¨çå®¢æ·ç«¯ä»£ç å¯è½æ²¡æå¶æéåçéåçç´æ¥è®¿é®æéã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹è¿­ä»£å¨æ¨¡å¼\n\n\n# 1. æå¾\n\nè¿­ä»£å¨æ¨¡å¼ï¼iteratorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¨ä¸æ´é²éååºå±è¡¨ç°å½¢å¼ ï¼åè¡¨ã æ åæ ç­ï¼ çæåµä¸éåéåä¸­ææçåç´ ã\n\n\n# 2. éç¨åºæ¯\n\n * å½éåèåä¸ºå¤æçæ°æ®ç»æï¼ ä¸ä½ å¸æå¯¹å®¢æ·ç«¯éèå¶å¤ææ§æ¶ ï¼åºäºä½¿ç¨ä¾¿å©æ§æå®å¨æ§çèèï¼ï¼ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼ã\n * ä½¿ç¨è¯¥æ¨¡å¼å¯ä»¥åå°ç¨åºä¸­éå¤çéåä»£ç ã\n * å¦æä½ å¸æä»£ç è½å¤éåä¸åççè³æ¯æ æ³é¢ç¥çæ°æ®ç»æï¼ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. è¿­ä»£å¨ ï¼iteratorï¼ æ¥å£å£°æäºéåéåæéçæä½ï¼ è·åä¸ä¸ä¸ªåç´ ã è·åå½åä½ç½®åéæ°å¼å§è¿­ä»£ç­ã\n 2. å·ä½è¿­ä»£å¨ ï¼concrete iteratorsï¼ å®ç°éåéåçä¸ç§ç¹å®ç®æ³ã è¿­ä»£å¨å¯¹è±¡å¿é¡»è·è¸ªèªèº«éåçè¿åº¦ã è¿ä½¿å¾å¤ä¸ªè¿­ä»£å¨å¯ä»¥ç¸äºç¬ç«å°éååä¸éåã\n 3. éå ï¼collectionï¼ æ¥å£å£°æä¸ä¸ªæå¤ä¸ªæ¹æ³æ¥è·åä¸éåå¼å®¹çè¿­ä»£å¨ã è¯·æ³¨æï¼ è¿åæ¹æ³çç±»åå¿é¡»è¢«å£°æä¸ºè¿­ä»£å¨æ¥å£ï¼ å æ­¤å·ä½éåå¯ä»¥è¿ååç§ä¸åç§ç±»çè¿­ä»£å¨ã\n 4. å·ä½éå ï¼concrete collectionsï¼ ä¼å¨å®¢æ·ç«¯è¯·æ±è¿­ä»£å¨æ¶è¿åä¸ä¸ªç¹å®çå·ä½è¿­ä»£å¨ç±»å®ä½ã ä½ å¯è½ä¼ç¢ç£¨ï¼ å©ä¸çéåä»£ç å¨ä»ä¹å°æ¹å¢ï¼ ä¸ç¨æå¿ï¼ å®ä¹ä¼å¨åä¸ä¸ªç±»ä¸­ã åªæ¯è¿äºç»èå¯¹äºå®éæ¨¡å¼æ¥è¯´å¹¶ä¸éè¦ï¼ æä»¥æä»¬å°å¶çç¥äºèå·²ã\n 5. å®¢æ·ç«¯ ï¼clientï¼ éè¿éååè¿­ä»£å¨çæ¥å£ä¸ä¸¤èè¿è¡äº¤äºã è¿æ ·ä¸æ¥å®¢æ·ç«¯æ éä¸å·ä½ç±»è¿è¡è¦åï¼ åè®¸åä¸å®¢æ·ç«¯ä»£ç ä½¿ç¨åç§ä¸åçéååè¿­ä»£å¨ã\n    * å®¢æ·ç«¯éå¸¸ä¸ä¼èªè¡åå»ºè¿­ä»£å¨ï¼ èæ¯ä¼ä»éåä¸­è·åã ä½å¨ç¹å®æåµä¸ï¼ å®¢æ·ç«¯å¯ä»¥ç´æ¥åå»ºä¸ä¸ªè¿­ä»£å¨ ï¼ä¾å¦å½å®¢æ·ç«¯éè¦èªå®ä¹ç¹æ®è¿­ä»£å¨æ¶ï¼ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\niterator : å®ä¹è®¿é®åç´ çæ¥å£ã\n\ninterface iterator {\n    public object first();\n    public object next();\n    public boolean isdone();\n    public object currentitem();\n}\n\n\nconcreteiterator : å®ç° iterator æ¥å£ãè®°å½å½åè®¿é®çåç´ å¨éåä¸­çä½ç½®ä¿¡æ¯ã\n\nclass concreteiterator implements iterator {\n    private int current = 0;\n    private concreteaggregate aggregate;\n\n    public concreteiterator(concreteaggregate aggregate) {\n        this.aggregate = aggregate;\n    }\n\n    @override\n    public object first() {\n        return aggregate.get(0);\n    }\n\n    @override\n    public object next() {\n        current++;\n        if (current < aggregate.size()) {\n            return aggregate.get(current);\n        }\n        return null;\n    }\n\n    @override\n    public boolean isdone() {\n        return (current >= aggregate.size()) ? true : false;\n    }\n\n    @override\n    public object currentitem() {\n        return aggregate.get(current);\n    }\n}\n\n\naggregate : å®ä¹åå»º iterator å¯¹è±¡çæ¥å£ã\n\ninterface aggregate {\n    public iterator createiterator();\n}\n\n\nconcreteaggregate : å®ç° iterator æ¥å£ï¼è¿åä¸ä¸ªåéç concreteiterator å®ä¾ã\n\nclass concreteaggregate implements aggregate {\n    private list<object> items = new arraylist<object>();\n\n    @override\n    public iterator createiterator() {\n        return new concreteiterator(this);\n    }\n\n    public int size() {\n        return items.size();\n    }\n\n    public object get(int index) {\n        return items.get(index);\n    }\n\n    public void set(int index, object element) {\n        items.set(index, element);\n    }\n\n    public void add(object element) {\n        items.add(element);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class iteratorpattern {\n    public static void main(string[] args) {\n        concreteaggregate aggregate = new concreteaggregate();\n        aggregate.add("å¼ ä¸");\n        aggregate.add("æå");\n        aggregate.add("çäº");\n        aggregate.add("èµµå­");\n\n        iterator iter = new concreteiterator(aggregate);\n        object item = iter.first();\n        system.out.println("ç¬¬ä¸ä¸ªäººæ¯ï¼" + item);\n        system.out.println("ææäººçååæ¯ï¼");\n        while (!iter.isdone()) {\n            system.out.println(iter.currentitem());\n            iter.next();\n        }\n    }\n}\n\n\nè¾åº\n\nç¬¬ä¸ä¸ªäººæ¯ï¼å¼ ä¸\nææäººçååæ¯ï¼\nå¼ ä¸\næå\nçäº\nèµµå­\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è¿­ä»£å¨æ¨¡å¼ç¨äºéåä¸ä¸ªå°è£äºè®¿é®å¾®ä¿¡å¥½åå³ç³»åè½çç¹æ®éåã è¯¥éåæä¾ä½¿ç¨ä¸åæ¹å¼éåæ¡£æ¡èµæçå¤ä¸ªè¿­ä»£å¨ã\n\n\n\nâå¥½å ï¼friendsï¼â è¿­ä»£å¨å¯ç¨äºéåæå®æ¡£æ¡çå¥½åã âåäº ï¼colleaguesï¼â è¿­ä»£å¨ä¹æä¾åæ ·çåè½ï¼ ä½ä»åæ¬ä¸ç®æ ç¨æ·å¨åä¸å®¶å¬å¸å·¥ä½çå¥½åã è¿ä¸¤ä¸ªè¿­ä»£å¨é½å®ç°äºåä¸ä¸ªéç¨æ¥å£ï¼ å®¢æ·ç«¯è½å¨ä¸äºè§£è®¤è¯ååé rest è¯·æ±ç­å®ç°ç»èçæåµä¸è·åæ¡£æ¡ã\n\nå®¢æ·ç«¯ä»éè¿æ¥å£ä¸éååè¿­ä»£å¨äº¤äºï¼ ä¹å°±ä¸ä¼åå·ä½ç±»è¦åã å¦æä½ å³å®å°åºç¨è¿æ¥å°å¨æ°çç¤¾äº¤ç½ç»ï¼ åªéæä¾æ°çéååè¿­ä»£å¨ç±»å³å¯ï¼ æ éä¿®æ¹ç°æä»£ç ã\n\n// éåæ¥å£å¿é¡»å£°æä¸ä¸ªç¨äºçæè¿­ä»£å¨çå·¥åæ¹æ³ãå¦æç¨åºä¸­æä¸åç±»åçè¿­\n// ä»£å¨ï¼ä½ ä¹å¯ä»¥å£°æå¤ä¸ªæ¹æ³ã\ninterface socialnetwork is\n    method createfriendsiterator(profileid):profileiterator\n    method createcoworkersiterator(profileid):profileiterator\n\n\n// æ¯ä¸ªå·ä½éåé½ä¸å¶è¿åçä¸ç»å·ä½è¿­ä»£å¨ç¸è¦åãä½å®¢æ·å¹¶ä¸æ¯è¿æ ·çï¼å ä¸º\n// è¿äºæ¹æ³çç­¾åå°ä¼è¿åè¿­ä»£å¨æ¥å£ã\nclass wechat implements socialnetwork is\n    // ...å¤§éçéåä»£ç åºè¯¥æ¾å¨è¿é...\n\n    // è¿­ä»£å¨åå»ºä»£ç ã\n    method createfriendsiterator(profileid) is\n        return new wechatiterator(this, profileid, "friends")\n    method createcoworkersiterator(profileid) is\n        return new wechatiterator(this, profileid, "coworkers")\n\n\n// ææè¿­ä»£å¨çéç¨æ¥å£ã\ninterface profileiterator is\n    method getnext():profile\n    method hasmore():bool\n\n\n// å·ä½è¿­ä»£å¨ç±»ã\nclass wechatiterator implements profileiterator is\n    // è¿­ä»£å¨éè¦ä¸ä¸ªæåå¶éåéåçå¼ç¨ã\n    private field wechat: wechat\n    private field profileid, type: string\n\n    // è¿­ä»£å¨å¯¹è±¡ä¼ç¬ç«äºå¶ä»è¿­ä»£å¨æ¥å¯¹éåè¿è¡éåãå æ­¤å®å¿é¡»ä¿å­è¿­ä»£å¨\n    // çç¶æã\n    private field currentposition\n    private field cache: array of profile\n\n    constructor wechatiterator(wechat, profileid, type) is\n        this.wechat = wechat\n        this.profileid = profileid\n        this.type = type\n\n    private method lazyinit() is\n        if (cache == null)\n            cache = wechat.socialgraphrequest(profileid, type)\n\n    // æ¯ä¸ªå·ä½è¿­ä»£å¨ç±»é½ä¼èªè¡å®ç°éç¨è¿­ä»£å¨æ¥å£ã\n    method getnext() is\n        if (hasmore())\n            currentposition++\n            return cache[currentposition]\n\n    method hasmore() is\n        lazyinit()\n        return currentposition < cache.length\n\n\n// è¿éè¿æä¸ä¸ªæç¨çç»æï¼ä½ å¯å°è¿­ä»£å¨ä¼ éç»å®¢æ·ç«¯ç±»ï¼æ éè®©å¶æ¥æè®¿é®æ´\n// ä¸ªéåçæéãè¿æ ·ä¸æ¥ï¼ä½ å°±æ éå°éåæ´é²ç»å®¢æ·ç«¯äºã\n//\n// è¿æå¦ä¸ä¸ªå¥½å¤ï¼ä½ å¯å¨è¿è¡æ¶å°ä¸åçè¿­ä»£å¨ä¼ éç»å®¢æ·ç«¯ï¼ä»èæ¹åå®¢æ·ç«¯\n// ä¸éåäºå¨çæ¹å¼ãè¿ä¸æ¹æ³å¯è¡çåå æ¯å®¢æ·ç«¯ä»£ç å¹¶æ²¡æåå·ä½è¿­ä»£å¨ç±»ç¸\n// è¦åã\nclass socialspammer is\n    method send(iterator: profileiterator, message: string) is\n        while (iterator.hasmore())\n            profile = iterator.getnext()\n            system.sendemail(profile.getemail(), message)\n\n\n// åºç¨ç¨åºï¼applicationï¼ç±»å¯å¯¹éååè¿­ä»£å¨è¿è¡éç½®ï¼ç¶åå°å¶ä¼ éç»å®¢æ·\n// ç«¯ä»£ç ã\nclass application is\n    field network: socialnetwork\n    field spammer: socialspammer\n\n    method config() is\n        if working with wechat\n            this.network = new wechat()\n        if working with linkedin\n            this.network = new linkedin()\n        this.spammer = new socialspammer()\n\n    method sendspamtofriends(profile) is\n        iterator = network.createfriendsiterator(profile.getid())\n        spammer.send(iterator, "éå¸¸éè¦çæ¶æ¯")\n\n    method sendspamtocoworkers(profile) is\n        iterator = network.createcoworkersiterator(profile.getid())\n        spammer.send(iterator, "éå¸¸éè¦çæ¶æ¯")\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥ä½¿ç¨è¿­ä»£å¨æ¨¡å¼æ¥éåç»åæ¨¡å¼æ ã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å·¥åæ¹æ³æ¨¡å¼åè¿­ä»£å¨æ¥è®©å­ç±»éåè¿åä¸åç±»åçè¿­ä»£å¨ï¼ å¹¶ä½¿å¾è¿­ä»£å¨ä¸éåç¸å¹éã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å¤å¿å½æ¨¡å¼åè¿­ä»£å¨æ¥è·åå½åè¿­ä»£å¨çç¶æï¼ å¹¶ä¸å¨éè¦çæ¶åè¿è¡åæ»ã\n * å¯ä»¥åæ¶ä½¿ç¨è®¿é®èæ¨¡å¼åè¿­ä»£å¨æ¥éåå¤ææ°æ®ç»æï¼ å¹¶å¯¹å¶ä¸­çåç´ æ§è¡æéæä½ï¼ å³ä½¿è¿äºåç´ æå±çç±»å®å¨ä¸åã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è¯¥æ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§ã è®¸å¤æ¡æ¶åç¨åºåºé½ä¼ä½¿ç¨å®æ¥æä¾éåå¶éåçæ åæ¹å¼ã\n\nä¸é¢æ¯è¯¥æ¨¡å¼å¨æ ¸å¿ java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * java.util.iteratorçææå®ç° ï¼è¿æ java.util.scannerï¼ã\n * java.util.enumerationçææå®ç°\n\nè¯å«æ¹æ³ï¼ è¿­ä»£å¨å¯ä»¥éè¿å¯¼èªæ¹æ³ ï¼ä¾å¦ nextå previousç­ï¼ æ¥è½»æ¾è¯å«ã ä½¿ç¨è¿­ä»£å¨çå®¢æ·ç«¯ä»£ç å¯è½æ²¡æå¶æéåçéåçç´æ¥è®¿é®æéã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹è§å¯èæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹è§å¯èæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-20T16:09:00.000Z",permalink:"/pages/87fbaa/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/17.%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/17.è§å¯èæ¨¡å¼.md",key:"v-07d9254f",path:"/pages/87fbaa/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:96},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:212},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:224},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:716},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:3343},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5650},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:6301},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6710}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹è§å¯èæ¨¡å¼\n\n\n# 1. æå¾\n\nè§å¯èæ¨¡å¼ï¼Observerï¼æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸ä½ å®ä¹ä¸ç§è®¢éæºå¶ï¼ å¯å¨å¯¹è±¡äºä»¶åçæ¶éç¥å¤ä¸ª âè§å¯â è¯¥å¯¹è±¡çå¶ä»å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä¸ä¸ªå¯¹è±¡ç¶æçæ¹åéè¦æ¹åå¶ä»å¯¹è±¡ï¼ æå®éå¯¹è±¡æ¯äºåæªç¥çæå¨æååçæ¶ï¼ å¯ä½¿ç¨è§å¯èæ¨¡å¼ã\n * å½åºç¨ä¸­çä¸äºå¯¹è±¡å¿é¡»è§å¯å¶ä»å¯¹è±¡æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã ä½ä»è½å¨æéæ¶é´åæç¹å®æåµä¸ä½¿ç¨ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. åå¸è ï¼Publisherï¼ ä¼åå¶ä»å¯¹è±¡åéå¼å¾å³æ³¨çäºä»¶ã äºä»¶ä¼å¨åå¸èèªèº«ç¶ææ¹åææ§è¡ç¹å®è¡ä¸ºååçã åå¸èä¸­åå«ä¸ä¸ªåè®¸æ°è®¢éèå å¥åå½åè®¢éèç¦»å¼åè¡¨çè®¢éææ¶ã\n 2. å½æ°äºä»¶åçæ¶ï¼ åéèä¼éåè®¢éåè¡¨å¹¶è°ç¨æ¯ä¸ªè®¢éèå¯¹è±¡çéç¥æ¹æ³ã è¯¥æ¹æ³æ¯å¨è®¢éèæ¥å£ä¸­å£°æçã\n 3. è®¢éè ï¼Subscriberï¼ æ¥å£å£°æäºéç¥æ¥å£ã å¨ç»å¤§å¤æ°æåµä¸ï¼ è¯¥æ¥å£ä»åå«ä¸ä¸ª updateæ´æ°æ¹æ³ã è¯¥æ¹æ³å¯ä»¥æ¥æå¤ä¸ªåæ°ï¼ ä½¿åå¸èè½å¨æ´æ°æ¶ä¼ éäºä»¶çè¯¦ç»ä¿¡æ¯ã\n 4. å·ä½è®¢éè ï¼Concrete Subscribersï¼ å¯ä»¥æ§è¡ä¸äºæä½æ¥ååºåå¸èçéç¥ã ææå·ä½è®¢éèç±»é½å®ç°äºåæ ·çæ¥å£ï¼ å æ­¤åå¸èä¸éè¦ä¸å·ä½ç±»ç¸è¦åã\n 5. è®¢éèéå¸¸éè¦ä¸äºä¸ä¸æä¿¡æ¯æ¥æ­£ç¡®å°å¤çæ´æ°ã å æ­¤ï¼ åå¸èéå¸¸ä¼å°ä¸äºä¸ä¸ææ°æ®ä½ä¸ºéç¥æ¹æ³çåæ°è¿è¡ä¼ éã åå¸èä¹å¯å°èªèº«ä½ä¸ºåæ°è¿è¡ä¼ éï¼ ä½¿è®¢éèç´æ¥è·åæéçæ°æ®ã\n 6. å®¢æ·ç«¯ ï¼Clientï¼ ä¼åå«åå»ºåå¸èåè®¢éèå¯¹è±¡ï¼ ç¶åä¸ºè®¢éèæ³¨ååå¸èæ´æ°ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nSubject : ä¸»é¢ç±»ï¼ä¿å­ææè®¢éæ­¤ä¸»é¢çè§å¯èï¼è§å¯èç æ°éæ¯ä»»æçãå®ä¹ æ·»å è§å¯è (Attach) å å é¤è§å¯è (Detach) çæ¥å£ã\n\nabstract class Subject {\n    protected String name;\n    protected String state;\n    protected List<Observer> observers = new ArrayList<Observer>();\n\n    public abstract String getState();\n    public abstract void setState(String state);\n    public abstract void Notify();\n\n    public Subject(String name) {\n        this.name = name;\n    }\n\n    public void Attach(Observer observer) {\n        observers.add(observer);\n    }\n\n    public void Detach(Observer observer) {\n        observers.remove(observer);\n    }\n}\n\n\nObserver : è§å¯èç±»ï¼å®ä¹æ´æ°æ¥å£ (Update)ï¼å½æ¶å° Subject çéç¥æ¶ï¼Observer éè¦åæ­¥æ´æ°ä¿¡æ¯ã\n\nabstract class Observer {\n    protected String name;\n    protected Subject subject;\n    public Observer(String name, Subject subject) {\n        this.name = name;\n        this.subject = subject;\n    }\n    public abstract void Update();\n}\n\n\nConcreteSubject : å·ä½ä¸»é¢ç±»ï¼å­å¨å¯¹äºè¿ä¸ªä¸»é¢æå´è¶£çææè§å¯èãå½åé¨ç¶æåçååæ¶ï¼åºéç¥ææç»è®°çè§å¯è(Notify)ã\n\nclass ConcreteSubject extends Subject {\n    public ConcreteSubject(String name) {\n        super(name);\n    }\n\n    @Override\n    public String getState() {\n        return state;\n    }\n\n    @Override\n    public void setState(String state) {\n        this.state = state;\n    }\n\n    @Override\n    public void Notify() {\n        System.out.println("======= " + this.name + "ä¸»é¢åå¸æ°æ¶æ¯ =======");\n        for (Observer observer : observers) {\n            observer.Update();\n        }\n    }\n}\n\n\nConcreteObserver : å·ä½è§å¯èç±»ï¼å®ç° Observer çæ´æ°æ¥å£ (Update)ï¼ä»¥ä¾¿å Subject åæ­¥ç¶æä¿¡æ¯ã\n\nclass ConcreteObserver extends Observer {\n    private String state;\n    public ConcreteObserver(String name, Subject subject) {\n        super(name, subject);\n    }\n\n    @Override\n    public void Update() {\n        state = subject.getState();\n        System.out.println(this.name + "æ¶å°å½åç¶æï¼" + state);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class ObserverPattern {\n    public static void main(String[] args) {\n        ConcreteSubject subject = new ConcreteSubject("å¤©æ°");\n        ConcreteObserver observer1 = new ConcreteObserver("å¼ ä¸", subject);\n        ConcreteObserver observer2 = new ConcreteObserver("æå", subject);\n        ConcreteObserver observer3 = new ConcreteObserver("çäº", subject);\n\n        subject.Attach(observer1);\n        subject.Attach(observer2);\n        subject.Attach(observer3);\n        subject.setState("ä»å¤©ä¸é¨");\n        subject.Notify();\n\n        subject.Detach(observer2);\n        subject.setState("æå¤©å¤©æ´");\n        subject.Notify();\n    }\n}\n\n\nè¾åº\n\n======= å¤©æ°ä¸»é¢åå¸æ°æ¶æ¯ =======\nå¼ ä¸æ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\næåæ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\nçäºæ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\n======= å¤©æ°ä¸»é¢åå¸æ°æ¶æ¯ =======\nå¼ ä¸æ¶å°å½åç¶æï¼æå¤©å¤©æ´\nçäºæ¶å°å½åç¶æï¼æå¤©å¤©æ´\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è§å¯èæ¨¡å¼åè®¸ææ¬ç¼è¾å¨å¯¹è±¡å°èªèº«çç¶ææ¹åéç¥ç»å¶ä»æå¡å¯¹è±¡ã\n\n\n\nè®¢éèåè¡¨æ¯å¨æçæçï¼ å¯¹è±¡å¯å¨è¿è¡æ¶æ ¹æ®ç¨åºéè¦å¼å§æåæ­¢çå¬éç¥ã\n\nå¨æ¬å®ç°ä¸­ï¼ ç¼è¾å¨ç±»èªèº«å¹¶ä¸ç»´æ¤è®¢éåè¡¨ã å®å°å·¥ä½å§æ´¾ç»ä¸é¨ä»äºæ­¤å·¥ä½çä¸ä¸ªç¹æ®å¸®æå¯¹è±¡ã ä½ è¿å¯å°è¯¥å¯¹è±¡åçº§ä¸ºä¸­å¿åçäºä»¶ååå¨ï¼ åè®¸ä»»ä½å¯¹è±¡æä¸ºåå¸èã\n\nåªè¦åå¸èéè¿åæ ·çæ¥å£ä¸ææè®¢éèè¿è¡äº¤äºï¼ é£ä¹å¨ç¨åºä¸­æ°å¢è®¢éèæ¶å°±æ éä¿®æ¹å·²æåå¸èç±»çä»£ç ã\n\n// åå¸èåºç±»åå«è®¢éç®¡çä»£ç åéç¥æ¹æ³ã\nclass EventManager is\n    private field listeners: hash map of event types and listeners\n\n    method subscribe(eventType, listener) is\n        listeners.add(eventType, listener)\n\n    method unsubscribe(eventType, listener) is\n        listeners.remove(eventType, listener)\n\n    method notify(eventType, data) is\n        foreach (listener in listeners.of(eventType)) do\n            listener.update(data)\n\n// å·ä½åå¸èåå«ä¸äºè®¢éèæå´è¶£çå®éä¸å¡é»è¾ãæä»¬å¯ä»¥ä»åå¸èåºç±»ä¸­æ©\n// å±åºè¯¥ç±»ï¼ä½å¨å®éæåµä¸å¹¶ä¸æ»è½åå°ï¼å ä¸ºå·ä½åå¸èå¯è½å·²ç»æ¯å­ç±»äºã\n// å¨è¿ç§æåµä¸ï¼ä½ å¯ç¨ç»åæ¥ä¿®è¡¥è®¢éé»è¾ï¼å°±åæä»¬å¨è¿éåçä¸æ ·ã\nclass Editor is\n    public field events: EventManager\n    private field file: File\n\n    constructor Editor() is\n        events = new EventManager()\n\n    // ä¸å¡é»è¾çæ¹æ³å¯å°ååéç¥ç»è®¢éèã\n    method openFile(path) is\n        this.file = new File(path)\n        events.notify("open", file.name)\n\n    method saveFile() is\n        file.write()\n        events.notify("save", file.name)\n\n    // ...\n\n\n// è¿éæ¯è®¢éèæ¥å£ãå¦æä½ çç¼ç¨è¯­è¨æ¯æå½æ°ç±»åï¼åå¯ç¨ä¸ç»å½æ°æ¥ä»£æ¿æ´\n// ä¸ªè®¢éèçå±æ¬¡ç»æã\ninterface EventListener is\n    method update(filename)\n\n// å·ä½è®¢éèä¼å¯¹å¶æ³¨åçåå¸èæååºçæ´æ°æ¶æ¯ååºååºã\nclass LoggingListener implements EventListener is\n    private field log: File\n    private field message\n\n    constructor LoggingListener(log_filename, message) is\n        this.log = new File(log_filename)\n        this.message = message\n\n    method update(filename) is\n        log.write(replace(\'%s\',filename,message))\n\nclass EmailAlertsListener implements EventListener is\n    private field email: string\n\n    constructor EmailAlertsListener(email, message) is\n        this.email = email\n        this.message = message\n\n    method update(filename) is\n        system.email(email, replace(\'%s\',filename,message))\n\n\n// åºç¨ç¨åºå¯å¨è¿è¡æ¶éç½®åå¸èåè®¢éèã\nclass Application is\n    method config() is\n        editor = new Editor()\n\n        logger = new LoggingListener(\n            "/path/to/log.txt",\n            "æäººæå¼äºæä»¶ï¼%s");\n        editor.events.subscribe("open", logger)\n\n        emailAlerts = new EmailAlertsListener(\n            "admin@example.com",\n            "æäººæ´æ¹äºæä»¶ï¼%s")\n        editor.events.subscribe("save", emailAlerts)\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * ä¸­ä»èåè§å¯èä¹é´çåºå«å¾å¾å¾é¾è®°ä½ã å¨å¤§é¨åæåµä¸ï¼ ä½ å¯ä»¥ä½¿ç¨å¶ä¸­ä¸ç§æ¨¡å¼ï¼ èææ¶å¯ä»¥åæ¶ä½¿ç¨ã è®©æä»¬æ¥ççå¦ä½åå°è¿ä¸ç¹ã\n   * ä¸­ä»èçä¸»è¦ç®æ æ¯æ¶é¤ä¸ç³»åç³»ç»ç»ä»¶ä¹é´çç¸äºä¾èµã è¿äºç»ä»¶å°ä¾èµäºåä¸ä¸ªä¸­ä»èå¯¹è±¡ã è§å¯èçç®æ æ¯å¨å¯¹è±¡ä¹é´å»ºç«å¨æçååè¿æ¥ï¼ ä½¿å¾é¨åå¯¹è±¡å¯ä½ä¸ºå¶ä»å¯¹è±¡çéå±åæ¥ä½ç¨ã\n   * æä¸ç§æµè¡çä¸­ä»èæ¨¡å¼å®ç°æ¹å¼ä¾èµäºè§å¯èã ä¸­ä»èå¯¹è±¡æå½åå¸èçè§è²ï¼ å¶ä»ç»ä»¶åä½ä¸ºè®¢éèï¼ å¯ä»¥è®¢éä¸­ä»èçäºä»¶æåæ¶è®¢éã å½ä¸­ä»èä»¥è¿ç§æ¹å¼å®ç°æ¶ï¼ å®å¯è½çä¸å»ä¸è§å¯èéå¸¸ç¸ä¼¼ã\n   * å½ä½ æå°çææ¶ï¼ è®°ä½å¯ä»¥éç¨å¶ä»æ¹å¼æ¥å®ç°ä¸­ä»èã ä¾å¦ï¼ ä½ å¯æ°¸ä¹æ§å°å°ææç»ä»¶é¾æ¥å°åä¸ä¸ªä¸­ä»èå¯¹è±¡ã è¿ç§å®ç°æ¹å¼åè§å¯èå¹¶ä¸ç¸åï¼ ä½è¿ä»æ¯ä¸ç§ä¸­ä»èæ¨¡å¼ã\n   * åè®¾æä¸ä¸ªç¨åºï¼ å¶ææçç»ä»¶é½åæäºåå¸èï¼ å®ä»¬ä¹é´å¯ä»¥ç¸äºå»ºç«å¨æè¿æ¥ã è¿æ ·ç¨åºä¸­å°±æ²¡æä¸­å¿åçä¸­ä»èå¯¹è±¡ï¼ èåªæä¸äºåå¸å¼çè§å¯èã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è§å¯èæ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§ï¼ ç¹å«æ¯å¨ GUI ç»ä»¶ä¸­ã å®æä¾äºå¨ä¸ä¸å¶ä»å¯¹è±¡æå±ç±»è¦åçæåµä¸å¯¹å¶äºä»¶ååºååºçæ¹å¼ã\n\nè¿éæ¯æ ¸å¿ Java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * java.util.Observer/ java.util.Observable ï¼æå°å¨çå®ä¸çä¸­ä½¿ç¨ï¼\n * java.util.EventListenerçææå®ç° ï¼å ä¹å¹¿æ³å­å¨äº Swing ç»ä»¶ä¸­ï¼\n * javax.servlet.http.HttpSessionBindingListener\n * javax.servlet.http.HttpSessionAttributeListener\n * javax.faces.event.PhaseListener\n\nè¯å«æ¹æ³ï¼ è¯¥æ¨¡å¼å¯ä»¥éè¿å°å¯¹è±¡å­å¨å¨åè¡¨ä¸­çè®¢éæ¹æ³ï¼ åå¯¹äºé¢åè¯¥åè¡¨ä¸­å¯¹è±¡çæ´æ°æ¹æ³çè°ç¨æ¥è¯å«ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹è§å¯èæ¨¡å¼\n\n\n# 1. æå¾\n\nè§å¯èæ¨¡å¼ï¼observerï¼æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸ä½ å®ä¹ä¸ç§è®¢éæºå¶ï¼ å¯å¨å¯¹è±¡äºä»¶åçæ¶éç¥å¤ä¸ª âè§å¯â è¯¥å¯¹è±¡çå¶ä»å¯¹è±¡ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä¸ä¸ªå¯¹è±¡ç¶æçæ¹åéè¦æ¹åå¶ä»å¯¹è±¡ï¼ æå®éå¯¹è±¡æ¯äºåæªç¥çæå¨æååçæ¶ï¼ å¯ä½¿ç¨è§å¯èæ¨¡å¼ã\n * å½åºç¨ä¸­çä¸äºå¯¹è±¡å¿é¡»è§å¯å¶ä»å¯¹è±¡æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã ä½ä»è½å¨æéæ¶é´åæç¹å®æåµä¸ä½¿ç¨ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. åå¸è ï¼publisherï¼ ä¼åå¶ä»å¯¹è±¡åéå¼å¾å³æ³¨çäºä»¶ã äºä»¶ä¼å¨åå¸èèªèº«ç¶ææ¹åææ§è¡ç¹å®è¡ä¸ºååçã åå¸èä¸­åå«ä¸ä¸ªåè®¸æ°è®¢éèå å¥åå½åè®¢éèç¦»å¼åè¡¨çè®¢éææ¶ã\n 2. å½æ°äºä»¶åçæ¶ï¼ åéèä¼éåè®¢éåè¡¨å¹¶è°ç¨æ¯ä¸ªè®¢éèå¯¹è±¡çéç¥æ¹æ³ã è¯¥æ¹æ³æ¯å¨è®¢éèæ¥å£ä¸­å£°æçã\n 3. è®¢éè ï¼subscriberï¼ æ¥å£å£°æäºéç¥æ¥å£ã å¨ç»å¤§å¤æ°æåµä¸ï¼ è¯¥æ¥å£ä»åå«ä¸ä¸ª updateæ´æ°æ¹æ³ã è¯¥æ¹æ³å¯ä»¥æ¥æå¤ä¸ªåæ°ï¼ ä½¿åå¸èè½å¨æ´æ°æ¶ä¼ éäºä»¶çè¯¦ç»ä¿¡æ¯ã\n 4. å·ä½è®¢éè ï¼concrete subscribersï¼ å¯ä»¥æ§è¡ä¸äºæä½æ¥ååºåå¸èçéç¥ã ææå·ä½è®¢éèç±»é½å®ç°äºåæ ·çæ¥å£ï¼ å æ­¤åå¸èä¸éè¦ä¸å·ä½ç±»ç¸è¦åã\n 5. è®¢éèéå¸¸éè¦ä¸äºä¸ä¸æä¿¡æ¯æ¥æ­£ç¡®å°å¤çæ´æ°ã å æ­¤ï¼ åå¸èéå¸¸ä¼å°ä¸äºä¸ä¸ææ°æ®ä½ä¸ºéç¥æ¹æ³çåæ°è¿è¡ä¼ éã åå¸èä¹å¯å°èªèº«ä½ä¸ºåæ°è¿è¡ä¼ éï¼ ä½¿è®¢éèç´æ¥è·åæéçæ°æ®ã\n 6. å®¢æ·ç«¯ ï¼clientï¼ ä¼åå«åå»ºåå¸èåè®¢éèå¯¹è±¡ï¼ ç¶åä¸ºè®¢éèæ³¨ååå¸èæ´æ°ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nsubject : ä¸»é¢ç±»ï¼ä¿å­ææè®¢éæ­¤ä¸»é¢çè§å¯èï¼è§å¯èç æ°éæ¯ä»»æçãå®ä¹ æ·»å è§å¯è (attach) å å é¤è§å¯è (detach) çæ¥å£ã\n\nabstract class subject {\n    protected string name;\n    protected string state;\n    protected list<observer> observers = new arraylist<observer>();\n\n    public abstract string getstate();\n    public abstract void setstate(string state);\n    public abstract void notify();\n\n    public subject(string name) {\n        this.name = name;\n    }\n\n    public void attach(observer observer) {\n        observers.add(observer);\n    }\n\n    public void detach(observer observer) {\n        observers.remove(observer);\n    }\n}\n\n\nobserver : è§å¯èç±»ï¼å®ä¹æ´æ°æ¥å£ (update)ï¼å½æ¶å° subject çéç¥æ¶ï¼observer éè¦åæ­¥æ´æ°ä¿¡æ¯ã\n\nabstract class observer {\n    protected string name;\n    protected subject subject;\n    public observer(string name, subject subject) {\n        this.name = name;\n        this.subject = subject;\n    }\n    public abstract void update();\n}\n\n\nconcretesubject : å·ä½ä¸»é¢ç±»ï¼å­å¨å¯¹äºè¿ä¸ªä¸»é¢æå´è¶£çææè§å¯èãå½åé¨ç¶æåçååæ¶ï¼åºéç¥ææç»è®°çè§å¯è(notify)ã\n\nclass concretesubject extends subject {\n    public concretesubject(string name) {\n        super(name);\n    }\n\n    @override\n    public string getstate() {\n        return state;\n    }\n\n    @override\n    public void setstate(string state) {\n        this.state = state;\n    }\n\n    @override\n    public void notify() {\n        system.out.println("======= " + this.name + "ä¸»é¢åå¸æ°æ¶æ¯ =======");\n        for (observer observer : observers) {\n            observer.update();\n        }\n    }\n}\n\n\nconcreteobserver : å·ä½è§å¯èç±»ï¼å®ç° observer çæ´æ°æ¥å£ (update)ï¼ä»¥ä¾¿å subject åæ­¥ç¶æä¿¡æ¯ã\n\nclass concreteobserver extends observer {\n    private string state;\n    public concreteobserver(string name, subject subject) {\n        super(name, subject);\n    }\n\n    @override\n    public void update() {\n        state = subject.getstate();\n        system.out.println(this.name + "æ¶å°å½åç¶æï¼" + state);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class observerpattern {\n    public static void main(string[] args) {\n        concretesubject subject = new concretesubject("å¤©æ°");\n        concreteobserver observer1 = new concreteobserver("å¼ ä¸", subject);\n        concreteobserver observer2 = new concreteobserver("æå", subject);\n        concreteobserver observer3 = new concreteobserver("çäº", subject);\n\n        subject.attach(observer1);\n        subject.attach(observer2);\n        subject.attach(observer3);\n        subject.setstate("ä»å¤©ä¸é¨");\n        subject.notify();\n\n        subject.detach(observer2);\n        subject.setstate("æå¤©å¤©æ´");\n        subject.notify();\n    }\n}\n\n\nè¾åº\n\n======= å¤©æ°ä¸»é¢åå¸æ°æ¶æ¯ =======\nå¼ ä¸æ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\næåæ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\nçäºæ¶å°å½åç¶æï¼ä»å¤©ä¸é¨\n======= å¤©æ°ä¸»é¢åå¸æ°æ¶æ¯ =======\nå¼ ä¸æ¶å°å½åç¶æï¼æå¤©å¤©æ´\nçäºæ¶å°å½åç¶æï¼æå¤©å¤©æ´\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è§å¯èæ¨¡å¼åè®¸ææ¬ç¼è¾å¨å¯¹è±¡å°èªèº«çç¶ææ¹åéç¥ç»å¶ä»æå¡å¯¹è±¡ã\n\n\n\nè®¢éèåè¡¨æ¯å¨æçæçï¼ å¯¹è±¡å¯å¨è¿è¡æ¶æ ¹æ®ç¨åºéè¦å¼å§æåæ­¢çå¬éç¥ã\n\nå¨æ¬å®ç°ä¸­ï¼ ç¼è¾å¨ç±»èªèº«å¹¶ä¸ç»´æ¤è®¢éåè¡¨ã å®å°å·¥ä½å§æ´¾ç»ä¸é¨ä»äºæ­¤å·¥ä½çä¸ä¸ªç¹æ®å¸®æå¯¹è±¡ã ä½ è¿å¯å°è¯¥å¯¹è±¡åçº§ä¸ºä¸­å¿åçäºä»¶ååå¨ï¼ åè®¸ä»»ä½å¯¹è±¡æä¸ºåå¸èã\n\nåªè¦åå¸èéè¿åæ ·çæ¥å£ä¸ææè®¢éèè¿è¡äº¤äºï¼ é£ä¹å¨ç¨åºä¸­æ°å¢è®¢éèæ¶å°±æ éä¿®æ¹å·²æåå¸èç±»çä»£ç ã\n\n// åå¸èåºç±»åå«è®¢éç®¡çä»£ç åéç¥æ¹æ³ã\nclass eventmanager is\n    private field listeners: hash map of event types and listeners\n\n    method subscribe(eventtype, listener) is\n        listeners.add(eventtype, listener)\n\n    method unsubscribe(eventtype, listener) is\n        listeners.remove(eventtype, listener)\n\n    method notify(eventtype, data) is\n        foreach (listener in listeners.of(eventtype)) do\n            listener.update(data)\n\n// å·ä½åå¸èåå«ä¸äºè®¢éèæå´è¶£çå®éä¸å¡é»è¾ãæä»¬å¯ä»¥ä»åå¸èåºç±»ä¸­æ©\n// å±åºè¯¥ç±»ï¼ä½å¨å®éæåµä¸å¹¶ä¸æ»è½åå°ï¼å ä¸ºå·ä½åå¸èå¯è½å·²ç»æ¯å­ç±»äºã\n// å¨è¿ç§æåµä¸ï¼ä½ å¯ç¨ç»åæ¥ä¿®è¡¥è®¢éé»è¾ï¼å°±åæä»¬å¨è¿éåçä¸æ ·ã\nclass editor is\n    public field events: eventmanager\n    private field file: file\n\n    constructor editor() is\n        events = new eventmanager()\n\n    // ä¸å¡é»è¾çæ¹æ³å¯å°ååéç¥ç»è®¢éèã\n    method openfile(path) is\n        this.file = new file(path)\n        events.notify("open", file.name)\n\n    method savefile() is\n        file.write()\n        events.notify("save", file.name)\n\n    // ...\n\n\n// è¿éæ¯è®¢éèæ¥å£ãå¦æä½ çç¼ç¨è¯­è¨æ¯æå½æ°ç±»åï¼åå¯ç¨ä¸ç»å½æ°æ¥ä»£æ¿æ´\n// ä¸ªè®¢éèçå±æ¬¡ç»æã\ninterface eventlistener is\n    method update(filename)\n\n// å·ä½è®¢éèä¼å¯¹å¶æ³¨åçåå¸èæååºçæ´æ°æ¶æ¯ååºååºã\nclass logginglistener implements eventlistener is\n    private field log: file\n    private field message\n\n    constructor logginglistener(log_filename, message) is\n        this.log = new file(log_filename)\n        this.message = message\n\n    method update(filename) is\n        log.write(replace(\'%s\',filename,message))\n\nclass emailalertslistener implements eventlistener is\n    private field email: string\n\n    constructor emailalertslistener(email, message) is\n        this.email = email\n        this.message = message\n\n    method update(filename) is\n        system.email(email, replace(\'%s\',filename,message))\n\n\n// åºç¨ç¨åºå¯å¨è¿è¡æ¶éç½®åå¸èåè®¢éèã\nclass application is\n    method config() is\n        editor = new editor()\n\n        logger = new logginglistener(\n            "/path/to/log.txt",\n            "æäººæå¼äºæä»¶ï¼%s");\n        editor.events.subscribe("open", logger)\n\n        emailalerts = new emailalertslistener(\n            "admin@example.com",\n            "æäººæ´æ¹äºæä»¶ï¼%s")\n        editor.events.subscribe("save", emailalerts)\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * ä¸­ä»èåè§å¯èä¹é´çåºå«å¾å¾å¾é¾è®°ä½ã å¨å¤§é¨åæåµä¸ï¼ ä½ å¯ä»¥ä½¿ç¨å¶ä¸­ä¸ç§æ¨¡å¼ï¼ èææ¶å¯ä»¥åæ¶ä½¿ç¨ã è®©æä»¬æ¥ççå¦ä½åå°è¿ä¸ç¹ã\n   * ä¸­ä»èçä¸»è¦ç®æ æ¯æ¶é¤ä¸ç³»åç³»ç»ç»ä»¶ä¹é´çç¸äºä¾èµã è¿äºç»ä»¶å°ä¾èµäºåä¸ä¸ªä¸­ä»èå¯¹è±¡ã è§å¯èçç®æ æ¯å¨å¯¹è±¡ä¹é´å»ºç«å¨æçååè¿æ¥ï¼ ä½¿å¾é¨åå¯¹è±¡å¯ä½ä¸ºå¶ä»å¯¹è±¡çéå±åæ¥ä½ç¨ã\n   * æä¸ç§æµè¡çä¸­ä»èæ¨¡å¼å®ç°æ¹å¼ä¾èµäºè§å¯èã ä¸­ä»èå¯¹è±¡æå½åå¸èçè§è²ï¼ å¶ä»ç»ä»¶åä½ä¸ºè®¢éèï¼ å¯ä»¥è®¢éä¸­ä»èçäºä»¶æåæ¶è®¢éã å½ä¸­ä»èä»¥è¿ç§æ¹å¼å®ç°æ¶ï¼ å®å¯è½çä¸å»ä¸è§å¯èéå¸¸ç¸ä¼¼ã\n   * å½ä½ æå°çææ¶ï¼ è®°ä½å¯ä»¥éç¨å¶ä»æ¹å¼æ¥å®ç°ä¸­ä»èã ä¾å¦ï¼ ä½ å¯æ°¸ä¹æ§å°å°ææç»ä»¶é¾æ¥å°åä¸ä¸ªä¸­ä»èå¯¹è±¡ã è¿ç§å®ç°æ¹å¼åè§å¯èå¹¶ä¸ç¸åï¼ ä½è¿ä»æ¯ä¸ç§ä¸­ä»èæ¨¡å¼ã\n   * åè®¾æä¸ä¸ªç¨åºï¼ å¶ææçç»ä»¶é½åæäºåå¸èï¼ å®ä»¬ä¹é´å¯ä»¥ç¸äºå»ºç«å¨æè¿æ¥ã è¿æ ·ç¨åºä¸­å°±æ²¡æä¸­å¿åçä¸­ä»èå¯¹è±¡ï¼ èåªæä¸äºåå¸å¼çè§å¯èã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è§å¯èæ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§ï¼ ç¹å«æ¯å¨ gui ç»ä»¶ä¸­ã å®æä¾äºå¨ä¸ä¸å¶ä»å¯¹è±¡æå±ç±»è¦åçæåµä¸å¯¹å¶äºä»¶ååºååºçæ¹å¼ã\n\nè¿éæ¯æ ¸å¿ java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * java.util.observer/ java.util.observable ï¼æå°å¨çå®ä¸çä¸­ä½¿ç¨ï¼\n * java.util.eventlistenerçææå®ç° ï¼å ä¹å¹¿æ³å­å¨äº swing ç»ä»¶ä¸­ï¼\n * javax.servlet.http.httpsessionbindinglistener\n * javax.servlet.http.httpsessionattributelistener\n * javax.faces.event.phaselistener\n\nè¯å«æ¹æ³ï¼ è¯¥æ¨¡å¼å¯ä»¥éè¿å°å¯¹è±¡å­å¨å¨åè¡¨ä¸­çè®¢éæ¹æ³ï¼ åå¯¹äºé¢åè¯¥åè¡¨ä¸­å¯¹è±¡çæ´æ°æ¹æ³çè°ç¨æ¥è¯å«ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹è§£éå¨æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹è§£éå¨æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-20T18:44:00.000Z",permalink:"/pages/1e0eff/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/18.%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/18.è§£éå¨æ¨¡å¼.md",key:"v-cc527b5a",path:"/pages/1e0eff/",headers:[{level:2,title:"1. ç®ä»",slug:"_1-ç®ä»",normalizedTitle:"1. ç®ä»",charIndex:17},{level:2,title:"2. å®ä¾",slug:"_2-å®ä¾",normalizedTitle:"2. å®ä¾",charIndex:1842},{level:2,title:"3. åºæ¯",slug:"_3-åºæ¯",normalizedTitle:"3. åºæ¯",charIndex:1852},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:1862}],headersStr:"1. ç®ä» 2. å®ä¾ 3. åºæ¯ 4. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹è§£éå¨æ¨¡å¼\n\n\n# 1. ç®ä»\n\nè§£éå¨æ¨¡å¼ (Interpreter) å®ä¹ä¸ä¸ªè¯­è¨ï¼å®ä¹å®çææ³çä¸ç§è¡¨ç¤ºãå¹¶å®ä¹ä¸ä¸ªè§£éå¨ï¼è¿ä¸ªè§£éå¨ä½¿ç¨è¯¥è¡¨ç¤ºæ¥è§£éè¯­è¨ä¸­çå¥å­ã\n\nè§£éå¨æ¨¡å¼æ¯ä¸ç§è¡ä¸ºåæ¨¡å¼ã\n\n\n\nContext : åå«è§£éå¨ä¹å¤çä¸äºå¨å±ä¿¡æ¯ã\n\n\nclass Context {\n    private String input;\n    private String output;\n\n    public void setInput(String input) {\n        this.input = input;\n    }\n\n    public String getInput() {\n        return this.input;\n    }\n\n    public void setOutput(String output) {\n        this.output = output;\n    }\n\n    public String getOutput() {\n        return this.output;\n    }\n}\n\n\nAbstractExpression : å£°æä¸ä¸ªæ½è±¡çè§£éæä½ï¼è¿ä¸ªæ¥å£ä¸ºæ½è±¡è¯­æ³æ ä¸­ææçèç¹æå±äº«ã\n\nabstract class AbstractExpression {\n    public abstract void Interpret(Context context);\n}\n\n\nTerminalExpression : å®ç°ä¸ææ³ä¸­çç»ç»ç¬¦ç¸å³èçè§£éæä½ãå®ç°æ½è±¡è¡¨è¾¾å¼ä¸­æè¦æ±çæ¥å£ï¼ä¸»è¦æ¯ä¸ä¸ª Interprete()æ¹æ³ã\n\nææ³ä¸­çæ¯ä¸ä¸ªç»ç»ç¬¦é½æä¸ä¸ªå·ä½ç»ç»è¡¨è¾¾å¼ä¸ä¹å¯¹åºã\n\nclass TerminalExpression extends AbstractExpression {\n    @Override\n    public void Interpret(Context context) {\n        context.setOutput("ç»ç«¯" + context.getInput());\n        System.out.println(context.getInput() + "ç»è¿ç»ç«¯è§£éå¨è§£éä¸ºï¼" + context.getOutput());\n    }\n}\n\n\nNonterminalExpression : å®ç°ä¸ææ³ä¸­çéç»ç»ç¬¦ç¸å³èçè§£éæä½ãå¯¹ææ³ä¸­çæ¯ä¸æ¡è§å R1ï¼R2......Rn é½éè¦ä¸ä¸ªå·ä½çéç»ç»ç¬¦è¡¨è¾¾å¼ç±»ãéè¿å®ç°æ½è±¡è¡¨è¾¾å¼ç Interpret æ¹æ³å®ç°è§£éæä½ã\n\nclass NonterminalExpression extends AbstractExpression {\n    @Override\n    public void Interpret(Context context) {\n        context.setOutput("éç»ç«¯" + context.getInput());\n        System.out.println(context.getInput() + "ç»è¿éç»ç«¯è§£éå¨è§£éä¸ºï¼" + context.getOutput());\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class InterpreterPattern {\n    public static void main(String[] args) {\n        Context context = new Context();\n        context.setInput("ABC");\n\n        AbstractExpression expression1 = new TerminalExpression();\n        expression1.Interpret(context);\n\n        AbstractExpression expression2 = new NonterminalExpression();\n        expression2.Interpret(context);\n    }\n}\n\n\nè¾åº\n\nABCç»è¿ç»ç«¯è§£éå¨è§£éä¸ºï¼ç»ç«¯ABC\nABCç»è¿éç»ç«¯è§£éå¨è§£éä¸ºï¼éç»ç«¯ABC\n\n\n\n# 2. å®ä¾\n\n\n# 3. åºæ¯\n\n\n# 4. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹è§£éå¨æ¨¡å¼\n\n\n# 1. ç®ä»\n\nè§£éå¨æ¨¡å¼ (interpreter) å®ä¹ä¸ä¸ªè¯­è¨ï¼å®ä¹å®çææ³çä¸ç§è¡¨ç¤ºãå¹¶å®ä¹ä¸ä¸ªè§£éå¨ï¼è¿ä¸ªè§£éå¨ä½¿ç¨è¯¥è¡¨ç¤ºæ¥è§£éè¯­è¨ä¸­çå¥å­ã\n\nè§£éå¨æ¨¡å¼æ¯ä¸ç§è¡ä¸ºåæ¨¡å¼ã\n\n\n\ncontext : åå«è§£éå¨ä¹å¤çä¸äºå¨å±ä¿¡æ¯ã\n\n\nclass context {\n    private string input;\n    private string output;\n\n    public void setinput(string input) {\n        this.input = input;\n    }\n\n    public string getinput() {\n        return this.input;\n    }\n\n    public void setoutput(string output) {\n        this.output = output;\n    }\n\n    public string getoutput() {\n        return this.output;\n    }\n}\n\n\nabstractexpression : å£°æä¸ä¸ªæ½è±¡çè§£éæä½ï¼è¿ä¸ªæ¥å£ä¸ºæ½è±¡è¯­æ³æ ä¸­ææçèç¹æå±äº«ã\n\nabstract class abstractexpression {\n    public abstract void interpret(context context);\n}\n\n\nterminalexpression : å®ç°ä¸ææ³ä¸­çç»ç»ç¬¦ç¸å³èçè§£éæä½ãå®ç°æ½è±¡è¡¨è¾¾å¼ä¸­æè¦æ±çæ¥å£ï¼ä¸»è¦æ¯ä¸ä¸ª interprete()æ¹æ³ã\n\nææ³ä¸­çæ¯ä¸ä¸ªç»ç»ç¬¦é½æä¸ä¸ªå·ä½ç»ç»è¡¨è¾¾å¼ä¸ä¹å¯¹åºã\n\nclass terminalexpression extends abstractexpression {\n    @override\n    public void interpret(context context) {\n        context.setoutput("ç»ç«¯" + context.getinput());\n        system.out.println(context.getinput() + "ç»è¿ç»ç«¯è§£éå¨è§£éä¸ºï¼" + context.getoutput());\n    }\n}\n\n\nnonterminalexpression : å®ç°ä¸ææ³ä¸­çéç»ç»ç¬¦ç¸å³èçè§£éæä½ãå¯¹ææ³ä¸­çæ¯ä¸æ¡è§å r1ï¼r2......rn é½éè¦ä¸ä¸ªå·ä½çéç»ç»ç¬¦è¡¨è¾¾å¼ç±»ãéè¿å®ç°æ½è±¡è¡¨è¾¾å¼ç interpret æ¹æ³å®ç°è§£éæä½ã\n\nclass nonterminalexpression extends abstractexpression {\n    @override\n    public void interpret(context context) {\n        context.setoutput("éç»ç«¯" + context.getinput());\n        system.out.println(context.getinput() + "ç»è¿éç»ç«¯è§£éå¨è§£éä¸ºï¼" + context.getoutput());\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class interpreterpattern {\n    public static void main(string[] args) {\n        context context = new context();\n        context.setinput("abc");\n\n        abstractexpression expression1 = new terminalexpression();\n        expression1.interpret(context);\n\n        abstractexpression expression2 = new nonterminalexpression();\n        expression2.interpret(context);\n    }\n}\n\n\nè¾åº\n\nabcç»è¿ç»ç«¯è§£éå¨è§£éä¸ºï¼ç»ç«¯abc\nabcç»è¿éç»ç«¯è§£éå¨è§£éä¸ºï¼éç»ç«¯abc\n\n\n\n# 2. å®ä¾\n\n\n# 3. åºæ¯\n\n\n# 4. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ä¸­ä»èæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ä¸­ä»èæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-22T13:34:00.000Z",permalink:"/pages/b5886f/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/19.%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/19.ä¸­ä»èæ¨¡å¼.md",key:"v-04ae6228",path:"/pages/b5886f/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:111},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:255},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:267},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:733},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:3077},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5142},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:5955},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:6321}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ä¸­ä»èæ¨¡å¼\n\n\n# 1. æå¾\n\nä¸­ä»èæ¨¡å¼ï¼Mediatorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è½è®©ä½ åå°å¯¹è±¡ä¹é´æ··ä¹±æ åºçä¾èµå³ç³»ã è¯¥æ¨¡å¼ä¼éå¶å¯¹è±¡ä¹é´çç´æ¥äº¤äºï¼ è¿«ä½¿å®ä»¬éè¿ä¸ä¸ªä¸­ä»èå¯¹è±¡è¿è¡åä½ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä¸äºå¯¹è±¡åå¶ä»å¯¹è±¡ç´§å¯è¦åä»¥è´é¾ä»¥å¯¹å¶è¿è¡ä¿®æ¹æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n * å½ç»ä»¶å è¿äºä¾èµå¶ä»ç»ä»¶èæ æ³å¨ä¸ååºç¨ä¸­å¤ç¨æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n * å¦æä¸ºäºè½å¨ä¸åææ¯ä¸å¤ç¨ä¸äºåºæ¬è¡ä¸ºï¼ å¯¼è´ä½ éè¦è¢«è¿«åå»ºå¤§éç»ä»¶å­ç±»æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. ç»ä»¶ ï¼Componentï¼ æ¯åç§åå«ä¸å¡é»è¾çç±»ã æ¯ä¸ªç»ä»¶é½æä¸ä¸ªæåä¸­ä»èçå¼ç¨ï¼ è¯¥å¼ç¨è¢«å£°æä¸ºä¸­ä»èæ¥å£ç±»åã ç»ä»¶ä¸ç¥éä¸­ä»èå®éæå±çç±»ï¼ å æ­¤ä½ å¯éè¿å°å¶è¿æ¥å°ä¸åçä¸­ä»èä»¥ä½¿å¶è½å¨å¶ä»ç¨åºä¸­å¤ç¨ã\n 2. ä¸­ä»è ï¼Mediatorï¼ æ¥å£å£°æäºä¸ç»ä»¶äº¤æµçæ¹æ³ï¼ ä½éå¸¸ä»åæ¬ä¸ä¸ªéç¥æ¹æ³ã ç»ä»¶å¯å°ä»»æä¸ä¸æ ï¼åæ¬èªå·±çå¯¹è±¡ï¼ ä½ä¸ºè¯¥æ¹æ³çåæ°ï¼ åªæè¿æ ·æ¥æ¶ç»ä»¶ååéèç±»ä¹é´æä¸ä¼è¦åã\n 3. å·ä½ä¸­ä»è ï¼Concrete Mediatorï¼ å°è£äºå¤ç§ç»ä»¶é´çå³ç³»ã å·ä½ä¸­ä»èéå¸¸ä¼ä¿å­ææç»ä»¶çå¼ç¨å¹¶å¯¹å¶è¿è¡ç®¡çï¼ çè³ææ¶ä¼å¯¹å¶çå½å¨æè¿è¡ç®¡çã\n 4. ç»ä»¶å¹¶ä¸ç¥éå¶ä»ç»ä»¶çæåµã å¦æç»ä»¶ååçäºéè¦äºä»¶ï¼ å®åªè½éç¥ä¸­ä»èã ä¸­ä»èæ¶å°éç¥åè½è½»æå°ç¡®å®åéèï¼ è¿æè®¸å·²è¶³ä»¥å¤æ­æ¥ä¸æ¥éè¦è§¦åçç»ä»¶äºã\n    * å¯¹äºç»ä»¶æ¥è¯´ï¼ ä¸­ä»èçä¸å»å®å¨å°±æ¯ä¸ä¸ªé»ç®±ã åéèä¸ç¥éæç»ä¼ç±è°æ¥å¤çèªå·±çè¯·æ±ï¼ æ¥æ¶èä¹ä¸ç¥éæåæ¯è°ååºäºè¯·æ±ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nMediator : ä¸º Colleague å¯¹è±¡å®ä¹ä¸ä¸ªäº¤æµæ¥å£ã\n\nabstract class Mediator {\n    public abstract void Send(String message, Colleague colleague);\n}\n\n\nConcreteMediator : å®ç° Mediator ä¸­çäº¤æµæ¥å£ã è¿ä¸ªç±»ä¸­éè¦äºè§£å¹¶ç»´æ¤ææç colleague å¯¹è±¡ã\n\nclass ConcreteMediator extends Mediator {\n    private ConcreteColleague1 colleague1;\n    private ConcreteColleague2 colleague2;\n\n    public void setColleague1(ConcreteColleague1 colleague1) {\n        this.colleague1 = colleague1;\n    }\n\n    public void setColleague2(ConcreteColleague2 colleague2) {\n        this.colleague2 = colleague2;\n    }\n\n    @Override\n    public void Send(String message, Colleague colleague) {\n        if (colleague == colleague1) {\n            colleague2.Notify(message);\n        } else if (colleague == colleague2){\n            colleague1.Notify(message);\n        } else {\n            System.out.println("Error!");\n        }\n    }\n}\n\n\nColleague ç» : æ¯ä¸ª Colleague å¯¹è±¡åºè¯¥ç¥éå®ç Mediator å¯¹è±¡ï¼ä½ä¸ç¥éå¶ä»åäºå¯¹è±¡ãå®åªè½èç³» Mediator å¯¹è±¡ã\n\nabstract class Colleague {\n    protected Mediator mediator;\n\n    public Colleague(Mediator mediator) {\n        this.mediator = mediator;\n    }\n\n    public void Send(String message) {\n        mediator.Send(message, this);\n    }\n\n    public abstract void Notify(String message);\n}\n\nclass ConcreteColleague1 extends Colleague {\n    public ConcreteColleague1(Mediator mediator) {\n        super(mediator);\n    }\n\n    @Override\n    public void Notify(String message) {\n        System.out.println("åäº1å¾å°ä¿¡æ¯ï¼" + message);\n    }\n}\n\nclass ConcreteColleague2 extends Colleague {\n    public ConcreteColleague2(Mediator mediator) {\n        super(mediator);\n    }\n\n    @Override\n    public void Notify(String message) {\n        System.out.println("åäº2å¾å°ä¿¡æ¯ï¼" + message);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class MediatorPattern {\n    public static void main(String[] args) {\n        ConcreteMediator mediator = new ConcreteMediator();\n        ConcreteColleague1 colleague1 = new ConcreteColleague1(mediator);\n        ConcreteColleague2 colleague2 = new ConcreteColleague2(mediator);\n\n        mediator.setColleague1(colleague1);\n        mediator.setColleague2(colleague2);\n\n        colleague1.Send("How are you?");\n        colleague2.Send("Fine, thank you. And you?");\n        colleague1.Send("I\'m fine. Thankes.");\n    }\n}\n\n\nè¾åº\n\nåäº2å¾å°ä¿¡æ¯ï¼How are you?\nåäº1å¾å°ä¿¡æ¯ï¼Fine, thank you. And you?\nåäº2å¾å°ä¿¡æ¯ï¼I\'m fine. Thankes.\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ä¸­ä»èæ¨¡å¼å¯å¸®å©ä½ åå°åç§ UI ç±» ï¼æé®ã å¤éæ¡åææ¬æ ç­¾ï¼ ä¹é´çç¸äºä¾èµå³ç³»ã\n\n\n\nç¨æ·è§¦åçåç´ ä¸ä¼ç´æ¥ä¸å¶ä»åç´ äº¤æµï¼ å³ä½¿çä¸å»å®ä»¬åºè¯¥è¿æ ·åã ç¸åï¼ åç´ åªéè®©ä¸­ä»èç¥æäºä»¶å³å¯ï¼ å¹¶è½å¨ååºéç¥æ¶åæ¶ä¼ éä»»ä½ä¸ä¸æä¿¡æ¯ã\n\næ¬ä¾ä¸­çä¸­ä»èæ¯æ´ä¸ªè®¤è¯å¯¹è¯æ¡ã å¯¹è¯æ¡ç¥éå·ä½åç´ åºå¦ä½è¿è¡åä½å¹¶ä¿è¿å®ä»¬çé´æ¥äº¤æµã å½æ¥æ¶å°äºä»¶éç¥åï¼ å¯¹è¯æ¡ä¼ç¡®å®è´è´£å¤çäºä»¶çåç´ å¹¶æ®æ­¤éå®åè¯·æ±ã\n\n// ä¸­ä»èæ¥å£å£°æäºä¸ä¸ªè½è®©ç»ä»¶å°åç§äºä»¶éç¥ç»ä¸­ä»èçæ¹æ³ãä¸­ä»èå¯å¯¹è¿\n// äºäºä»¶ååºååºå¹¶å°æ§è¡å·¥ä½ä¼ éç»å¶ä»ç»ä»¶ã\ninterface Mediator is\n    method notify(sender: Component, event: string)\n\n\n// å·ä½ä¸­ä»èç±»å¯è§£å¼åç»ä»¶ä¹é´ç¸äºäº¤åçè¿æ¥å³ç³»å¹¶å°å¶è½¬ç§»å°ä¸­ä»èä¸­ã\nclass AuthenticationDialog implements Mediator is\n    private field title: string\n    private field loginOrRegisterChkBx: Checkbox\n    private field loginUsername, loginPassword: Textbox\n    private field registrationUsername, registrationPassword,\n                  registrationEmail: Textbox\n    private field okBtn, cancelBtn: Button\n\n    constructor AuthenticationDialog() is\n        // åå»ºææç»ä»¶å¯¹è±¡å¹¶å°å½åä¸­ä»èä¼ éç»å¶æé å½æ°ä»¥å»ºç«è¿æ¥ã\n\n    // å½ç»ä»¶ä¸­æäºä»¶åçæ¶ï¼å®ä¼éç¥ä¸­ä»èãä¸­ä»èæ¥æ¶å°éç¥åå¯èªè¡å¤çï¼\n    // ä¹å¯å°è¯·æ±ä¼ éç»å¦ä¸ä¸ªç»ä»¶ã\n    method notify(sender, event) is\n        if (sender == loginOrRegisterChkBx and event == "check")\n            if (loginOrRegisterChkBx.checked)\n                title = "ç»å½"\n                // 1. æ¾ç¤ºç»å½è¡¨åç»ä»¶ã\n                // 2. éèæ³¨åè¡¨åç»ä»¶ã\n            else\n                title = "æ³¨å"\n                // 1. æ¾ç¤ºæ³¨åè¡¨åç»ä»¶ã\n                // 2. éèç»å½è¡¨åç»ä»¶ã\n\n        if (sender == okBtn && event == "click")\n            if (loginOrRegister.checked)\n                // å°è¯æ¾å°ä½¿ç¨ç»å½ä¿¡æ¯çç¨æ·ã\n                if (!found)\n                    // å¨ç»å½å­æ®µä¸æ¹æ¾ç¤ºéè¯¯ä¿¡æ¯ã\n            else\n                // 1. ä½¿ç¨æ³¨åå­æ®µä¸­çæ°æ®åå»ºç¨æ·è´¦å·ã\n                // 2. å®æç¨æ·ç»å½å·¥ä½ã â¦\n\n\n// ç»ä»¶ä¼ä½¿ç¨ä¸­ä»èæ¥å£ä¸ä¸­ä»èè¿è¡äº¤äºãå æ­¤åªéå°å®ä»¬ä¸ä¸åçä¸­ä»èè¿æ¥\n// èµ·æ¥ï¼ä½ å°±è½å¨å¶ä»æå¢ä¸­ä½¿ç¨è¿äºç»ä»¶äºã\nclass Component is\n    field dialog: Mediator\n\n    constructor Component(dialog) is\n        this.dialog = dialog\n\n    method click() is\n        dialog.notify(this, "click")\n\n    method keypress() is\n        dialog.notify(this, "keypress")\n\n// å·ä½ç»ä»¶ä¹é´æ æ³è¿è¡äº¤æµãå®ä»¬åªæä¸ä¸ªäº¤æµæ¸ éï¼é£å°±æ¯åä¸­ä»èåééç¥ã\nclass Button extends Component is\n    // ...\n\nclass Textbox extends Component is\n    // ...\n\nclass Checkbox extends Component is\n    method check() is\n        dialog.notify(this, "check")\n    // ...\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * å¤è§æ¨¡å¼åä¸­ä»èçèè´£ç±»ä¼¼ï¼ å®ä»¬é½å°è¯å¨å¤§éç´§å¯è¦åçç±»ä¸­ç»ç»èµ·åä½ã\n   * å¤è§ä¸ºå­ç³»ç»ä¸­çææå¯¹è±¡å®ä¹äºä¸ä¸ªç®åæ¥å£ï¼ ä½æ¯å®ä¸æä¾ä»»ä½æ°åè½ã å­ç³»ç»æ¬èº«ä¸ä¼æè¯å°å¤è§çå­å¨ã å­ç³»ç»ä¸­çå¯¹è±¡å¯ä»¥ç´æ¥è¿è¡äº¤æµã\n   * ä¸­ä»èå°ç³»ç»ä¸­ç»ä»¶çæ²éè¡ä¸ºä¸­å¿åã åç»ä»¶åªç¥éä¸­ä»èå¯¹è±¡ï¼ æ æ³ç´æ¥ç¸äºäº¤æµã\n * ä¸­ä»èåè§å¯èä¹é´çåºå«å¾å¾å¾é¾è®°ä½ã å¨å¤§é¨åæåµä¸ï¼ ä½ å¯ä»¥ä½¿ç¨å¶ä¸­ä¸ç§æ¨¡å¼ï¼ èææ¶å¯ä»¥åæ¶ä½¿ç¨ã è®©æä»¬æ¥ççå¦ä½åå°è¿ä¸ç¹ã\n   * ä¸­ä»èçä¸»è¦ç®æ æ¯æ¶é¤ä¸ç³»åç³»ç»ç»ä»¶ä¹é´çç¸äºä¾èµã è¿äºç»ä»¶å°ä¾èµäºåä¸ä¸ªä¸­ä»èå¯¹è±¡ã è§å¯èçç®æ æ¯å¨å¯¹è±¡ä¹é´å»ºç«å¨æçååè¿æ¥ï¼ ä½¿å¾é¨åå¯¹è±¡å¯ä½ä¸ºå¶ä»å¯¹è±¡çéå±åæ¥ä½ç¨ã\n   * æä¸ç§æµè¡çä¸­ä»èæ¨¡å¼å®ç°æ¹å¼ä¾èµäºè§å¯èã ä¸­ä»èå¯¹è±¡æå½åå¸èçè§è²ï¼ å¶ä»ç»ä»¶åä½ä¸ºè®¢éèï¼ å¯ä»¥è®¢éä¸­ä»èçäºä»¶æåæ¶è®¢éã å½ä¸­ä»èä»¥è¿ç§æ¹å¼å®ç°æ¶ï¼ å®å¯è½çä¸å»ä¸è§å¯èéå¸¸ç¸ä¼¼ã\n   * å½ä½ æå°çææ¶ï¼ è®°ä½å¯ä»¥éç¨å¶ä»æ¹å¼æ¥å®ç°ä¸­ä»èã ä¾å¦ï¼ ä½ å¯æ°¸ä¹æ§å°å°ææç»ä»¶é¾æ¥å°åä¸ä¸ªä¸­ä»èå¯¹è±¡ã è¿ç§å®ç°æ¹å¼åè§å¯èå¹¶ä¸ç¸åï¼ ä½è¿ä»æ¯ä¸ç§ä¸­ä»èæ¨¡å¼ã\n   * åè®¾æä¸ä¸ªç¨åºï¼ å¶ææçç»ä»¶é½åæäºåå¸èï¼ å®ä»¬ä¹é´å¯ä»¥ç¸äºå»ºç«å¨æè¿æ¥ã è¿æ ·ç¨åºä¸­å°±æ²¡æä¸­å¿åçä¸­ä»èå¯¹è±¡ï¼ èåªæä¸äºåå¸å¼çè§å¯èã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ä¸­ä»èæ¨¡å¼å¨ Java ä»£ç ä¸­æå¸¸ç¨äºå¸®å©ç¨åº GUI ç»ä»¶ä¹é´çéä¿¡ã å¨ MVC æ¨¡å¼ä¸­ï¼ æ§å¶å¨æ¯ä¸­ä»èçåä¹è¯ã\n\nä¸é¢æ¯æ ¸å¿ Java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * java.util.Timer ï¼ææ scheduleÂ­XXX()æ¹æ³ï¼\n * java.util.concurrent.Executor#execute()\n * java.util.concurrent.ExecutorService ï¼ invokeÂ­XXX()å submitÂ­()æ¹æ³ï¼\n * java.util.concurrent.ScheduledExecutorService ï¼ææ scheduleÂ­XXX()æ¹æ³ï¼\n * java.lang.reflect.Method#invoke()\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ä¸­ä»èæ¨¡å¼\n\n\n# 1. æå¾\n\nä¸­ä»èæ¨¡å¼ï¼mediatorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è½è®©ä½ åå°å¯¹è±¡ä¹é´æ··ä¹±æ åºçä¾èµå³ç³»ã è¯¥æ¨¡å¼ä¼éå¶å¯¹è±¡ä¹é´çç´æ¥äº¤äºï¼ è¿«ä½¿å®ä»¬éè¿ä¸ä¸ªä¸­ä»èå¯¹è±¡è¿è¡åä½ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä¸äºå¯¹è±¡åå¶ä»å¯¹è±¡ç´§å¯è¦åä»¥è´é¾ä»¥å¯¹å¶è¿è¡ä¿®æ¹æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n * å½ç»ä»¶å è¿äºä¾èµå¶ä»ç»ä»¶èæ æ³å¨ä¸ååºç¨ä¸­å¤ç¨æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n * å¦æä¸ºäºè½å¨ä¸åææ¯ä¸å¤ç¨ä¸äºåºæ¬è¡ä¸ºï¼ å¯¼è´ä½ éè¦è¢«è¿«åå»ºå¤§éç»ä»¶å­ç±»æ¶ï¼ å¯ä½¿ç¨ä¸­ä»èæ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n\n\n# 3.1. ç»æè¯´æ\n\n 1. ç»ä»¶ ï¼componentï¼ æ¯åç§åå«ä¸å¡é»è¾çç±»ã æ¯ä¸ªç»ä»¶é½æä¸ä¸ªæåä¸­ä»èçå¼ç¨ï¼ è¯¥å¼ç¨è¢«å£°æä¸ºä¸­ä»èæ¥å£ç±»åã ç»ä»¶ä¸ç¥éä¸­ä»èå®éæå±çç±»ï¼ å æ­¤ä½ å¯éè¿å°å¶è¿æ¥å°ä¸åçä¸­ä»èä»¥ä½¿å¶è½å¨å¶ä»ç¨åºä¸­å¤ç¨ã\n 2. ä¸­ä»è ï¼mediatorï¼ æ¥å£å£°æäºä¸ç»ä»¶äº¤æµçæ¹æ³ï¼ ä½éå¸¸ä»åæ¬ä¸ä¸ªéç¥æ¹æ³ã ç»ä»¶å¯å°ä»»æä¸ä¸æ ï¼åæ¬èªå·±çå¯¹è±¡ï¼ ä½ä¸ºè¯¥æ¹æ³çåæ°ï¼ åªæè¿æ ·æ¥æ¶ç»ä»¶ååéèç±»ä¹é´æä¸ä¼è¦åã\n 3. å·ä½ä¸­ä»è ï¼concrete mediatorï¼ å°è£äºå¤ç§ç»ä»¶é´çå³ç³»ã å·ä½ä¸­ä»èéå¸¸ä¼ä¿å­ææç»ä»¶çå¼ç¨å¹¶å¯¹å¶è¿è¡ç®¡çï¼ çè³ææ¶ä¼å¯¹å¶çå½å¨æè¿è¡ç®¡çã\n 4. ç»ä»¶å¹¶ä¸ç¥éå¶ä»ç»ä»¶çæåµã å¦æç»ä»¶ååçäºéè¦äºä»¶ï¼ å®åªè½éç¥ä¸­ä»èã ä¸­ä»èæ¶å°éç¥åè½è½»æå°ç¡®å®åéèï¼ è¿æè®¸å·²è¶³ä»¥å¤æ­æ¥ä¸æ¥éè¦è§¦åçç»ä»¶äºã\n    * å¯¹äºç»ä»¶æ¥è¯´ï¼ ä¸­ä»èçä¸å»å®å¨å°±æ¯ä¸ä¸ªé»ç®±ã åéèä¸ç¥éæç»ä¼ç±è°æ¥å¤çèªå·±çè¯·æ±ï¼ æ¥æ¶èä¹ä¸ç¥éæåæ¯è°ååºäºè¯·æ±ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nmediator : ä¸º colleague å¯¹è±¡å®ä¹ä¸ä¸ªäº¤æµæ¥å£ã\n\nabstract class mediator {\n    public abstract void send(string message, colleague colleague);\n}\n\n\nconcretemediator : å®ç° mediator ä¸­çäº¤æµæ¥å£ã è¿ä¸ªç±»ä¸­éè¦äºè§£å¹¶ç»´æ¤ææç colleague å¯¹è±¡ã\n\nclass concretemediator extends mediator {\n    private concretecolleague1 colleague1;\n    private concretecolleague2 colleague2;\n\n    public void setcolleague1(concretecolleague1 colleague1) {\n        this.colleague1 = colleague1;\n    }\n\n    public void setcolleague2(concretecolleague2 colleague2) {\n        this.colleague2 = colleague2;\n    }\n\n    @override\n    public void send(string message, colleague colleague) {\n        if (colleague == colleague1) {\n            colleague2.notify(message);\n        } else if (colleague == colleague2){\n            colleague1.notify(message);\n        } else {\n            system.out.println("error!");\n        }\n    }\n}\n\n\ncolleague ç» : æ¯ä¸ª colleague å¯¹è±¡åºè¯¥ç¥éå®ç mediator å¯¹è±¡ï¼ä½ä¸ç¥éå¶ä»åäºå¯¹è±¡ãå®åªè½èç³» mediator å¯¹è±¡ã\n\nabstract class colleague {\n    protected mediator mediator;\n\n    public colleague(mediator mediator) {\n        this.mediator = mediator;\n    }\n\n    public void send(string message) {\n        mediator.send(message, this);\n    }\n\n    public abstract void notify(string message);\n}\n\nclass concretecolleague1 extends colleague {\n    public concretecolleague1(mediator mediator) {\n        super(mediator);\n    }\n\n    @override\n    public void notify(string message) {\n        system.out.println("åäº1å¾å°ä¿¡æ¯ï¼" + message);\n    }\n}\n\nclass concretecolleague2 extends colleague {\n    public concretecolleague2(mediator mediator) {\n        super(mediator);\n    }\n\n    @override\n    public void notify(string message) {\n        system.out.println("åäº2å¾å°ä¿¡æ¯ï¼" + message);\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class mediatorpattern {\n    public static void main(string[] args) {\n        concretemediator mediator = new concretemediator();\n        concretecolleague1 colleague1 = new concretecolleague1(mediator);\n        concretecolleague2 colleague2 = new concretecolleague2(mediator);\n\n        mediator.setcolleague1(colleague1);\n        mediator.setcolleague2(colleague2);\n\n        colleague1.send("how are you?");\n        colleague2.send("fine, thank you. and you?");\n        colleague1.send("i\'m fine. thankes.");\n    }\n}\n\n\nè¾åº\n\nåäº2å¾å°ä¿¡æ¯ï¼how are you?\nåäº1å¾å°ä¿¡æ¯ï¼fine, thank you. and you?\nåäº2å¾å°ä¿¡æ¯ï¼i\'m fine. thankes.\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ä¸­ä»èæ¨¡å¼å¯å¸®å©ä½ åå°åç§ ui ç±» ï¼æé®ã å¤éæ¡åææ¬æ ç­¾ï¼ ä¹é´çç¸äºä¾èµå³ç³»ã\n\n\n\nç¨æ·è§¦åçåç´ ä¸ä¼ç´æ¥ä¸å¶ä»åç´ äº¤æµï¼ å³ä½¿çä¸å»å®ä»¬åºè¯¥è¿æ ·åã ç¸åï¼ åç´ åªéè®©ä¸­ä»èç¥æäºä»¶å³å¯ï¼ å¹¶è½å¨ååºéç¥æ¶åæ¶ä¼ éä»»ä½ä¸ä¸æä¿¡æ¯ã\n\næ¬ä¾ä¸­çä¸­ä»èæ¯æ´ä¸ªè®¤è¯å¯¹è¯æ¡ã å¯¹è¯æ¡ç¥éå·ä½åç´ åºå¦ä½è¿è¡åä½å¹¶ä¿è¿å®ä»¬çé´æ¥äº¤æµã å½æ¥æ¶å°äºä»¶éç¥åï¼ å¯¹è¯æ¡ä¼ç¡®å®è´è´£å¤çäºä»¶çåç´ å¹¶æ®æ­¤éå®åè¯·æ±ã\n\n// ä¸­ä»èæ¥å£å£°æäºä¸ä¸ªè½è®©ç»ä»¶å°åç§äºä»¶éç¥ç»ä¸­ä»èçæ¹æ³ãä¸­ä»èå¯å¯¹è¿\n// äºäºä»¶ååºååºå¹¶å°æ§è¡å·¥ä½ä¼ éç»å¶ä»ç»ä»¶ã\ninterface mediator is\n    method notify(sender: component, event: string)\n\n\n// å·ä½ä¸­ä»èç±»å¯è§£å¼åç»ä»¶ä¹é´ç¸äºäº¤åçè¿æ¥å³ç³»å¹¶å°å¶è½¬ç§»å°ä¸­ä»èä¸­ã\nclass authenticationdialog implements mediator is\n    private field title: string\n    private field loginorregisterchkbx: checkbox\n    private field loginusername, loginpassword: textbox\n    private field registrationusername, registrationpassword,\n                  registrationemail: textbox\n    private field okbtn, cancelbtn: button\n\n    constructor authenticationdialog() is\n        // åå»ºææç»ä»¶å¯¹è±¡å¹¶å°å½åä¸­ä»èä¼ éç»å¶æé å½æ°ä»¥å»ºç«è¿æ¥ã\n\n    // å½ç»ä»¶ä¸­æäºä»¶åçæ¶ï¼å®ä¼éç¥ä¸­ä»èãä¸­ä»èæ¥æ¶å°éç¥åå¯èªè¡å¤çï¼\n    // ä¹å¯å°è¯·æ±ä¼ éç»å¦ä¸ä¸ªç»ä»¶ã\n    method notify(sender, event) is\n        if (sender == loginorregisterchkbx and event == "check")\n            if (loginorregisterchkbx.checked)\n                title = "ç»å½"\n                // 1. æ¾ç¤ºç»å½è¡¨åç»ä»¶ã\n                // 2. éèæ³¨åè¡¨åç»ä»¶ã\n            else\n                title = "æ³¨å"\n                // 1. æ¾ç¤ºæ³¨åè¡¨åç»ä»¶ã\n                // 2. éèç»å½è¡¨åç»ä»¶ã\n\n        if (sender == okbtn && event == "click")\n            if (loginorregister.checked)\n                // å°è¯æ¾å°ä½¿ç¨ç»å½ä¿¡æ¯çç¨æ·ã\n                if (!found)\n                    // å¨ç»å½å­æ®µä¸æ¹æ¾ç¤ºéè¯¯ä¿¡æ¯ã\n            else\n                // 1. ä½¿ç¨æ³¨åå­æ®µä¸­çæ°æ®åå»ºç¨æ·è´¦å·ã\n                // 2. å®æç¨æ·ç»å½å·¥ä½ã â¦\n\n\n// ç»ä»¶ä¼ä½¿ç¨ä¸­ä»èæ¥å£ä¸ä¸­ä»èè¿è¡äº¤äºãå æ­¤åªéå°å®ä»¬ä¸ä¸åçä¸­ä»èè¿æ¥\n// èµ·æ¥ï¼ä½ å°±è½å¨å¶ä»æå¢ä¸­ä½¿ç¨è¿äºç»ä»¶äºã\nclass component is\n    field dialog: mediator\n\n    constructor component(dialog) is\n        this.dialog = dialog\n\n    method click() is\n        dialog.notify(this, "click")\n\n    method keypress() is\n        dialog.notify(this, "keypress")\n\n// å·ä½ç»ä»¶ä¹é´æ æ³è¿è¡äº¤æµãå®ä»¬åªæä¸ä¸ªäº¤æµæ¸ éï¼é£å°±æ¯åä¸­ä»èåééç¥ã\nclass button extends component is\n    // ...\n\nclass textbox extends component is\n    // ...\n\nclass checkbox extends component is\n    method check() is\n        dialog.notify(this, "check")\n    // ...\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n * å¤è§æ¨¡å¼åä¸­ä»èçèè´£ç±»ä¼¼ï¼ å®ä»¬é½å°è¯å¨å¤§éç´§å¯è¦åçç±»ä¸­ç»ç»èµ·åä½ã\n   * å¤è§ä¸ºå­ç³»ç»ä¸­çææå¯¹è±¡å®ä¹äºä¸ä¸ªç®åæ¥å£ï¼ ä½æ¯å®ä¸æä¾ä»»ä½æ°åè½ã å­ç³»ç»æ¬èº«ä¸ä¼æè¯å°å¤è§çå­å¨ã å­ç³»ç»ä¸­çå¯¹è±¡å¯ä»¥ç´æ¥è¿è¡äº¤æµã\n   * ä¸­ä»èå°ç³»ç»ä¸­ç»ä»¶çæ²éè¡ä¸ºä¸­å¿åã åç»ä»¶åªç¥éä¸­ä»èå¯¹è±¡ï¼ æ æ³ç´æ¥ç¸äºäº¤æµã\n * ä¸­ä»èåè§å¯èä¹é´çåºå«å¾å¾å¾é¾è®°ä½ã å¨å¤§é¨åæåµä¸ï¼ ä½ å¯ä»¥ä½¿ç¨å¶ä¸­ä¸ç§æ¨¡å¼ï¼ èææ¶å¯ä»¥åæ¶ä½¿ç¨ã è®©æä»¬æ¥ççå¦ä½åå°è¿ä¸ç¹ã\n   * ä¸­ä»èçä¸»è¦ç®æ æ¯æ¶é¤ä¸ç³»åç³»ç»ç»ä»¶ä¹é´çç¸äºä¾èµã è¿äºç»ä»¶å°ä¾èµäºåä¸ä¸ªä¸­ä»èå¯¹è±¡ã è§å¯èçç®æ æ¯å¨å¯¹è±¡ä¹é´å»ºç«å¨æçååè¿æ¥ï¼ ä½¿å¾é¨åå¯¹è±¡å¯ä½ä¸ºå¶ä»å¯¹è±¡çéå±åæ¥ä½ç¨ã\n   * æä¸ç§æµè¡çä¸­ä»èæ¨¡å¼å®ç°æ¹å¼ä¾èµäºè§å¯èã ä¸­ä»èå¯¹è±¡æå½åå¸èçè§è²ï¼ å¶ä»ç»ä»¶åä½ä¸ºè®¢éèï¼ å¯ä»¥è®¢éä¸­ä»èçäºä»¶æåæ¶è®¢éã å½ä¸­ä»èä»¥è¿ç§æ¹å¼å®ç°æ¶ï¼ å®å¯è½çä¸å»ä¸è§å¯èéå¸¸ç¸ä¼¼ã\n   * å½ä½ æå°çææ¶ï¼ è®°ä½å¯ä»¥éç¨å¶ä»æ¹å¼æ¥å®ç°ä¸­ä»èã ä¾å¦ï¼ ä½ å¯æ°¸ä¹æ§å°å°ææç»ä»¶é¾æ¥å°åä¸ä¸ªä¸­ä»èå¯¹è±¡ã è¿ç§å®ç°æ¹å¼åè§å¯èå¹¶ä¸ç¸åï¼ ä½è¿ä»æ¯ä¸ç§ä¸­ä»èæ¨¡å¼ã\n   * åè®¾æä¸ä¸ªç¨åºï¼ å¶ææçç»ä»¶é½åæäºåå¸èï¼ å®ä»¬ä¹é´å¯ä»¥ç¸äºå»ºç«å¨æè¿æ¥ã è¿æ ·ç¨åºä¸­å°±æ²¡æä¸­å¿åçä¸­ä»èå¯¹è±¡ï¼ èåªæä¸äºåå¸å¼çè§å¯èã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ä¸­ä»èæ¨¡å¼å¨ java ä»£ç ä¸­æå¸¸ç¨äºå¸®å©ç¨åº gui ç»ä»¶ä¹é´çéä¿¡ã å¨ mvc æ¨¡å¼ä¸­ï¼ æ§å¶å¨æ¯ä¸­ä»èçåä¹è¯ã\n\nä¸é¢æ¯æ ¸å¿ java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * java.util.timer ï¼ææ scheduleÂ­xxx()æ¹æ³ï¼\n * java.util.concurrent.executor#execute()\n * java.util.concurrent.executorservice ï¼ invokeÂ­xxx()å submitÂ­()æ¹æ³ï¼\n * java.util.concurrent.scheduledexecutorservice ï¼ææ scheduleÂ­xxx()æ¹æ³ï¼\n * java.lang.reflect.method#invoke()\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹èè´£é¾æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹èè´£é¾æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-22T14:34:00.000Z",permalink:"/pages/a92964/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/20.%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/20.èè´£é¾æ¨¡å¼.md",key:"v-1a6137e8",path:"/pages/a92964/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:202},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:331},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:341},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:814},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2560},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:4754},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:5330},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:5603}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹èè´£é¾æ¨¡å¼\n\n\n# 1. æå¾\n\nèè´£é¾æ¨¡å¼ï¼Chain Of Responsibilityï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸ä½ å°è¯·æ±æ²¿çå¤çèé¾è¿è¡åéã æ¶å°è¯·æ±åï¼ æ¯ä¸ªå¤çèåå¯å¯¹è¯·æ±è¿è¡å¤çï¼ æå°å¶ä¼ éç»é¾ä¸çä¸ä¸ªå¤çèã\n\nä½¿å¤ä¸ªå¯¹è±¡é½ææºä¼å¤çè¯·æ±ï¼ä»èé¿åè¯·æ±çåéèåæ¥æ¶èä¹é´çè¦åå³ç³»ã å°è¿ä¸ªå¯¹è±¡è¿æä¸æ¡é¾ï¼å¹¶æ²¿çè¿æ¡é¾ä¼ éè¯¥è¯·æ±ï¼ç´å°æä¸ä¸ªå¯¹è±¡å¤çå®ä¸ºæ­¢ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ç¨åºéè¦ä½¿ç¨ä¸åæ¹å¼å¤çä¸åç§ç±»è¯·æ±ï¼ èä¸è¯·æ±ç±»ååé¡ºåºé¢åæªç¥æ¶ï¼ å¯ä»¥ä½¿ç¨è´£ä»»é¾æ¨¡å¼ã\n * å½å¿é¡»æé¡ºåºæ§è¡å¤ä¸ªå¤çèæ¶ï¼ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n * å¦ææéå¤çèåå¶é¡ºåºå¿é¡»å¨è¿è¡æ¶è¿è¡æ¹åï¼ å¯ä»¥ä½¿ç¨è´£ä»»é¾æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. å¤çè ï¼Handlerï¼ å£°æäºææå·ä½å¤çèçéç¨æ¥å£ã è¯¥æ¥å£éå¸¸ä»åå«åä¸ªæ¹æ³ç¨äºè¯·æ±å¤çï¼ ä½ææ¶å¶è¿ä¼åå«ä¸ä¸ªè®¾ç½®é¾ä¸ä¸ä¸ªå¤çèçæ¹æ³ã\n\n 2. åºç¡å¤çè ï¼Base Handlerï¼ æ¯ä¸ä¸ªå¯éçç±»ï¼ ä½ å¯ä»¥å°ææå¤çèå±ç¨çæ ·æ¬ä»£ç æ¾ç½®å¨å¶ä¸­ã\n    \n    éå¸¸æåµä¸ï¼ è¯¥ç±»ä¸­å®ä¹äºä¸ä¸ªä¿å­å¯¹äºä¸ä¸ªå¤çèå¼ç¨çæååéã å®¢æ·ç«¯å¯éè¿å°å¤çèä¼ éç»ä¸ä¸ªå¤çèçæé å½æ°æè®¾å®æ¹æ³æ¥åå»ºé¾ã è¯¥ç±»è¿å¯ä»¥å®ç°é»è®¤çå¤çè¡ä¸ºï¼ ç¡®å®ä¸ä¸ªå¤çèå­å¨ååå°è¯·æ±ä¼ éç»å®ã\n\n 3. å·ä½å¤çè ï¼Concrete Handlersï¼ åå«å¤çè¯·æ±çå®éä»£ç ã æ¯ä¸ªå¤çèæ¥æ¶å°è¯·æ±åï¼ é½å¿é¡»å³å®æ¯å¦è¿è¡å¤çï¼ ä»¥åæ¯å¦æ²¿çé¾ä¼ éè¯·æ±ã\n    \n    å¤çèéå¸¸æ¯ç¬ç«ä¸ä¸å¯åçï¼ éè¦éè¿æé å½æ°ä¸æ¬¡æ§å°è·å¾ææå¿è¦å°æ°æ®ã\n\n 4. å®¢æ·ç«¯ ï¼Clientï¼ å¯æ ¹æ®ç¨åºé»è¾ä¸æ¬¡æ§æèå¨æå°çæé¾ã å¼å¾æ³¨æçæ¯ï¼ è¯·æ±å¯åéç»é¾ä¸çä»»æä¸ä¸ªå¤çèï¼ èéå¿é¡»æ¯ç¬¬ä¸ä¸ªå¤çèã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nHandler : å®ä¹ä¸ä¸ªå¤çè¯·æ±çæ¥å£ãï¼å¯éçï¼å®ç°è®¾ç½®åç»§èçæ¹æ³ã\n\nabstract class Handler {\n    protected Handler successor;\n    public void SetSuccesssor(Handler successor) {\n        this.successor = successor;\n    }\n\n    public abstract void HandlerRequest(int request);\n}\n\n\nConcreteHandler : å¤çå®æè´è´£çè¯·æ±ï¼å¯ä»¥è®¿é®å®çåç»§èï¼å¦æå¯å¤çè¯¥è¯·æ±ï¼å°±å¤çä¹ï¼å¦åå°±å°è¯·æ±è½¬åç»å®çåç»§èã\n\nclass ConcreteHandler1 extends Handler {\n    @Override\n    public void HandlerRequest(int request) {\n        if (request >= 0 && request < 10) {\n            System.out.println("ConcreteHandler1 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.HandlerRequest(request);\n        }\n    }\n}\n\nclass ConcreteHandler2 extends Handler {\n    @Override\n    public void HandlerRequest(int request) {\n        if (request >= 10 && request < 20) {\n            System.out.println("ConcreteHandler2 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.HandlerRequest(request);\n        }\n    }\n}\n\nclass ConcreteHandler3 extends Handler {\n    @Override\n    public void HandlerRequest(int request) {\n        if (request >= 20 && request < 30) {\n            System.out.println("ConcreteHandler3 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.HandlerRequest(request);\n        }\n    }\n}\n\n\nClient : éè¦è®¾ç½®ä¸ä¸ªèè´£é¾çåç¯èå¯¹è±¡ä¸²èèµ·æ¥ã\n\npublic class ChainOfResponsibilityPattern {\n    public static void main(String[] args) {\n        Handler h1 = new ConcreteHandler1();\n        Handler h2 = new ConcreteHandler2();\n        Handler h3 = new ConcreteHandler3();\n        h1.SetSuccesssor(h2);\n        h2.SetSuccesssor(h3);\n\n        int[] requests = {2, 29, 9, 15, 4, 19};\n        for (int i : requests) {\n            h1.HandlerRequest(i);\n        }\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è´£ä»»é¾æ¨¡å¼è´è´£ä¸ºæ´»å¨ç GUI åç´ æ¾ç¤ºä¸ä¸æå¸®å©ä¿¡æ¯ã\n\n\n\nåºç¨ç¨åºç GUI ãéå¸¸ä¸ºå¯¹è±¡æ ç»æã ä¾å¦ï¼ è´è´£æ¸²æç¨åºä¸»çªå£ç å¯¹è¯æ¡ç±»å°±æ¯å¯¹è±¡æ çæ ¹èç¹ã å¯¹è¯æ¡åå« é¢æ¿ ï¼ èé¢æ¿å¯è½åå«å¶ä»é¢æ¿ï¼ ææ¯ æé®å ææ¬æ¡ç­ä¸å±åç´ ã\n\nåªè¦ç»ä¸ä¸ªç®åçç»ä»¶æå®å¸®å©ææ¬ï¼ å®å°±å¯æ¾ç¤ºç®ç­çä¸ä¸ææç¤ºã ä½æ´å¤æçç»ä»¶å¯èªå®ä¹ä¸ä¸æå¸®å©ææ¬çæ¾ç¤ºæ¹å¼ï¼ ä¾å¦æ¾ç¤ºæåæå½åå®¹æå¨æµè§å¨ä¸­æå¼ä¸ä¸ªç½é¡µã\n\n\n\nå½ç¨æ·å°é¼ æ æéç§»å¨å°æä¸ªåç´ å¹¶æä¸ F1é®æ¶ï¼ ç¨åºæ£æµå°æéä¸çç»ä»¶å¹¶å¯¹å¶åéå¸®å©è¯·æ±ã è¯¥è¯·æ±ä¸æ­åä¸ä¼ éå°è¯¥åç´ ææçå®¹å¨ï¼ ç´è³æä¸ªåç´ è½å¤æ¾ç¤ºå¸®å©ä¿¡æ¯ã\n\n// å¤çèæ¥å£å£°æäºä¸ä¸ªåå»ºå¤çèé¾çæ¹æ³ãè¿å£°æäºä¸ä¸ªæ§è¡è¯·æ±çæ¹æ³ã\ninterface ComponentWithContextualHelp is\n    method showHelp()\n\n\n// ç®åç»ä»¶çåºç¡ç±»ã\nabstract class Component implements ComponentWithContextualHelp is\n    field tooltipText: string\n\n    // ç»ä»¶å®¹å¨å¨å¤çèé¾ä¸­ä½ä¸ºâä¸ä¸ä¸ªâé¾æ¥ã\n    protected field container: Container\n\n    // å¦æç»ä»¶è®¾å®äºå¸®å©æå­ï¼é£å®å°ä¼æ¾ç¤ºæç¤ºä¿¡æ¯ãå¦æç»ä»¶æ²¡æå¸®å©æå­\n    // ä¸å¶å®¹å¨å­å¨ï¼é£å®ä¼å°è°ç¨ä¼ éç»å®¹å¨ã\n    method showHelp() is\n        if (tooltipText != null)\n            // æ¾ç¤ºæç¤ºä¿¡æ¯ã\n        else\n            container.showHelp()\n\n\n// å®¹å¨å¯ä»¥å°ç®åç»ä»¶åå¶ä»å®¹å¨ä½ä¸ºå¶å­é¡¹ç®ãé¾å³ç³»å°å¨è¿éå»ºç«ãè¯¥ç±»å°ä»\n// å¶ç¶ç±»å¤ç»§æ¿ showHelpï¼æ¾ç¤ºå¸®å©ï¼çè¡ä¸ºã\nabstract class Container extends Component is\n    protected field children: array of Component\n\n    method add(child) is\n        children.add(child)\n        child.container = this\n\n\n// åå§ç»ä»¶åºè¯¥è½å¤ä½¿ç¨å¸®å©æä½çé»è®¤å®ç°...\nclass Button extends Component is\n    // ...\n\n// ä½å¤æç»ä»¶å¯è½ä¼å¯¹é»è®¤å®ç°è¿è¡éåãå¦ææ æ³ä»¥æ°çæ¹å¼æ¥æä¾å¸®å©æå­ï¼\n// é£ç»ä»¶æ»æ¯è¿è½è°ç¨åºç¡å®ç°çï¼åè§ Component ç±»ï¼ã\nclass Panel extends Container is\n    field modalHelpText: string\n\n    method showHelp() is\n        if (modalHelpText != null)\n            // æ¾ç¤ºåå«å¸®å©æå­çæ¨¡æçªå£ã\n        else\n            super.showHelp()\n\n// ...åä¸...\nclass Dialog extends Container is\n    field wikiPageURL: string\n\n    method showHelp() is\n        if (wikiPageURL != null)\n            // æå¼ç¾ç§å¸®å©é¡µé¢ã\n        else\n            super.showHelp()\n\n\n// å®¢æ·ç«¯ä»£ç ã\nclass Application is\n    // æ¯ä¸ªç¨åºé½è½ä»¥ä¸åæ¹å¼å¯¹é¾è¿è¡éç½®ã\n    method createUI() is\n        dialog = new Dialog("é¢ç®æ¥å")\n        dialog.wikiPageURL = "http://..."\n        panel = new Panel(0, 0, 400, 800)\n        panel.modalHelpText = "æ¬é¢æ¿ç¨äº..."\n        ok = new Button(250, 760, 50, 20, "ç¡®è®¤")\n        ok.tooltipText = "è¿æ¯ä¸ä¸ªç¡®è®¤æé®..."\n        cancel = new Button(320, 760, 50, 20, "åæ¶")\n        // ...\n        panel.add(ok)\n        panel.add(cancel)\n        dialog.add(panel)\n\n    // æ³è±¡è¿éä¼åçä»ä¹ã\n    method onF1KeyPress() is\n        component = this.getComponentAtMouseCoords()\n        component.showHelp()\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   \n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n\n * è´£ä»»é¾éå¸¸åç»åæ¨¡å¼ç»åä½¿ç¨ã å¨è¿ç§æåµä¸ï¼ å¶ç»ä»¶æ¥æ¶å°è¯·æ±åï¼ å¯ä»¥å°è¯·æ±æ²¿åå«å¨ä½ç¶ç»ä»¶çé¾ä¸ç´ä¼ éè³å¯¹è±¡æ çåºé¨ã\n\n * è´£ä»»é¾çç®¡çèå¯ä½¿ç¨å½ä»¤æ¨¡å¼å®ç°ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±è¯·æ±ä»£è¡¨çåä¸ä¸ªä¸ä¸æå¯¹è±¡æ§è¡è®¸å¤ä¸åçæä½ã\n   \n   è¿æå¦å¤ä¸ç§å®ç°æ¹å¼ï¼ é£å°±æ¯è¯·æ±èªèº«å°±æ¯ä¸ä¸ªå½ä»¤å¯¹è±¡ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±ä¸ç³»åä¸åä¸ä¸æè¿æ¥èæçé¾æ§è¡ç¸åçæä½ã\n\n * è´£ä»»é¾åè£é¥°æ¨¡å¼çç±»ç»æéå¸¸ç¸ä¼¼ã ä¸¤èé½ä¾èµéå½ç»åå°éè¦æ§è¡çæä½ä¼ éç»ä¸ç³»åå¯¹è±¡ã ä½æ¯ï¼ ä¸¤èæå ç¹éè¦çä¸åä¹å¤ã\n   \n   è´£ä»»é¾çç®¡çèå¯ä»¥ç¸äºç¬ç«å°æ§è¡ä¸åæä½ï¼ è¿å¯ä»¥éæ¶åæ­¢ä¼ éè¯·æ±ã å¦ä¸æ¹é¢ï¼ åç§è£é¥°å¯ä»¥å¨éµå¾ªåºæ¬æ¥å£çæåµä¸æ©å±å¯¹è±¡çè¡ä¸ºã æ­¤å¤ï¼ è£é¥°æ æ³ä¸­æ­è¯·æ±çä¼ éã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è´£ä»»é¾æ¨¡å¼å¨ Java ç¨åºä¸­å¹¶ä¸å¸¸è§ï¼ å ä¸ºå®ä»å¨ä»£ç ä¸å¯¹è±¡é¾æäº¤éæ¶æè½åæ¥ä½ç¨ã\n\nè¯¥æ¨¡å¼ææµè¡çä½¿ç¨æ¡ä¾ä¹ä¸æ¯å¨ GUI ç±»ä¸­å°äºä»¶åä¸ä¼ éç»ç¶ç»ä»¶ã å¦ä¸ä¸ªå¼å¾æ³¨æçä½¿ç¨æ¡ä¾æ¯ä¾æ¬¡è®¿é®è¿æ»¤å¨ã\n\nä¸é¢æ¯è¯¥æ¨¡å¼å¨æ ¸å¿ Java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * javax.servlet.Filter#doFilter()\n * java.util.logging.Logger#log()\n\nè¯å«æ¹æ³ï¼ è¯¥æ¨¡å¼å¯éè¿ä¸ç»å¯¹è±¡çè¡ä¸ºæ¹æ³é´æ¥è°ç¨å¶ä»å¯¹è±¡çç¸åæ¹æ³æ¥è¯å«ï¼ èä¸ææå¯¹è±¡é½ä¼éµå¾ªç¸åçæ¥å£ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹èè´£é¾æ¨¡å¼\n\n\n# 1. æå¾\n\nèè´£é¾æ¨¡å¼ï¼chain of responsibilityï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸ä½ å°è¯·æ±æ²¿çå¤çèé¾è¿è¡åéã æ¶å°è¯·æ±åï¼ æ¯ä¸ªå¤çèåå¯å¯¹è¯·æ±è¿è¡å¤çï¼ æå°å¶ä¼ éç»é¾ä¸çä¸ä¸ªå¤çèã\n\nä½¿å¤ä¸ªå¯¹è±¡é½ææºä¼å¤çè¯·æ±ï¼ä»èé¿åè¯·æ±çåéèåæ¥æ¶èä¹é´çè¦åå³ç³»ã å°è¿ä¸ªå¯¹è±¡è¿æä¸æ¡é¾ï¼å¹¶æ²¿çè¿æ¡é¾ä¼ éè¯¥è¯·æ±ï¼ç´å°æä¸ä¸ªå¯¹è±¡å¤çå®ä¸ºæ­¢ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ç¨åºéè¦ä½¿ç¨ä¸åæ¹å¼å¤çä¸åç§ç±»è¯·æ±ï¼ èä¸è¯·æ±ç±»ååé¡ºåºé¢åæªç¥æ¶ï¼ å¯ä»¥ä½¿ç¨è´£ä»»é¾æ¨¡å¼ã\n * å½å¿é¡»æé¡ºåºæ§è¡å¤ä¸ªå¤çèæ¶ï¼ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n * å¦ææéå¤çèåå¶é¡ºåºå¿é¡»å¨è¿è¡æ¶è¿è¡æ¹åï¼ å¯ä»¥ä½¿ç¨è´£ä»»é¾æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. å¤çè ï¼handlerï¼ å£°æäºææå·ä½å¤çèçéç¨æ¥å£ã è¯¥æ¥å£éå¸¸ä»åå«åä¸ªæ¹æ³ç¨äºè¯·æ±å¤çï¼ ä½ææ¶å¶è¿ä¼åå«ä¸ä¸ªè®¾ç½®é¾ä¸ä¸ä¸ªå¤çèçæ¹æ³ã\n\n 2. åºç¡å¤çè ï¼base handlerï¼ æ¯ä¸ä¸ªå¯éçç±»ï¼ ä½ å¯ä»¥å°ææå¤çèå±ç¨çæ ·æ¬ä»£ç æ¾ç½®å¨å¶ä¸­ã\n    \n    éå¸¸æåµä¸ï¼ è¯¥ç±»ä¸­å®ä¹äºä¸ä¸ªä¿å­å¯¹äºä¸ä¸ªå¤çèå¼ç¨çæååéã å®¢æ·ç«¯å¯éè¿å°å¤çèä¼ éç»ä¸ä¸ªå¤çèçæé å½æ°æè®¾å®æ¹æ³æ¥åå»ºé¾ã è¯¥ç±»è¿å¯ä»¥å®ç°é»è®¤çå¤çè¡ä¸ºï¼ ç¡®å®ä¸ä¸ªå¤çèå­å¨ååå°è¯·æ±ä¼ éç»å®ã\n\n 3. å·ä½å¤çè ï¼concrete handlersï¼ åå«å¤çè¯·æ±çå®éä»£ç ã æ¯ä¸ªå¤çèæ¥æ¶å°è¯·æ±åï¼ é½å¿é¡»å³å®æ¯å¦è¿è¡å¤çï¼ ä»¥åæ¯å¦æ²¿çé¾ä¼ éè¯·æ±ã\n    \n    å¤çèéå¸¸æ¯ç¬ç«ä¸ä¸å¯åçï¼ éè¦éè¿æé å½æ°ä¸æ¬¡æ§å°è·å¾ææå¿è¦å°æ°æ®ã\n\n 4. å®¢æ·ç«¯ ï¼clientï¼ å¯æ ¹æ®ç¨åºé»è¾ä¸æ¬¡æ§æèå¨æå°çæé¾ã å¼å¾æ³¨æçæ¯ï¼ è¯·æ±å¯åéç»é¾ä¸çä»»æä¸ä¸ªå¤çèï¼ èéå¿é¡»æ¯ç¬¬ä¸ä¸ªå¤çèã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nhandler : å®ä¹ä¸ä¸ªå¤çè¯·æ±çæ¥å£ãï¼å¯éçï¼å®ç°è®¾ç½®åç»§èçæ¹æ³ã\n\nabstract class handler {\n    protected handler successor;\n    public void setsuccesssor(handler successor) {\n        this.successor = successor;\n    }\n\n    public abstract void handlerrequest(int request);\n}\n\n\nconcretehandler : å¤çå®æè´è´£çè¯·æ±ï¼å¯ä»¥è®¿é®å®çåç»§èï¼å¦æå¯å¤çè¯¥è¯·æ±ï¼å°±å¤çä¹ï¼å¦åå°±å°è¯·æ±è½¬åç»å®çåç»§èã\n\nclass concretehandler1 extends handler {\n    @override\n    public void handlerrequest(int request) {\n        if (request >= 0 && request < 10) {\n            system.out.println("concretehandler1 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.handlerrequest(request);\n        }\n    }\n}\n\nclass concretehandler2 extends handler {\n    @override\n    public void handlerrequest(int request) {\n        if (request >= 10 && request < 20) {\n            system.out.println("concretehandler2 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.handlerrequest(request);\n        }\n    }\n}\n\nclass concretehandler3 extends handler {\n    @override\n    public void handlerrequest(int request) {\n        if (request >= 20 && request < 30) {\n            system.out.println("concretehandler3 å¤çè¯·æ± " + request);\n        } else if (null != successor) {\n            successor.handlerrequest(request);\n        }\n    }\n}\n\n\nclient : éè¦è®¾ç½®ä¸ä¸ªèè´£é¾çåç¯èå¯¹è±¡ä¸²èèµ·æ¥ã\n\npublic class chainofresponsibilitypattern {\n    public static void main(string[] args) {\n        handler h1 = new concretehandler1();\n        handler h2 = new concretehandler2();\n        handler h3 = new concretehandler3();\n        h1.setsuccesssor(h2);\n        h2.setsuccesssor(h3);\n\n        int[] requests = {2, 29, 9, 15, 4, 19};\n        for (int i : requests) {\n            h1.handlerrequest(i);\n        }\n    }\n}\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è´£ä»»é¾æ¨¡å¼è´è´£ä¸ºæ´»å¨ç gui åç´ æ¾ç¤ºä¸ä¸æå¸®å©ä¿¡æ¯ã\n\n\n\nåºç¨ç¨åºç gui ãéå¸¸ä¸ºå¯¹è±¡æ ç»æã ä¾å¦ï¼ è´è´£æ¸²æç¨åºä¸»çªå£ç å¯¹è¯æ¡ç±»å°±æ¯å¯¹è±¡æ çæ ¹èç¹ã å¯¹è¯æ¡åå« é¢æ¿ ï¼ èé¢æ¿å¯è½åå«å¶ä»é¢æ¿ï¼ ææ¯ æé®å ææ¬æ¡ç­ä¸å±åç´ ã\n\nåªè¦ç»ä¸ä¸ªç®åçç»ä»¶æå®å¸®å©ææ¬ï¼ å®å°±å¯æ¾ç¤ºç®ç­çä¸ä¸ææç¤ºã ä½æ´å¤æçç»ä»¶å¯èªå®ä¹ä¸ä¸æå¸®å©ææ¬çæ¾ç¤ºæ¹å¼ï¼ ä¾å¦æ¾ç¤ºæåæå½åå®¹æå¨æµè§å¨ä¸­æå¼ä¸ä¸ªç½é¡µã\n\n\n\nå½ç¨æ·å°é¼ æ æéç§»å¨å°æä¸ªåç´ å¹¶æä¸ f1é®æ¶ï¼ ç¨åºæ£æµå°æéä¸çç»ä»¶å¹¶å¯¹å¶åéå¸®å©è¯·æ±ã è¯¥è¯·æ±ä¸æ­åä¸ä¼ éå°è¯¥åç´ ææçå®¹å¨ï¼ ç´è³æä¸ªåç´ è½å¤æ¾ç¤ºå¸®å©ä¿¡æ¯ã\n\n// å¤çèæ¥å£å£°æäºä¸ä¸ªåå»ºå¤çèé¾çæ¹æ³ãè¿å£°æäºä¸ä¸ªæ§è¡è¯·æ±çæ¹æ³ã\ninterface componentwithcontextualhelp is\n    method showhelp()\n\n\n// ç®åç»ä»¶çåºç¡ç±»ã\nabstract class component implements componentwithcontextualhelp is\n    field tooltiptext: string\n\n    // ç»ä»¶å®¹å¨å¨å¤çèé¾ä¸­ä½ä¸ºâä¸ä¸ä¸ªâé¾æ¥ã\n    protected field container: container\n\n    // å¦æç»ä»¶è®¾å®äºå¸®å©æå­ï¼é£å®å°ä¼æ¾ç¤ºæç¤ºä¿¡æ¯ãå¦æç»ä»¶æ²¡æå¸®å©æå­\n    // ä¸å¶å®¹å¨å­å¨ï¼é£å®ä¼å°è°ç¨ä¼ éç»å®¹å¨ã\n    method showhelp() is\n        if (tooltiptext != null)\n            // æ¾ç¤ºæç¤ºä¿¡æ¯ã\n        else\n            container.showhelp()\n\n\n// å®¹å¨å¯ä»¥å°ç®åç»ä»¶åå¶ä»å®¹å¨ä½ä¸ºå¶å­é¡¹ç®ãé¾å³ç³»å°å¨è¿éå»ºç«ãè¯¥ç±»å°ä»\n// å¶ç¶ç±»å¤ç»§æ¿ showhelpï¼æ¾ç¤ºå¸®å©ï¼çè¡ä¸ºã\nabstract class container extends component is\n    protected field children: array of component\n\n    method add(child) is\n        children.add(child)\n        child.container = this\n\n\n// åå§ç»ä»¶åºè¯¥è½å¤ä½¿ç¨å¸®å©æä½çé»è®¤å®ç°...\nclass button extends component is\n    // ...\n\n// ä½å¤æç»ä»¶å¯è½ä¼å¯¹é»è®¤å®ç°è¿è¡éåãå¦ææ æ³ä»¥æ°çæ¹å¼æ¥æä¾å¸®å©æå­ï¼\n// é£ç»ä»¶æ»æ¯è¿è½è°ç¨åºç¡å®ç°çï¼åè§ component ç±»ï¼ã\nclass panel extends container is\n    field modalhelptext: string\n\n    method showhelp() is\n        if (modalhelptext != null)\n            // æ¾ç¤ºåå«å¸®å©æå­çæ¨¡æçªå£ã\n        else\n            super.showhelp()\n\n// ...åä¸...\nclass dialog extends container is\n    field wikipageurl: string\n\n    method showhelp() is\n        if (wikipageurl != null)\n            // æå¼ç¾ç§å¸®å©é¡µé¢ã\n        else\n            super.showhelp()\n\n\n// å®¢æ·ç«¯ä»£ç ã\nclass application is\n    // æ¯ä¸ªç¨åºé½è½ä»¥ä¸åæ¹å¼å¯¹é¾è¿è¡éç½®ã\n    method createui() is\n        dialog = new dialog("é¢ç®æ¥å")\n        dialog.wikipageurl = "http://..."\n        panel = new panel(0, 0, 400, 800)\n        panel.modalhelptext = "æ¬é¢æ¿ç¨äº..."\n        ok = new button(250, 760, 50, 20, "ç¡®è®¤")\n        ok.tooltiptext = "è¿æ¯ä¸ä¸ªç¡®è®¤æé®..."\n        cancel = new button(320, 760, 50, 20, "åæ¶")\n        // ...\n        panel.add(ok)\n        panel.add(cancel)\n        dialog.add(panel)\n\n    // æ³è±¡è¿éä¼åçä»ä¹ã\n    method onf1keypress() is\n        component = this.getcomponentatmousecoords()\n        component.showhelp()\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * è´£ä»»é¾æ¨¡å¼ã å½ä»¤æ¨¡å¼ã ä¸­ä»èæ¨¡å¼åè§å¯èæ¨¡å¼ç¨äºå¤çè¯·æ±åéèåæ¥æ¶èä¹é´çä¸åè¿æ¥æ¹å¼ï¼\n   \n   * è´£ä»»é¾æç§é¡ºåºå°è¯·æ±å¨æä¼ éç»ä¸ç³»åçæ½å¨æ¥æ¶èï¼ ç´è³å¶ä¸­ä¸åæ¥æ¶èå¯¹è¯·æ±è¿è¡å¤çã\n   * å½ä»¤å¨åéèåè¯·æ±èä¹é´å»ºç«ååè¿æ¥ã\n   * ä¸­ä»èæ¸é¤äºåéèåè¯·æ±èä¹é´çç´æ¥è¿æ¥ï¼ å¼ºå¶å®ä»¬éè¿ä¸ä¸ªä¸­ä»å¯¹è±¡è¿è¡é´æ¥æ²éã\n   * è§å¯èåè®¸æ¥æ¶èå¨æå°è®¢éæåæ¶æ¥æ¶è¯·æ±ã\n\n * è´£ä»»é¾éå¸¸åç»åæ¨¡å¼ç»åä½¿ç¨ã å¨è¿ç§æåµä¸ï¼ å¶ç»ä»¶æ¥æ¶å°è¯·æ±åï¼ å¯ä»¥å°è¯·æ±æ²¿åå«å¨ä½ç¶ç»ä»¶çé¾ä¸ç´ä¼ éè³å¯¹è±¡æ çåºé¨ã\n\n * è´£ä»»é¾çç®¡çèå¯ä½¿ç¨å½ä»¤æ¨¡å¼å®ç°ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±è¯·æ±ä»£è¡¨çåä¸ä¸ªä¸ä¸æå¯¹è±¡æ§è¡è®¸å¤ä¸åçæä½ã\n   \n   è¿æå¦å¤ä¸ç§å®ç°æ¹å¼ï¼ é£å°±æ¯è¯·æ±èªèº«å°±æ¯ä¸ä¸ªå½ä»¤å¯¹è±¡ã å¨è¿ç§æåµä¸ï¼ ä½ å¯ä»¥å¯¹ç±ä¸ç³»åä¸åä¸ä¸æè¿æ¥èæçé¾æ§è¡ç¸åçæä½ã\n\n * è´£ä»»é¾åè£é¥°æ¨¡å¼çç±»ç»æéå¸¸ç¸ä¼¼ã ä¸¤èé½ä¾èµéå½ç»åå°éè¦æ§è¡çæä½ä¼ éç»ä¸ç³»åå¯¹è±¡ã ä½æ¯ï¼ ä¸¤èæå ç¹éè¦çä¸åä¹å¤ã\n   \n   è´£ä»»é¾çç®¡çèå¯ä»¥ç¸äºç¬ç«å°æ§è¡ä¸åæä½ï¼ è¿å¯ä»¥éæ¶åæ­¢ä¼ éè¯·æ±ã å¦ä¸æ¹é¢ï¼ åç§è£é¥°å¯ä»¥å¨éµå¾ªåºæ¬æ¥å£çæåµä¸æ©å±å¯¹è±¡çè¡ä¸ºã æ­¤å¤ï¼ è£é¥°æ æ³ä¸­æ­è¯·æ±çä¼ éã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è´£ä»»é¾æ¨¡å¼å¨ java ç¨åºä¸­å¹¶ä¸å¸¸è§ï¼ å ä¸ºå®ä»å¨ä»£ç ä¸å¯¹è±¡é¾æäº¤éæ¶æè½åæ¥ä½ç¨ã\n\nè¯¥æ¨¡å¼ææµè¡çä½¿ç¨æ¡ä¾ä¹ä¸æ¯å¨ gui ç±»ä¸­å°äºä»¶åä¸ä¼ éç»ç¶ç»ä»¶ã å¦ä¸ä¸ªå¼å¾æ³¨æçä½¿ç¨æ¡ä¾æ¯ä¾æ¬¡è®¿é®è¿æ»¤å¨ã\n\nä¸é¢æ¯è¯¥æ¨¡å¼å¨æ ¸å¿ java ç¨åºåºä¸­çä¸äºç¤ºä¾ï¼\n\n * javax.servlet.filter#dofilter()\n * java.util.logging.logger#log()\n\nè¯å«æ¹æ³ï¼ è¯¥æ¨¡å¼å¯éè¿ä¸ç»å¯¹è±¡çè¡ä¸ºæ¹æ³é´æ¥è°ç¨å¶ä»å¯¹è±¡çç¸åæ¹æ³æ¥è¯å«ï¼ èä¸ææå¯¹è±¡é½ä¼éµå¾ªç¸åçæ¥å£ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹å¤å¿å½æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹å¤å¿å½æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-22T15:26:00.000Z",permalink:"/pages/e3cd5d/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/21.%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/21.å¤å¿å½æ¨¡å¼.md",key:"v-ca584e06",path:"/pages/e3cd5d/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:84},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:179},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:189},{level:4,title:"åºäºåµå¥ç±»çå®ç°",slug:"åºäºåµå¥ç±»çå®ç°",normalizedTitle:"åºäºåµå¥ç±»çå®ç°",charIndex:202},{level:4,title:"åºäºä¸­é´æ¥å£çå®ç°",slug:"åºäºä¸­é´æ¥å£çå®ç°",normalizedTitle:"åºäºä¸­é´æ¥å£çå®ç°",charIndex:628},{level:4,title:"å°è£æ´å ä¸¥æ ¼çå®ç°",slug:"å°è£æ´å ä¸¥æ ¼çå®ç°",normalizedTitle:"å°è£æ´å ä¸¥æ ¼çå®ç°",charIndex:848},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:1145},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:2696},{level:2,title:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_5-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"5. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:4360},{level:2,title:"6. æ¡ä¾",slug:"_6-æ¡ä¾",normalizedTitle:"6. æ¡ä¾",charIndex:4582},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:4808}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ åºäºåµå¥ç±»çå®ç° åºäºä¸­é´æ¥å£çå®ç° å°è£æ´å ä¸¥æ ¼çå®ç° 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. ä¸å¶ä»æ¨¡å¼çå³ç³» 6. æ¡ä¾ 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹å¤å¿å½æ¨¡å¼\n\n\n# 1. æå¾\n\nå¤å¿å½æ¨¡å¼ï¼Mementoï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸å¨ä¸æ´é²å¯¹è±¡å®ç°ç»èçæåµä¸ä¿å­åæ¢å¤å¯¹è±¡ä¹åçç¶æã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ éè¦åå»ºå¯¹è±¡ç¶æå¿«ç§æ¥æ¢å¤å¶ä¹åçç¶ææ¶ï¼ å¯ä»¥ä½¿ç¨å¤å¿å½æ¨¡å¼ã\n * å½ç´æ¥è®¿é®å¯¹è±¡çæååéã è·åå¨æè®¾ç½®å¨å°å¯¼è´å°è£è¢«çªç ´æ¶ï¼ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n# åºäºåµå¥ç±»çå®ç°\n\n\n\n 1. ååå¨ ï¼Originatorï¼ ç±»å¯ä»¥çæèªèº«ç¶æçå¿«ç§ï¼ ä¹å¯ä»¥å¨éè¦æ¶éè¿å¿«ç§æ¢å¤èªèº«ç¶æã\n\n 2. å¤å¿å½ ï¼Mementoï¼ æ¯ååå¨ç¶æå¿«ç§çå¼å¯¹è±¡ ï¼value objectï¼ã éå¸¸åæ³æ¯å°å¤å¿å½è®¾ä¸ºä¸å¯åçï¼ å¹¶éè¿æé å½æ°ä¸æ¬¡æ§ä¼ éæ°æ®ã\n\n 3. è´è´£äºº ï¼Caretakerï¼ ä»ç¥é âä½æ¶â å âä¸ºä½â ææååå¨çç¶æï¼ ä»¥åä½æ¶æ¢å¤ç¶æã\n    \n    è´è´£äººéè¿ä¿å­å¤å¿å½æ æ¥è®°å½ååå¨çåå²ç¶æã å½ååå¨éè¦åæº¯åå²ç¶ææ¶ï¼ è´è´£äººå°ä»æ ä¸­è·åæé¡¶é¨çå¤å¿å½ï¼ å¹¶å°å¶ä¼ éç»ååå¨çæ¢å¤ ï¼restorationï¼ æ¹æ³ã\n\n 4. å¨è¯¥å®ç°æ¹æ³ä¸­ï¼ å¤å¿å½ç±»å°è¢«åµå¥å¨ååå¨ä¸­ã è¿æ ·ååå¨å°±å¯è®¿é®å¤å¿å½çæååéåæ¹æ³ï¼ å³ä½¿è¿äºæ¹æ³è¢«å£°æä¸ºç§æã å¦ä¸æ¹é¢ï¼ è´è´£äººå¯¹äºå¤å¿å½çæååéåæ¹æ³çè®¿é®æééå¸¸æéï¼ å®ä»¬åªè½å¨æ ä¸­ä¿å­å¤å¿å½ï¼ èä¸è½ä¿®æ¹å¶ç¶æã\n\n# åºäºä¸­é´æ¥å£çå®ç°\n\nå¦å¤ä¸ç§å®ç°æ¹æ³éç¨äºä¸æ¯æåµå¥ç±»çç¼ç¨è¯­è¨ ï¼æ²¡éï¼ æè¯´çå°±æ¯ PHPï¼ã\n\n\n\n 1. å¨æ²¡æåµå¥ç±»çæåµä¸ï¼ ä½ å¯ä»¥è§å®è´è´£äººä»å¯éè¿æç¡®å£°æçä¸­é´æ¥å£ä¸å¤å¿å½äºå¨ï¼ è¯¥æ¥å£ä»å£°æä¸å¤å¿å½åæ°æ®ç¸å³çæ¹æ³ï¼ éå¶å¶å¯¹å¤å¿å½æååéçç´æ¥è®¿é®æéã\n 2. å¦ä¸æ¹é¢ï¼ ååå¨å¯ä»¥ç´æ¥ä¸å¤å¿å½å¯¹è±¡è¿è¡äº¤äºï¼ è®¿é®å¤å¿å½ç±»ä¸­å£°æçæååéåæ¹æ³ã è¿ç§æ¹å¼çç¼ºç¹å¨äºä½ éè¦å°å¤å¿å½çæææååéå£°æä¸ºå¬æã\n\n# å°è£æ´å ä¸¥æ ¼çå®ç°\n\nå¦æä½ ä¸æ³è®©å¶ä»ç±»æä»»ä½æºä¼éè¿å¤å¿å½æ¥è®¿é®ååå¨çç¶æï¼ é£ä¹è¿æå¦ä¸ç§å¯ç¨çå®ç°æ¹å¼ã\n\n\n\n 1. è¿ç§å®ç°æ¹å¼åè®¸å­å¨å¤ç§ä¸åç±»åçååå¨åå¤å¿å½ã æ¯ç§ååå¨é½åå¶ç¸åºçå¤å¿å½ç±»è¿è¡äº¤äºã ååå¨åå¤å¿å½é½ä¸ä¼å°å¶ç¶ææ´é²ç»å¶ä»ç±»ã\n 2. è´è´£äººæ­¤æ¶è¢«æç¡®ç¦æ­¢ä¿®æ¹å­å¨å¨å¤å¿å½ä¸­çç¶æã ä½è´è´£äººç±»å°ç¬ç«äºååå¨ï¼ å ä¸ºæ­¤æ¶æ¢å¤æ¹æ³è¢«å®ä¹å¨äºå¤å¿å½ç±»ä¸­ã\n 3. æ¯ä¸ªå¤å¿å½å°ä¸åå»ºäºèªèº«çååå¨è¿æ¥ã ååå¨ä¼å°èªå·±åç¶æä¼ éç»å¤å¿å½çæé å½æ°ã ç±äºè¿äºç±»ä¹é´çç´§å¯èç³»ï¼ åªè¦ååå¨å®ä¹äºåéçè®¾ç½®å¨ ï¼setterï¼ï¼ å¤å¿å½å°±è½æ¢å¤å¶ç¶æã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nMemento : è´è´£å­å¨ Originator å¯¹è±¡çåé¨ç¶æï¼å¹¶å¯ä»¥é²æ­¢ Originator ä»¥å¤çå¶ä»å¯¹è±¡è®¿é® Mementoã\n\nMemento æä¸¤ä¸ªæ¥å£ï¼Caretaker åªè½çå°å¤å¿å½ççªæ¥å£ï¼å®åªè½å°å¤å¿å½ä¼ éç»å¶ä»å¯¹è±¡ã Originator å¯ä»¥çå°ä¸ä¸ªå®½æ¥å£ï¼åè®¸å®è®¿é®è¿åå°ååç¶ææéçæææ°æ®ã\n\nclass Memento {\n    private String state;\n    public Memento(String state) {\n        this.state = state;\n    }\n\n    public String GetState() {\n        return state;\n    }\n}\n\n\nOriginator : è´è´£åå»ºä¸ä¸ªå¤å¿å½ Mementoï¼ç¨ä»¥è®°å½å½åæ¶å»å®çåé¨ç¶æï¼å¹¶å¯ä½¿ç¨å¤å¿å½æ¢å¤åé¨ç¶æã\n\nOriginator å¯æ ¹æ®éè¦å³å® Memento å­å¨ Originator çåªäºåé¨ç¶æã\n\nclass Originator {\n    private String state;\n\n    public void SetState(String state) {\n        this.state = state;\n    }\n    public String GetState() {\n        return state;\n    }\n\n    public Memento CreateMemento() {\n        return (new Memento(state));\n    }\n\n    public void SetMemento(Memento memento) {\n        state = memento.GetState();\n    }\n\n    public void Show() {\n        System.out.println("State = " + state);\n    }\n}\n\n\nCaretaker : è´è´£ä¿å­å¥½å¤å¿å½ Mementoï¼ä¸è½å¯¹å¤å¿å½çåå®¹è¿è¡æä½ææ£æ¥ã\n\nclass Caretaker {\n    private Memento memento;\n\n    public void SetMemento(Memento memento) {\n        this.memento = memento;\n    }\n    public Memento GetMemento() {\n        return memento;\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class MementoPattern {\n    public static void main(String[] args) {\n        Originator o = new Originator();\n        o.SetState("ON");\n        o.Show();\n\n        Caretaker c = new Caretaker();\n        c.SetMemento(o.CreateMemento());\n\n        o.SetState("OFF");\n        o.Show();\n\n        o.SetMemento(c.GetMemento());\n        o.Show();\n    }\n}\n\n\nè¾åº\n\nState = ON\nState = OFF\nState = ON\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾ç»åä½¿ç¨äºå½ä»¤æ¨¡å¼ä¸å¤å¿å½æ¨¡å¼ï¼ å¯ä¿å­å¤ææå­ç¼è¾å¨çç¶æå¿«ç§ï¼ å¹¶è½å¨éè¦æ¶ä»å¿«ç§ä¸­æ¢å¤ä¹åçç¶æã\n\n\n\nå½ä»¤ ï¼commandï¼ å¯¹è±¡å°ä½ä¸ºè´è´£äººï¼ å®ä»¬ä¼å¨æ§è¡ä¸å½ä»¤ç¸å³çæä½åè·åç¼è¾å¨çå¤å¿å½ã å½ç¨æ·è¯å¾æ¤éæè¿çå½ä»¤æ¶ï¼ ç¼è¾å¨å¯ä»¥ä½¿ç¨ä¿å­å¨å½ä»¤ä¸­çå¤å¿å½æ¥å°èªèº«åæ»å°ä¹åçç¶æã\n\nå¤å¿å½ç±»æ²¡æå£°æä»»ä½å¬æçæååéã è·åå¨ ï¼getterï¼ åè®¾ç½®å¨ï¼ å æ­¤æ²¡æå¯¹è±¡å¯ä»¥ä¿®æ¹å¶åå®¹ã å¤å¿å½ä¸åå»ºèªå·±çç¼è¾å¨ç¸è¿æ¥ï¼ è¿ä½¿å¾å¤å¿å½è½å¤éè¿ç¼è¾å¨å¯¹è±¡çè®¾ç½®å¨ä¼ éæ°æ®ï¼ æ¢å¤ä¸å¶ç¸è¿æ¥çç¼è¾å¨çç¶æã ç±äºå¤å¿å½ä¸ç¹å®çç¼è¾å¨å¯¹è±¡ç¸è¿æ¥ï¼ ç¨åºå¯ä»¥ä½¿ç¨ä¸­å¿åçæ¤éæ å®ç°å¯¹å¤ä¸ªç¬ç«ç¼è¾å¨çªå£çæ¯æã\n\n// ååå¨ä¸­åå«äºä¸äºå¯è½ä¼éæ¶é´ååçéè¦æ°æ®ãå®è¿å®ä¹äºå¨å¤å¿å½ä¸­ä¿å­\n// èªèº«ç¶æçæ¹æ³ï¼ä»¥åä»å¤å¿å½ä¸­æ¢å¤ç¶æçæ¹æ³ã\nclass Editor is\n    private field text, curX, curY, selectionWidth\n\n    method setText(text) is\n        this.text = text\n\n    method setCursor(x, y) is\n        this.curX = curX\n        this.curY = curY\n\n    method setSelectionWidth(width) is\n        this.selectionWidth = width\n\n    // å¨å¤å¿å½ä¸­ä¿å­å½åçç¶æã\n    method createSnapshot():Snapshot is\n        // å¤å¿å½æ¯ä¸å¯åçå¯¹è±¡ï¼å æ­¤ååå¨ä¼å°èªèº«ç¶æä½ä¸ºåæ°ä¼ éç»å¤å¿\n        // å½çæé å½æ°ã\n        return new Snapshot(this, text, curX, curY, selectionWidth)\n\n// å¤å¿å½ç±»ä¿å­æç¼è¾å¨çè¿å¾ç¶æã\nclass Snapshot is\n    private field editor: Editor\n    private field text, curX, curY, selectionWidth\n\n    constructor Snapshot(editor, text, curX, curY, selectionWidth) is\n        this.editor = editor\n        this.text = text\n        this.curX = curX\n        this.curY = curY\n        this.selectionWidth = selectionWidth\n\n    // å¨æä¸æ¶å»ï¼ç¼è¾å¨ä¹åçç¶æå¯ä»¥ä½¿ç¨å¤å¿å½å¯¹è±¡æ¥æ¢å¤ã\n    method restore() is\n        editor.setText(text)\n        editor.setCursor(curX, curY)\n        editor.setSelectionWidth(selectionWidth)\n\n// å½ä»¤å¯¹è±¡å¯ä½ä¸ºè´è´£äººãå¨è¿ç§æåµä¸ï¼å½ä»¤ä¼å¨ä¿®æ¹ååå¨ç¶æä¹åè·åä¸ä¸ª\n// å¤å¿å½ãå½éè¦æ¤éæ¶ï¼å®ä¼ä»å¤å¿å½ä¸­æ¢å¤ååå¨çç¶æã\nclass Command is\n    private field backup: Snapshot\n\n    method makeBackup() is\n        backup = editor.createSnapshot()\n\n    method undo() is\n        if (backup != null)\n            backup.restore()\n    // ...\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å½ä»¤æ¨¡å¼åå¤å¿å½æ¨¡å¼æ¥å®ç° âæ¤éâã å¨è¿ç§æåµä¸ï¼ å½ä»¤ç¨äºå¯¹ç®æ å¯¹è±¡æ§è¡åç§ä¸åçæä½ï¼ å¤å¿å½ç¨æ¥ä¿å­ä¸æ¡å½ä»¤æ§è¡åè¯¥å¯¹è±¡çç¶æã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å¤å¿å½åè¿­ä»£å¨æ¨¡å¼æ¥è·åå½åè¿­ä»£å¨çç¶æï¼ å¹¶ä¸å¨éè¦çæ¶åè¿è¡åæ»ã\n * ææ¶åååæ¨¡å¼å¯ä»¥ä½ä¸ºå¤å¿å½çä¸ä¸ªç®åçæ¬ï¼ å¶æ¡ä»¶æ¯ä½ éè¦å¨åå²è®°å½ä¸­å­å¨çå¯¹è±¡çç¶ææ¯è¾ç®åï¼ ä¸éè¦é¾æ¥å¶ä»å¤é¨èµæºï¼ æèé¾æ¥å¯ä»¥æ¹ä¾¿å°éå»ºã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å¤å¿å½çåºæ¬ååå¯éè¿åºååæ¥å®ç°ï¼ è¿å¨ Java è¯­è¨ä¸­å¾å¸¸è§ã å°½ç®¡å¤å¿å½ä¸æ¯çæå¯¹è±¡ç¶æå¿«ç§çå¯ä¸æææææ¹æ³ï¼ ä½å®è½å¨ä¿æ¤åå§å¯¹è±¡çç»æä¸æ´é²ç»å¶ä»å¯¹è±¡çæåµä¸ä¿å­å¯¹è±¡ç¶æçå¤ä»½ã\n\nä¸é¢æ¯æ ¸å¿ Java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * ææ java.io.Serializable çå®ç°é½å¯ä»¥æ¨¡æå¤å¿å½ã\n * ææ javax.faces.component.StateHolder çå®ç°ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹å¤å¿å½æ¨¡å¼\n\n\n# 1. æå¾\n\nå¤å¿å½æ¨¡å¼ï¼mementoï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ åè®¸å¨ä¸æ´é²å¯¹è±¡å®ç°ç»èçæåµä¸ä¿å­åæ¢å¤å¯¹è±¡ä¹åçç¶æã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ éè¦åå»ºå¯¹è±¡ç¶æå¿«ç§æ¥æ¢å¤å¶ä¹åçç¶ææ¶ï¼ å¯ä»¥ä½¿ç¨å¤å¿å½æ¨¡å¼ã\n * å½ç´æ¥è®¿é®å¯¹è±¡çæååéã è·åå¨æè®¾ç½®å¨å°å¯¼è´å°è£è¢«çªç ´æ¶ï¼ å¯ä»¥ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n# åºäºåµå¥ç±»çå®ç°\n\n\n\n 1. ååå¨ ï¼originatorï¼ ç±»å¯ä»¥çæèªèº«ç¶æçå¿«ç§ï¼ ä¹å¯ä»¥å¨éè¦æ¶éè¿å¿«ç§æ¢å¤èªèº«ç¶æã\n\n 2. å¤å¿å½ ï¼mementoï¼ æ¯ååå¨ç¶æå¿«ç§çå¼å¯¹è±¡ ï¼value objectï¼ã éå¸¸åæ³æ¯å°å¤å¿å½è®¾ä¸ºä¸å¯åçï¼ å¹¶éè¿æé å½æ°ä¸æ¬¡æ§ä¼ éæ°æ®ã\n\n 3. è´è´£äºº ï¼caretakerï¼ ä»ç¥é âä½æ¶â å âä¸ºä½â ææååå¨çç¶æï¼ ä»¥åä½æ¶æ¢å¤ç¶æã\n    \n    è´è´£äººéè¿ä¿å­å¤å¿å½æ æ¥è®°å½ååå¨çåå²ç¶æã å½ååå¨éè¦åæº¯åå²ç¶ææ¶ï¼ è´è´£äººå°ä»æ ä¸­è·åæé¡¶é¨çå¤å¿å½ï¼ å¹¶å°å¶ä¼ éç»ååå¨çæ¢å¤ ï¼restorationï¼ æ¹æ³ã\n\n 4. å¨è¯¥å®ç°æ¹æ³ä¸­ï¼ å¤å¿å½ç±»å°è¢«åµå¥å¨ååå¨ä¸­ã è¿æ ·ååå¨å°±å¯è®¿é®å¤å¿å½çæååéåæ¹æ³ï¼ å³ä½¿è¿äºæ¹æ³è¢«å£°æä¸ºç§æã å¦ä¸æ¹é¢ï¼ è´è´£äººå¯¹äºå¤å¿å½çæååéåæ¹æ³çè®¿é®æééå¸¸æéï¼ å®ä»¬åªè½å¨æ ä¸­ä¿å­å¤å¿å½ï¼ èä¸è½ä¿®æ¹å¶ç¶æã\n\n# åºäºä¸­é´æ¥å£çå®ç°\n\nå¦å¤ä¸ç§å®ç°æ¹æ³éç¨äºä¸æ¯æåµå¥ç±»çç¼ç¨è¯­è¨ ï¼æ²¡éï¼ æè¯´çå°±æ¯ phpï¼ã\n\n\n\n 1. å¨æ²¡æåµå¥ç±»çæåµä¸ï¼ ä½ å¯ä»¥è§å®è´è´£äººä»å¯éè¿æç¡®å£°æçä¸­é´æ¥å£ä¸å¤å¿å½äºå¨ï¼ è¯¥æ¥å£ä»å£°æä¸å¤å¿å½åæ°æ®ç¸å³çæ¹æ³ï¼ éå¶å¶å¯¹å¤å¿å½æååéçç´æ¥è®¿é®æéã\n 2. å¦ä¸æ¹é¢ï¼ ååå¨å¯ä»¥ç´æ¥ä¸å¤å¿å½å¯¹è±¡è¿è¡äº¤äºï¼ è®¿é®å¤å¿å½ç±»ä¸­å£°æçæååéåæ¹æ³ã è¿ç§æ¹å¼çç¼ºç¹å¨äºä½ éè¦å°å¤å¿å½çæææååéå£°æä¸ºå¬æã\n\n# å°è£æ´å ä¸¥æ ¼çå®ç°\n\nå¦æä½ ä¸æ³è®©å¶ä»ç±»æä»»ä½æºä¼éè¿å¤å¿å½æ¥è®¿é®ååå¨çç¶æï¼ é£ä¹è¿æå¦ä¸ç§å¯ç¨çå®ç°æ¹å¼ã\n\n\n\n 1. è¿ç§å®ç°æ¹å¼åè®¸å­å¨å¤ç§ä¸åç±»åçååå¨åå¤å¿å½ã æ¯ç§ååå¨é½åå¶ç¸åºçå¤å¿å½ç±»è¿è¡äº¤äºã ååå¨åå¤å¿å½é½ä¸ä¼å°å¶ç¶ææ´é²ç»å¶ä»ç±»ã\n 2. è´è´£äººæ­¤æ¶è¢«æç¡®ç¦æ­¢ä¿®æ¹å­å¨å¨å¤å¿å½ä¸­çç¶æã ä½è´è´£äººç±»å°ç¬ç«äºååå¨ï¼ å ä¸ºæ­¤æ¶æ¢å¤æ¹æ³è¢«å®ä¹å¨äºå¤å¿å½ç±»ä¸­ã\n 3. æ¯ä¸ªå¤å¿å½å°ä¸åå»ºäºèªèº«çååå¨è¿æ¥ã ååå¨ä¼å°èªå·±åç¶æä¼ éç»å¤å¿å½çæé å½æ°ã ç±äºè¿äºç±»ä¹é´çç´§å¯èç³»ï¼ åªè¦ååå¨å®ä¹äºåéçè®¾ç½®å¨ ï¼setterï¼ï¼ å¤å¿å½å°±è½æ¢å¤å¶ç¶æã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nmemento : è´è´£å­å¨ originator å¯¹è±¡çåé¨ç¶æï¼å¹¶å¯ä»¥é²æ­¢ originator ä»¥å¤çå¶ä»å¯¹è±¡è®¿é® mementoã\n\nmemento æä¸¤ä¸ªæ¥å£ï¼caretaker åªè½çå°å¤å¿å½ççªæ¥å£ï¼å®åªè½å°å¤å¿å½ä¼ éç»å¶ä»å¯¹è±¡ã originator å¯ä»¥çå°ä¸ä¸ªå®½æ¥å£ï¼åè®¸å®è®¿é®è¿åå°ååç¶ææéçæææ°æ®ã\n\nclass memento {\n    private string state;\n    public memento(string state) {\n        this.state = state;\n    }\n\n    public string getstate() {\n        return state;\n    }\n}\n\n\noriginator : è´è´£åå»ºä¸ä¸ªå¤å¿å½ mementoï¼ç¨ä»¥è®°å½å½åæ¶å»å®çåé¨ç¶æï¼å¹¶å¯ä½¿ç¨å¤å¿å½æ¢å¤åé¨ç¶æã\n\noriginator å¯æ ¹æ®éè¦å³å® memento å­å¨ originator çåªäºåé¨ç¶æã\n\nclass originator {\n    private string state;\n\n    public void setstate(string state) {\n        this.state = state;\n    }\n    public string getstate() {\n        return state;\n    }\n\n    public memento creatememento() {\n        return (new memento(state));\n    }\n\n    public void setmemento(memento memento) {\n        state = memento.getstate();\n    }\n\n    public void show() {\n        system.out.println("state = " + state);\n    }\n}\n\n\ncaretaker : è´è´£ä¿å­å¥½å¤å¿å½ mementoï¼ä¸è½å¯¹å¤å¿å½çåå®¹è¿è¡æä½ææ£æ¥ã\n\nclass caretaker {\n    private memento memento;\n\n    public void setmemento(memento memento) {\n        this.memento = memento;\n    }\n    public memento getmemento() {\n        return memento;\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class mementopattern {\n    public static void main(string[] args) {\n        originator o = new originator();\n        o.setstate("on");\n        o.show();\n\n        caretaker c = new caretaker();\n        c.setmemento(o.creatememento());\n\n        o.setstate("off");\n        o.show();\n\n        o.setmemento(c.getmemento());\n        o.show();\n    }\n}\n\n\nè¾åº\n\nstate = on\nstate = off\nstate = on\n\n\n\n# 4. ä¼ªä»£ç \n\næ¬ä¾ç»åä½¿ç¨äºå½ä»¤æ¨¡å¼ä¸å¤å¿å½æ¨¡å¼ï¼ å¯ä¿å­å¤ææå­ç¼è¾å¨çç¶æå¿«ç§ï¼ å¹¶è½å¨éè¦æ¶ä»å¿«ç§ä¸­æ¢å¤ä¹åçç¶æã\n\n\n\nå½ä»¤ ï¼commandï¼ å¯¹è±¡å°ä½ä¸ºè´è´£äººï¼ å®ä»¬ä¼å¨æ§è¡ä¸å½ä»¤ç¸å³çæä½åè·åç¼è¾å¨çå¤å¿å½ã å½ç¨æ·è¯å¾æ¤éæè¿çå½ä»¤æ¶ï¼ ç¼è¾å¨å¯ä»¥ä½¿ç¨ä¿å­å¨å½ä»¤ä¸­çå¤å¿å½æ¥å°èªèº«åæ»å°ä¹åçç¶æã\n\nå¤å¿å½ç±»æ²¡æå£°æä»»ä½å¬æçæååéã è·åå¨ ï¼getterï¼ åè®¾ç½®å¨ï¼ å æ­¤æ²¡æå¯¹è±¡å¯ä»¥ä¿®æ¹å¶åå®¹ã å¤å¿å½ä¸åå»ºèªå·±çç¼è¾å¨ç¸è¿æ¥ï¼ è¿ä½¿å¾å¤å¿å½è½å¤éè¿ç¼è¾å¨å¯¹è±¡çè®¾ç½®å¨ä¼ éæ°æ®ï¼ æ¢å¤ä¸å¶ç¸è¿æ¥çç¼è¾å¨çç¶æã ç±äºå¤å¿å½ä¸ç¹å®çç¼è¾å¨å¯¹è±¡ç¸è¿æ¥ï¼ ç¨åºå¯ä»¥ä½¿ç¨ä¸­å¿åçæ¤éæ å®ç°å¯¹å¤ä¸ªç¬ç«ç¼è¾å¨çªå£çæ¯æã\n\n// ååå¨ä¸­åå«äºä¸äºå¯è½ä¼éæ¶é´ååçéè¦æ°æ®ãå®è¿å®ä¹äºå¨å¤å¿å½ä¸­ä¿å­\n// èªèº«ç¶æçæ¹æ³ï¼ä»¥åä»å¤å¿å½ä¸­æ¢å¤ç¶æçæ¹æ³ã\nclass editor is\n    private field text, curx, cury, selectionwidth\n\n    method settext(text) is\n        this.text = text\n\n    method setcursor(x, y) is\n        this.curx = curx\n        this.cury = cury\n\n    method setselectionwidth(width) is\n        this.selectionwidth = width\n\n    // å¨å¤å¿å½ä¸­ä¿å­å½åçç¶æã\n    method createsnapshot():snapshot is\n        // å¤å¿å½æ¯ä¸å¯åçå¯¹è±¡ï¼å æ­¤ååå¨ä¼å°èªèº«ç¶æä½ä¸ºåæ°ä¼ éç»å¤å¿\n        // å½çæé å½æ°ã\n        return new snapshot(this, text, curx, cury, selectionwidth)\n\n// å¤å¿å½ç±»ä¿å­æç¼è¾å¨çè¿å¾ç¶æã\nclass snapshot is\n    private field editor: editor\n    private field text, curx, cury, selectionwidth\n\n    constructor snapshot(editor, text, curx, cury, selectionwidth) is\n        this.editor = editor\n        this.text = text\n        this.curx = curx\n        this.cury = cury\n        this.selectionwidth = selectionwidth\n\n    // å¨æä¸æ¶å»ï¼ç¼è¾å¨ä¹åçç¶æå¯ä»¥ä½¿ç¨å¤å¿å½å¯¹è±¡æ¥æ¢å¤ã\n    method restore() is\n        editor.settext(text)\n        editor.setcursor(curx, cury)\n        editor.setselectionwidth(selectionwidth)\n\n// å½ä»¤å¯¹è±¡å¯ä½ä¸ºè´è´£äººãå¨è¿ç§æåµä¸ï¼å½ä»¤ä¼å¨ä¿®æ¹ååå¨ç¶æä¹åè·åä¸ä¸ª\n// å¤å¿å½ãå½éè¦æ¤éæ¶ï¼å®ä¼ä»å¤å¿å½ä¸­æ¢å¤ååå¨çç¶æã\nclass command is\n    private field backup: snapshot\n\n    method makebackup() is\n        backup = editor.createsnapshot()\n\n    method undo() is\n        if (backup != null)\n            backup.restore()\n    // ...\n\n\n\n# 5. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å½ä»¤æ¨¡å¼åå¤å¿å½æ¨¡å¼æ¥å®ç° âæ¤éâã å¨è¿ç§æåµä¸ï¼ å½ä»¤ç¨äºå¯¹ç®æ å¯¹è±¡æ§è¡åç§ä¸åçæä½ï¼ å¤å¿å½ç¨æ¥ä¿å­ä¸æ¡å½ä»¤æ§è¡åè¯¥å¯¹è±¡çç¶æã\n * ä½ å¯ä»¥åæ¶ä½¿ç¨å¤å¿å½åè¿­ä»£å¨æ¨¡å¼æ¥è·åå½åè¿­ä»£å¨çç¶æï¼ å¹¶ä¸å¨éè¦çæ¶åè¿è¡åæ»ã\n * ææ¶åååæ¨¡å¼å¯ä»¥ä½ä¸ºå¤å¿å½çä¸ä¸ªç®åçæ¬ï¼ å¶æ¡ä»¶æ¯ä½ éè¦å¨åå²è®°å½ä¸­å­å¨çå¯¹è±¡çç¶ææ¯è¾ç®åï¼ ä¸éè¦é¾æ¥å¶ä»å¤é¨èµæºï¼ æèé¾æ¥å¯ä»¥æ¹ä¾¿å°éå»ºã\n\n\n# 6. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å¤å¿å½çåºæ¬ååå¯éè¿åºååæ¥å®ç°ï¼ è¿å¨ java è¯­è¨ä¸­å¾å¸¸è§ã å°½ç®¡å¤å¿å½ä¸æ¯çæå¯¹è±¡ç¶æå¿«ç§çå¯ä¸æææææ¹æ³ï¼ ä½å®è½å¨ä¿æ¤åå§å¯¹è±¡çç»æä¸æ´é²ç»å¶ä»å¯¹è±¡çæåµä¸ä¿å­å¯¹è±¡ç¶æçå¤ä»½ã\n\nä¸é¢æ¯æ ¸å¿ java ç¨åºåºä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * ææ java.io.serializable çå®ç°é½å¯ä»¥æ¨¡æå¤å¿å½ã\n * ææ javax.faces.component.stateholder çå®ç°ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ç­ç¥æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ç­ç¥æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-22T16:14:00.000Z",permalink:"/pages/e5bb92/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/22.%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/22.ç­ç¥æ¨¡å¼.md",key:"v-f0251290",path:"/pages/e5bb92/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:98},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:285},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:295},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:598},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1941},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:3415},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:3830},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:4475}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ç­ç¥æ¨¡å¼\n\n\n# 1. æå¾\n\nç­ç¥æ¨¡å¼ï¼Strategyï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®è½è®©ä½ å®ä¹ä¸ç³»åç®æ³ï¼ å¹¶å°æ¯ç§ç®æ³åå«æ¾å¥ç¬ç«çç±»ä¸­ï¼ ä»¥ä½¿ç®æ³çå¯¹è±¡è½å¤ç¸äºæ¿æ¢ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ æ³ä½¿ç¨å¯¹è±¡ä¸­åç§ä¸åçç®æ³åä½ï¼ å¹¶å¸æè½å¨è¿è¡æ¶åæ¢ç®æ³æ¶ï¼ å¯ä½¿ç¨ç­ç¥æ¨¡å¼ã\n * å½ä½ æè®¸å¤ä»å¨æ§è¡æäºè¡ä¸ºæ¶ç¥æä¸åçç¸ä¼¼ç±»æ¶ï¼ å¯ä½¿ç¨ç­ç¥æ¨¡å¼ã\n * å¦æç®æ³å¨ä¸ä¸æçé»è¾ä¸­ä¸æ¯ç¹å«éè¦ï¼ ä½¿ç¨è¯¥æ¨¡å¼è½å°ç±»çä¸å¡é»è¾ä¸å¶ç®æ³å®ç°ç»èéç¦»å¼æ¥ã\n * å½ç±»ä¸­ä½¿ç¨äºå¤ææ¡ä»¶è¿ç®ç¬¦ä»¥å¨åä¸ç®æ³çä¸ååä½ä¸­åæ¢æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. ä¸ä¸æ ï¼Contextï¼ ç»´æ¤æåå·ä½ç­ç¥çå¼ç¨ï¼ ä¸ä»éè¿ç­ç¥æ¥å£ä¸è¯¥å¯¹è±¡è¿è¡äº¤æµã\n 2. ç­ç¥ ï¼Strategyï¼ æ¥å£æ¯ææå·ä½ç­ç¥çéç¨æ¥å£ï¼ å®å£°æäºä¸ä¸ªä¸ä¸æç¨äºæ§è¡ç­ç¥çæ¹æ³ã\n 3. å·ä½ç­ç¥ ï¼Concrete Strategiesï¼ å®ç°äºä¸ä¸ææç¨ç®æ³çåç§ä¸ååä½ã\n 4. å½ä¸ä¸æéè¦è¿è¡ç®æ³æ¶ï¼ å®ä¼å¨å¶å·²è¿æ¥çç­ç¥å¯¹è±¡ä¸è°ç¨æ§è¡æ¹æ³ã ä¸ä¸æä¸æ¸æ¥å¶ææ¶åçç­ç¥ç±»åä¸ç®æ³çæ§è¡æ¹å¼ã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ ä¼åå»ºä¸ä¸ªç¹å®ç­ç¥å¯¹è±¡å¹¶å°å¶ä¼ éç»ä¸ä¸æã ä¸ä¸æåä¼æä¾ä¸ä¸ªè®¾ç½®å¨ä»¥ä¾¿å®¢æ·ç«¯å¨è¿è¡æ¶æ¿æ¢ç¸å³èçç­ç¥ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nStrategy : å®ä¹ææç®æ³çå¬å±æ¥å£(AlgorithmInterface)ãContext ä½¿ç¨è¿ä¸ªæ¥å£å»è°ç¨ ConcreteStrategy å®ä¹çå·ä½ç®æ³ã\n\nabstract class Strategy {\n    public abstract void AlgorithmInterface();\n}\n\n\nConcreteStrategy : å®ç° Strategy ä¸­çç®æ³æ¥å£(AlgorithmInterface)ã\n\nclass ConcreteStrategyA extends Strategy {\n    @Override\n    public void AlgorithmInterface() {\n        System.out.println("ç®æ³A");\n    }\n}\n\nclass ConcreteStrategyB extends Strategy {\n    @Override\n    public void AlgorithmInterface() {\n        System.out.println("ç®æ³B");\n    }\n}\n\nclass ConcreteStrategyC extends Strategy {\n    @Override\n    public void AlgorithmInterface() {\n        System.out.println("ç®æ³C");\n    }\n}\n\n\nContext : ç¨ä¸ä¸ª ConcreteStrategy æ¥éç½®ãç»´æ¤ä¸ä¸ªå¯¹ Strategy å¯¹è±¡çå¼ç¨ã\n\nclass Context {\n    Strategy strategy;\n    public Context(Strategy strategy) {\n        this.strategy = strategy;\n    }\n\n    public void ContextInterface() {\n        strategy.AlgorithmInterface();\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class StrategyPattern {\n    public static void main(String[] args) {\n        Context context1 = new Context(new ConcreteStrategyA());\n        context1.ContextInterface();\n\n        Context context2 = new Context(new ConcreteStrategyB());\n        context2.ContextInterface();\n\n        Context context3 = new Context(new ConcreteStrategyC());\n        context3.ContextInterface();\n    }\n}\n\n\nè¾åº\n\nç®æ³A\nç®æ³B\nç®æ³C\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ä¸ä¸æä½¿ç¨äºå¤ä¸ªç­ç¥æ¥æ§è¡ä¸åçè®¡ç®æä½ã\n\n// ç­ç¥æ¥å£å£°æäºæä¸ªç®æ³åä¸ªä¸åçæ¬é´æå±æçæä½ãä¸ä¸æä¼ä½¿ç¨è¯¥æ¥å£æ¥\n// è°ç¨æå·ä½ç­ç¥å®ä¹çç®æ³ã\ninterface Strategy is\n    method execute(a, b)\n\n// å·ä½ç­ç¥ä¼å¨éµå¾ªç­ç¥åºç¡æ¥å£çæåµä¸å®ç°ç®æ³ãè¯¥æ¥å£å®ç°äºå®ä»¬å¨ä¸ä¸æ\n// ä¸­çäºæ¢æ§ã\nclass ConcreteStrategyAdd implements Strategy is\n    method execute(a, b) is\n        return a + b\n\nclass ConcreteStrategySubtract implements Strategy is\n    method execute(a, b) is\n        return a - b\n\nclass ConcreteStrategyMultiply implements Strategy is\n    method execute(a, b) is\n        return a * b\n\n// ä¸ä¸æå®ä¹äºå®¢æ·ç«¯å³æ³¨çæ¥å£ã\nclass Context is\n    // ä¸ä¸æä¼ç»´æ¤æåæä¸ªç­ç¥å¯¹è±¡çå¼ç¨ãä¸ä¸æä¸ç¥æç­ç¥çå·ä½ç±»ãä¸ä¸\n    // æå¿é¡»éè¿ç­ç¥æ¥å£æ¥ä¸ææç­ç¥è¿è¡äº¤äºã\n    private strategy: Strategy\n\n    // ä¸ä¸æéå¸¸ä¼éè¿æé å½æ°æ¥æ¥æ¶ç­ç¥å¯¹è±¡ï¼åæ¶è¿æä¾è®¾ç½®å¨ä»¥ä¾¿å¨è¿è¡\n    // æ¶åæ¢ç­ç¥ã\n    method setStrategy(Strategy strategy) is\n        this.strategy = strategy\n\n    // ä¸ä¸æä¼å°ä¸äºå·¥ä½å§æ´¾ç»ç­ç¥å¯¹è±¡ï¼èä¸æ¯èªè¡å®ç°ä¸åçæ¬çç®æ³ã\n    method executeStrategy(int a, int b) is\n        return strategy.execute(a, b)\n\n\n// å®¢æ·ç«¯ä»£ç ä¼éæ©å·ä½ç­ç¥å¹¶å°å¶ä¼ éç»ä¸ä¸æãå®¢æ·ç«¯å¿é¡»ç¥æç­ç¥ä¹é´çå·®\n// å¼ï¼æè½ååºæ­£ç¡®çéæ©ã\nclass ExampleApplication is\n    method main() is\n\n        åå»ºä¸ä¸æå¯¹è±¡ã\n\n        è¯»åç¬¬ä¸ä¸ªæ°ã\n        è¯»åæåä¸ä¸ªæ°ã\n        ä»ç¨æ·è¾å¥ä¸­è¯»åææè¿è¡çè¡ä¸ºã\n\n        if (action == addition) then\n            context.setStrategy(new ConcreteStrategyAdd())\n\n        if (action == subtraction) then\n            context.setStrategy(new ConcreteStrategySubtract())\n\n        if (action == multiplication) then\n            context.setStrategy(new ConcreteStrategyMultiply())\n\n        result = context.executeStrategy(First number, Second number)\n\n        æå°ç»æã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ç­ç¥æ¨¡å¼å¨ Java ä»£ç ä¸­å¾å¸¸è§ã å®ç»å¸¸å¨åç§æ¡æ¶ä¸­ä½¿ç¨ï¼ è½å¨ä¸æ©å±ç±»çæåµä¸åç¨æ·æä¾æ¹åå¶è¡ä¸ºçæ¹å¼ã\n\nJava 8 å¼å§æ¯æ lambda æ¹æ³ï¼ å®å¯ä½ä¸ºä¸ç§æ¿ä»£ç­ç¥æ¨¡å¼çç®åæ¹å¼ã\n\nè¿éæä¸äºæ ¸å¿ Java ç¨åºåºä¸­ç­ç¥æ¨¡å¼çç¤ºä¾ï¼\n\n * å¯¹ java.util.Comparator#compare() çè°ç¨æ¥èª Collections#sort().\n * javax.servlet.http.HttpServletï¼ serviceÂ­()æ¹æ³ï¼ è¿ææææ¥å HttpÂ­ServletÂ­Requestå HttpÂ­ServletÂ­Responseå¯¹è±¡ä½ä¸ºåæ°ç doÂ­XXX()æ¹æ³ã\n * javax.servlet.Filter#doFilter()\n\nè¯å«æ¹æ³ï¼ ç­ç¥æ¨¡å¼å¯ä»¥éè¿åè®¸åµå¥å¯¹è±¡å®æå®éå·¥ä½çæ¹æ³ä»¥ååè®¸å°è¯¥å¯¹è±¡æ¿æ¢ä¸ºä¸åå¯¹è±¡çè®¾ç½®å¨æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * å½ä»¤æ¨¡å¼åç­ç¥çä¸å»å¾åï¼ å ä¸ºä¸¤èé½è½éè¿æäºè¡ä¸ºæ¥åæ°åå¯¹è±¡ã ä½æ¯ï¼ å®ä»¬çæå¾æéå¸¸å¤§çä¸åã\n   * ä½ å¯ä»¥ä½¿ç¨å½ä»¤æ¥å°ä»»ä½æä½è½¬æ¢ä¸ºå¯¹è±¡ã æä½çåæ°å°æä¸ºå¯¹è±¡çæååéã ä½ å¯ä»¥éè¿è½¬æ¢æ¥å»¶è¿æä½çæ§è¡ã å°æä½æ¾å¥éåã ä¿å­åå²å½ä»¤æèåè¿ç¨æå¡åéå½ä»¤ç­ã\n   * å¦ä¸æ¹é¢ï¼ ç­ç¥éå¸¸å¯ç¨äºæè¿°å®ææä»¶äºçä¸åæ¹å¼ï¼ è®©ä½ è½å¤å¨åä¸ä¸ªä¸ä¸æç±»ä¸­åæ¢ç®æ³ã\n * è£é¥°æ¨¡å¼å¯è®©ä½ æ´æ¹å¯¹è±¡çå¤è¡¨ï¼ ç­ç¥åè®©ä½ è½å¤æ¹åå¶æ¬è´¨ã\n * æ¨¡æ¿æ¹æ³æ¨¡å¼åºäºç»§æ¿æºå¶ï¼ å®åè®¸ä½ éè¿æ©å±å­ç±»ä¸­çé¨ååå®¹æ¥æ¹åé¨åç®æ³ã ç­ç¥åºäºç»åæºå¶ï¼ ä½ å¯ä»¥éè¿å¯¹ç¸åºè¡ä¸ºæä¾ä¸åçç­ç¥æ¥æ¹åå¯¹è±¡çé¨åè¡ä¸ºã æ¨¡æ¿æ¹æ³å¨ç±»å±æ¬¡ä¸è¿ä½ï¼ å æ­¤å®æ¯éæçã ç­ç¥å¨å¯¹è±¡å±æ¬¡ä¸è¿ä½ï¼ å æ­¤åè®¸å¨è¿è¡æ¶åæ¢è¡ä¸ºã\n * ç¶æå¯è¢«è§ä¸ºç­ç¥çæ©å±ã ä¸¤èé½åºäºç»åæºå¶ï¼ å®ä»¬é½éè¿å°é¨åå·¥ä½å§æ´¾ç» âå¸®æâ å¯¹è±¡æ¥æ¹åå¶å¨ä¸åææ¯ä¸çè¡ä¸ºã ç­ç¥ä½¿å¾è¿äºå¯¹è±¡ç¸äºä¹é´å®å¨ç¬ç«ï¼ å®ä»¬ä¸ç¥éå¶ä»å¯¹è±¡çå­å¨ã ä½ç¶ææ¨¡å¼æ²¡æéå¶å·ä½ç¶æä¹é´çä¾èµï¼ ä¸åè®¸å®ä»¬èªè¡æ¹åå¨ä¸åææ¯ä¸çç¶æã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ç­ç¥æ¨¡å¼\n\n\n# 1. æå¾\n\nç­ç¥æ¨¡å¼ï¼strategyï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®è½è®©ä½ å®ä¹ä¸ç³»åç®æ³ï¼ å¹¶å°æ¯ç§ç®æ³åå«æ¾å¥ç¬ç«çç±»ä¸­ï¼ ä»¥ä½¿ç®æ³çå¯¹è±¡è½å¤ç¸äºæ¿æ¢ã\n\n\n# 2. éç¨åºæ¯\n\n * å½ä½ æ³ä½¿ç¨å¯¹è±¡ä¸­åç§ä¸åçç®æ³åä½ï¼ å¹¶å¸æè½å¨è¿è¡æ¶åæ¢ç®æ³æ¶ï¼ å¯ä½¿ç¨ç­ç¥æ¨¡å¼ã\n * å½ä½ æè®¸å¤ä»å¨æ§è¡æäºè¡ä¸ºæ¶ç¥æä¸åçç¸ä¼¼ç±»æ¶ï¼ å¯ä½¿ç¨ç­ç¥æ¨¡å¼ã\n * å¦æç®æ³å¨ä¸ä¸æçé»è¾ä¸­ä¸æ¯ç¹å«éè¦ï¼ ä½¿ç¨è¯¥æ¨¡å¼è½å°ç±»çä¸å¡é»è¾ä¸å¶ç®æ³å®ç°ç»èéç¦»å¼æ¥ã\n * å½ç±»ä¸­ä½¿ç¨äºå¤ææ¡ä»¶è¿ç®ç¬¦ä»¥å¨åä¸ç®æ³çä¸ååä½ä¸­åæ¢æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. ä¸ä¸æ ï¼contextï¼ ç»´æ¤æåå·ä½ç­ç¥çå¼ç¨ï¼ ä¸ä»éè¿ç­ç¥æ¥å£ä¸è¯¥å¯¹è±¡è¿è¡äº¤æµã\n 2. ç­ç¥ ï¼strategyï¼ æ¥å£æ¯ææå·ä½ç­ç¥çéç¨æ¥å£ï¼ å®å£°æäºä¸ä¸ªä¸ä¸æç¨äºæ§è¡ç­ç¥çæ¹æ³ã\n 3. å·ä½ç­ç¥ ï¼concrete strategiesï¼ å®ç°äºä¸ä¸ææç¨ç®æ³çåç§ä¸ååä½ã\n 4. å½ä¸ä¸æéè¦è¿è¡ç®æ³æ¶ï¼ å®ä¼å¨å¶å·²è¿æ¥çç­ç¥å¯¹è±¡ä¸è°ç¨æ§è¡æ¹æ³ã ä¸ä¸æä¸æ¸æ¥å¶ææ¶åçç­ç¥ç±»åä¸ç®æ³çæ§è¡æ¹å¼ã\n 5. å®¢æ·ç«¯ ï¼clientï¼ ä¼åå»ºä¸ä¸ªç¹å®ç­ç¥å¯¹è±¡å¹¶å°å¶ä¼ éç»ä¸ä¸æã ä¸ä¸æåä¼æä¾ä¸ä¸ªè®¾ç½®å¨ä»¥ä¾¿å®¢æ·ç«¯å¨è¿è¡æ¶æ¿æ¢ç¸å³èçç­ç¥ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nstrategy : å®ä¹ææç®æ³çå¬å±æ¥å£(algorithminterface)ãcontext ä½¿ç¨è¿ä¸ªæ¥å£å»è°ç¨ concretestrategy å®ä¹çå·ä½ç®æ³ã\n\nabstract class strategy {\n    public abstract void algorithminterface();\n}\n\n\nconcretestrategy : å®ç° strategy ä¸­çç®æ³æ¥å£(algorithminterface)ã\n\nclass concretestrategya extends strategy {\n    @override\n    public void algorithminterface() {\n        system.out.println("ç®æ³a");\n    }\n}\n\nclass concretestrategyb extends strategy {\n    @override\n    public void algorithminterface() {\n        system.out.println("ç®æ³b");\n    }\n}\n\nclass concretestrategyc extends strategy {\n    @override\n    public void algorithminterface() {\n        system.out.println("ç®æ³c");\n    }\n}\n\n\ncontext : ç¨ä¸ä¸ª concretestrategy æ¥éç½®ãç»´æ¤ä¸ä¸ªå¯¹ strategy å¯¹è±¡çå¼ç¨ã\n\nclass context {\n    strategy strategy;\n    public context(strategy strategy) {\n        this.strategy = strategy;\n    }\n\n    public void contextinterface() {\n        strategy.algorithminterface();\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class strategypattern {\n    public static void main(string[] args) {\n        context context1 = new context(new concretestrategya());\n        context1.contextinterface();\n\n        context context2 = new context(new concretestrategyb());\n        context2.contextinterface();\n\n        context context3 = new context(new concretestrategyc());\n        context3.contextinterface();\n    }\n}\n\n\nè¾åº\n\nç®æ³a\nç®æ³b\nç®æ³c\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ä¸ä¸æä½¿ç¨äºå¤ä¸ªç­ç¥æ¥æ§è¡ä¸åçè®¡ç®æä½ã\n\n// ç­ç¥æ¥å£å£°æäºæä¸ªç®æ³åä¸ªä¸åçæ¬é´æå±æçæä½ãä¸ä¸æä¼ä½¿ç¨è¯¥æ¥å£æ¥\n// è°ç¨æå·ä½ç­ç¥å®ä¹çç®æ³ã\ninterface strategy is\n    method execute(a, b)\n\n// å·ä½ç­ç¥ä¼å¨éµå¾ªç­ç¥åºç¡æ¥å£çæåµä¸å®ç°ç®æ³ãè¯¥æ¥å£å®ç°äºå®ä»¬å¨ä¸ä¸æ\n// ä¸­çäºæ¢æ§ã\nclass concretestrategyadd implements strategy is\n    method execute(a, b) is\n        return a + b\n\nclass concretestrategysubtract implements strategy is\n    method execute(a, b) is\n        return a - b\n\nclass concretestrategymultiply implements strategy is\n    method execute(a, b) is\n        return a * b\n\n// ä¸ä¸æå®ä¹äºå®¢æ·ç«¯å³æ³¨çæ¥å£ã\nclass context is\n    // ä¸ä¸æä¼ç»´æ¤æåæä¸ªç­ç¥å¯¹è±¡çå¼ç¨ãä¸ä¸æä¸ç¥æç­ç¥çå·ä½ç±»ãä¸ä¸\n    // æå¿é¡»éè¿ç­ç¥æ¥å£æ¥ä¸ææç­ç¥è¿è¡äº¤äºã\n    private strategy: strategy\n\n    // ä¸ä¸æéå¸¸ä¼éè¿æé å½æ°æ¥æ¥æ¶ç­ç¥å¯¹è±¡ï¼åæ¶è¿æä¾è®¾ç½®å¨ä»¥ä¾¿å¨è¿è¡\n    // æ¶åæ¢ç­ç¥ã\n    method setstrategy(strategy strategy) is\n        this.strategy = strategy\n\n    // ä¸ä¸æä¼å°ä¸äºå·¥ä½å§æ´¾ç»ç­ç¥å¯¹è±¡ï¼èä¸æ¯èªè¡å®ç°ä¸åçæ¬çç®æ³ã\n    method executestrategy(int a, int b) is\n        return strategy.execute(a, b)\n\n\n// å®¢æ·ç«¯ä»£ç ä¼éæ©å·ä½ç­ç¥å¹¶å°å¶ä¼ éç»ä¸ä¸æãå®¢æ·ç«¯å¿é¡»ç¥æç­ç¥ä¹é´çå·®\n// å¼ï¼æè½ååºæ­£ç¡®çéæ©ã\nclass exampleapplication is\n    method main() is\n\n        åå»ºä¸ä¸æå¯¹è±¡ã\n\n        è¯»åç¬¬ä¸ä¸ªæ°ã\n        è¯»åæåä¸ä¸ªæ°ã\n        ä»ç¨æ·è¾å¥ä¸­è¯»åææè¿è¡çè¡ä¸ºã\n\n        if (action == addition) then\n            context.setstrategy(new concretestrategyadd())\n\n        if (action == subtraction) then\n            context.setstrategy(new concretestrategysubtract())\n\n        if (action == multiplication) then\n            context.setstrategy(new concretestrategymultiply())\n\n        result = context.executestrategy(first number, second number)\n\n        æå°ç»æã\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ ç­ç¥æ¨¡å¼å¨ java ä»£ç ä¸­å¾å¸¸è§ã å®ç»å¸¸å¨åç§æ¡æ¶ä¸­ä½¿ç¨ï¼ è½å¨ä¸æ©å±ç±»çæåµä¸åç¨æ·æä¾æ¹åå¶è¡ä¸ºçæ¹å¼ã\n\njava 8 å¼å§æ¯æ lambda æ¹æ³ï¼ å®å¯ä½ä¸ºä¸ç§æ¿ä»£ç­ç¥æ¨¡å¼çç®åæ¹å¼ã\n\nè¿éæä¸äºæ ¸å¿ java ç¨åºåºä¸­ç­ç¥æ¨¡å¼çç¤ºä¾ï¼\n\n * å¯¹ java.util.comparator#compare() çè°ç¨æ¥èª collections#sort().\n * javax.servlet.http.httpservletï¼ serviceÂ­()æ¹æ³ï¼ è¿ææææ¥å httpÂ­servletÂ­requestå httpÂ­servletÂ­responseå¯¹è±¡ä½ä¸ºåæ°ç doÂ­xxx()æ¹æ³ã\n * javax.servlet.filter#dofilter()\n\nè¯å«æ¹æ³ï¼ ç­ç¥æ¨¡å¼å¯ä»¥éè¿åè®¸åµå¥å¯¹è±¡å®æå®éå·¥ä½çæ¹æ³ä»¥ååè®¸å°è¯¥å¯¹è±¡æ¿æ¢ä¸ºä¸åå¯¹è±¡çè®¾ç½®å¨æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * å½ä»¤æ¨¡å¼åç­ç¥çä¸å»å¾åï¼ å ä¸ºä¸¤èé½è½éè¿æäºè¡ä¸ºæ¥åæ°åå¯¹è±¡ã ä½æ¯ï¼ å®ä»¬çæå¾æéå¸¸å¤§çä¸åã\n   * ä½ å¯ä»¥ä½¿ç¨å½ä»¤æ¥å°ä»»ä½æä½è½¬æ¢ä¸ºå¯¹è±¡ã æä½çåæ°å°æä¸ºå¯¹è±¡çæååéã ä½ å¯ä»¥éè¿è½¬æ¢æ¥å»¶è¿æä½çæ§è¡ã å°æä½æ¾å¥éåã ä¿å­åå²å½ä»¤æèåè¿ç¨æå¡åéå½ä»¤ç­ã\n   * å¦ä¸æ¹é¢ï¼ ç­ç¥éå¸¸å¯ç¨äºæè¿°å®ææä»¶äºçä¸åæ¹å¼ï¼ è®©ä½ è½å¤å¨åä¸ä¸ªä¸ä¸æç±»ä¸­åæ¢ç®æ³ã\n * è£é¥°æ¨¡å¼å¯è®©ä½ æ´æ¹å¯¹è±¡çå¤è¡¨ï¼ ç­ç¥åè®©ä½ è½å¤æ¹åå¶æ¬è´¨ã\n * æ¨¡æ¿æ¹æ³æ¨¡å¼åºäºç»§æ¿æºå¶ï¼ å®åè®¸ä½ éè¿æ©å±å­ç±»ä¸­çé¨ååå®¹æ¥æ¹åé¨åç®æ³ã ç­ç¥åºäºç»åæºå¶ï¼ ä½ å¯ä»¥éè¿å¯¹ç¸åºè¡ä¸ºæä¾ä¸åçç­ç¥æ¥æ¹åå¯¹è±¡çé¨åè¡ä¸ºã æ¨¡æ¿æ¹æ³å¨ç±»å±æ¬¡ä¸è¿ä½ï¼ å æ­¤å®æ¯éæçã ç­ç¥å¨å¯¹è±¡å±æ¬¡ä¸è¿ä½ï¼ å æ­¤åè®¸å¨è¿è¡æ¶åæ¢è¡ä¸ºã\n * ç¶æå¯è¢«è§ä¸ºç­ç¥çæ©å±ã ä¸¤èé½åºäºç»åæºå¶ï¼ å®ä»¬é½éè¿å°é¨åå·¥ä½å§æ´¾ç» âå¸®æâ å¯¹è±¡æ¥æ¹åå¶å¨ä¸åææ¯ä¸çè¡ä¸ºã ç­ç¥ä½¿å¾è¿äºå¯¹è±¡ç¸äºä¹é´å®å¨ç¬ç«ï¼ å®ä»¬ä¸ç¥éå¶ä»å¯¹è±¡çå­å¨ã ä½ç¶ææ¨¡å¼æ²¡æéå¶å·ä½ç¶æä¹é´çä¾èµï¼ ä¸åè®¸å®ä»¬èªè¡æ¹åå¨ä¸åææ¯ä¸çç¶æã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹è®¿é®èæ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹è®¿é®èæ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-22T18:25:00.000Z",permalink:"/pages/6e8ebc/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/23.%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/23.è®¿é®èæ¨¡å¼.md",key:"v-0f7af49e",path:"/pages/6e8ebc/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:17},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:73},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:208},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:218},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:644},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:3227},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:4999},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:5365},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:5511}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹è®¿é®èæ¨¡å¼\n\n\n# 1. æå¾\n\nè®¿é®èæ¨¡å¼ï¼Visitorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®è½å°ç®æ³ä¸å¶æä½ç¨çå¯¹è±¡éç¦»å¼æ¥ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦å¯¹ä¸ä¸ªå¤æå¯¹è±¡ç»æ ï¼ä¾å¦å¯¹è±¡æ ï¼ ä¸­çææåç´ æ§è¡æäºæä½ï¼ å¯ä½¿ç¨è®¿é®èæ¨¡å¼ã\n * å¯ä½¿ç¨è®¿é®èæ¨¡å¼æ¥æ¸çè¾å©è¡ä¸ºçä¸å¡é»è¾ã\n * å½æä¸ªè¡ä¸ºä»å¨ç±»å±æ¬¡ç»æä¸­çä¸äºç±»ä¸­ææä¹ï¼ èå¨å¶ä»ç±»ä¸­æ²¡ææä¹æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. è®¿é®è ï¼Visitorï¼ æ¥å£å£°æäºä¸ç³»åä»¥å¯¹è±¡ç»æçå·ä½åç´ ä¸ºåæ°çè®¿é®èæ¹æ³ã å¦æç¼ç¨è¯­è¨æ¯æéè½½ï¼ è¿äºæ¹æ³çåç§°å¯ä»¥æ¯ç¸åçï¼ ä½æ¯å¶åæ°ä¸å®æ¯ä¸åçã\n 2. å·ä½è®¿é®è ï¼Concrete Visitorï¼ ä¼ä¸ºä¸åçå·ä½åç´ ç±»å®ç°ç¸åè¡ä¸ºçå ä¸ªä¸åçæ¬ã\n 3. åç´  ï¼Elementï¼ æ¥å£å£°æäºä¸ä¸ªæ¹æ³æ¥ âæ¥æ¶â è®¿é®èã è¯¥æ¹æ³å¿é¡»æä¸ä¸ªåæ°è¢«å£°æä¸ºè®¿é®èæ¥å£ç±»åã\n 4. å·ä½åç´  ï¼Concrete Elementï¼ å¿é¡»å®ç°æ¥æ¶æ¹æ³ã è¯¥æ¹æ³çç®çæ¯æ ¹æ®å½ååç´ ç±»å°å¶è°ç¨éå®åå°ç¸åºè®¿é®èçæ¹æ³ã è¯·æ³¨æï¼ å³ä½¿åç´ åºç±»å®ç°äºè¯¥æ¹æ³ï¼ ææå­ç±»é½å¿é¡»å¯¹å¶è¿è¡éåå¹¶è°ç¨è®¿é®èå¯¹è±¡ä¸­çåéæ¹æ³ã\n 5. å®¢æ·ç«¯ ï¼Clientï¼ éå¸¸ä¼ä½ä¸ºéåæå¶ä»å¤æå¯¹è±¡ ï¼ä¾å¦ä¸ä¸ªç»åæ ï¼ çä»£è¡¨ã å®¢æ·ç«¯éå¸¸ä¸ç¥æææçå·ä½åç´ ç±»ï¼ å ä¸ºå®ä»¬ä¼éè¿æ½è±¡æ¥å£ä¸éåä¸­çå¯¹è±¡è¿è¡äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nVisitor : ä¸ºè¯¥å¯¹è±¡ç»æä¸­ ConcreteElement çæ¯ä¸ä¸ªç±»å£°æä¸ä¸ª Visit æä½ã\n\nabstract class Visitor {\n    public abstract void VisitConcreteElementA(ConcreteElementA elementA);\n    public abstract void VisitConcreteElementB(ConcreteElementB elementB);\n}\n\n\nConcreteVisitor : å®ç°æ¯ä¸ªç± Visitor å£°æçæä½ãæ¯ä¸ªæä½å®ç°ç®æ³çä¸é¨åï¼èè¯¥ç®æ³çæ®µä¹æ¯å¯¹åºäºç»æä¸­å¯¹è±¡çç±»ã\n\nclass ConcreteVisitor1 extends Visitor {\n    @Override\n    public void VisitConcreteElementA(ConcreteElementA elementA) {\n        System.out.println(this.getClass().getName() + " è®¿é® " + elementA.getClass().getName());\n    }\n\n    @Override\n    public void VisitConcreteElementB(ConcreteElementB elementB) {\n        System.out.println(this.getClass().getName() + " è®¿é® " + elementB.getClass().getName());\n    }\n}\n\nclass ConcreteVisitor2 extends Visitor {\n    @Override\n    public void VisitConcreteElementA(ConcreteElementA elementA) {\n        System.out.println(this.getClass().getName() + " è®¿é® " + elementA.getClass().getName());\n    }\n\n    @Override\n    public void VisitConcreteElementB(ConcreteElementB elementB) {\n        System.out.println(this.getClass().getName() + " è®¿é® " + elementB.getClass().getName());\n    }\n}\n\n\nElement : å®ä¹ä¸ä¸ª Accpet æä½ï¼å®ä»¥ä¸ä¸ªè®¿é®èä¸ºåæ°ã\n\nabstract class Element {\n    public abstract void Accept(Visitor visitor);\n}\n\n\nConcreteElement : å®ç° Element å£°æç Accept æä½ã\n\nclass ConcreteElementA extends Element {\n    @Override\n    public void Accept(Visitor visitor) {\n        visitor.VisitConcreteElementA(this);\n    }\n}\n\nclass ConcreteElementB extends Element {\n    @Override\n    public void Accept(Visitor visitor) {\n        visitor.VisitConcreteElementB(this);\n    }\n}\n\n\nObjectStructure : å¯ä»¥æä¸¾å®çåç´ ï¼å¯ä»¥æä¾ä¸ä¸ªé«å±çæ¥å£ä»¥åè®¸è®¿é®èè®¿é®å®çåç´ ã\n\nclass ObjectStructure {\n    private List<Element> elements = new ArrayList<Element>();\n\n    public void Attach(Element element) {\n        elements.add(element);\n    }\n\n    public void Detach(Element element) {\n        elements.remove(element);\n    }\n\n    public void Accept(Visitor visitor) {\n        for (Element elem : elements) {\n            elem.Accept(visitor);\n        }\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class VisitorPattern {\n    public static void main(String[] args) {\n        ObjectStructure o = new ObjectStructure();\n        o.Attach(new ConcreteElementA());\n        o.Attach(new ConcreteElementB());\n\n        ConcreteVisitor1 v1 = new ConcreteVisitor1();\n        ConcreteVisitor2 v2 = new ConcreteVisitor2();\n\n        o.Accept(v1);\n        o.Accept(v2);\n    }\n}\n\n\nè¾åº\n\nConcreteVisitor1 è®¿é® ConcreteElementA\nConcreteVisitor1 è®¿é® ConcreteElementB\nConcreteVisitor2 è®¿é® ConcreteElementA\nConcreteVisitor2 è®¿é® ConcreteElementB\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è®¿é®èæ¨¡å¼ä¸ºå ä½å¾åå±æ¬¡ç»ææ·»å äºå¯¹äº XML æä»¶å¯¼åºåè½çæ¯æã\n\n\n\n// åç´ æ¥å£å£°æäºä¸ä¸ª`acceptï¼æ¥æ¶ï¼`æ¹æ³ï¼å®ä¼å°è®¿é®èåºç¡æ¥å£ä½ä¸ºä¸ä¸ªå\n// æ°ã\ninterface Shape is\n    method move(x, y)\n    method draw()\n    method accept(v: Visitor)\n\n// æ¯ä¸ªå·ä½åç´ ç±»é½å¿é¡»ä»¥ç¹å®æ¹å¼å®ç°`accept`æ¹æ³ï¼ä½¿å¶è½è°ç¨ç¸åºåç´ ç±»ç\n// è®¿é®èæ¹æ³ã\nclass Dot implements Shape is\n    // ...\n\n    // æ³¨ææä»¬æ­£å¨è°ç¨ç`visitDotï¼è®¿é®ç¹ï¼`æ¹æ³ä¸å½åç±»çåç§°ç¸å¹éã\n    // è¿æ ·æä»¬è½è®©è®¿é®èç¥æä¸å¶äº¤äºçåç´ ç±»ã\n    method accept(v: Visitor) is\n        v.visitDot(this)\n\nclass Circle implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitCircle(this)\n\nclass Rectangle implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitRectangle(this)\n\nclass CompoundShape implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitCompoundShape(this)\n\n\n// è®¿é®èæ¥å£å£°æäºä¸ç»ä¸åç´ ç±»å¯¹åºçè®¿é®æ¹æ³ãè®¿é®æ¹æ³çç­¾åè½è®©è®¿é®èå\n// ç¡®è¾¨å«åºä¸å¶äº¤äºçåç´ æå±çç±»ã\ninterface Visitor is\n    method visitDot(d: Dot)\n    method visitCircle(c: Circle)\n    method visitRectangle(r: Rectangle)\n    method visitCompoundShape(cs: CompoundShape)\n\n// å·ä½è®¿é®èå®ç°äºåä¸ç®æ³çå¤ä¸ªçæ¬ï¼èä¸è¯¥ç®æ³è½ä¸ææå·ä½ç±»è¿è¡äº¤äºã\n//\n// è®¿é®èæ¨¡å¼å¨å¤æå¯¹è±¡ç»æï¼ä¾å¦ç»åæ ï¼ä¸ä½¿ç¨æ¶è½åæ¥æå¤§ä½ç¨ãå¨è¿ç§æ\n// åµä¸ï¼å®å¯ä»¥å­å¨ç®æ³çä¸äºä¸­é´ç¶æï¼å¹¶åæ¶å¨ç»æä¸­çä¸åå¯¹è±¡ä¸æ§è¡è®¿é®\n// èæ¹æ³ãè¿å¯è½ä¼éå¸¸æå¸®å©ã\nclass XMLExportVisitor implements Visitor is\n    method visitDot(d: Dot) is\n        // å¯¼åºç¹ï¼dotï¼ç ID åä¸­å¿åæ ã\n\n    method visitCircle(c: Circle) is\n        // å¯¼åºåï¼circleï¼ç ID ãä¸­å¿åæ ååå¾ã\n\n    method visitRectangle(r: Rectangle) is\n        // å¯¼åºé¿æ¹å½¢ï¼rectangleï¼ç ID ãå·¦ä¸è§åæ ãå®½åé¿ã\n\n    method visitCompoundShape(cs: CompoundShape) is\n        // å¯¼åºå¾å½¢ï¼shapeï¼ç ID åå¶å­é¡¹ç®ç ID åè¡¨ã\n\n\n// å®¢æ·ç«¯ä»£ç å¯å¨ä¸ç¥æå·ä½ç±»çæåµä¸å¨ä¸ç»åç´ ä¸è¿è¡è®¿é®èæä½ãâæ¥æ¶âæ\n// ä½ä¼å°è°ç¨å®ä½å°è®¿é®èå¯¹è±¡çç¸åºæä½ä¸ã\nclass Application is\n    field allShapes: array of Shapes\n\n    method export() is\n        exportVisitor = new XMLExportVisitor()\n\n        foreach (shape in allShapes) do\n            shape.accept(exportVisitor)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è®¿é®èä¸æ¯å¸¸ç¨çè®¾è®¡æ¨¡å¼ï¼ å ä¸ºå®ä¸ä»å¤æï¼ åºç¨èå´ä¹æ¯è¾ç­çªã\n\nè¿éæ¯ Java ç¨åºåºä»£ç ä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * javax.lang.model.element.AnnotationValue å AnnotationÂ­ValueÂ­Visitor\n * javax.lang.model.element.Element å ElementÂ­Visitor\n * javax.lang.model.type.TypeMirror å TypeÂ­Visitor\n * java.nio.file.FileVisitor å SimpleÂ­FileÂ­Visitor\n * javax.faces.component.visit.VisitContext å VisitÂ­Callback\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥å°è®¿é®èæ¨¡å¼è§ä¸ºå½ä»¤æ¨¡å¼çå å¼ºçæ¬ï¼ å¶å¯¹è±¡å¯å¯¹ä¸åç±»çå¤ç§å¯¹è±¡æ§è¡æä½ã\n * ä½ å¯ä»¥ä½¿ç¨è®¿é®èå¯¹æ´ä¸ªç»åæ¨¡å¼æ æ§è¡æä½ã\n * å¯ä»¥åæ¶ä½¿ç¨è®¿é®èåè¿­ä»£å¨æ¨¡å¼æ¥éåå¤ææ°æ®ç»æï¼ å¹¶å¯¹å¶ä¸­çåç´ æ§è¡æéæä½ï¼ å³ä½¿è¿äºåç´ æå±çç±»å®å¨ä¸åã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹è®¿é®èæ¨¡å¼\n\n\n# 1. æå¾\n\nè®¿é®èæ¨¡å¼ï¼visitorï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ å®è½å°ç®æ³ä¸å¶æä½ç¨çå¯¹è±¡éç¦»å¼æ¥ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æä½ éè¦å¯¹ä¸ä¸ªå¤æå¯¹è±¡ç»æ ï¼ä¾å¦å¯¹è±¡æ ï¼ ä¸­çææåç´ æ§è¡æäºæä½ï¼ å¯ä½¿ç¨è®¿é®èæ¨¡å¼ã\n * å¯ä½¿ç¨è®¿é®èæ¨¡å¼æ¥æ¸çè¾å©è¡ä¸ºçä¸å¡é»è¾ã\n * å½æä¸ªè¡ä¸ºä»å¨ç±»å±æ¬¡ç»æä¸­çä¸äºç±»ä¸­ææä¹ï¼ èå¨å¶ä»ç±»ä¸­æ²¡ææä¹æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. è®¿é®è ï¼visitorï¼ æ¥å£å£°æäºä¸ç³»åä»¥å¯¹è±¡ç»æçå·ä½åç´ ä¸ºåæ°çè®¿é®èæ¹æ³ã å¦æç¼ç¨è¯­è¨æ¯æéè½½ï¼ è¿äºæ¹æ³çåç§°å¯ä»¥æ¯ç¸åçï¼ ä½æ¯å¶åæ°ä¸å®æ¯ä¸åçã\n 2. å·ä½è®¿é®è ï¼concrete visitorï¼ ä¼ä¸ºä¸åçå·ä½åç´ ç±»å®ç°ç¸åè¡ä¸ºçå ä¸ªä¸åçæ¬ã\n 3. åç´  ï¼elementï¼ æ¥å£å£°æäºä¸ä¸ªæ¹æ³æ¥ âæ¥æ¶â è®¿é®èã è¯¥æ¹æ³å¿é¡»æä¸ä¸ªåæ°è¢«å£°æä¸ºè®¿é®èæ¥å£ç±»åã\n 4. å·ä½åç´  ï¼concrete elementï¼ å¿é¡»å®ç°æ¥æ¶æ¹æ³ã è¯¥æ¹æ³çç®çæ¯æ ¹æ®å½ååç´ ç±»å°å¶è°ç¨éå®åå°ç¸åºè®¿é®èçæ¹æ³ã è¯·æ³¨æï¼ å³ä½¿åç´ åºç±»å®ç°äºè¯¥æ¹æ³ï¼ ææå­ç±»é½å¿é¡»å¯¹å¶è¿è¡éåå¹¶è°ç¨è®¿é®èå¯¹è±¡ä¸­çåéæ¹æ³ã\n 5. å®¢æ·ç«¯ ï¼clientï¼ éå¸¸ä¼ä½ä¸ºéåæå¶ä»å¤æå¯¹è±¡ ï¼ä¾å¦ä¸ä¸ªç»åæ ï¼ çä»£è¡¨ã å®¢æ·ç«¯éå¸¸ä¸ç¥æææçå·ä½åç´ ç±»ï¼ å ä¸ºå®ä»¬ä¼éè¿æ½è±¡æ¥å£ä¸éåä¸­çå¯¹è±¡è¿è¡äº¤äºã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nvisitor : ä¸ºè¯¥å¯¹è±¡ç»æä¸­ concreteelement çæ¯ä¸ä¸ªç±»å£°æä¸ä¸ª visit æä½ã\n\nabstract class visitor {\n    public abstract void visitconcreteelementa(concreteelementa elementa);\n    public abstract void visitconcreteelementb(concreteelementb elementb);\n}\n\n\nconcretevisitor : å®ç°æ¯ä¸ªç± visitor å£°æçæä½ãæ¯ä¸ªæä½å®ç°ç®æ³çä¸é¨åï¼èè¯¥ç®æ³çæ®µä¹æ¯å¯¹åºäºç»æä¸­å¯¹è±¡çç±»ã\n\nclass concretevisitor1 extends visitor {\n    @override\n    public void visitconcreteelementa(concreteelementa elementa) {\n        system.out.println(this.getclass().getname() + " è®¿é® " + elementa.getclass().getname());\n    }\n\n    @override\n    public void visitconcreteelementb(concreteelementb elementb) {\n        system.out.println(this.getclass().getname() + " è®¿é® " + elementb.getclass().getname());\n    }\n}\n\nclass concretevisitor2 extends visitor {\n    @override\n    public void visitconcreteelementa(concreteelementa elementa) {\n        system.out.println(this.getclass().getname() + " è®¿é® " + elementa.getclass().getname());\n    }\n\n    @override\n    public void visitconcreteelementb(concreteelementb elementb) {\n        system.out.println(this.getclass().getname() + " è®¿é® " + elementb.getclass().getname());\n    }\n}\n\n\nelement : å®ä¹ä¸ä¸ª accpet æä½ï¼å®ä»¥ä¸ä¸ªè®¿é®èä¸ºåæ°ã\n\nabstract class element {\n    public abstract void accept(visitor visitor);\n}\n\n\nconcreteelement : å®ç° element å£°æç accept æä½ã\n\nclass concreteelementa extends element {\n    @override\n    public void accept(visitor visitor) {\n        visitor.visitconcreteelementa(this);\n    }\n}\n\nclass concreteelementb extends element {\n    @override\n    public void accept(visitor visitor) {\n        visitor.visitconcreteelementb(this);\n    }\n}\n\n\nobjectstructure : å¯ä»¥æä¸¾å®çåç´ ï¼å¯ä»¥æä¾ä¸ä¸ªé«å±çæ¥å£ä»¥åè®¸è®¿é®èè®¿é®å®çåç´ ã\n\nclass objectstructure {\n    private list<element> elements = new arraylist<element>();\n\n    public void attach(element element) {\n        elements.add(element);\n    }\n\n    public void detach(element element) {\n        elements.remove(element);\n    }\n\n    public void accept(visitor visitor) {\n        for (element elem : elements) {\n            elem.accept(visitor);\n        }\n    }\n}\n\n\nå®¢æ·ç«¯\n\npublic class visitorpattern {\n    public static void main(string[] args) {\n        objectstructure o = new objectstructure();\n        o.attach(new concreteelementa());\n        o.attach(new concreteelementb());\n\n        concretevisitor1 v1 = new concretevisitor1();\n        concretevisitor2 v2 = new concretevisitor2();\n\n        o.accept(v1);\n        o.accept(v2);\n    }\n}\n\n\nè¾åº\n\nconcretevisitor1 è®¿é® concreteelementa\nconcretevisitor1 è®¿é® concreteelementb\nconcretevisitor2 è®¿é® concreteelementa\nconcretevisitor2 è®¿é® concreteelementb\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ è®¿é®èæ¨¡å¼ä¸ºå ä½å¾åå±æ¬¡ç»ææ·»å äºå¯¹äº xml æä»¶å¯¼åºåè½çæ¯æã\n\n\n\n// åç´ æ¥å£å£°æäºä¸ä¸ª`acceptï¼æ¥æ¶ï¼`æ¹æ³ï¼å®ä¼å°è®¿é®èåºç¡æ¥å£ä½ä¸ºä¸ä¸ªå\n// æ°ã\ninterface shape is\n    method move(x, y)\n    method draw()\n    method accept(v: visitor)\n\n// æ¯ä¸ªå·ä½åç´ ç±»é½å¿é¡»ä»¥ç¹å®æ¹å¼å®ç°`accept`æ¹æ³ï¼ä½¿å¶è½è°ç¨ç¸åºåç´ ç±»ç\n// è®¿é®èæ¹æ³ã\nclass dot implements shape is\n    // ...\n\n    // æ³¨ææä»¬æ­£å¨è°ç¨ç`visitdotï¼è®¿é®ç¹ï¼`æ¹æ³ä¸å½åç±»çåç§°ç¸å¹éã\n    // è¿æ ·æä»¬è½è®©è®¿é®èç¥æä¸å¶äº¤äºçåç´ ç±»ã\n    method accept(v: visitor) is\n        v.visitdot(this)\n\nclass circle implements shape is\n    // ...\n    method accept(v: visitor) is\n        v.visitcircle(this)\n\nclass rectangle implements shape is\n    // ...\n    method accept(v: visitor) is\n        v.visitrectangle(this)\n\nclass compoundshape implements shape is\n    // ...\n    method accept(v: visitor) is\n        v.visitcompoundshape(this)\n\n\n// è®¿é®èæ¥å£å£°æäºä¸ç»ä¸åç´ ç±»å¯¹åºçè®¿é®æ¹æ³ãè®¿é®æ¹æ³çç­¾åè½è®©è®¿é®èå\n// ç¡®è¾¨å«åºä¸å¶äº¤äºçåç´ æå±çç±»ã\ninterface visitor is\n    method visitdot(d: dot)\n    method visitcircle(c: circle)\n    method visitrectangle(r: rectangle)\n    method visitcompoundshape(cs: compoundshape)\n\n// å·ä½è®¿é®èå®ç°äºåä¸ç®æ³çå¤ä¸ªçæ¬ï¼èä¸è¯¥ç®æ³è½ä¸ææå·ä½ç±»è¿è¡äº¤äºã\n//\n// è®¿é®èæ¨¡å¼å¨å¤æå¯¹è±¡ç»æï¼ä¾å¦ç»åæ ï¼ä¸ä½¿ç¨æ¶è½åæ¥æå¤§ä½ç¨ãå¨è¿ç§æ\n// åµä¸ï¼å®å¯ä»¥å­å¨ç®æ³çä¸äºä¸­é´ç¶æï¼å¹¶åæ¶å¨ç»æä¸­çä¸åå¯¹è±¡ä¸æ§è¡è®¿é®\n// èæ¹æ³ãè¿å¯è½ä¼éå¸¸æå¸®å©ã\nclass xmlexportvisitor implements visitor is\n    method visitdot(d: dot) is\n        // å¯¼åºç¹ï¼dotï¼ç id åä¸­å¿åæ ã\n\n    method visitcircle(c: circle) is\n        // å¯¼åºåï¼circleï¼ç id ãä¸­å¿åæ ååå¾ã\n\n    method visitrectangle(r: rectangle) is\n        // å¯¼åºé¿æ¹å½¢ï¼rectangleï¼ç id ãå·¦ä¸è§åæ ãå®½åé¿ã\n\n    method visitcompoundshape(cs: compoundshape) is\n        // å¯¼åºå¾å½¢ï¼shapeï¼ç id åå¶å­é¡¹ç®ç id åè¡¨ã\n\n\n// å®¢æ·ç«¯ä»£ç å¯å¨ä¸ç¥æå·ä½ç±»çæåµä¸å¨ä¸ç»åç´ ä¸è¿è¡è®¿é®èæä½ãâæ¥æ¶âæ\n// ä½ä¼å°è°ç¨å®ä½å°è®¿é®èå¯¹è±¡çç¸åºæä½ä¸ã\nclass application is\n    field allshapes: array of shapes\n\n    method export() is\n        exportvisitor = new xmlexportvisitor()\n\n        foreach (shape in allshapes) do\n            shape.accept(exportvisitor)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ è®¿é®èä¸æ¯å¸¸ç¨çè®¾è®¡æ¨¡å¼ï¼ å ä¸ºå®ä¸ä»å¤æï¼ åºç¨èå´ä¹æ¯è¾ç­çªã\n\nè¿éæ¯ java ç¨åºåºä»£ç ä¸­è¯¥æ¨¡å¼çä¸äºç¤ºä¾ï¼\n\n * javax.lang.model.element.annotationvalue å annotationÂ­valueÂ­visitor\n * javax.lang.model.element.element å elementÂ­visitor\n * javax.lang.model.type.typemirror å typeÂ­visitor\n * java.nio.file.filevisitor å simpleÂ­fileÂ­visitor\n * javax.faces.component.visit.visitcontext å visitÂ­callback\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * ä½ å¯ä»¥å°è®¿é®èæ¨¡å¼è§ä¸ºå½ä»¤æ¨¡å¼çå å¼ºçæ¬ï¼ å¶å¯¹è±¡å¯å¯¹ä¸åç±»çå¤ç§å¯¹è±¡æ§è¡æä½ã\n * ä½ å¯ä»¥ä½¿ç¨è®¿é®èå¯¹æ´ä¸ªç»åæ¨¡å¼æ æ§è¡æä½ã\n * å¯ä»¥åæ¶ä½¿ç¨è®¿é®èåè¿­ä»£å¨æ¨¡å¼æ¥éåå¤ææ°æ®ç»æï¼ å¹¶å¯¹å¶ä¸­çåç´ æ§è¡æéæä½ï¼ å³ä½¿è¿äºåç´ æå±çç±»å®å¨ä¸åã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼ä¹ç¶ææ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼ä¹ç¶ææ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2015-01-23T10:29:00.000Z",permalink:"/pages/6420d5/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/24.%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/24.ç¶ææ¨¡å¼.md",key:"v-1457855d",path:"/pages/6420d5/",headers:[{level:2,title:"1. æå¾",slug:"_1-æå¾",normalizedTitle:"1. æå¾",charIndex:16},{level:2,title:"2. éç¨åºæ¯",slug:"_2-éç¨åºæ¯",normalizedTitle:"2. éç¨åºæ¯",charIndex:93},{level:2,title:"3. ç»æ",slug:"_3-ç»æ",normalizedTitle:"3. ç»æ",charIndex:260},{level:3,title:"3.1. ç»æè¯´æ",slug:"_3-1-ç»æè¯´æ",normalizedTitle:"3.1. ç»æè¯´æ",charIndex:270},{level:3,title:"3.2. ç»æä»£ç èå¼",slug:"_3-2-ç»æä»£ç èå¼",normalizedTitle:"3.2. ç»æä»£ç èå¼",charIndex:656},{level:2,title:"4. ä¼ªä»£ç ",slug:"_4-ä¼ªä»£ç ",normalizedTitle:"4. ä¼ªä»£ç ",charIndex:1796},{level:2,title:"5. æ¡ä¾",slug:"_5-æ¡ä¾",normalizedTitle:"5. æ¡ä¾",charIndex:4765},{level:2,title:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",slug:"_6-ä¸å¶ä»æ¨¡å¼çå³ç³»",normalizedTitle:"6. ä¸å¶ä»æ¨¡å¼çå³ç³»",charIndex:4986},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:5275}],headersStr:"1. æå¾ 2. éç¨åºæ¯ 3. ç»æ 3.1. ç»æè¯´æ 3.2. ç»æä»£ç èå¼ 4. ä¼ªä»£ç  5. æ¡ä¾ 6. ä¸å¶ä»æ¨¡å¼çå³ç³» 7. åèèµæ",content:'# è®¾è®¡æ¨¡å¼ä¹ç¶ææ¨¡å¼\n\n\n# 1. æå¾\n\nç¶ææ¨¡å¼ï¼Stateï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¨ä¸ä¸ªå¯¹è±¡çåé¨ç¶æååæ¶æ¹åå¶è¡ä¸ºï¼ ä½¿å¶çä¸å»å°±åæ¹åäºèªèº«æå±çç±»ä¸æ ·ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æå¯¹è±¡éè¦æ ¹æ®èªèº«å½åç¶æè¿è¡ä¸åè¡ä¸ºï¼ åæ¶ç¶æçæ°ééå¸¸å¤ä¸ä¸ç¶æç¸å³çä»£ç ä¼é¢ç¹åæ´çè¯ï¼ å¯ä½¿ç¨ç¶ææ¨¡å¼ã\n * å¦ææä¸ªç±»éè¦æ ¹æ®æååéçå½åå¼æ¹åèªèº«è¡ä¸ºï¼ ä»èéè¦ä½¿ç¨å¤§éçæ¡ä»¶è¯­å¥æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n * å½ç¸ä¼¼ç¶æååºäºæ¡ä»¶çç¶ææºè½¬æ¢ä¸­å­å¨è®¸å¤éå¤ä»£ç æ¶ï¼ å¯ä½¿ç¨ç¶ææ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. ä¸ä¸æ ï¼Contextï¼ ä¿å­äºå¯¹äºä¸ä¸ªå·ä½ç¶æå¯¹è±¡çå¼ç¨ï¼ å¹¶ä¼å°ææä¸è¯¥ç¶æç¸å³çå·¥ä½å§æ´¾ç»å®ã ä¸ä¸æéè¿ç¶ææ¥å£ä¸ç¶æå¯¹è±¡äº¤äºï¼ ä¸ä¼æä¾ä¸ä¸ªè®¾ç½®å¨ç¨äºä¼ éæ°çç¶æå¯¹è±¡ã\n 2. ç¶æ ï¼Stateï¼ æ¥å£ä¼å£°æç¹å®äºç¶æçæ¹æ³ã è¿äºæ¹æ³åºè½è¢«å¶ä»ææå·ä½ç¶ææçè§£ï¼ å ä¸ºä½ ä¸å¸ææäºç¶æææ¥æçæ¹æ³æ°¸è¿ä¸ä¼è¢«è°ç¨ã\n 3. å·ä½ç¶æ ï¼Concrete Statesï¼ ä¼èªè¡å®ç°ç¹å®äºç¶æçæ¹æ³ã ä¸ºäºé¿åå¤ä¸ªç¶æä¸­åå«ç¸ä¼¼ä»£ç ï¼ ä½ å¯ä»¥æä¾ä¸ä¸ªå°è£æé¨åéç¨è¡ä¸ºçä¸­é´æ½è±¡ç±»ã\n    * ç¶æå¯¹è±¡å¯å­å¨å¯¹äºä¸ä¸æå¯¹è±¡çååå¼ç¨ã ç¶æå¯ä»¥éè¿è¯¥å¼ç¨ä»ä¸ä¸æå¤è·åæéä¿¡æ¯ï¼ å¹¶ä¸è½è§¦åç¶æè½¬ç§»ã\n 4. ä¸ä¸æåå·ä½ç¶æé½å¯ä»¥è®¾ç½®ä¸ä¸æçä¸ä¸ªç¶æï¼ å¹¶å¯éè¿æ¿æ¢è¿æ¥å°ä¸ä¸æçç¶æå¯¹è±¡æ¥å®æå®éçç¶æè½¬æ¢ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nState : å®ä¹ä¸ä¸ªæ¥å£ä»¥å°è£ä¸ Context çä¸ä¸ªç¹å®ç¶æç¸å³çè¡ä¸ºã\n\nabstract class State {\n    public abstract void Handle(Context context);\n}\n\n\nConcreteState : æ¯ä¸ä¸ªå­ç±»å®ç°ä¸ä¸ªä¸ Context çä¸ä¸ªç¶æç¸å³çè¡ä¸ºã\n\nclass ConcreteStateA extends State {\n    @Override\n    public void Handle(Context context) {\n        context.SetState(new ConcreteStateB());\n    }\n}\n\nclass ConcreteStateB extends State {\n    @Override\n    public void Handle(Context context) {\n        context.SetState(new ConcreteStateA());\n    }\n}\n\n\nContext : ç»´æ¤ä¸ä¸ª ConcreteState å­ç±»çå®ä¾ï¼è¿ä¸ªå®ä¾å®ä¹å½åçç¶æã\n\nclass Context {\n    private State state;\n    public Context(State state) {\n        this.state = state;\n    }\n\n    public void SetState(State state) {\n        this.state = state;\n        System.out.println("å½åç¶æï¼" + state.getClass().getName());\n    }\n    public State GetState() {\n        return state;\n    }\n\n    public void Request() {\n        state.Handle(this);\n    }\n}\n\n\n\nå®¢æ·ç«¯\n\npublic class StatePattern {\n    public static void main(String[] args) {\n        Context c = new Context(new ConcreteStateA());\n        c.Request();\n        c.Request();\n    }\n}\n\n\nè¾åº\n\nå½åç¶æï¼ConcreteStateB\nå½åç¶æï¼ConcreteStateA\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ç¶ææ¨¡å¼å°æ ¹æ®å½ååæ¾ç¶æï¼ è®©åªä½æ­æ¾å¨ä¸­çç¸åæ§ä»¶å®æä¸åçè¡ä¸ºã\n\n\n\næ­æ¾å¨çä¸»è¦å¯¹è±¡æ»æ¯ä¼è¿æ¥å°ä¸ä¸ªè´è´£æ­æ¾å¨ç»å¤§é¨åå·¥ä½çç¶æå¯¹è±¡ä¸­ã é¨åæä½ä¼æ´æ¢æ­æ¾å¨å½åçç¶æå¯¹è±¡ï¼ ä»¥æ­¤æ¹åæ­æ¾å¨å¯¹äºç¨æ·äºå¨æä½åºçååºã\n\n// é³é¢æ­æ¾å¨ï¼AudioÂ­Playerï¼ç±»å³ä¸ºä¸ä¸æãå®è¿ä¼ç»´æ¤æåç¶æç±»å®ä¾çå¼ç¨ï¼\n// è¯¥ç¶æç±»åç¨äºè¡¨ç¤ºé³é¢æ­æ¾å¨å½åçç¶æã\nclass AudioPlayer is\n    field state: State\n    field UI, volume, playlist, currentSong\n\n    constructor AudioPlayer() is\n        this.state = new ReadyState(this)\n\n        // ä¸ä¸æä¼å°å¤çç¨æ·è¾å¥çå·¥ä½å§æ´¾ç»ç¶æå¯¹è±¡ãç±äºæ¯ä¸ªç¶æé½ä»¥ä¸\n        // åçæ¹å¼å¤çè¾å¥ï¼å¶ç»æèªç¶å°ä¾èµäºå½åæå¤çç¶æã\n        UI = new UserInterface()\n        UI.lockButton.onClick(this.clickLock)\n        UI.playButton.onClick(this.clickPlay)\n        UI.nextButton.onClick(this.clickNext)\n        UI.prevButton.onClick(this.clickPrevious)\n\n    // å¶ä»å¯¹è±¡å¿é¡»è½åæ¢é³é¢æ­æ¾å¨å½åæå¤çç¶æã\n    method changeState(state: State) is\n        this.state = state\n\n    // UI æ¹æ³ä¼å°æ§è¡å·¥ä½å§æ´¾ç»å½åç¶æã\n    method clickLock() is\n        state.clickLock()\n    method clickPlay() is\n        state.clickPlay()\n    method clickNext() is\n        state.clickNext()\n    method clickPrevious() is\n        state.clickPrevious()\n\n    // ç¶æå¯è°ç¨ä¸ä¸æçä¸äºæå¡æ¹æ³ã\n    method startPlayback() is\n        // ...\n    method stopPlayback() is\n        // ...\n    method nextSong() is\n        // ...\n    method previousSong() is\n        // ...\n    method fastForward(time) is\n        // ...\n    method rewind(time) is\n        // ...\n\n\n// ææå·ä½ç¶æç±»é½å¿é¡»å®ç°ç¶æåºç±»å£°æçæ¹æ³ï¼å¹¶æä¾ååå¼ç¨æåä¸ç¶æç¸\n// å³çä¸ä¸æå¯¹è±¡ãç¶æå¯ä½¿ç¨ååå¼ç¨å°ä¸ä¸æè½¬æ¢ä¸ºå¦ä¸ä¸ªç¶æã\nabstract class State is\n    protected field player: AudioPlayer\n\n    // ä¸ä¸æå°èªèº«ä¼ éç»ç¶ææé å½æ°ãè¿å¯å¸®å©ç¶æå¨éè¦æ¶è·åä¸äºæç¨ç\n    // ä¸ä¸ææ°æ®ã\n    constructor State(player) is\n        this.player = player\n\n    abstract method clickLock()\n    abstract method clickPlay()\n    abstract method clickNext()\n    abstract method clickPrevious()\n\n\n// å·ä½ç¶æä¼å®ç°ä¸ä¸ä¸æç¶æç¸å³çå¤ç§è¡ä¸ºã\nclass LockedState extends State is\n\n    // å½ä½ è§£éä¸ä¸ªéå®çæ­æ¾å¨æ¶ï¼å®å¯è½å¤äºä¸¤ç§ç¶æä¹ä¸ã\n    method clickLock() is\n        if (player.playing)\n            player.changeState(new PlayingState(player))\n        else\n            player.changeState(new ReadyState(player))\n\n    method clickPlay() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n    method clickNext() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n    method clickPrevious() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n\n// å®ä»¬è¿å¯å¨ä¸ä¸æä¸­è§¦åç¶æè½¬æ¢ã\nclass ReadyState extends State is\n    method clickLock() is\n        player.changeState(new LockedState(player))\n\n    method clickPlay() is\n        player.startPlayback()\n        player.changeState(new PlayingState(player))\n\n    method clickNext() is\n        player.nextSong()\n\n    method clickPrevious() is\n        player.previousSong()\n\n\nclass PlayingState extends State is\n    method clickLock() is\n        player.changeState(new LockedState(player))\n\n    method clickPlay() is\n        player.stopPlayback()\n        player.changeState(new ReadyState(player))\n\n    method clickNext() is\n        if (event.doubleclick)\n            player.nextSong()\n        else\n            player.fastForward(5)\n\n    method clickPrevious() is\n        if (event.doubleclick)\n            player.previous()\n        else\n            player.rewind(5)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å¨ Java è¯­è¨ä¸­ï¼ ç¶ææ¨¡å¼éå¸¸è¢«ç¨äºå°åºäº switchè¯­å¥çå¤§åç¶ææºè½¬æ¢ä¸ºå¯¹è±¡ã\n\nè¿éæ¯æ ¸å¿ Java ç¨åºåºä¸­ä¸äºç¶ææ¨¡å¼çç¤ºä¾ï¼\n\n * javax.faces.lifecycle.LifeCycle#execute() ï¼ç± FacesÂ­Servletæ§å¶ï¼ è¡ä¸ºä¾èµäºå½å JSF çå½å¨æçé¶æ®µ ï¼ç¶æï¼ï¼\n\nè¯å«æ¹æ³ï¼ ç¶ææ¨¡å¼å¯éè¿åå¤é¨æ§å¶ä¸è½æ ¹æ®å¯¹è±¡ç¶ææ¹åè¡ä¸ºçæ¹æ³æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ç¶æå¯è¢«è§ä¸ºç­ç¥çæ©å±ã ä¸¤èé½åºäºç»åæºå¶ï¼ å®ä»¬é½éè¿å°é¨åå·¥ä½å§æ´¾ç» âå¸®æâ å¯¹è±¡æ¥æ¹åå¶å¨ä¸åææ¯ä¸çè¡ä¸ºã ç­ç¥ä½¿å¾è¿äºå¯¹è±¡ç¸äºä¹é´å®å¨ç¬ç«ï¼ å®ä»¬ä¸ç¥éå¶ä»å¯¹è±¡çå­å¨ã ä½ç¶ææ¨¡å¼æ²¡æéå¶å·ä½ç¶æä¹é´çä¾èµï¼ ä¸åè®¸å®ä»¬èªè¡æ¹åå¨ä¸åææ¯ä¸çç¶æã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',normalizedContent:'# è®¾è®¡æ¨¡å¼ä¹ç¶ææ¨¡å¼\n\n\n# 1. æå¾\n\nç¶ææ¨¡å¼ï¼stateï¼ æ¯ä¸ç§è¡ä¸ºè®¾è®¡æ¨¡å¼ï¼ è®©ä½ è½å¨ä¸ä¸ªå¯¹è±¡çåé¨ç¶æååæ¶æ¹åå¶è¡ä¸ºï¼ ä½¿å¶çä¸å»å°±åæ¹åäºèªèº«æå±çç±»ä¸æ ·ã\n\n\n# 2. éç¨åºæ¯\n\n * å¦æå¯¹è±¡éè¦æ ¹æ®èªèº«å½åç¶æè¿è¡ä¸åè¡ä¸ºï¼ åæ¶ç¶æçæ°ééå¸¸å¤ä¸ä¸ç¶æç¸å³çä»£ç ä¼é¢ç¹åæ´çè¯ï¼ å¯ä½¿ç¨ç¶ææ¨¡å¼ã\n * å¦ææä¸ªç±»éè¦æ ¹æ®æååéçå½åå¼æ¹åèªèº«è¡ä¸ºï¼ ä»èéè¦ä½¿ç¨å¤§éçæ¡ä»¶è¯­å¥æ¶ï¼ å¯ä½¿ç¨è¯¥æ¨¡å¼ã\n * å½ç¸ä¼¼ç¶æååºäºæ¡ä»¶çç¶ææºè½¬æ¢ä¸­å­å¨è®¸å¤éå¤ä»£ç æ¶ï¼ å¯ä½¿ç¨ç¶ææ¨¡å¼ã\n\n\n# 3. ç»æ\n\n\n# 3.1. ç»æè¯´æ\n\n\n\n 1. ä¸ä¸æ ï¼contextï¼ ä¿å­äºå¯¹äºä¸ä¸ªå·ä½ç¶æå¯¹è±¡çå¼ç¨ï¼ å¹¶ä¼å°ææä¸è¯¥ç¶æç¸å³çå·¥ä½å§æ´¾ç»å®ã ä¸ä¸æéè¿ç¶ææ¥å£ä¸ç¶æå¯¹è±¡äº¤äºï¼ ä¸ä¼æä¾ä¸ä¸ªè®¾ç½®å¨ç¨äºä¼ éæ°çç¶æå¯¹è±¡ã\n 2. ç¶æ ï¼stateï¼ æ¥å£ä¼å£°æç¹å®äºç¶æçæ¹æ³ã è¿äºæ¹æ³åºè½è¢«å¶ä»ææå·ä½ç¶ææçè§£ï¼ å ä¸ºä½ ä¸å¸ææäºç¶æææ¥æçæ¹æ³æ°¸è¿ä¸ä¼è¢«è°ç¨ã\n 3. å·ä½ç¶æ ï¼concrete statesï¼ ä¼èªè¡å®ç°ç¹å®äºç¶æçæ¹æ³ã ä¸ºäºé¿åå¤ä¸ªç¶æä¸­åå«ç¸ä¼¼ä»£ç ï¼ ä½ å¯ä»¥æä¾ä¸ä¸ªå°è£æé¨åéç¨è¡ä¸ºçä¸­é´æ½è±¡ç±»ã\n    * ç¶æå¯¹è±¡å¯å­å¨å¯¹äºä¸ä¸æå¯¹è±¡çååå¼ç¨ã ç¶æå¯ä»¥éè¿è¯¥å¼ç¨ä»ä¸ä¸æå¤è·åæéä¿¡æ¯ï¼ å¹¶ä¸è½è§¦åç¶æè½¬ç§»ã\n 4. ä¸ä¸æåå·ä½ç¶æé½å¯ä»¥è®¾ç½®ä¸ä¸æçä¸ä¸ªç¶æï¼ å¹¶å¯éè¿æ¿æ¢è¿æ¥å°ä¸ä¸æçç¶æå¯¹è±¡æ¥å®æå®éçç¶æè½¬æ¢ã\n\n\n# 3.2. ç»æä»£ç èå¼\n\nstate : å®ä¹ä¸ä¸ªæ¥å£ä»¥å°è£ä¸ context çä¸ä¸ªç¹å®ç¶æç¸å³çè¡ä¸ºã\n\nabstract class state {\n    public abstract void handle(context context);\n}\n\n\nconcretestate : æ¯ä¸ä¸ªå­ç±»å®ç°ä¸ä¸ªä¸ context çä¸ä¸ªç¶æç¸å³çè¡ä¸ºã\n\nclass concretestatea extends state {\n    @override\n    public void handle(context context) {\n        context.setstate(new concretestateb());\n    }\n}\n\nclass concretestateb extends state {\n    @override\n    public void handle(context context) {\n        context.setstate(new concretestatea());\n    }\n}\n\n\ncontext : ç»´æ¤ä¸ä¸ª concretestate å­ç±»çå®ä¾ï¼è¿ä¸ªå®ä¾å®ä¹å½åçç¶æã\n\nclass context {\n    private state state;\n    public context(state state) {\n        this.state = state;\n    }\n\n    public void setstate(state state) {\n        this.state = state;\n        system.out.println("å½åç¶æï¼" + state.getclass().getname());\n    }\n    public state getstate() {\n        return state;\n    }\n\n    public void request() {\n        state.handle(this);\n    }\n}\n\n\n\nå®¢æ·ç«¯\n\npublic class statepattern {\n    public static void main(string[] args) {\n        context c = new context(new concretestatea());\n        c.request();\n        c.request();\n    }\n}\n\n\nè¾åº\n\nå½åç¶æï¼concretestateb\nå½åç¶æï¼concretestatea\n\n\n\n# 4. ä¼ªä»£ç \n\nå¨æ¬ä¾ä¸­ï¼ ç¶ææ¨¡å¼å°æ ¹æ®å½ååæ¾ç¶æï¼ è®©åªä½æ­æ¾å¨ä¸­çç¸åæ§ä»¶å®æä¸åçè¡ä¸ºã\n\n\n\næ­æ¾å¨çä¸»è¦å¯¹è±¡æ»æ¯ä¼è¿æ¥å°ä¸ä¸ªè´è´£æ­æ¾å¨ç»å¤§é¨åå·¥ä½çç¶æå¯¹è±¡ä¸­ã é¨åæä½ä¼æ´æ¢æ­æ¾å¨å½åçç¶æå¯¹è±¡ï¼ ä»¥æ­¤æ¹åæ­æ¾å¨å¯¹äºç¨æ·äºå¨æä½åºçååºã\n\n// é³é¢æ­æ¾å¨ï¼audioÂ­playerï¼ç±»å³ä¸ºä¸ä¸æãå®è¿ä¼ç»´æ¤æåç¶æç±»å®ä¾çå¼ç¨ï¼\n// è¯¥ç¶æç±»åç¨äºè¡¨ç¤ºé³é¢æ­æ¾å¨å½åçç¶æã\nclass audioplayer is\n    field state: state\n    field ui, volume, playlist, currentsong\n\n    constructor audioplayer() is\n        this.state = new readystate(this)\n\n        // ä¸ä¸æä¼å°å¤çç¨æ·è¾å¥çå·¥ä½å§æ´¾ç»ç¶æå¯¹è±¡ãç±äºæ¯ä¸ªç¶æé½ä»¥ä¸\n        // åçæ¹å¼å¤çè¾å¥ï¼å¶ç»æèªç¶å°ä¾èµäºå½åæå¤çç¶æã\n        ui = new userinterface()\n        ui.lockbutton.onclick(this.clicklock)\n        ui.playbutton.onclick(this.clickplay)\n        ui.nextbutton.onclick(this.clicknext)\n        ui.prevbutton.onclick(this.clickprevious)\n\n    // å¶ä»å¯¹è±¡å¿é¡»è½åæ¢é³é¢æ­æ¾å¨å½åæå¤çç¶æã\n    method changestate(state: state) is\n        this.state = state\n\n    // ui æ¹æ³ä¼å°æ§è¡å·¥ä½å§æ´¾ç»å½åç¶æã\n    method clicklock() is\n        state.clicklock()\n    method clickplay() is\n        state.clickplay()\n    method clicknext() is\n        state.clicknext()\n    method clickprevious() is\n        state.clickprevious()\n\n    // ç¶æå¯è°ç¨ä¸ä¸æçä¸äºæå¡æ¹æ³ã\n    method startplayback() is\n        // ...\n    method stopplayback() is\n        // ...\n    method nextsong() is\n        // ...\n    method previoussong() is\n        // ...\n    method fastforward(time) is\n        // ...\n    method rewind(time) is\n        // ...\n\n\n// ææå·ä½ç¶æç±»é½å¿é¡»å®ç°ç¶æåºç±»å£°æçæ¹æ³ï¼å¹¶æä¾ååå¼ç¨æåä¸ç¶æç¸\n// å³çä¸ä¸æå¯¹è±¡ãç¶æå¯ä½¿ç¨ååå¼ç¨å°ä¸ä¸æè½¬æ¢ä¸ºå¦ä¸ä¸ªç¶æã\nabstract class state is\n    protected field player: audioplayer\n\n    // ä¸ä¸æå°èªèº«ä¼ éç»ç¶ææé å½æ°ãè¿å¯å¸®å©ç¶æå¨éè¦æ¶è·åä¸äºæç¨ç\n    // ä¸ä¸ææ°æ®ã\n    constructor state(player) is\n        this.player = player\n\n    abstract method clicklock()\n    abstract method clickplay()\n    abstract method clicknext()\n    abstract method clickprevious()\n\n\n// å·ä½ç¶æä¼å®ç°ä¸ä¸ä¸æç¶æç¸å³çå¤ç§è¡ä¸ºã\nclass lockedstate extends state is\n\n    // å½ä½ è§£éä¸ä¸ªéå®çæ­æ¾å¨æ¶ï¼å®å¯è½å¤äºä¸¤ç§ç¶æä¹ä¸ã\n    method clicklock() is\n        if (player.playing)\n            player.changestate(new playingstate(player))\n        else\n            player.changestate(new readystate(player))\n\n    method clickplay() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n    method clicknext() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n    method clickprevious() is\n        // å·²éå®ï¼ä»ä¹ä¹ä¸åã\n\n\n// å®ä»¬è¿å¯å¨ä¸ä¸æä¸­è§¦åç¶æè½¬æ¢ã\nclass readystate extends state is\n    method clicklock() is\n        player.changestate(new lockedstate(player))\n\n    method clickplay() is\n        player.startplayback()\n        player.changestate(new playingstate(player))\n\n    method clicknext() is\n        player.nextsong()\n\n    method clickprevious() is\n        player.previoussong()\n\n\nclass playingstate extends state is\n    method clicklock() is\n        player.changestate(new lockedstate(player))\n\n    method clickplay() is\n        player.stopplayback()\n        player.changestate(new readystate(player))\n\n    method clicknext() is\n        if (event.doubleclick)\n            player.nextsong()\n        else\n            player.fastforward(5)\n\n    method clickprevious() is\n        if (event.doubleclick)\n            player.previous()\n        else\n            player.rewind(5)\n\n\n\n# 5. æ¡ä¾\n\nä½¿ç¨ç¤ºä¾ï¼ å¨ java è¯­è¨ä¸­ï¼ ç¶ææ¨¡å¼éå¸¸è¢«ç¨äºå°åºäº switchè¯­å¥çå¤§åç¶ææºè½¬æ¢ä¸ºå¯¹è±¡ã\n\nè¿éæ¯æ ¸å¿ java ç¨åºåºä¸­ä¸äºç¶ææ¨¡å¼çç¤ºä¾ï¼\n\n * javax.faces.lifecycle.lifecycle#execute() ï¼ç± facesÂ­servletæ§å¶ï¼ è¡ä¸ºä¾èµäºå½å jsf çå½å¨æçé¶æ®µ ï¼ç¶æï¼ï¼\n\nè¯å«æ¹æ³ï¼ ç¶ææ¨¡å¼å¯éè¿åå¤é¨æ§å¶ä¸è½æ ¹æ®å¯¹è±¡ç¶ææ¹åè¡ä¸ºçæ¹æ³æ¥è¯å«ã\n\n\n# 6. ä¸å¶ä»æ¨¡å¼çå³ç³»\n\n * æ¡¥æ¥æ¨¡å¼ã ç¶ææ¨¡å¼åç­ç¥æ¨¡å¼ ï¼å¨æç§ç¨åº¦ä¸åæ¬ééå¨æ¨¡å¼ï¼ æ¨¡å¼çæ¥å£éå¸¸ç¸ä¼¼ã å®éä¸ï¼ å®ä»¬é½åºäºç»åæ¨¡å¼ââå³å°å·¥ä½å§æ´¾ç»å¶ä»å¯¹è±¡ï¼ ä¸è¿ä¹åèªè§£å³äºä¸åçé®é¢ã æ¨¡å¼å¹¶ä¸åªæ¯ä»¥ç¹å®æ¹å¼ç»ç»ä»£ç çéæ¹ï¼ ä½ è¿å¯ä»¥ä½¿ç¨å®ä»¬æ¥åå¶ä»å¼åèè®¨è®ºæ¨¡å¼æè§£å³çé®é¢ã\n * ç¶æå¯è¢«è§ä¸ºç­ç¥çæ©å±ã ä¸¤èé½åºäºç»åæºå¶ï¼ å®ä»¬é½éè¿å°é¨åå·¥ä½å§æ´¾ç» âå¸®æâ å¯¹è±¡æ¥æ¹åå¶å¨ä¸åææ¯ä¸çè¡ä¸ºã ç­ç¥ä½¿å¾è¿äºå¯¹è±¡ç¸äºä¹é´å®å¨ç¬ç«ï¼ å®ä»¬ä¸ç¥éå¶ä»å¯¹è±¡çå­å¨ã ä½ç¶ææ¨¡å¼æ²¡æéå¶å·ä½ç¶æä¹é´çä¾èµï¼ ä¸åè®¸å®ä»¬èªè¡æ¹åå¨ä¸åææ¯ä¸çç¶æã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"é¢åå¯¹è±¡åå",frontmatter:{title:"é¢åå¯¹è±¡åå",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2021-05-19T09:49:05.000Z",permalink:"/pages/b3c94e/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/25.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%8E%9F%E5%88%99.html",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/25.é¢åå¯¹è±¡åå.md",key:"v-3f96c8d8",path:"/pages/b3c94e/",headers:[{level:2,title:"1. åä¸èè´£åå",slug:"_1-åä¸èè´£åå",normalizedTitle:"1. åä¸èè´£åå",charIndex:17},{level:2,title:"2. å¼æ¾-å°é­åå",slug:"_2-å¼æ¾-å°é­åå",normalizedTitle:"2. å¼æ¾-å°é­åå",charIndex:110},{level:2,title:"3. éæ°æ¿æ¢åå",slug:"_3-éæ°æ¿æ¢åå",normalizedTitle:"3. éæ°æ¿æ¢åå",charIndex:205},{level:2,title:"4. ä¾èµåç½®åå",slug:"_4-ä¾èµåç½®åå",normalizedTitle:"4. ä¾èµåç½®åå",charIndex:268},{level:2,title:"5. æ¥å£éç¦»åå",slug:"_5-æ¥å£éç¦»åå",normalizedTitle:"5. æ¥å£éç¦»åå",charIndex:426},{level:2,title:"6. è¿ªç±³ç¹åå",slug:"_6-è¿ªç±³ç¹åå",normalizedTitle:"6. è¿ªç±³ç¹åå",charIndex:562},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:724}],headersStr:"1. åä¸èè´£åå 2. å¼æ¾-å°é­åå 3. éæ°æ¿æ¢åå 4. ä¾èµåç½®åå 5. æ¥å£éç¦»åå 6. è¿ªç±³ç¹åå 7. åèèµæ",content:"# é¢åå¯¹è±¡è®¾è®¡å­å¤§åå\n\n\n# 1. åä¸èè´£åå\n\nåä¸èè´£ååï¼Single Responsibility Principleï¼ï¼åºè¯¥æä¸ä»æä¸ä¸ªåå å¼èµ·ç±»çåæ´ã\n\nç®åç¹è¯´ï¼ä¸ä¸ªç±»ï¼æå¥½åªè´è´£ä¸ä»¶äºã\n\n\n# 2. å¼æ¾-å°é­åå\n\nå¼æ¾-å°é­ååï¼Open Close Principleï¼ï¼è½¯ä»¶å®ä½ï¼ç±»ãæ¨¡åãå½æ°ï¼ç­åºè¯¥å¯ä»¥æ©å±ï¼ä½æ¯ä¸å¯ä¿®æ¹ã\n\nå¯¹äºæ©å±æ¯å¼æ¾çï¼å¯¹äºæ´æ¹æ¯å°é­çã\n\n\n# 3. éæ°æ¿æ¢åå\n\néæ°æ¿æ¢ååï¼Liskov Substitution Principleï¼ï¼å­ç±»å¯ä»¥æ¿æ¢ç¶ç±»ã\n\n\n# 4. ä¾èµåç½®åå\n\nä¾èµåç½®ååï¼Dependency Inversion Principleï¼ï¼æ½è±¡ä¸åºè¯¥ä¾èµäºç»èï¼ç»èåºå½ä¾èµäºæ½è±¡ãæ¢è¨ä¹ï¼è¦éå¯¹æ¥å£ç¼ç¨ï¼èä¸æ¯éå¯¹å®ç°ç¼ç¨ã\n\nå³é®ç¹ï¼\n\n * é«å±æ¨¡åä¸åºè¯¥ä¾èµä½å±æ¨¡åï¼ä¸¤èé½åºè¯¥ä¾èµå¶æ½è±¡\n * æ½è±¡ä¸åºè¯¥ä¾èµç»è\n * ç»èåºè¯¥ä¾èµæ½è±¡\n\n\n# 5. æ¥å£éç¦»åå\n\næ¥å£éç¦»ååï¼Interface Segregation Principleï¼ä½¿ç¨å¤ä¸ªä¸é¨çæ¥å£ï¼èä¸ä½¿ç¨åä¸çæ»æ¥å£ï¼å³å®¢æ·ç«¯ä¸åºè¯¥ä¾èµé£äºå®ä¸éè¦çæ¥å£ã\n\n * å®¢æ·ç«¯ä¸åºä¾èµå®ä¸éè¦çæ¥å£\n * ç±»é´çä¾èµå³ç³»åºè¯¥å»ºç«å¨æå°çæ¥å£ä¸\n\n\n# 6. è¿ªç±³ç¹åå\n\nè¿ªç±³ç¹ååï¼Least Knowledge Principleï¼åç§°æå°ç¥è¯ååï¼ä¸ä¸ªè½¯ä»¶å®ä½åºå½å°½å¯è½å°å°ä¸å¶ä»å®ä½åçç¸äºä½ç¨ã\n\nä¸ä¸ªç±»åºè¯¥å¯¹èªå·±éè¦è°ç¨çç±»ç¥éå¾æå°ï¼ç±»çåé¨å¦ä½å®ç°ãå¦ä½å¤æé½ä¸è°ç¨èæèä¾èµèæ²¡å³ç³»ï¼è°ç¨èæèä¾èµèåªéè¦ç¥éä»éè¦çæ¹æ³å³å¯ï¼å¶ä»çæä¸æ¦ä¸å³å¿ã\n\n\n# 7. åèèµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã",normalizedContent:"# é¢åå¯¹è±¡è®¾è®¡å­å¤§åå\n\n\n# 1. åä¸èè´£åå\n\nåä¸èè´£ååï¼single responsibility principleï¼ï¼åºè¯¥æä¸ä»æä¸ä¸ªåå å¼èµ·ç±»çåæ´ã\n\nç®åç¹è¯´ï¼ä¸ä¸ªç±»ï¼æå¥½åªè´è´£ä¸ä»¶äºã\n\n\n# 2. å¼æ¾-å°é­åå\n\nå¼æ¾-å°é­ååï¼open close principleï¼ï¼è½¯ä»¶å®ä½ï¼ç±»ãæ¨¡åãå½æ°ï¼ç­åºè¯¥å¯ä»¥æ©å±ï¼ä½æ¯ä¸å¯ä¿®æ¹ã\n\nå¯¹äºæ©å±æ¯å¼æ¾çï¼å¯¹äºæ´æ¹æ¯å°é­çã\n\n\n# 3. éæ°æ¿æ¢åå\n\néæ°æ¿æ¢ååï¼liskov substitution principleï¼ï¼å­ç±»å¯ä»¥æ¿æ¢ç¶ç±»ã\n\n\n# 4. ä¾èµåç½®åå\n\nä¾èµåç½®ååï¼dependency inversion principleï¼ï¼æ½è±¡ä¸åºè¯¥ä¾èµäºç»èï¼ç»èåºå½ä¾èµäºæ½è±¡ãæ¢è¨ä¹ï¼è¦éå¯¹æ¥å£ç¼ç¨ï¼èä¸æ¯éå¯¹å®ç°ç¼ç¨ã\n\nå³é®ç¹ï¼\n\n * é«å±æ¨¡åä¸åºè¯¥ä¾èµä½å±æ¨¡åï¼ä¸¤èé½åºè¯¥ä¾èµå¶æ½è±¡\n * æ½è±¡ä¸åºè¯¥ä¾èµç»è\n * ç»èåºè¯¥ä¾èµæ½è±¡\n\n\n# 5. æ¥å£éç¦»åå\n\næ¥å£éç¦»ååï¼interface segregation principleï¼ä½¿ç¨å¤ä¸ªä¸é¨çæ¥å£ï¼èä¸ä½¿ç¨åä¸çæ»æ¥å£ï¼å³å®¢æ·ç«¯ä¸åºè¯¥ä¾èµé£äºå®ä¸éè¦çæ¥å£ã\n\n * å®¢æ·ç«¯ä¸åºä¾èµå®ä¸éè¦çæ¥å£\n * ç±»é´çä¾èµå³ç³»åºè¯¥å»ºç«å¨æå°çæ¥å£ä¸\n\n\n# 6. è¿ªç±³ç¹åå\n\nè¿ªç±³ç¹ååï¼least knowledge principleï¼åç§°æå°ç¥è¯ååï¼ä¸ä¸ªè½¯ä»¶å®ä½åºå½å°½å¯è½å°å°ä¸å¶ä»å®ä½åçç¸äºä½ç¨ã\n\nä¸ä¸ªç±»åºè¯¥å¯¹èªå·±éè¦è°ç¨çç±»ç¥éå¾æå°ï¼ç±»çåé¨å¦ä½å®ç°ãå¦ä½å¤æé½ä¸è°ç¨èæèä¾èµèæ²¡å³ç³»ï¼è°ç¨èæèä¾èµèåªéè¦ç¥éä»éè¦çæ¹æ³å³å¯ï¼å¶ä»çæä¸æ¦ä¸å³å¿ã\n\n\n# 7. åèèµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"è®¾è®¡æ¨¡å¼",frontmatter:{title:"è®¾è®¡æ¨¡å¼",categories:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],tags:["è®¾è®¡","è®¾è®¡æ¨¡å¼"],date:"2020-08-10T10:59:18.000Z",permalink:"/pages/4b9193/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/02.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/",relativePath:"03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/README.md",key:"v-0893d5c3",path:"/pages/4b9193/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:37},{level:3,title:"åå»ºåæ¨¡å¼",slug:"åå»ºåæ¨¡å¼",normalizedTitle:"åå»ºåæ¨¡å¼",charIndex:55},{level:3,title:"ç»æåæ¨¡å¼",slug:"ç»æåæ¨¡å¼",normalizedTitle:"ç»æåæ¨¡å¼",charIndex:247},{level:3,title:"è¡ä¸ºåæ¨¡å¼",slug:"è¡ä¸ºåæ¨¡å¼",normalizedTitle:"è¡ä¸ºåæ¨¡å¼",charIndex:429},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:701},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:755}],headersStr:"ð åå®¹ åå»ºåæ¨¡å¼ ç»æåæ¨¡å¼ è¡ä¸ºåæ¨¡å¼ ð èµæ ðª ä¼ é",content:"# è®¾è®¡æ¨¡å¼\n\n> è®¾è®¡æ¨¡å¼æ¯è½¯ä»¶è®¾è®¡ä¸­å¸¸è§é®é¢çå¸åè§£å³æ¹æ¡ã\n\n\n# ð åå®¹\n\né¢åå¯¹è±¡åå\n\n\n# åå»ºåæ¨¡å¼\n\n> åå»ºåæ¨¡å¼æä¾äºåå»ºå¯¹è±¡çæºå¶ï¼ è½å¤æåå·²æä»£ç ççµæ´»æ§åå¯å¤ç¨æ§ã\n\n * ç®åå·¥åæ¨¡å¼ (Simple Factory)\n * å·¥åæ¹æ³æ¨¡å¼ (Factory Method)\n * æ½è±¡å·¥åæ¨¡å¼ (Abstract Factory)\n * å»ºé èæ¨¡å¼ (Builder)\n * ååæ¨¡å¼ (Prototype)\n * åä¾æ¨¡å¼ (Singleton)\n\n\n# ç»æåæ¨¡å¼\n\n> ç»æåæ¨¡å¼ä»ç»å¦ä½å°å¯¹è±¡åç±»ç»è£æè¾å¤§çç»æï¼ å¹¶åæ¶ä¿æç»æççµæ´»åé«æã\n\n * ééå¨æ¨¡å¼ (Adapter)\n * æ¡¥æ¥æ¨¡å¼ (Bridge)\n * ç»åæ¨¡å¼ (Composite)\n * è£é¥°æ¨¡å¼ (Decorator)\n * å¤è§æ¨¡å¼ (Facade)\n * äº«åæ¨¡å¼ (Flyweight)\n * ä»£çæ¨¡å¼ (Proxy)\n\n\n# è¡ä¸ºåæ¨¡å¼\n\n> è¡ä¸ºæ¨¡å¼è´è´£å¯¹è±¡é´çé«ææ²éåèè´£å§æ´¾ã\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (Template Method)\n * å½ä»¤æ¨¡å¼ (Command)\n * è¿­ä»£å¨æ¨¡å¼ (Iterator)\n * è§å¯èæ¨¡å¼ (Observer)\n * è§£éå¨æ¨¡å¼ (Interpreter)\n * ä¸­ä»èæ¨¡å¼ (Mediator)\n * èè´£é¾æ¨¡å¼ (Chain of Responsibility)\n * å¤å¿å½æ¨¡å¼ (Memento)\n * ç­ç¥æ¨¡å¼ (Strategy)\n * è®¿é®èæ¨¡å¼ (Visitor)\n * ç¶ææ¨¡å¼ (State)\n\n\n# ð èµæ\n\n * ãHead First è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# è®¾è®¡æ¨¡å¼\n\n> è®¾è®¡æ¨¡å¼æ¯è½¯ä»¶è®¾è®¡ä¸­å¸¸è§é®é¢çå¸åè§£å³æ¹æ¡ã\n\n\n# ð åå®¹\n\né¢åå¯¹è±¡åå\n\n\n# åå»ºåæ¨¡å¼\n\n> åå»ºåæ¨¡å¼æä¾äºåå»ºå¯¹è±¡çæºå¶ï¼ è½å¤æåå·²æä»£ç ççµæ´»æ§åå¯å¤ç¨æ§ã\n\n * ç®åå·¥åæ¨¡å¼ (simple factory)\n * å·¥åæ¹æ³æ¨¡å¼ (factory method)\n * æ½è±¡å·¥åæ¨¡å¼ (abstract factory)\n * å»ºé èæ¨¡å¼ (builder)\n * ååæ¨¡å¼ (prototype)\n * åä¾æ¨¡å¼ (singleton)\n\n\n# ç»æåæ¨¡å¼\n\n> ç»æåæ¨¡å¼ä»ç»å¦ä½å°å¯¹è±¡åç±»ç»è£æè¾å¤§çç»æï¼ å¹¶åæ¶ä¿æç»æççµæ´»åé«æã\n\n * ééå¨æ¨¡å¼ (adapter)\n * æ¡¥æ¥æ¨¡å¼ (bridge)\n * ç»åæ¨¡å¼ (composite)\n * è£é¥°æ¨¡å¼ (decorator)\n * å¤è§æ¨¡å¼ (facade)\n * äº«åæ¨¡å¼ (flyweight)\n * ä»£çæ¨¡å¼ (proxy)\n\n\n# è¡ä¸ºåæ¨¡å¼\n\n> è¡ä¸ºæ¨¡å¼è´è´£å¯¹è±¡é´çé«ææ²éåèè´£å§æ´¾ã\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (template method)\n * å½ä»¤æ¨¡å¼ (command)\n * è¿­ä»£å¨æ¨¡å¼ (iterator)\n * è§å¯èæ¨¡å¼ (observer)\n * è§£éå¨æ¨¡å¼ (interpreter)\n * ä¸­ä»èæ¨¡å¼ (mediator)\n * èè´£é¾æ¨¡å¼ (chain of responsibility)\n * å¤å¿å½æ¨¡å¼ (memento)\n * ç­ç¥æ¨¡å¼ (strategy)\n * è®¿é®èæ¨¡å¼ (visitor)\n * ç¶ææ¨¡å¼ (state)\n\n\n# ð èµæ\n\n * ãhead first è®¾è®¡æ¨¡å¼ã\n * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n * è®¾è®¡æ¨¡å¼æç¨\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç çåå³éåéæ",frontmatter:{title:"ä»£ç çåå³éåéæ",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ","ä»£ç çåå³é"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/89848c/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/01.%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93%E5%92%8C%E9%87%8D%E6%9E%84.html",relativePath:"03.è®¾è®¡/03.éæ/01.ä»£ç çåå³éåéæ.md",key:"v-79c78335",path:"/pages/89848c/",headers:[{level:2,title:"1. çä¸è¯",slug:"_1-çä¸è¯",normalizedTitle:"1. çä¸è¯",charIndex:105},{level:3,title:"1.1. å¯¹ä»£ç çåå³éçæè",slug:"_1-1-å¯¹ä»£ç çåå³éçæè",normalizedTitle:"1.1. å¯¹ä»£ç çåå³éçæè",charIndex:116},{level:3,title:"1.2. éæçåå",slug:"_1-2-éæçåå",normalizedTitle:"1.2. éæçåå",charIndex:735},{level:4,title:"1.2.1. ä½è°éæ(What)",slug:"_1-2-1-ä½è°éæ-what",normalizedTitle:"1.2.1. ä½è°éæ(what)",charIndex:792},{level:4,title:"1.2.2. ä¸ºä½éæ(Why)",slug:"_1-2-2-ä¸ºä½éæ-why",normalizedTitle:"1.2.2. ä¸ºä½éæ(why)",charIndex:998},{level:4,title:"1.2.3. ä½æ¶éæ(When)",slug:"_1-2-3-ä½æ¶éæ-when",normalizedTitle:"1.2.3. ä½æ¶éæ(when)",charIndex:1113},{level:4,title:"1.2.4. å¦ä½éæ(How)",slug:"_1-2-4-å¦ä½éæ-how",normalizedTitle:"1.2.4. å¦ä½éæ(how)",charIndex:2251},{level:2,title:"2. ä»£ç çåå³é",slug:"_2-ä»£ç çåå³é",normalizedTitle:"2. ä»£ç çåå³é",charIndex:2719},{level:3,title:"2.1. ä»£ç åå³éä¹ä»£ç èè¿",slug:"_2-1-ä»£ç åå³éä¹ä»£ç èè¿",normalizedTitle:"2.1. ä»£ç åå³éä¹ä»£ç èè¿",charIndex:2827},{level:3,title:"2.2. ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡",slug:"_2-2-ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡",normalizedTitle:"2.2. ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡",charIndex:3002},{level:3,title:"2.3. ä»£ç åå³éä¹åé©çéç¢",slug:"_2-3-ä»£ç åå³éä¹åé©çéç¢",normalizedTitle:"2.3. ä»£ç åå³éä¹åé©çéç¢",charIndex:3133},{level:3,title:"2.4. ä»£ç åå³éä¹éå¿è¦ç",slug:"_2-4-ä»£ç åå³éä¹éå¿è¦ç",normalizedTitle:"2.4. ä»£ç åå³éä¹éå¿è¦ç",charIndex:3263},{level:3,title:"2.5. ä»£ç åå³éä¹è¦å",slug:"_2-5-ä»£ç åå³éä¹è¦å",normalizedTitle:"2.5. ä»£ç åå³éä¹è¦å",charIndex:3390},{level:2,title:"3. æ©å±éè¯»",slug:"_3-æ©å±éè¯»",normalizedTitle:"3. æ©å±éè¯»",charIndex:3489},{level:2,title:"4. åèèµæ",slug:"_4-åèèµæ",normalizedTitle:"4. åèèµæ",charIndex:3586}],headersStr:"1. çä¸è¯ 1.1. å¯¹ä»£ç çåå³éçæè 1.2. éæçåå 1.2.1. ä½è°éæ(What) 1.2.2. ä¸ºä½éæ(Why) 1.2.3. ä½æ¶éæ(When) 1.2.4. å¦ä½éæ(How) 2. ä»£ç çåå³é 2.1. ä»£ç åå³éä¹ä»£ç èè¿ 2.2. ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡ 2.3. ä»£ç åå³éä¹åé©çéç¢ 2.4. ä»£ç åå³éä¹éå¿è¦ç 2.5. ä»£ç åå³éä¹è¦å 3. æ©å±éè¯» 4. åèèµæ",content:"ç¬¬ä¸æ¬¡è¯»ãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ãæ¶ï¼ææ¾æ´çè¿ä¸ä¸ªç®åçç¬è®°ãæè¿ï¼å ä¸ºåä¸ä¸ä¸ªéæé¡¹ç®ï¼åä¸æ¬¡æ¸©ä¹ äºãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ããè¿ç¨ä¸­ï¼èåäºè®¤çæ»ç»ãæ´çéææ¹æ³çå²å¨ï¼äºæ¯æäºè¿ç³»åæå­ã\n\n\n# 1. çä¸è¯\n\n\n# 1.1. å¯¹ä»£ç çåå³éçæè\n\nâæçè¦æ©æ²»ï¼ä¸è¦æ¾å¼æ²»çâãå¤ä¹æ´ç´ çéç ï¼äººäººé½æã\n\nçï¼å°±æ¯ä¸å¥åº·ã\n\näººæçï¼å¯ä»¥éè¿æéãåè¯ãåææ¯æ¥è¿è¡æ²»çã\n\nå¦ææä»£ç çåå³éï¼ä»£ç è´¨éé®é¢ï¼æ¯ä½ççï¼é£ä¹éæå°±æ¯æ²»çä»£ç çåå³éçè¯ã\n\nä¸ªäººè®¤ä¸ºï¼å¨éæè¿ä»¶äºä¸ï¼ä¹å¯ä»¥åºç¨æ²»ççéçï¼\n\n * é²æ£äºæªç¶ã ââ æ¥ç§æå½æ¶æçä¸ä»£åå»æé¹ï¼æ¾ç»æä¸ªå¾èåçå»å­¦ä¸»å¼ ï¼é²æ£äºæªç¶ã æè§å¾è¿ä¸ªéçåºç¨äºè½¯ä»¶ä»£ç çéæäº¦ç¶ãç¼ç¨åè¦æåççè®¾è®¡ãç¼ç¨æ¶è¦æè¯å¥½çç¼ç¨é£æ ¼ï¼å°½éåå°é®é¢ãä»è¿ä¸ªå±é¢ä¸è¯´ï¼äºè§£ä»£ç çåå³éï¼ä¸ä»ä»æ¯ä¸ºäºåç°é®é¢ãè§£å³é®é¢ãæ´éè¦çä½ç¨æ¯ï¼æå¯¼æä»¬å¨ç¼ç¨è¿ç¨ä¸­ææè¯çå»è§é¿è¿äºé®é¢ã\n\n * å°çä¸å»ï¼æå¾å¤§çã ââ åå¤è¯´è¿ï¼âå¿ä»¥åå°èä¸ä¸ºï¼å¿ä»¥æ¶å°èä¸ºä¹âãåç°é®é¢å°±åæ¶ä¿®æ¹ï¼ä»£ç è´¨éèªç¶å®¹æè¿å¥è¯æ§å¾ªç¯ï¼åä¹ï¼äº¦ç¶ãè¦éè§ç§¯ç´¯çåéï¼å«æ»ä»¥ä¸ºä»£ç åºç°ç¹å°é®é¢ï¼é£é½ä¸æ¯äºå¿ã\n\n * å¯¹çä¸è¯ã ââ ç¨åºåºç°äºé®é¢ï¼è¦åæåºé®é¢çæ ¹æ¬ï¼æéå¯¹æ§çå¶å®åççéææ¹æ¡ãå¤§å®¶é½ç¥éåéè¯çåæï¼åæ ·çï¼çæ¹è¿ä¸å¦ä¸æ¹ã\n\n * å¿çè¯ ââ å»çç¨çè¯å®¹æäº§çå¯ä½ç¨ãæ¢ä¸å¥ä¿è¯­ï¼æ­¥å­å¤§äºå®¹ææ¯çèãéæå¦æå¤§åéæ§çå¹²ï¼é£ä½ å°±è¦æéæ¶å¯è½æè¡çå¿çåå¤ãæ¨åéæ¥ä¸æ¯éæï¼èæ¯éåãéæåºè¯¥æ¯å¾ªåºæ¸è¿ï¼æ­¥æ­¥ä¸ºè¥çè¿ç¨ãå½ä½ åç°éåä»£ç æ¯éæä»£ç æ´ç®åï¼å¾å¾è¯´æä½ æ©å°±è¯¥éæäºã\n\n\n# 1.2. éæçåå\n\nåé¢æä»£ç è´¨éé®é¢æ¯ä½ççï¼èæéææ¯ä½è¯ãè¿éï¼æä»¬åè¿ä¸æ­¥è®¨è®ºä¸ä¸éæçååã\n\n# 1.2.1. ä½è°éæ(What)\n\néæï¼Refactoringï¼ çå¸¸è§å®ä¹æ¯ï¼ä¸æ¹åè½¯ä»¶ç³»ç»å¤é¨è¡ä¸ºçåæä¸ï¼æ¹åå®çåé¨ç»æã\n\nä¸ªäººè§å¾è¿ä¸ªå®ä¹æç¹çæ¶©ãä¸å¦¨çè§£ä¸ºï¼éææ¯ç»ä»£ç æ²»ççè¡ä¸ºãèä»£ç æçæ¯æä»£ç çè´¨éï¼å¯é æ§ãå®å¨æ§ãå¯å¤ç¨æ§ãå¯ç»´æ¤æ§ï¼åæ§è½æé®é¢ã\n\néæçç®çæ¯ä¸ºäºæé«ä»£ç çè´¨éåæ§è½ã\n\næ³¨ï¼åè½ä¸å¨æèä¸æ­£ç¡®ï¼é£æ¯æ®ç¾ä»£ç ãå°±åæ²»çæ²»ä¸äºæ®ç¾ï¼éæä¹è§£å³ä¸äºåè½é®é¢ã\n\n# 1.2.2. ä¸ºä½éæ(Why)\n\nç¿»ç¿»ä¹¦ï¼ä¸ç½æä¸ä¸ï¼è°å°éæççç±å¤§ä½ç¸åï¼\n\n * éææ¹è¿è½¯ä»¶è®¾è®¡\n * éæä½¿è½¯ä»¶æ´å®¹æçè§£\n * éæå¸®å©æ¾å° bug\n * éææé«ç¼ç¨éåº¦\n\næ»ä¹å°±æ¯ï¼éæå¯ä»¥æé«ä»£ç è´¨éã\n\n# 1.2.3. ä½æ¶éæ(When)\n\nå³äºä½æ¶éæï¼æåå¼ç¨ä¸ä¸ éæå¹¶éé¾å¨å¦ä½åï¼èæ¯é¾å¨ä½æ¶å¼å§å ä¸æçè§ç¹ã\n\n> å¯¹äºä¸ä¸ªé«éåå±çå¬å¸æ¥è¯´ï¼åæ­¢ä¸å¡å¼åï¼ä¸é¨æ¥åéæé¡¹ç®ï¼ä»æ¥å°±ä¸æ¯ä¸ä¸ªå¯æ¥åçéé¡¹ï¼âè¾¹å¼é£æºè¾¹æ¢å¼æâææ¯è¿ç§å¬å¸æ³è¦çã\n\næä»¬ä¸å¦¨æ¥è¡¡éä¸ä¸éæçææ¬åæ¶çã\n\n * éæçææ¬\n   \n   éææ¯æææ¬çï¼è´¹æ¶è´¹åï¼æ¶é´ãäººåï¼ä¸è¯´ï¼è¿æå¯è½ä¼ä½¿æ¬æ¥æ­£å¸¸è¿è¡çç¨åºåºéãæä»¥ï¼å¾å¤äººé½æ±çâä¸æ±æåï¼ä½æ±æ è¿âçå¿çå¾è¿ä¸è¿ã\n   \n   è¿æä¸ç§ææ¬ï¼éæä½¿ç¨è¾æ°ä¸è¾ä¸ºå¤æçææ¯ï¼å­¦ä¹ æ²çº¿ä¸å¹³æ»ï¼å¢éæåææ¯åæ¢å°é¾ï¼ç­æåå¼åæçå¯è½ä¸ååéã\n   \n   ä½æ¯ï¼å¦æä¸ç´æ¾ä»»ä»£ç èæ½ä¸å»ï¼ææ¯åºå¡ä¼è¶æ¥è¶æ²éãå½ä»£ç æç»å¿«è¦è·ä¸å¨æ¶ï¼æ¶æå¸ä»¬å¾å¾è¿æ¯ä¸å¾ä¸ä½¿ç¨æ¿è¿çææ®µæ¥æ²»çä»£ç çé¡½ç¾ãä½æ¯ï¼è¿ä¸ªè¿ç¨éå¸¸é½æ¯éå¸¸çè¦çï¼èä¸æçå¾é«çå¤±è´¥é£é©ã\n\n * éæçæ¶ç\n   \n   éæçæ¶çæ¯æé«ä»£ç çè´¨éåæ§è½ï¼å¹¶æé«æªæ¥çå¼åæçãä½æ¯ï¼åºå½çå°ï¼éæå¾å¾å¹¶ä¸è½å¨ç­æåå¸¦æ¥å®éçæçï¼æèå¾é¾ç´è§çåºæçãèå¯¹äºä¸ä¸ªä¼ä¸æ¥è¯´ï¼æ²¡æä»ä¹æ¯æçæ´éè¦ãæ¢å¥è¯è¯´ï¼æ²¡æå®éæççäºï¼éå¸¸ä¹æ²¡æä»·å¼ãå¾å¤é¢å¯¼ï¼å°¤å¶æ¯éææ¯æ¹åçé¢å¯¼ï¼å¹¶ä¸å³å¿ä½ åºç¨äºä»ä¹æ°ææ¯ï¼è®©ä»£ç åå¾å¤ä¹ä¼éç­ç­ã\n\n * éæçåéæ¶æº\n   \n   ä»ä»¥ä¸æ¥çï¼éæå®å¨æ¯ä¸ªååä¸è®¨å¥½çäºæã\n   \n   äºæ¯ï¼å¾å¤äººå±æäºä¸æ¶ç KPI åè¦å½ç deadlineï¼ä¸è¾¹åæ§½çä»¥åçä»£ç æ¯åå¾ï¼ä¸è¾¹èªå·±ä¹å¨é åå¾ã\n   \n   ä½æ¯ï¼éææ¬åºè¯¥æ¯ä¸ªæ¸è¿å¼çè¿ç¨ï¼ä¸æ¯åªæä¼¤ç­å¨éª¨çæ¹é æå«éæãå¦æéè¦ç­å°ä»£ç å·²ç»çå°çå¥èèï¼åä½¿ç¨æ¿è¿æ¹å¼æ¥éæï¼é£å¿ç¶æ¯å°é¾ééï¼é£é©æé«ã\n   \n   ãéæãä¹¦ä¸­æå°çéææ¶æºåºè¯¥å¨æ·»å åè½ãä¿®å¤åè½ãå®¡æ¥ä»£ç æ¶ï¼ä¸å»ºè®®ä¸é¨æ½åºæ¶é´ä¸é¨åéæé¡¹ç®ã\n   \n   æè®¤ä¸ºï¼å¶ææ³å°±æ¯æï¼éæåºè¯¥æ¯å¨å¼åè¿ç¨ä¸­å®æ¶çãæ¸è¿çæ¼åè¿ç¨ã\n\n * éæçä¸æ°å½æ¶æº\n   \n   ä½æ¯ï¼è¿éæä¹è¦å¼ºè°ä¸ä¸ï¼ä¸æ¯ææè½¯ä»¶å¼åè¿ç¨é½ä¸å®è¦éæã\n   \n   è¾è½å¸æ¾éæä»·å¼çåºæ¯æ¯ï¼ä»£ç è§æ¨¡è¾å¤§ãçå½å¨æè¿è¾é¿ãæ¿æäºè¾å¤è´£ä»»ãæä¸ä¸ªè¾å¤§ï¼ä¸è¾ä¸ç¨³å®ï¼äººåæµå¨é¢ç¹ï¼å¢éå¨å¶ä¸å·¥ä½çåä¸ä»£ç åºã\n   \n   ä¸ä¹ç¸åï¼æä¸äºåºæ¯çéæä»·å¼å°±å¾å°ï¼\n   \n   * ä»£ç åºçå½å¨æå¿«è¦èµ°å°å°¾å£°ï¼å¼åéæ¸åå°ï¼ä»¥ç»´æ¤ä¸ºä¸»ã\n   * ä»£ç åºå½åçæ¬é©¬ä¸è¦åå¸äºï¼è¿æ¶éææ çæ¯ç»èªå·±æ¾éº»ç¦ã\n   * éæä»£ä»·è¿äºæ²éï¼éæååè½çæ­£ç¡®æ§ãç¨³å®æ§é¾ä»¥ä¿éï¼ææ¯è¿äºè¶åï¼å¢éæåææ¯è¿ç§»é¾åº¦å¤ªå¤§ã\n\n# 1.2.4. å¦ä½éæ(How)\n\néæè¡ä¸ºå¨æçæ¥ï¼ä¹æ¯å¯ä»¥åå±çº§çãç±é«å°ä½ï¼è¶é«å±çº§é¾åº¦è¶å¤§ï¼\n\n * ç³»ç»æ¶æãéç¾¤æ¶æãæ¡æ¶ãæå¡ãæ°æ®åºï¼è¿ä¸ªå±é¢çéæå±äºæç¥çº§éæãç°ä»£è½¯ä»¶å¾å¾ä¸å¡å¤æãåºå¤§ãä½¿ç¨å¾®æå¡ãæ°æ®è¿ç§»æ¥æåä¸å¡ï¼éä½ä¸å¡å¤æåº¦æä¸ºäºä¸»æµãä½æ¯ï¼è¿äºææ¯çæµè¯ãé¨ç½²å¤æï¼ææ¯é¾åº¦å¾é«ã\n * ç»ä»¶ãæ¨¡åãæ¥å£ï¼è¿ä¸ªå±é¢çéæå±äºææ¯çº§éæãç»ä»¶ãæ¨¡åãæ¡æ¶çéæï¼ä¸»è¦æ¯éå¯¹ä»£ç çè®¾è®¡é®é¢ãè§£å³çæ¯ä»£ç çæ´ä½ç»æé®é¢ãéè¦å¯¹æ¡æ¶ãè®¾è®¡æ¨¡å¼ãåå¸å¼ãå¹¶åç­ç­æè¶³å¤çäºè§£ã\n * ç±»ãæ¥å£ãå½æ°ãå­æ®µç­ï¼è¿ä¸ªå±é¢çéæå±äºææ³çº§éæããéæãä¸ä¹¦æå°äº ä»£ç çåå³é ä»¥åç¸å³çéææ¹æ³ãè¿äºé½æ¯å¯¹ç±»ãæ¥å£ãå½æ°ãå­æ®µçº§å«ä»£ç çéæææ®µãç±äºè¿ä¸çº§å«çéææ¹æ³è¾ä¸ºç®åï¼æä»¥å¯æä½æ§è¾å¼ºãå·ä½ç»èå¯ä»¥éè¯»ãä»£ç çåå³éãç¯ç« ã\n\nåä¸¤ç§å±çº§çéæå·²ç»æ¶åå°æ¶æå±é¢ï¼å½±åè¾å¤§ï¼é¾åº¦è¾é«ï¼å¦æååä¸å¤ä¸è¦è½»æåå¨ãç±äºè¿ä¸¤ä¸ªå±çº§æ¶åé¢åè¾å¹¿ï¼è¿éä¸åè®ºè¿°ã\n\næ­¤å¤ä¸ºåå²çº¿ãä¸é¢æ¯ä»£ç çåå³éç³»åããã\n\n\n# 2. ä»£ç çåå³é\n\nãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ãä¸­ä»ç»äº 22 ç§ä»£ç çåå³éä»¥åéæææ³ãè¿äºåå³éå¯ä»¥è¿ä¸æ­¥å½ç±»ãææ»è§å¾å°äºç©åç±»æå©äºçè§£åè®°å¿ãæä»¥æ¬ç³»åå°åå³éæç§ç¹æ§åç±»ï¼ç¶åéä¸è®²è§£ã\n\n\n\n\n# 2.1. ä»£ç åå³éä¹ä»£ç èè¿\n\n> ä»£ç èè¿(Bloated)è¿ç»åå³éæå³çï¼ä»£ç ä¸­çç±»ãå½æ°ãå­æ®µæ²¡æç»è¿åççç»ç»ï¼åªæ¯ç®åçå ç èµ·æ¥ãè¿ä¸ç±»åçé®é¢éå¸¸å¨ä»£ç çåæå¹¶ä¸ææ¾ï¼ä½æ¯éçä»£ç è§æ¨¡çå¢é¿èéæ¸ç§¯ç´¯ï¼ç¹å«æ¯å½æ²¡æäººåªåå»æ ¹é¤å®ä»¬æ¶ï¼ã\n\n * è¿é¿å½æ°\n * è¿å¤§çç±»\n * åºæ¬ç±»ååæ§\n * è¿é¿åæ°å\n * æ°æ®æ³¥å¢\n\n\n# 2.2. ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n\n> æ»¥ç¨é¢åå¯¹è±¡(Object-Orientation Abusers)è¿ç»åå³éæå³çï¼ä»£ç é¨åæå®å¨å°è¿èäºé¢åå¯¹è±¡ç¼ç¨ååã\n\n * switch å£°æ\n * ä¸´æ¶å­æ®µ\n * è¢«æç»çé¦èµ \n * å¼æ²åå·¥çç±»\n\n\n# 2.3. ä»£ç åå³éä¹åé©çéç¢\n\n> åé©çéç¢(Change Preventers)è¿ç»åå³éæå³çï¼å½ä½ éè¦æ¹åä¸å¤ä»£ç æ¶ï¼å´åç°ä¸å¾ä¸æ¹åå¶ä»çå°æ¹ãè¿ä½¿å¾ç¨åºå¼ååå¾å¤æãä»£ä»·é«æã\n\n * åæ£å¼åå\n * é°å¼¹å¼ä¿®æ¹\n * å¹³è¡ç»§æ¿ä½ç³»\n\n\n# 2.4. ä»£ç åå³éä¹éå¿è¦ç\n\n> éå¿è¦ç(Dispensables)è¿ç»åå³éæå³çï¼è¿æ ·çä»£ç å¯æå¯æ ï¼å®çå­å¨åèå½±åæ´ä½ä»£ç çæ´æ´åå¯è¯»æ§ã\n\n * è¿å¤çæ³¨é\n * éå¤ä»£ç \n * åä½ç±»\n * çº¯ç¨çæ°æ®ç±»\n * å¤¸å¤¸å¶è°æªæ¥æ§\n\n\n# 2.5. ä»£ç åå³éä¹è¦å\n\n> è¦å(Couplers)è¿ç»åå³éæå³çï¼ä¸åç±»ä¹é´è¿åº¦è¦åã\n\n * ä¾ææç»\n * çæµå³ç³»\n * è¿åº¦è¦åçæ¶æ¯é¾\n * ä¸­é´äºº\n * ä¸å®ç¾çåºç±»\n\n\n# 3. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 4. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring",normalizedContent:"ç¬¬ä¸æ¬¡è¯»ãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ãæ¶ï¼ææ¾æ´çè¿ä¸ä¸ªç®åçç¬è®°ãæè¿ï¼å ä¸ºåä¸ä¸ä¸ªéæé¡¹ç®ï¼åä¸æ¬¡æ¸©ä¹ äºãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ããè¿ç¨ä¸­ï¼èåäºè®¤çæ»ç»ãæ´çéææ¹æ³çå²å¨ï¼äºæ¯æäºè¿ç³»åæå­ã\n\n\n# 1. çä¸è¯\n\n\n# 1.1. å¯¹ä»£ç çåå³éçæè\n\nâæçè¦æ©æ²»ï¼ä¸è¦æ¾å¼æ²»çâãå¤ä¹æ´ç´ çéç ï¼äººäººé½æã\n\nçï¼å°±æ¯ä¸å¥åº·ã\n\näººæçï¼å¯ä»¥éè¿æéãåè¯ãåææ¯æ¥è¿è¡æ²»çã\n\nå¦ææä»£ç çåå³éï¼ä»£ç è´¨éé®é¢ï¼æ¯ä½ççï¼é£ä¹éæå°±æ¯æ²»çä»£ç çåå³éçè¯ã\n\nä¸ªäººè®¤ä¸ºï¼å¨éæè¿ä»¶äºä¸ï¼ä¹å¯ä»¥åºç¨æ²»ççéçï¼\n\n * é²æ£äºæªç¶ã ââ æ¥ç§æå½æ¶æçä¸ä»£åå»æé¹ï¼æ¾ç»æä¸ªå¾èåçå»å­¦ä¸»å¼ ï¼é²æ£äºæªç¶ã æè§å¾è¿ä¸ªéçåºç¨äºè½¯ä»¶ä»£ç çéæäº¦ç¶ãç¼ç¨åè¦æåççè®¾è®¡ãç¼ç¨æ¶è¦æè¯å¥½çç¼ç¨é£æ ¼ï¼å°½éåå°é®é¢ãä»è¿ä¸ªå±é¢ä¸è¯´ï¼äºè§£ä»£ç çåå³éï¼ä¸ä»ä»æ¯ä¸ºäºåç°é®é¢ãè§£å³é®é¢ãæ´éè¦çä½ç¨æ¯ï¼æå¯¼æä»¬å¨ç¼ç¨è¿ç¨ä¸­ææè¯çå»è§é¿è¿äºé®é¢ã\n\n * å°çä¸å»ï¼æå¾å¤§çã ââ åå¤è¯´è¿ï¼âå¿ä»¥åå°èä¸ä¸ºï¼å¿ä»¥æ¶å°èä¸ºä¹âãåç°é®é¢å°±åæ¶ä¿®æ¹ï¼ä»£ç è´¨éèªç¶å®¹æè¿å¥è¯æ§å¾ªç¯ï¼åä¹ï¼äº¦ç¶ãè¦éè§ç§¯ç´¯çåéï¼å«æ»ä»¥ä¸ºä»£ç åºç°ç¹å°é®é¢ï¼é£é½ä¸æ¯äºå¿ã\n\n * å¯¹çä¸è¯ã ââ ç¨åºåºç°äºé®é¢ï¼è¦åæåºé®é¢çæ ¹æ¬ï¼æéå¯¹æ§çå¶å®åççéææ¹æ¡ãå¤§å®¶é½ç¥éåéè¯çåæï¼åæ ·çï¼çæ¹è¿ä¸å¦ä¸æ¹ã\n\n * å¿çè¯ ââ å»çç¨çè¯å®¹æäº§çå¯ä½ç¨ãæ¢ä¸å¥ä¿è¯­ï¼æ­¥å­å¤§äºå®¹ææ¯çèãéæå¦æå¤§åéæ§çå¹²ï¼é£ä½ å°±è¦æéæ¶å¯è½æè¡çå¿çåå¤ãæ¨åéæ¥ä¸æ¯éæï¼èæ¯éåãéæåºè¯¥æ¯å¾ªåºæ¸è¿ï¼æ­¥æ­¥ä¸ºè¥çè¿ç¨ãå½ä½ åç°éåä»£ç æ¯éæä»£ç æ´ç®åï¼å¾å¾è¯´æä½ æ©å°±è¯¥éæäºã\n\n\n# 1.2. éæçåå\n\nåé¢æä»£ç è´¨éé®é¢æ¯ä½ççï¼èæéææ¯ä½è¯ãè¿éï¼æä»¬åè¿ä¸æ­¥è®¨è®ºä¸ä¸éæçååã\n\n# 1.2.1. ä½è°éæ(what)\n\néæï¼refactoringï¼ çå¸¸è§å®ä¹æ¯ï¼ä¸æ¹åè½¯ä»¶ç³»ç»å¤é¨è¡ä¸ºçåæä¸ï¼æ¹åå®çåé¨ç»æã\n\nä¸ªäººè§å¾è¿ä¸ªå®ä¹æç¹çæ¶©ãä¸å¦¨çè§£ä¸ºï¼éææ¯ç»ä»£ç æ²»ççè¡ä¸ºãèä»£ç æçæ¯æä»£ç çè´¨éï¼å¯é æ§ãå®å¨æ§ãå¯å¤ç¨æ§ãå¯ç»´æ¤æ§ï¼åæ§è½æé®é¢ã\n\néæçç®çæ¯ä¸ºäºæé«ä»£ç çè´¨éåæ§è½ã\n\næ³¨ï¼åè½ä¸å¨æèä¸æ­£ç¡®ï¼é£æ¯æ®ç¾ä»£ç ãå°±åæ²»çæ²»ä¸äºæ®ç¾ï¼éæä¹è§£å³ä¸äºåè½é®é¢ã\n\n# 1.2.2. ä¸ºä½éæ(why)\n\nç¿»ç¿»ä¹¦ï¼ä¸ç½æä¸ä¸ï¼è°å°éæççç±å¤§ä½ç¸åï¼\n\n * éææ¹è¿è½¯ä»¶è®¾è®¡\n * éæä½¿è½¯ä»¶æ´å®¹æçè§£\n * éæå¸®å©æ¾å° bug\n * éææé«ç¼ç¨éåº¦\n\næ»ä¹å°±æ¯ï¼éæå¯ä»¥æé«ä»£ç è´¨éã\n\n# 1.2.3. ä½æ¶éæ(when)\n\nå³äºä½æ¶éæï¼æåå¼ç¨ä¸ä¸ éæå¹¶éé¾å¨å¦ä½åï¼èæ¯é¾å¨ä½æ¶å¼å§å ä¸æçè§ç¹ã\n\n> å¯¹äºä¸ä¸ªé«éåå±çå¬å¸æ¥è¯´ï¼åæ­¢ä¸å¡å¼åï¼ä¸é¨æ¥åéæé¡¹ç®ï¼ä»æ¥å°±ä¸æ¯ä¸ä¸ªå¯æ¥åçéé¡¹ï¼âè¾¹å¼é£æºè¾¹æ¢å¼æâææ¯è¿ç§å¬å¸æ³è¦çã\n\næä»¬ä¸å¦¨æ¥è¡¡éä¸ä¸éæçææ¬åæ¶çã\n\n * éæçææ¬\n   \n   éææ¯æææ¬çï¼è´¹æ¶è´¹åï¼æ¶é´ãäººåï¼ä¸è¯´ï¼è¿æå¯è½ä¼ä½¿æ¬æ¥æ­£å¸¸è¿è¡çç¨åºåºéãæä»¥ï¼å¾å¤äººé½æ±çâä¸æ±æåï¼ä½æ±æ è¿âçå¿çå¾è¿ä¸è¿ã\n   \n   è¿æä¸ç§ææ¬ï¼éæä½¿ç¨è¾æ°ä¸è¾ä¸ºå¤æçææ¯ï¼å­¦ä¹ æ²çº¿ä¸å¹³æ»ï¼å¢éæåææ¯åæ¢å°é¾ï¼ç­æåå¼åæçå¯è½ä¸ååéã\n   \n   ä½æ¯ï¼å¦æä¸ç´æ¾ä»»ä»£ç èæ½ä¸å»ï¼ææ¯åºå¡ä¼è¶æ¥è¶æ²éãå½ä»£ç æç»å¿«è¦è·ä¸å¨æ¶ï¼æ¶æå¸ä»¬å¾å¾è¿æ¯ä¸å¾ä¸ä½¿ç¨æ¿è¿çææ®µæ¥æ²»çä»£ç çé¡½ç¾ãä½æ¯ï¼è¿ä¸ªè¿ç¨éå¸¸é½æ¯éå¸¸çè¦çï¼èä¸æçå¾é«çå¤±è´¥é£é©ã\n\n * éæçæ¶ç\n   \n   éæçæ¶çæ¯æé«ä»£ç çè´¨éåæ§è½ï¼å¹¶æé«æªæ¥çå¼åæçãä½æ¯ï¼åºå½çå°ï¼éæå¾å¾å¹¶ä¸è½å¨ç­æåå¸¦æ¥å®éçæçï¼æèå¾é¾ç´è§çåºæçãèå¯¹äºä¸ä¸ªä¼ä¸æ¥è¯´ï¼æ²¡æä»ä¹æ¯æçæ´éè¦ãæ¢å¥è¯è¯´ï¼æ²¡æå®éæççäºï¼éå¸¸ä¹æ²¡æä»·å¼ãå¾å¤é¢å¯¼ï¼å°¤å¶æ¯éææ¯æ¹åçé¢å¯¼ï¼å¹¶ä¸å³å¿ä½ åºç¨äºä»ä¹æ°ææ¯ï¼è®©ä»£ç åå¾å¤ä¹ä¼éç­ç­ã\n\n * éæçåéæ¶æº\n   \n   ä»ä»¥ä¸æ¥çï¼éæå®å¨æ¯ä¸ªååä¸è®¨å¥½çäºæã\n   \n   äºæ¯ï¼å¾å¤äººå±æäºä¸æ¶ç kpi åè¦å½ç deadlineï¼ä¸è¾¹åæ§½çä»¥åçä»£ç æ¯åå¾ï¼ä¸è¾¹èªå·±ä¹å¨é åå¾ã\n   \n   ä½æ¯ï¼éææ¬åºè¯¥æ¯ä¸ªæ¸è¿å¼çè¿ç¨ï¼ä¸æ¯åªæä¼¤ç­å¨éª¨çæ¹é æå«éæãå¦æéè¦ç­å°ä»£ç å·²ç»çå°çå¥èèï¼åä½¿ç¨æ¿è¿æ¹å¼æ¥éæï¼é£å¿ç¶æ¯å°é¾ééï¼é£é©æé«ã\n   \n   ãéæãä¹¦ä¸­æå°çéææ¶æºåºè¯¥å¨æ·»å åè½ãä¿®å¤åè½ãå®¡æ¥ä»£ç æ¶ï¼ä¸å»ºè®®ä¸é¨æ½åºæ¶é´ä¸é¨åéæé¡¹ç®ã\n   \n   æè®¤ä¸ºï¼å¶ææ³å°±æ¯æï¼éæåºè¯¥æ¯å¨å¼åè¿ç¨ä¸­å®æ¶çãæ¸è¿çæ¼åè¿ç¨ã\n\n * éæçä¸æ°å½æ¶æº\n   \n   ä½æ¯ï¼è¿éæä¹è¦å¼ºè°ä¸ä¸ï¼ä¸æ¯ææè½¯ä»¶å¼åè¿ç¨é½ä¸å®è¦éæã\n   \n   è¾è½å¸æ¾éæä»·å¼çåºæ¯æ¯ï¼ä»£ç è§æ¨¡è¾å¤§ãçå½å¨æè¿è¾é¿ãæ¿æäºè¾å¤è´£ä»»ãæä¸ä¸ªè¾å¤§ï¼ä¸è¾ä¸ç¨³å®ï¼äººåæµå¨é¢ç¹ï¼å¢éå¨å¶ä¸å·¥ä½çåä¸ä»£ç åºã\n   \n   ä¸ä¹ç¸åï¼æä¸äºåºæ¯çéæä»·å¼å°±å¾å°ï¼\n   \n   * ä»£ç åºçå½å¨æå¿«è¦èµ°å°å°¾å£°ï¼å¼åéæ¸åå°ï¼ä»¥ç»´æ¤ä¸ºä¸»ã\n   * ä»£ç åºå½åçæ¬é©¬ä¸è¦åå¸äºï¼è¿æ¶éææ çæ¯ç»èªå·±æ¾éº»ç¦ã\n   * éæä»£ä»·è¿äºæ²éï¼éæååè½çæ­£ç¡®æ§ãç¨³å®æ§é¾ä»¥ä¿éï¼ææ¯è¿äºè¶åï¼å¢éæåææ¯è¿ç§»é¾åº¦å¤ªå¤§ã\n\n# 1.2.4. å¦ä½éæ(how)\n\néæè¡ä¸ºå¨æçæ¥ï¼ä¹æ¯å¯ä»¥åå±çº§çãç±é«å°ä½ï¼è¶é«å±çº§é¾åº¦è¶å¤§ï¼\n\n * ç³»ç»æ¶æãéç¾¤æ¶æãæ¡æ¶ãæå¡ãæ°æ®åºï¼è¿ä¸ªå±é¢çéæå±äºæç¥çº§éæãç°ä»£è½¯ä»¶å¾å¾ä¸å¡å¤æãåºå¤§ãä½¿ç¨å¾®æå¡ãæ°æ®è¿ç§»æ¥æåä¸å¡ï¼éä½ä¸å¡å¤æåº¦æä¸ºäºä¸»æµãä½æ¯ï¼è¿äºææ¯çæµè¯ãé¨ç½²å¤æï¼ææ¯é¾åº¦å¾é«ã\n * ç»ä»¶ãæ¨¡åãæ¥å£ï¼è¿ä¸ªå±é¢çéæå±äºææ¯çº§éæãç»ä»¶ãæ¨¡åãæ¡æ¶çéæï¼ä¸»è¦æ¯éå¯¹ä»£ç çè®¾è®¡é®é¢ãè§£å³çæ¯ä»£ç çæ´ä½ç»æé®é¢ãéè¦å¯¹æ¡æ¶ãè®¾è®¡æ¨¡å¼ãåå¸å¼ãå¹¶åç­ç­æè¶³å¤çäºè§£ã\n * ç±»ãæ¥å£ãå½æ°ãå­æ®µç­ï¼è¿ä¸ªå±é¢çéæå±äºææ³çº§éæããéæãä¸ä¹¦æå°äº ä»£ç çåå³é ä»¥åç¸å³çéææ¹æ³ãè¿äºé½æ¯å¯¹ç±»ãæ¥å£ãå½æ°ãå­æ®µçº§å«ä»£ç çéæææ®µãç±äºè¿ä¸çº§å«çéææ¹æ³è¾ä¸ºç®åï¼æä»¥å¯æä½æ§è¾å¼ºãå·ä½ç»èå¯ä»¥éè¯»ãä»£ç çåå³éãç¯ç« ã\n\nåä¸¤ç§å±çº§çéæå·²ç»æ¶åå°æ¶æå±é¢ï¼å½±åè¾å¤§ï¼é¾åº¦è¾é«ï¼å¦æååä¸å¤ä¸è¦è½»æåå¨ãç±äºè¿ä¸¤ä¸ªå±çº§æ¶åé¢åè¾å¹¿ï¼è¿éä¸åè®ºè¿°ã\n\næ­¤å¤ä¸ºåå²çº¿ãä¸é¢æ¯ä»£ç çåå³éç³»åããã\n\n\n# 2. ä»£ç çåå³é\n\nãéæ:æ¹åæ¢æä»£ç çè®¾è®¡ãä¸­ä»ç»äº 22 ç§ä»£ç çåå³éä»¥åéæææ³ãè¿äºåå³éå¯ä»¥è¿ä¸æ­¥å½ç±»ãææ»è§å¾å°äºç©åç±»æå©äºçè§£åè®°å¿ãæä»¥æ¬ç³»åå°åå³éæç§ç¹æ§åç±»ï¼ç¶åéä¸è®²è§£ã\n\n\n\n\n# 2.1. ä»£ç åå³éä¹ä»£ç èè¿\n\n> ä»£ç èè¿(bloated)è¿ç»åå³éæå³çï¼ä»£ç ä¸­çç±»ãå½æ°ãå­æ®µæ²¡æç»è¿åççç»ç»ï¼åªæ¯ç®åçå ç èµ·æ¥ãè¿ä¸ç±»åçé®é¢éå¸¸å¨ä»£ç çåæå¹¶ä¸ææ¾ï¼ä½æ¯éçä»£ç è§æ¨¡çå¢é¿èéæ¸ç§¯ç´¯ï¼ç¹å«æ¯å½æ²¡æäººåªåå»æ ¹é¤å®ä»¬æ¶ï¼ã\n\n * è¿é¿å½æ°\n * è¿å¤§çç±»\n * åºæ¬ç±»ååæ§\n * è¿é¿åæ°å\n * æ°æ®æ³¥å¢\n\n\n# 2.2. ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n\n> æ»¥ç¨é¢åå¯¹è±¡(object-orientation abusers)è¿ç»åå³éæå³çï¼ä»£ç é¨åæå®å¨å°è¿èäºé¢åå¯¹è±¡ç¼ç¨ååã\n\n * switch å£°æ\n * ä¸´æ¶å­æ®µ\n * è¢«æç»çé¦èµ \n * å¼æ²åå·¥çç±»\n\n\n# 2.3. ä»£ç åå³éä¹åé©çéç¢\n\n> åé©çéç¢(change preventers)è¿ç»åå³éæå³çï¼å½ä½ éè¦æ¹åä¸å¤ä»£ç æ¶ï¼å´åç°ä¸å¾ä¸æ¹åå¶ä»çå°æ¹ãè¿ä½¿å¾ç¨åºå¼ååå¾å¤æãä»£ä»·é«æã\n\n * åæ£å¼åå\n * é°å¼¹å¼ä¿®æ¹\n * å¹³è¡ç»§æ¿ä½ç³»\n\n\n# 2.4. ä»£ç åå³éä¹éå¿è¦ç\n\n> éå¿è¦ç(dispensables)è¿ç»åå³éæå³çï¼è¿æ ·çä»£ç å¯æå¯æ ï¼å®çå­å¨åèå½±åæ´ä½ä»£ç çæ´æ´åå¯è¯»æ§ã\n\n * è¿å¤çæ³¨é\n * éå¤ä»£ç \n * åä½ç±»\n * çº¯ç¨çæ°æ®ç±»\n * å¤¸å¤¸å¶è°æªæ¥æ§\n\n\n# 2.5. ä»£ç åå³éä¹è¦å\n\n> è¦å(couplers)è¿ç»åå³éæå³çï¼ä¸åç±»ä¹é´è¿åº¦è¦åã\n\n * ä¾ææç»\n * çæµå³ç³»\n * è¿åº¦è¦åçæ¶æ¯é¾\n * ä¸­é´äºº\n * ä¸å®ç¾çåºç±»\n\n\n# 3. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 4. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç åå³éä¹ä»£ç èè¿",frontmatter:{title:"ä»£ç åå³éä¹ä»£ç èè¿",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ","ä»£ç çåå³é"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/82f4c8/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/02.%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.html",relativePath:"03.è®¾è®¡/03.éæ/02.ä»£ç åå³éä¹ä»£ç èè¿.md",key:"v-c5ef3042",path:"/pages/82f4c8/",headers:[{level:2,title:"1. åºæ¬ç±»ååæ§",slug:"_1-åºæ¬ç±»ååæ§",normalizedTitle:"1. åºæ¬ç±»ååæ§",charIndex:176},{level:3,title:"1.1. é®é¢åå ",slug:"_1-1-é®é¢åå ",normalizedTitle:"1.1. é®é¢åå ",charIndex:348},{level:3,title:"1.2. è§£å³æ¹æ³",slug:"_1-2-è§£å³æ¹æ³",normalizedTitle:"1.2. è§£å³æ¹æ³",charIndex:501},{level:3,title:"1.3. æ¶ç",slug:"_1-3-æ¶ç",normalizedTitle:"1.3. æ¶ç",charIndex:1132},{level:3,title:"1.4. éææ¹æ³è¯´æ",slug:"_1-4-éææ¹æ³è¯´æ",normalizedTitle:"1.4. éææ¹æ³è¯´æ",charIndex:1261},{level:4,title:"1.4.1. ä»¥ç±»åä»£ç±»åç (Replace Type Code with Class)",slug:"_1-4-1-ä»¥ç±»åä»£ç±»åç -replace-type-code-with-class",normalizedTitle:"1.4.1. ä»¥ç±»åä»£ç±»åç (replace type code with class)",charIndex:1276},{level:4,title:"1.4.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)",slug:"_1-4-2-å¼å¥åæ°å¯¹è±¡-introduce-parameter-object",normalizedTitle:"1.4.2. å¼å¥åæ°å¯¹è±¡(introduce parameter object)",charIndex:1378},{level:4,title:"1.4.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)",slug:"_1-4-3-ä¿æå¯¹è±¡å®æ´-preserve-whole-object",normalizedTitle:"1.4.3. ä¿æå¯¹è±¡å®æ´(preserve whole object)",charIndex:1467},{level:4,title:"1.4.4. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass)",slug:"_1-4-4-ä»¥å­ç±»åä»£ç±»åç -replace-type-code-with-subclass",normalizedTitle:"1.4.4. ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass)",charIndex:1736},{level:4,title:"1.4.5. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy)",slug:"_1-4-5-ä»¥ç¶æ-ç­ç¥æ¨¡å¼åä»£ç±»åç -replace-type-code-with-state-strategy",normalizedTitle:"1.4.5. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy)",charIndex:1836},{level:4,title:"1.4.6. ä»¥å¯¹è±¡åä»£æ°ç»(Replace Array with Object)",slug:"_1-4-6-ä»¥å¯¹è±¡åä»£æ°ç»-replace-array-with-object",normalizedTitle:"1.4.6. ä»¥å¯¹è±¡åä»£æ°ç»(replace array with object)",charIndex:1955},{level:2,title:"2. æ°æ®æ³¥å¢",slug:"_2-æ°æ®æ³¥å¢",normalizedTitle:"2. æ°æ®æ³¥å¢",charIndex:2216},{level:3,title:"2.1. é®é¢åå ",slug:"_2-1-é®é¢åå ",normalizedTitle:"2.1. é®é¢åå ",charIndex:2312},{level:3,title:"2.2. è§£å³æ¹æ³",slug:"_2-2-è§£å³æ¹æ³",normalizedTitle:"2.2. è§£å³æ¹æ³",charIndex:2443},{level:3,title:"2.3. æ¶ç",slug:"_2-3-æ¶ç",normalizedTitle:"2.3. æ¶ç",charIndex:2698},{level:3,title:"2.4. ä½æ¶å¿½ç¥",slug:"_2-4-ä½æ¶å¿½ç¥",normalizedTitle:"2.4. ä½æ¶å¿½ç¥",charIndex:2768},{level:3,title:"2.5. éææ¹æ³è¯´æ",slug:"_2-5-éææ¹æ³è¯´æ",normalizedTitle:"2.5. éææ¹æ³è¯´æ",charIndex:2851},{level:4,title:"2.5.1. æç¼ç±»(Extract Class)",slug:"_2-5-1-æç¼ç±»-extract-class",normalizedTitle:"2.5.1. æç¼ç±»(extract class)",charIndex:2866},{level:4,title:"2.5.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)",slug:"_2-5-2-å¼å¥åæ°å¯¹è±¡-introduce-parameter-object",normalizedTitle:"2.5.2. å¼å¥åæ°å¯¹è±¡(introduce parameter object)",charIndex:2947},{level:4,title:"2.5.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)",slug:"_2-5-3-ä¿æå¯¹è±¡å®æ´-preserve-whole-object",normalizedTitle:"2.5.3. ä¿æå¯¹è±¡å®æ´(preserve whole object)",charIndex:3036},{level:2,title:"3. è¿å¤§çç±»",slug:"_3-è¿å¤§çç±»",normalizedTitle:"3. è¿å¤§çç±»",charIndex:3306},{level:3,title:"3.1. é®é¢åå ",slug:"_3-1-é®é¢åå ",normalizedTitle:"3.1. é®é¢åå ",charIndex:3364},{level:3,title:"3.2. è§£å³æ¹æ³",slug:"_3-2-è§£å³æ¹æ³",normalizedTitle:"3.2. è§£å³æ¹æ³",charIndex:3445},{level:3,title:"3.3. æ¶ç",slug:"_3-3-æ¶ç",normalizedTitle:"3.3. æ¶ç",charIndex:3797},{level:3,title:"3.4. éææ¹æ³è¯´æ",slug:"_3-4-éææ¹æ³è¯´æ",normalizedTitle:"3.4. éææ¹æ³è¯´æ",charIndex:3873},{level:4,title:"3.4.1. æç¼ç±»(Extract Class)",slug:"_3-4-1-æç¼ç±»-extract-class",normalizedTitle:"3.4.1. æç¼ç±»(extract class)",charIndex:3888},{level:4,title:"3.4.2. æç¼å­ç±»(Extract Subclass)",slug:"_3-4-2-æç¼å­ç±»-extract-subclass",normalizedTitle:"3.4.2. æç¼å­ç±»(extract subclass)",charIndex:3969},{level:4,title:"3.4.3. æç¼æ¥å£(Extract Interface)",slug:"_3-4-3-æç¼æ¥å£-extract-interface",normalizedTitle:"3.4.3. æç¼æ¥å£(extract interface)",charIndex:4057},{level:4,title:"3.4.4. å¤å¶è¢«çè§æ°æ®(Duplicate Observed Data)",slug:"_3-4-4-å¤å¶è¢«çè§æ°æ®-duplicate-observed-data",normalizedTitle:"3.4.4. å¤å¶è¢«çè§æ°æ®(duplicate observed data)",charIndex:4157},{level:2,title:"4. è¿é¿å½æ°",slug:"_4-è¿é¿å½æ°",normalizedTitle:"4. è¿é¿å½æ°",charIndex:4288},{level:3,title:"4.1. é®é¢çåå ",slug:"_4-1-é®é¢çåå ",normalizedTitle:"4.1. é®é¢çåå ",charIndex:4395},{level:3,title:"4.2. è§£å³å½æ°",slug:"_4-2-è§£å³å½æ°",normalizedTitle:"4.2. è§£å³å½æ°",charIndex:4605},{level:3,title:"4.3. æ¶ç",slug:"_4-3-æ¶ç",normalizedTitle:"4.3. æ¶ç",charIndex:5172},{level:3,title:"4.4. æ§è½",slug:"_4-4-æ§è½",normalizedTitle:"4.4. æ§è½",charIndex:5268},{level:3,title:"4.5. éææ¹æ³è¯´æ",slug:"_4-5-éææ¹æ³è¯´æ",normalizedTitle:"4.5. éææ¹æ³è¯´æ",charIndex:5385},{level:4,title:"4.5.1. æç¼å½æ°(Extract Method)",slug:"_4-5-1-æç¼å½æ°-extract-method",normalizedTitle:"4.5.1. æç¼å½æ°(extract method)",charIndex:5400},{level:4,title:"4.5.2. ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(Replace Temp with Query)",slug:"_4-5-2-ä»¥æ¥è¯¢åä»£ä¸´æ¶åé-replace-temp-with-query",normalizedTitle:"4.5.2. ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(replace temp with query)",charIndex:5843},{level:4,title:"4.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)",slug:"_4-5-3-å¼å¥åæ°å¯¹è±¡-introduce-parameter-object",normalizedTitle:"4.5.3. å¼å¥åæ°å¯¹è±¡(introduce parameter object)",charIndex:6345},{level:4,title:"4.5.4. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)",slug:"_4-5-4-ä¿æå¯¹è±¡å®æ´-preserve-whole-object",normalizedTitle:"4.5.4. ä¿æå¯¹è±¡å®æ´(preserve whole object)",charIndex:6434},{level:4,title:"4.5.5. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object)",slug:"_4-5-5-ä»¥å½æ°å¯¹è±¡åä»£å½æ°-replace-method-with-method-object",normalizedTitle:"4.5.5. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object)",charIndex:6703},{level:4,title:"4.5.6. åè§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)",slug:"_4-5-6-åè§£æ¡ä»¶è¡¨è¾¾å¼-decompose-conditional",normalizedTitle:"4.5.6. åè§£æ¡ä»¶è¡¨è¾¾å¼(decompose conditional)",charIndex:7466},{level:2,title:"5. è¿é¿åæ°å",slug:"_5-è¿é¿åæ°å",normalizedTitle:"5. è¿é¿åæ°å",charIndex:7821},{level:3,title:"5.1. é®é¢åå ",slug:"_5-1-é®é¢åå ",normalizedTitle:"5.1. é®é¢åå ",charIndex:7888},{level:3,title:"5.2. è§£å³æ¹æ¡",slug:"_5-2-è§£å³æ¹æ¡",normalizedTitle:"5.2. è§£å³æ¹æ¡",charIndex:8148},{level:3,title:"5.3. æ¶ç",slug:"_5-3-æ¶ç",normalizedTitle:"5.3. æ¶ç",charIndex:8421},{level:3,title:"5.4. ä½æ¶å¿½ç¥",slug:"_5-4-ä½æ¶å¿½ç¥",normalizedTitle:"5.4. ä½æ¶å¿½ç¥",charIndex:8473},{level:3,title:"5.5. éææ¹æ³è¯´æ",slug:"_5-5-éææ¹æ³è¯´æ",normalizedTitle:"5.5. éææ¹æ³è¯´æ",charIndex:8606},{level:4,title:"5.5.1. ä»¥å½æ°åä»£åæ°(Replace Parameter with Methods)",slug:"_5-5-1-ä»¥å½æ°åä»£åæ°-replace-parameter-with-methods",normalizedTitle:"5.5.1. ä»¥å½æ°åä»£åæ°(replace parameter with methods)",charIndex:8621},{level:4,title:"5.5.2. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)",slug:"_5-5-2-ä¿æå¯¹è±¡å®æ´-preserve-whole-object",normalizedTitle:"5.5.2. ä¿æå¯¹è±¡å®æ´(preserve whole object)",charIndex:9038},{level:4,title:"5.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)",slug:"_5-5-3-å¼å¥åæ°å¯¹è±¡-introduce-parameter-object",normalizedTitle:"5.5.3. å¼å¥åæ°å¯¹è±¡(introduce parameter object)",charIndex:9307},{level:2,title:"6. æ©å±éè¯»",slug:"_6-æ©å±éè¯»",normalizedTitle:"6. æ©å±éè¯»",charIndex:9397},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:9494}],headersStr:"1. åºæ¬ç±»ååæ§ 1.1. é®é¢åå  1.2. è§£å³æ¹æ³ 1.3. æ¶ç 1.4. éææ¹æ³è¯´æ 1.4.1. ä»¥ç±»åä»£ç±»åç (Replace Type Code with Class) 1.4.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) 1.4.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) 1.4.4. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass) 1.4.5. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy) 1.4.6. ä»¥å¯¹è±¡åä»£æ°ç»(Replace Array with Object) 2. æ°æ®æ³¥å¢ 2.1. é®é¢åå  2.2. è§£å³æ¹æ³ 2.3. æ¶ç 2.4. ä½æ¶å¿½ç¥ 2.5. éææ¹æ³è¯´æ 2.5.1. æç¼ç±»(Extract Class) 2.5.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) 2.5.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) 3. è¿å¤§çç±» 3.1. é®é¢åå  3.2. è§£å³æ¹æ³ 3.3. æ¶ç 3.4. éææ¹æ³è¯´æ 3.4.1. æç¼ç±»(Extract Class) 3.4.2. æç¼å­ç±»(Extract Subclass) 3.4.3. æç¼æ¥å£(Extract Interface) 3.4.4. å¤å¶è¢«çè§æ°æ®(Duplicate Observed Data) 4. è¿é¿å½æ° 4.1. é®é¢çåå  4.2. è§£å³å½æ° 4.3. æ¶ç 4.4. æ§è½ 4.5. éææ¹æ³è¯´æ 4.5.1. æç¼å½æ°(Extract Method) 4.5.2. ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(Replace Temp with Query) 4.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) 4.5.4. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) 4.5.5. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object) 4.5.6. åè§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional) 5. è¿é¿åæ°å 5.1. é®é¢åå  5.2. è§£å³æ¹æ¡ 5.3. æ¶ç 5.4. ä½æ¶å¿½ç¥ 5.5. éææ¹æ³è¯´æ 5.5.1. ä»¥å½æ°åä»£åæ°(Replace Parameter with Methods) 5.5.2. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) 5.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) 6. æ©å±éè¯» 7. åèèµæ",content:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/bloaters\n> \n> ä»£ç èè¿(Bloated)è¿ç»åå³éæå³çï¼ä»£ç ä¸­çç±»ãå½æ°ãå­æ®µæ²¡æç»è¿åççç»ç»ï¼åªæ¯ç®åçå ç èµ·æ¥ãè¿ä¸ç±»åçé®é¢éå¸¸å¨ä»£ç çåæå¹¶ä¸ææ¾ï¼ä½æ¯éçä»£ç è§æ¨¡çå¢é¿èéæ¸ç§¯ç´¯ï¼ç¹å«æ¯å½æ²¡æäººåªåå»æ ¹é¤å®ä»¬æ¶ï¼ã\n\n\n# 1. åºæ¬ç±»ååæ§\n\n> åºæ¬ç±»ååæ§(Primitive Obsession)\n> \n>  * ä½¿ç¨åºæ¬ç±»åèä¸æ¯å°å¯¹è±¡æ¥å®ç°ç®åä»»å¡ï¼ä¾å¦è´§å¸ãèå´ãçµè¯å·ç å­ç¬¦ä¸²ç­ï¼ã\n>  * ä½¿ç¨å¸¸éç¼ç ä¿¡æ¯ï¼ä¾å¦ä¸ä¸ªç¨äºå¼ç¨ç®¡çåæéçå¸¸éUSER_ADMIN_ROLE = 1 ï¼ã\n>  * ä½¿ç¨å­ç¬¦ä¸²å¸¸éä½ä¸ºå­æ®µåå¨æ°ç»ä¸­ä½¿ç¨ã\n\n\n\n\n# 1.1. é®é¢åå \n\nç±»ä¼¼å¶ä»å¤§é¨ååå³éï¼åºæ¬ç±»ååæ§è¯çäºç±»åå»ºçæ¶åãä¸å¼å§ï¼å¯è½åªæ¯ä¸å¤çå­æ®µï¼éçè¡¨ç¤ºçç¹æ§è¶æ¥è¶å¤ï¼åºæ¬æ°æ®ç±»åå­æ®µä¹è¶æ¥è¶å¤ã\n\nåºæ¬ç±»åå¸¸å¸¸è¢«ç¨äºè¡¨ç¤ºæ¨¡åçç±»åãä½ æä¸ç»æ°å­æå­ç¬¦ä¸²ç¨æ¥è¡¨ç¤ºæä¸ªå®ä½ã\n\nè¿æä¸ä¸ªåºæ¯ï¼å¨æ¨¡æåºæ¯ï¼å¤§éçå­ç¬¦ä¸²å¸¸éè¢«ç¨äºæ°ç»çç´¢å¼ã\n\n\n# 1.2. è§£å³æ¹æ³\n\n\n\nå¤§å¤æ°ç¼ç¨è¯­è¨é½æ¯æåºæ¬æ°æ®ç±»ååç»æç±»åï¼ç±»ãç»æä½ç­ï¼ãç»æç±»ååè®¸ç¨åºåå°åºæ¬æ°æ®ç±»åç»ç»èµ·æ¥ï¼ä»¥ä»£è¡¨æä¸äºç©çæ¨¡åã\n\nåºæ¬æ°æ®ç±»åå¯ä»¥çææ¯æºæç±»åçç§¯æ¨åãå½åºæ¬æ°æ®ç±»åæ°éæè§æ¨¡åï¼å°å®ä»¬æç»ç»å°ç»åèµ·æ¥ï¼å¯ä»¥æ´æ¹ä¾¿çç®¡çè¿äºæ°æ®ã\n\n * å¦æä½ æå¤§éçåºæ¬æ°æ®ç±»åå­æ®µï¼å°±æå¯è½å°å¶ä¸­é¨åå­å¨é»è¾èç³»çå­æ®µç»ç»èµ·æ¥ï¼å½¢æä¸ä¸ªç±»ãæ´è¿ä¸æ­¥çæ¯ï¼å°ä¸è¿äºæ°æ®æå³èçæ¹æ³ä¹ä¸å¹¶ç§»å¥ç±»ä¸­ãä¸ºäºå®ç°è¿ä¸ªç®æ ï¼å¯ä»¥å°è¯ ä»¥ç±»åä»£ç±»åç (Replace Type Code with Class) ã\n * å¦æåºæ¬æ°æ®ç±»åå­æ®µçå¼æ¯ç¨äºæ¹æ³çåæ°ï¼å¯ä»¥ä½¿ç¨ å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) æ ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) ã\n * å¦ææ³è¦æ¿æ¢çæ°æ®å¼æ¯ç±»åç ï¼èå®å¹¶ä¸å½±åè¡ä¸ºï¼åå¯ä»¥è¿ç¨ ä»¥ç±»åä»£ç±»åç (Replace Type Code with Class) å°å®æ¿æ¢æãå¦æä½ æä¸ç±»åç ç¸å³çæ¡ä»¶è¡¨è¾¾å¼ï¼å¯è¿ç¨ ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass) æ ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy) å ä»¥å¤çã\n * å¦æä½ åç°èªå·±æ­£ä»æ°ç»ä¸­æéæ°æ®ï¼å¯è¿ç¨ ä»¥å¯¹è±¡åä»£æ°ç»(Replace Array with Object) ã\n\n\n# 1.3. æ¶ç\n\n * å¤äºäºä½¿ç¨å¯¹è±¡æ¿ä»£åºæ¬æ°æ®ç±»åï¼ä½¿å¾ä»£ç åå¾æ´å çµæ´»ã\n * ä»£ç åå¾æ´å æè¯»åæ´å æç»ç»ãç¹æ®æ°æ®å¯ä»¥éä¸­è¿è¡æä½ï¼èä¸åä¹åé£æ ·åæ£ãä¸ç¨åçæµè¿äºéççå¸¸éçæä¹ä»¥åå®ä»¬ä¸ºä»ä¹å¨æ°ç»ä¸­ã\n * æ´å®¹æåç°éå¤ä»£ç ã\n\n\n\n\n# 1.4. éææ¹æ³è¯´æ\n\n# 1.4.1. ä»¥ç±»åä»£ç±»åç (Replace Type Code with Class)\n\né®é¢\n\nç±»ä¹ä¸­æä¸ä¸ªæ°å¼ç±»åç ï¼ä½å®å¹¶ä¸å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªæ°çç±»æ¿æ¢è¯¥æ°å¼ç±»åç ã\n\n\n\n# 1.4.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 1.4.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daysTempRange.getLow();\nint high = daysTempRange.getHigh();\nboolean withinPlan = plan.withinRange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinPlan = plan.withinRange(daysTempRange);\n\n\n# 1.4.4. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass)\n\né®é¢\n\nä½ æä¸ä¸ªä¸å¯åçç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥å­ç±»åä»£è¿ä¸ªç±»åç ã\n\n\n\n# 1.4.5. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy)\n\né®é¢\n\nä½ æä¸ä¸ªç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºï¼ä½ä½ æ æ³éè¿ç»§æ¿æ¶é¤å®ã\n\n\n\nè§£å³\n\nä»¥ç¶æå¯¹è±¡åä»£ç±»åç ã\n\n\n\n# 1.4.6. ä»¥å¯¹è±¡åä»£æ°ç»(Replace Array with Object)\n\né®é¢\n\nä½ æä¸ä¸ªæ°ç»ï¼å¶ä¸­çåç´ åèªä»£è¡¨ä¸åçä¸è¥¿ã\n\nString[] row = new String[3];\nrow[0] = "Liverpool";\nrow[1] = "15";\n\n\nè§£å³\n\nä»¥å¯¹è±¡æ¿æ¢æ°ç»ãå¯¹äºæ°ç»ä¸­çæ¯ä¸ªåç´ ï¼ä»¥ä¸ä¸ªå­æ®µæ¥è¡¨ç¤ºã\n\nPerformance row = new Performance();\nrow.setName("Liverpool");\nrow.setWins("15");\n\n\n\n# 2. æ°æ®æ³¥å¢\n\n> æ°æ®æ³¥å¢(Data Clumps)\n> \n> ææ¶ï¼ä»£ç çä¸åé¨ååå«ç¸åçåéç»ï¼ä¾å¦ç¨äºè¿æ¥å°æ°æ®åºçåæ°ï¼ãè¿äºç»å¨ä¸èµ·åºç°çæ°æ®åºè¯¥æ¥æèªå·±çå¯¹è±¡ã\n\n\n\n\n# 2.1. é®é¢åå \n\néå¸¸ï¼æ°æ®æ³¥å¢çåºç°æ¶å ä¸ºç³ç³çç¼ç¨ç»ææâå¤å¶-ç²è´´å¼ç¼ç¨âã\n\næä¸ä¸ªå¤æ­æ¯å¦æ¯æ°æ®æ³¥å¢çå¥½åæ³ï¼å æä¼å¤æ°æ®ä¸­çä¸é¡¹ãè¿ä¹åï¼å¶ä»æ°æ®ææ²¡æå èå¤±å»æä¹ï¼å¦æå®ä»¬ä¸åææä¹ï¼è¿å°±æ¯ä¸ªæç¡®çä¿¡å·ï¼ä½ åºè¯¥ä¸ºå®ä»¬äº§çä¸ä¸ªæ°çå¯¹è±¡ã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * é¦åæ¾åºè¿äºæ°æ®ä»¥å­æ®µå½¢å¼åºç°çå°æ¹ï¼è¿ç¨ æç¼ç±»(Extract Class) å°å®ä»¬æç¼å°ä¸ä¸ªç¬ç«å¯¹è±¡ä¸­ã\n * å¦ææ°æ®æ³¥å¢å¨å½æ°çåæ°åä¸­åºç°ï¼è¿ç¨ å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) å°å®ä»¬ç»ç»æä¸ä¸ªç±»ã\n * å¦ææ°æ®æ³¥å¢çé¨åæ°æ®åºç°å¨å¶ä»å½æ°ä¸­ï¼èèè¿ç¨ ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) å°æ´ä¸ªæ°æ®å¯¹è±¡ä¼ å¥å°å½æ°ä¸­ã\n * æ£è§ä¸ä¸ä½¿ç¨è¿äºå­æ®µçä»£ç ï¼ä¹è®¸ï¼å°å®ä»¬ç§»å¥ä¸ä¸ªæ°æ®ç±»æ¯ä¸ªä¸éçä¸»æã\n\n\n# 2.3. æ¶ç\n\n * æé«ä»£ç æè¯»æ§åç»ç»æ§ãå¯¹äºç¹æ®æ°æ®çæä½ï¼å¯ä»¥éä¸­è¿è¡å¤çï¼èä¸åä»¥åé£æ ·åæ£ã\n * åå°ä»£ç éã\n\n\n\n\n# 2.4. ä½æ¶å¿½ç¥\n\n * ææ¶ä¸ºäºå¯¹è±¡ä¸­çé¨åæ°æ®èå°æ´ä¸ªå¯¹è±¡ä½ä¸ºåæ°ä¼ éç»å½æ°ï¼å¯è½ä¼äº§çè®©ä¸¤ä¸ªç±»ä¹é´ä¸æ¶æ¬¢è¿çä¾èµå³ç³»ï¼è¿ä¸­æåµä¸å¯ä»¥ä¸ä¼ éæ´ä¸ªå¯¹è±¡ã\n\n\n# 2.5. éææ¹æ³è¯´æ\n\n# 2.5.1. æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 2.5.2. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 2.5.3. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daysTempRange.getLow();\nint high = daysTempRange.getHigh();\nboolean withinPlan = plan.withinRange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinPlan = plan.withinRange(daysTempRange);\n\n\n\n# 3. è¿å¤§çç±»\n\n> è¿å¤§çç±»(Large Class)\n> \n> ä¸ä¸ªç±»å«æè¿å¤å­æ®µãå½æ°ãä»£ç è¡ã\n\n\n\n\n# 3.1. é®é¢åå \n\nç±»éå¸¸ä¸å¼å§å¾å°ï¼ä½æ¯éçç¨åºçå¢é¿èéæ¸è¨èã\n\nç±»ä¼¼äºè¿é¿å½æ°ï¼ç¨åºåéå¸¸è§å¾å¨ä¸ä¸ªç°å­ç±»ä¸­æ·»å æ°ç¹æ§æ¯åå»ºä¸ä¸ªæ°çç±»è¦å®¹æã\n\n\n# 3.2. è§£å³æ¹æ³\n\nè®¾è®¡æ¨¡å¼ä¸­æä¸æ¡éè¦ååï¼èè´£åä¸ååãä¸ä¸ªç±»åºè¯¥åªèµäºå®ä¸ä¸ªèè´£ãå¦æå®ææ¿æçèè´£å¤ªå¤ï¼å°±è¯¥èèä¸ºå®ååè´ã\n\n\n\n * å¦æè¿å¤§ç±»ä¸­çé¨åè¡ä¸ºå¯ä»¥æç¼å°ä¸ä¸ªç¬ç«çç»ä»¶ä¸­ï¼å¯ä»¥ä½¿ç¨ æç¼ç±»(Extract Class)ã\n * å¦æè¿å¤§ç±»ä¸­çé¨åè¡ä¸ºå¯ä»¥ç¨ä¸åæ¹å¼å®ç°æä½¿ç¨äºç¹æ®åºæ¯ï¼å¯ä»¥ä½¿ç¨ æç¼å­ç±»(Extract Subclass)ã\n * å¦ææå¿è¦ä¸ºå®¢æ·ç«¯æä¾ä¸ç»æä½åè¡ä¸ºï¼å¯ä»¥ä½¿ç¨ æç¼æ¥å£(Extract Interface)ã\n * å¦æä½ çè¿å¤§ç±»æ¯ä¸ª GUI ç±»ï¼å¯è½éè¦ææ°æ®åè¡ä¸ºç§»å°ä¸ä¸ªç¬ç«çé¢åå¯¹è±¡å»ãä½ å¯è½éè¦ä¸¤è¾¹åä¿çä¸äºéå¤æ°æ®ï¼å¹¶ä¿æä¸¤è¾¹åæ­¥ã å¤å¶è¢«çè§æ°æ®(Duplicate Observed Data) å¯ä»¥åè¯ä½ æä¹åã\n\n\n# 3.3. æ¶ç\n\n * éæè¿å¤§çç±»å¯ä»¥ä½¿ç¨åºåä¸å¿è®°ä½ä¸ä¸ªç±»ä¸­å¤§éçå±æ§ã\n * å¨å¤§å¤æ°æåµä¸ï¼åå²è¿å¤§çç±»å¯ä»¥é¿åä»£ç ååè½çéå¤ã\n\n\n\n\n# 3.4. éææ¹æ³è¯´æ\n\n# 3.4.1. æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 3.4.2. æç¼å­ç±»(Extract Subclass)\n\né®é¢\n\nä¸ä¸ªç±»ä¸­æäºç¹æ§ä»ç¨äºç¹å®åºæ¯ã\n\n\n\nè§£å³\n\nåå»ºä¸ä¸ªå­ç±»ï¼å¹¶å°ç¨äºç¹æ®åºæ¯çç¹æ§ç½®å¥å¶ä¸­ã\n\n\n\n# 3.4.3. æç¼æ¥å£(Extract Interface)\n\né®é¢\n\nå¤ä¸ªå®¢æ·ç«¯ä½¿ç¨ä¸ä¸ªç±»é¨åç¸åçå½æ°ãå¦ä¸ä¸ªåºæ¯æ¯ä¸¤ä¸ªç±»ä¸­çé¨åå½æ°ç¸åã\n\n\n\nè§£å³\n\nç§»å¨ç¸åçé¨åå½æ°å°æ¥å£ä¸­ã\n\n\n\n# 3.4.4. å¤å¶è¢«çè§æ°æ®(Duplicate Observed Data)\n\né®é¢\n\nå¦æå­å¨å¨ç±»ä¸­çæ°æ®æ¯è´è´£ GUI çã\n\n\n\nè§£å³\n\nä¸ä¸ªæ¯è¾å¥½çæ¹æ³æ¯å°è´è´£ GUI çæ°æ®æ¾å¥ä¸ä¸ªç¬ç«çç±»ï¼ä»¥ç¡®ä¿ GUI æ°æ®ä¸åç±»ä¹é´çè¿æ¥ååæ­¥ã\n\n\n\n\n# 4. è¿é¿å½æ°\n\n> è¿é¿å½æ°(Long Method)\n> \n> ä¸ä¸ªå½æ°å«æå¤ªå¤è¡ä»£ç ãä¸è¬æ¥è¯´ï¼ä»»ä½å½æ°è¶è¿ 10 è¡æ¶ï¼ä½ å°±å¯ä»¥èèæ¯ä¸æ¯è¿é¿äºã å½æ°ä¸­çä»£ç è¡æ°ååä¸ä¸è¦è¶è¿ 100 è¡ã\n\n\n\n\n# 4.1. é®é¢çåå \n\néå¸¸æåµä¸ï¼åå»ºä¸ä¸ªæ°å½æ°çé¾åº¦è¦å¤§äºæ·»å åè½å°ä¸ä¸ªå·²å­å¨çå½æ°ãå¤§é¨åäººé½è§å¾ï¼âæå°±æ·»å è¿ä¹ä¸¤è¡ä»£ç ï¼ä¸ºæ­¤æ°å»ºä¸ä¸ªå½æ°å®å¨æ¯å°é¢å¤§åäºãâäºæ¯ï¼å¼ ä¸å ä¸¤è¡ï¼æåå ä¸¤è¡ï¼çäºå ä¸¤è¡ãããå½æ°æ¥çåºå¤§ï¼æç»ççåä¸éæµç³ï¼åä¹æ²¡äººè½å®å¨çæäºãäºæ¯å¤§å®¶å°±æ´ä¸æ¢è½»æå¨è¿ä¸ªå½æ°äºï¼åªè½æ¶æ§å¾ªç¯çå¾å¶ä¸­æ·»å ä»£ç ãæä»¥ï¼å¦æä½ çå°ä¸ä¸ªè¶è¿ 200 è¡çå½æ°ï¼éå¸¸é½æ¯å¤ä¸ªç¨åºåä¸æ¼è¥¿ååºæ¥çã\n\n\n# 4.2. è§£å³å½æ°\n\nä¸ä¸ªå¾å¥½çæå·§æ¯ï¼å¯»æ¾æ³¨éãæ·»å æ³¨éï¼ä¸è¬æè¿ä¹å ä¸ªåå ï¼ä»£ç é»è¾è¾ä¸ºæ¦æ¶©æå¤æï¼è¿æ®µä»£ç åè½ç¸å¯¹ç¬ç«ï¼ç¹æ®å¤çã å¦æä»£ç åæ¹æä¸è¡æ³¨éï¼å°±æ¯å¨æéä½ ï¼å¯ä»¥å°è¿æ®µä»£ç æ¿æ¢æä¸ä¸ªå½æ°ï¼èä¸å¯ä»¥å¨æ³¨éçåºç¡ä¸ç»è¿ä¸ªå½æ°å½åãå¦æå½æ°æä¸ä¸ªæè¿°æ°å½çåå­ï¼å°±ä¸éè¦å»çåé¨ä»£ç ç©¶ç«æ¯å¦ä½å®ç°çãå°±ç®åªæä¸è¡ä»£ç ï¼å¦æå®éè¦ä»¥æ³¨éæ¥è¯´æï¼é£ä¹å¼å¾å°å®æç¼å°ç¬ç«å½æ°ä¸­ã\n\n\n\n * ä¸ºäºç»ä¸ä¸ªå½æ°ç¦èº«ï¼å¯ä»¥ä½¿ç¨ æç¼å½æ°(Extract Method)ã\n * å¦æå±é¨åéååæ°å¹²æ°æç¼å½æ°ï¼å¯ä»¥ä½¿ç¨ ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(Replace Temp with Query)ï¼å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) æ ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) ã\n * å¦æåé¢ä¸¤æ¡æ²¡æå¸®å©ï¼å¯ä»¥éè¿ ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object) å°è¯ç§»å¨æ´ä¸ªå½æ°å°ä¸ä¸ªç¬ç«çå¯¹è±¡ä¸­ã\n * æ¡ä»¶è¡¨è¾¾å¼åå¾ªç¯å¸¸å¸¸ä¹æ¯æç¼çä¿¡å·ãå¯¹äºæ¡ä»¶è¡¨è¾¾å¼ï¼å¯ä»¥ä½¿ç¨ åè§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional) ãè³äºå¾ªç¯ï¼åºè¯¥ä½¿ç¨ æç¼å½æ°(Extract Method) å°å¾ªç¯åå¶åçä»£ç æç¼å°ç¬ç«å½æ°ä¸­ã\n\n\n# 4.3. æ¶ç\n\n * å¨ææç±»åçé¢åå¯¹è±¡ä»£ç ä¸­ï¼å½æ°æ¯è¾ç­å°ç²¾æçç±»å¾å¾çå½å¨æè¾é¿ãä¸ä¸ªå½æ°è¶é¿ï¼å°±è¶ä¸å®¹æçè§£åç»´æ¤ã\n * æ­¤å¤ï¼è¿é¿å½æ°ä¸­å¾å¾å«æé¾ä»¥åç°çéå¤ä»£ç ã\n\n\n\n\n# 4.4. æ§è½\n\næ¯å¦åè®¸å¤äººè¯´çé£æ ·ï¼å¢å å½æ°çæ°éä¼å½±åæ§è½ï¼å¨å ä¹ç»å¤§å¤æ°æåµä¸ï¼è¿ç§å½±åæ¯å¯ä»¥å¿½ç¥ä¸è®¡ï¼æä»¥ä¸ç¨æå¿ã æ­¤å¤ï¼ç°å¨æäºæ¸æ°åæè¯»çä»£ç ï¼å¨éè¦çæ¶åï¼ä½ å°æ´å®¹ææ¾å°çæ­£ææçå½æ°æ¥éç»ä»£ç åæé«æ§è½ã\n\n\n# 4.5. éææ¹æ³è¯´æ\n\n# 4.5.1. æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# 4.5.2. ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(Replace Temp with Query)\n\né®é¢\n\nå°è¡¨è¾¾å¼çç»ææ¾å¨å±é¨åéä¸­ï¼ç¶åå¨ä»£ç ä¸­ä½¿ç¨ã\n\ndouble calculateTotal() {\n  double basePrice = quantity * itemPrice;\n  if (basePrice > 1000) {\n    return basePrice * 0.95;\n  }\n  else {\n    return basePrice * 0.98;\n  }\n}\n\n\nè§£å³\n\nå°æ´ä¸ªè¡¨è¾¾å¼ç§»å¨å°ä¸ä¸ªç¬ç«çå½æ°ä¸­å¹¶è¿åç»æãä½¿ç¨æ¥è¯¢å½æ°æ¥æ¿ä»£ä½¿ç¨åéãå¦æéè¦ï¼å¯ä»¥å¨å¶ä»å½æ°ä¸­åå¹¶æ°å½æ°ã\n\ndouble calculateTotal() {\n  if (basePrice() > 1000) {\n    return basePrice() * 0.95;\n  }\n  else {\n    return basePrice() * 0.98;\n  }\n}\ndouble basePrice() {\n  return quantity * itemPrice;\n}\n\n\n# 4.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 4.5.4. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daysTempRange.getLow();\nint high = daysTempRange.getHigh();\nboolean withinPlan = plan.withinRange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinPlan = plan.withinRange(daysTempRange);\n\n\n# 4.5.5. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object)\n\né®é¢\n\nä½ æä¸ä¸ªè¿é¿å½æ°ï¼å®çå±é¨åéäº¤ç»å¨ä¸èµ·ï¼ä»¥è´äºä½ æ æ³åºç¨æç¼å½æ°(Extract Method) ã\n\nclass Order {\n  //...\n  public double price() {\n    double primaryBasePrice;\n    double secondaryBasePrice;\n    double tertiaryBasePrice;\n    // long computation.\n    //...\n  }\n}\n\n\nè§£å³\n\nå°å½æ°ç§»å°ä¸ä¸ªç¬ç«çç±»ä¸­ï¼ä½¿å¾å±é¨åéæäºè¿ä¸ªç±»çå­æ®µãç¶åï¼ä½ å¯ä»¥å°å½æ°åå²æè¿ä¸ªç±»ä¸­çå¤ä¸ªå½æ°ã\n\nclass Order {\n  //...\n  public double price() {\n    return new PriceCalculator(this).compute();\n  }\n}\n\nclass PriceCalculator {\n  private double primaryBasePrice;\n  private double secondaryBasePrice;\n  private double tertiaryBasePrice;\n\n  public PriceCalculator(Order order) {\n    // copy relevant information from order object.\n    //...\n  }\n\n  public double compute() {\n    // long computation.\n    //...\n  }\n}\n\n\n# 4.5.6. åè§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)\n\né®é¢\n\nä½ æå¤æçæ¡ä»¶è¡¨è¾¾å¼ã\n\nif (date.before(SUMMER_START) || date.after(SUMMER_END)) {\n  charge = quantity * winterRate + winterServiceCharge;\n}\nelse {\n  charge = quantity * summerRate;\n}\n\n\nè§£å³\n\næ ¹æ®æ¡ä»¶åæ¯å°æ´ä¸ªæ¡ä»¶è¡¨è¾¾å¼åè§£æå ä¸ªå½æ°ã\n\nif (notSummer(date)) {\n  charge = winterCharge(quantity);\n}\nelse {\n  charge = summerCharge(quantity);\n}\n\n\n\n# 5. è¿é¿åæ°å\n\n> è¿é¿åæ°å(Long Parameter List)\n> \n> ä¸ä¸ªå½æ°æè¶è¿ 3ã4 ä¸ªå¥åã\n\n\n\n\n# 5.1. é®é¢åå \n\nè¿é¿åæ°åå¯è½æ¯å°å¤ä¸ªç®æ³å¹¶å°ä¸ä¸ªå½æ°ä¸­æ¶åççãå½æ°ä¸­çå¥åå¯ä»¥ç¨æ¥æ§å¶æç»éç¨åªä¸ªç®æ³å»æ§è¡ã\n\nè¿é¿åæ°åä¹å¯è½æ¯è§£è¦ç±»ä¹é´ä¾èµå³ç³»æ¶çå¯äº§åãä¾å¦ï¼ç¨äºåå»ºå½æ°ä¸­æéçç¹å®å¯¹è±¡çä»£ç å·²ä»å½æ°ç§»å¨å°è°ç¨å½æ°çä»£ç å¤ï¼ä½åå»ºçå¯¹è±¡æ¯ä½ä¸ºåæ°ä¼ éå°å½æ°ä¸­ãå æ­¤ï¼åå§ç±»ä¸åç¥éå¯¹è±¡ä¹é´çå³ç³»ï¼å¹¶ä¸ä¾èµæ§ä¹å·²ç»åå°ãä½æ¯å¦æåå»ºçè¿äºå¯¹è±¡ï¼æ¯ä¸ä¸ªé½å°éè¦å®èªå·±çåæ°ï¼è¿æå³çè¿é¿åæ°åã\n\nå¤ªé¿çåæ°åé¾ä»¥çè§£ï¼å¤ªå¤åæ°ä¼é æååä¸ä¸è´ãä¸æä½¿ç¨ï¼èä¸ä¸æ¦éè¦æ´å¤æ°æ®ï¼å°±ä¸å¾ä¸ä¿®æ¹å®ã\n\n\n# 5.2. è§£å³æ¹æ¡\n\n\n\n * å¦æåå·²æçå¯¹è±¡ååºä¸æ¡è¯·æ±å°±å¯ä»¥åä»£ä¸ä¸ªåæ°ï¼é£ä¹ä½ åºè¯¥ä½¿ç¨ ä»¥å½æ°åä»£åæ°(Replace Parameter with Methods) ãå¨è¿éï¼ï¼âå·²æçå¯¹è±¡âå¯è½æ¯å½æ°æå±ç±»éçä¸ä¸ªå­æ®µï¼ä¹å¯è½æ¯å¦ä¸ä¸ªåæ°ã\n * ä½ è¿å¯ä»¥è¿ç¨ ä¿æå¯¹è±¡å®æ´(Preserve Whole Object) å°æ¥èªåä¸å¯¹è±¡çä¸å æ°æ®æ¶éèµ·æ¥ï¼å¹¶ä»¥è¯¥å¯¹è±¡æ¿æ¢å®ä»¬ã\n * å¦ææäºæ°æ®ç¼ºä¹åççå¯¹è±¡å½å±ï¼å¯ä½¿ç¨ å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object) ä¸ºå®ä»¬å¶é åºä¸ä¸ªâåæ°å¯¹è±¡âã\n\n\n# 5.3. æ¶ç\n\n * æ´æè¯»ï¼æ´ç®ç­çä»£ç ã\n * éæå¯è½ä¼æ´é²åºä¹åæªæ³¨æå°çéå¤ä»£ç ã\n\n\n# 5.4. ä½æ¶å¿½ç¥\n\n * è¿éæä¸ä¸ªéè¦çä¾å¤ï¼ææ¶åä½ ææ¾ä¸æ³é æ"è¢«è°ç¨å¯¹è±¡"ä¸"è¾å¤§å¯¹è±¡"é´çæç§ä¾èµå³ç³»ãè¿æ¶åå°æ°æ®ä»å¯¹è±¡ä¸­æè§£åºæ¥åç¬ä½ä¸ºåæ°ï¼ä¹å¾åæçãä½æ¯è¯·æ³¨æå¶æå¼åçä»£ä»·ãå¦æåæ°åå¤ªé¿æååå¤ªé¢ç¹ï¼å°±éè¦éæ°èèèªå·±çä¾èµç»æäºã\n\n\n# 5.5. éææ¹æ³è¯´æ\n\n# 5.5.1. ä»¥å½æ°åä»£åæ°(Replace Parameter with Methods)\n\né®é¢\n\nå¯¹è±¡è°ç¨æä¸ªå½æ°ï¼å¹¶å°æå¾ç»æä½ä¸ºåæ°ï¼ä¼ éç»å¦ä¸ä¸ªå½æ°ãèæ¥åè¯¥åæ°çå½æ°æ¬èº«ä¹è½å¤è°ç¨åä¸ä¸ªå½æ°ã\n\nint basePrice = quantity * itemPrice;\ndouble seasonDiscount = this.getSeasonalDiscount();\ndouble fees = this.getFees();\ndouble finalPrice = discountedPrice(basePrice, seasonDiscount, fees);\n\n\nè§£å³\n\nè®©åæ°æ¥åèå»é¤è¯¥é¡¹åæ°ï¼å¹¶ç´æ¥è°ç¨åä¸ä¸ªå½æ°ã\n\nint basePrice = quantity * itemPrice;\ndouble finalPrice = discountedPrice(basePrice);\n\n\n# 5.5.2. ä¿æå¯¹è±¡å®æ´(Preserve Whole Object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daysTempRange.getLow();\nint high = daysTempRange.getHigh();\nboolean withinPlan = plan.withinRange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinPlan = plan.withinRange(daysTempRange);\n\n\n# 5.5.3. å¼å¥åæ°å¯¹è±¡(Introduce Parameter Object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n\n# 6. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 7. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',normalizedContent:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/bloaters\n> \n> ä»£ç èè¿(bloated)è¿ç»åå³éæå³çï¼ä»£ç ä¸­çç±»ãå½æ°ãå­æ®µæ²¡æç»è¿åççç»ç»ï¼åªæ¯ç®åçå ç èµ·æ¥ãè¿ä¸ç±»åçé®é¢éå¸¸å¨ä»£ç çåæå¹¶ä¸ææ¾ï¼ä½æ¯éçä»£ç è§æ¨¡çå¢é¿èéæ¸ç§¯ç´¯ï¼ç¹å«æ¯å½æ²¡æäººåªåå»æ ¹é¤å®ä»¬æ¶ï¼ã\n\n\n# 1. åºæ¬ç±»ååæ§\n\n> åºæ¬ç±»ååæ§(primitive obsession)\n> \n>  * ä½¿ç¨åºæ¬ç±»åèä¸æ¯å°å¯¹è±¡æ¥å®ç°ç®åä»»å¡ï¼ä¾å¦è´§å¸ãèå´ãçµè¯å·ç å­ç¬¦ä¸²ç­ï¼ã\n>  * ä½¿ç¨å¸¸éç¼ç ä¿¡æ¯ï¼ä¾å¦ä¸ä¸ªç¨äºå¼ç¨ç®¡çåæéçå¸¸éuser_admin_role = 1 ï¼ã\n>  * ä½¿ç¨å­ç¬¦ä¸²å¸¸éä½ä¸ºå­æ®µåå¨æ°ç»ä¸­ä½¿ç¨ã\n\n\n\n\n# 1.1. é®é¢åå \n\nç±»ä¼¼å¶ä»å¤§é¨ååå³éï¼åºæ¬ç±»ååæ§è¯çäºç±»åå»ºçæ¶åãä¸å¼å§ï¼å¯è½åªæ¯ä¸å¤çå­æ®µï¼éçè¡¨ç¤ºçç¹æ§è¶æ¥è¶å¤ï¼åºæ¬æ°æ®ç±»åå­æ®µä¹è¶æ¥è¶å¤ã\n\nåºæ¬ç±»åå¸¸å¸¸è¢«ç¨äºè¡¨ç¤ºæ¨¡åçç±»åãä½ æä¸ç»æ°å­æå­ç¬¦ä¸²ç¨æ¥è¡¨ç¤ºæä¸ªå®ä½ã\n\nè¿æä¸ä¸ªåºæ¯ï¼å¨æ¨¡æåºæ¯ï¼å¤§éçå­ç¬¦ä¸²å¸¸éè¢«ç¨äºæ°ç»çç´¢å¼ã\n\n\n# 1.2. è§£å³æ¹æ³\n\n\n\nå¤§å¤æ°ç¼ç¨è¯­è¨é½æ¯æåºæ¬æ°æ®ç±»ååç»æç±»åï¼ç±»ãç»æä½ç­ï¼ãç»æç±»ååè®¸ç¨åºåå°åºæ¬æ°æ®ç±»åç»ç»èµ·æ¥ï¼ä»¥ä»£è¡¨æä¸äºç©çæ¨¡åã\n\nåºæ¬æ°æ®ç±»åå¯ä»¥çææ¯æºæç±»åçç§¯æ¨åãå½åºæ¬æ°æ®ç±»åæ°éæè§æ¨¡åï¼å°å®ä»¬æç»ç»å°ç»åèµ·æ¥ï¼å¯ä»¥æ´æ¹ä¾¿çç®¡çè¿äºæ°æ®ã\n\n * å¦æä½ æå¤§éçåºæ¬æ°æ®ç±»åå­æ®µï¼å°±æå¯è½å°å¶ä¸­é¨åå­å¨é»è¾èç³»çå­æ®µç»ç»èµ·æ¥ï¼å½¢æä¸ä¸ªç±»ãæ´è¿ä¸æ­¥çæ¯ï¼å°ä¸è¿äºæ°æ®æå³èçæ¹æ³ä¹ä¸å¹¶ç§»å¥ç±»ä¸­ãä¸ºäºå®ç°è¿ä¸ªç®æ ï¼å¯ä»¥å°è¯ ä»¥ç±»åä»£ç±»åç (replace type code with class) ã\n * å¦æåºæ¬æ°æ®ç±»åå­æ®µçå¼æ¯ç¨äºæ¹æ³çåæ°ï¼å¯ä»¥ä½¿ç¨ å¼å¥åæ°å¯¹è±¡(introduce parameter object) æ ä¿æå¯¹è±¡å®æ´(preserve whole object) ã\n * å¦ææ³è¦æ¿æ¢çæ°æ®å¼æ¯ç±»åç ï¼èå®å¹¶ä¸å½±åè¡ä¸ºï¼åå¯ä»¥è¿ç¨ ä»¥ç±»åä»£ç±»åç (replace type code with class) å°å®æ¿æ¢æãå¦æä½ æä¸ç±»åç ç¸å³çæ¡ä»¶è¡¨è¾¾å¼ï¼å¯è¿ç¨ ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass) æ ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy) å ä»¥å¤çã\n * å¦æä½ åç°èªå·±æ­£ä»æ°ç»ä¸­æéæ°æ®ï¼å¯è¿ç¨ ä»¥å¯¹è±¡åä»£æ°ç»(replace array with object) ã\n\n\n# 1.3. æ¶ç\n\n * å¤äºäºä½¿ç¨å¯¹è±¡æ¿ä»£åºæ¬æ°æ®ç±»åï¼ä½¿å¾ä»£ç åå¾æ´å çµæ´»ã\n * ä»£ç åå¾æ´å æè¯»åæ´å æç»ç»ãç¹æ®æ°æ®å¯ä»¥éä¸­è¿è¡æä½ï¼èä¸åä¹åé£æ ·åæ£ãä¸ç¨åçæµè¿äºéççå¸¸éçæä¹ä»¥åå®ä»¬ä¸ºä»ä¹å¨æ°ç»ä¸­ã\n * æ´å®¹æåç°éå¤ä»£ç ã\n\n\n\n\n# 1.4. éææ¹æ³è¯´æ\n\n# 1.4.1. ä»¥ç±»åä»£ç±»åç (replace type code with class)\n\né®é¢\n\nç±»ä¹ä¸­æä¸ä¸ªæ°å¼ç±»åç ï¼ä½å®å¹¶ä¸å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªæ°çç±»æ¿æ¢è¯¥æ°å¼ç±»åç ã\n\n\n\n# 1.4.2. å¼å¥åæ°å¯¹è±¡(introduce parameter object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 1.4.3. ä¿æå¯¹è±¡å®æ´(preserve whole object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daystemprange.getlow();\nint high = daystemprange.gethigh();\nboolean withinplan = plan.withinrange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinplan = plan.withinrange(daystemprange);\n\n\n# 1.4.4. ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass)\n\né®é¢\n\nä½ æä¸ä¸ªä¸å¯åçç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥å­ç±»åä»£è¿ä¸ªç±»åç ã\n\n\n\n# 1.4.5. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy)\n\né®é¢\n\nä½ æä¸ä¸ªç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºï¼ä½ä½ æ æ³éè¿ç»§æ¿æ¶é¤å®ã\n\n\n\nè§£å³\n\nä»¥ç¶æå¯¹è±¡åä»£ç±»åç ã\n\n\n\n# 1.4.6. ä»¥å¯¹è±¡åä»£æ°ç»(replace array with object)\n\né®é¢\n\nä½ æä¸ä¸ªæ°ç»ï¼å¶ä¸­çåç´ åèªä»£è¡¨ä¸åçä¸è¥¿ã\n\nstring[] row = new string[3];\nrow[0] = "liverpool";\nrow[1] = "15";\n\n\nè§£å³\n\nä»¥å¯¹è±¡æ¿æ¢æ°ç»ãå¯¹äºæ°ç»ä¸­çæ¯ä¸ªåç´ ï¼ä»¥ä¸ä¸ªå­æ®µæ¥è¡¨ç¤ºã\n\nperformance row = new performance();\nrow.setname("liverpool");\nrow.setwins("15");\n\n\n\n# 2. æ°æ®æ³¥å¢\n\n> æ°æ®æ³¥å¢(data clumps)\n> \n> ææ¶ï¼ä»£ç çä¸åé¨ååå«ç¸åçåéç»ï¼ä¾å¦ç¨äºè¿æ¥å°æ°æ®åºçåæ°ï¼ãè¿äºç»å¨ä¸èµ·åºç°çæ°æ®åºè¯¥æ¥æèªå·±çå¯¹è±¡ã\n\n\n\n\n# 2.1. é®é¢åå \n\néå¸¸ï¼æ°æ®æ³¥å¢çåºç°æ¶å ä¸ºç³ç³çç¼ç¨ç»ææâå¤å¶-ç²è´´å¼ç¼ç¨âã\n\næä¸ä¸ªå¤æ­æ¯å¦æ¯æ°æ®æ³¥å¢çå¥½åæ³ï¼å æä¼å¤æ°æ®ä¸­çä¸é¡¹ãè¿ä¹åï¼å¶ä»æ°æ®ææ²¡æå èå¤±å»æä¹ï¼å¦æå®ä»¬ä¸åææä¹ï¼è¿å°±æ¯ä¸ªæç¡®çä¿¡å·ï¼ä½ åºè¯¥ä¸ºå®ä»¬äº§çä¸ä¸ªæ°çå¯¹è±¡ã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * é¦åæ¾åºè¿äºæ°æ®ä»¥å­æ®µå½¢å¼åºç°çå°æ¹ï¼è¿ç¨ æç¼ç±»(extract class) å°å®ä»¬æç¼å°ä¸ä¸ªç¬ç«å¯¹è±¡ä¸­ã\n * å¦ææ°æ®æ³¥å¢å¨å½æ°çåæ°åä¸­åºç°ï¼è¿ç¨ å¼å¥åæ°å¯¹è±¡(introduce parameter object) å°å®ä»¬ç»ç»æä¸ä¸ªç±»ã\n * å¦ææ°æ®æ³¥å¢çé¨åæ°æ®åºç°å¨å¶ä»å½æ°ä¸­ï¼èèè¿ç¨ ä¿æå¯¹è±¡å®æ´(preserve whole object) å°æ´ä¸ªæ°æ®å¯¹è±¡ä¼ å¥å°å½æ°ä¸­ã\n * æ£è§ä¸ä¸ä½¿ç¨è¿äºå­æ®µçä»£ç ï¼ä¹è®¸ï¼å°å®ä»¬ç§»å¥ä¸ä¸ªæ°æ®ç±»æ¯ä¸ªä¸éçä¸»æã\n\n\n# 2.3. æ¶ç\n\n * æé«ä»£ç æè¯»æ§åç»ç»æ§ãå¯¹äºç¹æ®æ°æ®çæä½ï¼å¯ä»¥éä¸­è¿è¡å¤çï¼èä¸åä»¥åé£æ ·åæ£ã\n * åå°ä»£ç éã\n\n\n\n\n# 2.4. ä½æ¶å¿½ç¥\n\n * ææ¶ä¸ºäºå¯¹è±¡ä¸­çé¨åæ°æ®èå°æ´ä¸ªå¯¹è±¡ä½ä¸ºåæ°ä¼ éç»å½æ°ï¼å¯è½ä¼äº§çè®©ä¸¤ä¸ªç±»ä¹é´ä¸æ¶æ¬¢è¿çä¾èµå³ç³»ï¼è¿ä¸­æåµä¸å¯ä»¥ä¸ä¼ éæ´ä¸ªå¯¹è±¡ã\n\n\n# 2.5. éææ¹æ³è¯´æ\n\n# 2.5.1. æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 2.5.2. å¼å¥åæ°å¯¹è±¡(introduce parameter object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 2.5.3. ä¿æå¯¹è±¡å®æ´(preserve whole object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daystemprange.getlow();\nint high = daystemprange.gethigh();\nboolean withinplan = plan.withinrange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinplan = plan.withinrange(daystemprange);\n\n\n\n# 3. è¿å¤§çç±»\n\n> è¿å¤§çç±»(large class)\n> \n> ä¸ä¸ªç±»å«æè¿å¤å­æ®µãå½æ°ãä»£ç è¡ã\n\n\n\n\n# 3.1. é®é¢åå \n\nç±»éå¸¸ä¸å¼å§å¾å°ï¼ä½æ¯éçç¨åºçå¢é¿èéæ¸è¨èã\n\nç±»ä¼¼äºè¿é¿å½æ°ï¼ç¨åºåéå¸¸è§å¾å¨ä¸ä¸ªç°å­ç±»ä¸­æ·»å æ°ç¹æ§æ¯åå»ºä¸ä¸ªæ°çç±»è¦å®¹æã\n\n\n# 3.2. è§£å³æ¹æ³\n\nè®¾è®¡æ¨¡å¼ä¸­æä¸æ¡éè¦ååï¼èè´£åä¸ååãä¸ä¸ªç±»åºè¯¥åªèµäºå®ä¸ä¸ªèè´£ãå¦æå®ææ¿æçèè´£å¤ªå¤ï¼å°±è¯¥èèä¸ºå®ååè´ã\n\n\n\n * å¦æè¿å¤§ç±»ä¸­çé¨åè¡ä¸ºå¯ä»¥æç¼å°ä¸ä¸ªç¬ç«çç»ä»¶ä¸­ï¼å¯ä»¥ä½¿ç¨ æç¼ç±»(extract class)ã\n * å¦æè¿å¤§ç±»ä¸­çé¨åè¡ä¸ºå¯ä»¥ç¨ä¸åæ¹å¼å®ç°æä½¿ç¨äºç¹æ®åºæ¯ï¼å¯ä»¥ä½¿ç¨ æç¼å­ç±»(extract subclass)ã\n * å¦ææå¿è¦ä¸ºå®¢æ·ç«¯æä¾ä¸ç»æä½åè¡ä¸ºï¼å¯ä»¥ä½¿ç¨ æç¼æ¥å£(extract interface)ã\n * å¦æä½ çè¿å¤§ç±»æ¯ä¸ª gui ç±»ï¼å¯è½éè¦ææ°æ®åè¡ä¸ºç§»å°ä¸ä¸ªç¬ç«çé¢åå¯¹è±¡å»ãä½ å¯è½éè¦ä¸¤è¾¹åä¿çä¸äºéå¤æ°æ®ï¼å¹¶ä¿æä¸¤è¾¹åæ­¥ã å¤å¶è¢«çè§æ°æ®(duplicate observed data) å¯ä»¥åè¯ä½ æä¹åã\n\n\n# 3.3. æ¶ç\n\n * éæè¿å¤§çç±»å¯ä»¥ä½¿ç¨åºåä¸å¿è®°ä½ä¸ä¸ªç±»ä¸­å¤§éçå±æ§ã\n * å¨å¤§å¤æ°æåµä¸ï¼åå²è¿å¤§çç±»å¯ä»¥é¿åä»£ç ååè½çéå¤ã\n\n\n\n\n# 3.4. éææ¹æ³è¯´æ\n\n# 3.4.1. æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 3.4.2. æç¼å­ç±»(extract subclass)\n\né®é¢\n\nä¸ä¸ªç±»ä¸­æäºç¹æ§ä»ç¨äºç¹å®åºæ¯ã\n\n\n\nè§£å³\n\nåå»ºä¸ä¸ªå­ç±»ï¼å¹¶å°ç¨äºç¹æ®åºæ¯çç¹æ§ç½®å¥å¶ä¸­ã\n\n\n\n# 3.4.3. æç¼æ¥å£(extract interface)\n\né®é¢\n\nå¤ä¸ªå®¢æ·ç«¯ä½¿ç¨ä¸ä¸ªç±»é¨åç¸åçå½æ°ãå¦ä¸ä¸ªåºæ¯æ¯ä¸¤ä¸ªç±»ä¸­çé¨åå½æ°ç¸åã\n\n\n\nè§£å³\n\nç§»å¨ç¸åçé¨åå½æ°å°æ¥å£ä¸­ã\n\n\n\n# 3.4.4. å¤å¶è¢«çè§æ°æ®(duplicate observed data)\n\né®é¢\n\nå¦æå­å¨å¨ç±»ä¸­çæ°æ®æ¯è´è´£ gui çã\n\n\n\nè§£å³\n\nä¸ä¸ªæ¯è¾å¥½çæ¹æ³æ¯å°è´è´£ gui çæ°æ®æ¾å¥ä¸ä¸ªç¬ç«çç±»ï¼ä»¥ç¡®ä¿ gui æ°æ®ä¸åç±»ä¹é´çè¿æ¥ååæ­¥ã\n\n\n\n\n# 4. è¿é¿å½æ°\n\n> è¿é¿å½æ°(long method)\n> \n> ä¸ä¸ªå½æ°å«æå¤ªå¤è¡ä»£ç ãä¸è¬æ¥è¯´ï¼ä»»ä½å½æ°è¶è¿ 10 è¡æ¶ï¼ä½ å°±å¯ä»¥èèæ¯ä¸æ¯è¿é¿äºã å½æ°ä¸­çä»£ç è¡æ°ååä¸ä¸è¦è¶è¿ 100 è¡ã\n\n\n\n\n# 4.1. é®é¢çåå \n\néå¸¸æåµä¸ï¼åå»ºä¸ä¸ªæ°å½æ°çé¾åº¦è¦å¤§äºæ·»å åè½å°ä¸ä¸ªå·²å­å¨çå½æ°ãå¤§é¨åäººé½è§å¾ï¼âæå°±æ·»å è¿ä¹ä¸¤è¡ä»£ç ï¼ä¸ºæ­¤æ°å»ºä¸ä¸ªå½æ°å®å¨æ¯å°é¢å¤§åäºãâäºæ¯ï¼å¼ ä¸å ä¸¤è¡ï¼æåå ä¸¤è¡ï¼çäºå ä¸¤è¡ãããå½æ°æ¥çåºå¤§ï¼æç»ççåä¸éæµç³ï¼åä¹æ²¡äººè½å®å¨çæäºãäºæ¯å¤§å®¶å°±æ´ä¸æ¢è½»æå¨è¿ä¸ªå½æ°äºï¼åªè½æ¶æ§å¾ªç¯çå¾å¶ä¸­æ·»å ä»£ç ãæä»¥ï¼å¦æä½ çå°ä¸ä¸ªè¶è¿ 200 è¡çå½æ°ï¼éå¸¸é½æ¯å¤ä¸ªç¨åºåä¸æ¼è¥¿ååºæ¥çã\n\n\n# 4.2. è§£å³å½æ°\n\nä¸ä¸ªå¾å¥½çæå·§æ¯ï¼å¯»æ¾æ³¨éãæ·»å æ³¨éï¼ä¸è¬æè¿ä¹å ä¸ªåå ï¼ä»£ç é»è¾è¾ä¸ºæ¦æ¶©æå¤æï¼è¿æ®µä»£ç åè½ç¸å¯¹ç¬ç«ï¼ç¹æ®å¤çã å¦æä»£ç åæ¹æä¸è¡æ³¨éï¼å°±æ¯å¨æéä½ ï¼å¯ä»¥å°è¿æ®µä»£ç æ¿æ¢æä¸ä¸ªå½æ°ï¼èä¸å¯ä»¥å¨æ³¨éçåºç¡ä¸ç»è¿ä¸ªå½æ°å½åãå¦æå½æ°æä¸ä¸ªæè¿°æ°å½çåå­ï¼å°±ä¸éè¦å»çåé¨ä»£ç ç©¶ç«æ¯å¦ä½å®ç°çãå°±ç®åªæä¸è¡ä»£ç ï¼å¦æå®éè¦ä»¥æ³¨éæ¥è¯´æï¼é£ä¹å¼å¾å°å®æç¼å°ç¬ç«å½æ°ä¸­ã\n\n\n\n * ä¸ºäºç»ä¸ä¸ªå½æ°ç¦èº«ï¼å¯ä»¥ä½¿ç¨ æç¼å½æ°(extract method)ã\n * å¦æå±é¨åéååæ°å¹²æ°æç¼å½æ°ï¼å¯ä»¥ä½¿ç¨ ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(replace temp with query)ï¼å¼å¥åæ°å¯¹è±¡(introduce parameter object) æ ä¿æå¯¹è±¡å®æ´(preserve whole object) ã\n * å¦æåé¢ä¸¤æ¡æ²¡æå¸®å©ï¼å¯ä»¥éè¿ ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object) å°è¯ç§»å¨æ´ä¸ªå½æ°å°ä¸ä¸ªç¬ç«çå¯¹è±¡ä¸­ã\n * æ¡ä»¶è¡¨è¾¾å¼åå¾ªç¯å¸¸å¸¸ä¹æ¯æç¼çä¿¡å·ãå¯¹äºæ¡ä»¶è¡¨è¾¾å¼ï¼å¯ä»¥ä½¿ç¨ åè§£æ¡ä»¶è¡¨è¾¾å¼(decompose conditional) ãè³äºå¾ªç¯ï¼åºè¯¥ä½¿ç¨ æç¼å½æ°(extract method) å°å¾ªç¯åå¶åçä»£ç æç¼å°ç¬ç«å½æ°ä¸­ã\n\n\n# 4.3. æ¶ç\n\n * å¨ææç±»åçé¢åå¯¹è±¡ä»£ç ä¸­ï¼å½æ°æ¯è¾ç­å°ç²¾æçç±»å¾å¾çå½å¨æè¾é¿ãä¸ä¸ªå½æ°è¶é¿ï¼å°±è¶ä¸å®¹æçè§£åç»´æ¤ã\n * æ­¤å¤ï¼è¿é¿å½æ°ä¸­å¾å¾å«æé¾ä»¥åç°çéå¤ä»£ç ã\n\n\n\n\n# 4.4. æ§è½\n\næ¯å¦åè®¸å¤äººè¯´çé£æ ·ï¼å¢å å½æ°çæ°éä¼å½±åæ§è½ï¼å¨å ä¹ç»å¤§å¤æ°æåµä¸ï¼è¿ç§å½±åæ¯å¯ä»¥å¿½ç¥ä¸è®¡ï¼æä»¥ä¸ç¨æå¿ã æ­¤å¤ï¼ç°å¨æäºæ¸æ°åæè¯»çä»£ç ï¼å¨éè¦çæ¶åï¼ä½ å°æ´å®¹ææ¾å°çæ­£ææçå½æ°æ¥éç»ä»£ç åæé«æ§è½ã\n\n\n# 4.5. éææ¹æ³è¯´æ\n\n# 4.5.1. æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# 4.5.2. ä»¥æ¥è¯¢åä»£ä¸´æ¶åé(replace temp with query)\n\né®é¢\n\nå°è¡¨è¾¾å¼çç»ææ¾å¨å±é¨åéä¸­ï¼ç¶åå¨ä»£ç ä¸­ä½¿ç¨ã\n\ndouble calculatetotal() {\n  double baseprice = quantity * itemprice;\n  if (baseprice > 1000) {\n    return baseprice * 0.95;\n  }\n  else {\n    return baseprice * 0.98;\n  }\n}\n\n\nè§£å³\n\nå°æ´ä¸ªè¡¨è¾¾å¼ç§»å¨å°ä¸ä¸ªç¬ç«çå½æ°ä¸­å¹¶è¿åç»æãä½¿ç¨æ¥è¯¢å½æ°æ¥æ¿ä»£ä½¿ç¨åéãå¦æéè¦ï¼å¯ä»¥å¨å¶ä»å½æ°ä¸­åå¹¶æ°å½æ°ã\n\ndouble calculatetotal() {\n  if (baseprice() > 1000) {\n    return baseprice() * 0.95;\n  }\n  else {\n    return baseprice() * 0.98;\n  }\n}\ndouble baseprice() {\n  return quantity * itemprice;\n}\n\n\n# 4.5.3. å¼å¥åæ°å¯¹è±¡(introduce parameter object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n# 4.5.4. ä¿æå¯¹è±¡å®æ´(preserve whole object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daystemprange.getlow();\nint high = daystemprange.gethigh();\nboolean withinplan = plan.withinrange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinplan = plan.withinrange(daystemprange);\n\n\n# 4.5.5. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object)\n\né®é¢\n\nä½ æä¸ä¸ªè¿é¿å½æ°ï¼å®çå±é¨åéäº¤ç»å¨ä¸èµ·ï¼ä»¥è´äºä½ æ æ³åºç¨æç¼å½æ°(extract method) ã\n\nclass order {\n  //...\n  public double price() {\n    double primarybaseprice;\n    double secondarybaseprice;\n    double tertiarybaseprice;\n    // long computation.\n    //...\n  }\n}\n\n\nè§£å³\n\nå°å½æ°ç§»å°ä¸ä¸ªç¬ç«çç±»ä¸­ï¼ä½¿å¾å±é¨åéæäºè¿ä¸ªç±»çå­æ®µãç¶åï¼ä½ å¯ä»¥å°å½æ°åå²æè¿ä¸ªç±»ä¸­çå¤ä¸ªå½æ°ã\n\nclass order {\n  //...\n  public double price() {\n    return new pricecalculator(this).compute();\n  }\n}\n\nclass pricecalculator {\n  private double primarybaseprice;\n  private double secondarybaseprice;\n  private double tertiarybaseprice;\n\n  public pricecalculator(order order) {\n    // copy relevant information from order object.\n    //...\n  }\n\n  public double compute() {\n    // long computation.\n    //...\n  }\n}\n\n\n# 4.5.6. åè§£æ¡ä»¶è¡¨è¾¾å¼(decompose conditional)\n\né®é¢\n\nä½ æå¤æçæ¡ä»¶è¡¨è¾¾å¼ã\n\nif (date.before(summer_start) || date.after(summer_end)) {\n  charge = quantity * winterrate + winterservicecharge;\n}\nelse {\n  charge = quantity * summerrate;\n}\n\n\nè§£å³\n\næ ¹æ®æ¡ä»¶åæ¯å°æ´ä¸ªæ¡ä»¶è¡¨è¾¾å¼åè§£æå ä¸ªå½æ°ã\n\nif (notsummer(date)) {\n  charge = wintercharge(quantity);\n}\nelse {\n  charge = summercharge(quantity);\n}\n\n\n\n# 5. è¿é¿åæ°å\n\n> è¿é¿åæ°å(long parameter list)\n> \n> ä¸ä¸ªå½æ°æè¶è¿ 3ã4 ä¸ªå¥åã\n\n\n\n\n# 5.1. é®é¢åå \n\nè¿é¿åæ°åå¯è½æ¯å°å¤ä¸ªç®æ³å¹¶å°ä¸ä¸ªå½æ°ä¸­æ¶åççãå½æ°ä¸­çå¥åå¯ä»¥ç¨æ¥æ§å¶æç»éç¨åªä¸ªç®æ³å»æ§è¡ã\n\nè¿é¿åæ°åä¹å¯è½æ¯è§£è¦ç±»ä¹é´ä¾èµå³ç³»æ¶çå¯äº§åãä¾å¦ï¼ç¨äºåå»ºå½æ°ä¸­æéçç¹å®å¯¹è±¡çä»£ç å·²ä»å½æ°ç§»å¨å°è°ç¨å½æ°çä»£ç å¤ï¼ä½åå»ºçå¯¹è±¡æ¯ä½ä¸ºåæ°ä¼ éå°å½æ°ä¸­ãå æ­¤ï¼åå§ç±»ä¸åç¥éå¯¹è±¡ä¹é´çå³ç³»ï¼å¹¶ä¸ä¾èµæ§ä¹å·²ç»åå°ãä½æ¯å¦æåå»ºçè¿äºå¯¹è±¡ï¼æ¯ä¸ä¸ªé½å°éè¦å®èªå·±çåæ°ï¼è¿æå³çè¿é¿åæ°åã\n\nå¤ªé¿çåæ°åé¾ä»¥çè§£ï¼å¤ªå¤åæ°ä¼é æååä¸ä¸è´ãä¸æä½¿ç¨ï¼èä¸ä¸æ¦éè¦æ´å¤æ°æ®ï¼å°±ä¸å¾ä¸ä¿®æ¹å®ã\n\n\n# 5.2. è§£å³æ¹æ¡\n\n\n\n * å¦æåå·²æçå¯¹è±¡ååºä¸æ¡è¯·æ±å°±å¯ä»¥åä»£ä¸ä¸ªåæ°ï¼é£ä¹ä½ åºè¯¥ä½¿ç¨ ä»¥å½æ°åä»£åæ°(replace parameter with methods) ãå¨è¿éï¼ï¼âå·²æçå¯¹è±¡âå¯è½æ¯å½æ°æå±ç±»éçä¸ä¸ªå­æ®µï¼ä¹å¯è½æ¯å¦ä¸ä¸ªåæ°ã\n * ä½ è¿å¯ä»¥è¿ç¨ ä¿æå¯¹è±¡å®æ´(preserve whole object) å°æ¥èªåä¸å¯¹è±¡çä¸å æ°æ®æ¶éèµ·æ¥ï¼å¹¶ä»¥è¯¥å¯¹è±¡æ¿æ¢å®ä»¬ã\n * å¦ææäºæ°æ®ç¼ºä¹åççå¯¹è±¡å½å±ï¼å¯ä½¿ç¨ å¼å¥åæ°å¯¹è±¡(introduce parameter object) ä¸ºå®ä»¬å¶é åºä¸ä¸ªâåæ°å¯¹è±¡âã\n\n\n# 5.3. æ¶ç\n\n * æ´æè¯»ï¼æ´ç®ç­çä»£ç ã\n * éæå¯è½ä¼æ´é²åºä¹åæªæ³¨æå°çéå¤ä»£ç ã\n\n\n# 5.4. ä½æ¶å¿½ç¥\n\n * è¿éæä¸ä¸ªéè¦çä¾å¤ï¼ææ¶åä½ ææ¾ä¸æ³é æ"è¢«è°ç¨å¯¹è±¡"ä¸"è¾å¤§å¯¹è±¡"é´çæç§ä¾èµå³ç³»ãè¿æ¶åå°æ°æ®ä»å¯¹è±¡ä¸­æè§£åºæ¥åç¬ä½ä¸ºåæ°ï¼ä¹å¾åæçãä½æ¯è¯·æ³¨æå¶æå¼åçä»£ä»·ãå¦æåæ°åå¤ªé¿æååå¤ªé¢ç¹ï¼å°±éè¦éæ°èèèªå·±çä¾èµç»æäºã\n\n\n# 5.5. éææ¹æ³è¯´æ\n\n# 5.5.1. ä»¥å½æ°åä»£åæ°(replace parameter with methods)\n\né®é¢\n\nå¯¹è±¡è°ç¨æä¸ªå½æ°ï¼å¹¶å°æå¾ç»æä½ä¸ºåæ°ï¼ä¼ éç»å¦ä¸ä¸ªå½æ°ãèæ¥åè¯¥åæ°çå½æ°æ¬èº«ä¹è½å¤è°ç¨åä¸ä¸ªå½æ°ã\n\nint baseprice = quantity * itemprice;\ndouble seasondiscount = this.getseasonaldiscount();\ndouble fees = this.getfees();\ndouble finalprice = discountedprice(baseprice, seasondiscount, fees);\n\n\nè§£å³\n\nè®©åæ°æ¥åèå»é¤è¯¥é¡¹åæ°ï¼å¹¶ç´æ¥è°ç¨åä¸ä¸ªå½æ°ã\n\nint baseprice = quantity * itemprice;\ndouble finalprice = discountedprice(baseprice);\n\n\n# 5.5.2. ä¿æå¯¹è±¡å®æ´(preserve whole object)\n\né®é¢\n\nä½ ä»æä¸ªå¯¹è±¡ä¸­ååºè¥å¹²å¼ï¼å°å®ä»¬ä½ä¸ºæä¸æ¬¡å½æ°è°ç¨æ¶çåæ°ã\n\nint low = daystemprange.getlow();\nint high = daystemprange.gethigh();\nboolean withinplan = plan.withinrange(low, high);\n\n\nè§£å³\n\næ¹ä¸ºä¼ éæ´ä¸ªå¯¹è±¡ã\n\nboolean withinplan = plan.withinrange(daystemprange);\n\n\n# 5.5.3. å¼å¥åæ°å¯¹è±¡(introduce parameter object)\n\né®é¢\n\næäºåæ°æ»æ¯å¾èªç¶å°åæ¶åºç°ã\n\n\n\nè§£å³\n\nä»¥ä¸ä¸ªå¯¹è±¡æ¥åä»£è¿äºåæ°ã\n\n\n\n\n# 6. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 7. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡",frontmatter:{title:"ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/9ae679/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/03.%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html",relativePath:"03.è®¾è®¡/03.éæ/03.ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡.md",key:"v-ce0e8fd4",path:"/pages/9ae679/",headers:[{level:2,title:"1. Switch å£°æ",slug:"_1-switch-å£°æ",normalizedTitle:"1. switch å£°æ",charIndex:134},{level:3,title:"1.1. é®é¢åå ",slug:"_1-1-é®é¢åå ",normalizedTitle:"1.1. é®é¢åå ",charIndex:218},{level:3,title:"1.2. è§£å³æ¹æ³",slug:"_1-2-è§£å³æ¹æ³",normalizedTitle:"1.2. è§£å³æ¹æ³",charIndex:430},{level:3,title:"1.3. æ¶ç",slug:"_1-3-æ¶ç",normalizedTitle:"1.3. æ¶ç",charIndex:960},{level:3,title:"1.4. ä½æ¶å¿½ç¥",slug:"_1-4-ä½æ¶å¿½ç¥",normalizedTitle:"1.4. ä½æ¶å¿½ç¥",charIndex:987},{level:3,title:"1.5. éææ¹æ³è¯´æ",slug:"_1-5-éææ¹æ³è¯´æ",normalizedTitle:"1.5. éææ¹æ³è¯´æ",charIndex:1125},{level:4,title:"1.5.1. æç¼å½æ°(Extract Method)",slug:"_1-5-1-æç¼å½æ°-extract-method",normalizedTitle:"1.5.1. æç¼å½æ°(extract method)",charIndex:1140},{level:4,title:"1.5.2. æ¬ç§»å½æ°(Move Method)",slug:"_1-5-2-æ¬ç§»å½æ°-move-method",normalizedTitle:"1.5.2. æ¬ç§»å½æ°(move method)",charIndex:1583},{level:4,title:"1.5.3. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass)",slug:"_1-5-3-ä»¥å­ç±»åä»£ç±»åç -replace-type-code-with-subclass",normalizedTitle:"1.5.3. ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass)",charIndex:1720},{level:4,title:"1.5.4. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy)",slug:"_1-5-4-ä»¥ç¶æ-ç­ç¥æ¨¡å¼åä»£ç±»åç -replace-type-code-with-state-strategy",normalizedTitle:"1.5.4. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy)",charIndex:1820},{level:4,title:"1.5.5. ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)",slug:"_1-5-5-ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼-replace-conditional-with-polymorphism",normalizedTitle:"1.5.5. ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(replace conditional with polymorphism)",charIndex:1939},{level:4,title:"1.5.6. ä»¥æç¡®å½æ°åä»£åæ°(Replace Parameter with Explicit Methods)",slug:"_1-5-6-ä»¥æç¡®å½æ°åä»£åæ°-replace-parameter-with-explicit-methods",normalizedTitle:"1.5.6. ä»¥æç¡®å½æ°åä»£åæ°(replace parameter with explicit methods)",charIndex:2878},{level:4,title:"1.5.7. å¼å¥ Null å¯¹è±¡(Introduce Null Object)",slug:"_1-5-7-å¼å¥-null-å¯¹è±¡-introduce-null-object",normalizedTitle:"1.5.7. å¼å¥ null å¯¹è±¡(introduce null object)",charIndex:3296},{level:2,title:"2. ä¸´æ¶å­æ®µ",slug:"_2-ä¸´æ¶å­æ®µ",normalizedTitle:"2. ä¸´æ¶å­æ®µ",charIndex:3808},{level:3,title:"2.1. é®é¢åå ",slug:"_2-1-é®é¢åå ",normalizedTitle:"2.1. é®é¢åå ",charIndex:3877},{level:3,title:"2.2. è§£å³æ¹æ³",slug:"_2-2-è§£å³æ¹æ³",normalizedTitle:"2.2. è§£å³æ¹æ³",charIndex:4110},{level:3,title:"2.3. æ¶ç",slug:"_2-3-æ¶ç",normalizedTitle:"2.3. æ¶ç",charIndex:4319},{level:3,title:"2.4. éææ¹æ³è¯´æ",slug:"_2-4-éææ¹æ³è¯´æ",normalizedTitle:"2.4. éææ¹æ³è¯´æ",charIndex:4351},{level:4,title:"2.4.1. æç¼ç±»(Extract Class)",slug:"_2-4-1-æç¼ç±»-extract-class",normalizedTitle:"2.4.1. æç¼ç±»(extract class)",charIndex:4366},{level:4,title:"2.4.2. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object)",slug:"_2-4-2-ä»¥å½æ°å¯¹è±¡åä»£å½æ°-replace-method-with-method-object",normalizedTitle:"2.4.2. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object)",charIndex:4447},{level:4,title:"2.4.3. å¼å¥ Null å¯¹è±¡(Introduce Null Object)",slug:"_2-4-3-å¼å¥-null-å¯¹è±¡-introduce-null-object",normalizedTitle:"2.4.3. å¼å¥ null å¯¹è±¡(introduce null object)",charIndex:5210},{level:2,title:"3. å¼æ²åå·¥çç±»",slug:"_3-å¼æ²åå·¥çç±»",normalizedTitle:"3. å¼æ²åå·¥çç±»",charIndex:5722},{level:3,title:"3.1. é®é¢åå ",slug:"_3-1-é®é¢åå ",normalizedTitle:"3.1. é®é¢åå ",charIndex:5822},{level:3,title:"3.2. è§£å³æ¹æ³",slug:"_3-2-è§£å³æ¹æ³",normalizedTitle:"3.2. è§£å³æ¹æ³",charIndex:5876},{level:3,title:"3.3. æ¶ç",slug:"_3-3-æ¶ç",normalizedTitle:"3.3. æ¶ç",charIndex:6147},{level:3,title:"3.4. ä½æ¶å¿½ç¥",slug:"_3-4-ä½æ¶å¿½ç¥",normalizedTitle:"3.4. ä½æ¶å¿½ç¥",charIndex:6216},{level:3,title:"3.5. éææ¹æ³è¯´æ",slug:"_3-5-éææ¹æ³è¯´æ",normalizedTitle:"3.5. éææ¹æ³è¯´æ",charIndex:6286},{level:4,title:"3.5.1. å½æ°æ¹å(Rename Method)",slug:"_3-5-1-å½æ°æ¹å-rename-method",normalizedTitle:"3.5.1. å½æ°æ¹å(rename method)",charIndex:6301},{level:4,title:"3.5.2. æ¬ç§»å½æ°(Move Method)",slug:"_3-5-2-æ¬ç§»å½æ°-move-method",normalizedTitle:"3.5.2. æ¬ç§»å½æ°(move method)",charIndex:6464},{level:4,title:"3.5.3. æ·»å åæ°(Add Parameter)",slug:"_3-5-3-æ·»å åæ°-add-parameter",normalizedTitle:"3.5.3. æ·»å åæ°(add parameter)",charIndex:6601},{level:4,title:"3.5.4. ä»¤å½æ°æºå¸¦åæ°(Parameterize Method)",slug:"_3-5-4-ä»¤å½æ°æºå¸¦åæ°-parameterize-method",normalizedTitle:"3.5.4. ä»¤å½æ°æºå¸¦åæ°(parameterize method)",charIndex:6797},{level:4,title:"3.5.5. æç¼è¶ç±»(Extract Superclass)",slug:"_3-5-5-æç¼è¶ç±»-extract-superclass",normalizedTitle:"3.5.5. æç¼è¶ç±»(extract superclass)",charIndex:6897},{level:2,title:"4. è¢«æç»çé¦èµ ",slug:"_4-è¢«æç»çé¦èµ ",normalizedTitle:"4. è¢«æç»çé¦èµ ",charIndex:6980},{level:3,title:"4.1. é®é¢åå ",slug:"_4-1-é®é¢åå ",normalizedTitle:"4.1. é®é¢åå ",charIndex:7062},{level:3,title:"4.2. è§£å³æ¹æ³",slug:"_4-2-è§£å³æ¹æ³",normalizedTitle:"4.2. è§£å³æ¹æ³",charIndex:7116},{level:3,title:"4.3. æ¶ç",slug:"_4-3-æ¶ç",normalizedTitle:"4.3. æ¶ç",charIndex:7319},{level:3,title:"4.4. éææ¹æ³è¯´æ",slug:"_4-4-éææ¹æ³è¯´æ",normalizedTitle:"4.4. éææ¹æ³è¯´æ",charIndex:7351},{level:4,title:"4.4.1. ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation)",slug:"_4-4-1-ä»¥å§æåä»£ç»§æ¿-replace-inheritance-with-delegation",normalizedTitle:"4.4.1. ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation)",charIndex:7366},{level:4,title:"4.4.2. æç¼è¶ç±»(Extract Superclass)",slug:"_4-4-2-æç¼è¶ç±»-extract-superclass",normalizedTitle:"4.4.2. æç¼è¶ç±»(extract superclass)",charIndex:7530},{level:2,title:"5. æ©å±éè¯»",slug:"_5-æ©å±éè¯»",normalizedTitle:"5. æ©å±éè¯»",charIndex:7613},{level:2,title:"6. åèèµæ",slug:"_6-åèèµæ",normalizedTitle:"6. åèèµæ",charIndex:7710}],headersStr:"1. Switch å£°æ 1.1. é®é¢åå  1.2. è§£å³æ¹æ³ 1.3. æ¶ç 1.4. ä½æ¶å¿½ç¥ 1.5. éææ¹æ³è¯´æ 1.5.1. æç¼å½æ°(Extract Method) 1.5.2. æ¬ç§»å½æ°(Move Method) 1.5.3. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass) 1.5.4. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy) 1.5.5. ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism) 1.5.6. ä»¥æç¡®å½æ°åä»£åæ°(Replace Parameter with Explicit Methods) 1.5.7. å¼å¥ Null å¯¹è±¡(Introduce Null Object) 2. ä¸´æ¶å­æ®µ 2.1. é®é¢åå  2.2. è§£å³æ¹æ³ 2.3. æ¶ç 2.4. éææ¹æ³è¯´æ 2.4.1. æç¼ç±»(Extract Class) 2.4.2. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object) 2.4.3. å¼å¥ Null å¯¹è±¡(Introduce Null Object) 3. å¼æ²åå·¥çç±» 3.1. é®é¢åå  3.2. è§£å³æ¹æ³ 3.3. æ¶ç 3.4. ä½æ¶å¿½ç¥ 3.5. éææ¹æ³è¯´æ 3.5.1. å½æ°æ¹å(Rename Method) 3.5.2. æ¬ç§»å½æ°(Move Method) 3.5.3. æ·»å åæ°(Add Parameter) 3.5.4. ä»¤å½æ°æºå¸¦åæ°(Parameterize Method) 3.5.5. æç¼è¶ç±»(Extract Superclass) 4. è¢«æç»çé¦èµ  4.1. é®é¢åå  4.2. è§£å³æ¹æ³ 4.3. æ¶ç 4.4. éææ¹æ³è¯´æ 4.4.1. ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation) 4.4.2. æç¼è¶ç±»(Extract Superclass) 5. æ©å±éè¯» 6. åèèµæ",content:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/oo-abusers\n> \n> æ»¥ç¨é¢åå¯¹è±¡(Object-Orientation Abusers)è¿ç»åå³éæå³çï¼ä»£ç é¨åæå®å¨å°è¿èäºé¢åå¯¹è±¡ç¼ç¨ååã\n\n\n# 1. Switch å£°æ\n\n> Switch å£°æ(Switch Statements)\n> \n> ä½ æä¸ä¸ªå¤æç switch è¯­å¥æ if åºåè¯­å¥ã\n\n\n\n\n# 1.1. é®é¢åå \n\né¢åå¯¹è±¡ç¨åºçä¸ä¸ªæææ¾ç¹å¾å°±æ¯ï¼å°ç¨ switch å case è¯­å¥ãä»æ¬è´¨ä¸è¯´ï¼switch è¯­å¥çé®é¢å¨äºéå¤ï¼if åºåä¹åæ ·å¦æ­¤ï¼ãä½ å¸¸ä¼åç° switch è¯­å¥æ£å¸äºä¸åå°ç¹ãå¦æè¦ä¸ºå®æ·»å ä¸ä¸ªæ°ç case å­å¥ï¼å°±å¿é¡»æ¾å°ææ switch è¯­å¥å¹¶ä¿®æ¹å®ä»¬ãé¢åå¯¹è±¡ä¸­çå¤ææ¦å¿µå¯ä¸ºæ­¤å¸¦æ¥ä¼éçè§£å³åæ³ã\n\nå¤§å¤æ°æ¶åï¼ä¸çå° switch è¯­å¥ï¼å°±åºè¯¥èèä»¥å¤ææ¥æ¿æ¢å®ã\n\n\n# 1.2. è§£å³æ¹æ³\n\n * é®é¢æ¯å¤æè¯¥åºç°å¨åªï¼switch è¯­å¥å¸¸å¸¸æ ¹æ®ç±»åç è¿è¡éæ©ï¼ä½ è¦çæ¯âä¸è¯¥ç±»åç ç¸å³çå½æ°æç±»âï¼æä»¥åºè¯¥è¿ç¨ æç¼å½æ°(Extract Method) å° switch è¯­å¥æç¼å°ä¸ä¸ªç¬ç«å½æ°ä¸­ï¼åä»¥ æ¬ç§»å½æ°(Move Method) å°å®æ¬ç§»å°éè¦å¤ææ§çé£ä¸ªç±»éã\n * å¦æä½ ç switch æ¯åºäºç±»åç æ¥è¯å«åæ¯ï¼è¿æ¶å¯ä»¥è¿ç¨ ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass) æ ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy) ã\n * ä¸æ¦å®æè¿æ ·çç»§æ¿ç»æåï¼å°±å¯ä»¥è¿ç¨ ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism) äºã\n * å¦ææ¡ä»¶åæ¯å¹¶ä¸å¤å¹¶ä¸å®ä»¬ä½¿ç¨ä¸ååæ°è°ç¨ç¸åçå½æ°ï¼å¤æå°±æ²¡å¿è¦äºãå¨è¿ç§æåµä¸ï¼ä½ å¯ä»¥è¿ç¨ ä»¥æç¡®å½æ°åä»£åæ°(Replace Parameter with Explicit Methods) ã\n * å¦æä½ çéæ©æ¡ä»¶ä¹ä¸æ¯ nullï¼å¯ä»¥è¿ç¨ å¼å¥ Null å¯¹è±¡(Introduce Null Object) ã\n\n\n# 1.3. æ¶ç\n\n * æåä»£ç ç»ç»æ§ã\n\n\n\n\n# 1.4. ä½æ¶å¿½ç¥\n\n * å¦æä¸ä¸ª switch æä½åªæ¯æ§è¡ç®åçè¡ä¸ºï¼å°±æ²¡æéæçå¿è¦äºã\n * switch å¸¸è¢«å·¥åè®¾è®¡æ¨¡å¼æï¼å·¥åæ¹æ³æ¨¡å¼(Factory Method)åæ½è±¡å·¥åæ¨¡å¼(Abstract Factory)ï¼æä½¿ç¨ï¼è¿ç§æåµä¸ä¹æ²¡å¿è¦éæã\n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# 1.5.2. æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 1.5.3. ä»¥å­ç±»åä»£ç±»åç (Replace Type Code with Subclass)\n\né®é¢\n\nä½ æä¸ä¸ªä¸å¯åçç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥å­ç±»åä»£è¿ä¸ªç±»åç ã\n\n\n\n# 1.5.4. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (Replace Type Code with State/Strategy)\n\né®é¢\n\nä½ æä¸ä¸ªç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºï¼ä½ä½ æ æ³éè¿ç»§æ¿æ¶é¤å®ã\n\n\n\nè§£å³\n\nä»¥ç¶æå¯¹è±¡åä»£ç±»åç ã\n\n\n\n# 1.5.5. ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)\n\né®é¢\n\nä½ æä¸æä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼å®æ ¹æ®å¯¹è±¡ç±»åçä¸åèéæ©ä¸åçè¡ä¸ºã\n\nclass Bird {\n  //...\n  double getSpeed() {\n    switch (type) {\n      case EUROPEAN:\n        return getBaseSpeed();\n      case AFRICAN:\n        return getBaseSpeed() - getLoadFactor() * numberOfCoconuts;\n      case NORWEGIAN_BLUE:\n        return (isNailed) ? 0 : getBaseSpeed(voltage);\n    }\n    throw new RuntimeException("Should be unreachable");\n  }\n}\n\n\nè§£å³\n\nå°è¿ä¸ªæ¡ä»¶è¡¨è¾¾å¼çæ¯ä¸ªåæ¯æ¾è¿ä¸ä¸ªå­ç±»åçè¦åå½æ°ä¸­ï¼ç¶åå°åå§å½æ°å£°æä¸ºæ½è±¡å½æ°ã\n\nabstract class Bird {\n  //...\n  abstract double getSpeed();\n}\n\nclass European extends Bird {\n  double getSpeed() {\n    return getBaseSpeed();\n  }\n}\nclass African extends Bird {\n  double getSpeed() {\n    return getBaseSpeed() - getLoadFactor() * numberOfCoconuts;\n  }\n}\nclass NorwegianBlue extends Bird {\n  double getSpeed() {\n    return (isNailed) ? 0 : getBaseSpeed(voltage);\n  }\n}\n\n// Somewhere in client code\nspeed = bird.getSpeed();\n\n\n# 1.5.6. ä»¥æç¡®å½æ°åä»£åæ°(Replace Parameter with Explicit Methods)\n\né®é¢\n\nä½ æä¸ä¸ªå½æ°ï¼å¶ä¸­å®å¨åå³äºåæ°å¼èéåä¸åçè¡ä¸ºã\n\nvoid setValue(String name, int value) {\n  if (name.equals("height")) {\n    height = value;\n    return;\n  }\n  if (name.equals("width")) {\n    width = value;\n    return;\n  }\n  Assert.shouldNeverReachHere();\n}\n\n\nè§£å³\n\néå¯¹è¯¥åæ°çæ¯ä¸ä¸ªå¯è½å¼ï¼å»ºç«ä¸ä¸ªç¬ç«å½æ°ã\n\nvoid setHeight(int arg) {\n  height = arg;\n}\nvoid setWidth(int arg) {\n  width = arg;\n}\n\n\n# 1.5.7. å¼å¥ Null å¯¹è±¡(Introduce Null Object)\n\né®é¢\n\nä½ éè¦åä¸æ£æ¥æå¯¹è±¡æ¯å¦ä¸º nullã\n\nif (customer == null) {\n  plan = BillingPlan.basic();\n}\nelse {\n  plan = customer.getPlan();\n}\n\n\nè§£å³\n\nå° null å¼æ¿æ¢ä¸º null å¯¹è±¡ã\n\nclass NullCustomer extends Customer {\n  Plan getPlan() {\n    return new NullPlan();\n  }\n  // Some other NULL functionality.\n}\n\n// Replace null values with Null-object.\ncustomer = (order.customer != null) ? order.customer : new NullCustomer();\n\n// Use Null-object as if it\'s normal subclass.\nplan = customer.getPlan();\n\n\n\n# 2. ä¸´æ¶å­æ®µ\n\n> ä¸´æ¶å­æ®µ(Temporary Field)çå¼åªå¨ç¹å®ç¯å¢ä¸ææä¹ï¼ç¦»å¼è¿ä¸ªç¯å¢ï¼å®ä»¬å°±ä»ä¹ä¹ä¸æ¯äºã\n\n\n\n\n# 2.1. é®é¢åå \n\nææ¶ä½ ä¼çå°è¿æ ·çå¯¹è±¡ï¼å¶åæä¸ªå®ä¾åéä»ä¸ºæç§ç¹å®æåµèè®¾ãè¿æ ·çä»£ç è®©äººä¸æçè§£ï¼å ä¸ºä½ éå¸¸è®¤ä¸ºå¯¹è±¡å¨æææ¶åé½éè¦å®çææåéãå¨åéæªè¢«ä½¿ç¨çæåµä¸çæµå½åè®¾ç½®ç®çï¼ä¼è®©ä½ åç¯ã éå¸¸ï¼ä¸´æ¶å­æ®µæ¯å¨æä¸ç®æ³éè¦å¤§éè¾å¥æ¶èåå»ºãå æ­¤ï¼ä¸ºäºé¿åå½æ°æè¿å¤åæ°ï¼ç¨åºåå³å®å¨ç±»ä¸­åå»ºè¿äºæ°æ®çä¸´æ¶å­æ®µãè¿äºä¸´æ¶å­æ®µä»ä»å¨ç®æ³ä¸­ä½¿ç¨ï¼å¶ä»æ¶åå´æ¯«æ ç¨å¤ã è¿ç§ä»£ç ä¸å¥½çè§£ãä½ æææ¥çå¯¹è±¡å­æ®µçæ°æ®ï¼ä½æ¯åºäºæç§åå ï¼å®ä»¬æ»æ¯ä¸ºç©ºã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * å¯ä»¥éè¿ æç¼ç±»(Extract Class) å°ä¸´æ¶å­æ®µåæä½å®ä»¬çææä»£ç æç¼å°ä¸ä¸ªåç¬çç±»ä¸­ãæ­¤å¤ï¼ä½ å¯ä»¥è¿ç¨ ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object) æ¥å®ç°åæ ·çç®çã\n * å¼å¥ Null å¯¹è±¡(Introduce Null Object) å¨âåéä¸åæ³âçæåµä¸åå»ºä¸ä¸ª null å¯¹è±¡ï¼ä»èé¿åååºæ¡ä»¶è¡¨è¾¾å¼ã\n\n\n\n\n# 2.3. æ¶ç\n\n * æ´å¥½çä»£ç æ¸æ°åº¦åç»ç»æ§ã\n\n\n\n\n# 2.4. éææ¹æ³è¯´æ\n\n# 2.4.1. æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 2.4.2. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(Replace Method with Method Object)\n\né®é¢\n\nä½ æä¸ä¸ªè¿é¿å½æ°ï¼å®çå±é¨åéäº¤ç»å¨ä¸èµ·ï¼ä»¥è´äºä½ æ æ³åºç¨æç¼å½æ°(Extract Method) ã\n\nclass Order {\n  //...\n  public double price() {\n    double primaryBasePrice;\n    double secondaryBasePrice;\n    double tertiaryBasePrice;\n    // long computation.\n    //...\n  }\n}\n\n\nè§£å³\n\nå°å½æ°ç§»å°ä¸ä¸ªç¬ç«çç±»ä¸­ï¼ä½¿å¾å±é¨åéæäºè¿ä¸ªç±»çå­æ®µãç¶åï¼ä½ å¯ä»¥å°å½æ°åå²æè¿ä¸ªç±»ä¸­çå¤ä¸ªå½æ°ã\n\nclass Order {\n  //...\n  public double price() {\n    return new PriceCalculator(this).compute();\n  }\n}\n\nclass PriceCalculator {\n  private double primaryBasePrice;\n  private double secondaryBasePrice;\n  private double tertiaryBasePrice;\n\n  public PriceCalculator(Order order) {\n    // copy relevant information from order object.\n    //...\n  }\n\n  public double compute() {\n    // long computation.\n    //...\n  }\n}\n\n\n# 2.4.3. å¼å¥ Null å¯¹è±¡(Introduce Null Object)\n\né®é¢\n\nä½ éè¦åä¸æ£æ¥æå¯¹è±¡æ¯å¦ä¸º nullã\n\nif (customer == null) {\n  plan = BillingPlan.basic();\n}\nelse {\n  plan = customer.getPlan();\n}\n\n\nè§£å³\n\nå° null å¼æ¿æ¢ä¸º null å¯¹è±¡ã\n\nclass NullCustomer extends Customer {\n  Plan getPlan() {\n    return new NullPlan();\n  }\n  // Some other NULL functionality.\n}\n\n// Replace null values with Null-object.\ncustomer = (order.customer != null) ? order.customer : new NullCustomer();\n\n// Use Null-object as if it\'s normal subclass.\nplan = customer.getPlan();\n\n\n\n# 3. å¼æ²åå·¥çç±»\n\n> å¼æ²åå·¥çç±»(Alternative Classes with Different Interfaces)\n> \n> ä¸¤ä¸ªç±»ä¸­æçä¸åçå½æ°ï¼å´å¨åçåä¸ä»¶äºã\n\n\n\n\n# 3.1. é®é¢åå \n\nè¿ç§æåµå¾å¾æ¯å ä¸ºï¼åå»ºè¿ä¸ªç±»çç¨åºåå¹¶ä¸ç¥éå·²ç»æå®ç°è¿ä¸ªåè½çç±»å­å¨äºã\n\n\n# 3.2. è§£å³æ¹æ³\n\n * å¦æä¸¤ä¸ªå½æ°ååä¸ä»¶äºï¼å´æçä¸åçç­¾åï¼è¯·è¿ç¨ å½æ°æ¹å(Rename Method) æ ¹æ®å®ä»¬çç¨ééæ°å½åã\n * è¿ç¨ æ¬ç§»å½æ°(Move Method) ã æ·»å åæ°(Add Parameter) å ä»¤å½æ°æºå¸¦åæ°(Parameterize Method) æ¥ä½¿å¾æ¹æ³çåç§°åå®ç°ä¸è´ã\n * å¦æä¸¤ä¸ªç±»ä»æé¨ååè½æ¯éå¤çï¼å°è¯è¿ç¨ æç¼è¶ç±»(Extract Superclass) ãè¿ç§æåµä¸ï¼å·²å­å¨çç±»å°±æäºè¶ç±»ã\n * å½æç»éæ©å¹¶è¿ç¨æç§æ¹æ³æ¥éæåï¼ä¹è®¸ä½ å°±è½å é¤å¶ä¸­ä¸ä¸ªç±»äºã\n\n\n# 3.3. æ¶ç\n\n * æ¶é¤äºä¸å¿è¦çéå¤ä»£ç ï¼ä¸ºä»£ç ç¦èº«äºã\n * ä»£ç æ´æè¯»ï¼ä¸åéè¦çæµä¸ºä»ä¹è¦æä¸¤ä¸ªåè½ç¸åçç±»ï¼ã\n\n\n\n\n# 3.4. ä½æ¶å¿½ç¥\n\n * ææ¶åå¹¶ç±»æ¯ä¸å¯è½çï¼æèæ¯å¦æ­¤å°é¾ä»¥è³äºæ²¡ææä¹ãä¾å¦ï¼ä¸¤ä¸ªåè½ç¸ä¼¼çç±»å­å¨äºä¸åç lib åºä¸­ã\n\n\n# 3.5. éææ¹æ³è¯´æ\n\n# 3.5.1. å½æ°æ¹å(Rename Method)\n\né®é¢\n\nå½æ°çåç§°æªè½æ°å½çæ­ç¤ºå½æ°çç¨éã\n\nclass Person {\n  public String getsnm();\n}\n\n\nè§£å³\n\nä¿®æ¹å½æ°åã\n\nclass Person {\n  public String getSecondName();\n}\n\n\n# 3.5.2. æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.5.3. æ·»å åæ°(Add Parameter)\n\né®é¢ æä¸ªå½æ°éè¦ä»è°ç¨ç«¯å¾å°æ´å¤ä¿¡æ¯ã\n\nclass Customer {\n  public Contact getContact();\n}\n\n\nè§£å³ ä¸ºæ­¤å½æ°æ·»å ä¸ä¸ªå¯¹è±¡å½æ°ï¼è®©æ¹å¯¹è±¡å¸¦è¿å½æ°æéä¿¡æ¯ã\n\nclass Customer {\n  public Contact getContact(Date date);\n}\n\n\n# 3.5.4. ä»¤å½æ°æºå¸¦åæ°(Parameterize Method)\n\né®é¢\n\nè¥å¹²å½æ°åäºç±»ä¼¼çå·¥ä½ï¼ä½å¨å½æ°æ¬ä½ä¸­å´åå«äºä¸åçå¼ã\n\nè§£å³\n\nå»ºç«åä¸å½æ°ï¼ä»¥åæ°è¡¨è¾¾åªäºä¸åçå¼ã\n\n\n\n# 3.5.5. æç¼è¶ç±»(Extract Superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n\n# 4. è¢«æç»çé¦èµ \n\n> è¢«æç»çé¦èµ (Refused Bequest)\n> \n> å­ç±»ä»ä»ä½¿ç¨ç¶ç±»ä¸­çé¨åæ¹æ³åå±æ§ãå¶ä»æ¥èªç¶ç±»çé¦èµ æä¸ºäºç´¯èµã\n\n\n\n\n# 4.1. é®é¢åå \n\næäºäººä»ä»æ¯æ³éç¨è¶ç±»ä¸­çé¨åä»£ç èåå»ºäºå­ç±»ãä½å®éä¸è¶ç±»åå­ç±»å®å¨ä¸åã\n\n\n# 4.2. è§£å³æ¹æ³\n\n * å¦æç»§æ¿æ²¡ææä¹å¹¶ä¸å­ç±»åç¶ç±»ä¹é´ç¡®å®æ²¡æå±åç¹ï¼å¯ä»¥è¿ç¨ ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation) æ¶é¤ç»§æ¿ã\n * å¦æç»§æ¿æ¯éå½çï¼åå»é¤å­ç±»ä¸­ä¸éè¦çå­æ®µåæ¹æ³ãè¿ç¨ æç¼è¶ç±»(Extract Superclass) å°ææè¶ç±»ä¸­å¯¹äºå­ç±»æç¨çå­æ®µåå½æ°æååºæ¥ï¼ç½®å¥ä¸ä¸ªæ°çè¶ç±»ä¸­ï¼ç¶åè®©ä¸¤ä¸ªç±»é½ç»§æ¿èªå®ã\n\n\n\n\n# 4.3. æ¶ç\n\n * æé«ä»£ç çæ¸æ°åº¦åç»ç»æ§ã\n\n\n\n\n# 4.4. éææ¹æ³è¯´æ\n\n# 4.4.1. ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation)\n\né®é¢\n\næä¸ªå­ç±»åªä½¿ç¨è¶ç±»æ¥å£ä¸­çä¸é¨åï¼ææ¯æ ¹æ¬ä¸éè¦ç»§æ¿èæ¥çæ°æ®ã\n\n\n\nè§£å³\n\n 1. å¨å­ç±»ä¸­æ°å»ºä¸ä¸ªå­æ®µç¨ä»¥ä¿å­è¶ç±»ï¼\n 2. è°æ´å­ç±»å½æ°ï¼ä»¤å®æ¹èå§æè¶ç±»ï¼\n 3. ç¶åå»æä¸¤èä¹é´çç»§æ¿å³ç³»ã\n\n\n\n# 4.4.2. æç¼è¶ç±»(Extract Superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n\n# 5. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 6. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',normalizedContent:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/oo-abusers\n> \n> æ»¥ç¨é¢åå¯¹è±¡(object-orientation abusers)è¿ç»åå³éæå³çï¼ä»£ç é¨åæå®å¨å°è¿èäºé¢åå¯¹è±¡ç¼ç¨ååã\n\n\n# 1. switch å£°æ\n\n> switch å£°æ(switch statements)\n> \n> ä½ æä¸ä¸ªå¤æç switch è¯­å¥æ if åºåè¯­å¥ã\n\n\n\n\n# 1.1. é®é¢åå \n\né¢åå¯¹è±¡ç¨åºçä¸ä¸ªæææ¾ç¹å¾å°±æ¯ï¼å°ç¨ switch å case è¯­å¥ãä»æ¬è´¨ä¸è¯´ï¼switch è¯­å¥çé®é¢å¨äºéå¤ï¼if åºåä¹åæ ·å¦æ­¤ï¼ãä½ å¸¸ä¼åç° switch è¯­å¥æ£å¸äºä¸åå°ç¹ãå¦æè¦ä¸ºå®æ·»å ä¸ä¸ªæ°ç case å­å¥ï¼å°±å¿é¡»æ¾å°ææ switch è¯­å¥å¹¶ä¿®æ¹å®ä»¬ãé¢åå¯¹è±¡ä¸­çå¤ææ¦å¿µå¯ä¸ºæ­¤å¸¦æ¥ä¼éçè§£å³åæ³ã\n\nå¤§å¤æ°æ¶åï¼ä¸çå° switch è¯­å¥ï¼å°±åºè¯¥èèä»¥å¤ææ¥æ¿æ¢å®ã\n\n\n# 1.2. è§£å³æ¹æ³\n\n * é®é¢æ¯å¤æè¯¥åºç°å¨åªï¼switch è¯­å¥å¸¸å¸¸æ ¹æ®ç±»åç è¿è¡éæ©ï¼ä½ è¦çæ¯âä¸è¯¥ç±»åç ç¸å³çå½æ°æç±»âï¼æä»¥åºè¯¥è¿ç¨ æç¼å½æ°(extract method) å° switch è¯­å¥æç¼å°ä¸ä¸ªç¬ç«å½æ°ä¸­ï¼åä»¥ æ¬ç§»å½æ°(move method) å°å®æ¬ç§»å°éè¦å¤ææ§çé£ä¸ªç±»éã\n * å¦æä½ ç switch æ¯åºäºç±»åç æ¥è¯å«åæ¯ï¼è¿æ¶å¯ä»¥è¿ç¨ ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass) æ ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy) ã\n * ä¸æ¦å®æè¿æ ·çç»§æ¿ç»æåï¼å°±å¯ä»¥è¿ç¨ ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(replace conditional with polymorphism) äºã\n * å¦ææ¡ä»¶åæ¯å¹¶ä¸å¤å¹¶ä¸å®ä»¬ä½¿ç¨ä¸ååæ°è°ç¨ç¸åçå½æ°ï¼å¤æå°±æ²¡å¿è¦äºãå¨è¿ç§æåµä¸ï¼ä½ å¯ä»¥è¿ç¨ ä»¥æç¡®å½æ°åä»£åæ°(replace parameter with explicit methods) ã\n * å¦æä½ çéæ©æ¡ä»¶ä¹ä¸æ¯ nullï¼å¯ä»¥è¿ç¨ å¼å¥ null å¯¹è±¡(introduce null object) ã\n\n\n# 1.3. æ¶ç\n\n * æåä»£ç ç»ç»æ§ã\n\n\n\n\n# 1.4. ä½æ¶å¿½ç¥\n\n * å¦æä¸ä¸ª switch æä½åªæ¯æ§è¡ç®åçè¡ä¸ºï¼å°±æ²¡æéæçå¿è¦äºã\n * switch å¸¸è¢«å·¥åè®¾è®¡æ¨¡å¼æï¼å·¥åæ¹æ³æ¨¡å¼(factory method)åæ½è±¡å·¥åæ¨¡å¼(abstract factory)ï¼æä½¿ç¨ï¼è¿ç§æåµä¸ä¹æ²¡å¿è¦éæã\n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# 1.5.2. æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 1.5.3. ä»¥å­ç±»åä»£ç±»åç (replace type code with subclass)\n\né®é¢\n\nä½ æä¸ä¸ªä¸å¯åçç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºã\n\n\n\nè§£å³\n\nä»¥å­ç±»åä»£è¿ä¸ªç±»åç ã\n\n\n\n# 1.5.4. ä»¥ç¶æ/ç­ç¥æ¨¡å¼åä»£ç±»åç (replace type code with state/strategy)\n\né®é¢\n\nä½ æä¸ä¸ªç±»åç ï¼å®ä¼å½±åç±»çè¡ä¸ºï¼ä½ä½ æ æ³éè¿ç»§æ¿æ¶é¤å®ã\n\n\n\nè§£å³\n\nä»¥ç¶æå¯¹è±¡åä»£ç±»åç ã\n\n\n\n# 1.5.5. ä»¥å¤æåä»£æ¡ä»¶è¡¨è¾¾å¼(replace conditional with polymorphism)\n\né®é¢\n\nä½ æä¸æä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼å®æ ¹æ®å¯¹è±¡ç±»åçä¸åèéæ©ä¸åçè¡ä¸ºã\n\nclass bird {\n  //...\n  double getspeed() {\n    switch (type) {\n      case european:\n        return getbasespeed();\n      case african:\n        return getbasespeed() - getloadfactor() * numberofcoconuts;\n      case norwegian_blue:\n        return (isnailed) ? 0 : getbasespeed(voltage);\n    }\n    throw new runtimeexception("should be unreachable");\n  }\n}\n\n\nè§£å³\n\nå°è¿ä¸ªæ¡ä»¶è¡¨è¾¾å¼çæ¯ä¸ªåæ¯æ¾è¿ä¸ä¸ªå­ç±»åçè¦åå½æ°ä¸­ï¼ç¶åå°åå§å½æ°å£°æä¸ºæ½è±¡å½æ°ã\n\nabstract class bird {\n  //...\n  abstract double getspeed();\n}\n\nclass european extends bird {\n  double getspeed() {\n    return getbasespeed();\n  }\n}\nclass african extends bird {\n  double getspeed() {\n    return getbasespeed() - getloadfactor() * numberofcoconuts;\n  }\n}\nclass norwegianblue extends bird {\n  double getspeed() {\n    return (isnailed) ? 0 : getbasespeed(voltage);\n  }\n}\n\n// somewhere in client code\nspeed = bird.getspeed();\n\n\n# 1.5.6. ä»¥æç¡®å½æ°åä»£åæ°(replace parameter with explicit methods)\n\né®é¢\n\nä½ æä¸ä¸ªå½æ°ï¼å¶ä¸­å®å¨åå³äºåæ°å¼èéåä¸åçè¡ä¸ºã\n\nvoid setvalue(string name, int value) {\n  if (name.equals("height")) {\n    height = value;\n    return;\n  }\n  if (name.equals("width")) {\n    width = value;\n    return;\n  }\n  assert.shouldneverreachhere();\n}\n\n\nè§£å³\n\néå¯¹è¯¥åæ°çæ¯ä¸ä¸ªå¯è½å¼ï¼å»ºç«ä¸ä¸ªç¬ç«å½æ°ã\n\nvoid setheight(int arg) {\n  height = arg;\n}\nvoid setwidth(int arg) {\n  width = arg;\n}\n\n\n# 1.5.7. å¼å¥ null å¯¹è±¡(introduce null object)\n\né®é¢\n\nä½ éè¦åä¸æ£æ¥æå¯¹è±¡æ¯å¦ä¸º nullã\n\nif (customer == null) {\n  plan = billingplan.basic();\n}\nelse {\n  plan = customer.getplan();\n}\n\n\nè§£å³\n\nå° null å¼æ¿æ¢ä¸º null å¯¹è±¡ã\n\nclass nullcustomer extends customer {\n  plan getplan() {\n    return new nullplan();\n  }\n  // some other null functionality.\n}\n\n// replace null values with null-object.\ncustomer = (order.customer != null) ? order.customer : new nullcustomer();\n\n// use null-object as if it\'s normal subclass.\nplan = customer.getplan();\n\n\n\n# 2. ä¸´æ¶å­æ®µ\n\n> ä¸´æ¶å­æ®µ(temporary field)çå¼åªå¨ç¹å®ç¯å¢ä¸ææä¹ï¼ç¦»å¼è¿ä¸ªç¯å¢ï¼å®ä»¬å°±ä»ä¹ä¹ä¸æ¯äºã\n\n\n\n\n# 2.1. é®é¢åå \n\nææ¶ä½ ä¼çå°è¿æ ·çå¯¹è±¡ï¼å¶åæä¸ªå®ä¾åéä»ä¸ºæç§ç¹å®æåµèè®¾ãè¿æ ·çä»£ç è®©äººä¸æçè§£ï¼å ä¸ºä½ éå¸¸è®¤ä¸ºå¯¹è±¡å¨æææ¶åé½éè¦å®çææåéãå¨åéæªè¢«ä½¿ç¨çæåµä¸çæµå½åè®¾ç½®ç®çï¼ä¼è®©ä½ åç¯ã éå¸¸ï¼ä¸´æ¶å­æ®µæ¯å¨æä¸ç®æ³éè¦å¤§éè¾å¥æ¶èåå»ºãå æ­¤ï¼ä¸ºäºé¿åå½æ°æè¿å¤åæ°ï¼ç¨åºåå³å®å¨ç±»ä¸­åå»ºè¿äºæ°æ®çä¸´æ¶å­æ®µãè¿äºä¸´æ¶å­æ®µä»ä»å¨ç®æ³ä¸­ä½¿ç¨ï¼å¶ä»æ¶åå´æ¯«æ ç¨å¤ã è¿ç§ä»£ç ä¸å¥½çè§£ãä½ æææ¥çå¯¹è±¡å­æ®µçæ°æ®ï¼ä½æ¯åºäºæç§åå ï¼å®ä»¬æ»æ¯ä¸ºç©ºã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * å¯ä»¥éè¿ æç¼ç±»(extract class) å°ä¸´æ¶å­æ®µåæä½å®ä»¬çææä»£ç æç¼å°ä¸ä¸ªåç¬çç±»ä¸­ãæ­¤å¤ï¼ä½ å¯ä»¥è¿ç¨ ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object) æ¥å®ç°åæ ·çç®çã\n * å¼å¥ null å¯¹è±¡(introduce null object) å¨âåéä¸åæ³âçæåµä¸åå»ºä¸ä¸ª null å¯¹è±¡ï¼ä»èé¿åååºæ¡ä»¶è¡¨è¾¾å¼ã\n\n\n\n\n# 2.3. æ¶ç\n\n * æ´å¥½çä»£ç æ¸æ°åº¦åç»ç»æ§ã\n\n\n\n\n# 2.4. éææ¹æ³è¯´æ\n\n# 2.4.1. æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 2.4.2. ä»¥å½æ°å¯¹è±¡åä»£å½æ°(replace method with method object)\n\né®é¢\n\nä½ æä¸ä¸ªè¿é¿å½æ°ï¼å®çå±é¨åéäº¤ç»å¨ä¸èµ·ï¼ä»¥è´äºä½ æ æ³åºç¨æç¼å½æ°(extract method) ã\n\nclass order {\n  //...\n  public double price() {\n    double primarybaseprice;\n    double secondarybaseprice;\n    double tertiarybaseprice;\n    // long computation.\n    //...\n  }\n}\n\n\nè§£å³\n\nå°å½æ°ç§»å°ä¸ä¸ªç¬ç«çç±»ä¸­ï¼ä½¿å¾å±é¨åéæäºè¿ä¸ªç±»çå­æ®µãç¶åï¼ä½ å¯ä»¥å°å½æ°åå²æè¿ä¸ªç±»ä¸­çå¤ä¸ªå½æ°ã\n\nclass order {\n  //...\n  public double price() {\n    return new pricecalculator(this).compute();\n  }\n}\n\nclass pricecalculator {\n  private double primarybaseprice;\n  private double secondarybaseprice;\n  private double tertiarybaseprice;\n\n  public pricecalculator(order order) {\n    // copy relevant information from order object.\n    //...\n  }\n\n  public double compute() {\n    // long computation.\n    //...\n  }\n}\n\n\n# 2.4.3. å¼å¥ null å¯¹è±¡(introduce null object)\n\né®é¢\n\nä½ éè¦åä¸æ£æ¥æå¯¹è±¡æ¯å¦ä¸º nullã\n\nif (customer == null) {\n  plan = billingplan.basic();\n}\nelse {\n  plan = customer.getplan();\n}\n\n\nè§£å³\n\nå° null å¼æ¿æ¢ä¸º null å¯¹è±¡ã\n\nclass nullcustomer extends customer {\n  plan getplan() {\n    return new nullplan();\n  }\n  // some other null functionality.\n}\n\n// replace null values with null-object.\ncustomer = (order.customer != null) ? order.customer : new nullcustomer();\n\n// use null-object as if it\'s normal subclass.\nplan = customer.getplan();\n\n\n\n# 3. å¼æ²åå·¥çç±»\n\n> å¼æ²åå·¥çç±»(alternative classes with different interfaces)\n> \n> ä¸¤ä¸ªç±»ä¸­æçä¸åçå½æ°ï¼å´å¨åçåä¸ä»¶äºã\n\n\n\n\n# 3.1. é®é¢åå \n\nè¿ç§æåµå¾å¾æ¯å ä¸ºï¼åå»ºè¿ä¸ªç±»çç¨åºåå¹¶ä¸ç¥éå·²ç»æå®ç°è¿ä¸ªåè½çç±»å­å¨äºã\n\n\n# 3.2. è§£å³æ¹æ³\n\n * å¦æä¸¤ä¸ªå½æ°ååä¸ä»¶äºï¼å´æçä¸åçç­¾åï¼è¯·è¿ç¨ å½æ°æ¹å(rename method) æ ¹æ®å®ä»¬çç¨ééæ°å½åã\n * è¿ç¨ æ¬ç§»å½æ°(move method) ã æ·»å åæ°(add parameter) å ä»¤å½æ°æºå¸¦åæ°(parameterize method) æ¥ä½¿å¾æ¹æ³çåç§°åå®ç°ä¸è´ã\n * å¦æä¸¤ä¸ªç±»ä»æé¨ååè½æ¯éå¤çï¼å°è¯è¿ç¨ æç¼è¶ç±»(extract superclass) ãè¿ç§æåµä¸ï¼å·²å­å¨çç±»å°±æäºè¶ç±»ã\n * å½æç»éæ©å¹¶è¿ç¨æç§æ¹æ³æ¥éæåï¼ä¹è®¸ä½ å°±è½å é¤å¶ä¸­ä¸ä¸ªç±»äºã\n\n\n# 3.3. æ¶ç\n\n * æ¶é¤äºä¸å¿è¦çéå¤ä»£ç ï¼ä¸ºä»£ç ç¦èº«äºã\n * ä»£ç æ´æè¯»ï¼ä¸åéè¦çæµä¸ºä»ä¹è¦æä¸¤ä¸ªåè½ç¸åçç±»ï¼ã\n\n\n\n\n# 3.4. ä½æ¶å¿½ç¥\n\n * ææ¶åå¹¶ç±»æ¯ä¸å¯è½çï¼æèæ¯å¦æ­¤å°é¾ä»¥è³äºæ²¡ææä¹ãä¾å¦ï¼ä¸¤ä¸ªåè½ç¸ä¼¼çç±»å­å¨äºä¸åç lib åºä¸­ã\n\n\n# 3.5. éææ¹æ³è¯´æ\n\n# 3.5.1. å½æ°æ¹å(rename method)\n\né®é¢\n\nå½æ°çåç§°æªè½æ°å½çæ­ç¤ºå½æ°çç¨éã\n\nclass person {\n  public string getsnm();\n}\n\n\nè§£å³\n\nä¿®æ¹å½æ°åã\n\nclass person {\n  public string getsecondname();\n}\n\n\n# 3.5.2. æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.5.3. æ·»å åæ°(add parameter)\n\né®é¢ æä¸ªå½æ°éè¦ä»è°ç¨ç«¯å¾å°æ´å¤ä¿¡æ¯ã\n\nclass customer {\n  public contact getcontact();\n}\n\n\nè§£å³ ä¸ºæ­¤å½æ°æ·»å ä¸ä¸ªå¯¹è±¡å½æ°ï¼è®©æ¹å¯¹è±¡å¸¦è¿å½æ°æéä¿¡æ¯ã\n\nclass customer {\n  public contact getcontact(date date);\n}\n\n\n# 3.5.4. ä»¤å½æ°æºå¸¦åæ°(parameterize method)\n\né®é¢\n\nè¥å¹²å½æ°åäºç±»ä¼¼çå·¥ä½ï¼ä½å¨å½æ°æ¬ä½ä¸­å´åå«äºä¸åçå¼ã\n\nè§£å³\n\nå»ºç«åä¸å½æ°ï¼ä»¥åæ°è¡¨è¾¾åªäºä¸åçå¼ã\n\n\n\n# 3.5.5. æç¼è¶ç±»(extract superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n\n# 4. è¢«æç»çé¦èµ \n\n> è¢«æç»çé¦èµ (refused bequest)\n> \n> å­ç±»ä»ä»ä½¿ç¨ç¶ç±»ä¸­çé¨åæ¹æ³åå±æ§ãå¶ä»æ¥èªç¶ç±»çé¦èµ æä¸ºäºç´¯èµã\n\n\n\n\n# 4.1. é®é¢åå \n\næäºäººä»ä»æ¯æ³éç¨è¶ç±»ä¸­çé¨åä»£ç èåå»ºäºå­ç±»ãä½å®éä¸è¶ç±»åå­ç±»å®å¨ä¸åã\n\n\n# 4.2. è§£å³æ¹æ³\n\n * å¦æç»§æ¿æ²¡ææä¹å¹¶ä¸å­ç±»åç¶ç±»ä¹é´ç¡®å®æ²¡æå±åç¹ï¼å¯ä»¥è¿ç¨ ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation) æ¶é¤ç»§æ¿ã\n * å¦æç»§æ¿æ¯éå½çï¼åå»é¤å­ç±»ä¸­ä¸éè¦çå­æ®µåæ¹æ³ãè¿ç¨ æç¼è¶ç±»(extract superclass) å°ææè¶ç±»ä¸­å¯¹äºå­ç±»æç¨çå­æ®µåå½æ°æååºæ¥ï¼ç½®å¥ä¸ä¸ªæ°çè¶ç±»ä¸­ï¼ç¶åè®©ä¸¤ä¸ªç±»é½ç»§æ¿èªå®ã\n\n\n\n\n# 4.3. æ¶ç\n\n * æé«ä»£ç çæ¸æ°åº¦åç»ç»æ§ã\n\n\n\n\n# 4.4. éææ¹æ³è¯´æ\n\n# 4.4.1. ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation)\n\né®é¢\n\næä¸ªå­ç±»åªä½¿ç¨è¶ç±»æ¥å£ä¸­çä¸é¨åï¼ææ¯æ ¹æ¬ä¸éè¦ç»§æ¿èæ¥çæ°æ®ã\n\n\n\nè§£å³\n\n 1. å¨å­ç±»ä¸­æ°å»ºä¸ä¸ªå­æ®µç¨ä»¥ä¿å­è¶ç±»ï¼\n 2. è°æ´å­ç±»å½æ°ï¼ä»¤å®æ¹èå§æè¶ç±»ï¼\n 3. ç¶åå»æä¸¤èä¹é´çç»§æ¿å³ç³»ã\n\n\n\n# 4.4.2. æç¼è¶ç±»(extract superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n\n# 5. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 6. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç åå³éä¹åé©çéç¢",frontmatter:{title:"ä»£ç åå³éä¹åé©çéç¢",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ","ä»£ç çåå³é"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/76e1cc/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/04.%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.html",relativePath:"03.è®¾è®¡/03.éæ/04.ä»£ç åå³éä¹åé©çéç¢.md",key:"v-38d3c9ce",path:"/pages/76e1cc/",headers:[{level:2,title:"1. åæ£å¼åå",slug:"_1-åæ£å¼åå",normalizedTitle:"1. åæ£å¼åå",charIndex:154},{level:3,title:"1.1. ç¹å¾",slug:"_1-1-ç¹å¾",normalizedTitle:"1.1. ç¹å¾",charIndex:310},{level:3,title:"1.2. é®é¢åå ",slug:"_1-2-é®é¢åå ",normalizedTitle:"1.2. é®é¢åå ",charIndex:399},{level:3,title:"1.3. è§£å³åæ³",slug:"_1-3-è§£å³åæ³",normalizedTitle:"1.3. è§£å³åæ³",charIndex:448},{level:3,title:"1.4. æ¶ç",slug:"_1-4-æ¶ç",normalizedTitle:"1.4. æ¶ç",charIndex:496},{level:3,title:"1.5. éææ¹æ³è¯´æ",slug:"_1-5-éææ¹æ³è¯´æ",normalizedTitle:"1.5. éææ¹æ³è¯´æ",charIndex:531},{level:4,title:"1.5.1. æç¼ç±»(Extract Class)",slug:"_1-5-1-æç¼ç±»-extract-class",normalizedTitle:"1.5.1. æç¼ç±»(extract class)",charIndex:546},{level:2,title:"2. å¹³è¡ç»§æ¿ä½ç³»",slug:"_2-å¹³è¡ç»§æ¿ä½ç³»",normalizedTitle:"2. å¹³è¡ç»§æ¿ä½ç³»",charIndex:628},{level:3,title:"2.1. ç¹å¾",slug:"_2-1-ç¹å¾",normalizedTitle:"2.1. ç¹å¾",charIndex:720},{level:3,title:"2.2. é®é¢åå ",slug:"_2-2-é®é¢åå ",normalizedTitle:"2.2. é®é¢åå ",charIndex:800},{level:3,title:"2.3. è§£å³æ¹æ³",slug:"_2-3-è§£å³æ¹æ³",normalizedTitle:"2.3. è§£å³æ¹æ³",charIndex:852},{level:3,title:"2.4. æ¶ç",slug:"_2-4-æ¶ç",normalizedTitle:"2.4. æ¶ç",charIndex:960},{level:3,title:"2.5. ä½æ¶å¿½ç¥",slug:"_2-5-ä½æ¶å¿½ç¥",normalizedTitle:"2.5. ä½æ¶å¿½ç¥",charIndex:994},{level:3,title:"2.6. éææ¹æ³è¯´æ",slug:"_2-6-éææ¹æ³è¯´æ",normalizedTitle:"2.6. éææ¹æ³è¯´æ",charIndex:1081},{level:4,title:"2.6.1. æ¬ç§»å½æ°(Move Method)",slug:"_2-6-1-æ¬ç§»å½æ°-move-method",normalizedTitle:"2.6.1. æ¬ç§»å½æ°(move method)",charIndex:1096},{level:4,title:"2.6.2. æ¬ç§»å­æ®µ(Move Field)",slug:"_2-6-2-æ¬ç§»å­æ®µ-move-field",normalizedTitle:"2.6.2. æ¬ç§»å­æ®µ(move field)",charIndex:1233},{level:2,title:"3. é°å¼¹å¼ä¿®æ¹",slug:"_3-é°å¼¹å¼ä¿®æ¹",normalizedTitle:"3. é°å¼¹å¼ä¿®æ¹",charIndex:1337},{level:3,title:"3.1. ç¹å¾",slug:"_3-1-ç¹å¾",normalizedTitle:"3.1. ç¹å¾",charIndex:1493},{level:3,title:"3.2. é®é¢åå ",slug:"_3-2-é®é¢åå ",normalizedTitle:"3.2. é®é¢åå ",charIndex:1530},{level:3,title:"3.3. è§£å³æ¹æ³",slug:"_3-3-è§£å³æ¹æ³",normalizedTitle:"3.3. è§£å³æ¹æ³",charIndex:1562},{level:3,title:"3.4. æ¶ç",slug:"_3-4-æ¶ç",normalizedTitle:"3.4. æ¶ç",charIndex:1715},{level:3,title:"3.5. éææ¹æ³è¯´æ",slug:"_3-5-éææ¹æ³è¯´æ",normalizedTitle:"3.5. éææ¹æ³è¯´æ",charIndex:1759},{level:4,title:"3.5.1. æ¬ç§»å½æ°(Move Method)",slug:"_3-5-1-æ¬ç§»å½æ°-move-method",normalizedTitle:"3.5.1. æ¬ç§»å½æ°(move method)",charIndex:1774},{level:4,title:"3.5.2. æ¬ç§»å­æ®µ(Move Field)",slug:"_3-5-2-æ¬ç§»å­æ®µ-move-field",normalizedTitle:"3.5.2. æ¬ç§»å­æ®µ(move field)",charIndex:1911},{level:4,title:"3.5.3. å°ç±»åèå(Inline Class)",slug:"_3-5-3-å°ç±»åèå-inline-class",normalizedTitle:"3.5.3. å°ç±»åèå(inline class)",charIndex:2014},{level:2,title:"4. æ©å±éè¯»",slug:"_4-æ©å±éè¯»",normalizedTitle:"4. æ©å±éè¯»",charIndex:2097},{level:2,title:"5. åèèµæ",slug:"_5-åèèµæ",normalizedTitle:"5. åèèµæ",charIndex:2194}],headersStr:"1. åæ£å¼åå 1.1. ç¹å¾ 1.2. é®é¢åå  1.3. è§£å³åæ³ 1.4. æ¶ç 1.5. éææ¹æ³è¯´æ 1.5.1. æç¼ç±»(Extract Class) 2. å¹³è¡ç»§æ¿ä½ç³» 2.1. ç¹å¾ 2.2. é®é¢åå  2.3. è§£å³æ¹æ³ 2.4. æ¶ç 2.5. ä½æ¶å¿½ç¥ 2.6. éææ¹æ³è¯´æ 2.6.1. æ¬ç§»å½æ°(Move Method) 2.6.2. æ¬ç§»å­æ®µ(Move Field) 3. é°å¼¹å¼ä¿®æ¹ 3.1. ç¹å¾ 3.2. é®é¢åå  3.3. è§£å³æ¹æ³ 3.4. æ¶ç 3.5. éææ¹æ³è¯´æ 3.5.1. æ¬ç§»å½æ°(Move Method) 3.5.2. æ¬ç§»å­æ®µ(Move Field) 3.5.3. å°ç±»åèå(Inline Class) 4. æ©å±éè¯» 5. åèèµæ",content:"> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/change-preventers\n> \n> åé©çéç¢(Change Preventers)è¿ç»åå³éæå³çï¼å½ä½ éè¦æ¹åä¸å¤ä»£ç æ¶ï¼å´åç°ä¸å¾ä¸æ¹åå¶ä»çå°æ¹ãè¿ä½¿å¾ç¨åºå¼ååå¾å¤æãä»£ä»·é«æã\n\n\n# 1. åæ£å¼åå\n\n> åæ£å¼åå(Divergent Change) ç±»ä¼¼äº é°å¼¹å¼ä¿®æ¹(Shotgun Surgery) ï¼ä½å®éä¸å®å¨ä¸åãåæ£å¼åå(Divergent Change) æ¯æä¸ä¸ªç±»åå¤ç§ååçå½±åãé°å¼¹å¼ä¿®æ¹(Shotgun Surgery) æ¯æå¤ç§ååå¼åå¤ä¸ªç±»ç¸åºçä¿®æ¹ã\n\n\n# 1.1. ç¹å¾\n\nä½ åç°ä½ æ³è¦ä¿®æ¹ä¸ä¸ªå½æ°ï¼å´å¿é¡»è¦åæ¶ä¿®æ¹è®¸å¤ä¸ç¸å³çå½æ°ãä¾å¦ï¼å½ä½ æ³è¦æ·»å ä¸ä¸ªæ°çäº§åç±»åæ¶ï¼ä½ éè¦åæ­¥ä¿®æ¹å¯¹äº§åè¿è¡æ¥æ¾ãæ¾ç¤ºãæåºçå½æ°ã\n\n\n\n\n# 1.2. é®é¢åå \n\néå¸¸ï¼è¿ç§åæ£å¼ä¿®æ¹æ¯ç±äºç¼ç¨ç»æä¸åçæèâå¤å¶-ç²è´´å¼ç¼ç¨âã\n\n\n# 1.3. è§£å³åæ³\n\n * è¿ç¨ æç¼ç±»(Extract Class) æåç±»çè¡ä¸ºã\n\n\n# 1.4. æ¶ç\n\n * æé«ä»£ç ç»ç»ç»æ\n * åå°éå¤ä»£ç \n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n\n# 2. å¹³è¡ç»§æ¿ä½ç³»\n\n> å¹³è¡ç»§æ¿ä½ç³»(Parallel Inheritance Hierarchies) å¶å®æ¯ é°å¼¹å¼ä¿®æ¹(Shotgun Surgery) çç¹æ®æåµã\n\n\n# 2.1. ç¹å¾\n\næ¯å½ä½ ä¸ºæä¸ªç±»æ·»å ä¸ä¸ªå­ç±»ï¼å¿é¡»åæ¶ä¸ºå¦ä¸ä¸ªç±»ç¸åºæ·»å ä¸ä¸ªå­ç±»ãè¿ç§æåµçå¸åç¹å¾æ¯ï¼æä¸ªç»§æ¿ä½ç³»çç±»ååç¼æç±»ååç¼å®å¨ç¸åã\n\n\n\n\n# 2.2. é®é¢åå \n\nèµ·åçç»§æ¿ä½ç³»å¾å°ï¼éçä¸æ­æ·»å æ°ç±»ï¼ç»§æ¿ä½ç³»è¶æ¥è¶å¤§ï¼ä¹è¶æ¥è¶é¾ä¿®æ¹ã\n\n\n# 2.3. è§£å³æ¹æ³\n\n * ä¸è¬ç­ç¥æ¯ï¼è®©ä¸ä¸ªç»§æ¿ä½ç³»çå®ä¾å¼ç¨å¦ä¸ä¸ªç»§æ¿ä½ç³»çå®ä¾ãå¦æåæ¥ååè¿ç¨ æ¬ç§»å½æ°(Move Method) å æ¬ç§»å­æ®µ(Move Field)ï¼å°±å¯ä»¥æ¶é¤å¼ç¨ç«¯çç»§æ¿ä½ç³»ã\n\n\n# 2.4. æ¶ç\n\n * æ´å¥½çä»£ç ç»ç»\n * åå°éå¤ä»£ç \n\n\n# 2.5. ä½æ¶å¿½ç¥\n\n * ææ¶å·æå¹¶è¡ç±»å±æ¬¡ç»æåªæ¯ä¸ç§ä¸ºäºé¿åç¨åºä½ç³»ç»ææ´æ··ä¹±çæ¹æ³ãå¦æä½ åç°å°è¯æ¶é¤å¹³è¡ç»§æ¿ä½ç³»å¯¼è´ä»£ç æ´å ä¸éï¼é£ä¹ä½ åºè¯¥åæ»ä½ çä¿®æ¹ã\n\n\n# 2.6. éææ¹æ³è¯´æ\n\n# 2.6.1. æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 2.6.2. æ¬ç§»å­æ®µ(Move Field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n\n# 3. é°å¼¹å¼ä¿®æ¹\n\n> é°å¼¹å¼ä¿®æ¹(Shotgun Surgery) ç±»ä¼¼äº åæ£å¼åå(Divergent Change) ï¼ä½å®éä¸å®å¨ä¸åãåæ£å¼åå(Divergent Change) æ¯æä¸ä¸ªç±»åå¤ç§ååçå½±åãé°å¼¹å¼ä¿®æ¹(Shotgun Surgery) æ¯æå¤ç§ååå¼åå¤ä¸ªç±»ç¸åºçä¿®æ¹ã\n\n\n# 3.1. ç¹å¾\n\nä»»ä½ä¿®æ¹é½éè¦å¨è®¸å¤ä¸åç±»ä¸åå°å¹åº¦ä¿®æ¹ã\n\n\n\n\n# 3.2. é®é¢åå \n\nä¸ä¸ªåä¸çèè´£è¢«æåæå¤§éçç±»ã\n\n\n# 3.3. è§£å³æ¹æ³\n\n * è¿ç¨æ¬ç§»å½æ°(Move Method) å æ¬ç§»å­æ®µ(Move Field) æ¥æ¬ç§»ä¸åç±»ä¸­ç¸åçè¡ä¸ºå°ä¸ä¸ªç¬ç«ç±»ä¸­ãå¦ææ²¡æéåå­æ¾æ¬ç§»å½æ°æå­æ®µçç±»ï¼å°±åå»ºä¸ä¸ªæ°ç±»ã\n * éå¸¸ï¼å¯ä»¥è¿ç¨ å°ç±»åèå(Inline Class) å°ä¸äºåç¸å³è¡ä¸ºæ¾è¿åä¸ä¸ªç±»ã\n\n\n\n\n# 3.4. æ¶ç\n\n * æ´å¥½çä»£ç ç»ç»\n * åå°éå¤ä»£ç \n * æ´æç»´æ¤\n\n\n\n\n# 3.5. éææ¹æ³è¯´æ\n\n# 3.5.1. æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.5.2. æ¬ç§»å­æ®µ(Move Field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n# 3.5.3. å°ç±»åèå(Inline Class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n\n# 4. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 5. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring",normalizedContent:"> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/change-preventers\n> \n> åé©çéç¢(change preventers)è¿ç»åå³éæå³çï¼å½ä½ éè¦æ¹åä¸å¤ä»£ç æ¶ï¼å´åç°ä¸å¾ä¸æ¹åå¶ä»çå°æ¹ãè¿ä½¿å¾ç¨åºå¼ååå¾å¤æãä»£ä»·é«æã\n\n\n# 1. åæ£å¼åå\n\n> åæ£å¼åå(divergent change) ç±»ä¼¼äº é°å¼¹å¼ä¿®æ¹(shotgun surgery) ï¼ä½å®éä¸å®å¨ä¸åãåæ£å¼åå(divergent change) æ¯æä¸ä¸ªç±»åå¤ç§ååçå½±åãé°å¼¹å¼ä¿®æ¹(shotgun surgery) æ¯æå¤ç§ååå¼åå¤ä¸ªç±»ç¸åºçä¿®æ¹ã\n\n\n# 1.1. ç¹å¾\n\nä½ åç°ä½ æ³è¦ä¿®æ¹ä¸ä¸ªå½æ°ï¼å´å¿é¡»è¦åæ¶ä¿®æ¹è®¸å¤ä¸ç¸å³çå½æ°ãä¾å¦ï¼å½ä½ æ³è¦æ·»å ä¸ä¸ªæ°çäº§åç±»åæ¶ï¼ä½ éè¦åæ­¥ä¿®æ¹å¯¹äº§åè¿è¡æ¥æ¾ãæ¾ç¤ºãæåºçå½æ°ã\n\n\n\n\n# 1.2. é®é¢åå \n\néå¸¸ï¼è¿ç§åæ£å¼ä¿®æ¹æ¯ç±äºç¼ç¨ç»æä¸åçæèâå¤å¶-ç²è´´å¼ç¼ç¨âã\n\n\n# 1.3. è§£å³åæ³\n\n * è¿ç¨ æç¼ç±»(extract class) æåç±»çè¡ä¸ºã\n\n\n# 1.4. æ¶ç\n\n * æé«ä»£ç ç»ç»ç»æ\n * åå°éå¤ä»£ç \n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n\n# 2. å¹³è¡ç»§æ¿ä½ç³»\n\n> å¹³è¡ç»§æ¿ä½ç³»(parallel inheritance hierarchies) å¶å®æ¯ é°å¼¹å¼ä¿®æ¹(shotgun surgery) çç¹æ®æåµã\n\n\n# 2.1. ç¹å¾\n\næ¯å½ä½ ä¸ºæä¸ªç±»æ·»å ä¸ä¸ªå­ç±»ï¼å¿é¡»åæ¶ä¸ºå¦ä¸ä¸ªç±»ç¸åºæ·»å ä¸ä¸ªå­ç±»ãè¿ç§æåµçå¸åç¹å¾æ¯ï¼æä¸ªç»§æ¿ä½ç³»çç±»ååç¼æç±»ååç¼å®å¨ç¸åã\n\n\n\n\n# 2.2. é®é¢åå \n\nèµ·åçç»§æ¿ä½ç³»å¾å°ï¼éçä¸æ­æ·»å æ°ç±»ï¼ç»§æ¿ä½ç³»è¶æ¥è¶å¤§ï¼ä¹è¶æ¥è¶é¾ä¿®æ¹ã\n\n\n# 2.3. è§£å³æ¹æ³\n\n * ä¸è¬ç­ç¥æ¯ï¼è®©ä¸ä¸ªç»§æ¿ä½ç³»çå®ä¾å¼ç¨å¦ä¸ä¸ªç»§æ¿ä½ç³»çå®ä¾ãå¦æåæ¥ååè¿ç¨ æ¬ç§»å½æ°(move method) å æ¬ç§»å­æ®µ(move field)ï¼å°±å¯ä»¥æ¶é¤å¼ç¨ç«¯çç»§æ¿ä½ç³»ã\n\n\n# 2.4. æ¶ç\n\n * æ´å¥½çä»£ç ç»ç»\n * åå°éå¤ä»£ç \n\n\n# 2.5. ä½æ¶å¿½ç¥\n\n * ææ¶å·æå¹¶è¡ç±»å±æ¬¡ç»æåªæ¯ä¸ç§ä¸ºäºé¿åç¨åºä½ç³»ç»ææ´æ··ä¹±çæ¹æ³ãå¦æä½ åç°å°è¯æ¶é¤å¹³è¡ç»§æ¿ä½ç³»å¯¼è´ä»£ç æ´å ä¸éï¼é£ä¹ä½ åºè¯¥åæ»ä½ çä¿®æ¹ã\n\n\n# 2.6. éææ¹æ³è¯´æ\n\n# 2.6.1. æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 2.6.2. æ¬ç§»å­æ®µ(move field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n\n# 3. é°å¼¹å¼ä¿®æ¹\n\n> é°å¼¹å¼ä¿®æ¹(shotgun surgery) ç±»ä¼¼äº åæ£å¼åå(divergent change) ï¼ä½å®éä¸å®å¨ä¸åãåæ£å¼åå(divergent change) æ¯æä¸ä¸ªç±»åå¤ç§ååçå½±åãé°å¼¹å¼ä¿®æ¹(shotgun surgery) æ¯æå¤ç§ååå¼åå¤ä¸ªç±»ç¸åºçä¿®æ¹ã\n\n\n# 3.1. ç¹å¾\n\nä»»ä½ä¿®æ¹é½éè¦å¨è®¸å¤ä¸åç±»ä¸åå°å¹åº¦ä¿®æ¹ã\n\n\n\n\n# 3.2. é®é¢åå \n\nä¸ä¸ªåä¸çèè´£è¢«æåæå¤§éçç±»ã\n\n\n# 3.3. è§£å³æ¹æ³\n\n * è¿ç¨æ¬ç§»å½æ°(move method) å æ¬ç§»å­æ®µ(move field) æ¥æ¬ç§»ä¸åç±»ä¸­ç¸åçè¡ä¸ºå°ä¸ä¸ªç¬ç«ç±»ä¸­ãå¦ææ²¡æéåå­æ¾æ¬ç§»å½æ°æå­æ®µçç±»ï¼å°±åå»ºä¸ä¸ªæ°ç±»ã\n * éå¸¸ï¼å¯ä»¥è¿ç¨ å°ç±»åèå(inline class) å°ä¸äºåç¸å³è¡ä¸ºæ¾è¿åä¸ä¸ªç±»ã\n\n\n\n\n# 3.4. æ¶ç\n\n * æ´å¥½çä»£ç ç»ç»\n * åå°éå¤ä»£ç \n * æ´æç»´æ¤\n\n\n\n\n# 3.5. éææ¹æ³è¯´æ\n\n# 3.5.1. æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.5.2. æ¬ç§»å­æ®µ(move field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n# 3.5.3. å°ç±»åèå(inline class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n\n# 4. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 5. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç åå³éä¹éå¿è¦ç",frontmatter:{title:"ä»£ç åå³éä¹éå¿è¦ç",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ","ä»£ç çåå³é"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/dff53d/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/05.%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.html",relativePath:"03.è®¾è®¡/03.éæ/05.ä»£ç åå³éä¹éå¿è¦ç.md",key:"v-5d9b4816",path:"/pages/dff53d/",headers:[{level:2,title:"1. åä½ç±»",slug:"_1-åä½ç±»",normalizedTitle:"1. åä½ç±»",charIndex:130},{level:3,title:"1.1. é®é¢åå ",slug:"_1-1-é®é¢åå ",normalizedTitle:"1.1. é®é¢åå ",charIndex:203},{level:3,title:"1.2. è§£å³æ¹æ³",slug:"_1-2-è§£å³æ¹æ³",normalizedTitle:"1.2. è§£å³æ¹æ³",charIndex:291},{level:3,title:"1.3. æ¶ç",slug:"_1-3-æ¶ç",normalizedTitle:"1.3. æ¶ç",charIndex:392},{level:3,title:"1.4. ä½æ¶å¿½ç¥",slug:"_1-4-ä½æ¶å¿½ç¥",normalizedTitle:"1.4. ä½æ¶å¿½ç¥",charIndex:422},{level:3,title:"1.5. éææ¹æ³è¯´æ",slug:"_1-5-éææ¹æ³è¯´æ",normalizedTitle:"1.5. éææ¹æ³è¯´æ",charIndex:488},{level:4,title:"1.5.1. å°ç±»åèå(Inline Class)",slug:"_1-5-1-å°ç±»åèå-inline-class",normalizedTitle:"1.5.1. å°ç±»åèå(inline class)",charIndex:503},{level:4,title:"1.5.2. æå ç»§æ¿ä½ç³»(Collapse Hierarchy)",slug:"_1-5-2-æå ç»§æ¿ä½ç³»-collapse-hierarchy",normalizedTitle:"1.5.2. æå ç»§æ¿ä½ç³»(collapse hierarchy)",charIndex:585},{level:2,title:"2. å¤¸å¤¸å¶è°æªæ¥æ§",slug:"_2-å¤¸å¤¸å¶è°æªæ¥æ§",normalizedTitle:"2. å¤¸å¤¸å¶è°æªæ¥æ§",charIndex:660},{level:3,title:"2.1. é®é¢åå ",slug:"_2-1-é®é¢åå ",normalizedTitle:"2.1. é®é¢åå ",charIndex:736},{level:3,title:"2.2. è§£å³æ¹æ³",slug:"_2-2-è§£å³æ¹æ³",normalizedTitle:"2.2. è§£å³æ¹æ³",charIndex:796},{level:3,title:"2.3. æ¶ç",slug:"_2-3-æ¶ç",normalizedTitle:"2.3. æ¶ç",charIndex:999},{level:3,title:"2.4. ä½æ¶å¿½ç¥",slug:"_2-4-ä½æ¶å¿½ç¥",normalizedTitle:"2.4. ä½æ¶å¿½ç¥",charIndex:1031},{level:3,title:"2.5. éææ¹æ³è¯´æ",slug:"_2-5-éææ¹æ³è¯´æ",normalizedTitle:"2.5. éææ¹æ³è¯´æ",charIndex:1161},{level:4,title:"2.5.1. æå ç»§æ¿ä½ç³»(Collapse Hierarchy)",slug:"_2-5-1-æå ç»§æ¿ä½ç³»-collapse-hierarchy",normalizedTitle:"2.5.1. æå ç»§æ¿ä½ç³»(collapse hierarchy)",charIndex:1176},{level:4,title:"2.5.2. å°ç±»åèå(Inline Class)",slug:"_2-5-2-å°ç±»åèå-inline-class",normalizedTitle:"2.5.2. å°ç±»åèå(inline class)",charIndex:1250},{level:4,title:"2.5.3. åèå½æ°(Inline Method)",slug:"_2-5-3-åèå½æ°-inline-method",normalizedTitle:"2.5.3. åèå½æ°(inline method)",charIndex:1332},{level:4,title:"2.5.4. ç§»é¤åæ°(Remove Parameter)",slug:"_2-5-4-ç§»é¤åæ°-remove-parameter",normalizedTitle:"2.5.4. ç§»é¤åæ°(remove parameter)",charIndex:1708},{level:2,title:"3. çº¯ç¨çæ°æ®ç±»",slug:"_3-çº¯ç¨çæ°æ®ç±»",normalizedTitle:"3. çº¯ç¨çæ°æ®ç±»",charIndex:1778},{level:3,title:"3.1. é®é¢åå ",slug:"_3-1-é®é¢åå ",normalizedTitle:"3.1. é®é¢åå ",charIndex:1902},{level:3,title:"3.2. è§£å³æ¹æ³",slug:"_3-2-è§£å³æ¹æ³",normalizedTitle:"3.2. è§£å³æ¹æ³",charIndex:1998},{level:3,title:"3.3. æ¶ç",slug:"_3-3-æ¶ç",normalizedTitle:"3.3. æ¶ç",charIndex:2407},{level:3,title:"3.4. éææ¹æ³è¯´æ",slug:"_3-4-éææ¹æ³è¯´æ",normalizedTitle:"3.4. éææ¹æ³è¯´æ",charIndex:2486},{level:4,title:"3.4.1. å°è£å­æ®µ(Encapsulated Field)",slug:"_3-4-1-å°è£å­æ®µ-encapsulated-field",normalizedTitle:"3.4.1. å°è£å­æ®µ(encapsulated field)",charIndex:2501},{level:4,title:"3.4.2. å°è£éå(Encapsulated Collection)",slug:"_3-4-2-å°è£éå-encapsulated-collection",normalizedTitle:"3.4.2. å°è£éå(encapsulated collection)",charIndex:2779},{level:4,title:"3.4.3. æ¬ç§»å½æ°(Move Method)",slug:"_3-4-3-æ¬ç§»å½æ°-move-method",normalizedTitle:"3.4.3. æ¬ç§»å½æ°(move method)",charIndex:2884},{level:4,title:"3.4.4. æç¼å½æ°(Extract Method)",slug:"_3-4-4-æç¼å½æ°-extract-method",normalizedTitle:"3.4.4. æç¼å½æ°(extract method)",charIndex:3021},{level:4,title:"3.4.5. ç§»é¤è®¾ç½®å½æ°(Remove Setting Method)",slug:"_3-4-5-ç§»é¤è®¾ç½®å½æ°-remove-setting-method",normalizedTitle:"3.4.5. ç§»é¤è®¾ç½®å½æ°(remove setting method)",charIndex:3464},{level:4,title:"3.4.6. éèå½æ°(Hide Method)",slug:"_3-4-6-éèå½æ°-hide-method",normalizedTitle:"3.4.6. éèå½æ°(hide method)",charIndex:3560},{level:2,title:"4. è¿å¤çæ³¨é",slug:"_4-è¿å¤çæ³¨é",normalizedTitle:"4. è¿å¤çæ³¨é",charIndex:3641},{level:3,title:"4.1. é®é¢åå ",slug:"_4-1-é®é¢åå ",normalizedTitle:"4.1. é®é¢åå ",charIndex:3732},{level:3,title:"4.2. è§£å³æ¹æ³",slug:"_4-2-è§£å³æ¹æ³",normalizedTitle:"4.2. è§£å³æ¹æ³",charIndex:3871},{level:3,title:"4.3. æ¶ç",slug:"_4-3-æ¶ç",normalizedTitle:"4.3. æ¶ç",charIndex:4123},{level:3,title:"4.4. ä½æ¶å¿½ç¥",slug:"_4-4-ä½æ¶å¿½ç¥",normalizedTitle:"4.4. ä½æ¶å¿½ç¥",charIndex:4151},{level:3,title:"4.5. éææ¹æ³è¯´æ",slug:"_4-5-éææ¹æ³è¯´æ",normalizedTitle:"4.5. éææ¹æ³è¯´æ",charIndex:4233},{level:4,title:"4.5.1. æç¼åé(Extract Variable)",slug:"_4-5-1-æç¼åé-extract-variable",normalizedTitle:"4.5.1. æç¼åé(extract variable)",charIndex:4248},{level:4,title:"4.5.2. æç¼å½æ°(Extract Method)",slug:"_4-5-2-æç¼å½æ°-extract-method",normalizedTitle:"4.5.2. æç¼å½æ°(extract method)",charIndex:4822},{level:4,title:"4.5.3. å½æ°æ¹å(Rename Method)",slug:"_4-5-3-å½æ°æ¹å-rename-method",normalizedTitle:"4.5.3. å½æ°æ¹å(rename method)",charIndex:5265},{level:4,title:"4.5.4. å¼å¥æ­è¨(Introduce Assertion)",slug:"_4-5-4-å¼å¥æ­è¨-introduce-assertion",normalizedTitle:"4.5.4. å¼å¥æ­è¨(introduce assertion)",charIndex:5428},{level:2,title:"5. éå¤ä»£ç ",slug:"_5-éå¤ä»£ç ",normalizedTitle:"5. éå¤ä»£ç ",charIndex:6004},{level:3,title:"5.1. é®é¢åå ",slug:"_5-1-é®é¢åå ",normalizedTitle:"5.1. é®é¢åå ",charIndex:6077},{level:3,title:"5.2. è§£å³æ¹æ³",slug:"_5-2-è§£å³æ¹æ³",normalizedTitle:"5.2. è§£å³æ¹æ³",charIndex:6303},{level:3,title:"5.3. æ¶ç",slug:"_5-3-æ¶ç",normalizedTitle:"5.3. æ¶ç",charIndex:7134},{level:3,title:"5.4. éææ¹æ³è¯´æ",slug:"_5-4-éææ¹æ³è¯´æ",normalizedTitle:"5.4. éææ¹æ³è¯´æ",charIndex:7188},{level:4,title:"5.4.1. æç¼å½æ°(Extract Method)",slug:"_5-4-1-æç¼å½æ°-extract-method",normalizedTitle:"5.4.1. æç¼å½æ°(extract method)",charIndex:7203},{level:4,title:"5.4.2. å½æ°ä¸ç§»(Pull Up Method)",slug:"_5-4-2-å½æ°ä¸ç§»-pull-up-method",normalizedTitle:"5.4.2. å½æ°ä¸ç§»(pull up method)",charIndex:7646},{level:4,title:"5.4.3. æé å½æ°æ¬ä½ä¸ç§»(Pull Up Constructor Body)",slug:"_5-4-3-æé å½æ°æ¬ä½ä¸ç§»-pull-up-constructor-body",normalizedTitle:"5.4.3. æé å½æ°æ¬ä½ä¸ç§»(pull up constructor body)",charIndex:7723},{level:4,title:"5.4.4. å¡é æ¨¡æ¿å½æ°(Form Template Method)",slug:"_5-4-4-å¡é æ¨¡æ¿å½æ°-form-template-method",normalizedTitle:"5.4.4. å¡é æ¨¡æ¿å½æ°(form template method)",charIndex:8149},{level:4,title:"5.4.5. æ¿æ¢ç®æ³(Substitute Algorithm)",slug:"_5-4-5-æ¿æ¢ç®æ³-substitute-algorithm",normalizedTitle:"5.4.5. æ¿æ¢ç®æ³(substitute algorithm)",charIndex:8330},{level:4,title:"5.4.6. æç¼è¶ç±»(Extract Superclass)",slug:"_5-4-6-æç¼è¶ç±»-extract-superclass",normalizedTitle:"5.4.6. æç¼è¶ç±»(extract superclass)",charIndex:8949},{level:4,title:"5.4.7. æç¼ç±»(Extract Class)",slug:"_5-4-7-æç¼ç±»-extract-class",normalizedTitle:"5.4.7. æç¼ç±»(extract class)",charIndex:9031},{level:4,title:"5.4.8. åå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)",slug:"_5-4-8-åå¹¶æ¡ä»¶è¡¨è¾¾å¼-consolidate-conditional-expression",normalizedTitle:"5.4.8. åå¹¶æ¡ä»¶è¡¨è¾¾å¼(consolidate conditional expression)",charIndex:9112},{level:4,title:"5.4.9. åå¹¶éå¤çæ¡ä»¶çæ®µ(Consolidate Duplicate Conditional Fragments)",slug:"_5-4-9-åå¹¶éå¤çæ¡ä»¶çæ®µ-consolidate-duplicate-conditional-fragments",normalizedTitle:"5.4.9. åå¹¶éå¤çæ¡ä»¶çæ®µ(consolidate duplicate conditional fragments)",charIndex:9559},{level:2,title:"6. æ©å±éè¯»",slug:"_6-æ©å±éè¯»",normalizedTitle:"6. æ©å±éè¯»",charIndex:9873},{level:2,title:"7. åèèµæ",slug:"_7-åèèµæ",normalizedTitle:"7. åèèµæ",charIndex:9970}],headersStr:"1. åä½ç±» 1.1. é®é¢åå  1.2. è§£å³æ¹æ³ 1.3. æ¶ç 1.4. ä½æ¶å¿½ç¥ 1.5. éææ¹æ³è¯´æ 1.5.1. å°ç±»åèå(Inline Class) 1.5.2. æå ç»§æ¿ä½ç³»(Collapse Hierarchy) 2. å¤¸å¤¸å¶è°æªæ¥æ§ 2.1. é®é¢åå  2.2. è§£å³æ¹æ³ 2.3. æ¶ç 2.4. ä½æ¶å¿½ç¥ 2.5. éææ¹æ³è¯´æ 2.5.1. æå ç»§æ¿ä½ç³»(Collapse Hierarchy) 2.5.2. å°ç±»åèå(Inline Class) 2.5.3. åèå½æ°(Inline Method) 2.5.4. ç§»é¤åæ°(Remove Parameter) 3. çº¯ç¨çæ°æ®ç±» 3.1. é®é¢åå  3.2. è§£å³æ¹æ³ 3.3. æ¶ç 3.4. éææ¹æ³è¯´æ 3.4.1. å°è£å­æ®µ(Encapsulated Field) 3.4.2. å°è£éå(Encapsulated Collection) 3.4.3. æ¬ç§»å½æ°(Move Method) 3.4.4. æç¼å½æ°(Extract Method) 3.4.5. ç§»é¤è®¾ç½®å½æ°(Remove Setting Method) 3.4.6. éèå½æ°(Hide Method) 4. è¿å¤çæ³¨é 4.1. é®é¢åå  4.2. è§£å³æ¹æ³ 4.3. æ¶ç 4.4. ä½æ¶å¿½ç¥ 4.5. éææ¹æ³è¯´æ 4.5.1. æç¼åé(Extract Variable) 4.5.2. æç¼å½æ°(Extract Method) 4.5.3. å½æ°æ¹å(Rename Method) 4.5.4. å¼å¥æ­è¨(Introduce Assertion) 5. éå¤ä»£ç  5.1. é®é¢åå  5.2. è§£å³æ¹æ³ 5.3. æ¶ç 5.4. éææ¹æ³è¯´æ 5.4.1. æç¼å½æ°(Extract Method) 5.4.2. å½æ°ä¸ç§»(Pull Up Method) 5.4.3. æé å½æ°æ¬ä½ä¸ç§»(Pull Up Constructor Body) 5.4.4. å¡é æ¨¡æ¿å½æ°(Form Template Method) 5.4.5. æ¿æ¢ç®æ³(Substitute Algorithm) 5.4.6. æç¼è¶ç±»(Extract Superclass) 5.4.7. æç¼ç±»(Extract Class) 5.4.8. åå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression) 5.4.9. åå¹¶éå¤çæ¡ä»¶çæ®µ(Consolidate Duplicate Conditional Fragments) 6. æ©å±éè¯» 7. åèèµæ",content:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/dispensables\n> \n> éå¿è¦ç(Dispensables)è¿ç»åå³éæå³çï¼è¿æ ·çä»£ç å¯æå¯æ ï¼å®çå­å¨åèå½±åæ´ä½ä»£ç çæ´æ´åå¯è¯»æ§ã\n\n\n# 1. åä½ç±»\n\n> åä½ç±»(Lazy Class)\n> \n> çè§£åç»´æ¤æ»æ¯è´¹æ¶è´¹åçãå¦æä¸ä¸ªç±»ä¸å¼å¾ä½ è±è´¹ç²¾åï¼å®å°±åºè¯¥è¢«å é¤ã\n\n\n\n\n# 1.1. é®é¢åå \n\nä¹è®¸ä¸ä¸ªç±»çåå§è®¾è®¡æ¯ä¸ä¸ªåè½å®å¨çç±»ï¼ç¶èéçä»£ç çåè¿ï¼åå¾æ²¡ä»ä¹ç¨äºã åæèç±»èµ·åçè®¾è®¡æ¯ä¸ºäºæ¯ææªæ¥çåè½æ©å±ï¼ç¶èå´ä¸ç´æªæ´¾ä¸ç¨åºã\n\n\n# 1.2. è§£å³æ¹æ³\n\n * æ²¡ä»ä¹ç¨çç±»å¯ä»¥è¿ç¨ å°ç±»åèå(Inline Class) æ¥å¹²æã\n\n\n\n * å¦æå­ç±»ç¨å¤ä¸å¤§ï¼è¯è¯ æå ç»§æ¿ä½ç³»(Collapse Hierarchy) ã\n\n\n# 1.3. æ¶ç\n\n * åå°ä»£ç é\n * æäºç»´æ¤\n\n\n# 1.4. ä½æ¶å¿½ç¥\n\n * ææ¶ï¼åå»ºåä½ç±»æ¯ä¸ºäºæè¿°æªæ¥å¼åçæå¾ãå¨è¿ç§æåµä¸ï¼å°è¯å¨ä»£ç ä¸­ä¿ææ¸æ°åç®åä¹é´çå¹³è¡¡ã\n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. å°ç±»åèå(Inline Class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n# 1.5.2. æå ç»§æ¿ä½ç³»(Collapse Hierarchy)\n\né®é¢\n\nè¶ç±»åå­ç±»ä¹é´æ å¤ªå¤§åºå«ã\n\n\n\nè§£å³\n\nå°å®ä»¬åä¸ºä¸ä½ã\n\n\n\n\n# 2. å¤¸å¤¸å¶è°æªæ¥æ§\n\n> å¤¸å¤¸å¶è°æªæ¥æ§(Speculative Generality)\n> \n> å­å¨æªè¢«ä½¿ç¨çç±»ãå½æ°ãå­æ®µæåæ°ã\n\n\n\n\n# 2.1. é®é¢åå \n\nææ¶ï¼ä»£ç ä»ä»ä¸ºäºæ¯ææªæ¥çç¹æ§èäº§çï¼ç¶èå´ä¸ç´æªå®ç°ãç»æï¼ä»£ç åå¾é¾ä»¥çè§£åç»´æ¤ã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * å¦æä½ çæä¸ªæ½è±¡ç±»å¶å®æ²¡æå¤ªå¤§ä½ç¨ï¼è¯·è¿ç¨ æå ç»§æ¿ä½ç³»(Collapse Hierarch) ã\n\n\n\n * ä¸å¿è¦çå§æå¯è¿ç¨ å°ç±»åèå(Inline Class) æ¶é¤ã\n * æ ç¨çå½æ°å¯è¿ç¨ åèå½æ°(Inline Method) æ¶é¤ã\n * å½æ°ä¸­ææ ç¨çåæ°åºè¯¥è¿ç¨ ç§»é¤åæ°(Remove Parameter) æ¶é¤ã\n * æ ç¨å­æ®µå¯ä»¥ç´æ¥å é¤ã\n\n\n# 2.3. æ¶ç\n\n * åå°ä»£ç éã\n * æ´æç»´æ¤ã\n\n\n# 2.4. ä½æ¶å¿½ç¥\n\n * å¦æä½ å¨ä¸ä¸ªæ¡æ¶ä¸å·¥ä½ï¼åå»ºæ¡æ¶æ¬èº«æ²¡æä½¿ç¨çåè½æ¯éå¸¸åççï¼åªè¦æ¡æ¶çç¨æ·éè¦è¿ä¸ªåè½ã\n * å é¤åç´ ä¹åï¼è¯·ç¡®ä¿å®ä»¬ä¸å¨ååæµè¯ä¸­ä½¿ç¨ãå¦ææµè¯éè¦ä»ç±»ä¸­è·åæäºåé¨ä¿¡æ¯ææ§è¡ç¹æ®çæµè¯ç¸å³æä½ï¼å°±ä¼åçè¿ç§æåµã\n\n\n# 2.5. éææ¹æ³è¯´æ\n\n# 2.5.1. æå ç»§æ¿ä½ç³»(Collapse Hierarchy)\n\né®é¢\n\nè¶ç±»åå­ç±»ä¹é´æ å¤ªå¤§åºå«ã\n\n\n\nè§£å³\n\nå°å®ä»¬åä¸ºä¸ä½ã\n\n\n\n# 2.5.2. å°ç±»åèå(Inline Class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n# 2.5.3. åèå½æ°(Inline Method)\n\né®é¢\n\nä¸ä¸ªå½æ°çæ¬ä½æ¯å½æ°åæ´æ¸æ¥ææã\n\nclass PizzaDelivery {\n  //...\n  int getRating() {\n    return moreThanFiveLateDeliveries() ? 2 : 1;\n  }\n  boolean moreThanFiveLateDeliveries() {\n    return numberOfLateDeliveries > 5;\n  }\n}\n\n\nè§£å³\n\nå¨å½æ°è°ç¨ç¹æå¥å½æ°æ¬ä½ï¼ç¶åç§»é¤è¯¥å½æ°ã\n\nclass PizzaDelivery {\n  //...\n  int getRating() {\n    return numberOfLateDeliveries > 5 ? 2 : 1;\n  }\n}\n\n\n# 2.5.4. ç§»é¤åæ°(Remove Parameter)\n\né®é¢\n\nå½æ°æ¬ä½ä¸åéè¦æä¸ªåæ°ã\n\n\n\nè§£å³\n\nå°è¯¥åæ°å»é¤ã\n\n\n\n\n# 3. çº¯ç¨çæ°æ®ç±»\n\n> çº¯ç¨çæ°æ®ç±»(Data Class) æçæ¯åªåå«å­æ®µåè®¿é®å®ä»¬ç getter å setter å½æ°çç±»ãè¿äºä»ä»æ¯ä¾å¶ä»ç±»ä½¿ç¨çæ°æ®å®¹å¨ãè¿äºç±»ä¸åå«ä»»ä½éå åè½ï¼å¹¶ä¸ä¸è½å¯¹èªå·±æ¥æçæ°æ®è¿è¡ç¬ç«æä½ã\n\n\n\n\n# 3.1. é®é¢åå \n\nå½ä¸ä¸ªæ°åå»ºçç±»åªåå«å ä¸ªå¬å±å­æ®µï¼çè³å¯è½å ä¸ª getters / settersï¼æ¯å¾æ­£å¸¸çãä½æ¯å¯¹è±¡ççæ­£åéå¨äºå®ä»¬å¯ä»¥åå«ä½ç¨äºæ°æ®çè¡ä¸ºç±»åææä½ã\n\n\n# 3.2. è§£å³æ¹æ³\n\n * å¦æä¸ä¸ªç±»æå¬å±å­æ®µï¼ä½ åºè¯¥è¿ç¨ å°è£å­æ®µ(Encapsulated Field) æ¥éèå­æ®µçç´æ¥è®¿é®æ¹å¼ã\n * å¦æè¿äºç±»å«å®¹å¨ç±»çå­æ®µï¼ä½ åºè¯¥æ£æ¥å®ä»¬æ¯ä¸æ¯å¾å°äºæ°å½çå°è£ï¼å¦ææ²¡æï¼å°±è¿ç¨ å°è£éå(Encapsulated Collection) æå®ä»¬å°è£èµ·æ¥ã\n * æ¾åºè¿äº getter/setter å½æ°è¢«å¶ä»ç±»è¿ç¨çå°ç¹ãå°è¯ä»¥ æ¬ç§»å½æ°(Move Method) æé£äºè°ç¨è¡ä¸ºæ¬ç§»å° çº¯ç¨çæ°æ®ç±»(Data Class) æ¥ãå¦ææ æ³æ¬ç§»è¿ä¸ªå½æ°ï¼å°±è¿ç¨ æç¼å½æ°(Extract Method) äº§çä¸ä¸ªå¯æ¬ç§»çå½æ°ã\n\n\n\n * å¨ç±»å·²ç»åæ»¡äºæ·±æçèçå½æ°ä¹åï¼ä½ å¯è½æ³è¦æè±æ§çæ°æ®è®¿é®æ¹æ³ï¼ä»¥æä¾éåºé¢è¾å¹¿çç±»æ°æ®è®¿é®æ¥å£ãä¸ºæ­¤ï¼å¯ä»¥è¿ç¨ ç§»é¤è®¾ç½®å½æ°(Remove Setting Method) å éèå½æ°(Hide Method) ã\n\n\n# 3.3. æ¶ç\n\n * æé«ä»£ç çå¯è¯»æ§åç»ç»æ§ãç¹å®æ°æ®çæä½ç°å¨è¢«éä¸­å¨ä¸ä¸ªå°æ¹ï¼èä¸æ¯å¨åæ£å¨ä»£ç åå¤ã\n * å¸®å©ä½ åç°å®¢æ·ç«¯ä»£ç çéå¤å¤ã\n\n\n# 3.4. éææ¹æ³è¯´æ\n\n# 3.4.1. å°è£å­æ®µ(Encapsulated Field)\n\né®é¢\n\nä½ çç±»ä¸­å­å¨ public å­æ®µã\n\nclass Person {\n  public String name;\n}\n\n\nè§£å³\n\nå°å®å£°æä¸º privateï¼å¹¶æä¾ç¸åºçè®¿é®å½æ°ã\n\nclass Person {\n  private String name;\n\n  public String getName() {\n    return name;\n  }\n  public void setName(String arg) {\n    name = arg;\n  }\n}\n\n\n# 3.4.2. å°è£éå(Encapsulated Collection)\n\né®é¢\n\næä¸ªå½æ°è¿åä¸ä¸ªéåã\n\n\n\nè§£å³\n\nè®©è¯¥å½æ°è¿åè¯¥éåçä¸ä¸ªåªè¯»å¯æ¬ï¼å¹¶å¨è¿ä¸ªç±»ä¸­æä¾æ·»å ãç§»é¤éååç´ çå½æ°ã\n\n\n\n# 3.4.3. æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.4.4. æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# 3.4.5. ç§»é¤è®¾ç½®å½æ°(Remove Setting Method)\n\né®é¢\n\nç±»ä¸­çæä¸ªå­æ®µåºè¯¥å¨å¯¹è±¡åå»ºæ¶è¢«è®¾å¼ï¼ç¶åå°±ä¸åæ¹åã\n\n\n\nè§£å³\n\nå»æè¯¥å­æ®µçææè®¾å¼å½æ°ã\n\n\n\n# 3.4.6. éèå½æ°(Hide Method)\n\né®é¢\n\næä¸ä¸ªå½æ°ï¼ä»æ¥æ²¡æè¢«å¶ä»ä»»ä½ç±»ç¨å°ã\n\n\n\nè§£å³\n\nå°è¿ä¸ªå½æ°ä¿®æ¹ä¸º privateã\n\n\n\n\n# 4. è¿å¤çæ³¨é\n\n> è¿å¤çæ³¨é(Comments)\n> \n> æ³¨éæ¬èº«å¹¶ä¸æ¯åäºãä½æ¯å¸¸å¸¸æè¿æ ·çæåµï¼ä¸æ®µä»£ç ä¸­åºç°é¿é¿çæ³¨éï¼èå®ä¹æä»¥å­å¨ï¼æ¯å ä¸ºä»£ç å¾ç³ç³ã\n\n\n\n\n# 4.1. é®é¢åå \n\næ³¨éçä½èæè¯å°èªå·±çä»£ç ä¸ç´è§æä¸ææ¾ï¼æä»¥æ³ä½¿ç¨æ³¨éæ¥è¯´æèªå·±çæå¾ãè¿ç§æåµä¸ï¼æ³¨éå°±åæ¯çä»£ç çé¤è­åã\n\n> æå¥½çæ³¨éæ¯ä¸ºå½æ°æç±»èµ·ä¸ä¸ªæ°å½çåå­ã\n\nå¦æä½ è§å¾ä¸ä¸ªä»£ç çæ®µæ²¡ææ³¨éå°±æ æ³çè§£ï¼è¯·åå°è¯éæï¼è¯çè®©æææ³¨éé½åå¾å¤ä½ã\n\n\n# 4.2. è§£å³æ¹æ³\n\n * å¦æä¸ä¸ªæ³¨éæ¯ä¸ºäºè§£éä¸ä¸ªå¤æçè¡¨è¾¾å¼ï¼å¯ä»¥è¿ç¨ æç¼åé(Extract Variable) å°è¡¨è¾¾å¼ååä¸ºæçè§£çå­è¡¨è¾¾å¼ã\n * å¦æä½ éè¦éè¿æ³¨éæ¥è§£éä¸æ®µä»£ç åäºä»ä¹ï¼è¯·è¯è¯ æç¼å½æ°(Extract Method) ã\n * å¦æå½æ°å·²ç»è¢«æç¼ï¼ä½ä»éè¦æ³¨éå½æ°åäºä»ä¹ï¼è¯è¯è¿ç¨ å½æ°æ¹å(Rename Method) æ¥ä¸ºå½æ°èµ·ä¸ä¸ªå¯ä»¥èªè§£éçåå­ã\n * å¦æéè¦å¯¹ç³»ç»æç¶æè¿è¡æ­è¨ï¼è¯·è¿ç¨ å¼å¥æ­è¨(Introduce Assertion) ã\n\n\n# 4.3. æ¶ç\n\n * ä»£ç åå¾æ´ç´è§åææ¾ã\n\n\n# 4.4. ä½æ¶å¿½ç¥\n\næ³¨éææ¶åå¾æç¨ï¼\n\n * å½è§£éä¸ºä»ä¹æäºç©è¦ä»¥ç¹æ®æ¹å¼å®ç°æ¶ã\n * å½è§£éæç§å¤æç®æ³æ¶ã\n * å½ä½ å®å¨ä¸ç¥å¯ä»¥åäºä»ä¹æ¶ã\n\n\n# 4.5. éææ¹æ³è¯´æ\n\n# 4.5.1. æç¼åé(Extract Variable)\n\né®é¢\n\nä½ æä¸ªé¾ä»¥çè§£çè¡¨è¾¾å¼ã\n\nvoid renderBanner() {\n  if ((platform.toUpperCase().indexOf("MAC") > -1) &&\n       (browser.toUpperCase().indexOf("IE") > -1) &&\n        wasInitialized() && resize > 0 )\n  {\n    // do something\n  }\n}\n\n\nè§£å³\n\nå°è¡¨è¾¾å¼çç»ææå®çå­è¡¨è¾¾å¼çç»æç¨ä¸è¨èªæçåéæ¥æ¿ä»£ã\n\nvoid renderBanner() {\n  final boolean isMacOs = platform.toUpperCase().indexOf("MAC") > -1;\n  final boolean isIE = browser.toUpperCase().indexOf("IE") > -1;\n  final boolean wasResized = resize > 0;\n\n  if (isMacOs && isIE && wasInitialized() && wasResized) {\n    // do something\n  }\n}\n\n\n# 4.5.2. æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# 4.5.3. å½æ°æ¹å(Rename Method)\n\né®é¢\n\nå½æ°çåç§°æªè½æ°å½çæ­ç¤ºå½æ°çç¨éã\n\nclass Person {\n  public String getsnm();\n}\n\n\nè§£å³\n\nä¿®æ¹å½æ°åã\n\nclass Person {\n  public String getSecondName();\n}\n\n\n# 4.5.4. å¼å¥æ­è¨(Introduce Assertion)\n\né®é¢\n\næä¸æ®µä»£ç éè¦å¯¹ç¨åºç¶æååºæç§åè®¾ã\n\ndouble getExpenseLimit() {\n  // should have either expense limit or a primary project\n  return (expenseLimit != NULL_EXPENSE) ?\n    expenseLimit:\n    primaryProject.getMemberExpenseLimit();\n}\n\n\nè§£å³\n\nä»¥æ­è¨æç¡®è¡¨ç°è¿ç§åè®¾ã\n\ndouble getExpenseLimit() {\n  Assert.isTrue(expenseLimit != NULL_EXPENSE || primaryProject != null);\n\n  return (expenseLimit != NULL_EXPENSE) ?\n    expenseLimit:\n    primaryProject.getMemberExpenseLimit();\n}\n\n\næ³¨ï¼è¯·ä¸è¦æ»¥ç¨æ­è¨ãä¸è¦ä½¿ç¨å®æ¥æ£æ¥âåºè¯¥ä¸ºçâçæ¡ä»¶ï¼åªè½ä½¿ç¨å®æ¥æ£æ¥âä¸å®å¿é¡»ä¸ºçâçæ¡ä»¶ãå®éä¸ï¼æ­è¨æ´å¤æ¯ç¨äºèªææ£æµä»£ç çä¸ç§ææ®µãå¨äº§åçæ­£äº¤ä»æ¶ï¼å¾å¾é½ä¼æ¶é¤æææ­è¨ã\n\n\n# 5. éå¤ä»£ç \n\n> éå¤ä»£ç (Duplicate Code)\n> \n> éå¤ä»£ç å ªç§°ä¸ºä»£ç åå³éä¹é¦ãæ¶é¤éå¤ä»£ç æ»æ¯æå©æ å®³çã\n\n\n\n\n# 5.1. é®é¢åå \n\néå¤ä»£ç éå¸¸åçå¨å¤ä¸ªç¨åºååæ¶å¨åä¸ç¨åºçä¸åé¨åä¸å·¥ä½æ¶ãç±äºä»ä»¬æ­£å¨å¤çä¸åçä»»å¡ï¼ä»ä»¬å¯è½ä¸ç¥éä»ä»¬çåäºå·²ç»åäºç±»ä¼¼çä»£ç ã\n\nè¿æä¸ç§æ´éæ¦çéå¤ï¼ç¹å®é¨åçä»£ç çä¸å»ä¸åä½å®éå¨ååä¸ä»¶äºãè¿ç§éå¤ä»£ç å¾å¾é¾ä»¥æ¾å°åæ¶é¤ã\n\nææ¶éå¤æ¯æç®çæ§çãå½æ¥äºæ»¡è¶³ deadlineï¼å¹¶ä¸ç°æä»£ç å¯¹äºè¦äº¤ä»çä»»å¡æ¯âå ä¹æ­£ç¡®çâæ¶ï¼æ°æç¨åºåå¯è½æ æ³æµæå¤å¶åç²è´´ç¸å³ä»£ç çè¯±æãå¨æäºæåµä¸ï¼ç¨åºååªæ¯å¤ªææ°ã\n\n\n# 5.2. è§£å³æ¹æ³\n\n * åä¸ä¸ªç±»çä¸¤ä¸ªå½æ°å«æç¸åçè¡¨è¾¾å¼ï¼è¿æ¶å¯ä»¥éç¨ æç¼å½æ°(Extract Method) æç¼åºéå¤çä»£ç ï¼ç¶åè®©è¿ä¸¤ä¸ªå°ç¹é½è°ç¨è¢«æç¼åºæ¥çé£æ®µä»£ç ã\n\n\n\n * å¦æä¸¤ä¸ªäºä¸ºåå¼çå­ç±»å«æéå¤ä»£ç ï¼\n   * é¦åå¯¹ä¸¤ä¸ªç±»é½è¿ç¨ æç¼å½æ°(Extract Method) ï¼ç¶åå¯¹è¢«æç¼åºæ¥çå½æ°è¿ç¨ å½æ°ä¸ç§»(Pull Up Method) ï¼å°å®æ¨å¥è¶ç±»ã\n   * å¦æéå¤ä»£ç å¨æé å½æ°ä¸­ï¼è¿ç¨ æé å½æ°æ¬ä½ä¸ç§»(Pull Up Constructor Body) ã\n   * å¦æéå¤ä»£ç åªæ¯ç¸ä¼¼ä½ä¸æ¯å®å¨ç¸åï¼è¿ç¨ å¡é æ¨¡æ¿å½æ°(Form Template Method) è·å¾ä¸ä¸ª æ¨¡æ¿æ¹æ³æ¨¡å¼(Template Method) ã\n   * å¦ææäºå½æ°ä»¥ä¸åçç®æ³åç¸åçäºï¼ä½ å¯ä»¥éæ©å¶ä¸­è¾æ¸æ°å°ä¸ä¸ªï¼å¹¶è¿ç¨ æ¿æ¢ç®æ³(Substitute Algorithm) å°å¶ä»å½æ°çç®æ³æ¿æ¢æã\n * å¦æä¸¤ä¸ªæ¯«ä¸ç¸å³çç±»ä¸­æéå¤ä»£ç ï¼\n   * è¯·å°è¯è¿ç¨ æç¼è¶ç±»(Extract Superclass) ï¼ä»¥ä¾¿ä¸ºç»´æ¤ææåååè½çè¿äºç±»åå»ºä¸ä¸ªè¶ç±»ã\n   * å¦æåå»ºè¶ç±»ååå°é¾ï¼å¯ä»¥å¨ä¸ä¸ªç±»ä¸­è¿ç¨ æç¼ç±»(Extract Class) ï¼å¹¶å¨å¦ä¸ä¸ªç±»ä¸­ä½¿ç¨è¿ä¸ªæ°çç»ä»¶ã\n * å¦æå­å¨å¤§éçæ¡ä»¶è¡¨è¾¾å¼ï¼å¹¶ä¸å®ä»¬æ§è¡å®å¨ç¸åçä»£ç ï¼ä»ä»æ¯å®ä»¬çæ¡ä»¶ä¸åï¼ï¼å¯ä»¥è¿ç¨ åå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression) å°è¿äºæä½åå¹¶ä¸ºåä¸ªæ¡ä»¶ï¼å¹¶è¿ç¨ æç¼å½æ°(Extract Method) å°è¯¥æ¡ä»¶æ¾å¥ä¸ä¸ªåå­å®¹æçè§£çç¬ç«å½æ°ä¸­ã\n * å¦ææ¡ä»¶è¡¨è¾¾å¼çææåæ¯é½æé¨åç¸åçä»£ç çæ®µï¼å¯ä»¥è¿ç¨ åå¹¶éå¤çæ¡ä»¶çæ®µ(Consolidate Duplicate Conditional Fragments) å°å®ä»¬é½å­å¨çä»£ç çæ®µç½®äºæ¡ä»¶è¡¨è¾¾å¼å¤é¨ã\n\n\n# 5.3. æ¶ç\n\n * åå¹¶éå¤ä»£ç ä¼ç®åä»£ç çç»æï¼å¹¶åå°ä»£ç éã\n * ä»£ç æ´ç®åãæ´æç»´æ¤ã\n\n\n# 5.4. éææ¹æ³è¯´æ\n\n# 5.4.1. æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# 5.4.2. å½æ°ä¸ç§»(Pull Up Method)\n\né®é¢\n\næäºå½æ°ï¼å¨åä¸ªå­ç±»ä¸­äº§çå®å¨ç¸åçç»æã\n\n\n\nè§£å³\n\nå°è¯¥å½æ°ç§»è³è¶ç±»ã\n\n\n\n# 5.4.3. æé å½æ°æ¬ä½ä¸ç§»(Pull Up Constructor Body)\n\né®é¢\n\nä½ å¨åä¸ªå­ç±»ä¸­æ¥æä¸äºæé å½æ°ï¼å®ä»¬çæ¬ä½å ä¹å®å¨ä¸è´ã\n\nclass Manager extends Employee {\n  public Manager(String name, String id, int grade) {\n    this.name = name;\n    this.id = id;\n    this.grade = grade;\n  }\n  //...\n}\n\n\nè§£å³\n\nå¨è¶ç±»ä¸­æ°å»ºä¸ä¸ªæé å½æ°ï¼å¹¶å¨å­ç±»æé å½æ°ä¸­è°ç¨å®ã\n\nclass Manager extends Employee {\n  public Manager(String name, String id, int grade) {\n    super(name, id);\n    this.grade = grade;\n  }\n  //...\n}\n\n\n# 5.4.4. å¡é æ¨¡æ¿å½æ°(Form Template Method)\n\né®é¢\n\nä½ æä¸äºå­ç±»ï¼å¶ä¸­ç¸åºçæäºå½æ°ä»¥ç¸åçé¡ºåºæ§è¡ç±»ä¼¼çæä½ï¼ä½åä¸ªæä½çç»èä¸ææä¸åã\n\n\n\nè§£å³\n\nå°è¿äºæä½åå«æ¾è¿ç¬ç«å½æ°ä¸­ï¼å¹¶ä¿æå®ä»¬é½æç¸åçç­¾åï¼äºæ¯åå½æ°ä¹å°±åå¾ç¸åäºãç¶åå°åå½æ°ä¸ç§»è³è¶ç±»ã\n\n\n\næ³¨ï¼è¿éåªæå°å·ä½åæ³ï¼å»ºè®®äºè§£ä¸ä¸æ¨¡æ¿æ¹æ³è®¾è®¡æ¨¡å¼ã\n\n# 5.4.5. æ¿æ¢ç®æ³(Substitute Algorithm)\n\né®é¢\n\nä½ æ³è¦ææä¸ªç®æ³æ¿æ¢ä¸ºå¦ä¸ä¸ªæ´æ¸æ°çç®æ³ã\n\nString foundPerson(String[] people){\n  for (int i = 0; i < people.length; i++) {\n    if (people[i].equals("Don")){\n      return "Don";\n    }\n    if (people[i].equals("John")){\n      return "John";\n    }\n    if (people[i].equals("Kent")){\n      return "Kent";\n    }\n  }\n  return "";\n}\n\n\nè§£å³\n\nå°å½æ°æ¬ä½æ¿æ¢ä¸ºå¦ä¸ä¸ªç®æ³ã\n\nString foundPerson(String[] people){\n  List candidates =\n    Arrays.asList(new String[] {"Don", "John", "Kent"});\n  for (int i=0; i < people.length; i++) {\n    if (candidates.contains(people[i])) {\n      return people[i];\n    }\n  }\n  return "";\n}\n\n\n# 5.4.6. æç¼è¶ç±»(Extract Superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n# 5.4.7. æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 5.4.8. åå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)\n\né®é¢\n\nä½ æä¸ç³»åæ¡ä»¶åæ¯ï¼é½å¾å°ç¸åç»æã\n\ndouble disabilityAmount() {\n  if (seniority < 2) {\n    return 0;\n  }\n  if (monthsDisabled > 12) {\n    return 0;\n  }\n  if (isPartTime) {\n    return 0;\n  }\n  // compute the disability amount\n  //...\n}\n\n\nè§£å³\n\nå°è¿äºæ¡ä»¶åæ¯åå¹¶ä¸ºä¸ä¸ªæ¡ä»¶ï¼å¹¶å°è¿ä¸ªæ¡ä»¶æç¼ä¸ºä¸ä¸ªç¬ç«å½æ°ã\n\ndouble disabilityAmount() {\n  if (isNotEligableForDisability()) {\n    return 0;\n  }\n  // compute the disability amount\n  //...\n}\n\n\n# 5.4.9. åå¹¶éå¤çæ¡ä»¶çæ®µ(Consolidate Duplicate Conditional Fragments)\n\né®é¢\n\nå¨æ¡ä»¶è¡¨è¾¾å¼çæ¯ä¸ªåæ¯ä¸æçç¸åçä¸æ®µä»£ç ã\n\nif (isSpecialDeal()) {\n  total = price * 0.95;\n  send();\n}\nelse {\n  total = price * 0.98;\n  send();\n}\n\n\nè§£å³\n\nå°è¿æ®µéå¤ä»£ç æ¬ç§»å°æ¡ä»¶è¡¨è¾¾å¼ä¹å¤ã\n\nif (isSpecialDeal()) {\n  total = price * 0.95;\n}\nelse {\n  total = price * 0.98;\n}\nsend();\n\n\n\n# 6. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 7. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',normalizedContent:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/dispensables\n> \n> éå¿è¦ç(dispensables)è¿ç»åå³éæå³çï¼è¿æ ·çä»£ç å¯æå¯æ ï¼å®çå­å¨åèå½±åæ´ä½ä»£ç çæ´æ´åå¯è¯»æ§ã\n\n\n# 1. åä½ç±»\n\n> åä½ç±»(lazy class)\n> \n> çè§£åç»´æ¤æ»æ¯è´¹æ¶è´¹åçãå¦æä¸ä¸ªç±»ä¸å¼å¾ä½ è±è´¹ç²¾åï¼å®å°±åºè¯¥è¢«å é¤ã\n\n\n\n\n# 1.1. é®é¢åå \n\nä¹è®¸ä¸ä¸ªç±»çåå§è®¾è®¡æ¯ä¸ä¸ªåè½å®å¨çç±»ï¼ç¶èéçä»£ç çåè¿ï¼åå¾æ²¡ä»ä¹ç¨äºã åæèç±»èµ·åçè®¾è®¡æ¯ä¸ºäºæ¯ææªæ¥çåè½æ©å±ï¼ç¶èå´ä¸ç´æªæ´¾ä¸ç¨åºã\n\n\n# 1.2. è§£å³æ¹æ³\n\n * æ²¡ä»ä¹ç¨çç±»å¯ä»¥è¿ç¨ å°ç±»åèå(inline class) æ¥å¹²æã\n\n\n\n * å¦æå­ç±»ç¨å¤ä¸å¤§ï¼è¯è¯ æå ç»§æ¿ä½ç³»(collapse hierarchy) ã\n\n\n# 1.3. æ¶ç\n\n * åå°ä»£ç é\n * æäºç»´æ¤\n\n\n# 1.4. ä½æ¶å¿½ç¥\n\n * ææ¶ï¼åå»ºåä½ç±»æ¯ä¸ºäºæè¿°æªæ¥å¼åçæå¾ãå¨è¿ç§æåµä¸ï¼å°è¯å¨ä»£ç ä¸­ä¿ææ¸æ°åç®åä¹é´çå¹³è¡¡ã\n\n\n# 1.5. éææ¹æ³è¯´æ\n\n# 1.5.1. å°ç±»åèå(inline class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n# 1.5.2. æå ç»§æ¿ä½ç³»(collapse hierarchy)\n\né®é¢\n\nè¶ç±»åå­ç±»ä¹é´æ å¤ªå¤§åºå«ã\n\n\n\nè§£å³\n\nå°å®ä»¬åä¸ºä¸ä½ã\n\n\n\n\n# 2. å¤¸å¤¸å¶è°æªæ¥æ§\n\n> å¤¸å¤¸å¶è°æªæ¥æ§(speculative generality)\n> \n> å­å¨æªè¢«ä½¿ç¨çç±»ãå½æ°ãå­æ®µæåæ°ã\n\n\n\n\n# 2.1. é®é¢åå \n\nææ¶ï¼ä»£ç ä»ä»ä¸ºäºæ¯ææªæ¥çç¹æ§èäº§çï¼ç¶èå´ä¸ç´æªå®ç°ãç»æï¼ä»£ç åå¾é¾ä»¥çè§£åç»´æ¤ã\n\n\n# 2.2. è§£å³æ¹æ³\n\n * å¦æä½ çæä¸ªæ½è±¡ç±»å¶å®æ²¡æå¤ªå¤§ä½ç¨ï¼è¯·è¿ç¨ æå ç»§æ¿ä½ç³»(collapse hierarch) ã\n\n\n\n * ä¸å¿è¦çå§æå¯è¿ç¨ å°ç±»åèå(inline class) æ¶é¤ã\n * æ ç¨çå½æ°å¯è¿ç¨ åèå½æ°(inline method) æ¶é¤ã\n * å½æ°ä¸­ææ ç¨çåæ°åºè¯¥è¿ç¨ ç§»é¤åæ°(remove parameter) æ¶é¤ã\n * æ ç¨å­æ®µå¯ä»¥ç´æ¥å é¤ã\n\n\n# 2.3. æ¶ç\n\n * åå°ä»£ç éã\n * æ´æç»´æ¤ã\n\n\n# 2.4. ä½æ¶å¿½ç¥\n\n * å¦æä½ å¨ä¸ä¸ªæ¡æ¶ä¸å·¥ä½ï¼åå»ºæ¡æ¶æ¬èº«æ²¡æä½¿ç¨çåè½æ¯éå¸¸åççï¼åªè¦æ¡æ¶çç¨æ·éè¦è¿ä¸ªåè½ã\n * å é¤åç´ ä¹åï¼è¯·ç¡®ä¿å®ä»¬ä¸å¨ååæµè¯ä¸­ä½¿ç¨ãå¦ææµè¯éè¦ä»ç±»ä¸­è·åæäºåé¨ä¿¡æ¯ææ§è¡ç¹æ®çæµè¯ç¸å³æä½ï¼å°±ä¼åçè¿ç§æåµã\n\n\n# 2.5. éææ¹æ³è¯´æ\n\n# 2.5.1. æå ç»§æ¿ä½ç³»(collapse hierarchy)\n\né®é¢\n\nè¶ç±»åå­ç±»ä¹é´æ å¤ªå¤§åºå«ã\n\n\n\nè§£å³\n\nå°å®ä»¬åä¸ºä¸ä½ã\n\n\n\n# 2.5.2. å°ç±»åèå(inline class)\n\né®é¢\n\næä¸ªç±»æ²¡æåå¤ªå¤äºæã\n\n\n\nè§£å³\n\nå°è¿ä¸ªç±»çææç¹æ§æ¬ç§»å°å¦ä¸ä¸ªç±»ä¸­ï¼ç¶åç§»é¤åç±»ã\n\n\n\n# 2.5.3. åèå½æ°(inline method)\n\né®é¢\n\nä¸ä¸ªå½æ°çæ¬ä½æ¯å½æ°åæ´æ¸æ¥ææã\n\nclass pizzadelivery {\n  //...\n  int getrating() {\n    return morethanfivelatedeliveries() ? 2 : 1;\n  }\n  boolean morethanfivelatedeliveries() {\n    return numberoflatedeliveries > 5;\n  }\n}\n\n\nè§£å³\n\nå¨å½æ°è°ç¨ç¹æå¥å½æ°æ¬ä½ï¼ç¶åç§»é¤è¯¥å½æ°ã\n\nclass pizzadelivery {\n  //...\n  int getrating() {\n    return numberoflatedeliveries > 5 ? 2 : 1;\n  }\n}\n\n\n# 2.5.4. ç§»é¤åæ°(remove parameter)\n\né®é¢\n\nå½æ°æ¬ä½ä¸åéè¦æä¸ªåæ°ã\n\n\n\nè§£å³\n\nå°è¯¥åæ°å»é¤ã\n\n\n\n\n# 3. çº¯ç¨çæ°æ®ç±»\n\n> çº¯ç¨çæ°æ®ç±»(data class) æçæ¯åªåå«å­æ®µåè®¿é®å®ä»¬ç getter å setter å½æ°çç±»ãè¿äºä»ä»æ¯ä¾å¶ä»ç±»ä½¿ç¨çæ°æ®å®¹å¨ãè¿äºç±»ä¸åå«ä»»ä½éå åè½ï¼å¹¶ä¸ä¸è½å¯¹èªå·±æ¥æçæ°æ®è¿è¡ç¬ç«æä½ã\n\n\n\n\n# 3.1. é®é¢åå \n\nå½ä¸ä¸ªæ°åå»ºçç±»åªåå«å ä¸ªå¬å±å­æ®µï¼çè³å¯è½å ä¸ª getters / settersï¼æ¯å¾æ­£å¸¸çãä½æ¯å¯¹è±¡ççæ­£åéå¨äºå®ä»¬å¯ä»¥åå«ä½ç¨äºæ°æ®çè¡ä¸ºç±»åææä½ã\n\n\n# 3.2. è§£å³æ¹æ³\n\n * å¦æä¸ä¸ªç±»æå¬å±å­æ®µï¼ä½ åºè¯¥è¿ç¨ å°è£å­æ®µ(encapsulated field) æ¥éèå­æ®µçç´æ¥è®¿é®æ¹å¼ã\n * å¦æè¿äºç±»å«å®¹å¨ç±»çå­æ®µï¼ä½ åºè¯¥æ£æ¥å®ä»¬æ¯ä¸æ¯å¾å°äºæ°å½çå°è£ï¼å¦ææ²¡æï¼å°±è¿ç¨ å°è£éå(encapsulated collection) æå®ä»¬å°è£èµ·æ¥ã\n * æ¾åºè¿äº getter/setter å½æ°è¢«å¶ä»ç±»è¿ç¨çå°ç¹ãå°è¯ä»¥ æ¬ç§»å½æ°(move method) æé£äºè°ç¨è¡ä¸ºæ¬ç§»å° çº¯ç¨çæ°æ®ç±»(data class) æ¥ãå¦ææ æ³æ¬ç§»è¿ä¸ªå½æ°ï¼å°±è¿ç¨ æç¼å½æ°(extract method) äº§çä¸ä¸ªå¯æ¬ç§»çå½æ°ã\n\n\n\n * å¨ç±»å·²ç»åæ»¡äºæ·±æçèçå½æ°ä¹åï¼ä½ å¯è½æ³è¦æè±æ§çæ°æ®è®¿é®æ¹æ³ï¼ä»¥æä¾éåºé¢è¾å¹¿çç±»æ°æ®è®¿é®æ¥å£ãä¸ºæ­¤ï¼å¯ä»¥è¿ç¨ ç§»é¤è®¾ç½®å½æ°(remove setting method) å éèå½æ°(hide method) ã\n\n\n# 3.3. æ¶ç\n\n * æé«ä»£ç çå¯è¯»æ§åç»ç»æ§ãç¹å®æ°æ®çæä½ç°å¨è¢«éä¸­å¨ä¸ä¸ªå°æ¹ï¼èä¸æ¯å¨åæ£å¨ä»£ç åå¤ã\n * å¸®å©ä½ åç°å®¢æ·ç«¯ä»£ç çéå¤å¤ã\n\n\n# 3.4. éææ¹æ³è¯´æ\n\n# 3.4.1. å°è£å­æ®µ(encapsulated field)\n\né®é¢\n\nä½ çç±»ä¸­å­å¨ public å­æ®µã\n\nclass person {\n  public string name;\n}\n\n\nè§£å³\n\nå°å®å£°æä¸º privateï¼å¹¶æä¾ç¸åºçè®¿é®å½æ°ã\n\nclass person {\n  private string name;\n\n  public string getname() {\n    return name;\n  }\n  public void setname(string arg) {\n    name = arg;\n  }\n}\n\n\n# 3.4.2. å°è£éå(encapsulated collection)\n\né®é¢\n\næä¸ªå½æ°è¿åä¸ä¸ªéåã\n\n\n\nè§£å³\n\nè®©è¯¥å½æ°è¿åè¯¥éåçä¸ä¸ªåªè¯»å¯æ¬ï¼å¹¶å¨è¿ä¸ªç±»ä¸­æä¾æ·»å ãç§»é¤éååç´ çå½æ°ã\n\n\n\n# 3.4.3. æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# 3.4.4. æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# 3.4.5. ç§»é¤è®¾ç½®å½æ°(remove setting method)\n\né®é¢\n\nç±»ä¸­çæä¸ªå­æ®µåºè¯¥å¨å¯¹è±¡åå»ºæ¶è¢«è®¾å¼ï¼ç¶åå°±ä¸åæ¹åã\n\n\n\nè§£å³\n\nå»æè¯¥å­æ®µçææè®¾å¼å½æ°ã\n\n\n\n# 3.4.6. éèå½æ°(hide method)\n\né®é¢\n\næä¸ä¸ªå½æ°ï¼ä»æ¥æ²¡æè¢«å¶ä»ä»»ä½ç±»ç¨å°ã\n\n\n\nè§£å³\n\nå°è¿ä¸ªå½æ°ä¿®æ¹ä¸º privateã\n\n\n\n\n# 4. è¿å¤çæ³¨é\n\n> è¿å¤çæ³¨é(comments)\n> \n> æ³¨éæ¬èº«å¹¶ä¸æ¯åäºãä½æ¯å¸¸å¸¸æè¿æ ·çæåµï¼ä¸æ®µä»£ç ä¸­åºç°é¿é¿çæ³¨éï¼èå®ä¹æä»¥å­å¨ï¼æ¯å ä¸ºä»£ç å¾ç³ç³ã\n\n\n\n\n# 4.1. é®é¢åå \n\næ³¨éçä½èæè¯å°èªå·±çä»£ç ä¸ç´è§æä¸ææ¾ï¼æä»¥æ³ä½¿ç¨æ³¨éæ¥è¯´æèªå·±çæå¾ãè¿ç§æåµä¸ï¼æ³¨éå°±åæ¯çä»£ç çé¤è­åã\n\n> æå¥½çæ³¨éæ¯ä¸ºå½æ°æç±»èµ·ä¸ä¸ªæ°å½çåå­ã\n\nå¦æä½ è§å¾ä¸ä¸ªä»£ç çæ®µæ²¡ææ³¨éå°±æ æ³çè§£ï¼è¯·åå°è¯éæï¼è¯çè®©æææ³¨éé½åå¾å¤ä½ã\n\n\n# 4.2. è§£å³æ¹æ³\n\n * å¦æä¸ä¸ªæ³¨éæ¯ä¸ºäºè§£éä¸ä¸ªå¤æçè¡¨è¾¾å¼ï¼å¯ä»¥è¿ç¨ æç¼åé(extract variable) å°è¡¨è¾¾å¼ååä¸ºæçè§£çå­è¡¨è¾¾å¼ã\n * å¦æä½ éè¦éè¿æ³¨éæ¥è§£éä¸æ®µä»£ç åäºä»ä¹ï¼è¯·è¯è¯ æç¼å½æ°(extract method) ã\n * å¦æå½æ°å·²ç»è¢«æç¼ï¼ä½ä»éè¦æ³¨éå½æ°åäºä»ä¹ï¼è¯è¯è¿ç¨ å½æ°æ¹å(rename method) æ¥ä¸ºå½æ°èµ·ä¸ä¸ªå¯ä»¥èªè§£éçåå­ã\n * å¦æéè¦å¯¹ç³»ç»æç¶æè¿è¡æ­è¨ï¼è¯·è¿ç¨ å¼å¥æ­è¨(introduce assertion) ã\n\n\n# 4.3. æ¶ç\n\n * ä»£ç åå¾æ´ç´è§åææ¾ã\n\n\n# 4.4. ä½æ¶å¿½ç¥\n\næ³¨éææ¶åå¾æç¨ï¼\n\n * å½è§£éä¸ºä»ä¹æäºç©è¦ä»¥ç¹æ®æ¹å¼å®ç°æ¶ã\n * å½è§£éæç§å¤æç®æ³æ¶ã\n * å½ä½ å®å¨ä¸ç¥å¯ä»¥åäºä»ä¹æ¶ã\n\n\n# 4.5. éææ¹æ³è¯´æ\n\n# 4.5.1. æç¼åé(extract variable)\n\né®é¢\n\nä½ æä¸ªé¾ä»¥çè§£çè¡¨è¾¾å¼ã\n\nvoid renderbanner() {\n  if ((platform.touppercase().indexof("mac") > -1) &&\n       (browser.touppercase().indexof("ie") > -1) &&\n        wasinitialized() && resize > 0 )\n  {\n    // do something\n  }\n}\n\n\nè§£å³\n\nå°è¡¨è¾¾å¼çç»ææå®çå­è¡¨è¾¾å¼çç»æç¨ä¸è¨èªæçåéæ¥æ¿ä»£ã\n\nvoid renderbanner() {\n  final boolean ismacos = platform.touppercase().indexof("mac") > -1;\n  final boolean isie = browser.touppercase().indexof("ie") > -1;\n  final boolean wasresized = resize > 0;\n\n  if (ismacos && isie && wasinitialized() && wasresized) {\n    // do something\n  }\n}\n\n\n# 4.5.2. æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# 4.5.3. å½æ°æ¹å(rename method)\n\né®é¢\n\nå½æ°çåç§°æªè½æ°å½çæ­ç¤ºå½æ°çç¨éã\n\nclass person {\n  public string getsnm();\n}\n\n\nè§£å³\n\nä¿®æ¹å½æ°åã\n\nclass person {\n  public string getsecondname();\n}\n\n\n# 4.5.4. å¼å¥æ­è¨(introduce assertion)\n\né®é¢\n\næä¸æ®µä»£ç éè¦å¯¹ç¨åºç¶æååºæç§åè®¾ã\n\ndouble getexpenselimit() {\n  // should have either expense limit or a primary project\n  return (expenselimit != null_expense) ?\n    expenselimit:\n    primaryproject.getmemberexpenselimit();\n}\n\n\nè§£å³\n\nä»¥æ­è¨æç¡®è¡¨ç°è¿ç§åè®¾ã\n\ndouble getexpenselimit() {\n  assert.istrue(expenselimit != null_expense || primaryproject != null);\n\n  return (expenselimit != null_expense) ?\n    expenselimit:\n    primaryproject.getmemberexpenselimit();\n}\n\n\næ³¨ï¼è¯·ä¸è¦æ»¥ç¨æ­è¨ãä¸è¦ä½¿ç¨å®æ¥æ£æ¥âåºè¯¥ä¸ºçâçæ¡ä»¶ï¼åªè½ä½¿ç¨å®æ¥æ£æ¥âä¸å®å¿é¡»ä¸ºçâçæ¡ä»¶ãå®éä¸ï¼æ­è¨æ´å¤æ¯ç¨äºèªææ£æµä»£ç çä¸ç§ææ®µãå¨äº§åçæ­£äº¤ä»æ¶ï¼å¾å¾é½ä¼æ¶é¤æææ­è¨ã\n\n\n# 5. éå¤ä»£ç \n\n> éå¤ä»£ç (duplicate code)\n> \n> éå¤ä»£ç å ªç§°ä¸ºä»£ç åå³éä¹é¦ãæ¶é¤éå¤ä»£ç æ»æ¯æå©æ å®³çã\n\n\n\n\n# 5.1. é®é¢åå \n\néå¤ä»£ç éå¸¸åçå¨å¤ä¸ªç¨åºååæ¶å¨åä¸ç¨åºçä¸åé¨åä¸å·¥ä½æ¶ãç±äºä»ä»¬æ­£å¨å¤çä¸åçä»»å¡ï¼ä»ä»¬å¯è½ä¸ç¥éä»ä»¬çåäºå·²ç»åäºç±»ä¼¼çä»£ç ã\n\nè¿æä¸ç§æ´éæ¦çéå¤ï¼ç¹å®é¨åçä»£ç çä¸å»ä¸åä½å®éå¨ååä¸ä»¶äºãè¿ç§éå¤ä»£ç å¾å¾é¾ä»¥æ¾å°åæ¶é¤ã\n\nææ¶éå¤æ¯æç®çæ§çãå½æ¥äºæ»¡è¶³ deadlineï¼å¹¶ä¸ç°æä»£ç å¯¹äºè¦äº¤ä»çä»»å¡æ¯âå ä¹æ­£ç¡®çâæ¶ï¼æ°æç¨åºåå¯è½æ æ³æµæå¤å¶åç²è´´ç¸å³ä»£ç çè¯±æãå¨æäºæåµä¸ï¼ç¨åºååªæ¯å¤ªææ°ã\n\n\n# 5.2. è§£å³æ¹æ³\n\n * åä¸ä¸ªç±»çä¸¤ä¸ªå½æ°å«æç¸åçè¡¨è¾¾å¼ï¼è¿æ¶å¯ä»¥éç¨ æç¼å½æ°(extract method) æç¼åºéå¤çä»£ç ï¼ç¶åè®©è¿ä¸¤ä¸ªå°ç¹é½è°ç¨è¢«æç¼åºæ¥çé£æ®µä»£ç ã\n\n\n\n * å¦æä¸¤ä¸ªäºä¸ºåå¼çå­ç±»å«æéå¤ä»£ç ï¼\n   * é¦åå¯¹ä¸¤ä¸ªç±»é½è¿ç¨ æç¼å½æ°(extract method) ï¼ç¶åå¯¹è¢«æç¼åºæ¥çå½æ°è¿ç¨ å½æ°ä¸ç§»(pull up method) ï¼å°å®æ¨å¥è¶ç±»ã\n   * å¦æéå¤ä»£ç å¨æé å½æ°ä¸­ï¼è¿ç¨ æé å½æ°æ¬ä½ä¸ç§»(pull up constructor body) ã\n   * å¦æéå¤ä»£ç åªæ¯ç¸ä¼¼ä½ä¸æ¯å®å¨ç¸åï¼è¿ç¨ å¡é æ¨¡æ¿å½æ°(form template method) è·å¾ä¸ä¸ª æ¨¡æ¿æ¹æ³æ¨¡å¼(template method) ã\n   * å¦ææäºå½æ°ä»¥ä¸åçç®æ³åç¸åçäºï¼ä½ å¯ä»¥éæ©å¶ä¸­è¾æ¸æ°å°ä¸ä¸ªï¼å¹¶è¿ç¨ æ¿æ¢ç®æ³(substitute algorithm) å°å¶ä»å½æ°çç®æ³æ¿æ¢æã\n * å¦æä¸¤ä¸ªæ¯«ä¸ç¸å³çç±»ä¸­æéå¤ä»£ç ï¼\n   * è¯·å°è¯è¿ç¨ æç¼è¶ç±»(extract superclass) ï¼ä»¥ä¾¿ä¸ºç»´æ¤ææåååè½çè¿äºç±»åå»ºä¸ä¸ªè¶ç±»ã\n   * å¦æåå»ºè¶ç±»ååå°é¾ï¼å¯ä»¥å¨ä¸ä¸ªç±»ä¸­è¿ç¨ æç¼ç±»(extract class) ï¼å¹¶å¨å¦ä¸ä¸ªç±»ä¸­ä½¿ç¨è¿ä¸ªæ°çç»ä»¶ã\n * å¦æå­å¨å¤§éçæ¡ä»¶è¡¨è¾¾å¼ï¼å¹¶ä¸å®ä»¬æ§è¡å®å¨ç¸åçä»£ç ï¼ä»ä»æ¯å®ä»¬çæ¡ä»¶ä¸åï¼ï¼å¯ä»¥è¿ç¨ åå¹¶æ¡ä»¶è¡¨è¾¾å¼(consolidate conditional expression) å°è¿äºæä½åå¹¶ä¸ºåä¸ªæ¡ä»¶ï¼å¹¶è¿ç¨ æç¼å½æ°(extract method) å°è¯¥æ¡ä»¶æ¾å¥ä¸ä¸ªåå­å®¹æçè§£çç¬ç«å½æ°ä¸­ã\n * å¦ææ¡ä»¶è¡¨è¾¾å¼çææåæ¯é½æé¨åç¸åçä»£ç çæ®µï¼å¯ä»¥è¿ç¨ åå¹¶éå¤çæ¡ä»¶çæ®µ(consolidate duplicate conditional fragments) å°å®ä»¬é½å­å¨çä»£ç çæ®µç½®äºæ¡ä»¶è¡¨è¾¾å¼å¤é¨ã\n\n\n# 5.3. æ¶ç\n\n * åå¹¶éå¤ä»£ç ä¼ç®åä»£ç çç»æï¼å¹¶åå°ä»£ç éã\n * ä»£ç æ´ç®åãæ´æç»´æ¤ã\n\n\n# 5.4. éææ¹æ³è¯´æ\n\n# 5.4.1. æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# 5.4.2. å½æ°ä¸ç§»(pull up method)\n\né®é¢\n\næäºå½æ°ï¼å¨åä¸ªå­ç±»ä¸­äº§çå®å¨ç¸åçç»æã\n\n\n\nè§£å³\n\nå°è¯¥å½æ°ç§»è³è¶ç±»ã\n\n\n\n# 5.4.3. æé å½æ°æ¬ä½ä¸ç§»(pull up constructor body)\n\né®é¢\n\nä½ å¨åä¸ªå­ç±»ä¸­æ¥æä¸äºæé å½æ°ï¼å®ä»¬çæ¬ä½å ä¹å®å¨ä¸è´ã\n\nclass manager extends employee {\n  public manager(string name, string id, int grade) {\n    this.name = name;\n    this.id = id;\n    this.grade = grade;\n  }\n  //...\n}\n\n\nè§£å³\n\nå¨è¶ç±»ä¸­æ°å»ºä¸ä¸ªæé å½æ°ï¼å¹¶å¨å­ç±»æé å½æ°ä¸­è°ç¨å®ã\n\nclass manager extends employee {\n  public manager(string name, string id, int grade) {\n    super(name, id);\n    this.grade = grade;\n  }\n  //...\n}\n\n\n# 5.4.4. å¡é æ¨¡æ¿å½æ°(form template method)\n\né®é¢\n\nä½ æä¸äºå­ç±»ï¼å¶ä¸­ç¸åºçæäºå½æ°ä»¥ç¸åçé¡ºåºæ§è¡ç±»ä¼¼çæä½ï¼ä½åä¸ªæä½çç»èä¸ææä¸åã\n\n\n\nè§£å³\n\nå°è¿äºæä½åå«æ¾è¿ç¬ç«å½æ°ä¸­ï¼å¹¶ä¿æå®ä»¬é½æç¸åçç­¾åï¼äºæ¯åå½æ°ä¹å°±åå¾ç¸åäºãç¶åå°åå½æ°ä¸ç§»è³è¶ç±»ã\n\n\n\næ³¨ï¼è¿éåªæå°å·ä½åæ³ï¼å»ºè®®äºè§£ä¸ä¸æ¨¡æ¿æ¹æ³è®¾è®¡æ¨¡å¼ã\n\n# 5.4.5. æ¿æ¢ç®æ³(substitute algorithm)\n\né®é¢\n\nä½ æ³è¦ææä¸ªç®æ³æ¿æ¢ä¸ºå¦ä¸ä¸ªæ´æ¸æ°çç®æ³ã\n\nstring foundperson(string[] people){\n  for (int i = 0; i < people.length; i++) {\n    if (people[i].equals("don")){\n      return "don";\n    }\n    if (people[i].equals("john")){\n      return "john";\n    }\n    if (people[i].equals("kent")){\n      return "kent";\n    }\n  }\n  return "";\n}\n\n\nè§£å³\n\nå°å½æ°æ¬ä½æ¿æ¢ä¸ºå¦ä¸ä¸ªç®æ³ã\n\nstring foundperson(string[] people){\n  list candidates =\n    arrays.aslist(new string[] {"don", "john", "kent"});\n  for (int i=0; i < people.length; i++) {\n    if (candidates.contains(people[i])) {\n      return people[i];\n    }\n  }\n  return "";\n}\n\n\n# 5.4.6. æç¼è¶ç±»(extract superclass)\n\né®é¢\n\nä¸¤ä¸ªç±»æç¸ä¼¼ç¹æ§ã\n\n\n\nè§£å³\n\nä¸ºè¿ä¸¤ä¸ªç±»å»ºç«ä¸ä¸ªè¶ç±»ï¼å°ç¸åç¹æ§ç§»è³è¶ç±»ã\n\n\n\n# 5.4.7. æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# 5.4.8. åå¹¶æ¡ä»¶è¡¨è¾¾å¼(consolidate conditional expression)\n\né®é¢\n\nä½ æä¸ç³»åæ¡ä»¶åæ¯ï¼é½å¾å°ç¸åç»æã\n\ndouble disabilityamount() {\n  if (seniority < 2) {\n    return 0;\n  }\n  if (monthsdisabled > 12) {\n    return 0;\n  }\n  if (isparttime) {\n    return 0;\n  }\n  // compute the disability amount\n  //...\n}\n\n\nè§£å³\n\nå°è¿äºæ¡ä»¶åæ¯åå¹¶ä¸ºä¸ä¸ªæ¡ä»¶ï¼å¹¶å°è¿ä¸ªæ¡ä»¶æç¼ä¸ºä¸ä¸ªç¬ç«å½æ°ã\n\ndouble disabilityamount() {\n  if (isnoteligablefordisability()) {\n    return 0;\n  }\n  // compute the disability amount\n  //...\n}\n\n\n# 5.4.9. åå¹¶éå¤çæ¡ä»¶çæ®µ(consolidate duplicate conditional fragments)\n\né®é¢\n\nå¨æ¡ä»¶è¡¨è¾¾å¼çæ¯ä¸ªåæ¯ä¸æçç¸åçä¸æ®µä»£ç ã\n\nif (isspecialdeal()) {\n  total = price * 0.95;\n  send();\n}\nelse {\n  total = price * 0.98;\n  send();\n}\n\n\nè§£å³\n\nå°è¿æ®µéå¤ä»£ç æ¬ç§»å°æ¡ä»¶è¡¨è¾¾å¼ä¹å¤ã\n\nif (isspecialdeal()) {\n  total = price * 0.95;\n}\nelse {\n  total = price * 0.98;\n}\nsend();\n\n\n\n# 6. æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# 7. åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ä»£ç åå³éä¹è¦å",frontmatter:{title:"ä»£ç åå³éä¹è¦å",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ","ä»£ç çåå³é"],date:"2018-10-13T22:48:00.000Z",permalink:"/pages/595d03/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/06.%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.html",relativePath:"03.è®¾è®¡/03.éæ/06.ä»£ç åå³éä¹è¦å.md",key:"v-3a98d9f2",path:"/pages/595d03/",headers:[{level:2,title:"ä¸å®ç¾çåºç±»",slug:"ä¸å®ç¾çåºç±»",normalizedTitle:"ä¸å®ç¾çåºç±»",charIndex:100},{level:3,title:"é®é¢åå ",slug:"é®é¢åå ",normalizedTitle:"é®é¢åå ",charIndex:198},{level:3,title:"è§£å³æ¹æ³",slug:"è§£å³æ¹æ³",normalizedTitle:"è§£å³æ¹æ³",charIndex:289},{level:3,title:"æ¶ç",slug:"æ¶ç",normalizedTitle:"æ¶ç",charIndex:415},{level:3,title:"ä½æ¶å¿½ç¥",slug:"ä½æ¶å¿½ç¥",normalizedTitle:"ä½æ¶å¿½ç¥",charIndex:462},{level:3,title:"éææ¹æ³è¯´æ",slug:"éææ¹æ³è¯´æ",normalizedTitle:"éææ¹æ³è¯´æ",charIndex:491},{level:4,title:"å¼å¥å¤å å½æ°(Introduce Foreign Method)",slug:"å¼å¥å¤å å½æ°-introduce-foreign-method",normalizedTitle:"å¼å¥å¤å å½æ°(introduce foreign method)",charIndex:319},{level:4,title:"å¼å¥æ¬å°æ©å±(Introduce Local Extension)",slug:"å¼å¥æ¬å°æ©å±-introduce-local-extension",normalizedTitle:"å¼å¥æ¬å°æ©å±(introduce local extension)",charIndex:375},{level:2,title:"ä¸­é´äºº",slug:"ä¸­é´äºº",normalizedTitle:"ä¸­é´äºº",charIndex:1118},{level:3,title:"é®é¢åå ",slug:"é®é¢åå -2",normalizedTitle:"é®é¢åå ",charIndex:198},{level:3,title:"è§£å³æ¹æ³",slug:"è§£å³æ¹æ³-2",normalizedTitle:"è§£å³æ¹æ³",charIndex:289},{level:3,title:"æ¶ç",slug:"æ¶ç-2",normalizedTitle:"æ¶ç",charIndex:415},{level:3,title:"ä½æ¶å¿½ç¥",slug:"ä½æ¶å¿½ç¥-2",normalizedTitle:"ä½æ¶å¿½ç¥",charIndex:462},{level:3,title:"éææ¹æ³è¯´æ",slug:"éææ¹æ³è¯´æ-2",normalizedTitle:"éææ¹æ³è¯´æ",charIndex:491},{level:4,title:"ç§»é¤ä¸­é´äºº(Remove Middle Man)",slug:"ç§»é¤ä¸­é´äºº-remove-middle-man",normalizedTitle:"ç§»é¤ä¸­é´äºº(remove middle man)",charIndex:1305},{level:2,title:"ä¾ææç»",slug:"ä¾ææç»",normalizedTitle:"ä¾ææç»",charIndex:1540},{level:3,title:"é®é¢åå ",slug:"é®é¢åå -3",normalizedTitle:"é®é¢åå ",charIndex:198},{level:3,title:"è§£å³æ¹æ³",slug:"è§£å³æ¹æ³-3",normalizedTitle:"è§£å³æ¹æ³",charIndex:289},{level:3,title:"æ¶ç",slug:"æ¶ç-3",normalizedTitle:"æ¶ç",charIndex:415},{level:3,title:"ä½æ¶å¿½ç¥",slug:"ä½æ¶å¿½ç¥-3",normalizedTitle:"ä½æ¶å¿½ç¥",charIndex:462},{level:3,title:"éææ¹æ³è¯´æ",slug:"éææ¹æ³è¯´æ-3",normalizedTitle:"éææ¹æ³è¯´æ",charIndex:491},{level:4,title:"æ¬ç§»å½æ°(Move Method)",slug:"æ¬ç§»å½æ°-move-method",normalizedTitle:"æ¬ç§»å½æ°(move method)",charIndex:1944},{level:4,title:"æç¼å½æ°(Extract Method)",slug:"æç¼å½æ°-extract-method",normalizedTitle:"æç¼å½æ°(extract method)",charIndex:1993},{level:2,title:"çæµå³ç³»",slug:"çæµå³ç³»",normalizedTitle:"çæµå³ç³»",charIndex:2863},{level:3,title:"é®é¢åå ",slug:"é®é¢åå -4",normalizedTitle:"é®é¢åå ",charIndex:198},{level:3,title:"è§£å³æ¹æ³",slug:"è§£å³æ¹æ³-4",normalizedTitle:"è§£å³æ¹æ³",charIndex:289},{level:3,title:"æ¶ç",slug:"æ¶ç-4",normalizedTitle:"æ¶ç",charIndex:415},{level:3,title:"éææ¹æ³è¯´æ",slug:"éææ¹æ³è¯´æ-4",normalizedTitle:"éææ¹æ³è¯´æ",charIndex:491},{level:4,title:"æ¬ç§»å½æ°(Move Method)",slug:"æ¬ç§»å½æ°-move-method-2",normalizedTitle:"æ¬ç§»å½æ°(move method)",charIndex:1944},{level:4,title:"æ¬ç§»å­æ®µ(Move Field)",slug:"æ¬ç§»å­æ®µ-move-field",normalizedTitle:"æ¬ç§»å­æ®µ(move field)",charIndex:3019},{level:4,title:"å°ååå³èæ¹ä¸ºååå³è(Change Bidirectional Association to Unidirectional)",slug:"å°ååå³èæ¹ä¸ºååå³è-change-bidirectional-association-to-unidirectional",normalizedTitle:"å°ååå³èæ¹ä¸ºååå³è(change bidirectional association to unidirectional)",charIndex:3065},{level:4,title:"æç¼ç±»(Extract Class)",slug:"æç¼ç±»-extract-class",normalizedTitle:"æç¼ç±»(extract class)",charIndex:3172},{level:4,title:"éèå§æå³ç³»(Hide Delegate)",slug:"éèå§æå³ç³»-hide-delegate",normalizedTitle:"éèå§æå³ç³»(hide delegate)",charIndex:3226},{level:4,title:"ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation)",slug:"ä»¥å§æåä»£ç»§æ¿-replace-inheritance-with-delegation",normalizedTitle:"ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation)",charIndex:3323},{level:2,title:"è¿åº¦è¦åçæ¶æ¯é¾",slug:"è¿åº¦è¦åçæ¶æ¯é¾",normalizedTitle:"è¿åº¦è¦åçæ¶æ¯é¾",charIndex:4079},{level:3,title:"é®é¢åå ",slug:"é®é¢åå -5",normalizedTitle:"é®é¢åå ",charIndex:198},{level:3,title:"è§£å³æ¹æ³",slug:"è§£å³æ¹æ³-5",normalizedTitle:"è§£å³æ¹æ³",charIndex:289},{level:3,title:"æ¶ç",slug:"æ¶ç-5",normalizedTitle:"æ¶ç",charIndex:415},{level:3,title:"ä½æ¶å¿½ç¥",slug:"ä½æ¶å¿½ç¥-4",normalizedTitle:"ä½æ¶å¿½ç¥",charIndex:462},{level:3,title:"éææ¹æ³è¯´æ",slug:"éææ¹æ³è¯´æ-5",normalizedTitle:"éææ¹æ³è¯´æ",charIndex:491},{level:4,title:"éèå§æå³ç³»(Hide Delegate)",slug:"éèå§æå³ç³»-hide-delegate-2",normalizedTitle:"éèå§æå³ç³»(hide delegate)",charIndex:3226},{level:4,title:"æç¼å½æ°(Extract Method)",slug:"æç¼å½æ°-extract-method-2",normalizedTitle:"æç¼å½æ°(extract method)",charIndex:1993},{level:4,title:"æ¬ç§»å½æ°(Move Method)",slug:"æ¬ç§»å½æ°-move-method-3",normalizedTitle:"æ¬ç§»å½æ°(move method)",charIndex:1944},{level:2,title:"æ©å±éè¯»",slug:"æ©å±éè¯»",normalizedTitle:"æ©å±éè¯»",charIndex:5224},{level:2,title:"åèèµæ",slug:"åèèµæ",normalizedTitle:"åèèµæ",charIndex:5318}],headersStr:"ä¸å®ç¾çåºç±» é®é¢åå  è§£å³æ¹æ³ æ¶ç ä½æ¶å¿½ç¥ éææ¹æ³è¯´æ å¼å¥å¤å å½æ°(Introduce Foreign Method) å¼å¥æ¬å°æ©å±(Introduce Local Extension) ä¸­é´äºº é®é¢åå  è§£å³æ¹æ³ æ¶ç ä½æ¶å¿½ç¥ éææ¹æ³è¯´æ ç§»é¤ä¸­é´äºº(Remove Middle Man) ä¾ææç» é®é¢åå  è§£å³æ¹æ³ æ¶ç ä½æ¶å¿½ç¥ éææ¹æ³è¯´æ æ¬ç§»å½æ°(Move Method) æç¼å½æ°(Extract Method) çæµå³ç³» é®é¢åå  è§£å³æ¹æ³ æ¶ç éææ¹æ³è¯´æ æ¬ç§»å½æ°(Move Method) æ¬ç§»å­æ®µ(Move Field) å°ååå³èæ¹ä¸ºååå³è(Change Bidirectional Association to Unidirectional) æç¼ç±»(Extract Class) éèå§æå³ç³»(Hide Delegate) ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation) è¿åº¦è¦åçæ¶æ¯é¾ é®é¢åå  è§£å³æ¹æ³ æ¶ç ä½æ¶å¿½ç¥ éææ¹æ³è¯´æ éèå§æå³ç³»(Hide Delegate) æç¼å½æ°(Extract Method) æ¬ç§»å½æ°(Move Method) æ©å±éè¯» åèèµæ",content:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/couplers\n> \n> è¦å(Couplers)è¿ç»åå³éæå³çï¼ä¸åç±»ä¹é´è¿åº¦è¦åã\n\n\n# ä¸å®ç¾çåºç±»\n\n> ä¸å®ç¾çåºç±»(Incomplete Library Class)\n> \n> å½ä¸ä¸ªç±»åºå·²ç»ä¸è½æ»¡è¶³å®ééè¦æ¶ï¼ä½ å°±ä¸å¾ä¸æ¹åè¿ä¸ªåºï¼å¦æè¿ä¸ªåºæ¯åªè¯»çï¼é£å°±æ²¡è¾äºï¼ã\n\n\n# é®é¢åå \n\nè®¸å¤ç¼ç¨ææ¯é½å»ºç«å¨åºç±»çåºç¡ä¸ãåºç±»çä½èæ²¡ç¨æªååç¥çè½åï¼ä¸è½å æ­¤è´£æªä»ä»¬ãéº»ç¦çæ¯åºå¾å¾æé çä¸å¤å¥½ï¼èä¸å¾å¾ä¸å¯è½è®©æä»¬ä¿®æ¹å¶ä¸­çç±»ä»¥æ»¡è¶³æä»¬çéè¦ã\n\n\n# è§£å³æ¹æ³\n\n * å¦æä½ åªæ³ä¿®æ¹ç±»åºçä¸ä¸¤ä¸ªå½æ°ï¼å¯ä»¥è¿ç¨ å¼å¥å¤å å½æ°(Introduce Foreign Method)ï¼\n * å¦ææ³è¦æ·»å ä¸å¤§å é¢å¤è¡ä¸ºï¼å°±å¾è¿ç¨ å¼å¥æ¬å°æ©å±(Introduce Local Extension) ã\n\n\n# æ¶ç\n\n * åå°ä»£ç éå¤ï¼ä½ ä¸ç¨ä¸è¨ä¸åå°±èªå·±å¨æå®ç°ä¸ä¸ªåºçå¨é¨åè½ï¼ä»£ä»·å¤ªé«ï¼\n\n\n# ä½æ¶å¿½ç¥\n\n * å¦ææ©å±åºä¼å¸¦æ¥é¢å¤çå·¥ä½éã\n\n\n# éææ¹æ³è¯´æ\n\n# å¼å¥å¤å å½æ°(Introduce Foreign Method)\n\né®é¢\n\nä½ éè¦ä¸ºæä¾æå¡çç±»å¢å ä¸ä¸ªå½æ°ï¼ä½ä½ æ æ³ä¿®æ¹è¿ä¸ªç±»ã\n\nclass Report {\n  //...\n  void sendReport() {\n    Date nextDay = new Date(previousEnd.getYear(),\n      previousEnd.getMonth(), previousEnd.getDate() + 1);\n    //...\n  }\n}\n\n\nè§£å³\n\nå¨å®¢æ·ç±»ä¸­å»ºç«ä¸ä¸ªå½æ°ï¼å¹¶ä¸ä¸ªç¬¬ä¸ä¸ªåæ°å½¢å¼ä¼ å¥ä¸ä¸ªæå¡ç±»å®ä¾ã\n\nclass Report {\n  //...\n  void sendReport() {\n    Date newStart = nextDay(previousEnd);\n    //...\n  }\n  private static Date nextDay(Date arg) {\n    return new Date(arg.getYear(), arg.getMonth(), arg.getDate() + 1);\n  }\n}\n\n\n# å¼å¥æ¬å°æ©å±(Introduce Local Extension)\n\né®é¢\n\nä½ éè¦ä¸ºæå¡ç±»æä¾ä¸äºé¢å¤å½æ°ï¼ä½ä½ æ æ³ä¿®æ¹è¿ä¸ªç±»ã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼ä½¿å®åå«è¿äºé¢å¤å½æ°ï¼è®©è¿ä¸ªæ©å±åæä¸ºæºç±»çå­ç±»æåè£ç±»ã\n\n\n\n\n# ä¸­é´äºº\n\n> ä¸­é´äºº(Middle Man)\n> \n> å¦æä¸ä¸ªç±»çä½ç¨ä»ä»æ¯æåå¦ä¸ä¸ªç±»çå§æï¼ä¸ºä»ä¹è¦å­å¨å¢ï¼\n\n\n\n\n# é®é¢åå \n\nå¯¹è±¡çåºæ¬ç¹å¾ä¹ä¸å°±æ¯å°è£ï¼å¯¹å¤é¨ä¸çéèå¶åé¨ç»èãå°è£å¾å¾ä¼´éå§æãä½æ¯äººä»¬å¯è½è¿åº¦è¿ç¨å§æãæ¯å¦ï¼ä½ ä¹è®¸ä¼çå°ä¸ä¸ªç±»çå¤§é¨åæç¨å·¥ä½é½å§æç»äºå¶ä»ç±»ï¼ç±»æ¬èº«æäºä¸ä¸ªç©ºå£³ï¼é¤äºå§æä¹å¤ä¸åä»»ä½äºæã\n\n\n# è§£å³æ¹æ³\n\nåºè¯¥è¿ç¨ ç§»é¤ä¸­é´äºº(Remove Middle Man)ï¼ç´æ¥åçæ­£è´è´£çå¯¹è±¡æäº¤éã\n\n\n# æ¶ç\n\n * åå°ç¬¨éçä»£ç ã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\nå¦ææ¯ä»¥ä¸æåµï¼ä¸è¦å é¤å·²åå»ºçä¸­é´äººï¼\n\n * æ·»å ä¸­é´äººæ¯ä¸ºäºé¿åç±»ä¹é´ä¾èµå³ç³»ã\n * ä¸äºè®¾è®¡æ¨¡å¼æç®çå°åå»ºä¸­é´äººï¼ä¾å¦ä»£çæ¨¡å¼åè£é¥°å¨æ¨¡å¼ï¼ã\n\n\n# éææ¹æ³è¯´æ\n\n# ç§»é¤ä¸­é´äºº(Remove Middle Man)\n\né®é¢\n\næä¸ªç±»åäºè¿å¤çç®åå§æå¨ä½ã\n\n\n\nè§£å³\n\nè®©å®¢æ·ç´æ¥è°ç¨å§æç±»ã\n\n\n\n\n# ä¾ææç»\n\n> ä¾ææç»(Feature Envy)\n> \n> ä¸ä¸ªå½æ°è®¿é®å¶å®å¯¹è±¡çæ°æ®æ¯è®¿é®èªå·±çæ°æ®æ´å¤ã\n\n\n\n\n# é®é¢åå \n\nè¿ç§æ°å³å¯è½åçå¨å­æ®µç§»å¨å°æ°æ®ç±»ä¹åãå¦ææ¯è¿ç§æåµï¼ä½ å¯è½æ³å°æ°æ®ç±»çæä½ç§»å¨å°è¿ä¸ªç±»ä¸­ã\n\n\n# è§£å³æ¹æ³\n\nAs a basic rule, if things change at the same time, you should keep them in the same place. Usually data and functions that use this data are changed together (although exceptions are possible).\n\næä¸ä¸ªåºæ¬ååï¼åæ¶ä¼åçæ¹åçäºæåºè¯¥è¢«æ¾å¨åä¸ä¸ªå°æ¹ãéå¸¸ï¼æ°æ®åä½¿ç¨è¿äºæ°æ®çå½æ°æ¯ä¸èµ·æ¹åçã\n\n\n\n * å¦æä¸ä¸ªå½æ°ææ¾åºè¯¥è¢«ç§»å°å¦ä¸ä¸ªå°æ¹ï¼å¯è¿ç¨ æ¬ç§»å½æ°(Move Method) ã\n * å¦æä»ä»æ¯å½æ°çé¨åä»£ç è®¿é®å¦ä¸ä¸ªå¯¹è±¡çæ°æ®ï¼è¿ç¨ æç¼å½æ°(Extract Method) å°è¿é¨åä»£ç ç§»å°ç¬ç«çå½æ°ä¸­ã\n * å¦æä¸ä¸ªæ¹æ³ä½¿ç¨æ¥èªå¶ä»å ä¸ªç±»çå½æ°ï¼é¦åç¡®å®åªä¸ªç±»åå«å¤§å¤æ°ä½¿ç¨çæ°æ®ãç¶åï¼å°è¯¥æ¹æ³ä¸å¶ä»æ°æ®ä¸èµ·æ¾å¨æ­¤ç±»ä¸­ãæèï¼ä½¿ç¨ æç¼å½æ°(Extract Method) å°æ¹æ³æåä¸ºå ä¸ªé¨åï¼å¯ä»¥æ¾ç½®å¨ä¸åç±»ä¸­çä¸åä½ç½®ã\n\n\n# æ¶ç\n\n * åå°éå¤ä»£ç ï¼å¦ææ°æ®å¤ççä»£ç æ¾å¨ä¸­å¿ä½ç½®ï¼ã\n * æ´å¥½çä»£ç ç»ç»æ§ï¼å¤çæ°æ®çå½æ°é è¿å®éæ°æ®ï¼ã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\n * ææ¶ï¼è¡ä¸ºè¢«ææå°ä¸ä¿å­æ°æ®çç±»åå¼ãè¿éå¸¸çä¼ç¹æ¯è½å¤å¨æå°æ¹åè¡ä¸ºï¼è§ç­ç¥è®¾è®¡æ¨¡å¼ï¼è®¿é®èè®¾è®¡æ¨¡å¼åå¶ä»æ¨¡å¼ï¼ã\n\n\n# éææ¹æ³è¯´æ\n\n# æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n\n# çæµå³ç³»\n\n> çæµå³ç³»(Inappropriate Intimacy)\n> \n> ä¸ä¸ªç±»å¤§éä½¿ç¨å¦ä¸ä¸ªç±»çåé¨å­æ®µåæ¹æ³ã\n\n\n\n\n# é®é¢åå \n\nç±»åç±»ä¹é´åºè¯¥å°½éå°çæç¥å½¼æ­¤ï¼åå°è¦åï¼ãè¿æ ·çç±»æ´å®¹æç»´æ¤åå¤ç¨ã\n\n\n# è§£å³æ¹æ³\n\n * æç®åçè§£å³æ¹æ³æ¯è¿ç¨ æ¬ç§»å½æ°(Move Method) å æ¬ç§»å­æ®µ(Move Field) æ¥è®©ç±»ä¹é´æ©æ­ç¾ç»ã\n\n\n\n * ä½ ä¹å¯ä»¥ççæ¯å¦è½è¿ç¨ å°ååå³èæ¹ä¸ºååå³è(Change Bidirectional Association to Unidirectional) è®©å¶ä¸­ä¸ä¸ªç±»å¯¹å¦ä¸ä¸ªè¯´åæã\n\n * å¦æè¿ä¸¤ä¸ªç±»å®å¨æ¯ææ¯éåï¼é¾åé¾èï¼å¯ä»¥è¿ç¨ æç¼ç±»(Extract Class) æäºèå±åç¹æç¼å°ä¸ä¸ªæ°ç±»ä¸­ï¼è®©å®ä»¬äº§çç±çç»æ¶ãæèï¼å¯ä»¥å°è¯è¿ç¨ éèå§æå³ç³»(Hide Delegate) è®©å¦ä¸ä¸ªç±»æ¥ä¸ºå®ä»¬çµçº¿æ­æ¡¥ã\n\n * ç»§æ¿å¾å¾é æç±»ä¹é´è¿åç´§å¯ï¼å ä¸ºå­ç±»å¯¹è¶ç±»çäºè§£æ»æ¯è¶è¿åèçä¸»è§æ¿æï¼å¦æä½ è§å¾è¯¥è®©è¿ä¸ªå­ç±»èªå·±é¯è¡ï¼è¯·è¿ç¨ ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation) æ¥è®©è¶ç±»åå­ç±»åå®¶ã\n\n\n# æ¶ç\n\n * æé«ä»£ç ç»ç»æ§ã\n * æé«ä»£ç å¤ç¨æ§ã\n\n\n\n\n# éææ¹æ³è¯´æ\n\n# æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# æ¬ç§»å­æ®µ(Move Field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n# å°ååå³èæ¹ä¸ºååå³è(Change Bidirectional Association to Unidirectional)\n\né®é¢\n\nä¸¤ä¸ªç±»ä¹é´æååå³èï¼ä½å¶ä¸­ä¸ä¸ªç±»å¦ä»ä¸åéè¦å¦ä¸ä¸ªç±»çç¹æ§ã\n\n\n\nè§£å³\n\nå»é¤ä¸å¿è¦çå³èã\n\n\n\n# æç¼ç±»(Extract Class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# éèå§æå³ç³»(Hide Delegate)\n\né®é¢\n\nå®¢æ·éè¿ä¸ä¸ªå§æç±»æ¥è°ç¨å¦ä¸ä¸ªå¯¹è±¡ã\n\n\n\nè§£å³\n\nå¨æå¡ç±»ä¸å»ºç«å®¢æ·æéçææå½æ°ï¼ç¨ä»¥éèå§æå³ç³»ã\n\n\n\n# ä»¥å§æåä»£ç»§æ¿(Replace Inheritance with Delegation)\n\né®é¢\n\næä¸ªå­ç±»åªä½¿ç¨è¶ç±»æ¥å£ä¸­çä¸é¨åï¼ææ¯æ ¹æ¬ä¸éè¦ç»§æ¿èæ¥çæ°æ®ã\n\n\n\nè§£å³\n\nå¨å­ç±»ä¸­æ°å»ºä¸ä¸ªå­æ®µç¨ä»¥ä¿å­è¶ç±»ï¼è°æ´å­ç±»å½æ°ï¼ä»¤å®æ¹èå§æè¶ç±»ï¼ç¶åå»æä¸¤èä¹é´çç»§æ¿å³ç³»ã\n\n\n\n\n# è¿åº¦è¦åçæ¶æ¯é¾\n\n> è¿åº¦è¦åçæ¶æ¯é¾(Message Chains)\n> \n> æ¶æ¯é¾çå½¢å¼ç±»ä¼¼äºï¼obj.getA().getB().getC()ã\n\n\n\n\n# é®é¢åå \n\nå¦æä½ çå°ç¨æ·åä¸ä¸ªå¯¹è±¡è¯·æ±å¦ä¸ä¸ªå¯¹è±¡ï¼ç¶ååååèè¯·æ±å¦ä¸ä¸ªå¯¹è±¡ï¼ç¶ååè¯·æ±å¦ä¸ä¸ªå¯¹è±¡â¦â¦è¿å°±æ¯æ¶æ¯é¾ãå®éä»£ç ä¸­ä½ çå°çå¯è½æ¯ä¸é¿ä¸² getThis()æä¸é¿ä¸²ä¸´æ¶åéãéåè¿ç§æ¹å¼ï¼æå³å®¢æ·ä»£ç å°ä¸æ¥æ¾è¿ç¨ä¸­çå¯¼èªç´§å¯è¦åãä¸æ¦å¯¹è±¡é´å³ç³»åçä»»ä½ååï¼å®¢æ·ç«¯å°±ä¸å¾ä¸ååºç¸åºçä¿®æ¹ã\n\n\n# è§£å³æ¹æ³\n\n * å¯ä»¥è¿ç¨ éèå§æå³ç³»(Hide Delegate) å é¤ä¸ä¸ªæ¶æ¯é¾ã\n\n\n\n * ææ¶æ´å¥½çéæ©æ¯ï¼åè§å¯æ¶æ¯é¾æç»å¾å°çå¯¹è±¡æ¯ç¨æ¥å¹²ä»ä¹çãççè½å¦ä»¥ æç¼å½æ°(Extract Method)æä½¿ç¨è¯¥å¯¹è±¡çä»£ç æç¼å°ä¸ä¸ªç¬ç«å½æ°ä¸­ï¼åè¿ç¨ æ¬ç§»å½æ°(Move Method) æè¿ä¸ªå½æ°æ¨å¥æ¶æ¯é¾ã\n\n\n# æ¶ç\n\n * è½åå°é¾ä¸­ç±»ä¹é´çä¾èµã\n * è½åå°ä»£ç éã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\n * è¿äºä¾µç¥æ§çå§æå¯è½ä¼ä½¿ç¨åºåé¾ä»¥çè§£åè½æ¯å¦ä½è§¦åçã\n\n\n# éææ¹æ³è¯´æ\n\n# éèå§æå³ç³»(Hide Delegate)\n\né®é¢\n\nå®¢æ·éè¿ä¸ä¸ªå§æç±»æ¥è°ç¨å¦ä¸ä¸ªå¯¹è±¡ã\n\n\n\nè§£å³\n\nå¨æå¡ç±»ä¸å»ºç«å®¢æ·æéçææå½æ°ï¼ç¨ä»¥éèå§æå³ç³»ã\n\n\n\n# æç¼å½æ°(Extract Method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printOwing() {\n  printBanner();\n\n  //print details\n  System.out.println("name: " + name);\n  System.out.println("amount: " + getOutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printOwing() {\n  printBanner();\n  printDetails(getOutstanding());\n}\n\nvoid printDetails(double outstanding) {\n  System.out.println("name: " + name);\n  System.out.println("amount: " + outstanding);\n}\n\n\n# æ¬ç§»å½æ°(Move Method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n\n# æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',normalizedContent:'> ç¿»è¯èªï¼https://sourcemaking.com/refactoring/smells/couplers\n> \n> è¦å(couplers)è¿ç»åå³éæå³çï¼ä¸åç±»ä¹é´è¿åº¦è¦åã\n\n\n# ä¸å®ç¾çåºç±»\n\n> ä¸å®ç¾çåºç±»(incomplete library class)\n> \n> å½ä¸ä¸ªç±»åºå·²ç»ä¸è½æ»¡è¶³å®ééè¦æ¶ï¼ä½ å°±ä¸å¾ä¸æ¹åè¿ä¸ªåºï¼å¦æè¿ä¸ªåºæ¯åªè¯»çï¼é£å°±æ²¡è¾äºï¼ã\n\n\n# é®é¢åå \n\nè®¸å¤ç¼ç¨ææ¯é½å»ºç«å¨åºç±»çåºç¡ä¸ãåºç±»çä½èæ²¡ç¨æªååç¥çè½åï¼ä¸è½å æ­¤è´£æªä»ä»¬ãéº»ç¦çæ¯åºå¾å¾æé çä¸å¤å¥½ï¼èä¸å¾å¾ä¸å¯è½è®©æä»¬ä¿®æ¹å¶ä¸­çç±»ä»¥æ»¡è¶³æä»¬çéè¦ã\n\n\n# è§£å³æ¹æ³\n\n * å¦æä½ åªæ³ä¿®æ¹ç±»åºçä¸ä¸¤ä¸ªå½æ°ï¼å¯ä»¥è¿ç¨ å¼å¥å¤å å½æ°(introduce foreign method)ï¼\n * å¦ææ³è¦æ·»å ä¸å¤§å é¢å¤è¡ä¸ºï¼å°±å¾è¿ç¨ å¼å¥æ¬å°æ©å±(introduce local extension) ã\n\n\n# æ¶ç\n\n * åå°ä»£ç éå¤ï¼ä½ ä¸ç¨ä¸è¨ä¸åå°±èªå·±å¨æå®ç°ä¸ä¸ªåºçå¨é¨åè½ï¼ä»£ä»·å¤ªé«ï¼\n\n\n# ä½æ¶å¿½ç¥\n\n * å¦ææ©å±åºä¼å¸¦æ¥é¢å¤çå·¥ä½éã\n\n\n# éææ¹æ³è¯´æ\n\n# å¼å¥å¤å å½æ°(introduce foreign method)\n\né®é¢\n\nä½ éè¦ä¸ºæä¾æå¡çç±»å¢å ä¸ä¸ªå½æ°ï¼ä½ä½ æ æ³ä¿®æ¹è¿ä¸ªç±»ã\n\nclass report {\n  //...\n  void sendreport() {\n    date nextday = new date(previousend.getyear(),\n      previousend.getmonth(), previousend.getdate() + 1);\n    //...\n  }\n}\n\n\nè§£å³\n\nå¨å®¢æ·ç±»ä¸­å»ºç«ä¸ä¸ªå½æ°ï¼å¹¶ä¸ä¸ªç¬¬ä¸ä¸ªåæ°å½¢å¼ä¼ å¥ä¸ä¸ªæå¡ç±»å®ä¾ã\n\nclass report {\n  //...\n  void sendreport() {\n    date newstart = nextday(previousend);\n    //...\n  }\n  private static date nextday(date arg) {\n    return new date(arg.getyear(), arg.getmonth(), arg.getdate() + 1);\n  }\n}\n\n\n# å¼å¥æ¬å°æ©å±(introduce local extension)\n\né®é¢\n\nä½ éè¦ä¸ºæå¡ç±»æä¾ä¸äºé¢å¤å½æ°ï¼ä½ä½ æ æ³ä¿®æ¹è¿ä¸ªç±»ã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼ä½¿å®åå«è¿äºé¢å¤å½æ°ï¼è®©è¿ä¸ªæ©å±åæä¸ºæºç±»çå­ç±»æåè£ç±»ã\n\n\n\n\n# ä¸­é´äºº\n\n> ä¸­é´äºº(middle man)\n> \n> å¦æä¸ä¸ªç±»çä½ç¨ä»ä»æ¯æåå¦ä¸ä¸ªç±»çå§æï¼ä¸ºä»ä¹è¦å­å¨å¢ï¼\n\n\n\n\n# é®é¢åå \n\nå¯¹è±¡çåºæ¬ç¹å¾ä¹ä¸å°±æ¯å°è£ï¼å¯¹å¤é¨ä¸çéèå¶åé¨ç»èãå°è£å¾å¾ä¼´éå§æãä½æ¯äººä»¬å¯è½è¿åº¦è¿ç¨å§æãæ¯å¦ï¼ä½ ä¹è®¸ä¼çå°ä¸ä¸ªç±»çå¤§é¨åæç¨å·¥ä½é½å§æç»äºå¶ä»ç±»ï¼ç±»æ¬èº«æäºä¸ä¸ªç©ºå£³ï¼é¤äºå§æä¹å¤ä¸åä»»ä½äºæã\n\n\n# è§£å³æ¹æ³\n\nåºè¯¥è¿ç¨ ç§»é¤ä¸­é´äºº(remove middle man)ï¼ç´æ¥åçæ­£è´è´£çå¯¹è±¡æäº¤éã\n\n\n# æ¶ç\n\n * åå°ç¬¨éçä»£ç ã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\nå¦ææ¯ä»¥ä¸æåµï¼ä¸è¦å é¤å·²åå»ºçä¸­é´äººï¼\n\n * æ·»å ä¸­é´äººæ¯ä¸ºäºé¿åç±»ä¹é´ä¾èµå³ç³»ã\n * ä¸äºè®¾è®¡æ¨¡å¼æç®çå°åå»ºä¸­é´äººï¼ä¾å¦ä»£çæ¨¡å¼åè£é¥°å¨æ¨¡å¼ï¼ã\n\n\n# éææ¹æ³è¯´æ\n\n# ç§»é¤ä¸­é´äºº(remove middle man)\n\né®é¢\n\næä¸ªç±»åäºè¿å¤çç®åå§æå¨ä½ã\n\n\n\nè§£å³\n\nè®©å®¢æ·ç´æ¥è°ç¨å§æç±»ã\n\n\n\n\n# ä¾ææç»\n\n> ä¾ææç»(feature envy)\n> \n> ä¸ä¸ªå½æ°è®¿é®å¶å®å¯¹è±¡çæ°æ®æ¯è®¿é®èªå·±çæ°æ®æ´å¤ã\n\n\n\n\n# é®é¢åå \n\nè¿ç§æ°å³å¯è½åçå¨å­æ®µç§»å¨å°æ°æ®ç±»ä¹åãå¦ææ¯è¿ç§æåµï¼ä½ å¯è½æ³å°æ°æ®ç±»çæä½ç§»å¨å°è¿ä¸ªç±»ä¸­ã\n\n\n# è§£å³æ¹æ³\n\nas a basic rule, if things change at the same time, you should keep them in the same place. usually data and functions that use this data are changed together (although exceptions are possible).\n\næä¸ä¸ªåºæ¬ååï¼åæ¶ä¼åçæ¹åçäºæåºè¯¥è¢«æ¾å¨åä¸ä¸ªå°æ¹ãéå¸¸ï¼æ°æ®åä½¿ç¨è¿äºæ°æ®çå½æ°æ¯ä¸èµ·æ¹åçã\n\n\n\n * å¦æä¸ä¸ªå½æ°ææ¾åºè¯¥è¢«ç§»å°å¦ä¸ä¸ªå°æ¹ï¼å¯è¿ç¨ æ¬ç§»å½æ°(move method) ã\n * å¦æä»ä»æ¯å½æ°çé¨åä»£ç è®¿é®å¦ä¸ä¸ªå¯¹è±¡çæ°æ®ï¼è¿ç¨ æç¼å½æ°(extract method) å°è¿é¨åä»£ç ç§»å°ç¬ç«çå½æ°ä¸­ã\n * å¦æä¸ä¸ªæ¹æ³ä½¿ç¨æ¥èªå¶ä»å ä¸ªç±»çå½æ°ï¼é¦åç¡®å®åªä¸ªç±»åå«å¤§å¤æ°ä½¿ç¨çæ°æ®ãç¶åï¼å°è¯¥æ¹æ³ä¸å¶ä»æ°æ®ä¸èµ·æ¾å¨æ­¤ç±»ä¸­ãæèï¼ä½¿ç¨ æç¼å½æ°(extract method) å°æ¹æ³æåä¸ºå ä¸ªé¨åï¼å¯ä»¥æ¾ç½®å¨ä¸åç±»ä¸­çä¸åä½ç½®ã\n\n\n# æ¶ç\n\n * åå°éå¤ä»£ç ï¼å¦ææ°æ®å¤ççä»£ç æ¾å¨ä¸­å¿ä½ç½®ï¼ã\n * æ´å¥½çä»£ç ç»ç»æ§ï¼å¤çæ°æ®çå½æ°é è¿å®éæ°æ®ï¼ã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\n * ææ¶ï¼è¡ä¸ºè¢«ææå°ä¸ä¿å­æ°æ®çç±»åå¼ãè¿éå¸¸çä¼ç¹æ¯è½å¤å¨æå°æ¹åè¡ä¸ºï¼è§ç­ç¥è®¾è®¡æ¨¡å¼ï¼è®¿é®èè®¾è®¡æ¨¡å¼åå¶ä»æ¨¡å¼ï¼ã\n\n\n# éææ¹æ³è¯´æ\n\n# æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n\n# çæµå³ç³»\n\n> çæµå³ç³»(inappropriate intimacy)\n> \n> ä¸ä¸ªç±»å¤§éä½¿ç¨å¦ä¸ä¸ªç±»çåé¨å­æ®µåæ¹æ³ã\n\n\n\n\n# é®é¢åå \n\nç±»åç±»ä¹é´åºè¯¥å°½éå°çæç¥å½¼æ­¤ï¼åå°è¦åï¼ãè¿æ ·çç±»æ´å®¹æç»´æ¤åå¤ç¨ã\n\n\n# è§£å³æ¹æ³\n\n * æç®åçè§£å³æ¹æ³æ¯è¿ç¨ æ¬ç§»å½æ°(move method) å æ¬ç§»å­æ®µ(move field) æ¥è®©ç±»ä¹é´æ©æ­ç¾ç»ã\n\n\n\n * ä½ ä¹å¯ä»¥ççæ¯å¦è½è¿ç¨ å°ååå³èæ¹ä¸ºååå³è(change bidirectional association to unidirectional) è®©å¶ä¸­ä¸ä¸ªç±»å¯¹å¦ä¸ä¸ªè¯´åæã\n\n * å¦æè¿ä¸¤ä¸ªç±»å®å¨æ¯ææ¯éåï¼é¾åé¾èï¼å¯ä»¥è¿ç¨ æç¼ç±»(extract class) æäºèå±åç¹æç¼å°ä¸ä¸ªæ°ç±»ä¸­ï¼è®©å®ä»¬äº§çç±çç»æ¶ãæèï¼å¯ä»¥å°è¯è¿ç¨ éèå§æå³ç³»(hide delegate) è®©å¦ä¸ä¸ªç±»æ¥ä¸ºå®ä»¬çµçº¿æ­æ¡¥ã\n\n * ç»§æ¿å¾å¾é æç±»ä¹é´è¿åç´§å¯ï¼å ä¸ºå­ç±»å¯¹è¶ç±»çäºè§£æ»æ¯è¶è¿åèçä¸»è§æ¿æï¼å¦æä½ è§å¾è¯¥è®©è¿ä¸ªå­ç±»èªå·±é¯è¡ï¼è¯·è¿ç¨ ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation) æ¥è®©è¶ç±»åå­ç±»åå®¶ã\n\n\n# æ¶ç\n\n * æé«ä»£ç ç»ç»æ§ã\n * æé«ä»£ç å¤ç¨æ§ã\n\n\n\n\n# éææ¹æ³è¯´æ\n\n# æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n# æ¬ç§»å­æ®µ(move field)\n\né®é¢\n\nå¨ä½ çç¨åºä¸­ï¼æä¸ªå­æ®µè¢«å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»æ´å¤å°ç¨å°ã\n\n\n\nè§£å³\n\nå¨ç®æ ç±»æ°å»ºä¸ä¸ªå­æ®µï¼ä¿®æ¹æºå­æ®µçææç¨æ·ï¼ä»¤ä»ä»¬æ¹ç¨æ°å­æ®µã\n\n\n\n# å°ååå³èæ¹ä¸ºååå³è(change bidirectional association to unidirectional)\n\né®é¢\n\nä¸¤ä¸ªç±»ä¹é´æååå³èï¼ä½å¶ä¸­ä¸ä¸ªç±»å¦ä»ä¸åéè¦å¦ä¸ä¸ªç±»çç¹æ§ã\n\n\n\nè§£å³\n\nå»é¤ä¸å¿è¦çå³èã\n\n\n\n# æç¼ç±»(extract class)\n\né®é¢\n\næä¸ªç±»åäºä¸æ­¢ä¸ä»¶äºã\n\n\n\nè§£å³\n\nå»ºç«ä¸ä¸ªæ°ç±»ï¼å°ç¸å³çå­æ®µåå½æ°ä»æ§ç±»æ¬ç§»å°æ°ç±»ã\n\n\n\n# éèå§æå³ç³»(hide delegate)\n\né®é¢\n\nå®¢æ·éè¿ä¸ä¸ªå§æç±»æ¥è°ç¨å¦ä¸ä¸ªå¯¹è±¡ã\n\n\n\nè§£å³\n\nå¨æå¡ç±»ä¸å»ºç«å®¢æ·æéçææå½æ°ï¼ç¨ä»¥éèå§æå³ç³»ã\n\n\n\n# ä»¥å§æåä»£ç»§æ¿(replace inheritance with delegation)\n\né®é¢\n\næä¸ªå­ç±»åªä½¿ç¨è¶ç±»æ¥å£ä¸­çä¸é¨åï¼ææ¯æ ¹æ¬ä¸éè¦ç»§æ¿èæ¥çæ°æ®ã\n\n\n\nè§£å³\n\nå¨å­ç±»ä¸­æ°å»ºä¸ä¸ªå­æ®µç¨ä»¥ä¿å­è¶ç±»ï¼è°æ´å­ç±»å½æ°ï¼ä»¤å®æ¹èå§æè¶ç±»ï¼ç¶åå»æä¸¤èä¹é´çç»§æ¿å³ç³»ã\n\n\n\n\n# è¿åº¦è¦åçæ¶æ¯é¾\n\n> è¿åº¦è¦åçæ¶æ¯é¾(message chains)\n> \n> æ¶æ¯é¾çå½¢å¼ç±»ä¼¼äºï¼obj.geta().getb().getc()ã\n\n\n\n\n# é®é¢åå \n\nå¦æä½ çå°ç¨æ·åä¸ä¸ªå¯¹è±¡è¯·æ±å¦ä¸ä¸ªå¯¹è±¡ï¼ç¶ååååèè¯·æ±å¦ä¸ä¸ªå¯¹è±¡ï¼ç¶ååè¯·æ±å¦ä¸ä¸ªå¯¹è±¡â¦â¦è¿å°±æ¯æ¶æ¯é¾ãå®éä»£ç ä¸­ä½ çå°çå¯è½æ¯ä¸é¿ä¸² getthis()æä¸é¿ä¸²ä¸´æ¶åéãéåè¿ç§æ¹å¼ï¼æå³å®¢æ·ä»£ç å°ä¸æ¥æ¾è¿ç¨ä¸­çå¯¼èªç´§å¯è¦åãä¸æ¦å¯¹è±¡é´å³ç³»åçä»»ä½ååï¼å®¢æ·ç«¯å°±ä¸å¾ä¸ååºç¸åºçä¿®æ¹ã\n\n\n# è§£å³æ¹æ³\n\n * å¯ä»¥è¿ç¨ éèå§æå³ç³»(hide delegate) å é¤ä¸ä¸ªæ¶æ¯é¾ã\n\n\n\n * ææ¶æ´å¥½çéæ©æ¯ï¼åè§å¯æ¶æ¯é¾æç»å¾å°çå¯¹è±¡æ¯ç¨æ¥å¹²ä»ä¹çãççè½å¦ä»¥ æç¼å½æ°(extract method)æä½¿ç¨è¯¥å¯¹è±¡çä»£ç æç¼å°ä¸ä¸ªç¬ç«å½æ°ä¸­ï¼åè¿ç¨ æ¬ç§»å½æ°(move method) æè¿ä¸ªå½æ°æ¨å¥æ¶æ¯é¾ã\n\n\n# æ¶ç\n\n * è½åå°é¾ä¸­ç±»ä¹é´çä¾èµã\n * è½åå°ä»£ç éã\n\n\n\n\n# ä½æ¶å¿½ç¥\n\n * è¿äºä¾µç¥æ§çå§æå¯è½ä¼ä½¿ç¨åºåé¾ä»¥çè§£åè½æ¯å¦ä½è§¦åçã\n\n\n# éææ¹æ³è¯´æ\n\n# éèå§æå³ç³»(hide delegate)\n\né®é¢\n\nå®¢æ·éè¿ä¸ä¸ªå§æç±»æ¥è°ç¨å¦ä¸ä¸ªå¯¹è±¡ã\n\n\n\nè§£å³\n\nå¨æå¡ç±»ä¸å»ºç«å®¢æ·æéçææå½æ°ï¼ç¨ä»¥éèå§æå³ç³»ã\n\n\n\n# æç¼å½æ°(extract method)\n\né®é¢\n\nä½ æä¸æ®µä»£ç å¯ä»¥ç»ç»å¨ä¸èµ·ã\n\nvoid printowing() {\n  printbanner();\n\n  //print details\n  system.out.println("name: " + name);\n  system.out.println("amount: " + getoutstanding());\n}\n\n\nè§£å³\n\nç§»å¨è¿æ®µä»£ç å°ä¸ä¸ªæ°çå½æ°ä¸­ï¼ä½¿ç¨å½æ°çè°ç¨æ¥æ¿ä»£èä»£ç ã\n\nvoid printowing() {\n  printbanner();\n  printdetails(getoutstanding());\n}\n\nvoid printdetails(double outstanding) {\n  system.out.println("name: " + name);\n  system.out.println("amount: " + outstanding);\n}\n\n\n# æ¬ç§»å½æ°(move method)\n\né®é¢\n\nä½ çç¨åºä¸­ï¼æä¸ªå½æ°ä¸å¶æé©»ç±»ä¹å¤çå¦ä¸ä¸ªç±»è¿è¡æ´å¤äº¤æµï¼è°ç¨åèï¼æè¢«åèè°ç¨ã\n\n\n\nè§£å³\n\nå¨è¯¥å½æ°æå¸¸å¼ç¨çç±»ä¸­å»ºç«ä¸ä¸ªæçç±»ä¼¼è¡ä¸ºçæ°å½æ°ãå°æ§å½æ°åæä¸ä¸ªåçº¯çå§æå½æ°ï¼ææ¯æ§å½æ°å®å¨ç§»é¤ã\n\n\n\n\n# æ©å±éè¯»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# åèèµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"éæ",frontmatter:{title:"éæ",categories:["è®¾è®¡","éæ"],tags:["è®¾è®¡","éæ"],date:"2021-04-29T16:05:03.000Z",permalink:"/pages/156570/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/03.%E9%87%8D%E6%9E%84/",relativePath:"03.è®¾è®¡/03.éæ/README.md",key:"v-45cada9f",path:"/pages/156570/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:68},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:163},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:256}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# éæ\n\n> éææ¯ä¸æ¹åè½¯ä»¶ç³»ç»å¤é¨è¡ä¸ºçåæä¸ï¼æ¹åå®çåé¨ç»æã\n> \n> éæçç®çæ¯ä¸ºäºæé«ä»£ç çè´¨éåæ§è½ã\n\n\n\n\n# ð åå®¹\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# ð èµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾",normalizedContent:"# éæ\n\n> éææ¯ä¸æ¹åè½¯ä»¶ç³»ç»å¤é¨è¡ä¸ºçåæä¸ï¼æ¹åå®çåé¨ç»æã\n> \n> éæçç®çæ¯ä¸ºäºæé«ä»£ç çè´¨éåæ§è½ã\n\n\n\n\n# ð åå®¹\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# ð èµæ\n\n * ãä»£ç æ´æ´ä¹éã\n * ãéæ - æ¹åæ¢æä»£ç çè®¾è®¡ã\n * ãä»£ç å¤§å¨ã\n * https://sourcemaking.com/refactoring\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"éè¯¯å¤ç",frontmatter:{title:"éè¯¯å¤ç",categories:["è®¾è®¡","ç¼ç¨èå¼"],tags:["è®¾è®¡","ç¼ç¨èå¼"],date:"2020-08-13T23:32:37.000Z",permalink:"/pages/dc158b/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/04.%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F/01.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86.html",relativePath:"03.è®¾è®¡/04.ç¼ç¨èå¼/01.éè¯¯å¤ç.md",key:"v-612a002e",path:"/pages/dc158b/",headers:[{level:2,title:"éè¯¯çåç±»",slug:"éè¯¯çåç±»",normalizedTitle:"éè¯¯çåç±»",charIndex:11},{level:4,title:"èµæºçéè¯¯",slug:"èµæºçéè¯¯",normalizedTitle:"èµæºçéè¯¯",charIndex:20},{level:4,title:"ç¨åºçéè¯¯",slug:"ç¨åºçéè¯¯",normalizedTitle:"ç¨åºçéè¯¯",charIndex:194},{level:4,title:"ç¨æ·çéè¯¯",slug:"ç¨æ·çéè¯¯",normalizedTitle:"ç¨æ·çéè¯¯",charIndex:255},{level:2,title:"éè¯¯è¿åç åå¼å¸¸ææ",slug:"éè¯¯è¿åç åå¼å¸¸ææ",normalizedTitle:"éè¯¯è¿åç åå¼å¸¸ææ",charIndex:464},{level:2,title:"å¼æ­¥ç¼ç¨çéè¯¯å¤ç",slug:"å¼æ­¥ç¼ç¨çéè¯¯å¤ç",normalizedTitle:"å¼æ­¥ç¼ç¨çéè¯¯å¤ç",charIndex:558},{level:3,title:"callback éè¯¯å¤ç",slug:"callback-éè¯¯å¤ç",normalizedTitle:"callback éè¯¯å¤ç",charIndex:750},{level:3,title:"JavaScript ç Promise éè¯¯å¤ç",slug:"javascript-ç-promise-éè¯¯å¤ç",normalizedTitle:"javascript ç promise éè¯¯å¤ç",charIndex:1602},{level:3,title:"Java ç Promise æ¨¡å¼",slug:"java-ç-promise-æ¨¡å¼",normalizedTitle:"java ç promise æ¨¡å¼",charIndex:3445},{level:2,title:"éè¯¯å¤ççæä½³å®è·µ",slug:"éè¯¯å¤ççæä½³å®è·µ",normalizedTitle:"éè¯¯å¤ççæä½³å®è·µ",charIndex:4852}],headersStr:"éè¯¯çåç±» èµæºçéè¯¯ ç¨åºçéè¯¯ ç¨æ·çéè¯¯ éè¯¯è¿åç åå¼å¸¸ææ å¼æ­¥ç¼ç¨çéè¯¯å¤ç callback éè¯¯å¤ç JavaScript ç Promise éè¯¯å¤ç Java ç Promise æ¨¡å¼ éè¯¯å¤ççæä½³å®è·µ",content:'# éè¯¯å¤ç\n\n\n# éè¯¯çåç±»\n\n# èµæºçéè¯¯\n\nå½æä»¬çä»£ç å»è¯·æ±ä¸äºèµæºæ¶å¯¼è´çéè¯¯ï¼æ¯å¦æå¼ä¸ä¸ªæ²¡ææéçæä»¶ï¼åæä»¶æ¶åºç°çåéè¯¯ï¼åéæä»¶å°ç½ç»ç«¯åç°ç½ç»æéçéè¯¯ï¼ç­ç­ãè¿ä¸ç±»éè¯¯å±äºç¨åºè¿è¡ç¯å¢çé®é¢ãå¯¹äºè¿ç±»éè¯¯ï¼æçæä»¬å¯ä»¥å¤çï¼æçæä»¬åæ æ³å¤çãæ¯å¦ï¼åå­èå°½ãæ æº¢åºææ¯ä¸äºç¨åºè¿è¡æ¶å³é®æ§èµæºä¸è½æ»¡è¶³ç­ç­è¿äºæåµï¼æä»¬åªè½åæ­¢è¿è¡ï¼çè³éåºæ´ä¸ªç¨åºã\n\n# ç¨åºçéè¯¯\n\næ¯å¦ï¼ç©ºæéãéæ³åæ°ç­ãè¿ç±»æ¯æä»¬èªå·±ç¨åºçéè¯¯ï¼æä»¬è¦è®°å½ä¸æ¥ï¼åå¥æ¥å¿ï¼æå¥½è§¦åçæ§ç³»ç»æ¥è­¦ã\n\n# ç¨æ·çéè¯¯\n\næ¯å¦ï¼Bad RequestãBad Format ç­è¿ç±»ç±ç¨æ·ä¸åæ³è¾å¥å¸¦æ¥çéè¯¯ãè¿ç±»éè¯¯åºæ¬ä¸æ¯å¨ç¨æ·ç API å±ä¸åºç°çé®é¢ãæ¯å¦ï¼è§£æä¸ä¸ª XML æ JSON æä»¶ï¼ææ¯ç¨æ·è¾å¥çå­æ®µä¸åæ³ä¹ç±»çã\n\nå¯¹äºè¿ç±»é®é¢ï¼æä»¬éè¦åç¨æ·ç«¯æ¥éï¼è®©ç¨æ·èªå·±å¤çä¿®æ­£ä»ä»¬çè¾å¥ææä½ãç¶åï¼æä»¬æ­£å¸¸æ§è¡ï¼ä½æ¯éè¦åç»è®¡ï¼ç»è®¡ç¸åºçéè¯¯çï¼è¿æ ·æå©äºæä»¬æ¹åè½¯ä»¶ææ¯ä¾¦æµæ¯å¦ææ¶æçç¨æ·è¯·æ±ã\n\n\n# éè¯¯è¿åç åå¼å¸¸ææ\n\néè¯¯å¤çä¸è¬æä¸¤ç§æ¹å¼ï¼éè¯¯è¿åç åå¼å¸¸ææã\n\n * å¯¹äºæä»¬å¹¶ä¸ææä¼åççäºï¼æä»¬å¯ä»¥ä½¿ç¨å¼å¸¸ææï¼\n * å¯¹äºæä»¬è§å¾å¯è½ä¼åççäºï¼ä½¿ç¨è¿åç ã\n\n\n# å¼æ­¥ç¼ç¨çéè¯¯å¤ç\n\n * æ æ³ä½¿ç¨è¿åç ãå ä¸ºå½æ°å¨âè¢«âå¼æ­¥è¿è¡ä¸­ï¼æè°çè¿ååªæ¯æå¤çæäº¤ç»ä¸ä¸æ¡æä»¤ï¼èä¸æ¯æå½æ°è¿è¡å®çç»æè¿åãæä»¥ï¼å½æ°è¿åçè¯­ä¹å®å¨åäºï¼è¿åç ä¹æ²¡æç¨äºã\n * æ æ³ä½¿ç¨æå¼å¸¸çæ¹å¼ãå ä¸ºé¤äºä¸è¿°çå½æ°ç«é©¬è¿åçåå ä¹å¤ï¼æåºçå¼å¸¸ä¹å¨å¦å¤ä¸ä¸ªçº¿ç¨ä¸­ï¼ä¸åçº¿ç¨ä¸­çæ æ¯å®å¨ä¸ä¸æ ·çï¼æä»¥ä¸»çº¿ç¨ç catch å®å¨çä¸å°å¦å¤ä¸ä¸ªçº¿ç¨ä¸­çå¼å¸¸ã\n\n\n# callback éè¯¯å¤ç\n\nå¼æ­¥ç¼ç¨ä¸­ï¼æå¸¸ç¨çéè¯¯å¤çæ¹å¼å°±æ¯ callbackæ¹å¼ãå¨åå¼æ­¥è¯·æ±çæ¶åï¼æ³¨åå ä¸ª OnSuccess()ã OnFailure() è¿æ ·çå½æ°ï¼è®©å¨å¦ä¸ä¸ªçº¿ç¨ä¸­è¿è¡çå¼æ­¥ä»£ç æ¥åè°è¿æ¥ã\n\nãç¤ºä¾ãJavaScript å¼æ­¥ç¼ç¨çéè¯¯å¤ç\n\nfunction successCallback(result) {\n  console.log(\'It succeeded with \' + result)\n}\n\nfunction failureCallback(error) {\n  console.log(\'It failed with \' + error)\n}\n\ndoSomething(successCallback, failureCallback)\n\n\nä½æ¯ï¼ å¦ææä»¬éè¦æå ä¸ªå¼æ­¥å½æ°é¡ºåºæ§è¡çè¯ï¼å¼æ­¥ç¨åºä¸­ï¼ç¨åºæ§è¡çé¡ºåºæ¯ä¸å¯é¢æµçãä¹æ¯ä¸ç¡®å®çï¼èææ¶åï¼å½æ°è¢«è°ç¨çä¸ä¸ææ¯æç¸äºä¾èµçï¼æä»¥ï¼æä»¬å¸æå®ä»¬è½æä¸å®çé¡ºåºå¤çï¼ï¼å°±ä¼åºç°äºæè°ç Callback Hell çé®é¢ãå¦ä¸æç¤ºï¼\n\ndoSomething(function (result) {\n  doSomethingElse(\n    result,\n    function (newResult) {\n      doThirdThing(\n        newResult,\n        function (finalResult) {\n          console.log(\'Got the final result: \' + finalResult)\n        },\n        failureCallback\n      )\n    },\n    failureCallback\n  )\n}, failureCallback)\n\n\nèè¿æ ·å±å±åµå¥ä¸­éè¦æ³¨åçéè¯¯å¤çå½æ°ä¹æå¯è½æ¯å®å¨ä¸ä¸æ ·çï¼èä¸ä¼å¯¼è´ä»£ç éå¸¸æ··ä¹±ï¼é¾ä»¥éè¯»åç»´æ¤ã\n\n\n# JavaScript ç Promise éè¯¯å¤ç\n\nå¨å¼æ­¥ç¼ç¨çå®è·µéï¼ä½¿ç¨ Promise æ¨¡å¼æ¥å¤çæ´ä¸ºä¼éã\n\ndoSomething()\n.then(result => doSomethingElse(result))\n.then(newResult => doThirdThing(newResult))\n.then(finalResult => {\n  console.log(`Got the final result: ${finalResult}`);\n}).catch(failureCallback);\n\n\nä¸é¢ä»£ç ä¸­ç then() å catch() æ¹æ³å°±æ¯ Promise å¯¹è±¡çæ¹æ³ï¼then()æ¹æ³å¯ä»¥æåä¸ªå¼æ­¥çå½æ°ç»ä¸²èèµ·æ¥ï¼ècatch() æ¹æ³åæ¯åºéçå¤çã\n\nçå°ä¸é¢çé£ä¸ªçº§èå¼çè°ç¨æ¹å¼ï¼è¿å°±è¦æä»¬ç doSomething() å½æ°è¿å Promise å¯¹è±¡ï¼ä¸é¢æ¯è¿ä¸ªå½æ°çç¸å³ä»£ç ç¤ºä¾ï¼\n\nfunction doSomething() {\n\tlet promise = new Promise();\n\tlet xhr = new XMLHttpRequest();\n\txhr.open(\'GET\', \'http://coolshell.cn/....\', true);\n\n\txhr.onload = function (e) {\n        if (this.status === 200) {\n            results = JSON.parse(this.responseText);\n            promise.resolve(results); // æåæ¶ï¼è°ç¨ resolve() æ¹æ³\n        }\n    };\n\n    xhr.onerror = function (e) {\n        promise.reject(e); // å¤±è´¥æ¶ï¼è°ç¨ reject() æ¹æ³\n    };\n\n    xhr.send();\n    return promise;\n}\n\n\nä»ä¸é¢çä»£ç ç¤ºä¾ä¸­ï¼æä»¬å¯ä»¥çå°ï¼å¦ææåäºï¼è¦è°ç¨ Promise.resolve() æ¹æ³ï¼è¿æ · Promise å¯¹è±¡ä¼ç»§ç»­è°ç¨ä¸ä¸ä¸ª then()ãå¦æåºéäºå°±è°ç¨ Promise.reject() æ¹æ³ï¼è¿æ ·å°±ä¼å¿½ç¥åé¢ç then() ç´å° catch() æ¹æ³ã\n\næä»¬å¯ä»¥çå° Promise.reject() å°±åæ¯æå¼å¸¸ä¸æ ·ãè¿ä¸ªç¼ç¨æ¨¡å¼è®©æä»¬çä»£ç ç»ç»æ¹ä¾¿äºå¾å¤ã\n\nå¦å¤ï¼å¤è¯´ä¸å¥ï¼Promise è¿å¯ä»¥åæ¶ç­å¾ä¸¤ä¸ªä¸åçå¼æ­¥æ¹æ³ãæ¯å¦ä¸é¢çä»£ç æå±ç¤ºçæ¹å¼ï¼\n\npromise1 = doSomething();\npromise2 = doSomethingElse();\nPromise.when(promise1, promise2).then( function (result1, result2) {\n\t... // å¤ç result1 å result2 çä»£ç \n}, handleError);\n\n\nå¨ ECMAScript 2017 çæ åä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨async/await è¿ä¸¤ä¸ªå³é®å­æ¥åä»£ Promise å¯¹è±¡ï¼è¿æ ·å¯ä»¥è®©æä»¬çä»£ç æ´æè¯»ã\n\næ¯å¦ä¸é¢çä»£ç ç¤ºä¾ï¼\n\nasync function foo() {\n  try {\n    let result = await doSomething();\n    let newResult = await doSomethingElse(result);\n    let finalResult = await doThirdThing(newResult);\n    console.log(`Got the final result: ${finalResult}`);\n  } catch(error) {\n    failureCallback(error);\n  }\n}\n\n\nå¦æå¨å½æ°å®ä¹ä¹åä½¿ç¨äº async å³é®å­ï¼å°±å¯ä»¥å¨å½æ°åä½¿ç¨ awaitã å½å¨ await æä¸ª Promise æ¶ï¼å½æ°æåæ§è¡ï¼ç´è³è¯¥ Promise äº§çç»æï¼å¹¶ä¸æåä¸ä¼é»å¡ä¸»çº¿ç¨ã å¦æ Promise resolveï¼åä¼è¿åå¼ã å¦æ Promise rejectï¼åä¼æåºæç»çå¼ã\n\n\n# Java ç Promise æ¨¡å¼\n\nå¨ JDK 1.8 éä¹å¼å¥äºç±»ä¼¼ JavaScript çç©æ³ ââ CompletableFutureãè¿ä¸ªç±»æä¾äºå¤§éçå¼æ­¥ç¼ç¨ä¸­ Promise çåç§æ¹å¼ã\n\né¾å¼å¤çï¼\n\nCompletableFuture.supplyAsync(this::findReceiver)\n                 .thenApply(this::sendMsg)\n                 .thenAccept(this::notify);\n\n\nä¸é¢çè¿ä¸ªé¾å¼å¤çå JavaScript ä¸­çthen()æ¹æ³å¾åï¼å¶ä¸­ç supplyAsync() è¡¨ç¤ºæ§è¡ä¸ä¸ªå¼æ­¥æ¹æ³ï¼è thenApply() è¡¨ç¤ºæ§è¡æåååä¸²èå¦å¤ä¸ä¸ªå¼æ­¥æ¹æ³ï¼æåæ¯ thenAccept() æ¥å¤çæç»ç»æã\n\nä¸é¢è¿ä¸ªä¾å­æ¯è¦åå¹¶ä¸¤ä¸ªå¼æ­¥å½æ°çç»æï¼\n\nString result = CompletableFuture.supplyAsync(() -> {\n         return "hello";\n     }).thenCombine(CompletableFuture.supplyAsync(() -> {\n         return "world";\n     }), (s1, s2) -> s1 + " " + s2).join());\nSystem.out.println(result);\n\n\n\næ¥ä¸æ¥ï¼æä»¬åæ¥çä¸ä¸ï¼Java è¿ä¸ªç±»ç¸å³çå¼å¸¸å¤çï¼\n\nCompletableFuture.supplyAsync(Integer::parseInt) // è¾å¥: "ILLEGAL"\n\t\t\t     .thenApply(r -> r * 2 * Math.PI)\n\t\t\t     .thenApply(s -> "apply>> " + s)\n\t\t\t     .exceptionally(ex -> "Error: " + ex.getMessage());\n\n\næä»¬è¦æ³¨æå°ä¸é¢ä»£ç éç exceptionally() æ¹æ³ï¼è¿ä¸ªå JavaScript Promise ä¸­ç catch() æ¹æ³ç¸ä¼¼ã\n\nè¿è¡ä¸é¢çä»£ç ï¼ä¼åºç°å¦ä¸è¾åºï¼\n\nError: java.lang.NumberFormatException: For input string: "ILLEGAL"\n\n\nä¹å¯ä»¥è¿æ ·ï¼\n\nCompletableFuture.supplyAsync(Integer::parseInt) // è¾å¥: "ILLEGAL"\n\t\t\t\t .thenApply(r -> r * 2 * Math.PI)\n\t\t\t\t .thenApply(s -> "apply>> " + s)\n\t\t\t\t .handle((result, ex) -> {\n\t\t\t\t \tif (result != null) {\n\t\t\t\t \t\treturn result;\n\t\t\t\t \t} else {\n\t\t\t\t \t\treturn "Error handling: " + ex.getMessage();\n\t\t\t\t \t}\n\t\t\t\t });\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½ å¯ä»¥çå°ï¼å¶ä½¿ç¨äº handle() æ¹æ³æ¥å¤çæç»çç»æï¼å¶ä¸­åå«äºå¼æ­¥å½æ°ä¸­çéè¯¯å¤çã\n\n\n# éè¯¯å¤ççæä½³å®è·µ\n\n * ç»ä¸åç±»çéè¯¯å­å¸ãæ è®ºä½ æ¯ä½¿ç¨éè¯¯ç è¿æ¯å¼å¸¸ææï¼é½éè¦è®¤çå¹¶ç»ä¸å°åå¥½éè¯¯çåç±»ãæå¥½æ¯å¨ä¸ä¸ªå°æ¹å®ä¹ç¸å³çéè¯¯ãæ¯å¦ï¼HTTP ç 4XX è¡¨ç¤ºå®¢æ·ç«¯æé®é¢ï¼5XX åè¡¨ç¤ºæå¡ç«¯æé®é¢ãä¹å°±æ¯è¯´ï¼ä½ è¦å»ºç«ä¸ä¸ªéè¯¯å­å¸ã\n * åç±»éè¯¯çå®ä¹æå¥½æ¯å¯ä»¥æ©å±çãè¿ä¸ç¹éå¸¸éè¦ï¼èå¯¹äºè¿ä¸ç¹ï¼éè¿é¢åå¯¹è±¡çç»§æ¿ææ¯å Go è¯­è¨é£æ ·çæ¥å£å¤æå¯ä»¥å¾å¥½å°åå°ãè¿æ ·å¯ä»¥æ¹ä¾¿å°éç¨å·²æçä»£ç ã\n * å®ä¹éè¯¯çä¸¥éç¨åº¦ãæ¯å¦ï¼Fatal è¡¨ç¤ºéå¤§éè¯¯ï¼Error è¡¨ç¤ºèµæºæéæ±å¾ä¸å°æ»¡è¶³ï¼Warning è¡¨ç¤ºå¹¶ä¸ä¸å®æ¯ä¸ªéè¯¯ä½è¿æ¯éè¦å¼èµ·æ³¨æï¼Info è¡¨ç¤ºä¸æ¯éè¯¯åªæ¯ä¸ä¸ªä¿¡æ¯ï¼Debug è¡¨ç¤ºè¿æ¯ç»åé¨å¼åäººåç¨äºè°è¯ç¨åºçã\n * éè¯¯æ¥å¿çè¾åºæå¥½ä½¿ç¨éè¯¯ç ï¼èä¸æ¯éè¯¯ä¿¡æ¯ãæå°éè¯¯æ¥å¿çæ¶åï¼åºè¯¥ä½¿ç¨ç»ä¸çæ ¼å¼ãä½æå¥½ä¸è¦ç¨éè¯¯ä¿¡æ¯ï¼èåºä½¿ç¨ç¸åºçéè¯¯ç ï¼éè¯¯ç ä¸ä¸å®æ¯æ°å­ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªè½ä»éè¯¯å­å¸éæ¾å°çä¸ä¸ªå¯ä¸çå¯ä»¥è®©äººè¯»æçå³é®å­ãè¿æ ·ï¼ä¼éå¸¸æå©äºæ¥å¿åæè½¯ä»¶è¿è¡èªå¨åçæ§ï¼èä¸æ¯è¦ä»éè¯¯ä¿¡æ¯ä¸­åè¯­ä¹åæãæ¯å¦ï¼HTTP çæ¥å¿ä¸­å°±ä¼æ HTTP çè¿åç ï¼å¦ï¼404ãä½ææ´æ¨èä½¿ç¨åPageNotFoundè¿æ ·çæ è¯ï¼è¿æ ·äººåæºå¨é½å¾å®¹æå¤çã\n * å¿½ç¥éè¯¯æå¥½ææ¥å¿ãä¸ç¶ä¼ç»ç»´æ¤å¸¦æ¥å¾å¤§çéº»ç¦ã\n * å¯¹äºåä¸ä¸ªå°æ¹ä¸åçæ¥éï¼æå¥½ä¸è¦é½æå°æ¥å¿éãä¸ç¶è¿æ ·ä¼å¯¼è´å¶å®æ¥å¿è¢«æ·¹æ²¡äºï¼ä¹ä¼å¯¼è´æ¥å¿æä»¶å¤ªå¤§ãæå¥½çå®è·µæ¯ï¼æåºä¸ä¸ªéè¯¯ä»¥ååºç°çæ¬¡æ°ã\n * ä¸è¦ç¨éè¯¯å¤çé»è¾æ¥å¤çä¸å¡é»è¾ãä¹å°±æ¯è¯´ï¼ä¸è¦ä½¿ç¨å¼å¸¸ææè¿æ ·çæ¹å¼æ¥å¤çä¸å¡é»è¾ï¼èæ¯åºè¯¥ç¨æ¡ä»¶å¤æ­ãå¦æä¸ä¸ªé»è¾æ§å¶å¯ä»¥ç¨ if - else æ¸æ¥å°è¡¨è¾¾ï¼é£å°±ä¸å»ºè®®ä½¿ç¨å¼å¸¸æ¹å¼å¤çãå¼å¸¸æææ¯ç¨æ¥å¤çä¸ææåççäºæï¼èéè¯¯ç åç¨æ¥å¤çå¯è½ä¼åççäºã\n * å¯¹äºåç±»çéè¯¯å¤çï¼ç¨ä¸æ ·çæ¨¡å¼ãæ¯å¦ï¼å¯¹äºnullå¯¹è±¡çéè¯¯ï¼è¦ä¹é½ç¨è¿å nullï¼å ä¸æ¡ä»¶æ£æ¥çæ¨¡å¼ï¼è¦ä¹é½ç¨æ NullPointerException çæ¹å¼å¤çãä¸è¦æ··ç¨ï¼è¿æ ·æå©äºä»£ç è§èã\n * å°½å¯è½å¨éè¯¯åççå°æ¹å¤çéè¯¯ãå ä¸ºè¿æ ·ä¼è®©è°ç¨èåå¾æ´ç®åã\n * åä¸å°½å¯è½å°è¿ååå§çéè¯¯ãå¦æä¸å®è¦æéè¯¯è¿åå°æ´é«å±å»å¤çï¼é£ä¹ï¼åºè¯¥è¿ååå§çéè¯¯ï¼èä¸æ¯éæ°åæä¸ä¸ªéè¯¯ã\n * å¤çéè¯¯æ¶ï¼æ»æ¯è¦æ¸çå·²åéçèµæºãè¿ç¹éå¸¸å³é®ï¼ä½¿ç¨ RAII ææ¯ï¼ææ¯ try-catch-finallyï¼ææ¯ Go ç defer é½å¯ä»¥å®¹æå°åå°ã\n * ä¸æ¨èå¨å¾ªç¯ä½éå¤çéè¯¯ãè¿éè¯´çæ¯ try-catchï¼ç»å¤§å¤æ°çæåµä½ ä¸éè¦è¿æ ·åãæå¥½ææ´ä¸ªå¾ªç¯ä½å¤æ¾å¨ try è¯­å¥ååï¼èå¨å¤é¢å catchã\n * ä¸è¦æå¤§éçä»£ç é½æ¾å¨ä¸ä¸ª try è¯­å¥ååãä¸ä¸ª try è¯­å¥ååçè¯­å¥åºè¯¥æ¯å®æä¸ä¸ªç®ååä¸çäºæã\n * ä¸ºä½ çéè¯¯å®ä¹æä¾æ¸æ¥çææ¡£ä»¥åæ¯ç§éè¯¯çä»£ç ç¤ºä¾ãå¦æä½ æ¯å RESTful API æ¹é¢çï¼ä½¿ç¨ Swagger ä¼å¸®ä½ å¾å®¹ææå®è¿ä¸ªäºã\n * å¯¹äºå¼æ­¥çæ¹å¼ï¼æ¨èä½¿ç¨ Promise æ¨¡å¼å¤çéè¯¯ãå¯¹äºè¿ä¸ç¹ï¼JavaScript ä¸­æå¾å¥½çå®è·µã\n * å¯¹äºåå¸å¼çç³»ç»ï¼æ¨èä½¿ç¨ APM ç¸å³çè½¯ä»¶ãå°¤å¶æ¯ä½¿ç¨ Zipkin è¿æ ·çæå¡è°ç¨è·è¸ªçåææ¥å³èéè¯¯ã',normalizedContent:'# éè¯¯å¤ç\n\n\n# éè¯¯çåç±»\n\n# èµæºçéè¯¯\n\nå½æä»¬çä»£ç å»è¯·æ±ä¸äºèµæºæ¶å¯¼è´çéè¯¯ï¼æ¯å¦æå¼ä¸ä¸ªæ²¡ææéçæä»¶ï¼åæä»¶æ¶åºç°çåéè¯¯ï¼åéæä»¶å°ç½ç»ç«¯åç°ç½ç»æéçéè¯¯ï¼ç­ç­ãè¿ä¸ç±»éè¯¯å±äºç¨åºè¿è¡ç¯å¢çé®é¢ãå¯¹äºè¿ç±»éè¯¯ï¼æçæä»¬å¯ä»¥å¤çï¼æçæä»¬åæ æ³å¤çãæ¯å¦ï¼åå­èå°½ãæ æº¢åºææ¯ä¸äºç¨åºè¿è¡æ¶å³é®æ§èµæºä¸è½æ»¡è¶³ç­ç­è¿äºæåµï¼æä»¬åªè½åæ­¢è¿è¡ï¼çè³éåºæ´ä¸ªç¨åºã\n\n# ç¨åºçéè¯¯\n\næ¯å¦ï¼ç©ºæéãéæ³åæ°ç­ãè¿ç±»æ¯æä»¬èªå·±ç¨åºçéè¯¯ï¼æä»¬è¦è®°å½ä¸æ¥ï¼åå¥æ¥å¿ï¼æå¥½è§¦åçæ§ç³»ç»æ¥è­¦ã\n\n# ç¨æ·çéè¯¯\n\næ¯å¦ï¼bad requestãbad format ç­è¿ç±»ç±ç¨æ·ä¸åæ³è¾å¥å¸¦æ¥çéè¯¯ãè¿ç±»éè¯¯åºæ¬ä¸æ¯å¨ç¨æ·ç api å±ä¸åºç°çé®é¢ãæ¯å¦ï¼è§£æä¸ä¸ª xml æ json æä»¶ï¼ææ¯ç¨æ·è¾å¥çå­æ®µä¸åæ³ä¹ç±»çã\n\nå¯¹äºè¿ç±»é®é¢ï¼æä»¬éè¦åç¨æ·ç«¯æ¥éï¼è®©ç¨æ·èªå·±å¤çä¿®æ­£ä»ä»¬çè¾å¥ææä½ãç¶åï¼æä»¬æ­£å¸¸æ§è¡ï¼ä½æ¯éè¦åç»è®¡ï¼ç»è®¡ç¸åºçéè¯¯çï¼è¿æ ·æå©äºæä»¬æ¹åè½¯ä»¶ææ¯ä¾¦æµæ¯å¦ææ¶æçç¨æ·è¯·æ±ã\n\n\n# éè¯¯è¿åç åå¼å¸¸ææ\n\néè¯¯å¤çä¸è¬æä¸¤ç§æ¹å¼ï¼éè¯¯è¿åç åå¼å¸¸ææã\n\n * å¯¹äºæä»¬å¹¶ä¸ææä¼åççäºï¼æä»¬å¯ä»¥ä½¿ç¨å¼å¸¸ææï¼\n * å¯¹äºæä»¬è§å¾å¯è½ä¼åççäºï¼ä½¿ç¨è¿åç ã\n\n\n# å¼æ­¥ç¼ç¨çéè¯¯å¤ç\n\n * æ æ³ä½¿ç¨è¿åç ãå ä¸ºå½æ°å¨âè¢«âå¼æ­¥è¿è¡ä¸­ï¼æè°çè¿ååªæ¯æå¤çæäº¤ç»ä¸ä¸æ¡æä»¤ï¼èä¸æ¯æå½æ°è¿è¡å®çç»æè¿åãæä»¥ï¼å½æ°è¿åçè¯­ä¹å®å¨åäºï¼è¿åç ä¹æ²¡æç¨äºã\n * æ æ³ä½¿ç¨æå¼å¸¸çæ¹å¼ãå ä¸ºé¤äºä¸è¿°çå½æ°ç«é©¬è¿åçåå ä¹å¤ï¼æåºçå¼å¸¸ä¹å¨å¦å¤ä¸ä¸ªçº¿ç¨ä¸­ï¼ä¸åçº¿ç¨ä¸­çæ æ¯å®å¨ä¸ä¸æ ·çï¼æä»¥ä¸»çº¿ç¨ç catch å®å¨çä¸å°å¦å¤ä¸ä¸ªçº¿ç¨ä¸­çå¼å¸¸ã\n\n\n# callback éè¯¯å¤ç\n\nå¼æ­¥ç¼ç¨ä¸­ï¼æå¸¸ç¨çéè¯¯å¤çæ¹å¼å°±æ¯ callbackæ¹å¼ãå¨åå¼æ­¥è¯·æ±çæ¶åï¼æ³¨åå ä¸ª onsuccess()ã onfailure() è¿æ ·çå½æ°ï¼è®©å¨å¦ä¸ä¸ªçº¿ç¨ä¸­è¿è¡çå¼æ­¥ä»£ç æ¥åè°è¿æ¥ã\n\nãç¤ºä¾ãjavascript å¼æ­¥ç¼ç¨çéè¯¯å¤ç\n\nfunction successcallback(result) {\n  console.log(\'it succeeded with \' + result)\n}\n\nfunction failurecallback(error) {\n  console.log(\'it failed with \' + error)\n}\n\ndosomething(successcallback, failurecallback)\n\n\nä½æ¯ï¼ å¦ææä»¬éè¦æå ä¸ªå¼æ­¥å½æ°é¡ºåºæ§è¡çè¯ï¼å¼æ­¥ç¨åºä¸­ï¼ç¨åºæ§è¡çé¡ºåºæ¯ä¸å¯é¢æµçãä¹æ¯ä¸ç¡®å®çï¼èææ¶åï¼å½æ°è¢«è°ç¨çä¸ä¸ææ¯æç¸äºä¾èµçï¼æä»¥ï¼æä»¬å¸æå®ä»¬è½æä¸å®çé¡ºåºå¤çï¼ï¼å°±ä¼åºç°äºæè°ç callback hell çé®é¢ãå¦ä¸æç¤ºï¼\n\ndosomething(function (result) {\n  dosomethingelse(\n    result,\n    function (newresult) {\n      dothirdthing(\n        newresult,\n        function (finalresult) {\n          console.log(\'got the final result: \' + finalresult)\n        },\n        failurecallback\n      )\n    },\n    failurecallback\n  )\n}, failurecallback)\n\n\nèè¿æ ·å±å±åµå¥ä¸­éè¦æ³¨åçéè¯¯å¤çå½æ°ä¹æå¯è½æ¯å®å¨ä¸ä¸æ ·çï¼èä¸ä¼å¯¼è´ä»£ç éå¸¸æ··ä¹±ï¼é¾ä»¥éè¯»åç»´æ¤ã\n\n\n# javascript ç promise éè¯¯å¤ç\n\nå¨å¼æ­¥ç¼ç¨çå®è·µéï¼ä½¿ç¨ promise æ¨¡å¼æ¥å¤çæ´ä¸ºä¼éã\n\ndosomething()\n.then(result => dosomethingelse(result))\n.then(newresult => dothirdthing(newresult))\n.then(finalresult => {\n  console.log(`got the final result: ${finalresult}`);\n}).catch(failurecallback);\n\n\nä¸é¢ä»£ç ä¸­ç then() å catch() æ¹æ³å°±æ¯ promise å¯¹è±¡çæ¹æ³ï¼then()æ¹æ³å¯ä»¥æåä¸ªå¼æ­¥çå½æ°ç»ä¸²èèµ·æ¥ï¼ècatch() æ¹æ³åæ¯åºéçå¤çã\n\nçå°ä¸é¢çé£ä¸ªçº§èå¼çè°ç¨æ¹å¼ï¼è¿å°±è¦æä»¬ç dosomething() å½æ°è¿å promise å¯¹è±¡ï¼ä¸é¢æ¯è¿ä¸ªå½æ°çç¸å³ä»£ç ç¤ºä¾ï¼\n\nfunction dosomething() {\n\tlet promise = new promise();\n\tlet xhr = new xmlhttprequest();\n\txhr.open(\'get\', \'http://coolshell.cn/....\', true);\n\n\txhr.onload = function (e) {\n        if (this.status === 200) {\n            results = json.parse(this.responsetext);\n            promise.resolve(results); // æåæ¶ï¼è°ç¨ resolve() æ¹æ³\n        }\n    };\n\n    xhr.onerror = function (e) {\n        promise.reject(e); // å¤±è´¥æ¶ï¼è°ç¨ reject() æ¹æ³\n    };\n\n    xhr.send();\n    return promise;\n}\n\n\nä»ä¸é¢çä»£ç ç¤ºä¾ä¸­ï¼æä»¬å¯ä»¥çå°ï¼å¦ææåäºï¼è¦è°ç¨ promise.resolve() æ¹æ³ï¼è¿æ · promise å¯¹è±¡ä¼ç»§ç»­è°ç¨ä¸ä¸ä¸ª then()ãå¦æåºéäºå°±è°ç¨ promise.reject() æ¹æ³ï¼è¿æ ·å°±ä¼å¿½ç¥åé¢ç then() ç´å° catch() æ¹æ³ã\n\næä»¬å¯ä»¥çå° promise.reject() å°±åæ¯æå¼å¸¸ä¸æ ·ãè¿ä¸ªç¼ç¨æ¨¡å¼è®©æä»¬çä»£ç ç»ç»æ¹ä¾¿äºå¾å¤ã\n\nå¦å¤ï¼å¤è¯´ä¸å¥ï¼promise è¿å¯ä»¥åæ¶ç­å¾ä¸¤ä¸ªä¸åçå¼æ­¥æ¹æ³ãæ¯å¦ä¸é¢çä»£ç æå±ç¤ºçæ¹å¼ï¼\n\npromise1 = dosomething();\npromise2 = dosomethingelse();\npromise.when(promise1, promise2).then( function (result1, result2) {\n\t... // å¤ç result1 å result2 çä»£ç \n}, handleerror);\n\n\nå¨ ecmascript 2017 çæ åä¸­ï¼æä»¬å¯ä»¥ä½¿ç¨async/await è¿ä¸¤ä¸ªå³é®å­æ¥åä»£ promise å¯¹è±¡ï¼è¿æ ·å¯ä»¥è®©æä»¬çä»£ç æ´æè¯»ã\n\næ¯å¦ä¸é¢çä»£ç ç¤ºä¾ï¼\n\nasync function foo() {\n  try {\n    let result = await dosomething();\n    let newresult = await dosomethingelse(result);\n    let finalresult = await dothirdthing(newresult);\n    console.log(`got the final result: ${finalresult}`);\n  } catch(error) {\n    failurecallback(error);\n  }\n}\n\n\nå¦æå¨å½æ°å®ä¹ä¹åä½¿ç¨äº async å³é®å­ï¼å°±å¯ä»¥å¨å½æ°åä½¿ç¨ awaitã å½å¨ await æä¸ª promise æ¶ï¼å½æ°æåæ§è¡ï¼ç´è³è¯¥ promise äº§çç»æï¼å¹¶ä¸æåä¸ä¼é»å¡ä¸»çº¿ç¨ã å¦æ promise resolveï¼åä¼è¿åå¼ã å¦æ promise rejectï¼åä¼æåºæç»çå¼ã\n\n\n# java ç promise æ¨¡å¼\n\nå¨ jdk 1.8 éä¹å¼å¥äºç±»ä¼¼ javascript çç©æ³ ââ completablefutureãè¿ä¸ªç±»æä¾äºå¤§éçå¼æ­¥ç¼ç¨ä¸­ promise çåç§æ¹å¼ã\n\né¾å¼å¤çï¼\n\ncompletablefuture.supplyasync(this::findreceiver)\n                 .thenapply(this::sendmsg)\n                 .thenaccept(this::notify);\n\n\nä¸é¢çè¿ä¸ªé¾å¼å¤çå javascript ä¸­çthen()æ¹æ³å¾åï¼å¶ä¸­ç supplyasync() è¡¨ç¤ºæ§è¡ä¸ä¸ªå¼æ­¥æ¹æ³ï¼è thenapply() è¡¨ç¤ºæ§è¡æåååä¸²èå¦å¤ä¸ä¸ªå¼æ­¥æ¹æ³ï¼æåæ¯ thenaccept() æ¥å¤çæç»ç»æã\n\nä¸é¢è¿ä¸ªä¾å­æ¯è¦åå¹¶ä¸¤ä¸ªå¼æ­¥å½æ°çç»æï¼\n\nstring result = completablefuture.supplyasync(() -> {\n         return "hello";\n     }).thencombine(completablefuture.supplyasync(() -> {\n         return "world";\n     }), (s1, s2) -> s1 + " " + s2).join());\nsystem.out.println(result);\n\n\n\næ¥ä¸æ¥ï¼æä»¬åæ¥çä¸ä¸ï¼java è¿ä¸ªç±»ç¸å³çå¼å¸¸å¤çï¼\n\ncompletablefuture.supplyasync(integer::parseint) // è¾å¥: "illegal"\n\t\t\t     .thenapply(r -> r * 2 * math.pi)\n\t\t\t     .thenapply(s -> "apply>> " + s)\n\t\t\t     .exceptionally(ex -> "error: " + ex.getmessage());\n\n\næä»¬è¦æ³¨æå°ä¸é¢ä»£ç éç exceptionally() æ¹æ³ï¼è¿ä¸ªå javascript promise ä¸­ç catch() æ¹æ³ç¸ä¼¼ã\n\nè¿è¡ä¸é¢çä»£ç ï¼ä¼åºç°å¦ä¸è¾åºï¼\n\nerror: java.lang.numberformatexception: for input string: "illegal"\n\n\nä¹å¯ä»¥è¿æ ·ï¼\n\ncompletablefuture.supplyasync(integer::parseint) // è¾å¥: "illegal"\n\t\t\t\t .thenapply(r -> r * 2 * math.pi)\n\t\t\t\t .thenapply(s -> "apply>> " + s)\n\t\t\t\t .handle((result, ex) -> {\n\t\t\t\t \tif (result != null) {\n\t\t\t\t \t\treturn result;\n\t\t\t\t \t} else {\n\t\t\t\t \t\treturn "error handling: " + ex.getmessage();\n\t\t\t\t \t}\n\t\t\t\t });\n\n\nä¸é¢ä»£ç ä¸­ï¼ä½ å¯ä»¥çå°ï¼å¶ä½¿ç¨äº handle() æ¹æ³æ¥å¤çæç»çç»æï¼å¶ä¸­åå«äºå¼æ­¥å½æ°ä¸­çéè¯¯å¤çã\n\n\n# éè¯¯å¤ççæä½³å®è·µ\n\n * ç»ä¸åç±»çéè¯¯å­å¸ãæ è®ºä½ æ¯ä½¿ç¨éè¯¯ç è¿æ¯å¼å¸¸ææï¼é½éè¦è®¤çå¹¶ç»ä¸å°åå¥½éè¯¯çåç±»ãæå¥½æ¯å¨ä¸ä¸ªå°æ¹å®ä¹ç¸å³çéè¯¯ãæ¯å¦ï¼http ç 4xx è¡¨ç¤ºå®¢æ·ç«¯æé®é¢ï¼5xx åè¡¨ç¤ºæå¡ç«¯æé®é¢ãä¹å°±æ¯è¯´ï¼ä½ è¦å»ºç«ä¸ä¸ªéè¯¯å­å¸ã\n * åç±»éè¯¯çå®ä¹æå¥½æ¯å¯ä»¥æ©å±çãè¿ä¸ç¹éå¸¸éè¦ï¼èå¯¹äºè¿ä¸ç¹ï¼éè¿é¢åå¯¹è±¡çç»§æ¿ææ¯å go è¯­è¨é£æ ·çæ¥å£å¤æå¯ä»¥å¾å¥½å°åå°ãè¿æ ·å¯ä»¥æ¹ä¾¿å°éç¨å·²æçä»£ç ã\n * å®ä¹éè¯¯çä¸¥éç¨åº¦ãæ¯å¦ï¼fatal è¡¨ç¤ºéå¤§éè¯¯ï¼error è¡¨ç¤ºèµæºæéæ±å¾ä¸å°æ»¡è¶³ï¼warning è¡¨ç¤ºå¹¶ä¸ä¸å®æ¯ä¸ªéè¯¯ä½è¿æ¯éè¦å¼èµ·æ³¨æï¼info è¡¨ç¤ºä¸æ¯éè¯¯åªæ¯ä¸ä¸ªä¿¡æ¯ï¼debug è¡¨ç¤ºè¿æ¯ç»åé¨å¼åäººåç¨äºè°è¯ç¨åºçã\n * éè¯¯æ¥å¿çè¾åºæå¥½ä½¿ç¨éè¯¯ç ï¼èä¸æ¯éè¯¯ä¿¡æ¯ãæå°éè¯¯æ¥å¿çæ¶åï¼åºè¯¥ä½¿ç¨ç»ä¸çæ ¼å¼ãä½æå¥½ä¸è¦ç¨éè¯¯ä¿¡æ¯ï¼èåºä½¿ç¨ç¸åºçéè¯¯ç ï¼éè¯¯ç ä¸ä¸å®æ¯æ°å­ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªè½ä»éè¯¯å­å¸éæ¾å°çä¸ä¸ªå¯ä¸çå¯ä»¥è®©äººè¯»æçå³é®å­ãè¿æ ·ï¼ä¼éå¸¸æå©äºæ¥å¿åæè½¯ä»¶è¿è¡èªå¨åçæ§ï¼èä¸æ¯è¦ä»éè¯¯ä¿¡æ¯ä¸­åè¯­ä¹åæãæ¯å¦ï¼http çæ¥å¿ä¸­å°±ä¼æ http çè¿åç ï¼å¦ï¼404ãä½ææ´æ¨èä½¿ç¨åpagenotfoundè¿æ ·çæ è¯ï¼è¿æ ·äººåæºå¨é½å¾å®¹æå¤çã\n * å¿½ç¥éè¯¯æå¥½ææ¥å¿ãä¸ç¶ä¼ç»ç»´æ¤å¸¦æ¥å¾å¤§çéº»ç¦ã\n * å¯¹äºåä¸ä¸ªå°æ¹ä¸åçæ¥éï¼æå¥½ä¸è¦é½æå°æ¥å¿éãä¸ç¶è¿æ ·ä¼å¯¼è´å¶å®æ¥å¿è¢«æ·¹æ²¡äºï¼ä¹ä¼å¯¼è´æ¥å¿æä»¶å¤ªå¤§ãæå¥½çå®è·µæ¯ï¼æåºä¸ä¸ªéè¯¯ä»¥ååºç°çæ¬¡æ°ã\n * ä¸è¦ç¨éè¯¯å¤çé»è¾æ¥å¤çä¸å¡é»è¾ãä¹å°±æ¯è¯´ï¼ä¸è¦ä½¿ç¨å¼å¸¸ææè¿æ ·çæ¹å¼æ¥å¤çä¸å¡é»è¾ï¼èæ¯åºè¯¥ç¨æ¡ä»¶å¤æ­ãå¦æä¸ä¸ªé»è¾æ§å¶å¯ä»¥ç¨ if - else æ¸æ¥å°è¡¨è¾¾ï¼é£å°±ä¸å»ºè®®ä½¿ç¨å¼å¸¸æ¹å¼å¤çãå¼å¸¸æææ¯ç¨æ¥å¤çä¸ææåççäºæï¼èéè¯¯ç åç¨æ¥å¤çå¯è½ä¼åççäºã\n * å¯¹äºåç±»çéè¯¯å¤çï¼ç¨ä¸æ ·çæ¨¡å¼ãæ¯å¦ï¼å¯¹äºnullå¯¹è±¡çéè¯¯ï¼è¦ä¹é½ç¨è¿å nullï¼å ä¸æ¡ä»¶æ£æ¥çæ¨¡å¼ï¼è¦ä¹é½ç¨æ nullpointerexception çæ¹å¼å¤çãä¸è¦æ··ç¨ï¼è¿æ ·æå©äºä»£ç è§èã\n * å°½å¯è½å¨éè¯¯åççå°æ¹å¤çéè¯¯ãå ä¸ºè¿æ ·ä¼è®©è°ç¨èåå¾æ´ç®åã\n * åä¸å°½å¯è½å°è¿ååå§çéè¯¯ãå¦æä¸å®è¦æéè¯¯è¿åå°æ´é«å±å»å¤çï¼é£ä¹ï¼åºè¯¥è¿ååå§çéè¯¯ï¼èä¸æ¯éæ°åæä¸ä¸ªéè¯¯ã\n * å¤çéè¯¯æ¶ï¼æ»æ¯è¦æ¸çå·²åéçèµæºãè¿ç¹éå¸¸å³é®ï¼ä½¿ç¨ raii ææ¯ï¼ææ¯ try-catch-finallyï¼ææ¯ go ç defer é½å¯ä»¥å®¹æå°åå°ã\n * ä¸æ¨èå¨å¾ªç¯ä½éå¤çéè¯¯ãè¿éè¯´çæ¯ try-catchï¼ç»å¤§å¤æ°çæåµä½ ä¸éè¦è¿æ ·åãæå¥½ææ´ä¸ªå¾ªç¯ä½å¤æ¾å¨ try è¯­å¥ååï¼èå¨å¤é¢å catchã\n * ä¸è¦æå¤§éçä»£ç é½æ¾å¨ä¸ä¸ª try è¯­å¥ååãä¸ä¸ª try è¯­å¥ååçè¯­å¥åºè¯¥æ¯å®æä¸ä¸ªç®ååä¸çäºæã\n * ä¸ºä½ çéè¯¯å®ä¹æä¾æ¸æ¥çææ¡£ä»¥åæ¯ç§éè¯¯çä»£ç ç¤ºä¾ãå¦æä½ æ¯å restful api æ¹é¢çï¼ä½¿ç¨ swagger ä¼å¸®ä½ å¾å®¹ææå®è¿ä¸ªäºã\n * å¯¹äºå¼æ­¥çæ¹å¼ï¼æ¨èä½¿ç¨ promise æ¨¡å¼å¤çéè¯¯ãå¯¹äºè¿ä¸ç¹ï¼javascript ä¸­æå¾å¥½çå®è·µã\n * å¯¹äºåå¸å¼çç³»ç»ï¼æ¨èä½¿ç¨ apm ç¸å³çè½¯ä»¶ãå°¤å¶æ¯ä½¿ç¨ zipkin è¿æ ·çæå¡è°ç¨è·è¸ªçåææ¥å³èéè¯¯ã',charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"ç¼ç¨èå¼",frontmatter:{title:"ç¼ç¨èå¼",categories:["è®¾è®¡","ç¼ç¨èå¼"],tags:["è®¾è®¡","ç¼ç¨èå¼"],date:"2021-04-29T16:05:03.000Z",permalink:"/pages/9e0f8e/"},regularPath:"/03.%E8%AE%BE%E8%AE%A1/04.%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F/",relativePath:"03.è®¾è®¡/04.ç¼ç¨èå¼/README.md",key:"v-179f8f74",path:"/pages/9e0f8e/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:11},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:30},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:76}],headersStr:"ð åå®¹ ð èµæ ðª ä¼ é",content:"# ç¼ç¨èå¼\n\n\n# ð åå®¹\n\n * éè¯¯å¤ç\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãç¨åºåä¿®ç¼ä¹éã\n   * ãä»£ç æ´æ´ä¹éã\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢",normalizedContent:"# ç¼ç¨èå¼\n\n\n# ð åå®¹\n\n * éè¯¯å¤ç\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãç¨åºåä¿®ç¼ä¹éã\n   * ãä»£ç æ´æ´ä¹éã\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"å½æ¡£",frontmatter:{archivesPage:!0,title:"å½æ¡£",permalink:"/archives/",article:!1},regularPath:"/@pages/archivesPage.html",relativePath:"@pages/archivesPage.md",key:"v-02e2a776",path:"/archives/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"åç±»",frontmatter:{categoriesPage:!0,title:"åç±»",permalink:"/categories/",article:!1},regularPath:"/@pages/categoriesPage.html",relativePath:"@pages/categoriesPage.md",key:"v-20b770b6",path:"/categories/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"æ ç­¾",frontmatter:{tagsPage:!0,title:"æ ç­¾",permalink:"/tags/",article:!1},regularPath:"/@pages/tagsPage.html",relativePath:"@pages/tagsPage.md",key:"v-0480d1c5",path:"/tags/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3},{title:"Home",frontmatter:{home:!0,heroImage:"img/bg.gif",heroText:"Design",tagline:"Design æ¯ä¸ªäººå¯¹äºæ¶æçå¿å¾åæ»ç»ã",bannerBg:"none",postList:"none",footer:"CC-BY-SA-4.0 Licensed | Copyright Â© 2018-Now Dunwu"},regularPath:"/",relativePath:"README.md",key:"v-7e5bbd14",path:"/",headers:[{level:2,title:"ð åå®¹",slug:"ð-åå®¹",normalizedTitle:"ð åå®¹",charIndex:134},{level:3,title:"è®¾è®¡æ­¥éª¤",slug:"è®¾è®¡æ­¥éª¤",normalizedTitle:"è®¾è®¡æ­¥éª¤",charIndex:144},{level:4,title:"ç¬¬ä¸æ­¥ï¼éæ±åæ",slug:"ç¬¬ä¸æ­¥-éæ±åæ",normalizedTitle:"ç¬¬ä¸æ­¥ï¼éæ±åæ",charIndex:296},{level:4,title:"ç¬¬äºæ­¥ï¼é¡¶å±è®¾è®¡",slug:"ç¬¬äºæ­¥-é¡¶å±è®¾è®¡",normalizedTitle:"ç¬¬äºæ­¥ï¼é¡¶å±è®¾è®¡",charIndex:638},{level:4,title:"ç¬¬ä¸æ­¥ï¼ç»ä»¶è®¾è®¡",slug:"ç¬¬ä¸æ­¥-ç»ä»¶è®¾è®¡",normalizedTitle:"ç¬¬ä¸æ­¥ï¼ç»ä»¶è®¾è®¡",charIndex:699},{level:4,title:"ç¬¬åæ­¥ï¼æ©å±è®¾è®¡",slug:"ç¬¬åæ­¥-æ©å±è®¾è®¡",normalizedTitle:"ç¬¬åæ­¥ï¼æ©å±è®¾è®¡",charIndex:731},{level:3,title:"æ¶æè®¾è®¡",slug:"æ¶æè®¾è®¡",normalizedTitle:"æ¶æè®¾è®¡",charIndex:817},{level:3,title:"åå¸å¼",slug:"åå¸å¼",normalizedTitle:"åå¸å¼",charIndex:1125},{level:4,title:"åå¸å¼ç»¼å",slug:"åå¸å¼ç»¼å",normalizedTitle:"åå¸å¼ç»¼å",charIndex:1132},{level:4,title:"åå¸å¼çè®º",slug:"åå¸å¼çè®º",normalizedTitle:"åå¸å¼çè®º",charIndex:1153},{level:4,title:"åå¸å¼å³é®ææ¯",slug:"åå¸å¼å³é®ææ¯",normalizedTitle:"åå¸å¼å³é®ææ¯",charIndex:1282},{level:5,title:"æµéè°åº¦",slug:"æµéè°åº¦",normalizedTitle:"æµéè°åº¦",charIndex:1318},{level:5,title:"æ°æ®è°åº¦",slug:"æ°æ®è°åº¦",normalizedTitle:"æ°æ®è°åº¦",charIndex:1513},{level:5,title:"èµæºè°åº¦",slug:"èµæºè°åº¦",normalizedTitle:"èµæºè°åº¦",charIndex:1750},{level:5,title:"éä¿¡",slug:"éä¿¡",normalizedTitle:"éä¿¡",charIndex:1767},{level:5,title:"æå¡æ²»ç",slug:"æå¡æ²»ç",normalizedTitle:"æå¡æ²»ç",charIndex:1809},{level:4,title:"åå¸å¼åºç¨",slug:"åå¸å¼åºç¨",normalizedTitle:"åå¸å¼åºç¨",charIndex:2019},{level:5,title:"å¾®æå¡",slug:"å¾®æå¡",normalizedTitle:"å¾®æå¡",charIndex:2028},{level:3,title:"è®¾è®¡æ¹æ³",slug:"è®¾è®¡æ¹æ³",normalizedTitle:"è®¾è®¡æ¹æ³",charIndex:2046},{level:4,title:"UML",slug:"uml",normalizedTitle:"uml",charIndex:2054},{level:4,title:"è®¾è®¡æ¨¡å¼",slug:"è®¾è®¡æ¨¡å¼",normalizedTitle:"è®¾è®¡æ¨¡å¼",charIndex:2279},{level:5,title:"åå»ºåæ¨¡å¼",slug:"åå»ºåæ¨¡å¼",normalizedTitle:"åå»ºåæ¨¡å¼",charIndex:2411},{level:5,title:"ç»æåæ¨¡å¼",slug:"ç»æåæ¨¡å¼",normalizedTitle:"ç»æåæ¨¡å¼",charIndex:2563},{level:5,title:"è¡ä¸ºåæ¨¡å¼",slug:"è¡ä¸ºåæ¨¡å¼",normalizedTitle:"è¡ä¸ºåæ¨¡å¼",charIndex:2702},{level:4,title:"éæ",slug:"éæ",normalizedTitle:"éæ",charIndex:2949},{level:2,title:"ð èµæ",slug:"ð-èµæ",normalizedTitle:"ð èµæ",charIndex:3200},{level:2,title:"ðª ä¼ é",slug:"ðª-ä¼ é",normalizedTitle:"ðª ä¼ é",charIndex:3742}],headersStr:"ð åå®¹ è®¾è®¡æ­¥éª¤ ç¬¬ä¸æ­¥ï¼éæ±åæ ç¬¬äºæ­¥ï¼é¡¶å±è®¾è®¡ ç¬¬ä¸æ­¥ï¼ç»ä»¶è®¾è®¡ ç¬¬åæ­¥ï¼æ©å±è®¾è®¡ æ¶æè®¾è®¡ åå¸å¼ åå¸å¼ç»¼å åå¸å¼çè®º åå¸å¼å³é®ææ¯ æµéè°åº¦ æ°æ®è°åº¦ èµæºè°åº¦ éä¿¡ æå¡æ²»ç åå¸å¼åºç¨ å¾®æå¡ è®¾è®¡æ¹æ³ UML è®¾è®¡æ¨¡å¼ åå»ºåæ¨¡å¼ ç»æåæ¨¡å¼ è¡ä¸ºåæ¨¡å¼ éæ ð èµæ ðª ä¼ é",content:"> â DESIGN æ¯ä¸ªäººå¯¹äºè½¯ä»¶ç³»ç»æ¶æçå¿å¾åæ»ç»ã\n> \n> æ¶æä¹éï¼å¨äºæè¡¡ï¼æè¡¡ä¹æ¯ï¼å¨äºåèã\n> \n>  * ð é¡¹ç®åæ­¥ç»´æ¤ï¼Github | Gitee\n>  * ð çµå­ä¹¦éè¯»ï¼Github Pages | Gitee Pages\n\n\n# ð åå®¹\n\n\n# è®¾è®¡æ­¥éª¤\n\nè§£å³æ¹æ¡ï¼Solutionï¼ï¼å°±æ¯éå¯¹æäºå·²ç»ä½ç°åºçï¼æèå¯ä»¥é¢æçé®é¢ãä¸è¶³ãç¼ºé·ãéæ±ç­ç­ï¼ææåºçä¸ä¸ªè§£å³æ´ä½é®é¢çå¯è¡æ§æ¹æ¡ãå°±è½¯ä»¶ç³»ç»èè¨ï¼è§£å³æ¹æ¡å°±æ¯ä¸ä¸ªå¯ä»¥è§£å³å·ä½ä¸å¡é®é¢ï¼å¹¶ä¸å¯ä»¥è½å°çè½¯ä»¶ç³»ç»ã\n\nè§£å³æ¹æ¡ï¼æ¯«æ çé®æ¯é¡¶å±ç³»ç»è®¾è®¡ï¼è¿éè¦è®¾è®¡èæ¢æææ¯ï¼ä¹æä¸å¡ã\n\n# ç¬¬ä¸æ­¥ï¼éæ±åæ\n\næææéè¦çä¸è¥¿èéå¨ä¸èµ·ï¼å®¡è§é®é¢ãä¸åçæé®ï¼ä»¥è³äºæä»¬å¯ä»¥æç¡®ä½¿ç¨åºæ¯åçº¦æãè®¨è®ºåè®¾ã\n\n * Whatï¼ç³»ç»çä½ç¨æ¯ä»ä¹ï¼ç³»ç»çç®æ æ¯ä»ä¹ï¼\n * Whoï¼ç³»ç»çç¨æ·ç¾¤ä½æ¯è°ï¼\n * Howï¼ç¨æ·å¸æææ ·ä½¿ç¨ç³»ç»ï¼ç³»ç»å¦ä½ä¸ºç¨æ·æä¾æå¡ï¼\n * How manyï¼æå¤å°ç¨æ·ï¼æ¥æ´»/ææ´»æå¤å°ï¼ââç¨æ·ä½éä¼æå¤§çå½±åç³»ç»çæ§è½è¦æ±ï¼ä»èå½±åç³»ç»çè§æ¨¡åå¤æåº¦ã\n * å®¹éï¼ç³»ç»éè¦å¤çå¤å°æ°æ®ï¼\n * å¹¶åéãååéï¼ç³»ç»éè¦æ¯ç§éå¤çå¤å°è¯·æ±ï¼\n * è¯»åæ¯çï¼ç³»ç»çè¯»åæ¯çæ¯å¤å°ï¼ââè¯»å¤åå°æåå¤è¯»å°å³å®äºä¸åçæ¶ææ¹æ¡ã\n * How muchï¼ç³»ç»çé¢ç®æ¯å¤å°ï¼åæ¬ç©æãäººåææ¬ç­ï¼ï¼\n * è¾å¥è¾åºï¼ç³»ç»çè¾å¥è¾åºåå«æ¯ä»ä¹ï¼\n\n# ç¬¬äºæ­¥ï¼é¡¶å±è®¾è®¡\n\nä½¿ç¨ææéè¦çç»ä»¶æ¥æç»åºä¸ä¸ªé«å±çº§çè®¾è®¡ã\n\n * ç»åºä¸»è¦çç»ä»¶åè¿æ¥\n * è¯æä½ çæ³æ³\n\n# ç¬¬ä¸æ­¥ï¼ç»ä»¶è®¾è®¡\n\nå¯¹æ¯ä¸ä¸ªæ ¸å¿ç»ä»¶è¿è¡è¯¦ç»æ·±å¥çåæã\n\n# ç¬¬åæ­¥ï¼æ©å±è®¾è®¡\n\nç¡®è®¤åå¤çç¶é¢ä»¥åä¸äºéå¶ãä¸¾ä¾æ¥è¯´å°±æ¯ä½ éè¦ä¸é¢çè¿äºæ¥å®ææ©å±æ§çè®®é¢åï¼\n\n * è´è½½åè¡¡\n * æ°´å¹³æ©å±\n * ç¼å­\n * æ°æ®åºåç\n\n\n# æ¶æè®¾è®¡\n\n> å¦ææè½¯ä»¶å¼åå·¥ä½æ¯ä½æ¯ä¸åºæäºï¼é£ä¹ç³»ç»æ¶ææ çæ¯æç¥å±é¢çå·¥ä½ãä¼æå¨ç¥ï¼ä¸ä¸é«æ¥¼å¹³å°èµ·ï¼ç³»ç»æ¶æå°±åæ¯è½¯ä»¶çå°åºï¼å¦æä¸å¼å§å°±æ­ªäºï¼é£ä¹ä»£ç åå¾åæ¼äº®ï¼è½¯ä»¶ä¹é¾ä»¥æåã\n> \n> è½¯ä»¶æ´ä½ç»æä¸ç»ä»¶çæ½è±¡æè¿°ï¼ç¨äºæå¯¼å¤§åè½¯ä»¶ç³»ç»åä¸ªæ¹é¢çè®¾è®¡ãéç¹æ¯åèæ²»ä¹ï¼åå°å¤§åç³»ç»æ½è±¡ä¸ºåä¸ªç»ä»¶ææ¨¡åï¼ç¶åéä¸è§£å³åç»ä»¶ãåæ¨¡åçåè½ãæ§è½é®é¢ï¼æåå°è¿äºç»ä»¶ãæ¨¡åæ´åæå¯¹å¤æå¡çä¸ä¸ªæ´ä½ã\n\n * ç³»ç»æ¶æé¢è¯é¢\n * ç³»ç»æ¶ææ¦è¿°\n * ç³»ç»é«æ§è½æ¶æ\n * ç³»ç»é«å¯ç¨æ¶æ\n * ç³»ç»ä¼¸ç¼©æ§æ¶æ\n * ç³»ç»æ©å±æ§æ¶æ\n * ç³»ç»å®å¨æ§æ¶æ\n * å¤§åç³»ç»æ ¸å¿ææ¯\n * é¢åé©±å¨è®¾è®¡\n\n\n# åå¸å¼\n\n# åå¸å¼ç»¼å\n\n * åå¸å¼é¢è¯æ»ç»\n\n# åå¸å¼çè®º\n\n * åå¸å¼çè®º - å³é®è¯ï¼æå åº­å°åãCAPãBASEãéè¯¯çåå¸å¼åè®¾\n * åå¸å¼ç®æ³ Paxos - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ Raft - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ Gossip - å³é®è¯ï¼æ°æ®ä¼ æ­\n\n# åå¸å¼å³é®ææ¯\n\n * éç¾¤\n * å¤å¶\n * ååº\n * éä¸»\n\n# æµéè°åº¦\n\n * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n * æå¡ç½å³\n * åå¸å¼ä¼è¯ - å³é®è¯ï¼ç²æ§ SessionãSession å¤å¶å±äº«ãåºäºç¼å­ç session å±äº«\n\n# æ°æ®è°åº¦\n\n * æ°æ®ç¼å­ - å³é®è¯ï¼è¿ç¨åç¼å­ãåå¸å¼ç¼å­ãç¼å­éªå´©ãç¼å­ç©¿éãç¼å­å»ç©¿ãç¼å­æ´æ°ãç¼å­é¢ç­ãç¼å­éçº§\n * è¯»ååç¦»\n * ååºåè¡¨ - å³é®è¯ï¼åçãè·¯ç±ãè¿ç§»ãæ©å®¹ãååãèå\n * åå¸å¼ ID - å³é®è¯ï¼UUIDãèªå¢åºåãéªè±ç®æ³ãLeaf\n * åå¸å¼äºå¡ - å³é®è¯ï¼2PCã3PCãTCCãæ¬å°æ¶æ¯è¡¨ãMQ æ¶æ¯ãSAGA\n * åå¸å¼é - å³é®è¯ï¼æ°æ®åºãRedisãZooKeeperãäºæ¥ãå¯éå¥ãæ­»éãå®¹éãèªæå°è¯\n\n# èµæºè°åº¦\n\n * å¼¹æ§ä¼¸ç¼©\n\n# éä¿¡\n\n * æ¶æ¯éå - å³é®è¯ï¼éå¤æ¶è´¹ãæ¶æ¯ä¸¢å¤±ãæ¶æ¯é¡ºåºæ§ãæ¶æ¯ç§¯å\n\n# æå¡æ²»ç\n\n * æå¡æ³¨åååç°\n * æå¡çæ§\n * æå¡é¾è·¯çæ§\n * æå¡å®¹é\n * æå¡ç¼æ\n * æå¡çæ¬ç®¡ç\n * æµéè°åº¦\n   * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n   * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n   * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n   * æå¡ç½å³\n\n# åå¸å¼åºç¨\n\n# å¾®æå¡\n\n * å¾®æå¡ç®ä»\n\n\n# è®¾è®¡æ¹æ³\n\n# UML\n\n> ç»ä¸å»ºæ¨¡è¯­è¨ï¼è±è¯­ - Unified Modeling Languageï¼ç¼©å UMLï¼æ¯éä¸å©çç¬¬ä¸ä»£å»ºæ¨¡åè§çº¦è¯­è¨ãUML æ¯ä¸ç§å¼æ¾çæ¹æ³ï¼ç¨äºè¯´æãå¯è§åãæå»ºåç¼åä¸ä¸ªæ­£å¨å¼åçãé¢åå¯¹è±¡çãè½¯ä»¶å¯éç³»ç»çå¶åçå¼æ¾æ¹æ³ãUML å±ç°äºä¸ç³»åæä½³å·¥ç¨å®è·µï¼è¿äºæä½³å®è·µå¨å¯¹å¤§è§æ¨¡ï¼å¤æç³»ç»è¿è¡å»ºæ¨¡æ¹é¢ï¼ç¹å«æ¯å¨è½¯ä»¶æ¶æå±æ¬¡å·²ç»è¢«éªè¯ææã\n\n * UML å¿«éå¥é¨\n * UML ç»æå»ºæ¨¡å¾\n * UML è¡ä¸ºå»ºæ¨¡å¾\n\n# è®¾è®¡æ¨¡å¼\n\n> è®¾è®¡æ¨¡å¼ï¼Design patternï¼ä»£è¡¨äºæä½³çå®è·µï¼éå¸¸è¢«æç»éªçé¢åå¯¹è±¡çè½¯ä»¶å¼åäººåæéç¨ãè®¾è®¡æ¨¡å¼æ¯è½¯ä»¶å¼åäººåå¨è½¯ä»¶å¼åè¿ç¨ä¸­é¢ä¸´çä¸è¬é®é¢çè§£å³æ¹æ¡ãè¿äºè§£å³æ¹æ¡æ¯ä¼å¤è½¯ä»¶å¼åäººåç»è¿ç¸å½é¿çä¸æ®µæ¶é´çè¯éªåéè¯¯æ»ç»åºæ¥çã\n\n# åå»ºåæ¨¡å¼\n\n * ç®åå·¥åæ¨¡å¼ (Simple Factory)\n * å·¥åæ¹æ³æ¨¡å¼ (Factory Method)\n * æ½è±¡å·¥åæ¨¡å¼ (Abstract Factory)\n * å»ºé èæ¨¡å¼ (Builder)\n * ååæ¨¡å¼ (Prototype)\n * åä¾æ¨¡å¼ (Singleton)\n\n# ç»æåæ¨¡å¼\n\n * ééå¨æ¨¡å¼ (Adapter)\n * æ¡¥æ¥æ¨¡å¼ (Bridge)\n * ç»åæ¨¡å¼ (Composite)\n * è£é¥°æ¨¡å¼ (Decorator)\n * å¤è§æ¨¡å¼ (Facade)\n * äº«åæ¨¡å¼ (Flyweight)\n * ä»£çæ¨¡å¼ (Proxy)\n\n# è¡ä¸ºåæ¨¡å¼\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (Template Method)\n * å½ä»¤æ¨¡å¼ (Command)\n * è¿­ä»£å¨æ¨¡å¼ (Iterator)\n * è§å¯èæ¨¡å¼ (Observer)\n * è§£éå¨æ¨¡å¼ (Interpreter)\n * ä¸­ä»èæ¨¡å¼ (Mediator)\n * èè´£é¾æ¨¡å¼ (Chain of Responsibility)\n * å¤å¿å½æ¨¡å¼ (Memento)\n * ç­ç¥æ¨¡å¼ (Strategy)\n * è®¿é®èæ¨¡å¼ (Visitor)\n * ç¶ææ¨¡å¼ (State)\n\n# éæ\n\n> æ¹åæ¢æä»£ç çè®¾è®¡ã\n> \n> å³é®è¯ï¼è¿é¿å½æ°ãè¿å¤§çç±»ãåºæ¬ç±»ååæ§ãè¿é¿åæ°åãæ°æ®æ³¥å¢ãswitch å£°æãä¸´æ¶å­æ®µãè¢«æç»çé¦èµ ãå¼æ²åå·¥çç±»ãåæ£å¼ååãé°å¼¹å¼ä¿®æ¹ãå¹³è¡ç»§æ¿ä½ç³»ãè¿å¤çæ³¨éãéå¤ä»£ç ãåä½ç±»ãçº¯ç¨çæ°æ®ç±»ãå¤¸å¤¸å¶è°æªæ¥æ§ãä¾ææç»ãçæµå³ç³»ãè¿åº¦è¦åçæ¶æ¯é¾ãä¸­é´äººãä¸å®ç¾çåºç±»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n   * å¤§åç½ç«ç³»ç»ä¸ Java ä¸­é´ä»¶å®è·µ\n   * ä¼ä¸ IT æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æ - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * éæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n   * ãHead First è®¾è®¡æ¨¡å¼ã\n   * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n   * ãéæââæ¹åæ¢æä»£ç çè®¾è®¡ã\n * æç¨\n   * system-design-primer\n   * ä» 0 å¼å§å­¦æ¶æ\n   * ä» 0 å¼å§å­¦å¾®æå¡\n   * RPC å®æä¸æ ¸å¿åç\n   * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n   * DDD å®æè¯¾\n   * Sparx UML æç¨\n   * UML Tutorial\n   * W3Cschool UML æç¨\n   * https://sourcemaking.com/refactoring\n\n\n# ðª ä¼ é\n\nâ¾ ð  DESIGN é¦é¡µ â¾ ð¯ æçåå®¢ â¾\n\n> ä½ å¯è½ä¼æå´è¶£ï¼\n\n * Java æç¨ ð\n * JavaCore æç¨ ð\n * JavaTech æç¨ ð\n * Spring æç¨ ð\n * Spring Boot æç¨ ð\n * æ°æ®åºæç¨ ð\n * æ°æ®ç»æåç®æ³æç¨ ð\n * Linux æç¨ ð\n * Nginx æç¨ ð",normalizedContent:"> â design æ¯ä¸ªäººå¯¹äºè½¯ä»¶ç³»ç»æ¶æçå¿å¾åæ»ç»ã\n> \n> æ¶æä¹éï¼å¨äºæè¡¡ï¼æè¡¡ä¹æ¯ï¼å¨äºåèã\n> \n>  * ð é¡¹ç®åæ­¥ç»´æ¤ï¼github | gitee\n>  * ð çµå­ä¹¦éè¯»ï¼github pages | gitee pages\n\n\n# ð åå®¹\n\n\n# è®¾è®¡æ­¥éª¤\n\nè§£å³æ¹æ¡ï¼solutionï¼ï¼å°±æ¯éå¯¹æäºå·²ç»ä½ç°åºçï¼æèå¯ä»¥é¢æçé®é¢ãä¸è¶³ãç¼ºé·ãéæ±ç­ç­ï¼ææåºçä¸ä¸ªè§£å³æ´ä½é®é¢çå¯è¡æ§æ¹æ¡ãå°±è½¯ä»¶ç³»ç»èè¨ï¼è§£å³æ¹æ¡å°±æ¯ä¸ä¸ªå¯ä»¥è§£å³å·ä½ä¸å¡é®é¢ï¼å¹¶ä¸å¯ä»¥è½å°çè½¯ä»¶ç³»ç»ã\n\nè§£å³æ¹æ¡ï¼æ¯«æ çé®æ¯é¡¶å±ç³»ç»è®¾è®¡ï¼è¿éè¦è®¾è®¡èæ¢æææ¯ï¼ä¹æä¸å¡ã\n\n# ç¬¬ä¸æ­¥ï¼éæ±åæ\n\næææéè¦çä¸è¥¿èéå¨ä¸èµ·ï¼å®¡è§é®é¢ãä¸åçæé®ï¼ä»¥è³äºæä»¬å¯ä»¥æç¡®ä½¿ç¨åºæ¯åçº¦æãè®¨è®ºåè®¾ã\n\n * whatï¼ç³»ç»çä½ç¨æ¯ä»ä¹ï¼ç³»ç»çç®æ æ¯ä»ä¹ï¼\n * whoï¼ç³»ç»çç¨æ·ç¾¤ä½æ¯è°ï¼\n * howï¼ç¨æ·å¸æææ ·ä½¿ç¨ç³»ç»ï¼ç³»ç»å¦ä½ä¸ºç¨æ·æä¾æå¡ï¼\n * how manyï¼æå¤å°ç¨æ·ï¼æ¥æ´»/ææ´»æå¤å°ï¼ââç¨æ·ä½éä¼æå¤§çå½±åç³»ç»çæ§è½è¦æ±ï¼ä»èå½±åç³»ç»çè§æ¨¡åå¤æåº¦ã\n * å®¹éï¼ç³»ç»éè¦å¤çå¤å°æ°æ®ï¼\n * å¹¶åéãååéï¼ç³»ç»éè¦æ¯ç§éå¤çå¤å°è¯·æ±ï¼\n * è¯»åæ¯çï¼ç³»ç»çè¯»åæ¯çæ¯å¤å°ï¼ââè¯»å¤åå°æåå¤è¯»å°å³å®äºä¸åçæ¶ææ¹æ¡ã\n * how muchï¼ç³»ç»çé¢ç®æ¯å¤å°ï¼åæ¬ç©æãäººåææ¬ç­ï¼ï¼\n * è¾å¥è¾åºï¼ç³»ç»çè¾å¥è¾åºåå«æ¯ä»ä¹ï¼\n\n# ç¬¬äºæ­¥ï¼é¡¶å±è®¾è®¡\n\nä½¿ç¨ææéè¦çç»ä»¶æ¥æç»åºä¸ä¸ªé«å±çº§çè®¾è®¡ã\n\n * ç»åºä¸»è¦çç»ä»¶åè¿æ¥\n * è¯æä½ çæ³æ³\n\n# ç¬¬ä¸æ­¥ï¼ç»ä»¶è®¾è®¡\n\nå¯¹æ¯ä¸ä¸ªæ ¸å¿ç»ä»¶è¿è¡è¯¦ç»æ·±å¥çåæã\n\n# ç¬¬åæ­¥ï¼æ©å±è®¾è®¡\n\nç¡®è®¤åå¤çç¶é¢ä»¥åä¸äºéå¶ãä¸¾ä¾æ¥è¯´å°±æ¯ä½ éè¦ä¸é¢çè¿äºæ¥å®ææ©å±æ§çè®®é¢åï¼\n\n * è´è½½åè¡¡\n * æ°´å¹³æ©å±\n * ç¼å­\n * æ°æ®åºåç\n\n\n# æ¶æè®¾è®¡\n\n> å¦ææè½¯ä»¶å¼åå·¥ä½æ¯ä½æ¯ä¸åºæäºï¼é£ä¹ç³»ç»æ¶ææ çæ¯æç¥å±é¢çå·¥ä½ãä¼æå¨ç¥ï¼ä¸ä¸é«æ¥¼å¹³å°èµ·ï¼ç³»ç»æ¶æå°±åæ¯è½¯ä»¶çå°åºï¼å¦æä¸å¼å§å°±æ­ªäºï¼é£ä¹ä»£ç åå¾åæ¼äº®ï¼è½¯ä»¶ä¹é¾ä»¥æåã\n> \n> è½¯ä»¶æ´ä½ç»æä¸ç»ä»¶çæ½è±¡æè¿°ï¼ç¨äºæå¯¼å¤§åè½¯ä»¶ç³»ç»åä¸ªæ¹é¢çè®¾è®¡ãéç¹æ¯åèæ²»ä¹ï¼åå°å¤§åç³»ç»æ½è±¡ä¸ºåä¸ªç»ä»¶ææ¨¡åï¼ç¶åéä¸è§£å³åç»ä»¶ãåæ¨¡åçåè½ãæ§è½é®é¢ï¼æåå°è¿äºç»ä»¶ãæ¨¡åæ´åæå¯¹å¤æå¡çä¸ä¸ªæ´ä½ã\n\n * ç³»ç»æ¶æé¢è¯é¢\n * ç³»ç»æ¶ææ¦è¿°\n * ç³»ç»é«æ§è½æ¶æ\n * ç³»ç»é«å¯ç¨æ¶æ\n * ç³»ç»ä¼¸ç¼©æ§æ¶æ\n * ç³»ç»æ©å±æ§æ¶æ\n * ç³»ç»å®å¨æ§æ¶æ\n * å¤§åç³»ç»æ ¸å¿ææ¯\n * é¢åé©±å¨è®¾è®¡\n\n\n# åå¸å¼\n\n# åå¸å¼ç»¼å\n\n * åå¸å¼é¢è¯æ»ç»\n\n# åå¸å¼çè®º\n\n * åå¸å¼çè®º - å³é®è¯ï¼æå åº­å°åãcapãbaseãéè¯¯çåå¸å¼åè®¾\n * åå¸å¼ç®æ³ paxos - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ raft - å³é®è¯ï¼å±è¯æ§ç®æ³\n * åå¸å¼ç®æ³ gossip - å³é®è¯ï¼æ°æ®ä¼ æ­\n\n# åå¸å¼å³é®ææ¯\n\n * éç¾¤\n * å¤å¶\n * ååº\n * éä¸»\n\n# æµéè°åº¦\n\n * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n * æå¡ç½å³\n * åå¸å¼ä¼è¯ - å³é®è¯ï¼ç²æ§ sessionãsession å¤å¶å±äº«ãåºäºç¼å­ç session å±äº«\n\n# æ°æ®è°åº¦\n\n * æ°æ®ç¼å­ - å³é®è¯ï¼è¿ç¨åç¼å­ãåå¸å¼ç¼å­ãç¼å­éªå´©ãç¼å­ç©¿éãç¼å­å»ç©¿ãç¼å­æ´æ°ãç¼å­é¢ç­ãç¼å­éçº§\n * è¯»ååç¦»\n * ååºåè¡¨ - å³é®è¯ï¼åçãè·¯ç±ãè¿ç§»ãæ©å®¹ãååãèå\n * åå¸å¼ id - å³é®è¯ï¼uuidãèªå¢åºåãéªè±ç®æ³ãleaf\n * åå¸å¼äºå¡ - å³é®è¯ï¼2pcã3pcãtccãæ¬å°æ¶æ¯è¡¨ãmq æ¶æ¯ãsaga\n * åå¸å¼é - å³é®è¯ï¼æ°æ®åºãredisãzookeeperãäºæ¥ãå¯éå¥ãæ­»éãå®¹éãèªæå°è¯\n\n# èµæºè°åº¦\n\n * å¼¹æ§ä¼¸ç¼©\n\n# éä¿¡\n\n * æ¶æ¯éå - å³é®è¯ï¼éå¤æ¶è´¹ãæ¶æ¯ä¸¢å¤±ãæ¶æ¯é¡ºåºæ§ãæ¶æ¯ç§¯å\n\n# æå¡æ²»ç\n\n * æå¡æ³¨åååç°\n * æå¡çæ§\n * æå¡é¾è·¯çæ§\n * æå¡å®¹é\n * æå¡ç¼æ\n * æå¡çæ¬ç®¡ç\n * æµéè°åº¦\n   * æµéæ§å¶ - å³é®è¯ï¼éæµãçæ­ãéçº§ãè®¡æ°å¨æ³ãæ¶é´çªå£æ³ãä»¤çæ¡¶æ³ãæ¼æ¡¶æ³\n   * è´è½½åè¡¡ - å³é®è¯ï¼è½®è¯¢ãéæºãæå°è¿æ¥ãæºå°ååå¸ãä¸è´æ§åå¸ãèæ hash æ§½\n   * æå¡è·¯ç± - å³é®è¯ï¼è·¯ç±ãæ¡ä»¶è·¯ç±ãèæ¬è·¯ç±ãæ ç­¾è·¯ç±\n   * æå¡ç½å³\n\n# åå¸å¼åºç¨\n\n# å¾®æå¡\n\n * å¾®æå¡ç®ä»\n\n\n# è®¾è®¡æ¹æ³\n\n# uml\n\n> ç»ä¸å»ºæ¨¡è¯­è¨ï¼è±è¯­ - unified modeling languageï¼ç¼©å umlï¼æ¯éä¸å©çç¬¬ä¸ä»£å»ºæ¨¡åè§çº¦è¯­è¨ãuml æ¯ä¸ç§å¼æ¾çæ¹æ³ï¼ç¨äºè¯´æãå¯è§åãæå»ºåç¼åä¸ä¸ªæ­£å¨å¼åçãé¢åå¯¹è±¡çãè½¯ä»¶å¯éç³»ç»çå¶åçå¼æ¾æ¹æ³ãuml å±ç°äºä¸ç³»åæä½³å·¥ç¨å®è·µï¼è¿äºæä½³å®è·µå¨å¯¹å¤§è§æ¨¡ï¼å¤æç³»ç»è¿è¡å»ºæ¨¡æ¹é¢ï¼ç¹å«æ¯å¨è½¯ä»¶æ¶æå±æ¬¡å·²ç»è¢«éªè¯ææã\n\n * uml å¿«éå¥é¨\n * uml ç»æå»ºæ¨¡å¾\n * uml è¡ä¸ºå»ºæ¨¡å¾\n\n# è®¾è®¡æ¨¡å¼\n\n> è®¾è®¡æ¨¡å¼ï¼design patternï¼ä»£è¡¨äºæä½³çå®è·µï¼éå¸¸è¢«æç»éªçé¢åå¯¹è±¡çè½¯ä»¶å¼åäººåæéç¨ãè®¾è®¡æ¨¡å¼æ¯è½¯ä»¶å¼åäººåå¨è½¯ä»¶å¼åè¿ç¨ä¸­é¢ä¸´çä¸è¬é®é¢çè§£å³æ¹æ¡ãè¿äºè§£å³æ¹æ¡æ¯ä¼å¤è½¯ä»¶å¼åäººåç»è¿ç¸å½é¿çä¸æ®µæ¶é´çè¯éªåéè¯¯æ»ç»åºæ¥çã\n\n# åå»ºåæ¨¡å¼\n\n * ç®åå·¥åæ¨¡å¼ (simple factory)\n * å·¥åæ¹æ³æ¨¡å¼ (factory method)\n * æ½è±¡å·¥åæ¨¡å¼ (abstract factory)\n * å»ºé èæ¨¡å¼ (builder)\n * ååæ¨¡å¼ (prototype)\n * åä¾æ¨¡å¼ (singleton)\n\n# ç»æåæ¨¡å¼\n\n * ééå¨æ¨¡å¼ (adapter)\n * æ¡¥æ¥æ¨¡å¼ (bridge)\n * ç»åæ¨¡å¼ (composite)\n * è£é¥°æ¨¡å¼ (decorator)\n * å¤è§æ¨¡å¼ (facade)\n * äº«åæ¨¡å¼ (flyweight)\n * ä»£çæ¨¡å¼ (proxy)\n\n# è¡ä¸ºåæ¨¡å¼\n\n * æ¨¡æ¿æ¹æ³æ¨¡å¼ (template method)\n * å½ä»¤æ¨¡å¼ (command)\n * è¿­ä»£å¨æ¨¡å¼ (iterator)\n * è§å¯èæ¨¡å¼ (observer)\n * è§£éå¨æ¨¡å¼ (interpreter)\n * ä¸­ä»èæ¨¡å¼ (mediator)\n * èè´£é¾æ¨¡å¼ (chain of responsibility)\n * å¤å¿å½æ¨¡å¼ (memento)\n * ç­ç¥æ¨¡å¼ (strategy)\n * è®¿é®èæ¨¡å¼ (visitor)\n * ç¶ææ¨¡å¼ (state)\n\n# éæ\n\n> æ¹åæ¢æä»£ç çè®¾è®¡ã\n> \n> å³é®è¯ï¼è¿é¿å½æ°ãè¿å¤§çç±»ãåºæ¬ç±»ååæ§ãè¿é¿åæ°åãæ°æ®æ³¥å¢ãswitch å£°æãä¸´æ¶å­æ®µãè¢«æç»çé¦èµ ãå¼æ²åå·¥çç±»ãåæ£å¼ååãé°å¼¹å¼ä¿®æ¹ãå¹³è¡ç»§æ¿ä½ç³»ãè¿å¤çæ³¨éãéå¤ä»£ç ãåä½ç±»ãçº¯ç¨çæ°æ®ç±»ãå¤¸å¤¸å¶è°æªæ¥æ§ãä¾ææç»ãçæµå³ç³»ãè¿åº¦è¦åçæ¶æ¯é¾ãä¸­é´äººãä¸å®ç¾çåºç±»\n\n * ä»£ç çåå³éåéæ\n * ä»£ç åå³éä¹ä»£ç èè¿\n * ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡\n * ä»£ç åå³éä¹åé©çéç¢\n * ä»£ç åå³éä¹éå¿è¦ç\n * ä»£ç åå³éä¹è¦å\n\n\n# ð èµæ\n\n * ä¹¦ç±\n   * ãå¤§åç½ç«ææ¯æ¶æï¼æ ¸å¿åçä¸æ¡ä¾åæã - æµæ¾ææçå°è§£å¤§åç½ç«æ¶ææ¼è¿ä¹è·¯ï¼ç®ä»äºå¤§åç³»ç»æé¢ä¸´çææä»¥åæ ¸å¿ææ¯ç¹ã\n   * ãäº¿çº§æµéç½ç«æ¶ææ ¸å¿ææ¯ï¼è·å¼æ¶å­¦æ­å»ºé«å¯ç¨é«å¹¶åç³»ç»ã\n   * å¤§åç½ç«ç³»ç»ä¸ java ä¸­é´ä»¶å®è·µ\n   * ä¼ä¸ it æ¶æè½¬åä¹éï¼é¿éå·´å·´ä¸­å°æç¥ææ³ä¸æ¶æå®æ - éè¿°é¿éå·´å·´ä¸­å°ç³»ç»åå±ï¼æ´å¤çæ¯è®²è§£åºç¨åºæ¯åè½åï¼æ²¡æè®²è§£ææ¯ç»èã\n   * éæµèä¸ï¼é¿éå·´å·´ææ¯æé¿ä¹è·¯ - ä¸»è¦ä»¥è¿ç»´çè§è§éè¿°ç³»ç»è¿ç»´ä¸­éå°çå°é¾ï¼å®ä½æè·¯ä»¥åè§£å³æ¹æ³ã\n   * ãhead first è®¾è®¡æ¨¡å¼ã\n   * ãå¤§è¯è®¾è®¡æ¨¡å¼ã\n   * ãéæââæ¹åæ¢æä»£ç çè®¾è®¡ã\n * æç¨\n   * system-design-primer\n   * ä» 0 å¼å§å­¦æ¶æ\n   * ä» 0 å¼å§å­¦å¾®æå¡\n   * rpc å®æä¸æ ¸å¿åç\n   * å¾®æå¡æ¶ææ ¸å¿ 20 è®²\n   * ddd å®æè¯¾\n   * sparx uml æç¨\n   * uml tutorial\n   * w3cschool uml æç¨\n   * https://sourcemaking.com/refactoring\n\n\n# ðª ä¼ é\n\nâ¾ ð  design é¦é¡µ â¾ ð¯ æçåå®¢ â¾\n\n> ä½ å¯è½ä¼æå´è¶£ï¼\n\n * java æç¨ ð\n * javacore æç¨ ð\n * javatech æç¨ ð\n * spring æç¨ ð\n * spring boot æç¨ ð\n * æ°æ®åºæç¨ ð\n * æ°æ®ç»æåç®æ³æç¨ ð\n * linux æç¨ ð\n * nginx æç¨ ð",charsets:{cjk:!0},lastUpdated:"2022/04/22, 20:07:55",lastUpdatedTimestamp:1650629275e3}],themeConfig:{nav:[{text:"æ¶æ",link:"/01.æ¶æ/"},{text:"åå¸å¼",link:"/02.åå¸å¼/"},{text:"è®¾è®¡",link:"/03.è®¾è®¡/",items:[{text:"UML",link:"/03.è®¾è®¡/01.UML/"},{text:"è®¾è®¡æ¨¡å¼",link:"/03.è®¾è®¡/02.è®¾è®¡æ¨¡å¼/"},{text:"éæ",link:"/03.è®¾è®¡/03.éæ/"}]}],sidebarDepth:2,logo:"https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo.png",repo:"dunwu/design",searchMaxSuggestions:10,lastUpdated:"ä¸æ¬¡æ´æ°",docsDir:"docs",editLinks:!0,editLinkText:"ð å¸®å©æ¹åæ­¤é¡µé¢ï¼",sidebar:{"/01.æ¶æ/":[{title:"è§£å³æ¹æ¡",collapsable:!1,children:[]},["02.ç³»ç»æ¶ææ¦è¿°.md","ç³»ç»æ¶ææ¦è¿°","/pages/ce2da4/"],["03.ç³»ç»é«æ§è½æ¶æ.md","ç³»ç»é«æ§è½æ¶æ","/pages/41c2c7/"],["04.ç³»ç»é«å¯ç¨æ¶æ.md","ç³»ç»é«å¯ç¨æ¶æ","/pages/ad5762/"],["05.ç³»ç»ä¼¸ç¼©æ§æ¶æ.md","ç³»ç»ä¼¸ç¼©æ§æ¶æ","/pages/ed2a88/"],["06.ç³»ç»æ©å±æ§æ¶æ.md","ç³»ç»æ©å±æ§æ¶æ","/pages/1580de/"],["07.ç³»ç»å®å¨æ§æ¶æ.md","ç³»ç»å®å¨æ§æ¶æ","/pages/039552/"],["08.å¤§åç³»ç»æ ¸å¿ææ¯.md","å¤§åç³»ç»æ ¸å¿ææ¯","/pages/eb0425/"],["09.é¢åé©±å¨è®¾è®¡.md","é¢åé©±å¨è®¾è®¡","/pages/4dfb51/"]],catalogue:{},"/02.åå¸å¼/":[{title:"åå¸å¼ç»¼å",collapsable:!1,children:[["01.åå¸å¼ç»¼å/01.åå¸å¼é¢è¯æ»ç».md","åå¸å¼é¢è¯æ»ç»","/pages/cd56bb/"]]},{title:"åå¸å¼çè®º",collapsable:!1,children:[["02.åå¸å¼çè®º/01.åå¸å¼çè®º.md","åå¸å¼çè®º","/pages/367308/"],["02.åå¸å¼çè®º/02.åå¸å¼ç®æ³Paxos.md","æ·±å¥åæå±è¯æ§ç®æ³ Paxos","/pages/874539/"],["02.åå¸å¼çè®º/03.åå¸å¼ç®æ³Raft.md","æ·±å¥åæå±è¯æ§ç®æ³ Raft","/pages/e40812/"],["02.åå¸å¼çè®º/04.åå¸å¼ç®æ³Gossip.md","åå¸å¼ç®æ³ Gossip","/pages/d15993/"]]},{title:"åå¸å¼å³é®ææ¯",collapsable:!1,children:[{title:"æµéè°åº¦",collapsable:!1,children:[["03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/01.æµéæ§å¶.md","æµéæ§å¶","/pages/282676/"],["03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/02.è´è½½åè¡¡.md","æ·±å¥æµåºè´è½½åè¡¡","/pages/b7ca44/"],["03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/03.æå¡è·¯ç±.md","æå¡è·¯ç±","/pages/d04ece/"],["03.åå¸å¼å³é®ææ¯/01.æµéè°åº¦/10.åå¸å¼ä¼è¯.md","åå¸å¼ä¼è¯åºæ¬åç","/pages/3e66c2/"]]},{title:"æ°æ®è°åº¦",collapsable:!1,children:[["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/01.æ°æ®ç¼å­.md","ç¼å­åºæ¬åç","/pages/471208/"],["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/02.è¯»ååç¦».md","è¯»ååç¦»åºæ¬åç","/pages/7da6ca/"],["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/03.ååºåè¡¨.md","ååºåè¡¨åºæ¬åç","/pages/103382/"],["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/04.åå¸å¼ID.md","åå¸å¼ ID åºæ¬åç","/pages/0b2e59/"],["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/05.åå¸å¼äºå¡.md","åå¸å¼äºå¡åºæ¬åç","/pages/910bad/"],["03.åå¸å¼å³é®ææ¯/02.æ°æ®è°åº¦/06.åå¸å¼é.md","åå¸å¼éåºæ¬åç","/pages/69360c/"]]},{title:"éä¿¡",collapsable:!1,children:[["03.åå¸å¼å³é®ææ¯/04.éä¿¡/01.æ¶æ¯éå.md","æ¶æ¯éååºæ¬åç","/pages/4bba35/"]]},{title:"æå¡æ²»ç",collapsable:!1,children:[["03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/01.æå¡æ³¨åååç°.md","æå¡æ³¨åååç°","/pages/516f3b/"],["03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/02.æå¡çæ§.md","æå¡çæ§","/pages/4c0174/"],["03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/03.æå¡é¾è·¯çæ§.md","æå¡é¾è·¯çæ§","/pages/f918df/"],["03.åå¸å¼å³é®ææ¯/05.æå¡æ²»ç/04.æå¡å®¹é.md","æå¡å®¹é","/pages/28bda8/"]]}]},{title:"åå¸å¼åºç¨",collapsable:!1,children:[{title:"å¾®æå¡",collapsable:!1,children:[["04.åå¸å¼åºç¨/01.å¾®æå¡/01.å¾®æå¡ç®ä».md","å¾®æå¡ç®ä»","/pages/f13c06/"],["04.åå¸å¼åºç¨/01.å¾®æå¡/02.RPC.md","RPC åºæ¬åç","/pages/ebf86b/"],["04.åå¸å¼åºç¨/01.å¾®æå¡/22.Kong.md","kong","/pages/3c87eb/"]]}]}],"/03.è®¾è®¡/":[{title:"UML",collapsable:!1,children:[["01.UML/01.UMLå¿«éå¥é¨.md","UML å¿«éå¥é¨","/pages/eae6a0/"],["01.UML/02.UMLç»æå»ºæ¨¡å¾.md","UML ç»æå»ºæ¨¡å¾","/pages/97f796/"],["01.UML/03.UMLè¡ä¸ºå»ºæ¨¡å¾.md","UMLè¡ä¸ºå»ºæ¨¡å¾","/pages/dba425/"]]},{title:"è®¾è®¡æ¨¡å¼",collapsable:!1,children:[["02.è®¾è®¡æ¨¡å¼/00.è®¾è®¡æ¨¡å¼æ¦è¿°.md","è®¾è®¡æ¨¡å¼æ¦è¿°","/pages/dad9fd/"],["02.è®¾è®¡æ¨¡å¼/01.ç®åå·¥åæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ç®åå·¥åæ¨¡å¼","/pages/4244b2/"],["02.è®¾è®¡æ¨¡å¼/02.å·¥åæ¹æ³æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹å·¥åæ¹æ³æ¨¡å¼","/pages/58cd12/"],["02.è®¾è®¡æ¨¡å¼/03.æ½è±¡å·¥åæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹æ½è±¡å·¥åæ¨¡å¼","/pages/d40cbb/"],["02.è®¾è®¡æ¨¡å¼/04.å»ºé èæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹å»ºé èæ¨¡å¼","/pages/cb480c/"],["02.è®¾è®¡æ¨¡å¼/05.ååæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ååæ¨¡å¼","/pages/c5ff69/"],["02.è®¾è®¡æ¨¡å¼/06.åä¾æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹åä¾æ¨¡å¼","/pages/b271ff/"],["02.è®¾è®¡æ¨¡å¼/07.ééå¨æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ééå¨æ¨¡å¼","/pages/2c4733/"],["02.è®¾è®¡æ¨¡å¼/08.æ¡¥æ¥æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹æ¡¥æ¥æ¨¡å¼","/pages/9f520d/"],["02.è®¾è®¡æ¨¡å¼/09.ç»åæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ç»åæ¨¡å¼","/pages/b18a73/"],["02.è®¾è®¡æ¨¡å¼/10.è£é¥°æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹è£é¥°æ¨¡å¼","/pages/12897e/"],["02.è®¾è®¡æ¨¡å¼/11.å¤è§æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹å¤è§æ¨¡å¼","/pages/427347/"],["02.è®¾è®¡æ¨¡å¼/12.äº«åæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹äº«åæ¨¡å¼","/pages/265866/"],["02.è®¾è®¡æ¨¡å¼/13.ä»£çæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ä»£çæ¨¡å¼","/pages/2937c1/"],["02.è®¾è®¡æ¨¡å¼/14.æ¨¡æ¿æ¹æ³æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹æ¨¡æ¿æ¹æ³æ¨¡å¼","/pages/604ebc/"],["02.è®¾è®¡æ¨¡å¼/15.å½ä»¤æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹å½ä»¤æ¨¡å¼","/pages/6389ed/"],["02.è®¾è®¡æ¨¡å¼/16.è¿­ä»£å¨æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹è¿­ä»£å¨æ¨¡å¼","/pages/d2026d/"],["02.è®¾è®¡æ¨¡å¼/17.è§å¯èæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹è§å¯èæ¨¡å¼","/pages/87fbaa/"],["02.è®¾è®¡æ¨¡å¼/18.è§£éå¨æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹è§£éå¨æ¨¡å¼","/pages/1e0eff/"],["02.è®¾è®¡æ¨¡å¼/19.ä¸­ä»èæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ä¸­ä»èæ¨¡å¼","/pages/b5886f/"],["02.è®¾è®¡æ¨¡å¼/20.èè´£é¾æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹èè´£é¾æ¨¡å¼","/pages/a92964/"],["02.è®¾è®¡æ¨¡å¼/21.å¤å¿å½æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹å¤å¿å½æ¨¡å¼","/pages/e3cd5d/"],["02.è®¾è®¡æ¨¡å¼/22.ç­ç¥æ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ç­ç¥æ¨¡å¼","/pages/e5bb92/"],["02.è®¾è®¡æ¨¡å¼/23.è®¿é®èæ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹è®¿é®èæ¨¡å¼","/pages/6e8ebc/"],["02.è®¾è®¡æ¨¡å¼/24.ç¶ææ¨¡å¼.md","è®¾è®¡æ¨¡å¼ä¹ç¶ææ¨¡å¼","/pages/6420d5/"],["02.è®¾è®¡æ¨¡å¼/25.é¢åå¯¹è±¡åå.md","é¢åå¯¹è±¡åå","/pages/b3c94e/"]]},{title:"éæ",collapsable:!1,children:[["03.éæ/01.ä»£ç çåå³éåéæ.md","ä»£ç çåå³éåéæ","/pages/89848c/"],["03.éæ/02.ä»£ç åå³éä¹ä»£ç èè¿.md","ä»£ç åå³éä¹ä»£ç èè¿","/pages/82f4c8/"],["03.éæ/03.ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡.md","ä»£ç åå³éä¹æ»¥ç¨é¢åå¯¹è±¡","/pages/9ae679/"],["03.éæ/04.ä»£ç åå³éä¹åé©çéç¢.md","ä»£ç åå³éä¹åé©çéç¢","/pages/76e1cc/"],["03.éæ/05.ä»£ç åå³éä¹éå¿è¦ç.md","ä»£ç åå³éä¹éå¿è¦ç","/pages/dff53d/"],["03.éæ/06.ä»£ç åå³éä¹è¦å.md","ä»£ç åå³éä¹è¦å","/pages/595d03/"]]},{title:"ç¼ç¨èå¼",collapsable:!1,children:[["04.ç¼ç¨èå¼/01.éè¯¯å¤ç.md","éè¯¯å¤ç","/pages/dc158b/"]]}]},updateBar:{showToArticle:!0},category:!0,tag:!0,archive:!0,author:{name:"dunwu",href:"https://github.com/dunwu"},social:{icons:[{iconClass:"icon-youjian",title:"åé®ä»¶",link:"mailto:forbreak@163.com"},{iconClass:"icon-github",title:"GitHub",link:"https://github.com/dunwu"}]},footer:{createYear:2019,copyrightInfo:"éæï¼dunwuï¼ | CC-BY-SA-4.0"},htmlModules:{pageB:'\n  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>\n  <style>\n    .pageB img{width:80px!important;}\n    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}\n  </style>\n  ',windowRB:'\n    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;\n    min-width: auto;min-height:auto;"></div>\n    <style>\n      .windowRB{ padding: 0;}\n      .windowRB .wwads-img{margin-top: 10px;}\n      .windowRB .wwads-content{margin: 0 10px 10px 10px;}\n      .custom-html-window-rb .close-but{\n        display: none;\n      }\n    </style>\n  '}}};t(155),t(213),t(144);var ss=t(223),cs=t(224),ds=(t(390),t(240),t(43));var us={computed:{$filterPosts:function(){return this.$site.pages.filter((function(n){var e=n.frontmatter,t=e.pageComponent,r=e.article,i=e.home;return!(t||!1===r||!0===i)}))},$sortPosts:function(){return(n=this.$filterPosts).sort((function(n,e){var t=n.frontmatter.sticky,r=e.frontmatter.sticky;return t&&r?t==r?Object(ds.a)(n,e):t-r:t&&!r?-1:!t&&r?1:Object(ds.a)(n,e)})),n;var n},$sortPostsByDate:function(){return(n=this.$filterPosts).sort((function(n,e){return Object(ds.a)(n,e)})),n;var n},$groupPosts:function(){return function(n){for(var e={},t={},r=function(r,i){var a=n[r].frontmatter,o=a.categories,l=a.tags;"array"===Object(ds.n)(o)&&o.forEach((function(t){t&&(e[t]||(e[t]=[]),e[t].push(n[r]))})),"array"===Object(ds.n)(l)&&l.forEach((function(e){e&&(t[e]||(t[e]=[]),t[e].push(n[r]))}))},i=0,a=n.length;i<a;i++)r(i);return{categories:e,tags:t}}(this.$sortPosts)},$categoriesAndTags:function(){return function(n){var e=[],t=[];for(var r in n.categories)e.push({key:r,length:n.categories[r].length});for(var i in n.tags)t.push({key:i,length:n.tags[i].length});return{categories:e,tags:t}}(this.$groupPosts)}}};Bi.component(ss.default),Bi.component(cs.default);function ps(n){return n.toString().padStart(2,"0")}t(394);Bi.component("Badge",(function(){return Promise.all([t.e(0),t.e(3)]).then(t.bind(null,585))})),Bi.component("CodeBlock",(function(){return Promise.resolve().then(t.bind(null,223))})),Bi.component("CodeGroup",(function(){return Promise.resolve().then(t.bind(null,224))}));t(395),t(396);var ms=[function(n){n.Vue,n.options;var e=n.router;n.siteData;n.isServer||e.afterEach((function(){var n;n=function(){},"complete"===document.readyState||"interactive"===document.readyState?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n),setTimeout((function(){var n=document.querySelector(".pageB");if(n){var e=n.querySelector(".wwads-hide");e&&(e.onclick=function(){n.style.display="none"}),n.style.display="flex"}}),0)}))},function(n){var e=n.Vue,t=(n.options,n.router,n.siteData);t.pages.map((function(n){var e=n.frontmatter,r=e.date,i=e.author;"string"==typeof r&&"Z"===r.charAt(r.length-1)&&(n.frontmatter.date=function(n){n instanceof Date||(n=new Date(n));return"".concat(n.getUTCFullYear(),"-").concat(ps(n.getUTCMonth()+1),"-").concat(ps(n.getUTCDate())," ").concat(ps(n.getUTCHours()),":").concat(ps(n.getUTCMinutes()),":").concat(ps(n.getUTCSeconds()))}(r)),i?n.author=i:t.themeConfig.author&&(n.author=t.themeConfig.author)})),e.mixin(us)},{},function(n){n.Vue.mixin({computed:{$dataBlock:function(){return this.$options.__data__block__}}})},{},{},function(){"undefined"!=typeof window&&function(n,e,t){function r(n){var t=e.createElement("div");t.className="heart",i.push({el:t,x:n.clientX-5,y:n.clientY-5,scale:1,alpha:1,color:"#11a8cd"}),e.body.appendChild(t)}var i=[];n.requestAnimationFrame=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(n){setTimeout(n,1e3/60)},function(n){var t=e.createElement("style");t.type="text/css";try{t.appendChild(e.createTextNode(n))}catch(e){t.styleSheet.cssText=n}e.getElementsByTagName("head")[0].appendChild(t)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),function(){var e="function"==typeof n.onclick&&n.onclick;n.onclick=function(n){var t=!0;n.path&&n.path.forEach((function(n){1===n.nodeType&&"string"==typeof n.className&&n.className.indexOf("theme-vdoing-content")>-1&&(t=!1)})),t&&(e&&e(),r(n))}}(),function n(){for(var t=0;t<i.length;t++)i[t].alpha<=0?(e.body.removeChild(i[t].el),i.splice(t,1)):(i[t].y--,i[t].scale+=.004,i[t].alpha-=.013,i[t].el.style.cssText="left:"+i[t].x+"px;top:"+i[t].y+"px;opacity:"+i[t].alpha+";transform:scale("+i[t].scale+","+i[t].scale+") rotate(45deg);background:"+i[t].color+";z-index:99999");requestAnimationFrame(n)}()}(window,document)}],hs=[];t(216);function gs(n,e){return(gs=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n})(n,e)}t(217),t(218);function fs(n){return(fs=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function vs(n,e){if(e&&("object"===So(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function bs(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,r=fs(n);if(e){var i=fs(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return vs(this,t)}}var ys=function(n){!function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&gs(n,e)}(t,n);var e=bs(t);function t(){return cl(this,t),e.apply(this,arguments)}return ul(t)}(function(){function n(){cl(this,n),this.store=new Bi({data:{state:{}}})}return ul(n,[{key:"$get",value:function(n){return this.store.state[n]}},{key:"$set",value:function(n,e){Bi.set(this.store.state,n,e)}},{key:"$emit",value:function(){var n;(n=this.store).$emit.apply(n,arguments)}},{key:"$on",value:function(){var n;(n=this.store).$on.apply(n,arguments)}}]),n}());Object.assign(ys.prototype,{getPageAsyncComponent:No,getLayoutAsyncComponent:Ho,getAsyncComponent:$o,getVueComponent:Qo});var xs={install:function(n){var e=new ys;n.$vuepress=e,n.prototype.$vuepress=e}};function Ts(n){n.beforeEach((function(e,t,r){if(ks(n,e.path))r();else if(/(\/|\.html)$/.test(e.path))if(/\/$/.test(e.path)){var i=e.path.replace(/\/$/,"")+".html";ks(n,i)?r(i):r()}else r();else{var a=e.path+"/",o=e.path+".html";ks(n,o)?r(o):ks(n,a)?r(a):r()}}))}function ks(n,e){var t=e.toLowerCase();return n.options.routes.some((function(n){return n.path.toLowerCase()===t}))}var ws={props:{pageKey:String,slotKey:{type:String,default:"default"}},render:function(n){var e=this.pageKey||this.$parent.$page.key;return Go("pageKey",e),Bi.component(e)||Bi.component(e,No(e)),Bi.component(e)?n(e):n("")}},Is={functional:!0,props:{slotKey:String,required:!0},render:function(n,e){var t=e.props,r=e.slots;return n("div",{class:["content__".concat(t.slotKey)]},r()[t.slotKey])}},Cs={computed:{openInNewWindowTitle:function(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Ss=(t(397),t(398),Object(is.a)(Cs,(function(){var n=this.$createElement,e=this._self._c||n;return e("span",[e("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[e("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),e("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),e("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports);function Es(){return(Es=Object(r.a)(regeneratorRuntime.mark((function n(e){var t,r,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:ls.routerBase||ls.base,Ts(r=new Io({base:t,mode:"history",fallback:!1,routes:os,scrollBehavior:function(n,e,t){return t||(n.hash?!Bi.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})}})),i={},n.prev=4,n.next=7,Promise.all(ms.filter((function(n){return"function"==typeof n})).map((function(n){return n({Vue:Bi,options:i,router:r,siteData:ls,isServer:e})})));case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(4),console.error(n.t0);case 12:return a=new Bi(Object.assign(i,{router:r,render:function(n){return n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},hs.map((function(e){return n(e)})))])}})),n.abrupt("return",{app:a,router:r});case 14:case"end":return n.stop()}}),n,null,[[4,9]])})))).apply(this,arguments)}Bi.config.productionTip=!1,Bi.use(Io),Bi.use(xs),Bi.mixin(function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bi;Co(e),t.$vuepress.$set("siteData",e);var r=n(t.$vuepress.$get("siteData")),i=new r,a=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(i)),o={};return Object.keys(a).reduce((function(n,e){return e.startsWith("$")&&(n[e]=a[e].get),n}),o),{computed:o}}((function(n){return function(){function e(){cl(this,e)}return ul(e,[{key:"setPage",value:function(n){this.__page=n}},{key:"$site",get:function(){return n}},{key:"$themeConfig",get:function(){return this.$site.themeConfig}},{key:"$frontmatter",get:function(){return this.$page.frontmatter}},{key:"$localeConfig",get:function(){var n,e,t=this.$site.locales,r=void 0===t?{}:t;for(var i in r)"/"===i?e=r[i]:0===this.$page.path.indexOf(i)&&(n=r[i]);return n||e||{}}},{key:"$siteTitle",get:function(){return this.$localeConfig.title||this.$site.title||""}},{key:"$canonicalUrl",get:function(){var n=this.$page.frontmatter.canonicalUrl;return"string"==typeof n&&n}},{key:"$title",get:function(){var n=this.$page,e=this.$page.frontmatter.metaTitle;if("string"==typeof e)return e;var t=this.$siteTitle,r=n.frontmatter.home?null:n.frontmatter.title||n.title;return t?r?r+" | "+t:t:r||"VuePress"}},{key:"$description",get:function(){var n=function(n){if(n){var e=n.filter((function(n){return"description"===n.name}))[0];if(e)return e.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}},{key:"$lang",get:function(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}},{key:"$localePath",get:function(){return this.$localeConfig.path||"/"}},{key:"$themeLocaleConfig",get:function(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}},{key:"$page",get:function(){return this.__page?this.__page:function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.path.toLowerCase()===e.toLowerCase())return r}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}}]),e}()}),ls)),Bi.component("Content",ws),Bi.component("ContentSlotsDistributor",Is),Bi.component("OutboundLink",Ss),Bi.component("ClientOnly",{functional:!0,render:function(n,e){var t=e.parent,r=e.children;if(t._isMounted)return r;t.$once("hook:mounted",(function(){t.$forceUpdate()}))}}),Bi.component("Layout",Ho("Layout")),Bi.component("NotFound",Ho("NotFound")),Bi.prototype.$withBase=function(n){var e=this.$site.base;return"/"===n.charAt(0)?e+n.slice(1):n},window.__VUEPRESS__={version:"1.9.2",hash:"18815ff"},function(n){return Es.apply(this,arguments)}(!1).then((function(n){var e=n.app;n.router.onReady((function(){e.$mount("#app")}))}))}]);